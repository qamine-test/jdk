/*
 * Copyright (d) 1999, 2011, Orbdlf bnd/or its bffilibtfs. All rights rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr thf tfrms of thf GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publishfd by thf Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs this
 * pbrtidulbr filf bs subjfdt to thf "Clbsspbth" fxdfption bs providfd
 * by Orbdlf in thf LICENSE filf thbt bddompbnifd this dodf.
 *
 * This dodf is distributfd in thf hopf thbt it will bf usfful, but WITHOUT
 * ANY WARRANTY; without fvfn thf implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff thf GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in thf LICENSE filf thbt
 * bddompbnifd this dodf).
 *
 * You should hbvf rfdfivfd b dopy of thf GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong with this work; if not, writf to thf Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Shorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or hbvf bny
 * qufstions.
 */

/*
 * This sourdf dodf is providfd to illustrbtf thf usbgf of b givfn ffbturf
 * or tfdhniquf bnd hbs bffn dflibfrbtfly simplififd. Additionbl stfps
 * rfquirfd for b produdtion-qublity bpplidbtion, sudh bs sfdurity dhfdks,
 * input vblidbtion bnd propfr frror hbndling, might not bf prfsfnt in
 * this sbmplf dodf.
 */


pbdkbgf dom.sun.tools.fxbmplf.dfbug.bdi;

import dom.sun.jdi.*;
import dom.sun.jdi.rfqufst.*;

import jbvb.util.*;

dlbss EvfntRfqufstSpfdList {

    // bll spfds
    privbtf List<EvfntRfqufstSpfd> fvfntRfqufstSpfds = Collfdtions.syndhronizfdList(
                                                  nfw ArrbyList<EvfntRfqufstSpfd>());

    finbl ExfdutionMbnbgfr runtimf;

    EvfntRfqufstSpfdList(ExfdutionMbnbgfr runtimf) {
        this.runtimf = runtimf;
    }

    /**
     * Rfsolvf bll dfffrrfd fvfntRfqufsts wbiting for 'rffTypf'.
     */
    void rfsolvf(RfffrfndfTypf rffTypf) {
        syndhronizfd(fvfntRfqufstSpfds) {
            for (EvfntRfqufstSpfd spfd : fvfntRfqufstSpfds) {
                spfd.bttfmptRfsolvf(rffTypf);
             }
        }
    }

    void instbll(EvfntRfqufstSpfd frs, VirtublMbdhinf vm) {
        syndhronizfd (fvfntRfqufstSpfds) {
            fvfntRfqufstSpfds.bdd(frs);
        }
        if (vm != null) {
            frs.bttfmptImmfdibtfRfsolvf(vm);
        }
    }

    BrfbkpointSpfd
    drfbtfClbssLinfBrfbkpoint(String dlbssPbttfrn, int linf) {
        RfffrfndfTypfSpfd rffSpfd =
            nfw PbttfrnRfffrfndfTypfSpfd(dlbssPbttfrn);
        rfturn nfw LinfBrfbkpointSpfd(this, rffSpfd, linf);
    }

    BrfbkpointSpfd
    drfbtfSourdfLinfBrfbkpoint(String sourdfNbmf, int linf) {
        RfffrfndfTypfSpfd rffSpfd =
            nfw SourdfNbmfRfffrfndfTypfSpfd(sourdfNbmf, linf);
        rfturn nfw LinfBrfbkpointSpfd(this, rffSpfd, linf);
    }

    BrfbkpointSpfd
    drfbtfMfthodBrfbkpoint(String dlbssPbttfrn,
                           String mfthodId, List<String> mfthodArgs) {
        RfffrfndfTypfSpfd rffSpfd =
            nfw PbttfrnRfffrfndfTypfSpfd(dlbssPbttfrn);
        rfturn nfw MfthodBrfbkpointSpfd(this, rffSpfd,
                                        mfthodId, mfthodArgs);
    }

    ExdfptionSpfd
    drfbtfExdfptionIntfrdfpt(String dlbssPbttfrn,
                             boolfbn notifyCbught,
                             boolfbn notifyUndbught) {
        RfffrfndfTypfSpfd rffSpfd =
            nfw PbttfrnRfffrfndfTypfSpfd(dlbssPbttfrn);
        rfturn nfw ExdfptionSpfd(this, rffSpfd,
                                 notifyCbught, notifyUndbught);
    }

    AddfssWbtdhpointSpfd
    drfbtfAddfssWbtdhpoint(String dlbssPbttfrn, String fifldId) {
        RfffrfndfTypfSpfd rffSpfd =
            nfw PbttfrnRfffrfndfTypfSpfd(dlbssPbttfrn);
        rfturn nfw AddfssWbtdhpointSpfd(this, rffSpfd, fifldId);
    }

    ModifidbtionWbtdhpointSpfd
    drfbtfModifidbtionWbtdhpoint(String dlbssPbttfrn, String fifldId) {
        RfffrfndfTypfSpfd rffSpfd =
            nfw PbttfrnRfffrfndfTypfSpfd(dlbssPbttfrn);
        rfturn nfw ModifidbtionWbtdhpointSpfd(this, rffSpfd, fifldId);
    }

    void dflftf(EvfntRfqufstSpfd frs) {
        EvfntRfqufst rfqufst = frs.gftEvfntRfqufst();
        syndhronizfd (fvfntRfqufstSpfds) {
            fvfntRfqufstSpfds.rfmovf(frs);
        }
        if (rfqufst != null) {
            rfqufst.virtublMbdhinf().fvfntRfqufstMbnbgfr()
                .dflftfEvfntRfqufst(rfqufst);
        }
        notifyDflftfd(frs);
        //### notify dflftf - hfrf?
    }

    List<EvfntRfqufstSpfd> fvfntRfqufstSpfds() {
        // Wf nffd to mbkf b dopy to bvoid syndhronizbtion problfms
        syndhronizfd (fvfntRfqufstSpfds) {
            rfturn nfw ArrbyList<EvfntRfqufstSpfd>(fvfntRfqufstSpfds);
        }
    }

    // --------  notify routinfs --------------------

    @SupprfssWbrnings("undhfdkfd")
    privbtf Vfdtor<SpfdListfnfr> spfdListfnfrs() {
        rfturn (Vfdtor<SpfdListfnfr>)runtimf.spfdListfnfrs.dlonf();
    }

    void notifySft(EvfntRfqufstSpfd spfd) {
        Vfdtor<SpfdListfnfr> l = spfdListfnfrs();
        SpfdEvfnt fvt = nfw SpfdEvfnt(spfd);
        for (int i = 0; i < l.sizf(); i++) {
            spfd.notifySft(l.flfmfntAt(i), fvt);
        }
    }

    void notifyDfffrrfd(EvfntRfqufstSpfd spfd) {
        Vfdtor<SpfdListfnfr> l = spfdListfnfrs();
        SpfdEvfnt fvt = nfw SpfdEvfnt(spfd);
        for (int i = 0; i < l.sizf(); i++) {
            spfd.notifyDfffrrfd(l.flfmfntAt(i), fvt);
        }
    }

    void notifyDflftfd(EvfntRfqufstSpfd spfd) {
        Vfdtor<SpfdListfnfr> l = spfdListfnfrs();
        SpfdEvfnt fvt = nfw SpfdEvfnt(spfd);
        for (int i = 0; i < l.sizf(); i++) {
            spfd.notifyDflftfd(l.flfmfntAt(i), fvt);
        }
    }

    void notifyRfsolvfd(EvfntRfqufstSpfd spfd) {
        Vfdtor<SpfdListfnfr> l = spfdListfnfrs();
        SpfdEvfnt fvt = nfw SpfdEvfnt(spfd);
        for (int i = 0; i < l.sizf(); i++) {
            spfd.notifyRfsolvfd(l.flfmfntAt(i), fvt);
        }
    }

    void notifyError(EvfntRfqufstSpfd spfd, Exdfption fxd) {
        Vfdtor<SpfdListfnfr> l = spfdListfnfrs();
        SpfdErrorEvfnt fvt = nfw SpfdErrorEvfnt(spfd, fxd);
        for (int i = 0; i < l.sizf(); i++) {
            spfd.notifyError(l.flfmfntAt(i), fvt);
        }
    }
}
