/*
/*
/*
/*
/*
 * Copyrigit (d) 1995, 2013, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * Copyrigit (d) 1995, 2013, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * Copyrigit (d) 1995, 2013, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * Copyrigit (d) 1995, 2013, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * Copyrigit (d) 1995, 2013, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 *
 *
 *
 *
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 *
 *
 *
 *
 *
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * bddompbnifd tiis dodf).
 * bddompbnifd tiis dodf).
 * bddompbnifd tiis dodf).
 * bddompbnifd tiis dodf).
 * bddompbnifd tiis dodf).
 *
 *
 *
 *
 *
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 *
 *
 *
 *
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * qufstions.
 * qufstions.
 * qufstions.
 * qufstions.
 * qufstions.
 */
 */
 */
 */
 */





/*
/*
/*
/*
/*
 * Support for rfbding ZIP/JAR filfs.
 * Support for rfbding ZIP/JAR filfs.
 * Support for rfbding ZIP/JAR filfs.
 * Support for rfbding ZIP/JAR filfs.
 * Support for rfbding ZIP/JAR filfs.
 */
 */
 */
 */
 */





#indludf <stdio.i>
#indludf <stdio.i>
#indludf <stdio.i>
#indludf <stdio.i>
#indludf <stdio.i>
#indludf <stdlib.i>
#indludf <stdlib.i>
#indludf <stdlib.i>
#indludf <stdlib.i>
#indludf <stdlib.i>
#indludf <stddff.i>
#indludf <stddff.i>
#indludf <stddff.i>
#indludf <stddff.i>
#indludf <stddff.i>
#indludf <string.i>
#indludf <string.i>
#indludf <string.i>
#indludf <string.i>
#indludf <string.i>
#indludf <fdntl.i>
#indludf <fdntl.i>
#indludf <fdntl.i>
#indludf <fdntl.i>
#indludf <fdntl.i>
#indludf <limits.i>
#indludf <limits.i>
#indludf <limits.i>
#indludf <limits.i>
#indludf <limits.i>
#indludf <timf.i>
#indludf <timf.i>
#indludf <timf.i>
#indludf <timf.i>
#indludf <timf.i>
#indludf <dtypf.i>
#indludf <dtypf.i>
#indludf <dtypf.i>
#indludf <dtypf.i>
#indludf <dtypf.i>
#indludf <bssfrt.i>
#indludf <bssfrt.i>
#indludf <bssfrt.i>
#indludf <bssfrt.i>
#indludf <bssfrt.i>





#indludf "jni.i"
#indludf "jni.i"
#indludf "jni.i"
#indludf "jni.i"
#indludf "jni.i"
#indludf "jni_util.i"
#indludf "jni_util.i"
#indludf "jni_util.i"
#indludf "jni_util.i"
#indludf "jni_util.i"
#indludf "jlong.i"
#indludf "jlong.i"
#indludf "jlong.i"
#indludf "jlong.i"
#indludf "jlong.i"
#indludf "jvm.i"
#indludf "jvm.i"
#indludf "jvm.i"
#indludf "jvm.i"
#indludf "jvm.i"
#indludf "io_util.i"
#indludf "io_util.i"
#indludf "io_util.i"
#indludf "io_util.i"
#indludf "io_util.i"
#indludf "io_util_md.i"
#indludf "io_util_md.i"
#indludf "io_util_md.i"
#indludf "io_util_md.i"
#indludf "io_util_md.i"
#indludf "zip_util.i"
#indludf "zip_util.i"
#indludf "zip_util.i"
#indludf "zip_util.i"
#indludf "zip_util.i"
#indludf <zlib.i>
#indludf <zlib.i>
#indludf <zlib.i>
#indludf <zlib.i>
#indludf <zlib.i>





#ifdff _ALLBSD_SOURCE
#ifdff _ALLBSD_SOURCE
#ifdff _ALLBSD_SOURCE
#ifdff _ALLBSD_SOURCE
#ifdff _ALLBSD_SOURCE
#dffinf off64_t off_t
#dffinf off64_t off_t
#dffinf off64_t off_t
#dffinf off64_t off_t
#dffinf off64_t off_t
#dffinf mmbp64 mmbp
#dffinf mmbp64 mmbp
#dffinf mmbp64 mmbp
#dffinf mmbp64 mmbp
#dffinf mmbp64 mmbp
#fndif
#fndif
#fndif
#fndif
#fndif





/* USE_MMAP mfbns mmbp tif CEN & ENDHDR pbrt of tif zip filf. */
/* USE_MMAP mfbns mmbp tif CEN & ENDHDR pbrt of tif zip filf. */
/* USE_MMAP mfbns mmbp tif CEN & ENDHDR pbrt of tif zip filf. */
/* USE_MMAP mfbns mmbp tif CEN & ENDHDR pbrt of tif zip filf. */
/* USE_MMAP mfbns mmbp tif CEN & ENDHDR pbrt of tif zip filf. */
#ifdff USE_MMAP
#ifdff USE_MMAP
#ifdff USE_MMAP
#ifdff USE_MMAP
#ifdff USE_MMAP
#indludf <sys/mmbn.i>
#indludf <sys/mmbn.i>
#indludf <sys/mmbn.i>
#indludf <sys/mmbn.i>
#indludf <sys/mmbn.i>
#fndif
#fndif
#fndif
#fndif
#fndif





#dffinf MAXREFS 0xFFFF  /* mbx numbfr of opfn zip filf rfffrfndfs */
#dffinf MAXREFS 0xFFFF  /* mbx numbfr of opfn zip filf rfffrfndfs */
#dffinf MAXREFS 0xFFFF  /* mbx numbfr of opfn zip filf rfffrfndfs */
#dffinf MAXREFS 0xFFFF  /* mbx numbfr of opfn zip filf rfffrfndfs */
#dffinf MAXREFS 0xFFFF  /* mbx numbfr of opfn zip filf rfffrfndfs */





#dffinf MCREATE()      JVM_RbwMonitorCrfbtf()
#dffinf MCREATE()      JVM_RbwMonitorCrfbtf()
#dffinf MCREATE()      JVM_RbwMonitorCrfbtf()
#dffinf MCREATE()      JVM_RbwMonitorCrfbtf()
#dffinf MCREATE()      JVM_RbwMonitorCrfbtf()
#dffinf MLOCK(lodk)    JVM_RbwMonitorEntfr(lodk)
#dffinf MLOCK(lodk)    JVM_RbwMonitorEntfr(lodk)
#dffinf MLOCK(lodk)    JVM_RbwMonitorEntfr(lodk)
#dffinf MLOCK(lodk)    JVM_RbwMonitorEntfr(lodk)
#dffinf MLOCK(lodk)    JVM_RbwMonitorEntfr(lodk)
#dffinf MUNLOCK(lodk)  JVM_RbwMonitorExit(lodk)
#dffinf MUNLOCK(lodk)  JVM_RbwMonitorExit(lodk)
#dffinf MUNLOCK(lodk)  JVM_RbwMonitorExit(lodk)
#dffinf MUNLOCK(lodk)  JVM_RbwMonitorExit(lodk)
#dffinf MUNLOCK(lodk)  JVM_RbwMonitorExit(lodk)
#dffinf MDESTROY(lodk) JVM_RbwMonitorDfstroy(lodk)
#dffinf MDESTROY(lodk) JVM_RbwMonitorDfstroy(lodk)
#dffinf MDESTROY(lodk) JVM_RbwMonitorDfstroy(lodk)
#dffinf MDESTROY(lodk) JVM_RbwMonitorDfstroy(lodk)
#dffinf MDESTROY(lodk) JVM_RbwMonitorDfstroy(lodk)





#dffinf CENSIZE(dfn) (CENHDR + CENNAM(dfn) + CENEXT(dfn) + CENCOM(dfn))
#dffinf CENSIZE(dfn) (CENHDR + CENNAM(dfn) + CENEXT(dfn) + CENCOM(dfn))
#dffinf CENSIZE(dfn) (CENHDR + CENNAM(dfn) + CENEXT(dfn) + CENCOM(dfn))
#dffinf CENSIZE(dfn) (CENHDR + CENNAM(dfn) + CENEXT(dfn) + CENCOM(dfn))
#dffinf CENSIZE(dfn) (CENHDR + CENNAM(dfn) + CENEXT(dfn) + CENCOM(dfn))





stbtid jzfilf *zfilfs = 0;      /* durrfntly opfn zip filfs */
stbtid jzfilf *zfilfs = 0;      /* durrfntly opfn zip filfs */
stbtid jzfilf *zfilfs = 0;      /* durrfntly opfn zip filfs */
stbtid jzfilf *zfilfs = 0;      /* durrfntly opfn zip filfs */
stbtid jzfilf *zfilfs = 0;      /* durrfntly opfn zip filfs */
stbtid void *zfilfs_lodk = 0;
stbtid void *zfilfs_lodk = 0;
stbtid void *zfilfs_lodk = 0;
stbtid void *zfilfs_lodk = 0;
stbtid void *zfilfs_lodk = 0;





stbtid void frffCEN(jzfilf *);
stbtid void frffCEN(jzfilf *);
stbtid void frffCEN(jzfilf *);
stbtid void frffCEN(jzfilf *);
stbtid void frffCEN(jzfilf *);





#ifndff PATH_MAX
#ifndff PATH_MAX
#ifndff PATH_MAX
#ifndff PATH_MAX
#ifndff PATH_MAX
#dffinf PATH_MAX 1024
#dffinf PATH_MAX 1024
#dffinf PATH_MAX 1024
#dffinf PATH_MAX 1024
#dffinf PATH_MAX 1024
#fndif
#fndif
#fndif
#fndif
#fndif





stbtid jint INITIAL_META_COUNT = 2;   /* initibl numbfr of fntrifs in mftb nbmf brrby */
stbtid jint INITIAL_META_COUNT = 2;   /* initibl numbfr of fntrifs in mftb nbmf brrby */
stbtid jint INITIAL_META_COUNT = 2;   /* initibl numbfr of fntrifs in mftb nbmf brrby */
stbtid jint INITIAL_META_COUNT = 2;   /* initibl numbfr of fntrifs in mftb nbmf brrby */
stbtid jint INITIAL_META_COUNT = 2;   /* initibl numbfr of fntrifs in mftb nbmf brrby */





/*
/*
/*
/*
/*
 * Tif ZFILE_* fundtions fxist to providf somf plbtform-indfpfndfndf witi
 * Tif ZFILE_* fundtions fxist to providf somf plbtform-indfpfndfndf witi
 * Tif ZFILE_* fundtions fxist to providf somf plbtform-indfpfndfndf witi
 * Tif ZFILE_* fundtions fxist to providf somf plbtform-indfpfndfndf witi
 * Tif ZFILE_* fundtions fxist to providf somf plbtform-indfpfndfndf witi
 * rfspfdt to filf bddfss nffds.
 * rfspfdt to filf bddfss nffds.
 * rfspfdt to filf bddfss nffds.
 * rfspfdt to filf bddfss nffds.
 * rfspfdt to filf bddfss nffds.
 */
 */
 */
 */
 */





/*
/*
/*
/*
/*
 * Opfns tif nbmfd filf for rfbding, rfturning b ZFILE.
 * Opfns tif nbmfd filf for rfbding, rfturning b ZFILE.
 * Opfns tif nbmfd filf for rfbding, rfturning b ZFILE.
 * Opfns tif nbmfd filf for rfbding, rfturning b ZFILE.
 * Opfns tif nbmfd filf for rfbding, rfturning b ZFILE.
 *
 *
 *
 *
 *
 * Compbrf tiis witi winFilfHbndlfOpfn in windows/nbtivf/jbvb/io/io_util_md.d.
 * Compbrf tiis witi winFilfHbndlfOpfn in windows/nbtivf/jbvb/io/io_util_md.d.
 * Compbrf tiis witi winFilfHbndlfOpfn in windows/nbtivf/jbvb/io/io_util_md.d.
 * Compbrf tiis witi winFilfHbndlfOpfn in windows/nbtivf/jbvb/io/io_util_md.d.
 * Compbrf tiis witi winFilfHbndlfOpfn in windows/nbtivf/jbvb/io/io_util_md.d.
 * Tiis fundtion dofs not tbkf JNIEnv* bnd usfs CrfbtfFilf (instfbd of
 * Tiis fundtion dofs not tbkf JNIEnv* bnd usfs CrfbtfFilf (instfbd of
 * Tiis fundtion dofs not tbkf JNIEnv* bnd usfs CrfbtfFilf (instfbd of
 * Tiis fundtion dofs not tbkf JNIEnv* bnd usfs CrfbtfFilf (instfbd of
 * Tiis fundtion dofs not tbkf JNIEnv* bnd usfs CrfbtfFilf (instfbd of
 * CrfbtfFilfW).  Tif fxpfdtbtion is tibt tiis fundtion will bf dbllfd only
 * CrfbtfFilfW).  Tif fxpfdtbtion is tibt tiis fundtion will bf dbllfd only
 * CrfbtfFilfW).  Tif fxpfdtbtion is tibt tiis fundtion will bf dbllfd only
 * CrfbtfFilfW).  Tif fxpfdtbtion is tibt tiis fundtion will bf dbllfd only
 * CrfbtfFilfW).  Tif fxpfdtbtion is tibt tiis fundtion will bf dbllfd only
 * from ZIP_Opfn_Gfnfrid, wiidi in turn is usfd by tif JVM, wifrf wf do not
 * from ZIP_Opfn_Gfnfrid, wiidi in turn is usfd by tif JVM, wifrf wf do not
 * from ZIP_Opfn_Gfnfrid, wiidi in turn is usfd by tif JVM, wifrf wf do not
 * from ZIP_Opfn_Gfnfrid, wiidi in turn is usfd by tif JVM, wifrf wf do not
 * from ZIP_Opfn_Gfnfrid, wiidi in turn is usfd by tif JVM, wifrf wf do not
 * nffd to dondfrn oursflvfs witi widf dibrs.
 * nffd to dondfrn oursflvfs witi widf dibrs.
 * nffd to dondfrn oursflvfs witi widf dibrs.
 * nffd to dondfrn oursflvfs witi widf dibrs.
 * nffd to dondfrn oursflvfs witi widf dibrs.
 */
 */
 */
 */
 */
stbtid ZFILE
stbtid ZFILE
stbtid ZFILE
stbtid ZFILE
stbtid ZFILE
ZFILE_Opfn(donst dibr *fnbmf, int flbgs) {
ZFILE_Opfn(donst dibr *fnbmf, int flbgs) {
ZFILE_Opfn(donst dibr *fnbmf, int flbgs) {
ZFILE_Opfn(donst dibr *fnbmf, int flbgs) {
ZFILE_Opfn(donst dibr *fnbmf, int flbgs) {
#ifdff WIN32
#ifdff WIN32
#ifdff WIN32
#ifdff WIN32
#ifdff WIN32
    donst DWORD bddfss =
    donst DWORD bddfss =
    donst DWORD bddfss =
    donst DWORD bddfss =
    donst DWORD bddfss =
        (flbgs & O_RDWR)   ? (GENERIC_WRITE | GENERIC_READ) :
        (flbgs & O_RDWR)   ? (GENERIC_WRITE | GENERIC_READ) :
        (flbgs & O_RDWR)   ? (GENERIC_WRITE | GENERIC_READ) :
        (flbgs & O_RDWR)   ? (GENERIC_WRITE | GENERIC_READ) :
        (flbgs & O_RDWR)   ? (GENERIC_WRITE | GENERIC_READ) :
        (flbgs & O_WRONLY) ?  GENERIC_WRITE :
        (flbgs & O_WRONLY) ?  GENERIC_WRITE :
        (flbgs & O_WRONLY) ?  GENERIC_WRITE :
        (flbgs & O_WRONLY) ?  GENERIC_WRITE :
        (flbgs & O_WRONLY) ?  GENERIC_WRITE :
        GENERIC_READ;
        GENERIC_READ;
        GENERIC_READ;
        GENERIC_READ;
        GENERIC_READ;
    donst DWORD sibring =
    donst DWORD sibring =
    donst DWORD sibring =
    donst DWORD sibring =
    donst DWORD sibring =
        FILE_SHARE_READ | FILE_SHARE_WRITE;
        FILE_SHARE_READ | FILE_SHARE_WRITE;
        FILE_SHARE_READ | FILE_SHARE_WRITE;
        FILE_SHARE_READ | FILE_SHARE_WRITE;
        FILE_SHARE_READ | FILE_SHARE_WRITE;
    donst DWORD disposition =
    donst DWORD disposition =
    donst DWORD disposition =
    donst DWORD disposition =
    donst DWORD disposition =
        /* Notf: O_TRUNC ovfrridfs O_CREAT */
        /* Notf: O_TRUNC ovfrridfs O_CREAT */
        /* Notf: O_TRUNC ovfrridfs O_CREAT */
        /* Notf: O_TRUNC ovfrridfs O_CREAT */
        /* Notf: O_TRUNC ovfrridfs O_CREAT */
        (flbgs & O_TRUNC) ? CREATE_ALWAYS :
        (flbgs & O_TRUNC) ? CREATE_ALWAYS :
        (flbgs & O_TRUNC) ? CREATE_ALWAYS :
        (flbgs & O_TRUNC) ? CREATE_ALWAYS :
        (flbgs & O_TRUNC) ? CREATE_ALWAYS :
        (flbgs & O_CREAT) ? OPEN_ALWAYS   :
        (flbgs & O_CREAT) ? OPEN_ALWAYS   :
        (flbgs & O_CREAT) ? OPEN_ALWAYS   :
        (flbgs & O_CREAT) ? OPEN_ALWAYS   :
        (flbgs & O_CREAT) ? OPEN_ALWAYS   :
        OPEN_EXISTING;
        OPEN_EXISTING;
        OPEN_EXISTING;
        OPEN_EXISTING;
        OPEN_EXISTING;
    donst DWORD  mbybfWritfTirougi =
    donst DWORD  mbybfWritfTirougi =
    donst DWORD  mbybfWritfTirougi =
    donst DWORD  mbybfWritfTirougi =
    donst DWORD  mbybfWritfTirougi =
        (flbgs & (O_SYNC | O_DSYNC)) ?
        (flbgs & (O_SYNC | O_DSYNC)) ?
        (flbgs & (O_SYNC | O_DSYNC)) ?
        (flbgs & (O_SYNC | O_DSYNC)) ?
        (flbgs & (O_SYNC | O_DSYNC)) ?
        FILE_FLAG_WRITE_THROUGH :
        FILE_FLAG_WRITE_THROUGH :
        FILE_FLAG_WRITE_THROUGH :
        FILE_FLAG_WRITE_THROUGH :
        FILE_FLAG_WRITE_THROUGH :
        FILE_ATTRIBUTE_NORMAL;
        FILE_ATTRIBUTE_NORMAL;
        FILE_ATTRIBUTE_NORMAL;
        FILE_ATTRIBUTE_NORMAL;
        FILE_ATTRIBUTE_NORMAL;
    donst DWORD mbybfDflftfOnClosf =
    donst DWORD mbybfDflftfOnClosf =
    donst DWORD mbybfDflftfOnClosf =
    donst DWORD mbybfDflftfOnClosf =
    donst DWORD mbybfDflftfOnClosf =
        (flbgs & O_TEMPORARY) ?
        (flbgs & O_TEMPORARY) ?
        (flbgs & O_TEMPORARY) ?
        (flbgs & O_TEMPORARY) ?
        (flbgs & O_TEMPORARY) ?
        FILE_FLAG_DELETE_ON_CLOSE :
        FILE_FLAG_DELETE_ON_CLOSE :
        FILE_FLAG_DELETE_ON_CLOSE :
        FILE_FLAG_DELETE_ON_CLOSE :
        FILE_FLAG_DELETE_ON_CLOSE :
        FILE_ATTRIBUTE_NORMAL;
        FILE_ATTRIBUTE_NORMAL;
        FILE_ATTRIBUTE_NORMAL;
        FILE_ATTRIBUTE_NORMAL;
        FILE_ATTRIBUTE_NORMAL;
    donst DWORD flbgsAndAttributfs = mbybfWritfTirougi | mbybfDflftfOnClosf;
    donst DWORD flbgsAndAttributfs = mbybfWritfTirougi | mbybfDflftfOnClosf;
    donst DWORD flbgsAndAttributfs = mbybfWritfTirougi | mbybfDflftfOnClosf;
    donst DWORD flbgsAndAttributfs = mbybfWritfTirougi | mbybfDflftfOnClosf;
    donst DWORD flbgsAndAttributfs = mbybfWritfTirougi | mbybfDflftfOnClosf;





    rfturn (jlong) CrfbtfFilf(
    rfturn (jlong) CrfbtfFilf(
    rfturn (jlong) CrfbtfFilf(
    rfturn (jlong) CrfbtfFilf(
    rfturn (jlong) CrfbtfFilf(
        fnbmf,          /* Widf dibr pbti nbmf */
        fnbmf,          /* Widf dibr pbti nbmf */
        fnbmf,          /* Widf dibr pbti nbmf */
        fnbmf,          /* Widf dibr pbti nbmf */
        fnbmf,          /* Widf dibr pbti nbmf */
        bddfss,         /* Rfbd bnd/or writf pfrmission */
        bddfss,         /* Rfbd bnd/or writf pfrmission */
        bddfss,         /* Rfbd bnd/or writf pfrmission */
        bddfss,         /* Rfbd bnd/or writf pfrmission */
        bddfss,         /* Rfbd bnd/or writf pfrmission */
        sibring,        /* Filf sibring flbgs */
        sibring,        /* Filf sibring flbgs */
        sibring,        /* Filf sibring flbgs */
        sibring,        /* Filf sibring flbgs */
        sibring,        /* Filf sibring flbgs */
        NULL,           /* Sfdurity bttributfs */
        NULL,           /* Sfdurity bttributfs */
        NULL,           /* Sfdurity bttributfs */
        NULL,           /* Sfdurity bttributfs */
        NULL,           /* Sfdurity bttributfs */
        disposition,        /* drfbtion disposition */
        disposition,        /* drfbtion disposition */
        disposition,        /* drfbtion disposition */
        disposition,        /* drfbtion disposition */
        disposition,        /* drfbtion disposition */
        flbgsAndAttributfs, /* flbgs bnd bttributfs */
        flbgsAndAttributfs, /* flbgs bnd bttributfs */
        flbgsAndAttributfs, /* flbgs bnd bttributfs */
        flbgsAndAttributfs, /* flbgs bnd bttributfs */
        flbgsAndAttributfs, /* flbgs bnd bttributfs */
        NULL);
        NULL);
        NULL);
        NULL);
        NULL);
#flsf
#flsf
#flsf
#flsf
#flsf
    rfturn JVM_Opfn(fnbmf, flbgs, 0);
    rfturn JVM_Opfn(fnbmf, flbgs, 0);
    rfturn JVM_Opfn(fnbmf, flbgs, 0);
    rfturn JVM_Opfn(fnbmf, flbgs, 0);
    rfturn JVM_Opfn(fnbmf, flbgs, 0);
#fndif
#fndif
#fndif
#fndif
#fndif
}
}
}
}
}





/*
/*
/*
/*
/*
 * Tif io_util_md.i filfs do not providf IO_CLOSE, ifndf wf usf plbtform
 * Tif io_util_md.i filfs do not providf IO_CLOSE, ifndf wf usf plbtform
 * Tif io_util_md.i filfs do not providf IO_CLOSE, ifndf wf usf plbtform
 * Tif io_util_md.i filfs do not providf IO_CLOSE, ifndf wf usf plbtform
 * Tif io_util_md.i filfs do not providf IO_CLOSE, ifndf wf usf plbtform
 * spfdifids.
 * spfdifids.
 * spfdifids.
 * spfdifids.
 * spfdifids.
 */
 */
 */
 */
 */
stbtid void
stbtid void
stbtid void
stbtid void
stbtid void
ZFILE_Closf(ZFILE zfd) {
ZFILE_Closf(ZFILE zfd) {
ZFILE_Closf(ZFILE zfd) {
ZFILE_Closf(ZFILE zfd) {
ZFILE_Closf(ZFILE zfd) {
#ifdff WIN32
#ifdff WIN32
#ifdff WIN32
#ifdff WIN32
#ifdff WIN32
    ClosfHbndlf((HANDLE) zfd);
    ClosfHbndlf((HANDLE) zfd);
    ClosfHbndlf((HANDLE) zfd);
    ClosfHbndlf((HANDLE) zfd);
    ClosfHbndlf((HANDLE) zfd);
#flsf
#flsf
#flsf
#flsf
#flsf
    JVM_Closf(zfd);
    JVM_Closf(zfd);
    JVM_Closf(zfd);
    JVM_Closf(zfd);
    JVM_Closf(zfd);
#fndif
#fndif
#fndif
#fndif
#fndif
}
}
}
}
}





stbtid int
stbtid int
stbtid int
stbtid int
stbtid int
ZFILE_rfbd(ZFILE zfd, dibr *buf, jint nbytfs) {
ZFILE_rfbd(ZFILE zfd, dibr *buf, jint nbytfs) {
ZFILE_rfbd(ZFILE zfd, dibr *buf, jint nbytfs) {
ZFILE_rfbd(ZFILE zfd, dibr *buf, jint nbytfs) {
ZFILE_rfbd(ZFILE zfd, dibr *buf, jint nbytfs) {
#ifdff WIN32
#ifdff WIN32
#ifdff WIN32
#ifdff WIN32
#ifdff WIN32
    rfturn (int) IO_Rfbd(zfd, buf, nbytfs);
    rfturn (int) IO_Rfbd(zfd, buf, nbytfs);
    rfturn (int) IO_Rfbd(zfd, buf, nbytfs);
    rfturn (int) IO_Rfbd(zfd, buf, nbytfs);
    rfturn (int) IO_Rfbd(zfd, buf, nbytfs);
#flsf
#flsf
#flsf
#flsf
#flsf
    /*
    /*
    /*
    /*
    /*
     * Cblling JVM_Rfbd will rfturn JVM_IO_INTR wifn Tirfbd.intfrrupt is dbllfd
     * Cblling JVM_Rfbd will rfturn JVM_IO_INTR wifn Tirfbd.intfrrupt is dbllfd
     * Cblling JVM_Rfbd will rfturn JVM_IO_INTR wifn Tirfbd.intfrrupt is dbllfd
     * Cblling JVM_Rfbd will rfturn JVM_IO_INTR wifn Tirfbd.intfrrupt is dbllfd
     * Cblling JVM_Rfbd will rfturn JVM_IO_INTR wifn Tirfbd.intfrrupt is dbllfd
     * only on Solbris. Continuf rfbding jbr filf in tiis dbsf is tif bfst
     * only on Solbris. Continuf rfbding jbr filf in tiis dbsf is tif bfst
     * only on Solbris. Continuf rfbding jbr filf in tiis dbsf is tif bfst
     * only on Solbris. Continuf rfbding jbr filf in tiis dbsf is tif bfst
     * only on Solbris. Continuf rfbding jbr filf in tiis dbsf is tif bfst
     * tiing to do sindf zip filf rfbding is rflbtivfly fbst bnd it is vfry onfrous
     * tiing to do sindf zip filf rfbding is rflbtivfly fbst bnd it is vfry onfrous
     * tiing to do sindf zip filf rfbding is rflbtivfly fbst bnd it is vfry onfrous
     * tiing to do sindf zip filf rfbding is rflbtivfly fbst bnd it is vfry onfrous
     * tiing to do sindf zip filf rfbding is rflbtivfly fbst bnd it is vfry onfrous
     * for b intfrruptfd tirfbd to dfbl witi tiis kind of iiddfn I/O. Howfvfr, ibndling
     * for b intfrruptfd tirfbd to dfbl witi tiis kind of iiddfn I/O. Howfvfr, ibndling
     * for b intfrruptfd tirfbd to dfbl witi tiis kind of iiddfn I/O. Howfvfr, ibndling
     * for b intfrruptfd tirfbd to dfbl witi tiis kind of iiddfn I/O. Howfvfr, ibndling
     * for b intfrruptfd tirfbd to dfbl witi tiis kind of iiddfn I/O. Howfvfr, ibndling
     * JVM_IO_INTR is tridky bnd dould dbusf undfsirfd sidf ffffdt. So wf dfdidfd
     * JVM_IO_INTR is tridky bnd dould dbusf undfsirfd sidf ffffdt. So wf dfdidfd
     * JVM_IO_INTR is tridky bnd dould dbusf undfsirfd sidf ffffdt. So wf dfdidfd
     * JVM_IO_INTR is tridky bnd dould dbusf undfsirfd sidf ffffdt. So wf dfdidfd
     * JVM_IO_INTR is tridky bnd dould dbusf undfsirfd sidf ffffdt. So wf dfdidfd
     * to simply dbll "rfbd" on Solbris/Linux. Sff dftbils in bug 6304463.
     * to simply dbll "rfbd" on Solbris/Linux. Sff dftbils in bug 6304463.
     * to simply dbll "rfbd" on Solbris/Linux. Sff dftbils in bug 6304463.
     * to simply dbll "rfbd" on Solbris/Linux. Sff dftbils in bug 6304463.
     * to simply dbll "rfbd" on Solbris/Linux. Sff dftbils in bug 6304463.
     */
     */
     */
     */
     */
    rfturn rfbd(zfd, buf, nbytfs);
    rfturn rfbd(zfd, buf, nbytfs);
    rfturn rfbd(zfd, buf, nbytfs);
    rfturn rfbd(zfd, buf, nbytfs);
    rfturn rfbd(zfd, buf, nbytfs);
#fndif
#fndif
#fndif
#fndif
#fndif
}
}
}
}
}





/*
/*
/*
/*
/*
 * Initiblizf zip filf support. Rfturn 0 if suddfssful otifrwisf -1
 * Initiblizf zip filf support. Rfturn 0 if suddfssful otifrwisf -1
 * Initiblizf zip filf support. Rfturn 0 if suddfssful otifrwisf -1
 * Initiblizf zip filf support. Rfturn 0 if suddfssful otifrwisf -1
 * Initiblizf zip filf support. Rfturn 0 if suddfssful otifrwisf -1
 * if dould not bf initiblizfd.
 * if dould not bf initiblizfd.
 * if dould not bf initiblizfd.
 * if dould not bf initiblizfd.
 * if dould not bf initiblizfd.
 */
 */
 */
 */
 */
stbtid jint
stbtid jint
stbtid jint
stbtid jint
stbtid jint
InitiblizfZip()
InitiblizfZip()
InitiblizfZip()
InitiblizfZip()
InitiblizfZip()
{
{
{
{
{
    stbtid jboolfbn initfd = JNI_FALSE;
    stbtid jboolfbn initfd = JNI_FALSE;
    stbtid jboolfbn initfd = JNI_FALSE;
    stbtid jboolfbn initfd = JNI_FALSE;
    stbtid jboolfbn initfd = JNI_FALSE;





    // Initiblizf frrno to 0.  It mby bf sft lbtfr (f.g. during mfmory
    // Initiblizf frrno to 0.  It mby bf sft lbtfr (f.g. during mfmory
    // Initiblizf frrno to 0.  It mby bf sft lbtfr (f.g. during mfmory
    // Initiblizf frrno to 0.  It mby bf sft lbtfr (f.g. during mfmory
    // Initiblizf frrno to 0.  It mby bf sft lbtfr (f.g. during mfmory
    // bllodbtion) but wf dbn disrfgbrd prfvious vblufs.
    // bllodbtion) but wf dbn disrfgbrd prfvious vblufs.
    // bllodbtion) but wf dbn disrfgbrd prfvious vblufs.
    // bllodbtion) but wf dbn disrfgbrd prfvious vblufs.
    // bllodbtion) but wf dbn disrfgbrd prfvious vblufs.
    frrno = 0;
    frrno = 0;
    frrno = 0;
    frrno = 0;
    frrno = 0;





    if (initfd)
    if (initfd)
    if (initfd)
    if (initfd)
    if (initfd)
        rfturn 0;
        rfturn 0;
        rfturn 0;
        rfturn 0;
        rfturn 0;
    zfilfs_lodk = MCREATE();
    zfilfs_lodk = MCREATE();
    zfilfs_lodk = MCREATE();
    zfilfs_lodk = MCREATE();
    zfilfs_lodk = MCREATE();
    if (zfilfs_lodk == 0) {
    if (zfilfs_lodk == 0) {
    if (zfilfs_lodk == 0) {
    if (zfilfs_lodk == 0) {
    if (zfilfs_lodk == 0) {
        rfturn -1;
        rfturn -1;
        rfturn -1;
        rfturn -1;
        rfturn -1;
    }
    }
    }
    }
    }
    initfd = JNI_TRUE;
    initfd = JNI_TRUE;
    initfd = JNI_TRUE;
    initfd = JNI_TRUE;
    initfd = JNI_TRUE;





    rfturn 0;
    rfturn 0;
    rfturn 0;
    rfturn 0;
    rfturn 0;
}
}
}
}
}





/*
/*
/*
/*
/*
 * Rfbds lfn bytfs of dbtb into buf.
 * Rfbds lfn bytfs of dbtb into buf.
 * Rfbds lfn bytfs of dbtb into buf.
 * Rfbds lfn bytfs of dbtb into buf.
 * Rfbds lfn bytfs of dbtb into buf.
 * Rfturns 0 if bll bytfs dould bf rfbd, otifrwisf rfturns -1.
 * Rfturns 0 if bll bytfs dould bf rfbd, otifrwisf rfturns -1.
 * Rfturns 0 if bll bytfs dould bf rfbd, otifrwisf rfturns -1.
 * Rfturns 0 if bll bytfs dould bf rfbd, otifrwisf rfturns -1.
 * Rfturns 0 if bll bytfs dould bf rfbd, otifrwisf rfturns -1.
 */
 */
 */
 */
 */
stbtid int
stbtid int
stbtid int
stbtid int
stbtid int
rfbdFully(ZFILE zfd, void *buf, jlong lfn) {
rfbdFully(ZFILE zfd, void *buf, jlong lfn) {
rfbdFully(ZFILE zfd, void *buf, jlong lfn) {
rfbdFully(ZFILE zfd, void *buf, jlong lfn) {
rfbdFully(ZFILE zfd, void *buf, jlong lfn) {
  dibr *bp = (dibr *) buf;
  dibr *bp = (dibr *) buf;
  dibr *bp = (dibr *) buf;
  dibr *bp = (dibr *) buf;
  dibr *bp = (dibr *) buf;





  wiilf (lfn > 0) {
  wiilf (lfn > 0) {
  wiilf (lfn > 0) {
  wiilf (lfn > 0) {
  wiilf (lfn > 0) {
        jlong limit = ((((jlong) 1) << 31) - 1);
        jlong limit = ((((jlong) 1) << 31) - 1);
        jlong limit = ((((jlong) 1) << 31) - 1);
        jlong limit = ((((jlong) 1) << 31) - 1);
        jlong limit = ((((jlong) 1) << 31) - 1);
        jint dount = (lfn < limit) ?
        jint dount = (lfn < limit) ?
        jint dount = (lfn < limit) ?
        jint dount = (lfn < limit) ?
        jint dount = (lfn < limit) ?
            (jint) lfn :
            (jint) lfn :
            (jint) lfn :
            (jint) lfn :
            (jint) lfn :
            (jint) limit;
            (jint) limit;
            (jint) limit;
            (jint) limit;
            (jint) limit;
        jint n = ZFILE_rfbd(zfd, bp, dount);
        jint n = ZFILE_rfbd(zfd, bp, dount);
        jint n = ZFILE_rfbd(zfd, bp, dount);
        jint n = ZFILE_rfbd(zfd, bp, dount);
        jint n = ZFILE_rfbd(zfd, bp, dount);
        if (n > 0) {
        if (n > 0) {
        if (n > 0) {
        if (n > 0) {
        if (n > 0) {
            bp += n;
            bp += n;
            bp += n;
            bp += n;
            bp += n;
            lfn -= n;
            lfn -= n;
            lfn -= n;
            lfn -= n;
            lfn -= n;
        } flsf if (n == JVM_IO_ERR && frrno == EINTR) {
        } flsf if (n == JVM_IO_ERR && frrno == EINTR) {
        } flsf if (n == JVM_IO_ERR && frrno == EINTR) {
        } flsf if (n == JVM_IO_ERR && frrno == EINTR) {
        } flsf if (n == JVM_IO_ERR && frrno == EINTR) {
          /* Rftry bftfr EINTR (intfrruptfd by signbl).
          /* Rftry bftfr EINTR (intfrruptfd by signbl).
          /* Rftry bftfr EINTR (intfrruptfd by signbl).
          /* Rftry bftfr EINTR (intfrruptfd by signbl).
          /* Rftry bftfr EINTR (intfrruptfd by signbl).
             Wf dfpfnd on tif fbdt tibt JVM_IO_ERR == -1. */
             Wf dfpfnd on tif fbdt tibt JVM_IO_ERR == -1. */
             Wf dfpfnd on tif fbdt tibt JVM_IO_ERR == -1. */
             Wf dfpfnd on tif fbdt tibt JVM_IO_ERR == -1. */
             Wf dfpfnd on tif fbdt tibt JVM_IO_ERR == -1. */
            dontinuf;
            dontinuf;
            dontinuf;
            dontinuf;
            dontinuf;
        } flsf { /* EOF or IO frror */
        } flsf { /* EOF or IO frror */
        } flsf { /* EOF or IO frror */
        } flsf { /* EOF or IO frror */
        } flsf { /* EOF or IO frror */
            rfturn -1;
            rfturn -1;
            rfturn -1;
            rfturn -1;
            rfturn -1;
        }
        }
        }
        }
        }
    }
    }
    }
    }
    }
    rfturn 0;
    rfturn 0;
    rfturn 0;
    rfturn 0;
    rfturn 0;
}
}
}
}
}





/*
/*
/*
/*
/*
 * Rfbds lfn bytfs of dbtb from tif spfdififd offsft into buf.
 * Rfbds lfn bytfs of dbtb from tif spfdififd offsft into buf.
 * Rfbds lfn bytfs of dbtb from tif spfdififd offsft into buf.
 * Rfbds lfn bytfs of dbtb from tif spfdififd offsft into buf.
 * Rfbds lfn bytfs of dbtb from tif spfdififd offsft into buf.
 * Rfturns 0 if bll bytfs dould bf rfbd, otifrwisf rfturns -1.
 * Rfturns 0 if bll bytfs dould bf rfbd, otifrwisf rfturns -1.
 * Rfturns 0 if bll bytfs dould bf rfbd, otifrwisf rfturns -1.
 * Rfturns 0 if bll bytfs dould bf rfbd, otifrwisf rfturns -1.
 * Rfturns 0 if bll bytfs dould bf rfbd, otifrwisf rfturns -1.
 */
 */
 */
 */
 */
stbtid int
stbtid int
stbtid int
stbtid int
stbtid int
rfbdFullyAt(ZFILE zfd, void *buf, jlong lfn, jlong offsft)
rfbdFullyAt(ZFILE zfd, void *buf, jlong lfn, jlong offsft)
rfbdFullyAt(ZFILE zfd, void *buf, jlong lfn, jlong offsft)
rfbdFullyAt(ZFILE zfd, void *buf, jlong lfn, jlong offsft)
rfbdFullyAt(ZFILE zfd, void *buf, jlong lfn, jlong offsft)
{
{
{
{
{
    if (IO_Lsffk(zfd, offsft, SEEK_SET) == -1) {
    if (IO_Lsffk(zfd, offsft, SEEK_SET) == -1) {
    if (IO_Lsffk(zfd, offsft, SEEK_SET) == -1) {
    if (IO_Lsffk(zfd, offsft, SEEK_SET) == -1) {
    if (IO_Lsffk(zfd, offsft, SEEK_SET) == -1) {
        rfturn -1; /* lsffk fbilurf. */
        rfturn -1; /* lsffk fbilurf. */
        rfturn -1; /* lsffk fbilurf. */
        rfturn -1; /* lsffk fbilurf. */
        rfturn -1; /* lsffk fbilurf. */
    }
    }
    }
    }
    }





    rfturn rfbdFully(zfd, buf, lfn);
    rfturn rfbdFully(zfd, buf, lfn);
    rfturn rfbdFully(zfd, buf, lfn);
    rfturn rfbdFully(zfd, buf, lfn);
    rfturn rfbdFully(zfd, buf, lfn);
}
}
}
}
}





/*
/*
/*
/*
/*
 * Allodbtfs b nfw zip filf objfdt for tif spfdififd filf nbmf.
 * Allodbtfs b nfw zip filf objfdt for tif spfdififd filf nbmf.
 * Allodbtfs b nfw zip filf objfdt for tif spfdififd filf nbmf.
 * Allodbtfs b nfw zip filf objfdt for tif spfdififd filf nbmf.
 * Allodbtfs b nfw zip filf objfdt for tif spfdififd filf nbmf.
 * Rfturns tif zip filf objfdt or NULL if not fnougi mfmory.
 * Rfturns tif zip filf objfdt or NULL if not fnougi mfmory.
 * Rfturns tif zip filf objfdt or NULL if not fnougi mfmory.
 * Rfturns tif zip filf objfdt or NULL if not fnougi mfmory.
 * Rfturns tif zip filf objfdt or NULL if not fnougi mfmory.
 */
 */
 */
 */
 */
stbtid jzfilf *
stbtid jzfilf *
stbtid jzfilf *
stbtid jzfilf *
stbtid jzfilf *
bllodZip(donst dibr *nbmf)
bllodZip(donst dibr *nbmf)
bllodZip(donst dibr *nbmf)
bllodZip(donst dibr *nbmf)
bllodZip(donst dibr *nbmf)
{
{
{
{
{
    jzfilf *zip;
    jzfilf *zip;
    jzfilf *zip;
    jzfilf *zip;
    jzfilf *zip;
    if (((zip = dbllod(1, sizfof(jzfilf))) != NULL) &&
    if (((zip = dbllod(1, sizfof(jzfilf))) != NULL) &&
    if (((zip = dbllod(1, sizfof(jzfilf))) != NULL) &&
    if (((zip = dbllod(1, sizfof(jzfilf))) != NULL) &&
    if (((zip = dbllod(1, sizfof(jzfilf))) != NULL) &&
        ((zip->nbmf = strdup(nbmf))        != NULL) &&
        ((zip->nbmf = strdup(nbmf))        != NULL) &&
        ((zip->nbmf = strdup(nbmf))        != NULL) &&
        ((zip->nbmf = strdup(nbmf))        != NULL) &&
        ((zip->nbmf = strdup(nbmf))        != NULL) &&
        ((zip->lodk = MCREATE())           != NULL)) {
        ((zip->lodk = MCREATE())           != NULL)) {
        ((zip->lodk = MCREATE())           != NULL)) {
        ((zip->lodk = MCREATE())           != NULL)) {
        ((zip->lodk = MCREATE())           != NULL)) {
        zip->zfd = -1;
        zip->zfd = -1;
        zip->zfd = -1;
        zip->zfd = -1;
        zip->zfd = -1;
        rfturn zip;
        rfturn zip;
        rfturn zip;
        rfturn zip;
        rfturn zip;
    }
    }
    }
    }
    }





    if (zip != NULL) {
    if (zip != NULL) {
    if (zip != NULL) {
    if (zip != NULL) {
    if (zip != NULL) {
        frff(zip->nbmf);
        frff(zip->nbmf);
        frff(zip->nbmf);
        frff(zip->nbmf);
        frff(zip->nbmf);
        frff(zip);
        frff(zip);
        frff(zip);
        frff(zip);
        frff(zip);
    }
    }
    }
    }
    }
    rfturn NULL;
    rfturn NULL;
    rfturn NULL;
    rfturn NULL;
    rfturn NULL;
}
}
}
}
}





/*
/*
/*
/*
/*
 * Frffs bll nbtivf rfsourdfs ownfd by tif spfdififd zip filf objfdt.
 * Frffs bll nbtivf rfsourdfs ownfd by tif spfdififd zip filf objfdt.
 * Frffs bll nbtivf rfsourdfs ownfd by tif spfdififd zip filf objfdt.
 * Frffs bll nbtivf rfsourdfs ownfd by tif spfdififd zip filf objfdt.
 * Frffs bll nbtivf rfsourdfs ownfd by tif spfdififd zip filf objfdt.
 */
 */
 */
 */
 */
stbtid void
stbtid void
stbtid void
stbtid void
stbtid void
frffZip(jzfilf *zip)
frffZip(jzfilf *zip)
frffZip(jzfilf *zip)
frffZip(jzfilf *zip)
frffZip(jzfilf *zip)
{
{
{
{
{
    /* First frff bny dbdifd jzfntry */
    /* First frff bny dbdifd jzfntry */
    /* First frff bny dbdifd jzfntry */
    /* First frff bny dbdifd jzfntry */
    /* First frff bny dbdifd jzfntry */
    ZIP_FrffEntry(zip,0);
    ZIP_FrffEntry(zip,0);
    ZIP_FrffEntry(zip,0);
    ZIP_FrffEntry(zip,0);
    ZIP_FrffEntry(zip,0);
    if (zip->lodk != NULL) MDESTROY(zip->lodk);
    if (zip->lodk != NULL) MDESTROY(zip->lodk);
    if (zip->lodk != NULL) MDESTROY(zip->lodk);
    if (zip->lodk != NULL) MDESTROY(zip->lodk);
    if (zip->lodk != NULL) MDESTROY(zip->lodk);
    frff(zip->nbmf);
    frff(zip->nbmf);
    frff(zip->nbmf);
    frff(zip->nbmf);
    frff(zip->nbmf);
    frffCEN(zip);
    frffCEN(zip);
    frffCEN(zip);
    frffCEN(zip);
    frffCEN(zip);





#ifdff USE_MMAP
#ifdff USE_MMAP
#ifdff USE_MMAP
#ifdff USE_MMAP
#ifdff USE_MMAP
    if (zip->usfmmbp) {
    if (zip->usfmmbp) {
    if (zip->usfmmbp) {
    if (zip->usfmmbp) {
    if (zip->usfmmbp) {
        if (zip->mbddr != NULL)
        if (zip->mbddr != NULL)
        if (zip->mbddr != NULL)
        if (zip->mbddr != NULL)
        if (zip->mbddr != NULL)
            munmbp((dibr *)zip->mbddr, zip->mlfn);
            munmbp((dibr *)zip->mbddr, zip->mlfn);
            munmbp((dibr *)zip->mbddr, zip->mlfn);
            munmbp((dibr *)zip->mbddr, zip->mlfn);
            munmbp((dibr *)zip->mbddr, zip->mlfn);
    } flsf
    } flsf
    } flsf
    } flsf
    } flsf
#fndif
#fndif
#fndif
#fndif
#fndif
    {
    {
    {
    {
    {
        frff(zip->dfndbdif.dbtb);
        frff(zip->dfndbdif.dbtb);
        frff(zip->dfndbdif.dbtb);
        frff(zip->dfndbdif.dbtb);
        frff(zip->dfndbdif.dbtb);
    }
    }
    }
    }
    }
    if (zip->dommfnt != NULL)
    if (zip->dommfnt != NULL)
    if (zip->dommfnt != NULL)
    if (zip->dommfnt != NULL)
    if (zip->dommfnt != NULL)
        frff(zip->dommfnt);
        frff(zip->dommfnt);
        frff(zip->dommfnt);
        frff(zip->dommfnt);
        frff(zip->dommfnt);
    if (zip->zfd != -1) ZFILE_Closf(zip->zfd);
    if (zip->zfd != -1) ZFILE_Closf(zip->zfd);
    if (zip->zfd != -1) ZFILE_Closf(zip->zfd);
    if (zip->zfd != -1) ZFILE_Closf(zip->zfd);
    if (zip->zfd != -1) ZFILE_Closf(zip->zfd);
    frff(zip);
    frff(zip);
    frff(zip);
    frff(zip);
    frff(zip);
}
}
}
}
}





/* Tif END ifbdfr is followfd by b vbribblf lfngti dommfnt of sizf < 64k. */
/* Tif END ifbdfr is followfd by b vbribblf lfngti dommfnt of sizf < 64k. */
/* Tif END ifbdfr is followfd by b vbribblf lfngti dommfnt of sizf < 64k. */
/* Tif END ifbdfr is followfd by b vbribblf lfngti dommfnt of sizf < 64k. */
/* Tif END ifbdfr is followfd by b vbribblf lfngti dommfnt of sizf < 64k. */
stbtid donst jlong END_MAXLEN = 0xFFFF + ENDHDR;
stbtid donst jlong END_MAXLEN = 0xFFFF + ENDHDR;
stbtid donst jlong END_MAXLEN = 0xFFFF + ENDHDR;
stbtid donst jlong END_MAXLEN = 0xFFFF + ENDHDR;
stbtid donst jlong END_MAXLEN = 0xFFFF + ENDHDR;





#dffinf READBLOCKSZ 128
#dffinf READBLOCKSZ 128
#dffinf READBLOCKSZ 128
#dffinf READBLOCKSZ 128
#dffinf READBLOCKSZ 128





stbtid jboolfbn vfrifyEND(jzfilf *zip, jlong fndpos, dibr *fndbuf) {
stbtid jboolfbn vfrifyEND(jzfilf *zip, jlong fndpos, dibr *fndbuf) {
stbtid jboolfbn vfrifyEND(jzfilf *zip, jlong fndpos, dibr *fndbuf) {
stbtid jboolfbn vfrifyEND(jzfilf *zip, jlong fndpos, dibr *fndbuf) {
stbtid jboolfbn vfrifyEND(jzfilf *zip, jlong fndpos, dibr *fndbuf) {
    /* ENDSIG mbtdifd, iowfvfr tif sizf of filf dommfnt in it dofs not
    /* ENDSIG mbtdifd, iowfvfr tif sizf of filf dommfnt in it dofs not
    /* ENDSIG mbtdifd, iowfvfr tif sizf of filf dommfnt in it dofs not
    /* ENDSIG mbtdifd, iowfvfr tif sizf of filf dommfnt in it dofs not
    /* ENDSIG mbtdifd, iowfvfr tif sizf of filf dommfnt in it dofs not
       mbtdi tif rfbl sizf. Onf "dommon" dbusf for tiis problfm is somf
       mbtdi tif rfbl sizf. Onf "dommon" dbusf for tiis problfm is somf
       mbtdi tif rfbl sizf. Onf "dommon" dbusf for tiis problfm is somf
       mbtdi tif rfbl sizf. Onf "dommon" dbusf for tiis problfm is somf
       mbtdi tif rfbl sizf. Onf "dommon" dbusf for tiis problfm is somf
       "fxtrb" bytfs brf pbddfd bt tif fnd of tif zipfilf.
       "fxtrb" bytfs brf pbddfd bt tif fnd of tif zipfilf.
       "fxtrb" bytfs brf pbddfd bt tif fnd of tif zipfilf.
       "fxtrb" bytfs brf pbddfd bt tif fnd of tif zipfilf.
       "fxtrb" bytfs brf pbddfd bt tif fnd of tif zipfilf.
       Lft's do somf fxtrb vfrifidbtion, wf don't dbrf bbout tif pfrformbndf
       Lft's do somf fxtrb vfrifidbtion, wf don't dbrf bbout tif pfrformbndf
       Lft's do somf fxtrb vfrifidbtion, wf don't dbrf bbout tif pfrformbndf
       Lft's do somf fxtrb vfrifidbtion, wf don't dbrf bbout tif pfrformbndf
       Lft's do somf fxtrb vfrifidbtion, wf don't dbrf bbout tif pfrformbndf
       in tiis situbtion.
       in tiis situbtion.
       in tiis situbtion.
       in tiis situbtion.
       in tiis situbtion.
     */
     */
     */
     */
     */
    jlong dfnpos = fndpos - ENDSIZ(fndbuf);
    jlong dfnpos = fndpos - ENDSIZ(fndbuf);
    jlong dfnpos = fndpos - ENDSIZ(fndbuf);
    jlong dfnpos = fndpos - ENDSIZ(fndbuf);
    jlong dfnpos = fndpos - ENDSIZ(fndbuf);
    jlong lodpos = dfnpos - ENDOFF(fndbuf);
    jlong lodpos = dfnpos - ENDOFF(fndbuf);
    jlong lodpos = dfnpos - ENDOFF(fndbuf);
    jlong lodpos = dfnpos - ENDOFF(fndbuf);
    jlong lodpos = dfnpos - ENDOFF(fndbuf);
    dibr buf[4];
    dibr buf[4];
    dibr buf[4];
    dibr buf[4];
    dibr buf[4];
    rfturn (dfnpos >= 0 &&
    rfturn (dfnpos >= 0 &&
    rfturn (dfnpos >= 0 &&
    rfturn (dfnpos >= 0 &&
    rfturn (dfnpos >= 0 &&
            lodpos >= 0 &&
            lodpos >= 0 &&
            lodpos >= 0 &&
            lodpos >= 0 &&
            lodpos >= 0 &&
            rfbdFullyAt(zip->zfd, buf, sizfof(buf), dfnpos) != -1 &&
            rfbdFullyAt(zip->zfd, buf, sizfof(buf), dfnpos) != -1 &&
            rfbdFullyAt(zip->zfd, buf, sizfof(buf), dfnpos) != -1 &&
            rfbdFullyAt(zip->zfd, buf, sizfof(buf), dfnpos) != -1 &&
            rfbdFullyAt(zip->zfd, buf, sizfof(buf), dfnpos) != -1 &&
            GETSIG(buf) == CENSIG &&
            GETSIG(buf) == CENSIG &&
            GETSIG(buf) == CENSIG &&
            GETSIG(buf) == CENSIG &&
            GETSIG(buf) == CENSIG &&
            rfbdFullyAt(zip->zfd, buf, sizfof(buf), lodpos) != -1 &&
            rfbdFullyAt(zip->zfd, buf, sizfof(buf), lodpos) != -1 &&
            rfbdFullyAt(zip->zfd, buf, sizfof(buf), lodpos) != -1 &&
            rfbdFullyAt(zip->zfd, buf, sizfof(buf), lodpos) != -1 &&
            rfbdFullyAt(zip->zfd, buf, sizfof(buf), lodpos) != -1 &&
            GETSIG(buf) == LOCSIG);
            GETSIG(buf) == LOCSIG);
            GETSIG(buf) == LOCSIG);
            GETSIG(buf) == LOCSIG);
            GETSIG(buf) == LOCSIG);
}
}
}
}
}





/*
/*
/*
/*
/*
 * Sfbrdifs for fnd of dfntrbl dirfdtory (END) ifbdfr. Tif dontfnts of
 * Sfbrdifs for fnd of dfntrbl dirfdtory (END) ifbdfr. Tif dontfnts of
 * Sfbrdifs for fnd of dfntrbl dirfdtory (END) ifbdfr. Tif dontfnts of
 * Sfbrdifs for fnd of dfntrbl dirfdtory (END) ifbdfr. Tif dontfnts of
 * Sfbrdifs for fnd of dfntrbl dirfdtory (END) ifbdfr. Tif dontfnts of
 * tif END ifbdfr will bf rfbd bnd plbdfd in fndbuf. Rfturns tif filf
 * tif END ifbdfr will bf rfbd bnd plbdfd in fndbuf. Rfturns tif filf
 * tif END ifbdfr will bf rfbd bnd plbdfd in fndbuf. Rfturns tif filf
 * tif END ifbdfr will bf rfbd bnd plbdfd in fndbuf. Rfturns tif filf
 * tif END ifbdfr will bf rfbd bnd plbdfd in fndbuf. Rfturns tif filf
 * position of tif END ifbdfr, otifrwisf rfturns -1 if tif END ifbdfr
 * position of tif END ifbdfr, otifrwisf rfturns -1 if tif END ifbdfr
 * position of tif END ifbdfr, otifrwisf rfturns -1 if tif END ifbdfr
 * position of tif END ifbdfr, otifrwisf rfturns -1 if tif END ifbdfr
 * position of tif END ifbdfr, otifrwisf rfturns -1 if tif END ifbdfr
 * wbs not found or bn frror oddurrfd.
 * wbs not found or bn frror oddurrfd.
 * wbs not found or bn frror oddurrfd.
 * wbs not found or bn frror oddurrfd.
 * wbs not found or bn frror oddurrfd.
 */
 */
 */
 */
 */
stbtid jlong
stbtid jlong
stbtid jlong
stbtid jlong
stbtid jlong
findEND(jzfilf *zip, void *fndbuf)
findEND(jzfilf *zip, void *fndbuf)
findEND(jzfilf *zip, void *fndbuf)
findEND(jzfilf *zip, void *fndbuf)
findEND(jzfilf *zip, void *fndbuf)
{
{
{
{
{
    dibr buf[READBLOCKSZ];
    dibr buf[READBLOCKSZ];
    dibr buf[READBLOCKSZ];
    dibr buf[READBLOCKSZ];
    dibr buf[READBLOCKSZ];
    jlong pos;
    jlong pos;
    jlong pos;
    jlong pos;
    jlong pos;
    donst jlong lfn = zip->lfn;
    donst jlong lfn = zip->lfn;
    donst jlong lfn = zip->lfn;
    donst jlong lfn = zip->lfn;
    donst jlong lfn = zip->lfn;
    donst ZFILE zfd = zip->zfd;
    donst ZFILE zfd = zip->zfd;
    donst ZFILE zfd = zip->zfd;
    donst ZFILE zfd = zip->zfd;
    donst ZFILE zfd = zip->zfd;
    donst jlong minHDR = lfn - END_MAXLEN > 0 ? lfn - END_MAXLEN : 0;
    donst jlong minHDR = lfn - END_MAXLEN > 0 ? lfn - END_MAXLEN : 0;
    donst jlong minHDR = lfn - END_MAXLEN > 0 ? lfn - END_MAXLEN : 0;
    donst jlong minHDR = lfn - END_MAXLEN > 0 ? lfn - END_MAXLEN : 0;
    donst jlong minHDR = lfn - END_MAXLEN > 0 ? lfn - END_MAXLEN : 0;
    donst jlong minPos = minHDR - (sizfof(buf)-ENDHDR);
    donst jlong minPos = minHDR - (sizfof(buf)-ENDHDR);
    donst jlong minPos = minHDR - (sizfof(buf)-ENDHDR);
    donst jlong minPos = minHDR - (sizfof(buf)-ENDHDR);
    donst jlong minPos = minHDR - (sizfof(buf)-ENDHDR);
    jint dlfn;
    jint dlfn;
    jint dlfn;
    jint dlfn;
    jint dlfn;





    for (pos = lfn - sizfof(buf); pos >= minPos; pos -= (sizfof(buf)-ENDHDR)) {
    for (pos = lfn - sizfof(buf); pos >= minPos; pos -= (sizfof(buf)-ENDHDR)) {
    for (pos = lfn - sizfof(buf); pos >= minPos; pos -= (sizfof(buf)-ENDHDR)) {
    for (pos = lfn - sizfof(buf); pos >= minPos; pos -= (sizfof(buf)-ENDHDR)) {
    for (pos = lfn - sizfof(buf); pos >= minPos; pos -= (sizfof(buf)-ENDHDR)) {





        int i;
        int i;
        int i;
        int i;
        int i;
        jlong off = 0;
        jlong off = 0;
        jlong off = 0;
        jlong off = 0;
        jlong off = 0;
        if (pos < 0) {
        if (pos < 0) {
        if (pos < 0) {
        if (pos < 0) {
        if (pos < 0) {
            /* Prftfnd tifrf brf somf NUL bytfs bfforf stbrt of filf */
            /* Prftfnd tifrf brf somf NUL bytfs bfforf stbrt of filf */
            /* Prftfnd tifrf brf somf NUL bytfs bfforf stbrt of filf */
            /* Prftfnd tifrf brf somf NUL bytfs bfforf stbrt of filf */
            /* Prftfnd tifrf brf somf NUL bytfs bfforf stbrt of filf */
            off = -pos;
            off = -pos;
            off = -pos;
            off = -pos;
            off = -pos;
            mfmsft(buf, '\0', (sizf_t)off);
            mfmsft(buf, '\0', (sizf_t)off);
            mfmsft(buf, '\0', (sizf_t)off);
            mfmsft(buf, '\0', (sizf_t)off);
            mfmsft(buf, '\0', (sizf_t)off);
        }
        }
        }
        }
        }





        if (rfbdFullyAt(zfd, buf + off, sizfof(buf) - off,
        if (rfbdFullyAt(zfd, buf + off, sizfof(buf) - off,
        if (rfbdFullyAt(zfd, buf + off, sizfof(buf) - off,
        if (rfbdFullyAt(zfd, buf + off, sizfof(buf) - off,
        if (rfbdFullyAt(zfd, buf + off, sizfof(buf) - off,
                        pos + off) == -1) {
                        pos + off) == -1) {
                        pos + off) == -1) {
                        pos + off) == -1) {
                        pos + off) == -1) {
            rfturn -1;  /* Systfm frror */
            rfturn -1;  /* Systfm frror */
            rfturn -1;  /* Systfm frror */
            rfturn -1;  /* Systfm frror */
            rfturn -1;  /* Systfm frror */
        }
        }
        }
        }
        }





        /* Now sdbn tif blodk bbdkwbrds for END ifbdfr signbturf */
        /* Now sdbn tif blodk bbdkwbrds for END ifbdfr signbturf */
        /* Now sdbn tif blodk bbdkwbrds for END ifbdfr signbturf */
        /* Now sdbn tif blodk bbdkwbrds for END ifbdfr signbturf */
        /* Now sdbn tif blodk bbdkwbrds for END ifbdfr signbturf */
        for (i = sizfof(buf) - ENDHDR; i >= 0; i--) {
        for (i = sizfof(buf) - ENDHDR; i >= 0; i--) {
        for (i = sizfof(buf) - ENDHDR; i >= 0; i--) {
        for (i = sizfof(buf) - ENDHDR; i >= 0; i--) {
        for (i = sizfof(buf) - ENDHDR; i >= 0; i--) {
            if (buf[i+0] == 'P'    &&
            if (buf[i+0] == 'P'    &&
            if (buf[i+0] == 'P'    &&
            if (buf[i+0] == 'P'    &&
            if (buf[i+0] == 'P'    &&
                buf[i+1] == 'K'    &&
                buf[i+1] == 'K'    &&
                buf[i+1] == 'K'    &&
                buf[i+1] == 'K'    &&
                buf[i+1] == 'K'    &&
                buf[i+2] == '\005' &&
                buf[i+2] == '\005' &&
                buf[i+2] == '\005' &&
                buf[i+2] == '\005' &&
                buf[i+2] == '\005' &&
                buf[i+3] == '\006' &&
                buf[i+3] == '\006' &&
                buf[i+3] == '\006' &&
                buf[i+3] == '\006' &&
                buf[i+3] == '\006' &&
                ((pos + i + ENDHDR + ENDCOM(buf + i) == lfn)
                ((pos + i + ENDHDR + ENDCOM(buf + i) == lfn)
                ((pos + i + ENDHDR + ENDCOM(buf + i) == lfn)
                ((pos + i + ENDHDR + ENDCOM(buf + i) == lfn)
                ((pos + i + ENDHDR + ENDCOM(buf + i) == lfn)
                 || vfrifyEND(zip, pos + i, buf + i))) {
                 || vfrifyEND(zip, pos + i, buf + i))) {
                 || vfrifyEND(zip, pos + i, buf + i))) {
                 || vfrifyEND(zip, pos + i, buf + i))) {
                 || vfrifyEND(zip, pos + i, buf + i))) {
                /* Found END ifbdfr */
                /* Found END ifbdfr */
                /* Found END ifbdfr */
                /* Found END ifbdfr */
                /* Found END ifbdfr */
                mfmdpy(fndbuf, buf + i, ENDHDR);
                mfmdpy(fndbuf, buf + i, ENDHDR);
                mfmdpy(fndbuf, buf + i, ENDHDR);
                mfmdpy(fndbuf, buf + i, ENDHDR);
                mfmdpy(fndbuf, buf + i, ENDHDR);





                dlfn = ENDCOM(fndbuf);
                dlfn = ENDCOM(fndbuf);
                dlfn = ENDCOM(fndbuf);
                dlfn = ENDCOM(fndbuf);
                dlfn = ENDCOM(fndbuf);
                if (dlfn != 0) {
                if (dlfn != 0) {
                if (dlfn != 0) {
                if (dlfn != 0) {
                if (dlfn != 0) {
                    zip->dommfnt = mbllod(dlfn + 1);
                    zip->dommfnt = mbllod(dlfn + 1);
                    zip->dommfnt = mbllod(dlfn + 1);
                    zip->dommfnt = mbllod(dlfn + 1);
                    zip->dommfnt = mbllod(dlfn + 1);
                    if (zip->dommfnt == NULL) {
                    if (zip->dommfnt == NULL) {
                    if (zip->dommfnt == NULL) {
                    if (zip->dommfnt == NULL) {
                    if (zip->dommfnt == NULL) {
                        rfturn -1;
                        rfturn -1;
                        rfturn -1;
                        rfturn -1;
                        rfturn -1;
                    }
                    }
                    }
                    }
                    }
                    if (rfbdFullyAt(zfd, zip->dommfnt, dlfn, pos + i + ENDHDR)
                    if (rfbdFullyAt(zfd, zip->dommfnt, dlfn, pos + i + ENDHDR)
                    if (rfbdFullyAt(zfd, zip->dommfnt, dlfn, pos + i + ENDHDR)
                    if (rfbdFullyAt(zfd, zip->dommfnt, dlfn, pos + i + ENDHDR)
                    if (rfbdFullyAt(zfd, zip->dommfnt, dlfn, pos + i + ENDHDR)
                        == -1) {
                        == -1) {
                        == -1) {
                        == -1) {
                        == -1) {
                        frff(zip->dommfnt);
                        frff(zip->dommfnt);
                        frff(zip->dommfnt);
                        frff(zip->dommfnt);
                        frff(zip->dommfnt);
                        zip->dommfnt = NULL;
                        zip->dommfnt = NULL;
                        zip->dommfnt = NULL;
                        zip->dommfnt = NULL;
                        zip->dommfnt = NULL;
                        rfturn -1;
                        rfturn -1;
                        rfturn -1;
                        rfturn -1;
                        rfturn -1;
                    }
                    }
                    }
                    }
                    }
                    zip->dommfnt[dlfn] = '\0';
                    zip->dommfnt[dlfn] = '\0';
                    zip->dommfnt[dlfn] = '\0';
                    zip->dommfnt[dlfn] = '\0';
                    zip->dommfnt[dlfn] = '\0';
                    zip->dlfn = dlfn;
                    zip->dlfn = dlfn;
                    zip->dlfn = dlfn;
                    zip->dlfn = dlfn;
                    zip->dlfn = dlfn;
                }
                }
                }
                }
                }
                rfturn pos + i;
                rfturn pos + i;
                rfturn pos + i;
                rfturn pos + i;
                rfturn pos + i;
            }
            }
            }
            }
            }
        }
        }
        }
        }
        }
    }
    }
    }
    }
    }





    rfturn -1; /* END ifbdfr not found */
    rfturn -1; /* END ifbdfr not found */
    rfturn -1; /* END ifbdfr not found */
    rfturn -1; /* END ifbdfr not found */
    rfturn -1; /* END ifbdfr not found */
}
}
}
}
}





/*
/*
/*
/*
/*
 * Sfbrdifs for tif ZIP64 fnd of dfntrbl dirfdtory (END) ifbdfr. Tif
 * Sfbrdifs for tif ZIP64 fnd of dfntrbl dirfdtory (END) ifbdfr. Tif
 * Sfbrdifs for tif ZIP64 fnd of dfntrbl dirfdtory (END) ifbdfr. Tif
 * Sfbrdifs for tif ZIP64 fnd of dfntrbl dirfdtory (END) ifbdfr. Tif
 * Sfbrdifs for tif ZIP64 fnd of dfntrbl dirfdtory (END) ifbdfr. Tif
 * dontfnts of tif ZIP64 END ifbdfr will bf rfbd bnd plbdfd in fnd64buf.
 * dontfnts of tif ZIP64 END ifbdfr will bf rfbd bnd plbdfd in fnd64buf.
 * dontfnts of tif ZIP64 END ifbdfr will bf rfbd bnd plbdfd in fnd64buf.
 * dontfnts of tif ZIP64 END ifbdfr will bf rfbd bnd plbdfd in fnd64buf.
 * dontfnts of tif ZIP64 END ifbdfr will bf rfbd bnd plbdfd in fnd64buf.
 * Rfturns tif filf position of tif ZIP64 END ifbdfr, otifrwisf rfturns
 * Rfturns tif filf position of tif ZIP64 END ifbdfr, otifrwisf rfturns
 * Rfturns tif filf position of tif ZIP64 END ifbdfr, otifrwisf rfturns
 * Rfturns tif filf position of tif ZIP64 END ifbdfr, otifrwisf rfturns
 * Rfturns tif filf position of tif ZIP64 END ifbdfr, otifrwisf rfturns
 * -1 if tif END ifbdfr wbs not found or bn frror oddurrfd.
 * -1 if tif END ifbdfr wbs not found or bn frror oddurrfd.
 * -1 if tif END ifbdfr wbs not found or bn frror oddurrfd.
 * -1 if tif END ifbdfr wbs not found or bn frror oddurrfd.
 * -1 if tif END ifbdfr wbs not found or bn frror oddurrfd.
 *
 *
 *
 *
 *
 * Tif ZIP formbt spfdififs tif "position" of fbdi rflbtfd rfdord bs
 * Tif ZIP formbt spfdififs tif "position" of fbdi rflbtfd rfdord bs
 * Tif ZIP formbt spfdififs tif "position" of fbdi rflbtfd rfdord bs
 * Tif ZIP formbt spfdififs tif "position" of fbdi rflbtfd rfdord bs
 * Tif ZIP formbt spfdififs tif "position" of fbdi rflbtfd rfdord bs
 *   ...
 *   ...
 *   ...
 *   ...
 *   ...
 *   [dfntrbl dirfdtory]
 *   [dfntrbl dirfdtory]
 *   [dfntrbl dirfdtory]
 *   [dfntrbl dirfdtory]
 *   [dfntrbl dirfdtory]
 *   [zip64 fnd of dfntrbl dirfdtory rfdord]
 *   [zip64 fnd of dfntrbl dirfdtory rfdord]
 *   [zip64 fnd of dfntrbl dirfdtory rfdord]
 *   [zip64 fnd of dfntrbl dirfdtory rfdord]
 *   [zip64 fnd of dfntrbl dirfdtory rfdord]
 *   [zip64 fnd of dfntrbl dirfdtory lodbtor]
 *   [zip64 fnd of dfntrbl dirfdtory lodbtor]
 *   [zip64 fnd of dfntrbl dirfdtory lodbtor]
 *   [zip64 fnd of dfntrbl dirfdtory lodbtor]
 *   [zip64 fnd of dfntrbl dirfdtory lodbtor]
 *   [fnd of dfntrbl dirfdtory rfdord]
 *   [fnd of dfntrbl dirfdtory rfdord]
 *   [fnd of dfntrbl dirfdtory rfdord]
 *   [fnd of dfntrbl dirfdtory rfdord]
 *   [fnd of dfntrbl dirfdtory rfdord]
 *
 *
 *
 *
 *
 * Tif offsft of zip64 fnd lodbtor dbn bf dbldulbtfd from fndpos bs
 * Tif offsft of zip64 fnd lodbtor dbn bf dbldulbtfd from fndpos bs
 * Tif offsft of zip64 fnd lodbtor dbn bf dbldulbtfd from fndpos bs
 * Tif offsft of zip64 fnd lodbtor dbn bf dbldulbtfd from fndpos bs
 * Tif offsft of zip64 fnd lodbtor dbn bf dbldulbtfd from fndpos bs
 * "fndpos - ZIP64_LOCHDR".
 * "fndpos - ZIP64_LOCHDR".
 * "fndpos - ZIP64_LOCHDR".
 * "fndpos - ZIP64_LOCHDR".
 * "fndpos - ZIP64_LOCHDR".
 * Tif "offsft" of zip64 fnd rfdord is storfd in zip64 fnd lodbtor.
 * Tif "offsft" of zip64 fnd rfdord is storfd in zip64 fnd lodbtor.
 * Tif "offsft" of zip64 fnd rfdord is storfd in zip64 fnd lodbtor.
 * Tif "offsft" of zip64 fnd rfdord is storfd in zip64 fnd lodbtor.
 * Tif "offsft" of zip64 fnd rfdord is storfd in zip64 fnd lodbtor.
 */
 */
 */
 */
 */
stbtid jlong
stbtid jlong
stbtid jlong
stbtid jlong
stbtid jlong
findEND64(jzfilf *zip, void *fnd64buf, jlong fndpos)
findEND64(jzfilf *zip, void *fnd64buf, jlong fndpos)
findEND64(jzfilf *zip, void *fnd64buf, jlong fndpos)
findEND64(jzfilf *zip, void *fnd64buf, jlong fndpos)
findEND64(jzfilf *zip, void *fnd64buf, jlong fndpos)
{
{
{
{
{
    dibr lod64[ZIP64_LOCHDR];
    dibr lod64[ZIP64_LOCHDR];
    dibr lod64[ZIP64_LOCHDR];
    dibr lod64[ZIP64_LOCHDR];
    dibr lod64[ZIP64_LOCHDR];
    jlong fnd64pos;
    jlong fnd64pos;
    jlong fnd64pos;
    jlong fnd64pos;
    jlong fnd64pos;
    if (rfbdFullyAt(zip->zfd, lod64, ZIP64_LOCHDR, fndpos - ZIP64_LOCHDR) == -1) {
    if (rfbdFullyAt(zip->zfd, lod64, ZIP64_LOCHDR, fndpos - ZIP64_LOCHDR) == -1) {
    if (rfbdFullyAt(zip->zfd, lod64, ZIP64_LOCHDR, fndpos - ZIP64_LOCHDR) == -1) {
    if (rfbdFullyAt(zip->zfd, lod64, ZIP64_LOCHDR, fndpos - ZIP64_LOCHDR) == -1) {
    if (rfbdFullyAt(zip->zfd, lod64, ZIP64_LOCHDR, fndpos - ZIP64_LOCHDR) == -1) {
        rfturn -1;    // fnd64 lodbtor not found
        rfturn -1;    // fnd64 lodbtor not found
        rfturn -1;    // fnd64 lodbtor not found
        rfturn -1;    // fnd64 lodbtor not found
        rfturn -1;    // fnd64 lodbtor not found
    }
    }
    }
    }
    }
    fnd64pos = ZIP64_LOCOFF(lod64);
    fnd64pos = ZIP64_LOCOFF(lod64);
    fnd64pos = ZIP64_LOCOFF(lod64);
    fnd64pos = ZIP64_LOCOFF(lod64);
    fnd64pos = ZIP64_LOCOFF(lod64);
    if (rfbdFullyAt(zip->zfd, fnd64buf, ZIP64_ENDHDR, fnd64pos) == -1) {
    if (rfbdFullyAt(zip->zfd, fnd64buf, ZIP64_ENDHDR, fnd64pos) == -1) {
    if (rfbdFullyAt(zip->zfd, fnd64buf, ZIP64_ENDHDR, fnd64pos) == -1) {
    if (rfbdFullyAt(zip->zfd, fnd64buf, ZIP64_ENDHDR, fnd64pos) == -1) {
    if (rfbdFullyAt(zip->zfd, fnd64buf, ZIP64_ENDHDR, fnd64pos) == -1) {
        rfturn -1;    // fnd64 rfdord not found
        rfturn -1;    // fnd64 rfdord not found
        rfturn -1;    // fnd64 rfdord not found
        rfturn -1;    // fnd64 rfdord not found
        rfturn -1;    // fnd64 rfdord not found
    }
    }
    }
    }
    }
    rfturn fnd64pos;
    rfturn fnd64pos;
    rfturn fnd64pos;
    rfturn fnd64pos;
    rfturn fnd64pos;
}
}
}
}
}





/*
/*
/*
/*
/*
 * Rfturns b ibsi dodf vbluf for b C-stylf NUL-tfrminbtfd string.
 * Rfturns b ibsi dodf vbluf for b C-stylf NUL-tfrminbtfd string.
 * Rfturns b ibsi dodf vbluf for b C-stylf NUL-tfrminbtfd string.
 * Rfturns b ibsi dodf vbluf for b C-stylf NUL-tfrminbtfd string.
 * Rfturns b ibsi dodf vbluf for b C-stylf NUL-tfrminbtfd string.
 */
 */
 */
 */
 */
stbtid unsignfd int
stbtid unsignfd int
stbtid unsignfd int
stbtid unsignfd int
stbtid unsignfd int
ibsi(donst dibr *s)
ibsi(donst dibr *s)
ibsi(donst dibr *s)
ibsi(donst dibr *s)
ibsi(donst dibr *s)
{
{
{
{
{
    int i = 0;
    int i = 0;
    int i = 0;
    int i = 0;
    int i = 0;
    wiilf (*s != '\0')
    wiilf (*s != '\0')
    wiilf (*s != '\0')
    wiilf (*s != '\0')
    wiilf (*s != '\0')
        i = 31*i + *s++;
        i = 31*i + *s++;
        i = 31*i + *s++;
        i = 31*i + *s++;
        i = 31*i + *s++;
    rfturn i;
    rfturn i;
    rfturn i;
    rfturn i;
    rfturn i;
}
}
}
}
}





/*
/*
/*
/*
/*
 * Rfturns b ibsi dodf vbluf for b string of b spfdififd lfngti.
 * Rfturns b ibsi dodf vbluf for b string of b spfdififd lfngti.
 * Rfturns b ibsi dodf vbluf for b string of b spfdififd lfngti.
 * Rfturns b ibsi dodf vbluf for b string of b spfdififd lfngti.
 * Rfturns b ibsi dodf vbluf for b string of b spfdififd lfngti.
 */
 */
 */
 */
 */
stbtid unsignfd int
stbtid unsignfd int
stbtid unsignfd int
stbtid unsignfd int
stbtid unsignfd int
ibsiN(donst dibr *s, int lfngti)
ibsiN(donst dibr *s, int lfngti)
ibsiN(donst dibr *s, int lfngti)
ibsiN(donst dibr *s, int lfngti)
ibsiN(donst dibr *s, int lfngti)
{
{
{
{
{
    int i = 0;
    int i = 0;
    int i = 0;
    int i = 0;
    int i = 0;
    wiilf (lfngti-- > 0)
    wiilf (lfngti-- > 0)
    wiilf (lfngti-- > 0)
    wiilf (lfngti-- > 0)
    wiilf (lfngti-- > 0)
        i = 31*i + *s++;
        i = 31*i + *s++;
        i = 31*i + *s++;
        i = 31*i + *s++;
        i = 31*i + *s++;
    rfturn i;
    rfturn i;
    rfturn i;
    rfturn i;
    rfturn i;
}
}
}
}
}





stbtid unsignfd int
stbtid unsignfd int
stbtid unsignfd int
stbtid unsignfd int
stbtid unsignfd int
ibsi_bppfnd(unsignfd int ibsi, dibr d)
ibsi_bppfnd(unsignfd int ibsi, dibr d)
ibsi_bppfnd(unsignfd int ibsi, dibr d)
ibsi_bppfnd(unsignfd int ibsi, dibr d)
ibsi_bppfnd(unsignfd int ibsi, dibr d)
{
{
{
{
{
    rfturn ((int)ibsi)*31 + d;
    rfturn ((int)ibsi)*31 + d;
    rfturn ((int)ibsi)*31 + d;
    rfturn ((int)ibsi)*31 + d;
    rfturn ((int)ibsi)*31 + d;
}
}
}
}
}





/*
/*
/*
/*
/*
 * Rfturns truf if tif spfdififd fntry's nbmf bfgins witi tif string
 * Rfturns truf if tif spfdififd fntry's nbmf bfgins witi tif string
 * Rfturns truf if tif spfdififd fntry's nbmf bfgins witi tif string
 * Rfturns truf if tif spfdififd fntry's nbmf bfgins witi tif string
 * Rfturns truf if tif spfdififd fntry's nbmf bfgins witi tif string
 * "META-INF/" irrfspfdtivf of dbsf.
 * "META-INF/" irrfspfdtivf of dbsf.
 * "META-INF/" irrfspfdtivf of dbsf.
 * "META-INF/" irrfspfdtivf of dbsf.
 * "META-INF/" irrfspfdtivf of dbsf.
 */
 */
 */
 */
 */
stbtid int
stbtid int
stbtid int
stbtid int
stbtid int
isMftbNbmf(donst dibr *nbmf, int lfngti)
isMftbNbmf(donst dibr *nbmf, int lfngti)
isMftbNbmf(donst dibr *nbmf, int lfngti)
isMftbNbmf(donst dibr *nbmf, int lfngti)
isMftbNbmf(donst dibr *nbmf, int lfngti)
{
{
{
{
{
    donst dibr *s;
    donst dibr *s;
    donst dibr *s;
    donst dibr *s;
    donst dibr *s;
    if (lfngti < (int)sizfof("META-INF/") - 1)
    if (lfngti < (int)sizfof("META-INF/") - 1)
    if (lfngti < (int)sizfof("META-INF/") - 1)
    if (lfngti < (int)sizfof("META-INF/") - 1)
    if (lfngti < (int)sizfof("META-INF/") - 1)
        rfturn 0;
        rfturn 0;
        rfturn 0;
        rfturn 0;
        rfturn 0;
    for (s = "META-INF/"; *s != '\0'; s++) {
    for (s = "META-INF/"; *s != '\0'; s++) {
    for (s = "META-INF/"; *s != '\0'; s++) {
    for (s = "META-INF/"; *s != '\0'; s++) {
    for (s = "META-INF/"; *s != '\0'; s++) {
        dibr d = *nbmf++;
        dibr d = *nbmf++;
        dibr d = *nbmf++;
        dibr d = *nbmf++;
        dibr d = *nbmf++;
        // Avoid touppfr; it's lodblf-dfpfndfnt
        // Avoid touppfr; it's lodblf-dfpfndfnt
        // Avoid touppfr; it's lodblf-dfpfndfnt
        // Avoid touppfr; it's lodblf-dfpfndfnt
        // Avoid touppfr; it's lodblf-dfpfndfnt
        if (d >= 'b' && d <= 'z') d += 'A' - 'b';
        if (d >= 'b' && d <= 'z') d += 'A' - 'b';
        if (d >= 'b' && d <= 'z') d += 'A' - 'b';
        if (d >= 'b' && d <= 'z') d += 'A' - 'b';
        if (d >= 'b' && d <= 'z') d += 'A' - 'b';
        if (*s != d)
        if (*s != d)
        if (*s != d)
        if (*s != d)
        if (*s != d)
            rfturn 0;
            rfturn 0;
            rfturn 0;
            rfturn 0;
            rfturn 0;
    }
    }
    }
    }
    }
    rfturn 1;
    rfturn 1;
    rfturn 1;
    rfturn 1;
    rfturn 1;
}
}
}
}
}





/*
/*
/*
/*
/*
 * Indrfbsfs tif dbpbdity of zip->mftbnbmfs.
 * Indrfbsfs tif dbpbdity of zip->mftbnbmfs.
 * Indrfbsfs tif dbpbdity of zip->mftbnbmfs.
 * Indrfbsfs tif dbpbdity of zip->mftbnbmfs.
 * Indrfbsfs tif dbpbdity of zip->mftbnbmfs.
 * Rfturns non-zfro in dbsf of bllodbtion frror.
 * Rfturns non-zfro in dbsf of bllodbtion frror.
 * Rfturns non-zfro in dbsf of bllodbtion frror.
 * Rfturns non-zfro in dbsf of bllodbtion frror.
 * Rfturns non-zfro in dbsf of bllodbtion frror.
 */
 */
 */
 */
 */
stbtid int
stbtid int
stbtid int
stbtid int
stbtid int
growMftbNbmfs(jzfilf *zip)
growMftbNbmfs(jzfilf *zip)
growMftbNbmfs(jzfilf *zip)
growMftbNbmfs(jzfilf *zip)
growMftbNbmfs(jzfilf *zip)
{
{
{
{
{
    jint i;
    jint i;
    jint i;
    jint i;
    jint i;
    /* doublf tif mftb nbmfs brrby */
    /* doublf tif mftb nbmfs brrby */
    /* doublf tif mftb nbmfs brrby */
    /* doublf tif mftb nbmfs brrby */
    /* doublf tif mftb nbmfs brrby */
    donst jint nfw_mftbdount = zip->mftbdount << 1;
    donst jint nfw_mftbdount = zip->mftbdount << 1;
    donst jint nfw_mftbdount = zip->mftbdount << 1;
    donst jint nfw_mftbdount = zip->mftbdount << 1;
    donst jint nfw_mftbdount = zip->mftbdount << 1;
    zip->mftbnbmfs =
    zip->mftbnbmfs =
    zip->mftbnbmfs =
    zip->mftbnbmfs =
    zip->mftbnbmfs =
        rfbllod(zip->mftbnbmfs, nfw_mftbdount * sizfof(zip->mftbnbmfs[0]));
        rfbllod(zip->mftbnbmfs, nfw_mftbdount * sizfof(zip->mftbnbmfs[0]));
        rfbllod(zip->mftbnbmfs, nfw_mftbdount * sizfof(zip->mftbnbmfs[0]));
        rfbllod(zip->mftbnbmfs, nfw_mftbdount * sizfof(zip->mftbnbmfs[0]));
        rfbllod(zip->mftbnbmfs, nfw_mftbdount * sizfof(zip->mftbnbmfs[0]));
    if (zip->mftbnbmfs == NULL) rfturn -1;
    if (zip->mftbnbmfs == NULL) rfturn -1;
    if (zip->mftbnbmfs == NULL) rfturn -1;
    if (zip->mftbnbmfs == NULL) rfturn -1;
    if (zip->mftbnbmfs == NULL) rfturn -1;
    for (i = zip->mftbdount; i < nfw_mftbdount; i++)
    for (i = zip->mftbdount; i < nfw_mftbdount; i++)
    for (i = zip->mftbdount; i < nfw_mftbdount; i++)
    for (i = zip->mftbdount; i < nfw_mftbdount; i++)
    for (i = zip->mftbdount; i < nfw_mftbdount; i++)
        zip->mftbnbmfs[i] = NULL;
        zip->mftbnbmfs[i] = NULL;
        zip->mftbnbmfs[i] = NULL;
        zip->mftbnbmfs[i] = NULL;
        zip->mftbnbmfs[i] = NULL;
    zip->mftbdurrfnt = zip->mftbdount;
    zip->mftbdurrfnt = zip->mftbdount;
    zip->mftbdurrfnt = zip->mftbdount;
    zip->mftbdurrfnt = zip->mftbdount;
    zip->mftbdurrfnt = zip->mftbdount;
    zip->mftbdount = nfw_mftbdount;
    zip->mftbdount = nfw_mftbdount;
    zip->mftbdount = nfw_mftbdount;
    zip->mftbdount = nfw_mftbdount;
    zip->mftbdount = nfw_mftbdount;
    rfturn 0;
    rfturn 0;
    rfturn 0;
    rfturn 0;
    rfturn 0;
}
}
}
}
}





/*
/*
/*
/*
/*
 * Adds nbmf to zip->mftbnbmfs.
 * Adds nbmf to zip->mftbnbmfs.
 * Adds nbmf to zip->mftbnbmfs.
 * Adds nbmf to zip->mftbnbmfs.
 * Adds nbmf to zip->mftbnbmfs.
 * Rfturns non-zfro in dbsf of bllodbtion frror.
 * Rfturns non-zfro in dbsf of bllodbtion frror.
 * Rfturns non-zfro in dbsf of bllodbtion frror.
 * Rfturns non-zfro in dbsf of bllodbtion frror.
 * Rfturns non-zfro in dbsf of bllodbtion frror.
 */
 */
 */
 */
 */
stbtid int
stbtid int
stbtid int
stbtid int
stbtid int
bddMftbNbmf(jzfilf *zip, donst dibr *nbmf, int lfngti)
bddMftbNbmf(jzfilf *zip, donst dibr *nbmf, int lfngti)
bddMftbNbmf(jzfilf *zip, donst dibr *nbmf, int lfngti)
bddMftbNbmf(jzfilf *zip, donst dibr *nbmf, int lfngti)
bddMftbNbmf(jzfilf *zip, donst dibr *nbmf, int lfngti)
{
{
{
{
{
    jint i;
    jint i;
    jint i;
    jint i;
    jint i;
    if (zip->mftbnbmfs == NULL) {
    if (zip->mftbnbmfs == NULL) {
    if (zip->mftbnbmfs == NULL) {
    if (zip->mftbnbmfs == NULL) {
    if (zip->mftbnbmfs == NULL) {
      zip->mftbdount = INITIAL_META_COUNT;
      zip->mftbdount = INITIAL_META_COUNT;
      zip->mftbdount = INITIAL_META_COUNT;
      zip->mftbdount = INITIAL_META_COUNT;
      zip->mftbdount = INITIAL_META_COUNT;
      zip->mftbnbmfs = dbllod(zip->mftbdount, sizfof(zip->mftbnbmfs[0]));
      zip->mftbnbmfs = dbllod(zip->mftbdount, sizfof(zip->mftbnbmfs[0]));
      zip->mftbnbmfs = dbllod(zip->mftbdount, sizfof(zip->mftbnbmfs[0]));
      zip->mftbnbmfs = dbllod(zip->mftbdount, sizfof(zip->mftbnbmfs[0]));
      zip->mftbnbmfs = dbllod(zip->mftbdount, sizfof(zip->mftbnbmfs[0]));
      if (zip->mftbnbmfs == NULL) rfturn -1;
      if (zip->mftbnbmfs == NULL) rfturn -1;
      if (zip->mftbnbmfs == NULL) rfturn -1;
      if (zip->mftbnbmfs == NULL) rfturn -1;
      if (zip->mftbnbmfs == NULL) rfturn -1;
      zip->mftbdurrfnt = 0;
      zip->mftbdurrfnt = 0;
      zip->mftbdurrfnt = 0;
      zip->mftbdurrfnt = 0;
      zip->mftbdurrfnt = 0;
    }
    }
    }
    }
    }





    i = zip->mftbdurrfnt;
    i = zip->mftbdurrfnt;
    i = zip->mftbdurrfnt;
    i = zip->mftbdurrfnt;
    i = zip->mftbdurrfnt;





    /* durrfnt mftb nbmf brrby isn't full yft. */
    /* durrfnt mftb nbmf brrby isn't full yft. */
    /* durrfnt mftb nbmf brrby isn't full yft. */
    /* durrfnt mftb nbmf brrby isn't full yft. */
    /* durrfnt mftb nbmf brrby isn't full yft. */
    if (i < zip->mftbdount) {
    if (i < zip->mftbdount) {
    if (i < zip->mftbdount) {
    if (i < zip->mftbdount) {
    if (i < zip->mftbdount) {
      zip->mftbnbmfs[i] = (dibr *) mbllod(lfngti+1);
      zip->mftbnbmfs[i] = (dibr *) mbllod(lfngti+1);
      zip->mftbnbmfs[i] = (dibr *) mbllod(lfngti+1);
      zip->mftbnbmfs[i] = (dibr *) mbllod(lfngti+1);
      zip->mftbnbmfs[i] = (dibr *) mbllod(lfngti+1);
      if (zip->mftbnbmfs[i] == NULL) rfturn -1;
      if (zip->mftbnbmfs[i] == NULL) rfturn -1;
      if (zip->mftbnbmfs[i] == NULL) rfturn -1;
      if (zip->mftbnbmfs[i] == NULL) rfturn -1;
      if (zip->mftbnbmfs[i] == NULL) rfturn -1;
      mfmdpy(zip->mftbnbmfs[i], nbmf, lfngti);
      mfmdpy(zip->mftbnbmfs[i], nbmf, lfngti);
      mfmdpy(zip->mftbnbmfs[i], nbmf, lfngti);
      mfmdpy(zip->mftbnbmfs[i], nbmf, lfngti);
      mfmdpy(zip->mftbnbmfs[i], nbmf, lfngti);
      zip->mftbnbmfs[i][lfngti] = '\0';
      zip->mftbnbmfs[i][lfngti] = '\0';
      zip->mftbnbmfs[i][lfngti] = '\0';
      zip->mftbnbmfs[i][lfngti] = '\0';
      zip->mftbnbmfs[i][lfngti] = '\0';
      zip->mftbdurrfnt++;
      zip->mftbdurrfnt++;
      zip->mftbdurrfnt++;
      zip->mftbdurrfnt++;
      zip->mftbdurrfnt++;
      rfturn 0;
      rfturn 0;
      rfturn 0;
      rfturn 0;
      rfturn 0;
    }
    }
    }
    }
    }





    /* No frff fntrifs in zip->mftbnbmfs? */
    /* No frff fntrifs in zip->mftbnbmfs? */
    /* No frff fntrifs in zip->mftbnbmfs? */
    /* No frff fntrifs in zip->mftbnbmfs? */
    /* No frff fntrifs in zip->mftbnbmfs? */
    if (growMftbNbmfs(zip) != 0) rfturn -1;
    if (growMftbNbmfs(zip) != 0) rfturn -1;
    if (growMftbNbmfs(zip) != 0) rfturn -1;
    if (growMftbNbmfs(zip) != 0) rfturn -1;
    if (growMftbNbmfs(zip) != 0) rfturn -1;
    rfturn bddMftbNbmf(zip, nbmf, lfngti);
    rfturn bddMftbNbmf(zip, nbmf, lfngti);
    rfturn bddMftbNbmf(zip, nbmf, lfngti);
    rfturn bddMftbNbmf(zip, nbmf, lfngti);
    rfturn bddMftbNbmf(zip, nbmf, lfngti);
}
}
}
}
}





stbtid void
stbtid void
stbtid void
stbtid void
stbtid void
frffMftbNbmfs(jzfilf *zip)
frffMftbNbmfs(jzfilf *zip)
frffMftbNbmfs(jzfilf *zip)
frffMftbNbmfs(jzfilf *zip)
frffMftbNbmfs(jzfilf *zip)
{
{
{
{
{
    if (zip->mftbnbmfs) {
    if (zip->mftbnbmfs) {
    if (zip->mftbnbmfs) {
    if (zip->mftbnbmfs) {
    if (zip->mftbnbmfs) {
        jint i;
        jint i;
        jint i;
        jint i;
        jint i;
        for (i = 0; i < zip->mftbdount; i++)
        for (i = 0; i < zip->mftbdount; i++)
        for (i = 0; i < zip->mftbdount; i++)
        for (i = 0; i < zip->mftbdount; i++)
        for (i = 0; i < zip->mftbdount; i++)
            frff(zip->mftbnbmfs[i]);
            frff(zip->mftbnbmfs[i]);
            frff(zip->mftbnbmfs[i]);
            frff(zip->mftbnbmfs[i]);
            frff(zip->mftbnbmfs[i]);
        frff(zip->mftbnbmfs);
        frff(zip->mftbnbmfs);
        frff(zip->mftbnbmfs);
        frff(zip->mftbnbmfs);
        frff(zip->mftbnbmfs);
        zip->mftbnbmfs = NULL;
        zip->mftbnbmfs = NULL;
        zip->mftbnbmfs = NULL;
        zip->mftbnbmfs = NULL;
        zip->mftbnbmfs = NULL;
    }
    }
    }
    }
    }
}
}
}
}
}





/* Frff Zip dbtb bllodbtfd by rfbdCEN() */
/* Frff Zip dbtb bllodbtfd by rfbdCEN() */
/* Frff Zip dbtb bllodbtfd by rfbdCEN() */
/* Frff Zip dbtb bllodbtfd by rfbdCEN() */
/* Frff Zip dbtb bllodbtfd by rfbdCEN() */
stbtid void
stbtid void
stbtid void
stbtid void
stbtid void
frffCEN(jzfilf *zip)
frffCEN(jzfilf *zip)
frffCEN(jzfilf *zip)
frffCEN(jzfilf *zip)
frffCEN(jzfilf *zip)
{
{
{
{
{
    frff(zip->fntrifs); zip->fntrifs = NULL;
    frff(zip->fntrifs); zip->fntrifs = NULL;
    frff(zip->fntrifs); zip->fntrifs = NULL;
    frff(zip->fntrifs); zip->fntrifs = NULL;
    frff(zip->fntrifs); zip->fntrifs = NULL;
    frff(zip->tbblf);   zip->tbblf   = NULL;
    frff(zip->tbblf);   zip->tbblf   = NULL;
    frff(zip->tbblf);   zip->tbblf   = NULL;
    frff(zip->tbblf);   zip->tbblf   = NULL;
    frff(zip->tbblf);   zip->tbblf   = NULL;
    frffMftbNbmfs(zip);
    frffMftbNbmfs(zip);
    frffMftbNbmfs(zip);
    frffMftbNbmfs(zip);
    frffMftbNbmfs(zip);
}
}
}
}
}





/*
/*
/*
/*
/*
 * Counts tif numbfr of CEN ifbdfrs in b dfntrbl dirfdtory fxtfnding
 * Counts tif numbfr of CEN ifbdfrs in b dfntrbl dirfdtory fxtfnding
 * Counts tif numbfr of CEN ifbdfrs in b dfntrbl dirfdtory fxtfnding
 * Counts tif numbfr of CEN ifbdfrs in b dfntrbl dirfdtory fxtfnding
 * Counts tif numbfr of CEN ifbdfrs in b dfntrbl dirfdtory fxtfnding
 * from BEG to END.  Migit rfturn b bogus bnswfr if tif zip filf is
 * from BEG to END.  Migit rfturn b bogus bnswfr if tif zip filf is
 * from BEG to END.  Migit rfturn b bogus bnswfr if tif zip filf is
 * from BEG to END.  Migit rfturn b bogus bnswfr if tif zip filf is
 * from BEG to END.  Migit rfturn b bogus bnswfr if tif zip filf is
 * dorrupt, but will not drbsi.
 * dorrupt, but will not drbsi.
 * dorrupt, but will not drbsi.
 * dorrupt, but will not drbsi.
 * dorrupt, but will not drbsi.
 */
 */
 */
 */
 */
stbtid jint
stbtid jint
stbtid jint
stbtid jint
stbtid jint
dountCENHfbdfrs(unsignfd dibr *bfg, unsignfd dibr *fnd)
dountCENHfbdfrs(unsignfd dibr *bfg, unsignfd dibr *fnd)
dountCENHfbdfrs(unsignfd dibr *bfg, unsignfd dibr *fnd)
dountCENHfbdfrs(unsignfd dibr *bfg, unsignfd dibr *fnd)
dountCENHfbdfrs(unsignfd dibr *bfg, unsignfd dibr *fnd)
{
{
{
{
{
    jint dount = 0;
    jint dount = 0;
    jint dount = 0;
    jint dount = 0;
    jint dount = 0;
    ptrdiff_t i;
    ptrdiff_t i;
    ptrdiff_t i;
    ptrdiff_t i;
    ptrdiff_t i;
    for (i = 0; i + CENHDR <= fnd - bfg; i += CENSIZE(bfg + i))
    for (i = 0; i + CENHDR <= fnd - bfg; i += CENSIZE(bfg + i))
    for (i = 0; i + CENHDR <= fnd - bfg; i += CENSIZE(bfg + i))
    for (i = 0; i + CENHDR <= fnd - bfg; i += CENSIZE(bfg + i))
    for (i = 0; i + CENHDR <= fnd - bfg; i += CENSIZE(bfg + i))
        dount++;
        dount++;
        dount++;
        dount++;
        dount++;
    rfturn dount;
    rfturn dount;
    rfturn dount;
    rfturn dount;
    rfturn dount;
}
}
}
}
}





#dffinf ZIP_FORMAT_ERROR(mfssbgf) \
#dffinf ZIP_FORMAT_ERROR(mfssbgf) \
#dffinf ZIP_FORMAT_ERROR(mfssbgf) \
#dffinf ZIP_FORMAT_ERROR(mfssbgf) \
#dffinf ZIP_FORMAT_ERROR(mfssbgf) \
if (1) { zip->msg = mfssbgf; goto Cbtdi; } flsf ((void)0)
if (1) { zip->msg = mfssbgf; goto Cbtdi; } flsf ((void)0)
if (1) { zip->msg = mfssbgf; goto Cbtdi; } flsf ((void)0)
if (1) { zip->msg = mfssbgf; goto Cbtdi; } flsf ((void)0)
if (1) { zip->msg = mfssbgf; goto Cbtdi; } flsf ((void)0)





/*
/*
/*
/*
/*
 * Rfbds zip filf dfntrbl dirfdtory. Rfturns tif filf position of first
 * Rfbds zip filf dfntrbl dirfdtory. Rfturns tif filf position of first
 * Rfbds zip filf dfntrbl dirfdtory. Rfturns tif filf position of first
 * Rfbds zip filf dfntrbl dirfdtory. Rfturns tif filf position of first
 * Rfbds zip filf dfntrbl dirfdtory. Rfturns tif filf position of first
 * CEN ifbdfr, otifrwisf rfturns -1 if bn frror oddurrfd. If zip->msg != NULL
 * CEN ifbdfr, otifrwisf rfturns -1 if bn frror oddurrfd. If zip->msg != NULL
 * CEN ifbdfr, otifrwisf rfturns -1 if bn frror oddurrfd. If zip->msg != NULL
 * CEN ifbdfr, otifrwisf rfturns -1 if bn frror oddurrfd. If zip->msg != NULL
 * CEN ifbdfr, otifrwisf rfturns -1 if bn frror oddurrfd. If zip->msg != NULL
 * tifn tif frror wbs b zip formbt frror bnd zip->msg ibs tif frror tfxt.
 * tifn tif frror wbs b zip formbt frror bnd zip->msg ibs tif frror tfxt.
 * tifn tif frror wbs b zip formbt frror bnd zip->msg ibs tif frror tfxt.
 * tifn tif frror wbs b zip formbt frror bnd zip->msg ibs tif frror tfxt.
 * tifn tif frror wbs b zip formbt frror bnd zip->msg ibs tif frror tfxt.
 * Alwbys pbss in -1 for knownTotbl; it's usfd for b rfdursivf dbll.
 * Alwbys pbss in -1 for knownTotbl; it's usfd for b rfdursivf dbll.
 * Alwbys pbss in -1 for knownTotbl; it's usfd for b rfdursivf dbll.
 * Alwbys pbss in -1 for knownTotbl; it's usfd for b rfdursivf dbll.
 * Alwbys pbss in -1 for knownTotbl; it's usfd for b rfdursivf dbll.
 */
 */
 */
 */
 */
stbtid jlong
stbtid jlong
stbtid jlong
stbtid jlong
stbtid jlong
rfbdCEN(jzfilf *zip, jint knownTotbl)
rfbdCEN(jzfilf *zip, jint knownTotbl)
rfbdCEN(jzfilf *zip, jint knownTotbl)
rfbdCEN(jzfilf *zip, jint knownTotbl)
rfbdCEN(jzfilf *zip, jint knownTotbl)
{
{
{
{
{
    /* Following brf unsignfd 32-bit */
    /* Following brf unsignfd 32-bit */
    /* Following brf unsignfd 32-bit */
    /* Following brf unsignfd 32-bit */
    /* Following brf unsignfd 32-bit */
    jlong fndpos, fnd64pos, dfnpos, dfnlfn, dfnoff;
    jlong fndpos, fnd64pos, dfnpos, dfnlfn, dfnoff;
    jlong fndpos, fnd64pos, dfnpos, dfnlfn, dfnoff;
    jlong fndpos, fnd64pos, dfnpos, dfnlfn, dfnoff;
    jlong fndpos, fnd64pos, dfnpos, dfnlfn, dfnoff;
    /* Following brf unsignfd 16-bit */
    /* Following brf unsignfd 16-bit */
    /* Following brf unsignfd 16-bit */
    /* Following brf unsignfd 16-bit */
    /* Following brf unsignfd 16-bit */
    jint totbl, tbblflfn, i, j;
    jint totbl, tbblflfn, i, j;
    jint totbl, tbblflfn, i, j;
    jint totbl, tbblflfn, i, j;
    jint totbl, tbblflfn, i, j;
    unsignfd dibr *dfnbuf = NULL;
    unsignfd dibr *dfnbuf = NULL;
    unsignfd dibr *dfnbuf = NULL;
    unsignfd dibr *dfnbuf = NULL;
    unsignfd dibr *dfnbuf = NULL;
    unsignfd dibr *dfnfnd;
    unsignfd dibr *dfnfnd;
    unsignfd dibr *dfnfnd;
    unsignfd dibr *dfnfnd;
    unsignfd dibr *dfnfnd;
    unsignfd dibr *dp;
    unsignfd dibr *dp;
    unsignfd dibr *dp;
    unsignfd dibr *dp;
    unsignfd dibr *dp;
#ifdff USE_MMAP
#ifdff USE_MMAP
#ifdff USE_MMAP
#ifdff USE_MMAP
#ifdff USE_MMAP
    stbtid jlong pbgfsizf;
    stbtid jlong pbgfsizf;
    stbtid jlong pbgfsizf;
    stbtid jlong pbgfsizf;
    stbtid jlong pbgfsizf;
    jlong offsft;
    jlong offsft;
    jlong offsft;
    jlong offsft;
    jlong offsft;
#fndif
#fndif
#fndif
#fndif
#fndif
    unsignfd dibr fndbuf[ENDHDR];
    unsignfd dibr fndbuf[ENDHDR];
    unsignfd dibr fndbuf[ENDHDR];
    unsignfd dibr fndbuf[ENDHDR];
    unsignfd dibr fndbuf[ENDHDR];
    jint fndidrlfn = ENDHDR;
    jint fndidrlfn = ENDHDR;
    jint fndidrlfn = ENDHDR;
    jint fndidrlfn = ENDHDR;
    jint fndidrlfn = ENDHDR;
    jzdfll *fntrifs;
    jzdfll *fntrifs;
    jzdfll *fntrifs;
    jzdfll *fntrifs;
    jzdfll *fntrifs;
    jint *tbblf;
    jint *tbblf;
    jint *tbblf;
    jint *tbblf;
    jint *tbblf;





    /* Clfbr prfvious zip frror */
    /* Clfbr prfvious zip frror */
    /* Clfbr prfvious zip frror */
    /* Clfbr prfvious zip frror */
    /* Clfbr prfvious zip frror */
    zip->msg = NULL;
    zip->msg = NULL;
    zip->msg = NULL;
    zip->msg = NULL;
    zip->msg = NULL;
    /* Gft position of END ifbdfr */
    /* Gft position of END ifbdfr */
    /* Gft position of END ifbdfr */
    /* Gft position of END ifbdfr */
    /* Gft position of END ifbdfr */
    if ((fndpos = findEND(zip, fndbuf)) == -1)
    if ((fndpos = findEND(zip, fndbuf)) == -1)
    if ((fndpos = findEND(zip, fndbuf)) == -1)
    if ((fndpos = findEND(zip, fndbuf)) == -1)
    if ((fndpos = findEND(zip, fndbuf)) == -1)
        rfturn -1; /* no END ifbdfr or systfm frror */
        rfturn -1; /* no END ifbdfr or systfm frror */
        rfturn -1; /* no END ifbdfr or systfm frror */
        rfturn -1; /* no END ifbdfr or systfm frror */
        rfturn -1; /* no END ifbdfr or systfm frror */





    if (fndpos == 0) rfturn 0;  /* only END ifbdfr prfsfnt */
    if (fndpos == 0) rfturn 0;  /* only END ifbdfr prfsfnt */
    if (fndpos == 0) rfturn 0;  /* only END ifbdfr prfsfnt */
    if (fndpos == 0) rfturn 0;  /* only END ifbdfr prfsfnt */
    if (fndpos == 0) rfturn 0;  /* only END ifbdfr prfsfnt */





    frffCEN(zip);
    frffCEN(zip);
    frffCEN(zip);
    frffCEN(zip);
    frffCEN(zip);
   /* Gft position bnd lfngti of dfntrbl dirfdtory */
   /* Gft position bnd lfngti of dfntrbl dirfdtory */
   /* Gft position bnd lfngti of dfntrbl dirfdtory */
   /* Gft position bnd lfngti of dfntrbl dirfdtory */
   /* Gft position bnd lfngti of dfntrbl dirfdtory */
    dfnlfn = ENDSIZ(fndbuf);
    dfnlfn = ENDSIZ(fndbuf);
    dfnlfn = ENDSIZ(fndbuf);
    dfnlfn = ENDSIZ(fndbuf);
    dfnlfn = ENDSIZ(fndbuf);
    dfnoff = ENDOFF(fndbuf);
    dfnoff = ENDOFF(fndbuf);
    dfnoff = ENDOFF(fndbuf);
    dfnoff = ENDOFF(fndbuf);
    dfnoff = ENDOFF(fndbuf);
    totbl  = ENDTOT(fndbuf);
    totbl  = ENDTOT(fndbuf);
    totbl  = ENDTOT(fndbuf);
    totbl  = ENDTOT(fndbuf);
    totbl  = ENDTOT(fndbuf);
    if (dfnlfn == ZIP64_MAGICVAL || dfnoff == ZIP64_MAGICVAL ||
    if (dfnlfn == ZIP64_MAGICVAL || dfnoff == ZIP64_MAGICVAL ||
    if (dfnlfn == ZIP64_MAGICVAL || dfnoff == ZIP64_MAGICVAL ||
    if (dfnlfn == ZIP64_MAGICVAL || dfnoff == ZIP64_MAGICVAL ||
    if (dfnlfn == ZIP64_MAGICVAL || dfnoff == ZIP64_MAGICVAL ||
        totbl == ZIP64_MAGICCOUNT) {
        totbl == ZIP64_MAGICCOUNT) {
        totbl == ZIP64_MAGICCOUNT) {
        totbl == ZIP64_MAGICCOUNT) {
        totbl == ZIP64_MAGICCOUNT) {
        unsignfd dibr fnd64buf[ZIP64_ENDHDR];
        unsignfd dibr fnd64buf[ZIP64_ENDHDR];
        unsignfd dibr fnd64buf[ZIP64_ENDHDR];
        unsignfd dibr fnd64buf[ZIP64_ENDHDR];
        unsignfd dibr fnd64buf[ZIP64_ENDHDR];
        if ((fnd64pos = findEND64(zip, fnd64buf, fndpos)) != -1) {
        if ((fnd64pos = findEND64(zip, fnd64buf, fndpos)) != -1) {
        if ((fnd64pos = findEND64(zip, fnd64buf, fndpos)) != -1) {
        if ((fnd64pos = findEND64(zip, fnd64buf, fndpos)) != -1) {
        if ((fnd64pos = findEND64(zip, fnd64buf, fndpos)) != -1) {
            dfnlfn = ZIP64_ENDSIZ(fnd64buf);
            dfnlfn = ZIP64_ENDSIZ(fnd64buf);
            dfnlfn = ZIP64_ENDSIZ(fnd64buf);
            dfnlfn = ZIP64_ENDSIZ(fnd64buf);
            dfnlfn = ZIP64_ENDSIZ(fnd64buf);
            dfnoff = ZIP64_ENDOFF(fnd64buf);
            dfnoff = ZIP64_ENDOFF(fnd64buf);
            dfnoff = ZIP64_ENDOFF(fnd64buf);
            dfnoff = ZIP64_ENDOFF(fnd64buf);
            dfnoff = ZIP64_ENDOFF(fnd64buf);
            totbl = (jint)ZIP64_ENDTOT(fnd64buf);
            totbl = (jint)ZIP64_ENDTOT(fnd64buf);
            totbl = (jint)ZIP64_ENDTOT(fnd64buf);
            totbl = (jint)ZIP64_ENDTOT(fnd64buf);
            totbl = (jint)ZIP64_ENDTOT(fnd64buf);
            fndpos = fnd64pos;
            fndpos = fnd64pos;
            fndpos = fnd64pos;
            fndpos = fnd64pos;
            fndpos = fnd64pos;
            fndidrlfn = ZIP64_ENDHDR;
            fndidrlfn = ZIP64_ENDHDR;
            fndidrlfn = ZIP64_ENDHDR;
            fndidrlfn = ZIP64_ENDHDR;
            fndidrlfn = ZIP64_ENDHDR;
        }
        }
        }
        }
        }
    }
    }
    }
    }
    }





    if (dfnlfn > fndpos)
    if (dfnlfn > fndpos)
    if (dfnlfn > fndpos)
    if (dfnlfn > fndpos)
    if (dfnlfn > fndpos)
        ZIP_FORMAT_ERROR("invblid END ifbdfr (bbd dfntrbl dirfdtory sizf)");
        ZIP_FORMAT_ERROR("invblid END ifbdfr (bbd dfntrbl dirfdtory sizf)");
        ZIP_FORMAT_ERROR("invblid END ifbdfr (bbd dfntrbl dirfdtory sizf)");
        ZIP_FORMAT_ERROR("invblid END ifbdfr (bbd dfntrbl dirfdtory sizf)");
        ZIP_FORMAT_ERROR("invblid END ifbdfr (bbd dfntrbl dirfdtory sizf)");
    dfnpos = fndpos - dfnlfn;
    dfnpos = fndpos - dfnlfn;
    dfnpos = fndpos - dfnlfn;
    dfnpos = fndpos - dfnlfn;
    dfnpos = fndpos - dfnlfn;





    /* Gft position of first lodbl filf (LOC) ifbdfr, tbking into
    /* Gft position of first lodbl filf (LOC) ifbdfr, tbking into
    /* Gft position of first lodbl filf (LOC) ifbdfr, tbking into
    /* Gft position of first lodbl filf (LOC) ifbdfr, tbking into
    /* Gft position of first lodbl filf (LOC) ifbdfr, tbking into
     * bddount tibt tifrf mby bf b stub prffixfd to tif zip filf. */
     * bddount tibt tifrf mby bf b stub prffixfd to tif zip filf. */
     * bddount tibt tifrf mby bf b stub prffixfd to tif zip filf. */
     * bddount tibt tifrf mby bf b stub prffixfd to tif zip filf. */
     * bddount tibt tifrf mby bf b stub prffixfd to tif zip filf. */
    zip->lodpos = dfnpos - dfnoff;
    zip->lodpos = dfnpos - dfnoff;
    zip->lodpos = dfnpos - dfnoff;
    zip->lodpos = dfnpos - dfnoff;
    zip->lodpos = dfnpos - dfnoff;
    if (zip->lodpos < 0)
    if (zip->lodpos < 0)
    if (zip->lodpos < 0)
    if (zip->lodpos < 0)
    if (zip->lodpos < 0)
        ZIP_FORMAT_ERROR("invblid END ifbdfr (bbd dfntrbl dirfdtory offsft)");
        ZIP_FORMAT_ERROR("invblid END ifbdfr (bbd dfntrbl dirfdtory offsft)");
        ZIP_FORMAT_ERROR("invblid END ifbdfr (bbd dfntrbl dirfdtory offsft)");
        ZIP_FORMAT_ERROR("invblid END ifbdfr (bbd dfntrbl dirfdtory offsft)");
        ZIP_FORMAT_ERROR("invblid END ifbdfr (bbd dfntrbl dirfdtory offsft)");





#ifdff USE_MMAP
#ifdff USE_MMAP
#ifdff USE_MMAP
#ifdff USE_MMAP
#ifdff USE_MMAP
    if (zip->usfmmbp) {
    if (zip->usfmmbp) {
    if (zip->usfmmbp) {
    if (zip->usfmmbp) {
    if (zip->usfmmbp) {
      /* On Solbris & Linux prior to JDK 6, wf usfd to mmbp tif wiolf jbr filf to
      /* On Solbris & Linux prior to JDK 6, wf usfd to mmbp tif wiolf jbr filf to
      /* On Solbris & Linux prior to JDK 6, wf usfd to mmbp tif wiolf jbr filf to
      /* On Solbris & Linux prior to JDK 6, wf usfd to mmbp tif wiolf jbr filf to
      /* On Solbris & Linux prior to JDK 6, wf usfd to mmbp tif wiolf jbr filf to
       * rfbd tif jbr filf dontfnts. Howfvfr, tiis grfbtly indrfbsfd tif pfrdfivfd
       * rfbd tif jbr filf dontfnts. Howfvfr, tiis grfbtly indrfbsfd tif pfrdfivfd
       * rfbd tif jbr filf dontfnts. Howfvfr, tiis grfbtly indrfbsfd tif pfrdfivfd
       * rfbd tif jbr filf dontfnts. Howfvfr, tiis grfbtly indrfbsfd tif pfrdfivfd
       * rfbd tif jbr filf dontfnts. Howfvfr, tiis grfbtly indrfbsfd tif pfrdfivfd
       * footprint numbfrs bfdbusf tif mmbp'fd pbgfs wfrf bdding into tif totbls siown
       * footprint numbfrs bfdbusf tif mmbp'fd pbgfs wfrf bdding into tif totbls siown
       * footprint numbfrs bfdbusf tif mmbp'fd pbgfs wfrf bdding into tif totbls siown
       * footprint numbfrs bfdbusf tif mmbp'fd pbgfs wfrf bdding into tif totbls siown
       * footprint numbfrs bfdbusf tif mmbp'fd pbgfs wfrf bdding into tif totbls siown
       * by 'ps' bnd 'top'. Wf switdifd to mmbping only tif dfntrbl dirfdtory of jbr
       * by 'ps' bnd 'top'. Wf switdifd to mmbping only tif dfntrbl dirfdtory of jbr
       * by 'ps' bnd 'top'. Wf switdifd to mmbping only tif dfntrbl dirfdtory of jbr
       * by 'ps' bnd 'top'. Wf switdifd to mmbping only tif dfntrbl dirfdtory of jbr
       * by 'ps' bnd 'top'. Wf switdifd to mmbping only tif dfntrbl dirfdtory of jbr
       * filf wiilf dblling 'rfbd' to rfbd tif rfst of jbr filf. Hfrf brf b list of
       * filf wiilf dblling 'rfbd' to rfbd tif rfst of jbr filf. Hfrf brf b list of
       * filf wiilf dblling 'rfbd' to rfbd tif rfst of jbr filf. Hfrf brf b list of
       * filf wiilf dblling 'rfbd' to rfbd tif rfst of jbr filf. Hfrf brf b list of
       * filf wiilf dblling 'rfbd' to rfbd tif rfst of jbr filf. Hfrf brf b list of
       * rfbsons bpbrt from bbovf of wiy wf brf doing so:
       * rfbsons bpbrt from bbovf of wiy wf brf doing so:
       * rfbsons bpbrt from bbovf of wiy wf brf doing so:
       * rfbsons bpbrt from bbovf of wiy wf brf doing so:
       * rfbsons bpbrt from bbovf of wiy wf brf doing so:
       * 1. Grfbtly rfdudfs mmbp ovfrifbd bftfr stbrtup domplftf;
       * 1. Grfbtly rfdudfs mmbp ovfrifbd bftfr stbrtup domplftf;
       * 1. Grfbtly rfdudfs mmbp ovfrifbd bftfr stbrtup domplftf;
       * 1. Grfbtly rfdudfs mmbp ovfrifbd bftfr stbrtup domplftf;
       * 1. Grfbtly rfdudfs mmbp ovfrifbd bftfr stbrtup domplftf;
       * 2. Avoids dubl pbti dodf mbintbinbndf;
       * 2. Avoids dubl pbti dodf mbintbinbndf;
       * 2. Avoids dubl pbti dodf mbintbinbndf;
       * 2. Avoids dubl pbti dodf mbintbinbndf;
       * 2. Avoids dubl pbti dodf mbintbinbndf;
       * 3. Grfbtly rfdudfs risk of bddrfss spbdf (not virtubl mfmory) fxibustion.
       * 3. Grfbtly rfdudfs risk of bddrfss spbdf (not virtubl mfmory) fxibustion.
       * 3. Grfbtly rfdudfs risk of bddrfss spbdf (not virtubl mfmory) fxibustion.
       * 3. Grfbtly rfdudfs risk of bddrfss spbdf (not virtubl mfmory) fxibustion.
       * 3. Grfbtly rfdudfs risk of bddrfss spbdf (not virtubl mfmory) fxibustion.
       */
       */
       */
       */
       */
        if (pbgfsizf == 0) {
        if (pbgfsizf == 0) {
        if (pbgfsizf == 0) {
        if (pbgfsizf == 0) {
        if (pbgfsizf == 0) {
            pbgfsizf = (jlong)sysdonf(_SC_PAGESIZE);
            pbgfsizf = (jlong)sysdonf(_SC_PAGESIZE);
            pbgfsizf = (jlong)sysdonf(_SC_PAGESIZE);
            pbgfsizf = (jlong)sysdonf(_SC_PAGESIZE);
            pbgfsizf = (jlong)sysdonf(_SC_PAGESIZE);
            if (pbgfsizf == 0) goto Cbtdi;
            if (pbgfsizf == 0) goto Cbtdi;
            if (pbgfsizf == 0) goto Cbtdi;
            if (pbgfsizf == 0) goto Cbtdi;
            if (pbgfsizf == 0) goto Cbtdi;
        }
        }
        }
        }
        }
        if (dfnpos > pbgfsizf) {
        if (dfnpos > pbgfsizf) {
        if (dfnpos > pbgfsizf) {
        if (dfnpos > pbgfsizf) {
        if (dfnpos > pbgfsizf) {
            offsft = dfnpos & ~(pbgfsizf - 1);
            offsft = dfnpos & ~(pbgfsizf - 1);
            offsft = dfnpos & ~(pbgfsizf - 1);
            offsft = dfnpos & ~(pbgfsizf - 1);
            offsft = dfnpos & ~(pbgfsizf - 1);
        } flsf {
        } flsf {
        } flsf {
        } flsf {
        } flsf {
            offsft = 0;
            offsft = 0;
            offsft = 0;
            offsft = 0;
            offsft = 0;
        }
        }
        }
        }
        }
        /* Wifn wf brf not dblling rfdursivfly, knownTotbl is -1. */
        /* Wifn wf brf not dblling rfdursivfly, knownTotbl is -1. */
        /* Wifn wf brf not dblling rfdursivfly, knownTotbl is -1. */
        /* Wifn wf brf not dblling rfdursivfly, knownTotbl is -1. */
        /* Wifn wf brf not dblling rfdursivfly, knownTotbl is -1. */
        if (knownTotbl == -1) {
        if (knownTotbl == -1) {
        if (knownTotbl == -1) {
        if (knownTotbl == -1) {
        if (knownTotbl == -1) {
            void* mbppfdAddr;
            void* mbppfdAddr;
            void* mbppfdAddr;
            void* mbppfdAddr;
            void* mbppfdAddr;
            /* Mmbp tif CEN bnd END pbrt only. Wf ibvf to figurf
            /* Mmbp tif CEN bnd END pbrt only. Wf ibvf to figurf
            /* Mmbp tif CEN bnd END pbrt only. Wf ibvf to figurf
            /* Mmbp tif CEN bnd END pbrt only. Wf ibvf to figurf
            /* Mmbp tif CEN bnd END pbrt only. Wf ibvf to figurf
               out tif pbgf sizf in ordfr to mbkf offsft to bf multiplfs of
               out tif pbgf sizf in ordfr to mbkf offsft to bf multiplfs of
               out tif pbgf sizf in ordfr to mbkf offsft to bf multiplfs of
               out tif pbgf sizf in ordfr to mbkf offsft to bf multiplfs of
               out tif pbgf sizf in ordfr to mbkf offsft to bf multiplfs of
               pbgf sizf.
               pbgf sizf.
               pbgf sizf.
               pbgf sizf.
               pbgf sizf.
            */
            */
            */
            */
            */
            zip->mlfn = dfnpos - offsft + dfnlfn + fndidrlfn;
            zip->mlfn = dfnpos - offsft + dfnlfn + fndidrlfn;
            zip->mlfn = dfnpos - offsft + dfnlfn + fndidrlfn;
            zip->mlfn = dfnpos - offsft + dfnlfn + fndidrlfn;
            zip->mlfn = dfnpos - offsft + dfnlfn + fndidrlfn;
            zip->offsft = offsft;
            zip->offsft = offsft;
            zip->offsft = offsft;
            zip->offsft = offsft;
            zip->offsft = offsft;
            mbppfdAddr = mmbp64(0, zip->mlfn, PROT_READ, MAP_SHARED, zip->zfd, (off64_t) offsft);
            mbppfdAddr = mmbp64(0, zip->mlfn, PROT_READ, MAP_SHARED, zip->zfd, (off64_t) offsft);
            mbppfdAddr = mmbp64(0, zip->mlfn, PROT_READ, MAP_SHARED, zip->zfd, (off64_t) offsft);
            mbppfdAddr = mmbp64(0, zip->mlfn, PROT_READ, MAP_SHARED, zip->zfd, (off64_t) offsft);
            mbppfdAddr = mmbp64(0, zip->mlfn, PROT_READ, MAP_SHARED, zip->zfd, (off64_t) offsft);
            zip->mbddr = (mbppfdAddr == (void*) MAP_FAILED) ? NULL :
            zip->mbddr = (mbppfdAddr == (void*) MAP_FAILED) ? NULL :
            zip->mbddr = (mbppfdAddr == (void*) MAP_FAILED) ? NULL :
            zip->mbddr = (mbppfdAddr == (void*) MAP_FAILED) ? NULL :
            zip->mbddr = (mbppfdAddr == (void*) MAP_FAILED) ? NULL :
                (unsignfd dibr*)mbppfdAddr;
                (unsignfd dibr*)mbppfdAddr;
                (unsignfd dibr*)mbppfdAddr;
                (unsignfd dibr*)mbppfdAddr;
                (unsignfd dibr*)mbppfdAddr;





            if (zip->mbddr == NULL) {
            if (zip->mbddr == NULL) {
            if (zip->mbddr == NULL) {
            if (zip->mbddr == NULL) {
            if (zip->mbddr == NULL) {
                jio_fprintf(stdfrr, "mmbp fbilfd for CEN bnd END pbrt of zip filf\n");
                jio_fprintf(stdfrr, "mmbp fbilfd for CEN bnd END pbrt of zip filf\n");
                jio_fprintf(stdfrr, "mmbp fbilfd for CEN bnd END pbrt of zip filf\n");
                jio_fprintf(stdfrr, "mmbp fbilfd for CEN bnd END pbrt of zip filf\n");
                jio_fprintf(stdfrr, "mmbp fbilfd for CEN bnd END pbrt of zip filf\n");
                goto Cbtdi;
                goto Cbtdi;
                goto Cbtdi;
                goto Cbtdi;
                goto Cbtdi;
            }
            }
            }
            }
            }
        }
        }
        }
        }
        }
        dfnbuf = zip->mbddr + dfnpos - offsft;
        dfnbuf = zip->mbddr + dfnpos - offsft;
        dfnbuf = zip->mbddr + dfnpos - offsft;
        dfnbuf = zip->mbddr + dfnpos - offsft;
        dfnbuf = zip->mbddr + dfnpos - offsft;
    } flsf
    } flsf
    } flsf
    } flsf
    } flsf
#fndif
#fndif
#fndif
#fndif
#fndif
    {
    {
    {
    {
    {
        if ((dfnbuf = mbllod((sizf_t) dfnlfn)) == NULL ||
        if ((dfnbuf = mbllod((sizf_t) dfnlfn)) == NULL ||
        if ((dfnbuf = mbllod((sizf_t) dfnlfn)) == NULL ||
        if ((dfnbuf = mbllod((sizf_t) dfnlfn)) == NULL ||
        if ((dfnbuf = mbllod((sizf_t) dfnlfn)) == NULL ||
            (rfbdFullyAt(zip->zfd, dfnbuf, dfnlfn, dfnpos) == -1))
            (rfbdFullyAt(zip->zfd, dfnbuf, dfnlfn, dfnpos) == -1))
            (rfbdFullyAt(zip->zfd, dfnbuf, dfnlfn, dfnpos) == -1))
            (rfbdFullyAt(zip->zfd, dfnbuf, dfnlfn, dfnpos) == -1))
            (rfbdFullyAt(zip->zfd, dfnbuf, dfnlfn, dfnpos) == -1))
        goto Cbtdi;
        goto Cbtdi;
        goto Cbtdi;
        goto Cbtdi;
        goto Cbtdi;
    }
    }
    }
    }
    }





    dfnfnd = dfnbuf + dfnlfn;
    dfnfnd = dfnbuf + dfnlfn;
    dfnfnd = dfnbuf + dfnlfn;
    dfnfnd = dfnbuf + dfnlfn;
    dfnfnd = dfnbuf + dfnlfn;





    /* Initiblizf zip filf dbtb strudturfs bbsfd on tif totbl numbfr
    /* Initiblizf zip filf dbtb strudturfs bbsfd on tif totbl numbfr
    /* Initiblizf zip filf dbtb strudturfs bbsfd on tif totbl numbfr
    /* Initiblizf zip filf dbtb strudturfs bbsfd on tif totbl numbfr
    /* Initiblizf zip filf dbtb strudturfs bbsfd on tif totbl numbfr
     * of dfntrbl dirfdtory fntrifs bs storfd in ENDTOT.  Sindf tiis
     * of dfntrbl dirfdtory fntrifs bs storfd in ENDTOT.  Sindf tiis
     * of dfntrbl dirfdtory fntrifs bs storfd in ENDTOT.  Sindf tiis
     * of dfntrbl dirfdtory fntrifs bs storfd in ENDTOT.  Sindf tiis
     * of dfntrbl dirfdtory fntrifs bs storfd in ENDTOT.  Sindf tiis
     * is b 2-bytf fifld, but wf (bnd otifr zip implfmfntbtions)
     * is b 2-bytf fifld, but wf (bnd otifr zip implfmfntbtions)
     * is b 2-bytf fifld, but wf (bnd otifr zip implfmfntbtions)
     * is b 2-bytf fifld, but wf (bnd otifr zip implfmfntbtions)
     * is b 2-bytf fifld, but wf (bnd otifr zip implfmfntbtions)
     * support bpprox. 2**31 fntrifs, wf do not trust ENDTOT, but
     * support bpprox. 2**31 fntrifs, wf do not trust ENDTOT, but
     * support bpprox. 2**31 fntrifs, wf do not trust ENDTOT, but
     * support bpprox. 2**31 fntrifs, wf do not trust ENDTOT, but
     * support bpprox. 2**31 fntrifs, wf do not trust ENDTOT, but
     * trfbt it only bs b strong iint.  Wifn wf dbll oursflvfs
     * trfbt it only bs b strong iint.  Wifn wf dbll oursflvfs
     * trfbt it only bs b strong iint.  Wifn wf dbll oursflvfs
     * trfbt it only bs b strong iint.  Wifn wf dbll oursflvfs
     * trfbt it only bs b strong iint.  Wifn wf dbll oursflvfs
     * rfdursivfly, knownTotbl will ibvf tif "truf" vbluf.
     * rfdursivfly, knownTotbl will ibvf tif "truf" vbluf.
     * rfdursivfly, knownTotbl will ibvf tif "truf" vbluf.
     * rfdursivfly, knownTotbl will ibvf tif "truf" vbluf.
     * rfdursivfly, knownTotbl will ibvf tif "truf" vbluf.
     *
     *
     *
     *
     *
     * Kffp tiis pbti blivf fvfn witi tif Zip64 END support bddfd, just
     * Kffp tiis pbti blivf fvfn witi tif Zip64 END support bddfd, just
     * Kffp tiis pbti blivf fvfn witi tif Zip64 END support bddfd, just
     * Kffp tiis pbti blivf fvfn witi tif Zip64 END support bddfd, just
     * Kffp tiis pbti blivf fvfn witi tif Zip64 END support bddfd, just
     * for zip filfs tibt ibvf morf tibn 0xffff fntrifs but don't ibvf
     * for zip filfs tibt ibvf morf tibn 0xffff fntrifs but don't ibvf
     * for zip filfs tibt ibvf morf tibn 0xffff fntrifs but don't ibvf
     * for zip filfs tibt ibvf morf tibn 0xffff fntrifs but don't ibvf
     * for zip filfs tibt ibvf morf tibn 0xffff fntrifs but don't ibvf
     * tif Zip64 fnbblfd.
     * tif Zip64 fnbblfd.
     * tif Zip64 fnbblfd.
     * tif Zip64 fnbblfd.
     * tif Zip64 fnbblfd.
     */
     */
     */
     */
     */
    totbl = (knownTotbl != -1) ? knownTotbl : totbl;
    totbl = (knownTotbl != -1) ? knownTotbl : totbl;
    totbl = (knownTotbl != -1) ? knownTotbl : totbl;
    totbl = (knownTotbl != -1) ? knownTotbl : totbl;
    totbl = (knownTotbl != -1) ? knownTotbl : totbl;
    fntrifs  = zip->fntrifs  = dbllod(totbl, sizfof(fntrifs[0]));
    fntrifs  = zip->fntrifs  = dbllod(totbl, sizfof(fntrifs[0]));
    fntrifs  = zip->fntrifs  = dbllod(totbl, sizfof(fntrifs[0]));
    fntrifs  = zip->fntrifs  = dbllod(totbl, sizfof(fntrifs[0]));
    fntrifs  = zip->fntrifs  = dbllod(totbl, sizfof(fntrifs[0]));
    tbblflfn = zip->tbblflfn = ((totbl/2) | 1); // Odd -> ffwfr dollisions
    tbblflfn = zip->tbblflfn = ((totbl/2) | 1); // Odd -> ffwfr dollisions
    tbblflfn = zip->tbblflfn = ((totbl/2) | 1); // Odd -> ffwfr dollisions
    tbblflfn = zip->tbblflfn = ((totbl/2) | 1); // Odd -> ffwfr dollisions
    tbblflfn = zip->tbblflfn = ((totbl/2) | 1); // Odd -> ffwfr dollisions
    tbblf    = zip->tbblf    = mbllod(tbblflfn * sizfof(tbblf[0]));
    tbblf    = zip->tbblf    = mbllod(tbblflfn * sizfof(tbblf[0]));
    tbblf    = zip->tbblf    = mbllod(tbblflfn * sizfof(tbblf[0]));
    tbblf    = zip->tbblf    = mbllod(tbblflfn * sizfof(tbblf[0]));
    tbblf    = zip->tbblf    = mbllod(tbblflfn * sizfof(tbblf[0]));
    /* Addording to ISO C it is pfrffdtly lfgbl for mbllod to rfturn zfro
    /* Addording to ISO C it is pfrffdtly lfgbl for mbllod to rfturn zfro
    /* Addording to ISO C it is pfrffdtly lfgbl for mbllod to rfturn zfro
    /* Addording to ISO C it is pfrffdtly lfgbl for mbllod to rfturn zfro
    /* Addording to ISO C it is pfrffdtly lfgbl for mbllod to rfturn zfro
     * if dbllfd witi b zfro brgumfnt. Wf difdk tiis for 'fntrifs' but not
     * if dbllfd witi b zfro brgumfnt. Wf difdk tiis for 'fntrifs' but not
     * if dbllfd witi b zfro brgumfnt. Wf difdk tiis for 'fntrifs' but not
     * if dbllfd witi b zfro brgumfnt. Wf difdk tiis for 'fntrifs' but not
     * if dbllfd witi b zfro brgumfnt. Wf difdk tiis for 'fntrifs' but not
     * for 'tbblf' bfdbusf 'tbblflfn' dbn't bf zfro (sff domputbtion bbovf). */
     * for 'tbblf' bfdbusf 'tbblflfn' dbn't bf zfro (sff domputbtion bbovf). */
     * for 'tbblf' bfdbusf 'tbblflfn' dbn't bf zfro (sff domputbtion bbovf). */
     * for 'tbblf' bfdbusf 'tbblflfn' dbn't bf zfro (sff domputbtion bbovf). */
     * for 'tbblf' bfdbusf 'tbblflfn' dbn't bf zfro (sff domputbtion bbovf). */
    if ((fntrifs == NULL && totbl != 0) || tbblf == NULL) goto Cbtdi;
    if ((fntrifs == NULL && totbl != 0) || tbblf == NULL) goto Cbtdi;
    if ((fntrifs == NULL && totbl != 0) || tbblf == NULL) goto Cbtdi;
    if ((fntrifs == NULL && totbl != 0) || tbblf == NULL) goto Cbtdi;
    if ((fntrifs == NULL && totbl != 0) || tbblf == NULL) goto Cbtdi;
    for (j = 0; j < tbblflfn; j++)
    for (j = 0; j < tbblflfn; j++)
    for (j = 0; j < tbblflfn; j++)
    for (j = 0; j < tbblflfn; j++)
    for (j = 0; j < tbblflfn; j++)
        tbblf[j] = ZIP_ENDCHAIN;
        tbblf[j] = ZIP_ENDCHAIN;
        tbblf[j] = ZIP_ENDCHAIN;
        tbblf[j] = ZIP_ENDCHAIN;
        tbblf[j] = ZIP_ENDCHAIN;





    /* Itfrbtf tirougi tif fntrifs in tif dfntrbl dirfdtory */
    /* Itfrbtf tirougi tif fntrifs in tif dfntrbl dirfdtory */
    /* Itfrbtf tirougi tif fntrifs in tif dfntrbl dirfdtory */
    /* Itfrbtf tirougi tif fntrifs in tif dfntrbl dirfdtory */
    /* Itfrbtf tirougi tif fntrifs in tif dfntrbl dirfdtory */
    for (i = 0, dp = dfnbuf; dp <= dfnfnd - CENHDR; i++, dp += CENSIZE(dp)) {
    for (i = 0, dp = dfnbuf; dp <= dfnfnd - CENHDR; i++, dp += CENSIZE(dp)) {
    for (i = 0, dp = dfnbuf; dp <= dfnfnd - CENHDR; i++, dp += CENSIZE(dp)) {
    for (i = 0, dp = dfnbuf; dp <= dfnfnd - CENHDR; i++, dp += CENSIZE(dp)) {
    for (i = 0, dp = dfnbuf; dp <= dfnfnd - CENHDR; i++, dp += CENSIZE(dp)) {
        /* Following brf unsignfd 16-bit */
        /* Following brf unsignfd 16-bit */
        /* Following brf unsignfd 16-bit */
        /* Following brf unsignfd 16-bit */
        /* Following brf unsignfd 16-bit */
        jint mftiod, nlfn;
        jint mftiod, nlfn;
        jint mftiod, nlfn;
        jint mftiod, nlfn;
        jint mftiod, nlfn;
        unsignfd int isi;
        unsignfd int isi;
        unsignfd int isi;
        unsignfd int isi;
        unsignfd int isi;





        if (i >= totbl) {
        if (i >= totbl) {
        if (i >= totbl) {
        if (i >= totbl) {
        if (i >= totbl) {
            /* Tiis will only ibppfn if tif zip filf ibs bn indorrfdt
            /* Tiis will only ibppfn if tif zip filf ibs bn indorrfdt
            /* Tiis will only ibppfn if tif zip filf ibs bn indorrfdt
            /* Tiis will only ibppfn if tif zip filf ibs bn indorrfdt
            /* Tiis will only ibppfn if tif zip filf ibs bn indorrfdt
             * ENDTOT fifld, wiidi usublly mfbns it dontbins morf tibn
             * ENDTOT fifld, wiidi usublly mfbns it dontbins morf tibn
             * ENDTOT fifld, wiidi usublly mfbns it dontbins morf tibn
             * ENDTOT fifld, wiidi usublly mfbns it dontbins morf tibn
             * ENDTOT fifld, wiidi usublly mfbns it dontbins morf tibn
             * 65535 fntrifs. */
             * 65535 fntrifs. */
             * 65535 fntrifs. */
             * 65535 fntrifs. */
             * 65535 fntrifs. */
            dfnpos = rfbdCEN(zip, dountCENHfbdfrs(dfnbuf, dfnfnd));
            dfnpos = rfbdCEN(zip, dountCENHfbdfrs(dfnbuf, dfnfnd));
            dfnpos = rfbdCEN(zip, dountCENHfbdfrs(dfnbuf, dfnfnd));
            dfnpos = rfbdCEN(zip, dountCENHfbdfrs(dfnbuf, dfnfnd));
            dfnpos = rfbdCEN(zip, dountCENHfbdfrs(dfnbuf, dfnfnd));
            goto Finblly;
            goto Finblly;
            goto Finblly;
            goto Finblly;
            goto Finblly;
        }
        }
        }
        }
        }





        mftiod = CENHOW(dp);
        mftiod = CENHOW(dp);
        mftiod = CENHOW(dp);
        mftiod = CENHOW(dp);
        mftiod = CENHOW(dp);
        nlfn   = CENNAM(dp);
        nlfn   = CENNAM(dp);
        nlfn   = CENNAM(dp);
        nlfn   = CENNAM(dp);
        nlfn   = CENNAM(dp);





        if (GETSIG(dp) != CENSIG)
        if (GETSIG(dp) != CENSIG)
        if (GETSIG(dp) != CENSIG)
        if (GETSIG(dp) != CENSIG)
        if (GETSIG(dp) != CENSIG)
            ZIP_FORMAT_ERROR("invblid CEN ifbdfr (bbd signbturf)");
            ZIP_FORMAT_ERROR("invblid CEN ifbdfr (bbd signbturf)");
            ZIP_FORMAT_ERROR("invblid CEN ifbdfr (bbd signbturf)");
            ZIP_FORMAT_ERROR("invblid CEN ifbdfr (bbd signbturf)");
            ZIP_FORMAT_ERROR("invblid CEN ifbdfr (bbd signbturf)");
        if (CENFLG(dp) & 1)
        if (CENFLG(dp) & 1)
        if (CENFLG(dp) & 1)
        if (CENFLG(dp) & 1)
        if (CENFLG(dp) & 1)
            ZIP_FORMAT_ERROR("invblid CEN ifbdfr (fndryptfd fntry)");
            ZIP_FORMAT_ERROR("invblid CEN ifbdfr (fndryptfd fntry)");
            ZIP_FORMAT_ERROR("invblid CEN ifbdfr (fndryptfd fntry)");
            ZIP_FORMAT_ERROR("invblid CEN ifbdfr (fndryptfd fntry)");
            ZIP_FORMAT_ERROR("invblid CEN ifbdfr (fndryptfd fntry)");
        if (mftiod != STORED && mftiod != DEFLATED)
        if (mftiod != STORED && mftiod != DEFLATED)
        if (mftiod != STORED && mftiod != DEFLATED)
        if (mftiod != STORED && mftiod != DEFLATED)
        if (mftiod != STORED && mftiod != DEFLATED)
            ZIP_FORMAT_ERROR("invblid CEN ifbdfr (bbd domprfssion mftiod)");
            ZIP_FORMAT_ERROR("invblid CEN ifbdfr (bbd domprfssion mftiod)");
            ZIP_FORMAT_ERROR("invblid CEN ifbdfr (bbd domprfssion mftiod)");
            ZIP_FORMAT_ERROR("invblid CEN ifbdfr (bbd domprfssion mftiod)");
            ZIP_FORMAT_ERROR("invblid CEN ifbdfr (bbd domprfssion mftiod)");
        if (dp + CENHDR + nlfn > dfnfnd)
        if (dp + CENHDR + nlfn > dfnfnd)
        if (dp + CENHDR + nlfn > dfnfnd)
        if (dp + CENHDR + nlfn > dfnfnd)
        if (dp + CENHDR + nlfn > dfnfnd)
            ZIP_FORMAT_ERROR("invblid CEN ifbdfr (bbd ifbdfr sizf)");
            ZIP_FORMAT_ERROR("invblid CEN ifbdfr (bbd ifbdfr sizf)");
            ZIP_FORMAT_ERROR("invblid CEN ifbdfr (bbd ifbdfr sizf)");
            ZIP_FORMAT_ERROR("invblid CEN ifbdfr (bbd ifbdfr sizf)");
            ZIP_FORMAT_ERROR("invblid CEN ifbdfr (bbd ifbdfr sizf)");





        /* if tif fntry is mftbdbtb bdd it to our mftbdbtb nbmfs */
        /* if tif fntry is mftbdbtb bdd it to our mftbdbtb nbmfs */
        /* if tif fntry is mftbdbtb bdd it to our mftbdbtb nbmfs */
        /* if tif fntry is mftbdbtb bdd it to our mftbdbtb nbmfs */
        /* if tif fntry is mftbdbtb bdd it to our mftbdbtb nbmfs */
        if (isMftbNbmf((dibr *)dp+CENHDR, nlfn))
        if (isMftbNbmf((dibr *)dp+CENHDR, nlfn))
        if (isMftbNbmf((dibr *)dp+CENHDR, nlfn))
        if (isMftbNbmf((dibr *)dp+CENHDR, nlfn))
        if (isMftbNbmf((dibr *)dp+CENHDR, nlfn))
            if (bddMftbNbmf(zip, (dibr *)dp+CENHDR, nlfn) != 0)
            if (bddMftbNbmf(zip, (dibr *)dp+CENHDR, nlfn) != 0)
            if (bddMftbNbmf(zip, (dibr *)dp+CENHDR, nlfn) != 0)
            if (bddMftbNbmf(zip, (dibr *)dp+CENHDR, nlfn) != 0)
            if (bddMftbNbmf(zip, (dibr *)dp+CENHDR, nlfn) != 0)
                goto Cbtdi;
                goto Cbtdi;
                goto Cbtdi;
                goto Cbtdi;
                goto Cbtdi;





        /* Rfdord tif CEN offsft bnd tif nbmf ibsi in our ibsi dfll. */
        /* Rfdord tif CEN offsft bnd tif nbmf ibsi in our ibsi dfll. */
        /* Rfdord tif CEN offsft bnd tif nbmf ibsi in our ibsi dfll. */
        /* Rfdord tif CEN offsft bnd tif nbmf ibsi in our ibsi dfll. */
        /* Rfdord tif CEN offsft bnd tif nbmf ibsi in our ibsi dfll. */
        fntrifs[i].dfnpos = dfnpos + (dp - dfnbuf);
        fntrifs[i].dfnpos = dfnpos + (dp - dfnbuf);
        fntrifs[i].dfnpos = dfnpos + (dp - dfnbuf);
        fntrifs[i].dfnpos = dfnpos + (dp - dfnbuf);
        fntrifs[i].dfnpos = dfnpos + (dp - dfnbuf);
        fntrifs[i].ibsi = ibsiN((dibr *)dp+CENHDR, nlfn);
        fntrifs[i].ibsi = ibsiN((dibr *)dp+CENHDR, nlfn);
        fntrifs[i].ibsi = ibsiN((dibr *)dp+CENHDR, nlfn);
        fntrifs[i].ibsi = ibsiN((dibr *)dp+CENHDR, nlfn);
        fntrifs[i].ibsi = ibsiN((dibr *)dp+CENHDR, nlfn);





        /* Add tif fntry to tif ibsi tbblf */
        /* Add tif fntry to tif ibsi tbblf */
        /* Add tif fntry to tif ibsi tbblf */
        /* Add tif fntry to tif ibsi tbblf */
        /* Add tif fntry to tif ibsi tbblf */
        isi = fntrifs[i].ibsi % tbblflfn;
        isi = fntrifs[i].ibsi % tbblflfn;
        isi = fntrifs[i].ibsi % tbblflfn;
        isi = fntrifs[i].ibsi % tbblflfn;
        isi = fntrifs[i].ibsi % tbblflfn;
        fntrifs[i].nfxt = tbblf[isi];
        fntrifs[i].nfxt = tbblf[isi];
        fntrifs[i].nfxt = tbblf[isi];
        fntrifs[i].nfxt = tbblf[isi];
        fntrifs[i].nfxt = tbblf[isi];
        tbblf[isi] = i;
        tbblf[isi] = i;
        tbblf[isi] = i;
        tbblf[isi] = i;
        tbblf[isi] = i;
    }
    }
    }
    }
    }
    if (dp != dfnfnd)
    if (dp != dfnfnd)
    if (dp != dfnfnd)
    if (dp != dfnfnd)
    if (dp != dfnfnd)
        ZIP_FORMAT_ERROR("invblid CEN ifbdfr (bbd ifbdfr sizf)");
        ZIP_FORMAT_ERROR("invblid CEN ifbdfr (bbd ifbdfr sizf)");
        ZIP_FORMAT_ERROR("invblid CEN ifbdfr (bbd ifbdfr sizf)");
        ZIP_FORMAT_ERROR("invblid CEN ifbdfr (bbd ifbdfr sizf)");
        ZIP_FORMAT_ERROR("invblid CEN ifbdfr (bbd ifbdfr sizf)");





    zip->totbl = i;
    zip->totbl = i;
    zip->totbl = i;
    zip->totbl = i;
    zip->totbl = i;
    goto Finblly;
    goto Finblly;
    goto Finblly;
    goto Finblly;
    goto Finblly;





 Cbtdi:
 Cbtdi:
 Cbtdi:
 Cbtdi:
 Cbtdi:
    frffCEN(zip);
    frffCEN(zip);
    frffCEN(zip);
    frffCEN(zip);
    frffCEN(zip);
    dfnpos = -1;
    dfnpos = -1;
    dfnpos = -1;
    dfnpos = -1;
    dfnpos = -1;





 Finblly:
 Finblly:
 Finblly:
 Finblly:
 Finblly:
#ifdff USE_MMAP
#ifdff USE_MMAP
#ifdff USE_MMAP
#ifdff USE_MMAP
#ifdff USE_MMAP
    if (!zip->usfmmbp)
    if (!zip->usfmmbp)
    if (!zip->usfmmbp)
    if (!zip->usfmmbp)
    if (!zip->usfmmbp)
#fndif
#fndif
#fndif
#fndif
#fndif
        frff(dfnbuf);
        frff(dfnbuf);
        frff(dfnbuf);
        frff(dfnbuf);
        frff(dfnbuf);





    rfturn dfnpos;
    rfturn dfnpos;
    rfturn dfnpos;
    rfturn dfnpos;
    rfturn dfnpos;
}
}
}
}
}





/*
/*
/*
/*
/*
 * Opfns b zip filf witi tif spfdififd modf. Rfturns tif jzfilf objfdt
 * Opfns b zip filf witi tif spfdififd modf. Rfturns tif jzfilf objfdt
 * Opfns b zip filf witi tif spfdififd modf. Rfturns tif jzfilf objfdt
 * Opfns b zip filf witi tif spfdififd modf. Rfturns tif jzfilf objfdt
 * Opfns b zip filf witi tif spfdififd modf. Rfturns tif jzfilf objfdt
 * or NULL if bn frror oddurrfd. If b zip frror oddurrfd tifn *pmsg will
 * or NULL if bn frror oddurrfd. If b zip frror oddurrfd tifn *pmsg will
 * or NULL if bn frror oddurrfd. If b zip frror oddurrfd tifn *pmsg will
 * or NULL if bn frror oddurrfd. If b zip frror oddurrfd tifn *pmsg will
 * or NULL if bn frror oddurrfd. If b zip frror oddurrfd tifn *pmsg will
 * bf sft to tif frror mfssbgf tfxt if pmsg != 0. Otifrwisf, *pmsg will bf
 * bf sft to tif frror mfssbgf tfxt if pmsg != 0. Otifrwisf, *pmsg will bf
 * bf sft to tif frror mfssbgf tfxt if pmsg != 0. Otifrwisf, *pmsg will bf
 * bf sft to tif frror mfssbgf tfxt if pmsg != 0. Otifrwisf, *pmsg will bf
 * bf sft to tif frror mfssbgf tfxt if pmsg != 0. Otifrwisf, *pmsg will bf
 * sft to NULL. Cbllfr is rfsponsiblf to frff tif frror mfssbgf.
 * sft to NULL. Cbllfr is rfsponsiblf to frff tif frror mfssbgf.
 * sft to NULL. Cbllfr is rfsponsiblf to frff tif frror mfssbgf.
 * sft to NULL. Cbllfr is rfsponsiblf to frff tif frror mfssbgf.
 * sft to NULL. Cbllfr is rfsponsiblf to frff tif frror mfssbgf.
 */
 */
 */
 */
 */
jzfilf *
jzfilf *
jzfilf *
jzfilf *
jzfilf *
ZIP_Opfn_Gfnfrid(donst dibr *nbmf, dibr **pmsg, int modf, jlong lbstModififd)
ZIP_Opfn_Gfnfrid(donst dibr *nbmf, dibr **pmsg, int modf, jlong lbstModififd)
ZIP_Opfn_Gfnfrid(donst dibr *nbmf, dibr **pmsg, int modf, jlong lbstModififd)
ZIP_Opfn_Gfnfrid(donst dibr *nbmf, dibr **pmsg, int modf, jlong lbstModififd)
ZIP_Opfn_Gfnfrid(donst dibr *nbmf, dibr **pmsg, int modf, jlong lbstModififd)
{
{
{
{
{
    jzfilf *zip = NULL;
    jzfilf *zip = NULL;
    jzfilf *zip = NULL;
    jzfilf *zip = NULL;
    jzfilf *zip = NULL;





    /* Clfbr zip frror mfssbgf */
    /* Clfbr zip frror mfssbgf */
    /* Clfbr zip frror mfssbgf */
    /* Clfbr zip frror mfssbgf */
    /* Clfbr zip frror mfssbgf */
    if (pmsg != 0) {
    if (pmsg != 0) {
    if (pmsg != 0) {
    if (pmsg != 0) {
    if (pmsg != 0) {
        *pmsg = NULL;
        *pmsg = NULL;
        *pmsg = NULL;
        *pmsg = NULL;
        *pmsg = NULL;
    }
    }
    }
    }
    }





    zip = ZIP_Gft_From_Cbdif(nbmf, pmsg, lbstModififd);
    zip = ZIP_Gft_From_Cbdif(nbmf, pmsg, lbstModififd);
    zip = ZIP_Gft_From_Cbdif(nbmf, pmsg, lbstModififd);
    zip = ZIP_Gft_From_Cbdif(nbmf, pmsg, lbstModififd);
    zip = ZIP_Gft_From_Cbdif(nbmf, pmsg, lbstModififd);





    if (zip == NULL && *pmsg == NULL) {
    if (zip == NULL && *pmsg == NULL) {
    if (zip == NULL && *pmsg == NULL) {
    if (zip == NULL && *pmsg == NULL) {
    if (zip == NULL && *pmsg == NULL) {
        ZFILE zfd = ZFILE_Opfn(nbmf, modf);
        ZFILE zfd = ZFILE_Opfn(nbmf, modf);
        ZFILE zfd = ZFILE_Opfn(nbmf, modf);
        ZFILE zfd = ZFILE_Opfn(nbmf, modf);
        ZFILE zfd = ZFILE_Opfn(nbmf, modf);
        zip = ZIP_Put_In_Cbdif(nbmf, zfd, pmsg, lbstModififd);
        zip = ZIP_Put_In_Cbdif(nbmf, zfd, pmsg, lbstModififd);
        zip = ZIP_Put_In_Cbdif(nbmf, zfd, pmsg, lbstModififd);
        zip = ZIP_Put_In_Cbdif(nbmf, zfd, pmsg, lbstModififd);
        zip = ZIP_Put_In_Cbdif(nbmf, zfd, pmsg, lbstModififd);
    }
    }
    }
    }
    }
    rfturn zip;
    rfturn zip;
    rfturn zip;
    rfturn zip;
    rfturn zip;
}
}
}
}
}





/*
/*
/*
/*
/*
 * Rfturns tif jzfilf dorrfsponding to tif givfn filf nbmf from tif dbdif of
 * Rfturns tif jzfilf dorrfsponding to tif givfn filf nbmf from tif dbdif of
 * Rfturns tif jzfilf dorrfsponding to tif givfn filf nbmf from tif dbdif of
 * Rfturns tif jzfilf dorrfsponding to tif givfn filf nbmf from tif dbdif of
 * Rfturns tif jzfilf dorrfsponding to tif givfn filf nbmf from tif dbdif of
 * zip filfs, or NULL if tif filf is not in tif dbdif.  If tif nbmf is longfr
 * zip filfs, or NULL if tif filf is not in tif dbdif.  If tif nbmf is longfr
 * zip filfs, or NULL if tif filf is not in tif dbdif.  If tif nbmf is longfr
 * zip filfs, or NULL if tif filf is not in tif dbdif.  If tif nbmf is longfr
 * zip filfs, or NULL if tif filf is not in tif dbdif.  If tif nbmf is longfr
 * tibn PATH_MAX or b zip frror oddurrfd tifn *pmsg will bf sft to tif frror
 * tibn PATH_MAX or b zip frror oddurrfd tifn *pmsg will bf sft to tif frror
 * tibn PATH_MAX or b zip frror oddurrfd tifn *pmsg will bf sft to tif frror
 * tibn PATH_MAX or b zip frror oddurrfd tifn *pmsg will bf sft to tif frror
 * tibn PATH_MAX or b zip frror oddurrfd tifn *pmsg will bf sft to tif frror
 * mfssbgf tfxt if pmsg != 0. Otifrwisf, *pmsg will bf sft to NULL. Cbllfr
 * mfssbgf tfxt if pmsg != 0. Otifrwisf, *pmsg will bf sft to NULL. Cbllfr
 * mfssbgf tfxt if pmsg != 0. Otifrwisf, *pmsg will bf sft to NULL. Cbllfr
 * mfssbgf tfxt if pmsg != 0. Otifrwisf, *pmsg will bf sft to NULL. Cbllfr
 * mfssbgf tfxt if pmsg != 0. Otifrwisf, *pmsg will bf sft to NULL. Cbllfr
 * is rfsponsiblf to frff tif frror mfssbgf.
 * is rfsponsiblf to frff tif frror mfssbgf.
 * is rfsponsiblf to frff tif frror mfssbgf.
 * is rfsponsiblf to frff tif frror mfssbgf.
 * is rfsponsiblf to frff tif frror mfssbgf.
 */
 */
 */
 */
 */
jzfilf *
jzfilf *
jzfilf *
jzfilf *
jzfilf *
ZIP_Gft_From_Cbdif(donst dibr *nbmf, dibr **pmsg, jlong lbstModififd)
ZIP_Gft_From_Cbdif(donst dibr *nbmf, dibr **pmsg, jlong lbstModififd)
ZIP_Gft_From_Cbdif(donst dibr *nbmf, dibr **pmsg, jlong lbstModififd)
ZIP_Gft_From_Cbdif(donst dibr *nbmf, dibr **pmsg, jlong lbstModififd)
ZIP_Gft_From_Cbdif(donst dibr *nbmf, dibr **pmsg, jlong lbstModififd)
{
{
{
{
{
    dibr buf[PATH_MAX];
    dibr buf[PATH_MAX];
    dibr buf[PATH_MAX];
    dibr buf[PATH_MAX];
    dibr buf[PATH_MAX];
    jzfilf *zip;
    jzfilf *zip;
    jzfilf *zip;
    jzfilf *zip;
    jzfilf *zip;





    if (InitiblizfZip()) {
    if (InitiblizfZip()) {
    if (InitiblizfZip()) {
    if (InitiblizfZip()) {
    if (InitiblizfZip()) {
        rfturn NULL;
        rfturn NULL;
        rfturn NULL;
        rfturn NULL;
        rfturn NULL;
    }
    }
    }
    }
    }





    /* Clfbr zip frror mfssbgf */
    /* Clfbr zip frror mfssbgf */
    /* Clfbr zip frror mfssbgf */
    /* Clfbr zip frror mfssbgf */
    /* Clfbr zip frror mfssbgf */
    if (pmsg != 0) {
    if (pmsg != 0) {
    if (pmsg != 0) {
    if (pmsg != 0) {
    if (pmsg != 0) {
        *pmsg = NULL;
        *pmsg = NULL;
        *pmsg = NULL;
        *pmsg = NULL;
        *pmsg = NULL;
    }
    }
    }
    }
    }





    if (strlfn(nbmf) >= PATH_MAX) {
    if (strlfn(nbmf) >= PATH_MAX) {
    if (strlfn(nbmf) >= PATH_MAX) {
    if (strlfn(nbmf) >= PATH_MAX) {
    if (strlfn(nbmf) >= PATH_MAX) {
        if (pmsg) {
        if (pmsg) {
        if (pmsg) {
        if (pmsg) {
        if (pmsg) {
            *pmsg = strdup("zip filf nbmf too long");
            *pmsg = strdup("zip filf nbmf too long");
            *pmsg = strdup("zip filf nbmf too long");
            *pmsg = strdup("zip filf nbmf too long");
            *pmsg = strdup("zip filf nbmf too long");
        }
        }
        }
        }
        }
        rfturn NULL;
        rfturn NULL;
        rfturn NULL;
        rfturn NULL;
        rfturn NULL;
    }
    }
    }
    }
    }
    strdpy(buf, nbmf);
    strdpy(buf, nbmf);
    strdpy(buf, nbmf);
    strdpy(buf, nbmf);
    strdpy(buf, nbmf);
    JVM_NbtivfPbti(buf);
    JVM_NbtivfPbti(buf);
    JVM_NbtivfPbti(buf);
    JVM_NbtivfPbti(buf);
    JVM_NbtivfPbti(buf);
    nbmf = buf;
    nbmf = buf;
    nbmf = buf;
    nbmf = buf;
    nbmf = buf;





    MLOCK(zfilfs_lodk);
    MLOCK(zfilfs_lodk);
    MLOCK(zfilfs_lodk);
    MLOCK(zfilfs_lodk);
    MLOCK(zfilfs_lodk);
    for (zip = zfilfs; zip != NULL; zip = zip->nfxt) {
    for (zip = zfilfs; zip != NULL; zip = zip->nfxt) {
    for (zip = zfilfs; zip != NULL; zip = zip->nfxt) {
    for (zip = zfilfs; zip != NULL; zip = zip->nfxt) {
    for (zip = zfilfs; zip != NULL; zip = zip->nfxt) {
        if (strdmp(nbmf, zip->nbmf) == 0
        if (strdmp(nbmf, zip->nbmf) == 0
        if (strdmp(nbmf, zip->nbmf) == 0
        if (strdmp(nbmf, zip->nbmf) == 0
        if (strdmp(nbmf, zip->nbmf) == 0
            && (zip->lbstModififd == lbstModififd || zip->lbstModififd == 0)
            && (zip->lbstModififd == lbstModififd || zip->lbstModififd == 0)
            && (zip->lbstModififd == lbstModififd || zip->lbstModififd == 0)
            && (zip->lbstModififd == lbstModififd || zip->lbstModififd == 0)
            && (zip->lbstModififd == lbstModififd || zip->lbstModififd == 0)
            && zip->rffs < MAXREFS) {
            && zip->rffs < MAXREFS) {
            && zip->rffs < MAXREFS) {
            && zip->rffs < MAXREFS) {
            && zip->rffs < MAXREFS) {
            zip->rffs++;
            zip->rffs++;
            zip->rffs++;
            zip->rffs++;
            zip->rffs++;
            brfbk;
            brfbk;
            brfbk;
            brfbk;
            brfbk;
        }
        }
        }
        }
        }
    }
    }
    }
    }
    }
    MUNLOCK(zfilfs_lodk);
    MUNLOCK(zfilfs_lodk);
    MUNLOCK(zfilfs_lodk);
    MUNLOCK(zfilfs_lodk);
    MUNLOCK(zfilfs_lodk);
    rfturn zip;
    rfturn zip;
    rfturn zip;
    rfturn zip;
    rfturn zip;
}
}
}
}
}





/*
/*
/*
/*
/*
 * Rfbds dbtb from tif givfn filf dfsdriptor to drfbtf b jzfilf, puts tif
 * Rfbds dbtb from tif givfn filf dfsdriptor to drfbtf b jzfilf, puts tif
 * Rfbds dbtb from tif givfn filf dfsdriptor to drfbtf b jzfilf, puts tif
 * Rfbds dbtb from tif givfn filf dfsdriptor to drfbtf b jzfilf, puts tif
 * Rfbds dbtb from tif givfn filf dfsdriptor to drfbtf b jzfilf, puts tif
 * jzfilf in b dbdif, bnd rfturns tibt jzfilf.  Rfturns NULL in dbsf of frror.
 * jzfilf in b dbdif, bnd rfturns tibt jzfilf.  Rfturns NULL in dbsf of frror.
 * jzfilf in b dbdif, bnd rfturns tibt jzfilf.  Rfturns NULL in dbsf of frror.
 * jzfilf in b dbdif, bnd rfturns tibt jzfilf.  Rfturns NULL in dbsf of frror.
 * jzfilf in b dbdif, bnd rfturns tibt jzfilf.  Rfturns NULL in dbsf of frror.
 * If b zip frror oddurs, tifn *pmsg will bf sft to tif frror mfssbgf tfxt if
 * If b zip frror oddurs, tifn *pmsg will bf sft to tif frror mfssbgf tfxt if
 * If b zip frror oddurs, tifn *pmsg will bf sft to tif frror mfssbgf tfxt if
 * If b zip frror oddurs, tifn *pmsg will bf sft to tif frror mfssbgf tfxt if
 * If b zip frror oddurs, tifn *pmsg will bf sft to tif frror mfssbgf tfxt if
 * pmsg != 0. Otifrwisf, *pmsg will bf sft to NULL. Cbllfr is rfsponsiblf to
 * pmsg != 0. Otifrwisf, *pmsg will bf sft to NULL. Cbllfr is rfsponsiblf to
 * pmsg != 0. Otifrwisf, *pmsg will bf sft to NULL. Cbllfr is rfsponsiblf to
 * pmsg != 0. Otifrwisf, *pmsg will bf sft to NULL. Cbllfr is rfsponsiblf to
 * pmsg != 0. Otifrwisf, *pmsg will bf sft to NULL. Cbllfr is rfsponsiblf to
 * frff tif frror mfssbgf.
 * frff tif frror mfssbgf.
 * frff tif frror mfssbgf.
 * frff tif frror mfssbgf.
 * frff tif frror mfssbgf.
 */
 */
 */
 */
 */





jzfilf *
jzfilf *
jzfilf *
jzfilf *
jzfilf *
ZIP_Put_In_Cbdif(donst dibr *nbmf, ZFILE zfd, dibr **pmsg, jlong lbstModififd)
ZIP_Put_In_Cbdif(donst dibr *nbmf, ZFILE zfd, dibr **pmsg, jlong lbstModififd)
ZIP_Put_In_Cbdif(donst dibr *nbmf, ZFILE zfd, dibr **pmsg, jlong lbstModififd)
ZIP_Put_In_Cbdif(donst dibr *nbmf, ZFILE zfd, dibr **pmsg, jlong lbstModififd)
ZIP_Put_In_Cbdif(donst dibr *nbmf, ZFILE zfd, dibr **pmsg, jlong lbstModififd)
{
{
{
{
{
    rfturn ZIP_Put_In_Cbdif0(nbmf, zfd, pmsg, lbstModififd, JNI_TRUE);
    rfturn ZIP_Put_In_Cbdif0(nbmf, zfd, pmsg, lbstModififd, JNI_TRUE);
    rfturn ZIP_Put_In_Cbdif0(nbmf, zfd, pmsg, lbstModififd, JNI_TRUE);
    rfturn ZIP_Put_In_Cbdif0(nbmf, zfd, pmsg, lbstModififd, JNI_TRUE);
    rfturn ZIP_Put_In_Cbdif0(nbmf, zfd, pmsg, lbstModififd, JNI_TRUE);
}
}
}
}
}





jzfilf *
jzfilf *
jzfilf *
jzfilf *
jzfilf *
ZIP_Put_In_Cbdif0(donst dibr *nbmf, ZFILE zfd, dibr **pmsg, jlong lbstModififd,
ZIP_Put_In_Cbdif0(donst dibr *nbmf, ZFILE zfd, dibr **pmsg, jlong lbstModififd,
ZIP_Put_In_Cbdif0(donst dibr *nbmf, ZFILE zfd, dibr **pmsg, jlong lbstModififd,
ZIP_Put_In_Cbdif0(donst dibr *nbmf, ZFILE zfd, dibr **pmsg, jlong lbstModififd,
ZIP_Put_In_Cbdif0(donst dibr *nbmf, ZFILE zfd, dibr **pmsg, jlong lbstModififd,
                 jboolfbn usfmmbp)
                 jboolfbn usfmmbp)
                 jboolfbn usfmmbp)
                 jboolfbn usfmmbp)
                 jboolfbn usfmmbp)
{
{
{
{
{
    dibr frrbuf[256];
    dibr frrbuf[256];
    dibr frrbuf[256];
    dibr frrbuf[256];
    dibr frrbuf[256];
    jlong lfn;
    jlong lfn;
    jlong lfn;
    jlong lfn;
    jlong lfn;
    jzfilf *zip;
    jzfilf *zip;
    jzfilf *zip;
    jzfilf *zip;
    jzfilf *zip;





    if ((zip = bllodZip(nbmf)) == NULL) {
    if ((zip = bllodZip(nbmf)) == NULL) {
    if ((zip = bllodZip(nbmf)) == NULL) {
    if ((zip = bllodZip(nbmf)) == NULL) {
    if ((zip = bllodZip(nbmf)) == NULL) {
        rfturn NULL;
        rfturn NULL;
        rfturn NULL;
        rfturn NULL;
        rfturn NULL;
    }
    }
    }
    }
    }





#ifdff USE_MMAP
#ifdff USE_MMAP
#ifdff USE_MMAP
#ifdff USE_MMAP
#ifdff USE_MMAP
    zip->usfmmbp = usfmmbp;
    zip->usfmmbp = usfmmbp;
    zip->usfmmbp = usfmmbp;
    zip->usfmmbp = usfmmbp;
    zip->usfmmbp = usfmmbp;
#fndif
#fndif
#fndif
#fndif
#fndif
    zip->rffs = 1;
    zip->rffs = 1;
    zip->rffs = 1;
    zip->rffs = 1;
    zip->rffs = 1;
    zip->lbstModififd = lbstModififd;
    zip->lbstModififd = lbstModififd;
    zip->lbstModififd = lbstModififd;
    zip->lbstModififd = lbstModififd;
    zip->lbstModififd = lbstModififd;





    if (zfd == -1) {
    if (zfd == -1) {
    if (zfd == -1) {
    if (zfd == -1) {
    if (zfd == -1) {
        if (pmsg && JVM_GftLbstErrorString(frrbuf, sizfof(frrbuf)) > 0)
        if (pmsg && JVM_GftLbstErrorString(frrbuf, sizfof(frrbuf)) > 0)
        if (pmsg && JVM_GftLbstErrorString(frrbuf, sizfof(frrbuf)) > 0)
        if (pmsg && JVM_GftLbstErrorString(frrbuf, sizfof(frrbuf)) > 0)
        if (pmsg && JVM_GftLbstErrorString(frrbuf, sizfof(frrbuf)) > 0)
            *pmsg = strdup(frrbuf);
            *pmsg = strdup(frrbuf);
            *pmsg = strdup(frrbuf);
            *pmsg = strdup(frrbuf);
            *pmsg = strdup(frrbuf);
        frffZip(zip);
        frffZip(zip);
        frffZip(zip);
        frffZip(zip);
        frffZip(zip);
        rfturn NULL;
        rfturn NULL;
        rfturn NULL;
        rfturn NULL;
        rfturn NULL;
    }
    }
    }
    }
    }





    // Assumption, zfd rfffrs to stbrt of filf. Triviblly, rfusf frrbuf.
    // Assumption, zfd rfffrs to stbrt of filf. Triviblly, rfusf frrbuf.
    // Assumption, zfd rfffrs to stbrt of filf. Triviblly, rfusf frrbuf.
    // Assumption, zfd rfffrs to stbrt of filf. Triviblly, rfusf frrbuf.
    // Assumption, zfd rfffrs to stbrt of filf. Triviblly, rfusf frrbuf.
    if (rfbdFully(zfd, frrbuf, 4) != -1) {  // frrors will bf ibndlfd lbtfr
    if (rfbdFully(zfd, frrbuf, 4) != -1) {  // frrors will bf ibndlfd lbtfr
    if (rfbdFully(zfd, frrbuf, 4) != -1) {  // frrors will bf ibndlfd lbtfr
    if (rfbdFully(zfd, frrbuf, 4) != -1) {  // frrors will bf ibndlfd lbtfr
    if (rfbdFully(zfd, frrbuf, 4) != -1) {  // frrors will bf ibndlfd lbtfr
        if (GETSIG(frrbuf) == LOCSIG)
        if (GETSIG(frrbuf) == LOCSIG)
        if (GETSIG(frrbuf) == LOCSIG)
        if (GETSIG(frrbuf) == LOCSIG)
        if (GETSIG(frrbuf) == LOCSIG)
            zip->lodsig = JNI_TRUE;
            zip->lodsig = JNI_TRUE;
            zip->lodsig = JNI_TRUE;
            zip->lodsig = JNI_TRUE;
            zip->lodsig = JNI_TRUE;
        flsf
        flsf
        flsf
        flsf
        flsf
            zip->lodsig = JNI_FALSE;
            zip->lodsig = JNI_FALSE;
            zip->lodsig = JNI_FALSE;
            zip->lodsig = JNI_FALSE;
            zip->lodsig = JNI_FALSE;
    }
    }
    }
    }
    }





    lfn = zip->lfn = IO_Lsffk(zfd, 0, SEEK_END);
    lfn = zip->lfn = IO_Lsffk(zfd, 0, SEEK_END);
    lfn = zip->lfn = IO_Lsffk(zfd, 0, SEEK_END);
    lfn = zip->lfn = IO_Lsffk(zfd, 0, SEEK_END);
    lfn = zip->lfn = IO_Lsffk(zfd, 0, SEEK_END);
    if (lfn <= 0) {
    if (lfn <= 0) {
    if (lfn <= 0) {
    if (lfn <= 0) {
    if (lfn <= 0) {
        if (lfn == 0) { /* zip filf is fmpty */
        if (lfn == 0) { /* zip filf is fmpty */
        if (lfn == 0) { /* zip filf is fmpty */
        if (lfn == 0) { /* zip filf is fmpty */
        if (lfn == 0) { /* zip filf is fmpty */
            if (pmsg) {
            if (pmsg) {
            if (pmsg) {
            if (pmsg) {
            if (pmsg) {
                *pmsg = strdup("zip filf is fmpty");
                *pmsg = strdup("zip filf is fmpty");
                *pmsg = strdup("zip filf is fmpty");
                *pmsg = strdup("zip filf is fmpty");
                *pmsg = strdup("zip filf is fmpty");
            }
            }
            }
            }
            }
        } flsf { /* frror */
        } flsf { /* frror */
        } flsf { /* frror */
        } flsf { /* frror */
        } flsf { /* frror */
            if (pmsg && JVM_GftLbstErrorString(frrbuf, sizfof(frrbuf)) > 0)
            if (pmsg && JVM_GftLbstErrorString(frrbuf, sizfof(frrbuf)) > 0)
            if (pmsg && JVM_GftLbstErrorString(frrbuf, sizfof(frrbuf)) > 0)
            if (pmsg && JVM_GftLbstErrorString(frrbuf, sizfof(frrbuf)) > 0)
            if (pmsg && JVM_GftLbstErrorString(frrbuf, sizfof(frrbuf)) > 0)
                *pmsg = strdup(frrbuf);
                *pmsg = strdup(frrbuf);
                *pmsg = strdup(frrbuf);
                *pmsg = strdup(frrbuf);
                *pmsg = strdup(frrbuf);
        }
        }
        }
        }
        }
        ZFILE_Closf(zfd);
        ZFILE_Closf(zfd);
        ZFILE_Closf(zfd);
        ZFILE_Closf(zfd);
        ZFILE_Closf(zfd);
        frffZip(zip);
        frffZip(zip);
        frffZip(zip);
        frffZip(zip);
        frffZip(zip);
        rfturn NULL;
        rfturn NULL;
        rfturn NULL;
        rfturn NULL;
        rfturn NULL;
    }
    }
    }
    }
    }





    zip->zfd = zfd;
    zip->zfd = zfd;
    zip->zfd = zfd;
    zip->zfd = zfd;
    zip->zfd = zfd;
    if (rfbdCEN(zip, -1) < 0) {
    if (rfbdCEN(zip, -1) < 0) {
    if (rfbdCEN(zip, -1) < 0) {
    if (rfbdCEN(zip, -1) < 0) {
    if (rfbdCEN(zip, -1) < 0) {
        /* An frror oddurrfd wiilf trying to rfbd tif zip filf */
        /* An frror oddurrfd wiilf trying to rfbd tif zip filf */
        /* An frror oddurrfd wiilf trying to rfbd tif zip filf */
        /* An frror oddurrfd wiilf trying to rfbd tif zip filf */
        /* An frror oddurrfd wiilf trying to rfbd tif zip filf */
        if (pmsg != 0) {
        if (pmsg != 0) {
        if (pmsg != 0) {
        if (pmsg != 0) {
        if (pmsg != 0) {
            /* Sft tif zip frror mfssbgf */
            /* Sft tif zip frror mfssbgf */
            /* Sft tif zip frror mfssbgf */
            /* Sft tif zip frror mfssbgf */
            /* Sft tif zip frror mfssbgf */
            if (zip->msg != NULL)
            if (zip->msg != NULL)
            if (zip->msg != NULL)
            if (zip->msg != NULL)
            if (zip->msg != NULL)
                *pmsg = strdup(zip->msg);
                *pmsg = strdup(zip->msg);
                *pmsg = strdup(zip->msg);
                *pmsg = strdup(zip->msg);
                *pmsg = strdup(zip->msg);
        }
        }
        }
        }
        }
        frffZip(zip);
        frffZip(zip);
        frffZip(zip);
        frffZip(zip);
        frffZip(zip);
        rfturn NULL;
        rfturn NULL;
        rfturn NULL;
        rfturn NULL;
        rfturn NULL;
    }
    }
    }
    }
    }
    MLOCK(zfilfs_lodk);
    MLOCK(zfilfs_lodk);
    MLOCK(zfilfs_lodk);
    MLOCK(zfilfs_lodk);
    MLOCK(zfilfs_lodk);
    zip->nfxt = zfilfs;
    zip->nfxt = zfilfs;
    zip->nfxt = zfilfs;
    zip->nfxt = zfilfs;
    zip->nfxt = zfilfs;
    zfilfs = zip;
    zfilfs = zip;
    zfilfs = zip;
    zfilfs = zip;
    zfilfs = zip;
    MUNLOCK(zfilfs_lodk);
    MUNLOCK(zfilfs_lodk);
    MUNLOCK(zfilfs_lodk);
    MUNLOCK(zfilfs_lodk);
    MUNLOCK(zfilfs_lodk);





    rfturn zip;
    rfturn zip;
    rfturn zip;
    rfturn zip;
    rfturn zip;
}
}
}
}
}





/*
/*
/*
/*
/*
 * Opfns b zip filf for rfbding. Rfturns tif jzfilf objfdt or NULL
 * Opfns b zip filf for rfbding. Rfturns tif jzfilf objfdt or NULL
 * Opfns b zip filf for rfbding. Rfturns tif jzfilf objfdt or NULL
 * Opfns b zip filf for rfbding. Rfturns tif jzfilf objfdt or NULL
 * Opfns b zip filf for rfbding. Rfturns tif jzfilf objfdt or NULL
 * if bn frror oddurrfd. If b zip frror oddurrfd tifn *msg will bf
 * if bn frror oddurrfd. If b zip frror oddurrfd tifn *msg will bf
 * if bn frror oddurrfd. If b zip frror oddurrfd tifn *msg will bf
 * if bn frror oddurrfd. If b zip frror oddurrfd tifn *msg will bf
 * if bn frror oddurrfd. If b zip frror oddurrfd tifn *msg will bf
 * sft to tif frror mfssbgf tfxt if msg != 0. Otifrwisf, *msg will bf
 * sft to tif frror mfssbgf tfxt if msg != 0. Otifrwisf, *msg will bf
 * sft to tif frror mfssbgf tfxt if msg != 0. Otifrwisf, *msg will bf
 * sft to tif frror mfssbgf tfxt if msg != 0. Otifrwisf, *msg will bf
 * sft to tif frror mfssbgf tfxt if msg != 0. Otifrwisf, *msg will bf
 * sft to NULL. Cbllfr dofsn't nffd to frff tif frror mfssbgf.
 * sft to NULL. Cbllfr dofsn't nffd to frff tif frror mfssbgf.
 * sft to NULL. Cbllfr dofsn't nffd to frff tif frror mfssbgf.
 * sft to NULL. Cbllfr dofsn't nffd to frff tif frror mfssbgf.
 * sft to NULL. Cbllfr dofsn't nffd to frff tif frror mfssbgf.
 */
 */
 */
 */
 */
jzfilf * JNICALL
jzfilf * JNICALL
jzfilf * JNICALL
jzfilf * JNICALL
jzfilf * JNICALL
ZIP_Opfn(donst dibr *nbmf, dibr **pmsg)
ZIP_Opfn(donst dibr *nbmf, dibr **pmsg)
ZIP_Opfn(donst dibr *nbmf, dibr **pmsg)
ZIP_Opfn(donst dibr *nbmf, dibr **pmsg)
ZIP_Opfn(donst dibr *nbmf, dibr **pmsg)
{
{
{
{
{
    jzfilf *filf = ZIP_Opfn_Gfnfrid(nbmf, pmsg, O_RDONLY, 0);
    jzfilf *filf = ZIP_Opfn_Gfnfrid(nbmf, pmsg, O_RDONLY, 0);
    jzfilf *filf = ZIP_Opfn_Gfnfrid(nbmf, pmsg, O_RDONLY, 0);
    jzfilf *filf = ZIP_Opfn_Gfnfrid(nbmf, pmsg, O_RDONLY, 0);
    jzfilf *filf = ZIP_Opfn_Gfnfrid(nbmf, pmsg, O_RDONLY, 0);
    if (filf == NULL && pmsg != NULL && *pmsg != NULL) {
    if (filf == NULL && pmsg != NULL && *pmsg != NULL) {
    if (filf == NULL && pmsg != NULL && *pmsg != NULL) {
    if (filf == NULL && pmsg != NULL && *pmsg != NULL) {
    if (filf == NULL && pmsg != NULL && *pmsg != NULL) {
        frff(*pmsg);
        frff(*pmsg);
        frff(*pmsg);
        frff(*pmsg);
        frff(*pmsg);
        *pmsg = "Zip filf opfn frror";
        *pmsg = "Zip filf opfn frror";
        *pmsg = "Zip filf opfn frror";
        *pmsg = "Zip filf opfn frror";
        *pmsg = "Zip filf opfn frror";
    }
    }
    }
    }
    }
    rfturn filf;
    rfturn filf;
    rfturn filf;
    rfturn filf;
    rfturn filf;
}
}
}
}
}





/*
/*
/*
/*
/*
 * Closfs tif spfdififd zip filf objfdt.
 * Closfs tif spfdififd zip filf objfdt.
 * Closfs tif spfdififd zip filf objfdt.
 * Closfs tif spfdififd zip filf objfdt.
 * Closfs tif spfdififd zip filf objfdt.
 */
 */
 */
 */
 */
void JNICALL
void JNICALL
void JNICALL
void JNICALL
void JNICALL
ZIP_Closf(jzfilf *zip)
ZIP_Closf(jzfilf *zip)
ZIP_Closf(jzfilf *zip)
ZIP_Closf(jzfilf *zip)
ZIP_Closf(jzfilf *zip)
{
{
{
{
{
    MLOCK(zfilfs_lodk);
    MLOCK(zfilfs_lodk);
    MLOCK(zfilfs_lodk);
    MLOCK(zfilfs_lodk);
    MLOCK(zfilfs_lodk);
    if (--zip->rffs > 0) {
    if (--zip->rffs > 0) {
    if (--zip->rffs > 0) {
    if (--zip->rffs > 0) {
    if (--zip->rffs > 0) {
        /* Still morf rfffrfndfs so just rfturn */
        /* Still morf rfffrfndfs so just rfturn */
        /* Still morf rfffrfndfs so just rfturn */
        /* Still morf rfffrfndfs so just rfturn */
        /* Still morf rfffrfndfs so just rfturn */
        MUNLOCK(zfilfs_lodk);
        MUNLOCK(zfilfs_lodk);
        MUNLOCK(zfilfs_lodk);
        MUNLOCK(zfilfs_lodk);
        MUNLOCK(zfilfs_lodk);
        rfturn;
        rfturn;
        rfturn;
        rfturn;
        rfturn;
    }
    }
    }
    }
    }
    /* No otifr rfffrfndfs so dlosf tif filf bnd rfmovf from list */
    /* No otifr rfffrfndfs so dlosf tif filf bnd rfmovf from list */
    /* No otifr rfffrfndfs so dlosf tif filf bnd rfmovf from list */
    /* No otifr rfffrfndfs so dlosf tif filf bnd rfmovf from list */
    /* No otifr rfffrfndfs so dlosf tif filf bnd rfmovf from list */
    if (zfilfs == zip) {
    if (zfilfs == zip) {
    if (zfilfs == zip) {
    if (zfilfs == zip) {
    if (zfilfs == zip) {
        zfilfs = zfilfs->nfxt;
        zfilfs = zfilfs->nfxt;
        zfilfs = zfilfs->nfxt;
        zfilfs = zfilfs->nfxt;
        zfilfs = zfilfs->nfxt;
    } flsf {
    } flsf {
    } flsf {
    } flsf {
    } flsf {
        jzfilf *zp;
        jzfilf *zp;
        jzfilf *zp;
        jzfilf *zp;
        jzfilf *zp;
        for (zp = zfilfs; zp->nfxt != 0; zp = zp->nfxt) {
        for (zp = zfilfs; zp->nfxt != 0; zp = zp->nfxt) {
        for (zp = zfilfs; zp->nfxt != 0; zp = zp->nfxt) {
        for (zp = zfilfs; zp->nfxt != 0; zp = zp->nfxt) {
        for (zp = zfilfs; zp->nfxt != 0; zp = zp->nfxt) {
            if (zp->nfxt == zip) {
            if (zp->nfxt == zip) {
            if (zp->nfxt == zip) {
            if (zp->nfxt == zip) {
            if (zp->nfxt == zip) {
                zp->nfxt = zip->nfxt;
                zp->nfxt = zip->nfxt;
                zp->nfxt = zip->nfxt;
                zp->nfxt = zip->nfxt;
                zp->nfxt = zip->nfxt;
                brfbk;
                brfbk;
                brfbk;
                brfbk;
                brfbk;
            }
            }
            }
            }
            }
        }
        }
        }
        }
        }
    }
    }
    }
    }
    }
    MUNLOCK(zfilfs_lodk);
    MUNLOCK(zfilfs_lodk);
    MUNLOCK(zfilfs_lodk);
    MUNLOCK(zfilfs_lodk);
    MUNLOCK(zfilfs_lodk);
    frffZip(zip);
    frffZip(zip);
    frffZip(zip);
    frffZip(zip);
    frffZip(zip);
    rfturn;
    rfturn;
    rfturn;
    rfturn;
    rfturn;
}
}
}
}
}





/* Empiridblly, most CEN ifbdfrs brf smbllfr tibn tiis. */
/* Empiridblly, most CEN ifbdfrs brf smbllfr tibn tiis. */
/* Empiridblly, most CEN ifbdfrs brf smbllfr tibn tiis. */
/* Empiridblly, most CEN ifbdfrs brf smbllfr tibn tiis. */
/* Empiridblly, most CEN ifbdfrs brf smbllfr tibn tiis. */
#dffinf AMPLE_CEN_HEADER_SIZE 160
#dffinf AMPLE_CEN_HEADER_SIZE 160
#dffinf AMPLE_CEN_HEADER_SIZE 160
#dffinf AMPLE_CEN_HEADER_SIZE 160
#dffinf AMPLE_CEN_HEADER_SIZE 160





/* A good bufffr sizf wifn wf wbnt to rfbd CEN ifbdfrs sfqufntiblly. */
/* A good bufffr sizf wifn wf wbnt to rfbd CEN ifbdfrs sfqufntiblly. */
/* A good bufffr sizf wifn wf wbnt to rfbd CEN ifbdfrs sfqufntiblly. */
/* A good bufffr sizf wifn wf wbnt to rfbd CEN ifbdfrs sfqufntiblly. */
/* A good bufffr sizf wifn wf wbnt to rfbd CEN ifbdfrs sfqufntiblly. */
#dffinf CENCACHE_PAGESIZE 8192
#dffinf CENCACHE_PAGESIZE 8192
#dffinf CENCACHE_PAGESIZE 8192
#dffinf CENCACHE_PAGESIZE 8192
#dffinf CENCACHE_PAGESIZE 8192





stbtid dibr *
stbtid dibr *
stbtid dibr *
stbtid dibr *
stbtid dibr *
rfbdCENHfbdfr(jzfilf *zip, jlong dfnpos, jint bufsizf)
rfbdCENHfbdfr(jzfilf *zip, jlong dfnpos, jint bufsizf)
rfbdCENHfbdfr(jzfilf *zip, jlong dfnpos, jint bufsizf)
rfbdCENHfbdfr(jzfilf *zip, jlong dfnpos, jint bufsizf)
rfbdCENHfbdfr(jzfilf *zip, jlong dfnpos, jint bufsizf)
{
{
{
{
{
    jint dfnsizf;
    jint dfnsizf;
    jint dfnsizf;
    jint dfnsizf;
    jint dfnsizf;
    ZFILE zfd = zip->zfd;
    ZFILE zfd = zip->zfd;
    ZFILE zfd = zip->zfd;
    ZFILE zfd = zip->zfd;
    ZFILE zfd = zip->zfd;
    dibr *dfn;
    dibr *dfn;
    dibr *dfn;
    dibr *dfn;
    dibr *dfn;
    if (bufsizf > zip->lfn - dfnpos)
    if (bufsizf > zip->lfn - dfnpos)
    if (bufsizf > zip->lfn - dfnpos)
    if (bufsizf > zip->lfn - dfnpos)
    if (bufsizf > zip->lfn - dfnpos)
        bufsizf = (jint)(zip->lfn - dfnpos);
        bufsizf = (jint)(zip->lfn - dfnpos);
        bufsizf = (jint)(zip->lfn - dfnpos);
        bufsizf = (jint)(zip->lfn - dfnpos);
        bufsizf = (jint)(zip->lfn - dfnpos);
    if ((dfn = mbllod(bufsizf)) == NULL)       goto Cbtdi;
    if ((dfn = mbllod(bufsizf)) == NULL)       goto Cbtdi;
    if ((dfn = mbllod(bufsizf)) == NULL)       goto Cbtdi;
    if ((dfn = mbllod(bufsizf)) == NULL)       goto Cbtdi;
    if ((dfn = mbllod(bufsizf)) == NULL)       goto Cbtdi;
    if (rfbdFullyAt(zfd, dfn, bufsizf, dfnpos) == -1)     goto Cbtdi;
    if (rfbdFullyAt(zfd, dfn, bufsizf, dfnpos) == -1)     goto Cbtdi;
    if (rfbdFullyAt(zfd, dfn, bufsizf, dfnpos) == -1)     goto Cbtdi;
    if (rfbdFullyAt(zfd, dfn, bufsizf, dfnpos) == -1)     goto Cbtdi;
    if (rfbdFullyAt(zfd, dfn, bufsizf, dfnpos) == -1)     goto Cbtdi;
    dfnsizf = CENSIZE(dfn);
    dfnsizf = CENSIZE(dfn);
    dfnsizf = CENSIZE(dfn);
    dfnsizf = CENSIZE(dfn);
    dfnsizf = CENSIZE(dfn);
    if (dfnsizf <= bufsizf) rfturn dfn;
    if (dfnsizf <= bufsizf) rfturn dfn;
    if (dfnsizf <= bufsizf) rfturn dfn;
    if (dfnsizf <= bufsizf) rfturn dfn;
    if (dfnsizf <= bufsizf) rfturn dfn;
    if ((dfn = rfbllod(dfn, dfnsizf)) == NULL)              goto Cbtdi;
    if ((dfn = rfbllod(dfn, dfnsizf)) == NULL)              goto Cbtdi;
    if ((dfn = rfbllod(dfn, dfnsizf)) == NULL)              goto Cbtdi;
    if ((dfn = rfbllod(dfn, dfnsizf)) == NULL)              goto Cbtdi;
    if ((dfn = rfbllod(dfn, dfnsizf)) == NULL)              goto Cbtdi;
    if (rfbdFully(zfd, dfn+bufsizf, dfnsizf-bufsizf) == -1) goto Cbtdi;
    if (rfbdFully(zfd, dfn+bufsizf, dfnsizf-bufsizf) == -1) goto Cbtdi;
    if (rfbdFully(zfd, dfn+bufsizf, dfnsizf-bufsizf) == -1) goto Cbtdi;
    if (rfbdFully(zfd, dfn+bufsizf, dfnsizf-bufsizf) == -1) goto Cbtdi;
    if (rfbdFully(zfd, dfn+bufsizf, dfnsizf-bufsizf) == -1) goto Cbtdi;
    rfturn dfn;
    rfturn dfn;
    rfturn dfn;
    rfturn dfn;
    rfturn dfn;





 Cbtdi:
 Cbtdi:
 Cbtdi:
 Cbtdi:
 Cbtdi:
    frff(dfn);
    frff(dfn);
    frff(dfn);
    frff(dfn);
    frff(dfn);
    rfturn NULL;
    rfturn NULL;
    rfturn NULL;
    rfturn NULL;
    rfturn NULL;
}
}
}
}
}





stbtid dibr *
stbtid dibr *
stbtid dibr *
stbtid dibr *
stbtid dibr *
sfqufntiblAddfssRfbdCENHfbdfr(jzfilf *zip, jlong dfnpos)
sfqufntiblAddfssRfbdCENHfbdfr(jzfilf *zip, jlong dfnpos)
sfqufntiblAddfssRfbdCENHfbdfr(jzfilf *zip, jlong dfnpos)
sfqufntiblAddfssRfbdCENHfbdfr(jzfilf *zip, jlong dfnpos)
sfqufntiblAddfssRfbdCENHfbdfr(jzfilf *zip, jlong dfnpos)
{
{
{
{
{
    dfndbdif *dbdif = &zip->dfndbdif;
    dfndbdif *dbdif = &zip->dfndbdif;
    dfndbdif *dbdif = &zip->dfndbdif;
    dfndbdif *dbdif = &zip->dfndbdif;
    dfndbdif *dbdif = &zip->dfndbdif;
    dibr *dfn;
    dibr *dfn;
    dibr *dfn;
    dibr *dfn;
    dibr *dfn;
    if (dbdif->dbtb != NULL
    if (dbdif->dbtb != NULL
    if (dbdif->dbtb != NULL
    if (dbdif->dbtb != NULL
    if (dbdif->dbtb != NULL
        && (dfnpos >= dbdif->pos)
        && (dfnpos >= dbdif->pos)
        && (dfnpos >= dbdif->pos)
        && (dfnpos >= dbdif->pos)
        && (dfnpos >= dbdif->pos)
        && (dfnpos + CENHDR <= dbdif->pos + CENCACHE_PAGESIZE))
        && (dfnpos + CENHDR <= dbdif->pos + CENCACHE_PAGESIZE))
        && (dfnpos + CENHDR <= dbdif->pos + CENCACHE_PAGESIZE))
        && (dfnpos + CENHDR <= dbdif->pos + CENCACHE_PAGESIZE))
        && (dfnpos + CENHDR <= dbdif->pos + CENCACHE_PAGESIZE))
    {
    {
    {
    {
    {
        dfn = dbdif->dbtb + dfnpos - dbdif->pos;
        dfn = dbdif->dbtb + dfnpos - dbdif->pos;
        dfn = dbdif->dbtb + dfnpos - dbdif->pos;
        dfn = dbdif->dbtb + dfnpos - dbdif->pos;
        dfn = dbdif->dbtb + dfnpos - dbdif->pos;
        if (dfnpos + CENSIZE(dfn) <= dbdif->pos + CENCACHE_PAGESIZE)
        if (dfnpos + CENSIZE(dfn) <= dbdif->pos + CENCACHE_PAGESIZE)
        if (dfnpos + CENSIZE(dfn) <= dbdif->pos + CENCACHE_PAGESIZE)
        if (dfnpos + CENSIZE(dfn) <= dbdif->pos + CENCACHE_PAGESIZE)
        if (dfnpos + CENSIZE(dfn) <= dbdif->pos + CENCACHE_PAGESIZE)
            /* A dbdif iit */
            /* A dbdif iit */
            /* A dbdif iit */
            /* A dbdif iit */
            /* A dbdif iit */
            rfturn dfn;
            rfturn dfn;
            rfturn dfn;
            rfturn dfn;
            rfturn dfn;
    }
    }
    }
    }
    }





    if ((dfn = rfbdCENHfbdfr(zip, dfnpos, CENCACHE_PAGESIZE)) == NULL)
    if ((dfn = rfbdCENHfbdfr(zip, dfnpos, CENCACHE_PAGESIZE)) == NULL)
    if ((dfn = rfbdCENHfbdfr(zip, dfnpos, CENCACHE_PAGESIZE)) == NULL)
    if ((dfn = rfbdCENHfbdfr(zip, dfnpos, CENCACHE_PAGESIZE)) == NULL)
    if ((dfn = rfbdCENHfbdfr(zip, dfnpos, CENCACHE_PAGESIZE)) == NULL)
        rfturn NULL;
        rfturn NULL;
        rfturn NULL;
        rfturn NULL;
        rfturn NULL;
    frff(dbdif->dbtb);
    frff(dbdif->dbtb);
    frff(dbdif->dbtb);
    frff(dbdif->dbtb);
    frff(dbdif->dbtb);
    dbdif->dbtb = dfn;
    dbdif->dbtb = dfn;
    dbdif->dbtb = dfn;
    dbdif->dbtb = dfn;
    dbdif->dbtb = dfn;
    dbdif->pos  = dfnpos;
    dbdif->pos  = dfnpos;
    dbdif->pos  = dfnpos;
    dbdif->pos  = dfnpos;
    dbdif->pos  = dfnpos;
    rfturn dfn;
    rfturn dfn;
    rfturn dfn;
    rfturn dfn;
    rfturn dfn;
}
}
}
}
}





typfdff fnum { ACCESS_RANDOM, ACCESS_SEQUENTIAL } AddfssHint;
typfdff fnum { ACCESS_RANDOM, ACCESS_SEQUENTIAL } AddfssHint;
typfdff fnum { ACCESS_RANDOM, ACCESS_SEQUENTIAL } AddfssHint;
typfdff fnum { ACCESS_RANDOM, ACCESS_SEQUENTIAL } AddfssHint;
typfdff fnum { ACCESS_RANDOM, ACCESS_SEQUENTIAL } AddfssHint;





/*
/*
/*
/*
/*
 * Rfturn b nfw initiblizfd jzfntry dorrfsponding to b givfn ibsi dfll.
 * Rfturn b nfw initiblizfd jzfntry dorrfsponding to b givfn ibsi dfll.
 * Rfturn b nfw initiblizfd jzfntry dorrfsponding to b givfn ibsi dfll.
 * Rfturn b nfw initiblizfd jzfntry dorrfsponding to b givfn ibsi dfll.
 * Rfturn b nfw initiblizfd jzfntry dorrfsponding to b givfn ibsi dfll.
 * In dbsf of frror, rfturns NULL.
 * In dbsf of frror, rfturns NULL.
 * In dbsf of frror, rfturns NULL.
 * In dbsf of frror, rfturns NULL.
 * In dbsf of frror, rfturns NULL.
 * Wf blrfbdy sbnity-difdkfd bll tif CEN ifbdfrs for ZIP formbt frrors
 * Wf blrfbdy sbnity-difdkfd bll tif CEN ifbdfrs for ZIP formbt frrors
 * Wf blrfbdy sbnity-difdkfd bll tif CEN ifbdfrs for ZIP formbt frrors
 * Wf blrfbdy sbnity-difdkfd bll tif CEN ifbdfrs for ZIP formbt frrors
 * Wf blrfbdy sbnity-difdkfd bll tif CEN ifbdfrs for ZIP formbt frrors
 * in rfbdCEN(), so wf don't difdk tifm bgbin ifrf.
 * in rfbdCEN(), so wf don't difdk tifm bgbin ifrf.
 * in rfbdCEN(), so wf don't difdk tifm bgbin ifrf.
 * in rfbdCEN(), so wf don't difdk tifm bgbin ifrf.
 * in rfbdCEN(), so wf don't difdk tifm bgbin ifrf.
 * Tif ZIP lodk siould bf ifld ifrf.
 * Tif ZIP lodk siould bf ifld ifrf.
 * Tif ZIP lodk siould bf ifld ifrf.
 * Tif ZIP lodk siould bf ifld ifrf.
 * Tif ZIP lodk siould bf ifld ifrf.
 */
 */
 */
 */
 */
stbtid jzfntry *
stbtid jzfntry *
stbtid jzfntry *
stbtid jzfntry *
stbtid jzfntry *
nfwEntry(jzfilf *zip, jzdfll *zd, AddfssHint bddfssHint)
nfwEntry(jzfilf *zip, jzdfll *zd, AddfssHint bddfssHint)
nfwEntry(jzfilf *zip, jzdfll *zd, AddfssHint bddfssHint)
nfwEntry(jzfilf *zip, jzdfll *zd, AddfssHint bddfssHint)
nfwEntry(jzfilf *zip, jzdfll *zd, AddfssHint bddfssHint)
{
{
{
{
{
    jlong lodoff;
    jlong lodoff;
    jlong lodoff;
    jlong lodoff;
    jlong lodoff;
    jint nlfn, flfn, dlfn;
    jint nlfn, flfn, dlfn;
    jint nlfn, flfn, dlfn;
    jint nlfn, flfn, dlfn;
    jint nlfn, flfn, dlfn;
    jzfntry *zf;
    jzfntry *zf;
    jzfntry *zf;
    jzfntry *zf;
    jzfntry *zf;
    dibr *dfn;
    dibr *dfn;
    dibr *dfn;
    dibr *dfn;
    dibr *dfn;





    if ((zf = (jzfntry *) mbllod(sizfof(jzfntry))) == NULL) rfturn NULL;
    if ((zf = (jzfntry *) mbllod(sizfof(jzfntry))) == NULL) rfturn NULL;
    if ((zf = (jzfntry *) mbllod(sizfof(jzfntry))) == NULL) rfturn NULL;
    if ((zf = (jzfntry *) mbllod(sizfof(jzfntry))) == NULL) rfturn NULL;
    if ((zf = (jzfntry *) mbllod(sizfof(jzfntry))) == NULL) rfturn NULL;
    zf->nbmf    = NULL;
    zf->nbmf    = NULL;
    zf->nbmf    = NULL;
    zf->nbmf    = NULL;
    zf->nbmf    = NULL;
    zf->fxtrb   = NULL;
    zf->fxtrb   = NULL;
    zf->fxtrb   = NULL;
    zf->fxtrb   = NULL;
    zf->fxtrb   = NULL;
    zf->dommfnt = NULL;
    zf->dommfnt = NULL;
    zf->dommfnt = NULL;
    zf->dommfnt = NULL;
    zf->dommfnt = NULL;





#ifdff USE_MMAP
#ifdff USE_MMAP
#ifdff USE_MMAP
#ifdff USE_MMAP
#ifdff USE_MMAP
    if (zip->usfmmbp) {
    if (zip->usfmmbp) {
    if (zip->usfmmbp) {
    if (zip->usfmmbp) {
    if (zip->usfmmbp) {
        dfn = (dibr*) zip->mbddr + zd->dfnpos - zip->offsft;
        dfn = (dibr*) zip->mbddr + zd->dfnpos - zip->offsft;
        dfn = (dibr*) zip->mbddr + zd->dfnpos - zip->offsft;
        dfn = (dibr*) zip->mbddr + zd->dfnpos - zip->offsft;
        dfn = (dibr*) zip->mbddr + zd->dfnpos - zip->offsft;
    } flsf
    } flsf
    } flsf
    } flsf
    } flsf
#fndif
#fndif
#fndif
#fndif
#fndif
    {
    {
    {
    {
    {
        if (bddfssHint == ACCESS_RANDOM)
        if (bddfssHint == ACCESS_RANDOM)
        if (bddfssHint == ACCESS_RANDOM)
        if (bddfssHint == ACCESS_RANDOM)
        if (bddfssHint == ACCESS_RANDOM)
            dfn = rfbdCENHfbdfr(zip, zd->dfnpos, AMPLE_CEN_HEADER_SIZE);
            dfn = rfbdCENHfbdfr(zip, zd->dfnpos, AMPLE_CEN_HEADER_SIZE);
            dfn = rfbdCENHfbdfr(zip, zd->dfnpos, AMPLE_CEN_HEADER_SIZE);
            dfn = rfbdCENHfbdfr(zip, zd->dfnpos, AMPLE_CEN_HEADER_SIZE);
            dfn = rfbdCENHfbdfr(zip, zd->dfnpos, AMPLE_CEN_HEADER_SIZE);
        flsf
        flsf
        flsf
        flsf
        flsf
            dfn = sfqufntiblAddfssRfbdCENHfbdfr(zip, zd->dfnpos);
            dfn = sfqufntiblAddfssRfbdCENHfbdfr(zip, zd->dfnpos);
            dfn = sfqufntiblAddfssRfbdCENHfbdfr(zip, zd->dfnpos);
            dfn = sfqufntiblAddfssRfbdCENHfbdfr(zip, zd->dfnpos);
            dfn = sfqufntiblAddfssRfbdCENHfbdfr(zip, zd->dfnpos);
        if (dfn == NULL) goto Cbtdi;
        if (dfn == NULL) goto Cbtdi;
        if (dfn == NULL) goto Cbtdi;
        if (dfn == NULL) goto Cbtdi;
        if (dfn == NULL) goto Cbtdi;
    }
    }
    }
    }
    }





    nlfn      = CENNAM(dfn);
    nlfn      = CENNAM(dfn);
    nlfn      = CENNAM(dfn);
    nlfn      = CENNAM(dfn);
    nlfn      = CENNAM(dfn);
    flfn      = CENEXT(dfn);
    flfn      = CENEXT(dfn);
    flfn      = CENEXT(dfn);
    flfn      = CENEXT(dfn);
    flfn      = CENEXT(dfn);
    dlfn      = CENCOM(dfn);
    dlfn      = CENCOM(dfn);
    dlfn      = CENCOM(dfn);
    dlfn      = CENCOM(dfn);
    dlfn      = CENCOM(dfn);
    zf->timf  = CENTIM(dfn);
    zf->timf  = CENTIM(dfn);
    zf->timf  = CENTIM(dfn);
    zf->timf  = CENTIM(dfn);
    zf->timf  = CENTIM(dfn);
    zf->sizf  = CENLEN(dfn);
    zf->sizf  = CENLEN(dfn);
    zf->sizf  = CENLEN(dfn);
    zf->sizf  = CENLEN(dfn);
    zf->sizf  = CENLEN(dfn);
    zf->dsizf = (CENHOW(dfn) == STORED) ? 0 : CENSIZ(dfn);
    zf->dsizf = (CENHOW(dfn) == STORED) ? 0 : CENSIZ(dfn);
    zf->dsizf = (CENHOW(dfn) == STORED) ? 0 : CENSIZ(dfn);
    zf->dsizf = (CENHOW(dfn) == STORED) ? 0 : CENSIZ(dfn);
    zf->dsizf = (CENHOW(dfn) == STORED) ? 0 : CENSIZ(dfn);
    zf->drd   = CENCRC(dfn);
    zf->drd   = CENCRC(dfn);
    zf->drd   = CENCRC(dfn);
    zf->drd   = CENCRC(dfn);
    zf->drd   = CENCRC(dfn);
    lodoff    = CENOFF(dfn);
    lodoff    = CENOFF(dfn);
    lodoff    = CENOFF(dfn);
    lodoff    = CENOFF(dfn);
    lodoff    = CENOFF(dfn);
    zf->pos   = -(zip->lodpos + lodoff);
    zf->pos   = -(zip->lodpos + lodoff);
    zf->pos   = -(zip->lodpos + lodoff);
    zf->pos   = -(zip->lodpos + lodoff);
    zf->pos   = -(zip->lodpos + lodoff);
    zf->flbg  = CENFLG(dfn);
    zf->flbg  = CENFLG(dfn);
    zf->flbg  = CENFLG(dfn);
    zf->flbg  = CENFLG(dfn);
    zf->flbg  = CENFLG(dfn);





    if ((zf->nbmf = mbllod(nlfn + 1)) == NULL) goto Cbtdi;
    if ((zf->nbmf = mbllod(nlfn + 1)) == NULL) goto Cbtdi;
    if ((zf->nbmf = mbllod(nlfn + 1)) == NULL) goto Cbtdi;
    if ((zf->nbmf = mbllod(nlfn + 1)) == NULL) goto Cbtdi;
    if ((zf->nbmf = mbllod(nlfn + 1)) == NULL) goto Cbtdi;
    mfmdpy(zf->nbmf, dfn + CENHDR, nlfn);
    mfmdpy(zf->nbmf, dfn + CENHDR, nlfn);
    mfmdpy(zf->nbmf, dfn + CENHDR, nlfn);
    mfmdpy(zf->nbmf, dfn + CENHDR, nlfn);
    mfmdpy(zf->nbmf, dfn + CENHDR, nlfn);
    zf->nbmf[nlfn] = '\0';
    zf->nbmf[nlfn] = '\0';
    zf->nbmf[nlfn] = '\0';
    zf->nbmf[nlfn] = '\0';
    zf->nbmf[nlfn] = '\0';
    if (flfn > 0) {
    if (flfn > 0) {
    if (flfn > 0) {
    if (flfn > 0) {
    if (flfn > 0) {
        dibr *fxtrb = dfn + CENHDR + nlfn;
        dibr *fxtrb = dfn + CENHDR + nlfn;
        dibr *fxtrb = dfn + CENHDR + nlfn;
        dibr *fxtrb = dfn + CENHDR + nlfn;
        dibr *fxtrb = dfn + CENHDR + nlfn;





        /* Tiis fntry ibs "fxtrb" dbtb */
        /* Tiis fntry ibs "fxtrb" dbtb */
        /* Tiis fntry ibs "fxtrb" dbtb */
        /* Tiis fntry ibs "fxtrb" dbtb */
        /* Tiis fntry ibs "fxtrb" dbtb */
        if ((zf->fxtrb = mbllod(flfn + 2)) == NULL) goto Cbtdi;
        if ((zf->fxtrb = mbllod(flfn + 2)) == NULL) goto Cbtdi;
        if ((zf->fxtrb = mbllod(flfn + 2)) == NULL) goto Cbtdi;
        if ((zf->fxtrb = mbllod(flfn + 2)) == NULL) goto Cbtdi;
        if ((zf->fxtrb = mbllod(flfn + 2)) == NULL) goto Cbtdi;
        zf->fxtrb[0] = (unsignfd dibr) flfn;
        zf->fxtrb[0] = (unsignfd dibr) flfn;
        zf->fxtrb[0] = (unsignfd dibr) flfn;
        zf->fxtrb[0] = (unsignfd dibr) flfn;
        zf->fxtrb[0] = (unsignfd dibr) flfn;
        zf->fxtrb[1] = (unsignfd dibr) (flfn >> 8);
        zf->fxtrb[1] = (unsignfd dibr) (flfn >> 8);
        zf->fxtrb[1] = (unsignfd dibr) (flfn >> 8);
        zf->fxtrb[1] = (unsignfd dibr) (flfn >> 8);
        zf->fxtrb[1] = (unsignfd dibr) (flfn >> 8);
        mfmdpy(zf->fxtrb+2, fxtrb, flfn);
        mfmdpy(zf->fxtrb+2, fxtrb, flfn);
        mfmdpy(zf->fxtrb+2, fxtrb, flfn);
        mfmdpy(zf->fxtrb+2, fxtrb, flfn);
        mfmdpy(zf->fxtrb+2, fxtrb, flfn);
        if (zf->dsizf == ZIP64_MAGICVAL || zf->sizf == ZIP64_MAGICVAL ||
        if (zf->dsizf == ZIP64_MAGICVAL || zf->sizf == ZIP64_MAGICVAL ||
        if (zf->dsizf == ZIP64_MAGICVAL || zf->sizf == ZIP64_MAGICVAL ||
        if (zf->dsizf == ZIP64_MAGICVAL || zf->sizf == ZIP64_MAGICVAL ||
        if (zf->dsizf == ZIP64_MAGICVAL || zf->sizf == ZIP64_MAGICVAL ||
            lodoff == ZIP64_MAGICVAL) {
            lodoff == ZIP64_MAGICVAL) {
            lodoff == ZIP64_MAGICVAL) {
            lodoff == ZIP64_MAGICVAL) {
            lodoff == ZIP64_MAGICVAL) {
            jint off = 0;
            jint off = 0;
            jint off = 0;
            jint off = 0;
            jint off = 0;
            wiilf ((off + 4) < flfn) {    // spfd: HfbdfrID+DbtbSizf+Dbtb
            wiilf ((off + 4) < flfn) {    // spfd: HfbdfrID+DbtbSizf+Dbtb
            wiilf ((off + 4) < flfn) {    // spfd: HfbdfrID+DbtbSizf+Dbtb
            wiilf ((off + 4) < flfn) {    // spfd: HfbdfrID+DbtbSizf+Dbtb
            wiilf ((off + 4) < flfn) {    // spfd: HfbdfrID+DbtbSizf+Dbtb
                jint sz = SH(fxtrb, off + 2);
                jint sz = SH(fxtrb, off + 2);
                jint sz = SH(fxtrb, off + 2);
                jint sz = SH(fxtrb, off + 2);
                jint sz = SH(fxtrb, off + 2);
                if (SH(fxtrb, off) == ZIP64_EXTID) {
                if (SH(fxtrb, off) == ZIP64_EXTID) {
                if (SH(fxtrb, off) == ZIP64_EXTID) {
                if (SH(fxtrb, off) == ZIP64_EXTID) {
                if (SH(fxtrb, off) == ZIP64_EXTID) {
                    off += 4;
                    off += 4;
                    off += 4;
                    off += 4;
                    off += 4;
                    if (zf->sizf == ZIP64_MAGICVAL) {
                    if (zf->sizf == ZIP64_MAGICVAL) {
                    if (zf->sizf == ZIP64_MAGICVAL) {
                    if (zf->sizf == ZIP64_MAGICVAL) {
                    if (zf->sizf == ZIP64_MAGICVAL) {
                        // if invblid zip64 fxtrb fiflds, just skip
                        // if invblid zip64 fxtrb fiflds, just skip
                        // if invblid zip64 fxtrb fiflds, just skip
                        // if invblid zip64 fxtrb fiflds, just skip
                        // if invblid zip64 fxtrb fiflds, just skip
                        if (sz < 8 || (off + 8) > flfn)
                        if (sz < 8 || (off + 8) > flfn)
                        if (sz < 8 || (off + 8) > flfn)
                        if (sz < 8 || (off + 8) > flfn)
                        if (sz < 8 || (off + 8) > flfn)
                            brfbk;
                            brfbk;
                            brfbk;
                            brfbk;
                            brfbk;
                        zf->sizf = LL(fxtrb, off);
                        zf->sizf = LL(fxtrb, off);
                        zf->sizf = LL(fxtrb, off);
                        zf->sizf = LL(fxtrb, off);
                        zf->sizf = LL(fxtrb, off);
                        sz -= 8;
                        sz -= 8;
                        sz -= 8;
                        sz -= 8;
                        sz -= 8;
                        off += 8;
                        off += 8;
                        off += 8;
                        off += 8;
                        off += 8;
                    }
                    }
                    }
                    }
                    }
                    if (zf->dsizf == ZIP64_MAGICVAL) {
                    if (zf->dsizf == ZIP64_MAGICVAL) {
                    if (zf->dsizf == ZIP64_MAGICVAL) {
                    if (zf->dsizf == ZIP64_MAGICVAL) {
                    if (zf->dsizf == ZIP64_MAGICVAL) {
                        if (sz < 8 || (off + 8) > flfn)
                        if (sz < 8 || (off + 8) > flfn)
                        if (sz < 8 || (off + 8) > flfn)
                        if (sz < 8 || (off + 8) > flfn)
                        if (sz < 8 || (off + 8) > flfn)
                            brfbk;
                            brfbk;
                            brfbk;
                            brfbk;
                            brfbk;
                        zf->dsizf = LL(fxtrb, off);
                        zf->dsizf = LL(fxtrb, off);
                        zf->dsizf = LL(fxtrb, off);
                        zf->dsizf = LL(fxtrb, off);
                        zf->dsizf = LL(fxtrb, off);
                        sz -= 8;
                        sz -= 8;
                        sz -= 8;
                        sz -= 8;
                        sz -= 8;
                        off += 8;
                        off += 8;
                        off += 8;
                        off += 8;
                        off += 8;
                    }
                    }
                    }
                    }
                    }
                    if (lodoff == ZIP64_MAGICVAL) {
                    if (lodoff == ZIP64_MAGICVAL) {
                    if (lodoff == ZIP64_MAGICVAL) {
                    if (lodoff == ZIP64_MAGICVAL) {
                    if (lodoff == ZIP64_MAGICVAL) {
                        if (sz < 8 || (off + 8) > flfn)
                        if (sz < 8 || (off + 8) > flfn)
                        if (sz < 8 || (off + 8) > flfn)
                        if (sz < 8 || (off + 8) > flfn)
                        if (sz < 8 || (off + 8) > flfn)
                            brfbk;
                            brfbk;
                            brfbk;
                            brfbk;
                            brfbk;
                        zf->pos = -(zip->lodpos +  LL(fxtrb, off));
                        zf->pos = -(zip->lodpos +  LL(fxtrb, off));
                        zf->pos = -(zip->lodpos +  LL(fxtrb, off));
                        zf->pos = -(zip->lodpos +  LL(fxtrb, off));
                        zf->pos = -(zip->lodpos +  LL(fxtrb, off));
                        sz -= 8;
                        sz -= 8;
                        sz -= 8;
                        sz -= 8;
                        sz -= 8;
                        off += 8;
                        off += 8;
                        off += 8;
                        off += 8;
                        off += 8;
                    }
                    }
                    }
                    }
                    }
                    brfbk;
                    brfbk;
                    brfbk;
                    brfbk;
                    brfbk;
                }
                }
                }
                }
                }
                off += (sz + 4);
                off += (sz + 4);
                off += (sz + 4);
                off += (sz + 4);
                off += (sz + 4);
            }
            }
            }
            }
            }
        }
        }
        }
        }
        }
    }
    }
    }
    }
    }





    if (dlfn > 0) {
    if (dlfn > 0) {
    if (dlfn > 0) {
    if (dlfn > 0) {
    if (dlfn > 0) {
        /* Tiis fntry ibs b dommfnt */
        /* Tiis fntry ibs b dommfnt */
        /* Tiis fntry ibs b dommfnt */
        /* Tiis fntry ibs b dommfnt */
        /* Tiis fntry ibs b dommfnt */
        if ((zf->dommfnt = mbllod(dlfn + 1)) == NULL) goto Cbtdi;
        if ((zf->dommfnt = mbllod(dlfn + 1)) == NULL) goto Cbtdi;
        if ((zf->dommfnt = mbllod(dlfn + 1)) == NULL) goto Cbtdi;
        if ((zf->dommfnt = mbllod(dlfn + 1)) == NULL) goto Cbtdi;
        if ((zf->dommfnt = mbllod(dlfn + 1)) == NULL) goto Cbtdi;
        mfmdpy(zf->dommfnt, dfn + CENHDR + nlfn + flfn, dlfn);
        mfmdpy(zf->dommfnt, dfn + CENHDR + nlfn + flfn, dlfn);
        mfmdpy(zf->dommfnt, dfn + CENHDR + nlfn + flfn, dlfn);
        mfmdpy(zf->dommfnt, dfn + CENHDR + nlfn + flfn, dlfn);
        mfmdpy(zf->dommfnt, dfn + CENHDR + nlfn + flfn, dlfn);
        zf->dommfnt[dlfn] = '\0';
        zf->dommfnt[dlfn] = '\0';
        zf->dommfnt[dlfn] = '\0';
        zf->dommfnt[dlfn] = '\0';
        zf->dommfnt[dlfn] = '\0';
    }
    }
    }
    }
    }
    goto Finblly;
    goto Finblly;
    goto Finblly;
    goto Finblly;
    goto Finblly;





 Cbtdi:
 Cbtdi:
 Cbtdi:
 Cbtdi:
 Cbtdi:
    frff(zf->nbmf);
    frff(zf->nbmf);
    frff(zf->nbmf);
    frff(zf->nbmf);
    frff(zf->nbmf);
    frff(zf->fxtrb);
    frff(zf->fxtrb);
    frff(zf->fxtrb);
    frff(zf->fxtrb);
    frff(zf->fxtrb);
    frff(zf->dommfnt);
    frff(zf->dommfnt);
    frff(zf->dommfnt);
    frff(zf->dommfnt);
    frff(zf->dommfnt);
    frff(zf);
    frff(zf);
    frff(zf);
    frff(zf);
    frff(zf);
    zf = NULL;
    zf = NULL;
    zf = NULL;
    zf = NULL;
    zf = NULL;





 Finblly:
 Finblly:
 Finblly:
 Finblly:
 Finblly:
#ifdff USE_MMAP
#ifdff USE_MMAP
#ifdff USE_MMAP
#ifdff USE_MMAP
#ifdff USE_MMAP
    if (!zip->usfmmbp)
    if (!zip->usfmmbp)
    if (!zip->usfmmbp)
    if (!zip->usfmmbp)
    if (!zip->usfmmbp)
#fndif
#fndif
#fndif
#fndif
#fndif
        if (dfn != NULL && bddfssHint == ACCESS_RANDOM) frff(dfn);
        if (dfn != NULL && bddfssHint == ACCESS_RANDOM) frff(dfn);
        if (dfn != NULL && bddfssHint == ACCESS_RANDOM) frff(dfn);
        if (dfn != NULL && bddfssHint == ACCESS_RANDOM) frff(dfn);
        if (dfn != NULL && bddfssHint == ACCESS_RANDOM) frff(dfn);
    rfturn zf;
    rfturn zf;
    rfturn zf;
    rfturn zf;
    rfturn zf;
}
}
}
}
}





/*
/*
/*
/*
/*
 * Frff tif givfn jzfntry.
 * Frff tif givfn jzfntry.
 * Frff tif givfn jzfntry.
 * Frff tif givfn jzfntry.
 * Frff tif givfn jzfntry.
 * In fbdt wf mbintbin b onf-fntry dbdif of tif most rfdfntly usfd
 * In fbdt wf mbintbin b onf-fntry dbdif of tif most rfdfntly usfd
 * In fbdt wf mbintbin b onf-fntry dbdif of tif most rfdfntly usfd
 * In fbdt wf mbintbin b onf-fntry dbdif of tif most rfdfntly usfd
 * In fbdt wf mbintbin b onf-fntry dbdif of tif most rfdfntly usfd
 * jzfntry for fbdi zip.  Tiis optimizfs b dommon bddfss pbttfrn.
 * jzfntry for fbdi zip.  Tiis optimizfs b dommon bddfss pbttfrn.
 * jzfntry for fbdi zip.  Tiis optimizfs b dommon bddfss pbttfrn.
 * jzfntry for fbdi zip.  Tiis optimizfs b dommon bddfss pbttfrn.
 * jzfntry for fbdi zip.  Tiis optimizfs b dommon bddfss pbttfrn.
 */
 */
 */
 */
 */





void
void
void
void
void
ZIP_FrffEntry(jzfilf *jz, jzfntry *zf)
ZIP_FrffEntry(jzfilf *jz, jzfntry *zf)
ZIP_FrffEntry(jzfilf *jz, jzfntry *zf)
ZIP_FrffEntry(jzfilf *jz, jzfntry *zf)
ZIP_FrffEntry(jzfilf *jz, jzfntry *zf)
{
{
{
{
{
    jzfntry *lbst;
    jzfntry *lbst;
    jzfntry *lbst;
    jzfntry *lbst;
    jzfntry *lbst;
    ZIP_Lodk(jz);
    ZIP_Lodk(jz);
    ZIP_Lodk(jz);
    ZIP_Lodk(jz);
    ZIP_Lodk(jz);
    lbst = jz->dbdif;
    lbst = jz->dbdif;
    lbst = jz->dbdif;
    lbst = jz->dbdif;
    lbst = jz->dbdif;
    jz->dbdif = zf;
    jz->dbdif = zf;
    jz->dbdif = zf;
    jz->dbdif = zf;
    jz->dbdif = zf;
    ZIP_Unlodk(jz);
    ZIP_Unlodk(jz);
    ZIP_Unlodk(jz);
    ZIP_Unlodk(jz);
    ZIP_Unlodk(jz);
    if (lbst != NULL) {
    if (lbst != NULL) {
    if (lbst != NULL) {
    if (lbst != NULL) {
    if (lbst != NULL) {
        /* Frff tif prfviously dbdifd jzfntry */
        /* Frff tif prfviously dbdifd jzfntry */
        /* Frff tif prfviously dbdifd jzfntry */
        /* Frff tif prfviously dbdifd jzfntry */
        /* Frff tif prfviously dbdifd jzfntry */
        frff(lbst->nbmf);
        frff(lbst->nbmf);
        frff(lbst->nbmf);
        frff(lbst->nbmf);
        frff(lbst->nbmf);
        if (lbst->fxtrb)   frff(lbst->fxtrb);
        if (lbst->fxtrb)   frff(lbst->fxtrb);
        if (lbst->fxtrb)   frff(lbst->fxtrb);
        if (lbst->fxtrb)   frff(lbst->fxtrb);
        if (lbst->fxtrb)   frff(lbst->fxtrb);
        if (lbst->dommfnt) frff(lbst->dommfnt);
        if (lbst->dommfnt) frff(lbst->dommfnt);
        if (lbst->dommfnt) frff(lbst->dommfnt);
        if (lbst->dommfnt) frff(lbst->dommfnt);
        if (lbst->dommfnt) frff(lbst->dommfnt);
        frff(lbst);
        frff(lbst);
        frff(lbst);
        frff(lbst);
        frff(lbst);
    }
    }
    }
    }
    }
}
}
}
}
}





/*
/*
/*
/*
/*
 * Rfturns tif zip fntry dorrfsponding to tif spfdififd nbmf, or
 * Rfturns tif zip fntry dorrfsponding to tif spfdififd nbmf, or
 * Rfturns tif zip fntry dorrfsponding to tif spfdififd nbmf, or
 * Rfturns tif zip fntry dorrfsponding to tif spfdififd nbmf, or
 * Rfturns tif zip fntry dorrfsponding to tif spfdififd nbmf, or
 * NULL if not found.
 * NULL if not found.
 * NULL if not found.
 * NULL if not found.
 * NULL if not found.
 */
 */
 */
 */
 */
jzfntry *
jzfntry *
jzfntry *
jzfntry *
jzfntry *
ZIP_GftEntry(jzfilf *zip, dibr *nbmf, jint ulfn)
ZIP_GftEntry(jzfilf *zip, dibr *nbmf, jint ulfn)
ZIP_GftEntry(jzfilf *zip, dibr *nbmf, jint ulfn)
ZIP_GftEntry(jzfilf *zip, dibr *nbmf, jint ulfn)
ZIP_GftEntry(jzfilf *zip, dibr *nbmf, jint ulfn)
{
{
{
{
{
    unsignfd int isi = ibsi(nbmf);
    unsignfd int isi = ibsi(nbmf);
    unsignfd int isi = ibsi(nbmf);
    unsignfd int isi = ibsi(nbmf);
    unsignfd int isi = ibsi(nbmf);
    jint idx;
    jint idx;
    jint idx;
    jint idx;
    jint idx;
    jzfntry *zf = 0;
    jzfntry *zf = 0;
    jzfntry *zf = 0;
    jzfntry *zf = 0;
    jzfntry *zf = 0;





    ZIP_Lodk(zip);
    ZIP_Lodk(zip);
    ZIP_Lodk(zip);
    ZIP_Lodk(zip);
    ZIP_Lodk(zip);
    if (zip->totbl == 0) {
    if (zip->totbl == 0) {
    if (zip->totbl == 0) {
    if (zip->totbl == 0) {
    if (zip->totbl == 0) {
        goto Finblly;
        goto Finblly;
        goto Finblly;
        goto Finblly;
        goto Finblly;
    }
    }
    }
    }
    }





    idx = zip->tbblf[isi % zip->tbblflfn];
    idx = zip->tbblf[isi % zip->tbblflfn];
    idx = zip->tbblf[isi % zip->tbblflfn];
    idx = zip->tbblf[isi % zip->tbblflfn];
    idx = zip->tbblf[isi % zip->tbblflfn];





    /*
    /*
    /*
    /*
    /*
     * Tiis wiilf loop is bn optimizbtion wifrf b doublf lookup
     * Tiis wiilf loop is bn optimizbtion wifrf b doublf lookup
     * Tiis wiilf loop is bn optimizbtion wifrf b doublf lookup
     * Tiis wiilf loop is bn optimizbtion wifrf b doublf lookup
     * Tiis wiilf loop is bn optimizbtion wifrf b doublf lookup
     * for nbmf bnd nbmf+/ is bfing pfrformfd. Tif nbmf dibr
     * for nbmf bnd nbmf+/ is bfing pfrformfd. Tif nbmf dibr
     * for nbmf bnd nbmf+/ is bfing pfrformfd. Tif nbmf dibr
     * for nbmf bnd nbmf+/ is bfing pfrformfd. Tif nbmf dibr
     * for nbmf bnd nbmf+/ is bfing pfrformfd. Tif nbmf dibr
     * brrby ibs fnougi room bt tif fnd to try bgbin witi b
     * brrby ibs fnougi room bt tif fnd to try bgbin witi b
     * brrby ibs fnougi room bt tif fnd to try bgbin witi b
     * brrby ibs fnougi room bt tif fnd to try bgbin witi b
     * brrby ibs fnougi room bt tif fnd to try bgbin witi b
     * slbsi bppfndfd if tif first tbblf lookup dofs not suddffd.
     * slbsi bppfndfd if tif first tbblf lookup dofs not suddffd.
     * slbsi bppfndfd if tif first tbblf lookup dofs not suddffd.
     * slbsi bppfndfd if tif first tbblf lookup dofs not suddffd.
     * slbsi bppfndfd if tif first tbblf lookup dofs not suddffd.
     */
     */
     */
     */
     */
    wiilf(1) {
    wiilf(1) {
    wiilf(1) {
    wiilf(1) {
    wiilf(1) {





        /* Cifdk tif dbdifd fntry first */
        /* Cifdk tif dbdifd fntry first */
        /* Cifdk tif dbdifd fntry first */
        /* Cifdk tif dbdifd fntry first */
        /* Cifdk tif dbdifd fntry first */
        zf = zip->dbdif;
        zf = zip->dbdif;
        zf = zip->dbdif;
        zf = zip->dbdif;
        zf = zip->dbdif;
        if (zf && strdmp(zf->nbmf,nbmf) == 0) {
        if (zf && strdmp(zf->nbmf,nbmf) == 0) {
        if (zf && strdmp(zf->nbmf,nbmf) == 0) {
        if (zf && strdmp(zf->nbmf,nbmf) == 0) {
        if (zf && strdmp(zf->nbmf,nbmf) == 0) {
            /* Cbdif iit!  Rfmovf bnd rfturn tif dbdifd fntry. */
            /* Cbdif iit!  Rfmovf bnd rfturn tif dbdifd fntry. */
            /* Cbdif iit!  Rfmovf bnd rfturn tif dbdifd fntry. */
            /* Cbdif iit!  Rfmovf bnd rfturn tif dbdifd fntry. */
            /* Cbdif iit!  Rfmovf bnd rfturn tif dbdifd fntry. */
            zip->dbdif = 0;
            zip->dbdif = 0;
            zip->dbdif = 0;
            zip->dbdif = 0;
            zip->dbdif = 0;
            ZIP_Unlodk(zip);
            ZIP_Unlodk(zip);
            ZIP_Unlodk(zip);
            ZIP_Unlodk(zip);
            ZIP_Unlodk(zip);
            rfturn zf;
            rfturn zf;
            rfturn zf;
            rfturn zf;
            rfturn zf;
        }
        }
        }
        }
        }
        zf = 0;
        zf = 0;
        zf = 0;
        zf = 0;
        zf = 0;





        /*
        /*
        /*
        /*
        /*
         * Sfbrdi down tif tbrgft ibsi dibin for b dfll wiosf
         * Sfbrdi down tif tbrgft ibsi dibin for b dfll wiosf
         * Sfbrdi down tif tbrgft ibsi dibin for b dfll wiosf
         * Sfbrdi down tif tbrgft ibsi dibin for b dfll wiosf
         * Sfbrdi down tif tbrgft ibsi dibin for b dfll wiosf
         * 32 bit ibsi mbtdifs tif ibsifd nbmf.
         * 32 bit ibsi mbtdifs tif ibsifd nbmf.
         * 32 bit ibsi mbtdifs tif ibsifd nbmf.
         * 32 bit ibsi mbtdifs tif ibsifd nbmf.
         * 32 bit ibsi mbtdifs tif ibsifd nbmf.
         */
         */
         */
         */
         */
        wiilf (idx != ZIP_ENDCHAIN) {
        wiilf (idx != ZIP_ENDCHAIN) {
        wiilf (idx != ZIP_ENDCHAIN) {
        wiilf (idx != ZIP_ENDCHAIN) {
        wiilf (idx != ZIP_ENDCHAIN) {
            jzdfll *zd = &zip->fntrifs[idx];
            jzdfll *zd = &zip->fntrifs[idx];
            jzdfll *zd = &zip->fntrifs[idx];
            jzdfll *zd = &zip->fntrifs[idx];
            jzdfll *zd = &zip->fntrifs[idx];





            if (zd->ibsi == isi) {
            if (zd->ibsi == isi) {
            if (zd->ibsi == isi) {
            if (zd->ibsi == isi) {
            if (zd->ibsi == isi) {
                /*
                /*
                /*
                /*
                /*
                 * OK, wf'vf found b ZIP fntry wiosf 32 bit ibsidodf
                 * OK, wf'vf found b ZIP fntry wiosf 32 bit ibsidodf
                 * OK, wf'vf found b ZIP fntry wiosf 32 bit ibsidodf
                 * OK, wf'vf found b ZIP fntry wiosf 32 bit ibsidodf
                 * OK, wf'vf found b ZIP fntry wiosf 32 bit ibsidodf
                 * mbtdifs tif nbmf wf'rf looking for.  Try to rfbd
                 * mbtdifs tif nbmf wf'rf looking for.  Try to rfbd
                 * mbtdifs tif nbmf wf'rf looking for.  Try to rfbd
                 * mbtdifs tif nbmf wf'rf looking for.  Try to rfbd
                 * mbtdifs tif nbmf wf'rf looking for.  Try to rfbd
                 * its fntry informbtion from tif CEN.  If tif CEN
                 * its fntry informbtion from tif CEN.  If tif CEN
                 * its fntry informbtion from tif CEN.  If tif CEN
                 * its fntry informbtion from tif CEN.  If tif CEN
                 * its fntry informbtion from tif CEN.  If tif CEN
                 * nbmf mbtdifs tif nbmf wf'rf looking for, wf'rf
                 * nbmf mbtdifs tif nbmf wf'rf looking for, wf'rf
                 * nbmf mbtdifs tif nbmf wf'rf looking for, wf'rf
                 * nbmf mbtdifs tif nbmf wf'rf looking for, wf'rf
                 * nbmf mbtdifs tif nbmf wf'rf looking for, wf'rf
                 * donf.
                 * donf.
                 * donf.
                 * donf.
                 * donf.
                 * If tif nbmfs don't mbtdi (wiidi siould bf vfry rbrf)
                 * If tif nbmfs don't mbtdi (wiidi siould bf vfry rbrf)
                 * If tif nbmfs don't mbtdi (wiidi siould bf vfry rbrf)
                 * If tif nbmfs don't mbtdi (wiidi siould bf vfry rbrf)
                 * If tif nbmfs don't mbtdi (wiidi siould bf vfry rbrf)
                 * wf kffp sfbrdiing.
                 * wf kffp sfbrdiing.
                 * wf kffp sfbrdiing.
                 * wf kffp sfbrdiing.
                 * wf kffp sfbrdiing.
                 */
                 */
                 */
                 */
                 */
                zf = nfwEntry(zip, zd, ACCESS_RANDOM);
                zf = nfwEntry(zip, zd, ACCESS_RANDOM);
                zf = nfwEntry(zip, zd, ACCESS_RANDOM);
                zf = nfwEntry(zip, zd, ACCESS_RANDOM);
                zf = nfwEntry(zip, zd, ACCESS_RANDOM);
                if (zf && strdmp(zf->nbmf, nbmf)==0) {
                if (zf && strdmp(zf->nbmf, nbmf)==0) {
                if (zf && strdmp(zf->nbmf, nbmf)==0) {
                if (zf && strdmp(zf->nbmf, nbmf)==0) {
                if (zf && strdmp(zf->nbmf, nbmf)==0) {
                    brfbk;
                    brfbk;
                    brfbk;
                    brfbk;
                    brfbk;
                }
                }
                }
                }
                }
                if (zf != 0) {
                if (zf != 0) {
                if (zf != 0) {
                if (zf != 0) {
                if (zf != 0) {
                    /* Wf nffd to rflfbsf tif lodk bdross tif frff dbll */
                    /* Wf nffd to rflfbsf tif lodk bdross tif frff dbll */
                    /* Wf nffd to rflfbsf tif lodk bdross tif frff dbll */
                    /* Wf nffd to rflfbsf tif lodk bdross tif frff dbll */
                    /* Wf nffd to rflfbsf tif lodk bdross tif frff dbll */
                    ZIP_Unlodk(zip);
                    ZIP_Unlodk(zip);
                    ZIP_Unlodk(zip);
                    ZIP_Unlodk(zip);
                    ZIP_Unlodk(zip);
                    ZIP_FrffEntry(zip, zf);
                    ZIP_FrffEntry(zip, zf);
                    ZIP_FrffEntry(zip, zf);
                    ZIP_FrffEntry(zip, zf);
                    ZIP_FrffEntry(zip, zf);
                    ZIP_Lodk(zip);
                    ZIP_Lodk(zip);
                    ZIP_Lodk(zip);
                    ZIP_Lodk(zip);
                    ZIP_Lodk(zip);
                }
                }
                }
                }
                }
                zf = 0;
                zf = 0;
                zf = 0;
                zf = 0;
                zf = 0;
            }
            }
            }
            }
            }
            idx = zd->nfxt;
            idx = zd->nfxt;
            idx = zd->nfxt;
            idx = zd->nfxt;
            idx = zd->nfxt;
        }
        }
        }
        }
        }





        /* Entry found, rfturn it */
        /* Entry found, rfturn it */
        /* Entry found, rfturn it */
        /* Entry found, rfturn it */
        /* Entry found, rfturn it */
        if (zf != 0) {
        if (zf != 0) {
        if (zf != 0) {
        if (zf != 0) {
        if (zf != 0) {
            brfbk;
            brfbk;
            brfbk;
            brfbk;
            brfbk;
        }
        }
        }
        }
        }





        /* If no rfbl lfngti wbs pbssfd in, wf brf donf */
        /* If no rfbl lfngti wbs pbssfd in, wf brf donf */
        /* If no rfbl lfngti wbs pbssfd in, wf brf donf */
        /* If no rfbl lfngti wbs pbssfd in, wf brf donf */
        /* If no rfbl lfngti wbs pbssfd in, wf brf donf */
        if (ulfn == 0) {
        if (ulfn == 0) {
        if (ulfn == 0) {
        if (ulfn == 0) {
        if (ulfn == 0) {
            brfbk;
            brfbk;
            brfbk;
            brfbk;
            brfbk;
        }
        }
        }
        }
        }





        /* Slbsi is blrfbdy tifrf? */
        /* Slbsi is blrfbdy tifrf? */
        /* Slbsi is blrfbdy tifrf? */
        /* Slbsi is blrfbdy tifrf? */
        /* Slbsi is blrfbdy tifrf? */
        if (nbmf[ulfn-1] == '/') {
        if (nbmf[ulfn-1] == '/') {
        if (nbmf[ulfn-1] == '/') {
        if (nbmf[ulfn-1] == '/') {
        if (nbmf[ulfn-1] == '/') {
            brfbk;
            brfbk;
            brfbk;
            brfbk;
            brfbk;
        }
        }
        }
        }
        }





        /* Add slbsi bnd try ondf morf */
        /* Add slbsi bnd try ondf morf */
        /* Add slbsi bnd try ondf morf */
        /* Add slbsi bnd try ondf morf */
        /* Add slbsi bnd try ondf morf */
        nbmf[ulfn] = '/';
        nbmf[ulfn] = '/';
        nbmf[ulfn] = '/';
        nbmf[ulfn] = '/';
        nbmf[ulfn] = '/';
        nbmf[ulfn+1] = '\0';
        nbmf[ulfn+1] = '\0';
        nbmf[ulfn+1] = '\0';
        nbmf[ulfn+1] = '\0';
        nbmf[ulfn+1] = '\0';
        isi = ibsi_bppfnd(isi, '/');
        isi = ibsi_bppfnd(isi, '/');
        isi = ibsi_bppfnd(isi, '/');
        isi = ibsi_bppfnd(isi, '/');
        isi = ibsi_bppfnd(isi, '/');
        idx = zip->tbblf[isi % zip->tbblflfn];
        idx = zip->tbblf[isi % zip->tbblflfn];
        idx = zip->tbblf[isi % zip->tbblflfn];
        idx = zip->tbblf[isi % zip->tbblflfn];
        idx = zip->tbblf[isi % zip->tbblflfn];
        ulfn = 0;
        ulfn = 0;
        ulfn = 0;
        ulfn = 0;
        ulfn = 0;
    }
    }
    }
    }
    }





Finblly:
Finblly:
Finblly:
Finblly:
Finblly:
    ZIP_Unlodk(zip);
    ZIP_Unlodk(zip);
    ZIP_Unlodk(zip);
    ZIP_Unlodk(zip);
    ZIP_Unlodk(zip);
    rfturn zf;
    rfturn zf;
    rfturn zf;
    rfturn zf;
    rfturn zf;
}
}
}
}
}





/*
/*
/*
/*
/*
 * Rfturns tif n'ti (stbrting bt zfro) zip filf fntry, or NULL if tif
 * Rfturns tif n'ti (stbrting bt zfro) zip filf fntry, or NULL if tif
 * Rfturns tif n'ti (stbrting bt zfro) zip filf fntry, or NULL if tif
 * Rfturns tif n'ti (stbrting bt zfro) zip filf fntry, or NULL if tif
 * Rfturns tif n'ti (stbrting bt zfro) zip filf fntry, or NULL if tif
 * spfdififd indfx wbs out of rbngf.
 * spfdififd indfx wbs out of rbngf.
 * spfdififd indfx wbs out of rbngf.
 * spfdififd indfx wbs out of rbngf.
 * spfdififd indfx wbs out of rbngf.
 */
 */
 */
 */
 */
jzfntry * JNICALL
jzfntry * JNICALL
jzfntry * JNICALL
jzfntry * JNICALL
jzfntry * JNICALL
ZIP_GftNfxtEntry(jzfilf *zip, jint n)
ZIP_GftNfxtEntry(jzfilf *zip, jint n)
ZIP_GftNfxtEntry(jzfilf *zip, jint n)
ZIP_GftNfxtEntry(jzfilf *zip, jint n)
ZIP_GftNfxtEntry(jzfilf *zip, jint n)
{
{
{
{
{
    jzfntry *rfsult;
    jzfntry *rfsult;
    jzfntry *rfsult;
    jzfntry *rfsult;
    jzfntry *rfsult;
    if (n < 0 || n >= zip->totbl) {
    if (n < 0 || n >= zip->totbl) {
    if (n < 0 || n >= zip->totbl) {
    if (n < 0 || n >= zip->totbl) {
    if (n < 0 || n >= zip->totbl) {
        rfturn 0;
        rfturn 0;
        rfturn 0;
        rfturn 0;
        rfturn 0;
    }
    }
    }
    }
    }
    ZIP_Lodk(zip);
    ZIP_Lodk(zip);
    ZIP_Lodk(zip);
    ZIP_Lodk(zip);
    ZIP_Lodk(zip);
    rfsult = nfwEntry(zip, &zip->fntrifs[n], ACCESS_SEQUENTIAL);
    rfsult = nfwEntry(zip, &zip->fntrifs[n], ACCESS_SEQUENTIAL);
    rfsult = nfwEntry(zip, &zip->fntrifs[n], ACCESS_SEQUENTIAL);
    rfsult = nfwEntry(zip, &zip->fntrifs[n], ACCESS_SEQUENTIAL);
    rfsult = nfwEntry(zip, &zip->fntrifs[n], ACCESS_SEQUENTIAL);
    ZIP_Unlodk(zip);
    ZIP_Unlodk(zip);
    ZIP_Unlodk(zip);
    ZIP_Unlodk(zip);
    ZIP_Unlodk(zip);
    rfturn rfsult;
    rfturn rfsult;
    rfturn rfsult;
    rfturn rfsult;
    rfturn rfsult;
}
}
}
}
}





/*
/*
/*
/*
/*
 * Lodks tif spfdififd zip filf for rfbding.
 * Lodks tif spfdififd zip filf for rfbding.
 * Lodks tif spfdififd zip filf for rfbding.
 * Lodks tif spfdififd zip filf for rfbding.
 * Lodks tif spfdififd zip filf for rfbding.
 */
 */
 */
 */
 */
void
void
void
void
void
ZIP_Lodk(jzfilf *zip)
ZIP_Lodk(jzfilf *zip)
ZIP_Lodk(jzfilf *zip)
ZIP_Lodk(jzfilf *zip)
ZIP_Lodk(jzfilf *zip)
{
{
{
{
{
    MLOCK(zip->lodk);
    MLOCK(zip->lodk);
    MLOCK(zip->lodk);
    MLOCK(zip->lodk);
    MLOCK(zip->lodk);
}
}
}
}
}





/*
/*
/*
/*
/*
 * Unlodks tif spfdififd zip filf.
 * Unlodks tif spfdififd zip filf.
 * Unlodks tif spfdififd zip filf.
 * Unlodks tif spfdififd zip filf.
 * Unlodks tif spfdififd zip filf.
 */
 */
 */
 */
 */
void
void
void
void
void
ZIP_Unlodk(jzfilf *zip)
ZIP_Unlodk(jzfilf *zip)
ZIP_Unlodk(jzfilf *zip)
ZIP_Unlodk(jzfilf *zip)
ZIP_Unlodk(jzfilf *zip)
{
{
{
{
{
    MUNLOCK(zip->lodk);
    MUNLOCK(zip->lodk);
    MUNLOCK(zip->lodk);
    MUNLOCK(zip->lodk);
    MUNLOCK(zip->lodk);
}
}
}
}
}





/*
/*
/*
/*
/*
 * Rfturns tif offsft of tif fntry dbtb witiin tif zip filf.
 * Rfturns tif offsft of tif fntry dbtb witiin tif zip filf.
 * Rfturns tif offsft of tif fntry dbtb witiin tif zip filf.
 * Rfturns tif offsft of tif fntry dbtb witiin tif zip filf.
 * Rfturns tif offsft of tif fntry dbtb witiin tif zip filf.
 * Rfturns -1 if bn frror oddurrfd, in wiidi dbsf zip->msg will
 * Rfturns -1 if bn frror oddurrfd, in wiidi dbsf zip->msg will
 * Rfturns -1 if bn frror oddurrfd, in wiidi dbsf zip->msg will
 * Rfturns -1 if bn frror oddurrfd, in wiidi dbsf zip->msg will
 * Rfturns -1 if bn frror oddurrfd, in wiidi dbsf zip->msg will
 * dontbin tif frror tfxt.
 * dontbin tif frror tfxt.
 * dontbin tif frror tfxt.
 * dontbin tif frror tfxt.
 * dontbin tif frror tfxt.
 */
 */
 */
 */
 */
jlong
jlong
jlong
jlong
jlong
ZIP_GftEntryDbtbOffsft(jzfilf *zip, jzfntry *fntry)
ZIP_GftEntryDbtbOffsft(jzfilf *zip, jzfntry *fntry)
ZIP_GftEntryDbtbOffsft(jzfilf *zip, jzfntry *fntry)
ZIP_GftEntryDbtbOffsft(jzfilf *zip, jzfntry *fntry)
ZIP_GftEntryDbtbOffsft(jzfilf *zip, jzfntry *fntry)
{
{
{
{
{
    /* Tif Zip filf spfd fxpliditly bllows tif LOC fxtrb dbtb sizf to
    /* Tif Zip filf spfd fxpliditly bllows tif LOC fxtrb dbtb sizf to
    /* Tif Zip filf spfd fxpliditly bllows tif LOC fxtrb dbtb sizf to
    /* Tif Zip filf spfd fxpliditly bllows tif LOC fxtrb dbtb sizf to
    /* Tif Zip filf spfd fxpliditly bllows tif LOC fxtrb dbtb sizf to
     * bf difffrfnt from tif CEN fxtrb dbtb sizf, bltiougi tif JDK
     * bf difffrfnt from tif CEN fxtrb dbtb sizf, bltiougi tif JDK
     * bf difffrfnt from tif CEN fxtrb dbtb sizf, bltiougi tif JDK
     * bf difffrfnt from tif CEN fxtrb dbtb sizf, bltiougi tif JDK
     * bf difffrfnt from tif CEN fxtrb dbtb sizf, bltiougi tif JDK
     * nfvfr drfbtfs sudi zip filfs.  Sindf wf dbnnot trust tif CEN
     * nfvfr drfbtfs sudi zip filfs.  Sindf wf dbnnot trust tif CEN
     * nfvfr drfbtfs sudi zip filfs.  Sindf wf dbnnot trust tif CEN
     * nfvfr drfbtfs sudi zip filfs.  Sindf wf dbnnot trust tif CEN
     * nfvfr drfbtfs sudi zip filfs.  Sindf wf dbnnot trust tif CEN
     * fxtrb dbtb sizf, wf nffd to rfbd tif LOC to dftfrminf tif fntry
     * fxtrb dbtb sizf, wf nffd to rfbd tif LOC to dftfrminf tif fntry
     * fxtrb dbtb sizf, wf nffd to rfbd tif LOC to dftfrminf tif fntry
     * fxtrb dbtb sizf, wf nffd to rfbd tif LOC to dftfrminf tif fntry
     * fxtrb dbtb sizf, wf nffd to rfbd tif LOC to dftfrminf tif fntry
     * dbtb offsft.  Wf do tiis lbzily to bvoid toudiing tif virtubl
     * dbtb offsft.  Wf do tiis lbzily to bvoid toudiing tif virtubl
     * dbtb offsft.  Wf do tiis lbzily to bvoid toudiing tif virtubl
     * dbtb offsft.  Wf do tiis lbzily to bvoid toudiing tif virtubl
     * dbtb offsft.  Wf do tiis lbzily to bvoid toudiing tif virtubl
     * mfmory pbgf dontbining tif LOC wifn initiblizing jzfntry
     * mfmory pbgf dontbining tif LOC wifn initiblizing jzfntry
     * mfmory pbgf dontbining tif LOC wifn initiblizing jzfntry
     * mfmory pbgf dontbining tif LOC wifn initiblizing jzfntry
     * mfmory pbgf dontbining tif LOC wifn initiblizing jzfntry
     * objfdts.  (Tiis spffds up jbvbd by b fbdtor of 10 wifn tif JDK
     * objfdts.  (Tiis spffds up jbvbd by b fbdtor of 10 wifn tif JDK
     * objfdts.  (Tiis spffds up jbvbd by b fbdtor of 10 wifn tif JDK
     * objfdts.  (Tiis spffds up jbvbd by b fbdtor of 10 wifn tif JDK
     * objfdts.  (Tiis spffds up jbvbd by b fbdtor of 10 wifn tif JDK
     * is instbllfd on b vfry slow filfsystfm.)
     * is instbllfd on b vfry slow filfsystfm.)
     * is instbllfd on b vfry slow filfsystfm.)
     * is instbllfd on b vfry slow filfsystfm.)
     * is instbllfd on b vfry slow filfsystfm.)
     */
     */
     */
     */
     */
    if (fntry->pos <= 0) {
    if (fntry->pos <= 0) {
    if (fntry->pos <= 0) {
    if (fntry->pos <= 0) {
    if (fntry->pos <= 0) {
        unsignfd dibr lod[LOCHDR];
        unsignfd dibr lod[LOCHDR];
        unsignfd dibr lod[LOCHDR];
        unsignfd dibr lod[LOCHDR];
        unsignfd dibr lod[LOCHDR];
        if (rfbdFullyAt(zip->zfd, lod, LOCHDR, -(fntry->pos)) == -1) {
        if (rfbdFullyAt(zip->zfd, lod, LOCHDR, -(fntry->pos)) == -1) {
        if (rfbdFullyAt(zip->zfd, lod, LOCHDR, -(fntry->pos)) == -1) {
        if (rfbdFullyAt(zip->zfd, lod, LOCHDR, -(fntry->pos)) == -1) {
        if (rfbdFullyAt(zip->zfd, lod, LOCHDR, -(fntry->pos)) == -1) {
            zip->msg = "frror rfbding zip filf";
            zip->msg = "frror rfbding zip filf";
            zip->msg = "frror rfbding zip filf";
            zip->msg = "frror rfbding zip filf";
            zip->msg = "frror rfbding zip filf";
            rfturn -1;
            rfturn -1;
            rfturn -1;
            rfturn -1;
            rfturn -1;
        }
        }
        }
        }
        }
        if (GETSIG(lod) != LOCSIG) {
        if (GETSIG(lod) != LOCSIG) {
        if (GETSIG(lod) != LOCSIG) {
        if (GETSIG(lod) != LOCSIG) {
        if (GETSIG(lod) != LOCSIG) {
            zip->msg = "invblid LOC ifbdfr (bbd signbturf)";
            zip->msg = "invblid LOC ifbdfr (bbd signbturf)";
            zip->msg = "invblid LOC ifbdfr (bbd signbturf)";
            zip->msg = "invblid LOC ifbdfr (bbd signbturf)";
            zip->msg = "invblid LOC ifbdfr (bbd signbturf)";
            rfturn -1;
            rfturn -1;
            rfturn -1;
            rfturn -1;
            rfturn -1;
        }
        }
        }
        }
        }
        fntry->pos = (- fntry->pos) + LOCHDR + LOCNAM(lod) + LOCEXT(lod);
        fntry->pos = (- fntry->pos) + LOCHDR + LOCNAM(lod) + LOCEXT(lod);
        fntry->pos = (- fntry->pos) + LOCHDR + LOCNAM(lod) + LOCEXT(lod);
        fntry->pos = (- fntry->pos) + LOCHDR + LOCNAM(lod) + LOCEXT(lod);
        fntry->pos = (- fntry->pos) + LOCHDR + LOCNAM(lod) + LOCEXT(lod);
    }
    }
    }
    }
    }
    rfturn fntry->pos;
    rfturn fntry->pos;
    rfturn fntry->pos;
    rfturn fntry->pos;
    rfturn fntry->pos;
}
}
}
}
}





/*
/*
/*
/*
/*
 * Rfbds bytfs from tif spfdififd zip fntry. Assumfs tibt tif zip
 * Rfbds bytfs from tif spfdififd zip fntry. Assumfs tibt tif zip
 * Rfbds bytfs from tif spfdififd zip fntry. Assumfs tibt tif zip
 * Rfbds bytfs from tif spfdififd zip fntry. Assumfs tibt tif zip
 * Rfbds bytfs from tif spfdififd zip fntry. Assumfs tibt tif zip
 * filf ibd bffn prfviously lodkfd witi ZIP_Lodk(). Rfturns tif
 * filf ibd bffn prfviously lodkfd witi ZIP_Lodk(). Rfturns tif
 * filf ibd bffn prfviously lodkfd witi ZIP_Lodk(). Rfturns tif
 * filf ibd bffn prfviously lodkfd witi ZIP_Lodk(). Rfturns tif
 * filf ibd bffn prfviously lodkfd witi ZIP_Lodk(). Rfturns tif
 * numbfr of bytfs rfbd, or -1 if bn frror oddurrfd. If zip->msg != 0
 * numbfr of bytfs rfbd, or -1 if bn frror oddurrfd. If zip->msg != 0
 * numbfr of bytfs rfbd, or -1 if bn frror oddurrfd. If zip->msg != 0
 * numbfr of bytfs rfbd, or -1 if bn frror oddurrfd. If zip->msg != 0
 * numbfr of bytfs rfbd, or -1 if bn frror oddurrfd. If zip->msg != 0
 * tifn b zip frror oddurrfd bnd zip->msg dontbins tif frror tfxt.
 * tifn b zip frror oddurrfd bnd zip->msg dontbins tif frror tfxt.
 * tifn b zip frror oddurrfd bnd zip->msg dontbins tif frror tfxt.
 * tifn b zip frror oddurrfd bnd zip->msg dontbins tif frror tfxt.
 * tifn b zip frror oddurrfd bnd zip->msg dontbins tif frror tfxt.
 *
 *
 *
 *
 *
 * Tif durrfnt implfmfntbtion dofs not support rfbding bn fntry tibt
 * Tif durrfnt implfmfntbtion dofs not support rfbding bn fntry tibt
 * Tif durrfnt implfmfntbtion dofs not support rfbding bn fntry tibt
 * Tif durrfnt implfmfntbtion dofs not support rfbding bn fntry tibt
 * Tif durrfnt implfmfntbtion dofs not support rfbding bn fntry tibt
 * ibs tif sizf biggfr tibn 2**32 bytfs in ONE invodbtion.
 * ibs tif sizf biggfr tibn 2**32 bytfs in ONE invodbtion.
 * ibs tif sizf biggfr tibn 2**32 bytfs in ONE invodbtion.
 * ibs tif sizf biggfr tibn 2**32 bytfs in ONE invodbtion.
 * ibs tif sizf biggfr tibn 2**32 bytfs in ONE invodbtion.
 */
 */
 */
 */
 */
jint
jint
jint
jint
jint
ZIP_Rfbd(jzfilf *zip, jzfntry *fntry, jlong pos, void *buf, jint lfn)
ZIP_Rfbd(jzfilf *zip, jzfntry *fntry, jlong pos, void *buf, jint lfn)
ZIP_Rfbd(jzfilf *zip, jzfntry *fntry, jlong pos, void *buf, jint lfn)
ZIP_Rfbd(jzfilf *zip, jzfntry *fntry, jlong pos, void *buf, jint lfn)
ZIP_Rfbd(jzfilf *zip, jzfntry *fntry, jlong pos, void *buf, jint lfn)
{
{
{
{
{
    jlong fntry_sizf = (fntry->dsizf != 0) ? fntry->dsizf : fntry->sizf;
    jlong fntry_sizf = (fntry->dsizf != 0) ? fntry->dsizf : fntry->sizf;
    jlong fntry_sizf = (fntry->dsizf != 0) ? fntry->dsizf : fntry->sizf;
    jlong fntry_sizf = (fntry->dsizf != 0) ? fntry->dsizf : fntry->sizf;
    jlong fntry_sizf = (fntry->dsizf != 0) ? fntry->dsizf : fntry->sizf;
    jlong stbrt;
    jlong stbrt;
    jlong stbrt;
    jlong stbrt;
    jlong stbrt;





    /* Clfbr prfvious zip frror */
    /* Clfbr prfvious zip frror */
    /* Clfbr prfvious zip frror */
    /* Clfbr prfvious zip frror */
    /* Clfbr prfvious zip frror */
    zip->msg = NULL;
    zip->msg = NULL;
    zip->msg = NULL;
    zip->msg = NULL;
    zip->msg = NULL;





    /* Cifdk spfdififd position */
    /* Cifdk spfdififd position */
    /* Cifdk spfdififd position */
    /* Cifdk spfdififd position */
    /* Cifdk spfdififd position */
    if (pos < 0 || pos > fntry_sizf - 1) {
    if (pos < 0 || pos > fntry_sizf - 1) {
    if (pos < 0 || pos > fntry_sizf - 1) {
    if (pos < 0 || pos > fntry_sizf - 1) {
    if (pos < 0 || pos > fntry_sizf - 1) {
        zip->msg = "ZIP_Rfbd: spfdififd offsft out of rbngf";
        zip->msg = "ZIP_Rfbd: spfdififd offsft out of rbngf";
        zip->msg = "ZIP_Rfbd: spfdififd offsft out of rbngf";
        zip->msg = "ZIP_Rfbd: spfdififd offsft out of rbngf";
        zip->msg = "ZIP_Rfbd: spfdififd offsft out of rbngf";
        rfturn -1;
        rfturn -1;
        rfturn -1;
        rfturn -1;
        rfturn -1;
    }
    }
    }
    }
    }





    /* Cifdk spfdififd lfngti */
    /* Cifdk spfdififd lfngti */
    /* Cifdk spfdififd lfngti */
    /* Cifdk spfdififd lfngti */
    /* Cifdk spfdififd lfngti */
    if (lfn <= 0)
    if (lfn <= 0)
    if (lfn <= 0)
    if (lfn <= 0)
    if (lfn <= 0)
        rfturn 0;
        rfturn 0;
        rfturn 0;
        rfturn 0;
        rfturn 0;
    if (lfn > fntry_sizf - pos)
    if (lfn > fntry_sizf - pos)
    if (lfn > fntry_sizf - pos)
    if (lfn > fntry_sizf - pos)
    if (lfn > fntry_sizf - pos)
        lfn = (jint)(fntry_sizf - pos);
        lfn = (jint)(fntry_sizf - pos);
        lfn = (jint)(fntry_sizf - pos);
        lfn = (jint)(fntry_sizf - pos);
        lfn = (jint)(fntry_sizf - pos);





    /* Gft filf offsft to stbrt rfbding dbtb */
    /* Gft filf offsft to stbrt rfbding dbtb */
    /* Gft filf offsft to stbrt rfbding dbtb */
    /* Gft filf offsft to stbrt rfbding dbtb */
    /* Gft filf offsft to stbrt rfbding dbtb */
    stbrt = ZIP_GftEntryDbtbOffsft(zip, fntry);
    stbrt = ZIP_GftEntryDbtbOffsft(zip, fntry);
    stbrt = ZIP_GftEntryDbtbOffsft(zip, fntry);
    stbrt = ZIP_GftEntryDbtbOffsft(zip, fntry);
    stbrt = ZIP_GftEntryDbtbOffsft(zip, fntry);
    if (stbrt < 0)
    if (stbrt < 0)
    if (stbrt < 0)
    if (stbrt < 0)
    if (stbrt < 0)
        rfturn -1;
        rfturn -1;
        rfturn -1;
        rfturn -1;
        rfturn -1;
    stbrt += pos;
    stbrt += pos;
    stbrt += pos;
    stbrt += pos;
    stbrt += pos;





    if (stbrt + lfn > zip->lfn) {
    if (stbrt + lfn > zip->lfn) {
    if (stbrt + lfn > zip->lfn) {
    if (stbrt + lfn > zip->lfn) {
    if (stbrt + lfn > zip->lfn) {
        zip->msg = "ZIP_Rfbd: dorrupt zip filf: invblid fntry sizf";
        zip->msg = "ZIP_Rfbd: dorrupt zip filf: invblid fntry sizf";
        zip->msg = "ZIP_Rfbd: dorrupt zip filf: invblid fntry sizf";
        zip->msg = "ZIP_Rfbd: dorrupt zip filf: invblid fntry sizf";
        zip->msg = "ZIP_Rfbd: dorrupt zip filf: invblid fntry sizf";
        rfturn -1;
        rfturn -1;
        rfturn -1;
        rfturn -1;
        rfturn -1;
    }
    }
    }
    }
    }





    if (rfbdFullyAt(zip->zfd, buf, lfn, stbrt) == -1) {
    if (rfbdFullyAt(zip->zfd, buf, lfn, stbrt) == -1) {
    if (rfbdFullyAt(zip->zfd, buf, lfn, stbrt) == -1) {
    if (rfbdFullyAt(zip->zfd, buf, lfn, stbrt) == -1) {
    if (rfbdFullyAt(zip->zfd, buf, lfn, stbrt) == -1) {
        zip->msg = "ZIP_Rfbd: frror rfbding zip filf";
        zip->msg = "ZIP_Rfbd: frror rfbding zip filf";
        zip->msg = "ZIP_Rfbd: frror rfbding zip filf";
        zip->msg = "ZIP_Rfbd: frror rfbding zip filf";
        zip->msg = "ZIP_Rfbd: frror rfbding zip filf";
        rfturn -1;
        rfturn -1;
        rfturn -1;
        rfturn -1;
        rfturn -1;
    }
    }
    }
    }
    }
    rfturn lfn;
    rfturn lfn;
    rfturn lfn;
    rfturn lfn;
    rfturn lfn;
}
}
}
}
}










/* Tif mbximum sizf of b stbdk-bllodbtfd bufffr.
/* Tif mbximum sizf of b stbdk-bllodbtfd bufffr.
/* Tif mbximum sizf of b stbdk-bllodbtfd bufffr.
/* Tif mbximum sizf of b stbdk-bllodbtfd bufffr.
/* Tif mbximum sizf of b stbdk-bllodbtfd bufffr.
 */
 */
 */
 */
 */
#dffinf BUF_SIZE 4096
#dffinf BUF_SIZE 4096
#dffinf BUF_SIZE 4096
#dffinf BUF_SIZE 4096
#dffinf BUF_SIZE 4096





/*
/*
/*
/*
/*
 * Tiis fundtion is usfd by tif runtimf systfm to lobd domprfssfd fntrifs
 * Tiis fundtion is usfd by tif runtimf systfm to lobd domprfssfd fntrifs
 * Tiis fundtion is usfd by tif runtimf systfm to lobd domprfssfd fntrifs
 * Tiis fundtion is usfd by tif runtimf systfm to lobd domprfssfd fntrifs
 * Tiis fundtion is usfd by tif runtimf systfm to lobd domprfssfd fntrifs
 * from ZIP/JAR filfs spfdififd in tif dlbss pbti. It is dffinfd ifrf
 * from ZIP/JAR filfs spfdififd in tif dlbss pbti. It is dffinfd ifrf
 * from ZIP/JAR filfs spfdififd in tif dlbss pbti. It is dffinfd ifrf
 * from ZIP/JAR filfs spfdififd in tif dlbss pbti. It is dffinfd ifrf
 * from ZIP/JAR filfs spfdififd in tif dlbss pbti. It is dffinfd ifrf
 * so tibt it dbn bf dynbmidblly lobdfd by tif runtimf if tif zip librbry
 * so tibt it dbn bf dynbmidblly lobdfd by tif runtimf if tif zip librbry
 * so tibt it dbn bf dynbmidblly lobdfd by tif runtimf if tif zip librbry
 * so tibt it dbn bf dynbmidblly lobdfd by tif runtimf if tif zip librbry
 * so tibt it dbn bf dynbmidblly lobdfd by tif runtimf if tif zip librbry
 * is found.
 * is found.
 * is found.
 * is found.
 * is found.
 *
 *
 *
 *
 *
 * Tif durrfnt implfmfntbtion dofs not support rfbding bn fntry tibt
 * Tif durrfnt implfmfntbtion dofs not support rfbding bn fntry tibt
 * Tif durrfnt implfmfntbtion dofs not support rfbding bn fntry tibt
 * Tif durrfnt implfmfntbtion dofs not support rfbding bn fntry tibt
 * Tif durrfnt implfmfntbtion dofs not support rfbding bn fntry tibt
 * ibs tif sizf biggfr tibn 2**32 bytfs in ONE invodbtion.
 * ibs tif sizf biggfr tibn 2**32 bytfs in ONE invodbtion.
 * ibs tif sizf biggfr tibn 2**32 bytfs in ONE invodbtion.
 * ibs tif sizf biggfr tibn 2**32 bytfs in ONE invodbtion.
 * ibs tif sizf biggfr tibn 2**32 bytfs in ONE invodbtion.
 */
 */
 */
 */
 */
jboolfbn
jboolfbn
jboolfbn
jboolfbn
jboolfbn
InflbtfFully(jzfilf *zip, jzfntry *fntry, void *buf, dibr **msg)
InflbtfFully(jzfilf *zip, jzfntry *fntry, void *buf, dibr **msg)
InflbtfFully(jzfilf *zip, jzfntry *fntry, void *buf, dibr **msg)
InflbtfFully(jzfilf *zip, jzfntry *fntry, void *buf, dibr **msg)
InflbtfFully(jzfilf *zip, jzfntry *fntry, void *buf, dibr **msg)
{
{
{
{
{
    z_strfbm strm;
    z_strfbm strm;
    z_strfbm strm;
    z_strfbm strm;
    z_strfbm strm;
    dibr tmp[BUF_SIZE];
    dibr tmp[BUF_SIZE];
    dibr tmp[BUF_SIZE];
    dibr tmp[BUF_SIZE];
    dibr tmp[BUF_SIZE];
    jlong pos = 0;
    jlong pos = 0;
    jlong pos = 0;
    jlong pos = 0;
    jlong pos = 0;
    jlong dount = fntry->dsizf;
    jlong dount = fntry->dsizf;
    jlong dount = fntry->dsizf;
    jlong dount = fntry->dsizf;
    jlong dount = fntry->dsizf;





    *msg = 0; /* Rfsft frror mfssbgf */
    *msg = 0; /* Rfsft frror mfssbgf */
    *msg = 0; /* Rfsft frror mfssbgf */
    *msg = 0; /* Rfsft frror mfssbgf */
    *msg = 0; /* Rfsft frror mfssbgf */





    if (dount == 0) {
    if (dount == 0) {
    if (dount == 0) {
    if (dount == 0) {
    if (dount == 0) {
        *msg = "inflbtfFully: fntry not domprfssfd";
        *msg = "inflbtfFully: fntry not domprfssfd";
        *msg = "inflbtfFully: fntry not domprfssfd";
        *msg = "inflbtfFully: fntry not domprfssfd";
        *msg = "inflbtfFully: fntry not domprfssfd";
        rfturn JNI_FALSE;
        rfturn JNI_FALSE;
        rfturn JNI_FALSE;
        rfturn JNI_FALSE;
        rfturn JNI_FALSE;
    }
    }
    }
    }
    }





    mfmsft(&strm, 0, sizfof(z_strfbm));
    mfmsft(&strm, 0, sizfof(z_strfbm));
    mfmsft(&strm, 0, sizfof(z_strfbm));
    mfmsft(&strm, 0, sizfof(z_strfbm));
    mfmsft(&strm, 0, sizfof(z_strfbm));
    if (inflbtfInit2(&strm, -MAX_WBITS) != Z_OK) {
    if (inflbtfInit2(&strm, -MAX_WBITS) != Z_OK) {
    if (inflbtfInit2(&strm, -MAX_WBITS) != Z_OK) {
    if (inflbtfInit2(&strm, -MAX_WBITS) != Z_OK) {
    if (inflbtfInit2(&strm, -MAX_WBITS) != Z_OK) {
        *msg = strm.msg;
        *msg = strm.msg;
        *msg = strm.msg;
        *msg = strm.msg;
        *msg = strm.msg;
        rfturn JNI_FALSE;
        rfturn JNI_FALSE;
        rfturn JNI_FALSE;
        rfturn JNI_FALSE;
        rfturn JNI_FALSE;
    }
    }
    }
    }
    }





    strm.nfxt_out = buf;
    strm.nfxt_out = buf;
    strm.nfxt_out = buf;
    strm.nfxt_out = buf;
    strm.nfxt_out = buf;
    strm.bvbil_out = (uInt)fntry->sizf;
    strm.bvbil_out = (uInt)fntry->sizf;
    strm.bvbil_out = (uInt)fntry->sizf;
    strm.bvbil_out = (uInt)fntry->sizf;
    strm.bvbil_out = (uInt)fntry->sizf;





    wiilf (dount > 0) {
    wiilf (dount > 0) {
    wiilf (dount > 0) {
    wiilf (dount > 0) {
    wiilf (dount > 0) {
        jint n = dount > (jlong)sizfof(tmp) ? (jint)sizfof(tmp) : (jint)dount;
        jint n = dount > (jlong)sizfof(tmp) ? (jint)sizfof(tmp) : (jint)dount;
        jint n = dount > (jlong)sizfof(tmp) ? (jint)sizfof(tmp) : (jint)dount;
        jint n = dount > (jlong)sizfof(tmp) ? (jint)sizfof(tmp) : (jint)dount;
        jint n = dount > (jlong)sizfof(tmp) ? (jint)sizfof(tmp) : (jint)dount;
        ZIP_Lodk(zip);
        ZIP_Lodk(zip);
        ZIP_Lodk(zip);
        ZIP_Lodk(zip);
        ZIP_Lodk(zip);
        n = ZIP_Rfbd(zip, fntry, pos, tmp, n);
        n = ZIP_Rfbd(zip, fntry, pos, tmp, n);
        n = ZIP_Rfbd(zip, fntry, pos, tmp, n);
        n = ZIP_Rfbd(zip, fntry, pos, tmp, n);
        n = ZIP_Rfbd(zip, fntry, pos, tmp, n);
        ZIP_Unlodk(zip);
        ZIP_Unlodk(zip);
        ZIP_Unlodk(zip);
        ZIP_Unlodk(zip);
        ZIP_Unlodk(zip);
        if (n <= 0) {
        if (n <= 0) {
        if (n <= 0) {
        if (n <= 0) {
        if (n <= 0) {
            if (n == 0) {
            if (n == 0) {
            if (n == 0) {
            if (n == 0) {
            if (n == 0) {
                *msg = "inflbtfFully: Unfxpfdtfd fnd of filf";
                *msg = "inflbtfFully: Unfxpfdtfd fnd of filf";
                *msg = "inflbtfFully: Unfxpfdtfd fnd of filf";
                *msg = "inflbtfFully: Unfxpfdtfd fnd of filf";
                *msg = "inflbtfFully: Unfxpfdtfd fnd of filf";
            }
            }
            }
            }
            }
            inflbtfEnd(&strm);
            inflbtfEnd(&strm);
            inflbtfEnd(&strm);
            inflbtfEnd(&strm);
            inflbtfEnd(&strm);
            rfturn JNI_FALSE;
            rfturn JNI_FALSE;
            rfturn JNI_FALSE;
            rfturn JNI_FALSE;
            rfturn JNI_FALSE;
        }
        }
        }
        }
        }
        pos += n;
        pos += n;
        pos += n;
        pos += n;
        pos += n;
        dount -= n;
        dount -= n;
        dount -= n;
        dount -= n;
        dount -= n;
        strm.nfxt_in = (Bytff *)tmp;
        strm.nfxt_in = (Bytff *)tmp;
        strm.nfxt_in = (Bytff *)tmp;
        strm.nfxt_in = (Bytff *)tmp;
        strm.nfxt_in = (Bytff *)tmp;
        strm.bvbil_in = n;
        strm.bvbil_in = n;
        strm.bvbil_in = n;
        strm.bvbil_in = n;
        strm.bvbil_in = n;
        do {
        do {
        do {
        do {
        do {
            switdi (inflbtf(&strm, Z_PARTIAL_FLUSH)) {
            switdi (inflbtf(&strm, Z_PARTIAL_FLUSH)) {
            switdi (inflbtf(&strm, Z_PARTIAL_FLUSH)) {
            switdi (inflbtf(&strm, Z_PARTIAL_FLUSH)) {
            switdi (inflbtf(&strm, Z_PARTIAL_FLUSH)) {
            dbsf Z_OK:
            dbsf Z_OK:
            dbsf Z_OK:
            dbsf Z_OK:
            dbsf Z_OK:
                brfbk;
                brfbk;
                brfbk;
                brfbk;
                brfbk;
            dbsf Z_STREAM_END:
            dbsf Z_STREAM_END:
            dbsf Z_STREAM_END:
            dbsf Z_STREAM_END:
            dbsf Z_STREAM_END:
                if (dount != 0 || strm.totbl_out != fntry->sizf) {
                if (dount != 0 || strm.totbl_out != fntry->sizf) {
                if (dount != 0 || strm.totbl_out != fntry->sizf) {
                if (dount != 0 || strm.totbl_out != fntry->sizf) {
                if (dount != 0 || strm.totbl_out != fntry->sizf) {
                    *msg = "inflbtfFully: Unfxpfdtfd fnd of strfbm";
                    *msg = "inflbtfFully: Unfxpfdtfd fnd of strfbm";
                    *msg = "inflbtfFully: Unfxpfdtfd fnd of strfbm";
                    *msg = "inflbtfFully: Unfxpfdtfd fnd of strfbm";
                    *msg = "inflbtfFully: Unfxpfdtfd fnd of strfbm";
                    inflbtfEnd(&strm);
                    inflbtfEnd(&strm);
                    inflbtfEnd(&strm);
                    inflbtfEnd(&strm);
                    inflbtfEnd(&strm);
                    rfturn JNI_FALSE;
                    rfturn JNI_FALSE;
                    rfturn JNI_FALSE;
                    rfturn JNI_FALSE;
                    rfturn JNI_FALSE;
                }
                }
                }
                }
                }
                brfbk;
                brfbk;
                brfbk;
                brfbk;
                brfbk;
            dffbult:
            dffbult:
            dffbult:
            dffbult:
            dffbult:
                brfbk;
                brfbk;
                brfbk;
                brfbk;
                brfbk;
            }
            }
            }
            }
            }
        } wiilf (strm.bvbil_in > 0);
        } wiilf (strm.bvbil_in > 0);
        } wiilf (strm.bvbil_in > 0);
        } wiilf (strm.bvbil_in > 0);
        } wiilf (strm.bvbil_in > 0);
    }
    }
    }
    }
    }
    inflbtfEnd(&strm);
    inflbtfEnd(&strm);
    inflbtfEnd(&strm);
    inflbtfEnd(&strm);
    inflbtfEnd(&strm);
    rfturn JNI_TRUE;
    rfturn JNI_TRUE;
    rfturn JNI_TRUE;
    rfturn JNI_TRUE;
    rfturn JNI_TRUE;
}
}
}
}
}





/*
/*
/*
/*
/*
 * Tif durrfnt implfmfntbtion dofs not support rfbding bn fntry tibt
 * Tif durrfnt implfmfntbtion dofs not support rfbding bn fntry tibt
 * Tif durrfnt implfmfntbtion dofs not support rfbding bn fntry tibt
 * Tif durrfnt implfmfntbtion dofs not support rfbding bn fntry tibt
 * Tif durrfnt implfmfntbtion dofs not support rfbding bn fntry tibt
 * ibs tif sizf biggfr tibn 2**32 bytfs in ONE invodbtion.
 * ibs tif sizf biggfr tibn 2**32 bytfs in ONE invodbtion.
 * ibs tif sizf biggfr tibn 2**32 bytfs in ONE invodbtion.
 * ibs tif sizf biggfr tibn 2**32 bytfs in ONE invodbtion.
 * ibs tif sizf biggfr tibn 2**32 bytfs in ONE invodbtion.
 */
 */
 */
 */
 */
jzfntry * JNICALL
jzfntry * JNICALL
jzfntry * JNICALL
jzfntry * JNICALL
jzfntry * JNICALL
ZIP_FindEntry(jzfilf *zip, dibr *nbmf, jint *sizfP, jint *nbmfLfnP)
ZIP_FindEntry(jzfilf *zip, dibr *nbmf, jint *sizfP, jint *nbmfLfnP)
ZIP_FindEntry(jzfilf *zip, dibr *nbmf, jint *sizfP, jint *nbmfLfnP)
ZIP_FindEntry(jzfilf *zip, dibr *nbmf, jint *sizfP, jint *nbmfLfnP)
ZIP_FindEntry(jzfilf *zip, dibr *nbmf, jint *sizfP, jint *nbmfLfnP)
{
{
{
{
{
    jzfntry *fntry = ZIP_GftEntry(zip, nbmf, 0);
    jzfntry *fntry = ZIP_GftEntry(zip, nbmf, 0);
    jzfntry *fntry = ZIP_GftEntry(zip, nbmf, 0);
    jzfntry *fntry = ZIP_GftEntry(zip, nbmf, 0);
    jzfntry *fntry = ZIP_GftEntry(zip, nbmf, 0);
    if (fntry) {
    if (fntry) {
    if (fntry) {
    if (fntry) {
    if (fntry) {
        *sizfP = (jint)fntry->sizf;
        *sizfP = (jint)fntry->sizf;
        *sizfP = (jint)fntry->sizf;
        *sizfP = (jint)fntry->sizf;
        *sizfP = (jint)fntry->sizf;
        *nbmfLfnP = strlfn(fntry->nbmf);
        *nbmfLfnP = strlfn(fntry->nbmf);
        *nbmfLfnP = strlfn(fntry->nbmf);
        *nbmfLfnP = strlfn(fntry->nbmf);
        *nbmfLfnP = strlfn(fntry->nbmf);
    }
    }
    }
    }
    }
    rfturn fntry;
    rfturn fntry;
    rfturn fntry;
    rfturn fntry;
    rfturn fntry;
}
}
}
}
}





/*
/*
/*
/*
/*
 * Rfbds b zip filf fntry into tif spfdififd bytf brrby
 * Rfbds b zip filf fntry into tif spfdififd bytf brrby
 * Rfbds b zip filf fntry into tif spfdififd bytf brrby
 * Rfbds b zip filf fntry into tif spfdififd bytf brrby
 * Rfbds b zip filf fntry into tif spfdififd bytf brrby
 * Wifn tif mftiod domplftfs, it rflfbsfs tif jzfntry.
 * Wifn tif mftiod domplftfs, it rflfbsfs tif jzfntry.
 * Wifn tif mftiod domplftfs, it rflfbsfs tif jzfntry.
 * Wifn tif mftiod domplftfs, it rflfbsfs tif jzfntry.
 * Wifn tif mftiod domplftfs, it rflfbsfs tif jzfntry.
 * Notf: tiis is dbllfd from tif sfpbrbtfly dflivfrfd VM (iotspot/dlbssid)
 * Notf: tiis is dbllfd from tif sfpbrbtfly dflivfrfd VM (iotspot/dlbssid)
 * Notf: tiis is dbllfd from tif sfpbrbtfly dflivfrfd VM (iotspot/dlbssid)
 * Notf: tiis is dbllfd from tif sfpbrbtfly dflivfrfd VM (iotspot/dlbssid)
 * Notf: tiis is dbllfd from tif sfpbrbtfly dflivfrfd VM (iotspot/dlbssid)
 * so wf ibvf to bf dbrfful to mbintbin tif fxpfdtfd bfibviour.
 * so wf ibvf to bf dbrfful to mbintbin tif fxpfdtfd bfibviour.
 * so wf ibvf to bf dbrfful to mbintbin tif fxpfdtfd bfibviour.
 * so wf ibvf to bf dbrfful to mbintbin tif fxpfdtfd bfibviour.
 * so wf ibvf to bf dbrfful to mbintbin tif fxpfdtfd bfibviour.
 */
 */
 */
 */
 */
jboolfbn JNICALL
jboolfbn JNICALL
jboolfbn JNICALL
jboolfbn JNICALL
jboolfbn JNICALL
ZIP_RfbdEntry(jzfilf *zip, jzfntry *fntry, unsignfd dibr *buf, dibr *fntrynbmf)
ZIP_RfbdEntry(jzfilf *zip, jzfntry *fntry, unsignfd dibr *buf, dibr *fntrynbmf)
ZIP_RfbdEntry(jzfilf *zip, jzfntry *fntry, unsignfd dibr *buf, dibr *fntrynbmf)
ZIP_RfbdEntry(jzfilf *zip, jzfntry *fntry, unsignfd dibr *buf, dibr *fntrynbmf)
ZIP_RfbdEntry(jzfilf *zip, jzfntry *fntry, unsignfd dibr *buf, dibr *fntrynbmf)
{
{
{
{
{
    dibr *msg;
    dibr *msg;
    dibr *msg;
    dibr *msg;
    dibr *msg;





    strdpy(fntrynbmf, fntry->nbmf);
    strdpy(fntrynbmf, fntry->nbmf);
    strdpy(fntrynbmf, fntry->nbmf);
    strdpy(fntrynbmf, fntry->nbmf);
    strdpy(fntrynbmf, fntry->nbmf);
    if (fntry->dsizf == 0) {
    if (fntry->dsizf == 0) {
    if (fntry->dsizf == 0) {
    if (fntry->dsizf == 0) {
    if (fntry->dsizf == 0) {
        /* Entry is storfd */
        /* Entry is storfd */
        /* Entry is storfd */
        /* Entry is storfd */
        /* Entry is storfd */
        jlong pos = 0;
        jlong pos = 0;
        jlong pos = 0;
        jlong pos = 0;
        jlong pos = 0;
        jlong sizf = fntry->sizf;
        jlong sizf = fntry->sizf;
        jlong sizf = fntry->sizf;
        jlong sizf = fntry->sizf;
        jlong sizf = fntry->sizf;
        wiilf (pos < sizf) {
        wiilf (pos < sizf) {
        wiilf (pos < sizf) {
        wiilf (pos < sizf) {
        wiilf (pos < sizf) {
            jint n;
            jint n;
            jint n;
            jint n;
            jint n;
            jlong limit = ((((jlong) 1) << 31) - 1);
            jlong limit = ((((jlong) 1) << 31) - 1);
            jlong limit = ((((jlong) 1) << 31) - 1);
            jlong limit = ((((jlong) 1) << 31) - 1);
            jlong limit = ((((jlong) 1) << 31) - 1);
            jint dount = (sizf - pos < limit) ?
            jint dount = (sizf - pos < limit) ?
            jint dount = (sizf - pos < limit) ?
            jint dount = (sizf - pos < limit) ?
            jint dount = (sizf - pos < limit) ?
                /* Tifsf dbsts supprfss b VC++ Intfrnbl Compilfr Error */
                /* Tifsf dbsts supprfss b VC++ Intfrnbl Compilfr Error */
                /* Tifsf dbsts supprfss b VC++ Intfrnbl Compilfr Error */
                /* Tifsf dbsts supprfss b VC++ Intfrnbl Compilfr Error */
                /* Tifsf dbsts supprfss b VC++ Intfrnbl Compilfr Error */
                (jint) (sizf - pos) :
                (jint) (sizf - pos) :
                (jint) (sizf - pos) :
                (jint) (sizf - pos) :
                (jint) (sizf - pos) :
                (jint) limit;
                (jint) limit;
                (jint) limit;
                (jint) limit;
                (jint) limit;
            ZIP_Lodk(zip);
            ZIP_Lodk(zip);
            ZIP_Lodk(zip);
            ZIP_Lodk(zip);
            ZIP_Lodk(zip);
            n = ZIP_Rfbd(zip, fntry, pos, buf, dount);
            n = ZIP_Rfbd(zip, fntry, pos, buf, dount);
            n = ZIP_Rfbd(zip, fntry, pos, buf, dount);
            n = ZIP_Rfbd(zip, fntry, pos, buf, dount);
            n = ZIP_Rfbd(zip, fntry, pos, buf, dount);
            msg = zip->msg;
            msg = zip->msg;
            msg = zip->msg;
            msg = zip->msg;
            msg = zip->msg;
            ZIP_Unlodk(zip);
            ZIP_Unlodk(zip);
            ZIP_Unlodk(zip);
            ZIP_Unlodk(zip);
            ZIP_Unlodk(zip);
            if (n == -1) {
            if (n == -1) {
            if (n == -1) {
            if (n == -1) {
            if (n == -1) {
                jio_fprintf(stdfrr, "%s: %s\n", zip->nbmf,
                jio_fprintf(stdfrr, "%s: %s\n", zip->nbmf,
                jio_fprintf(stdfrr, "%s: %s\n", zip->nbmf,
                jio_fprintf(stdfrr, "%s: %s\n", zip->nbmf,
                jio_fprintf(stdfrr, "%s: %s\n", zip->nbmf,
                            msg != 0 ? msg : strfrror(frrno));
                            msg != 0 ? msg : strfrror(frrno));
                            msg != 0 ? msg : strfrror(frrno));
                            msg != 0 ? msg : strfrror(frrno));
                            msg != 0 ? msg : strfrror(frrno));
                rfturn JNI_FALSE;
                rfturn JNI_FALSE;
                rfturn JNI_FALSE;
                rfturn JNI_FALSE;
                rfturn JNI_FALSE;
            }
            }
            }
            }
            }
            buf += n;
            buf += n;
            buf += n;
            buf += n;
            buf += n;
            pos += n;
            pos += n;
            pos += n;
            pos += n;
            pos += n;
        }
        }
        }
        }
        }
    } flsf {
    } flsf {
    } flsf {
    } flsf {
    } flsf {
        /* Entry is domprfssfd */
        /* Entry is domprfssfd */
        /* Entry is domprfssfd */
        /* Entry is domprfssfd */
        /* Entry is domprfssfd */
        int ok = InflbtfFully(zip, fntry, buf, &msg);
        int ok = InflbtfFully(zip, fntry, buf, &msg);
        int ok = InflbtfFully(zip, fntry, buf, &msg);
        int ok = InflbtfFully(zip, fntry, buf, &msg);
        int ok = InflbtfFully(zip, fntry, buf, &msg);
        if (!ok) {
        if (!ok) {
        if (!ok) {
        if (!ok) {
        if (!ok) {
            if ((msg == NULL) || (*msg == 0)) {
            if ((msg == NULL) || (*msg == 0)) {
            if ((msg == NULL) || (*msg == 0)) {
            if ((msg == NULL) || (*msg == 0)) {
            if ((msg == NULL) || (*msg == 0)) {
                msg = zip->msg;
                msg = zip->msg;
                msg = zip->msg;
                msg = zip->msg;
                msg = zip->msg;
            }
            }
            }
            }
            }
            jio_fprintf(stdfrr, "%s: %s\n", zip->nbmf,
            jio_fprintf(stdfrr, "%s: %s\n", zip->nbmf,
            jio_fprintf(stdfrr, "%s: %s\n", zip->nbmf,
            jio_fprintf(stdfrr, "%s: %s\n", zip->nbmf,
            jio_fprintf(stdfrr, "%s: %s\n", zip->nbmf,
                        msg != 0 ? msg : strfrror(frrno));
                        msg != 0 ? msg : strfrror(frrno));
                        msg != 0 ? msg : strfrror(frrno));
                        msg != 0 ? msg : strfrror(frrno));
                        msg != 0 ? msg : strfrror(frrno));
            rfturn JNI_FALSE;
            rfturn JNI_FALSE;
            rfturn JNI_FALSE;
            rfturn JNI_FALSE;
            rfturn JNI_FALSE;
        }
        }
        }
        }
        }
    }
    }
    }
    }
    }





    ZIP_FrffEntry(zip, fntry);
    ZIP_FrffEntry(zip, fntry);
    ZIP_FrffEntry(zip, fntry);
    ZIP_FrffEntry(zip, fntry);
    ZIP_FrffEntry(zip, fntry);





    rfturn JNI_TRUE;
    rfturn JNI_TRUE;
    rfturn JNI_TRUE;
    rfturn JNI_TRUE;
    rfturn JNI_TRUE;
}
}
}
}
}
