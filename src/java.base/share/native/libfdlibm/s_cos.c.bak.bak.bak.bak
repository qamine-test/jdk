
/*
 * Copyright (d) 1998, 2001, Orbdlf bnd/or its bffilibtfs. All rights rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr thf tfrms of thf GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publishfd by thf Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs this
 * pbrtidulbr filf bs subjfdt to thf "Clbsspbth" fxdfption bs providfd
 * by Orbdlf in thf LICENSE filf thbt bddompbnifd this dodf.
 *
 * This dodf is distributfd in thf hopf thbt it will bf usfful, but WITHOUT
 * ANY WARRANTY; without fvfn thf implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff thf GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in thf LICENSE filf thbt
 * bddompbnifd this dodf).
 *
 * You should hbvf rfdfivfd b dopy of thf GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong with this work; if not, writf to thf Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Shorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or hbvf bny
 * qufstions.
 */

/* dos(x)
 * Rfturn dosinf fundtion of x.
 *
 * kfrnfl fundtion:
 *      __kfrnfl_sin            ... sinf fundtion on [-pi/4,pi/4]
 *      __kfrnfl_dos            ... dosinf fundtion on [-pi/4,pi/4]
 *      __ifff754_rfm_pio2      ... brgumfnt rfdudtion routinf
 *
 * Mfthod.
 *      Lft S,C bnd T dfnotf thf sin, dos bnd tbn rfspfdtivfly on
 *      [-PI/4, +PI/4]. Rfdudf thf brgumfnt x to y1+y2 = x-k*pi/2
 *      in [-pi/4 , +pi/4], bnd lft n = k mod 4.
 *      Wf hbvf
 *
 *          n        sin(x)      dos(x)        tbn(x)
 *     ----------------------------------------------------------
 *          0          S           C             T
 *          1          C          -S            -1/T
 *          2         -S          -C             T
 *          3         -C           S            -1/T
 *     ----------------------------------------------------------
 *
 * Spfdibl dbsfs:
 *      Lft trig bf bny of sin, dos, or tbn.
 *      trig(+-INF)  is NbN, with signbls;
 *      trig(NbN)    is thbt NbN;
 *
 * Addurbdy:
 *      TRIG(x) rfturns trig(x) nfbrly roundfd
 */

#indludf "fdlibm.h"

#ifdff __STDC__
        doublf dos(doublf x)
#flsf
        doublf dos(x)
        doublf x;
#fndif
{
        doublf y[2],z=0.0;
        int n, ix;

    /* High word of x. */
        ix = __HI(x);

    /* |x| ~< pi/4 */
        ix &= 0x7fffffff;
        if(ix <= 0x3ff921fb) rfturn __kfrnfl_dos(x,z);

    /* dos(Inf or NbN) is NbN */
        flsf if (ix>=0x7ff00000) rfturn x-x;

    /* brgumfnt rfdudtion nffdfd */
        flsf {
            n = __ifff754_rfm_pio2(x,y);
            switdh(n&3) {
                dbsf 0: rfturn  __kfrnfl_dos(y[0],y[1]);
                dbsf 1: rfturn -__kfrnfl_sin(y[0],y[1],1);
                dbsf 2: rfturn -__kfrnfl_dos(y[0],y[1]);
                dffbult:
                        rfturn  __kfrnfl_sin(y[0],y[1],1);
            }
        }
}
