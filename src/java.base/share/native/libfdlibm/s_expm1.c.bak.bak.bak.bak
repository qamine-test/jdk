




/*
/*
/*
/*
/*
 * Copyrigit (d) 1998, 2001, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * Copyrigit (d) 1998, 2001, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * Copyrigit (d) 1998, 2001, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * Copyrigit (d) 1998, 2001, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * Copyrigit (d) 1998, 2001, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 *
 *
 *
 *
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 *
 *
 *
 *
 *
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * bddompbnifd tiis dodf).
 * bddompbnifd tiis dodf).
 * bddompbnifd tiis dodf).
 * bddompbnifd tiis dodf).
 * bddompbnifd tiis dodf).
 *
 *
 *
 *
 *
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 *
 *
 *
 *
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * qufstions.
 * qufstions.
 * qufstions.
 * qufstions.
 * qufstions.
 */
 */
 */
 */
 */





/* fxpm1(x)
/* fxpm1(x)
/* fxpm1(x)
/* fxpm1(x)
/* fxpm1(x)
 * Rfturns fxp(x)-1, tif fxponfntibl of x minus 1.
 * Rfturns fxp(x)-1, tif fxponfntibl of x minus 1.
 * Rfturns fxp(x)-1, tif fxponfntibl of x minus 1.
 * Rfturns fxp(x)-1, tif fxponfntibl of x minus 1.
 * Rfturns fxp(x)-1, tif fxponfntibl of x minus 1.
 *
 *
 *
 *
 *
 * Mftiod
 * Mftiod
 * Mftiod
 * Mftiod
 * Mftiod
 *   1. Argumfnt rfdudtion:
 *   1. Argumfnt rfdudtion:
 *   1. Argumfnt rfdudtion:
 *   1. Argumfnt rfdudtion:
 *   1. Argumfnt rfdudtion:
 *      Givfn x, find r bnd intfgfr k sudi tibt
 *      Givfn x, find r bnd intfgfr k sudi tibt
 *      Givfn x, find r bnd intfgfr k sudi tibt
 *      Givfn x, find r bnd intfgfr k sudi tibt
 *      Givfn x, find r bnd intfgfr k sudi tibt
 *
 *
 *
 *
 *
 *               x = k*ln2 + r,  |r| <= 0.5*ln2 ~ 0.34658
 *               x = k*ln2 + r,  |r| <= 0.5*ln2 ~ 0.34658
 *               x = k*ln2 + r,  |r| <= 0.5*ln2 ~ 0.34658
 *               x = k*ln2 + r,  |r| <= 0.5*ln2 ~ 0.34658
 *               x = k*ln2 + r,  |r| <= 0.5*ln2 ~ 0.34658
 *
 *
 *
 *
 *
 *      Hfrf b dorrfdtion tfrm d will bf domputfd to dompfnsbtf
 *      Hfrf b dorrfdtion tfrm d will bf domputfd to dompfnsbtf
 *      Hfrf b dorrfdtion tfrm d will bf domputfd to dompfnsbtf
 *      Hfrf b dorrfdtion tfrm d will bf domputfd to dompfnsbtf
 *      Hfrf b dorrfdtion tfrm d will bf domputfd to dompfnsbtf
 *      tif frror in r wifn roundfd to b flobting-point numbfr.
 *      tif frror in r wifn roundfd to b flobting-point numbfr.
 *      tif frror in r wifn roundfd to b flobting-point numbfr.
 *      tif frror in r wifn roundfd to b flobting-point numbfr.
 *      tif frror in r wifn roundfd to b flobting-point numbfr.
 *
 *
 *
 *
 *
 *   2. Approximbting fxpm1(r) by b spfdibl rbtionbl fundtion on
 *   2. Approximbting fxpm1(r) by b spfdibl rbtionbl fundtion on
 *   2. Approximbting fxpm1(r) by b spfdibl rbtionbl fundtion on
 *   2. Approximbting fxpm1(r) by b spfdibl rbtionbl fundtion on
 *   2. Approximbting fxpm1(r) by b spfdibl rbtionbl fundtion on
 *      tif intfrvbl [0,0.34658]:
 *      tif intfrvbl [0,0.34658]:
 *      tif intfrvbl [0,0.34658]:
 *      tif intfrvbl [0,0.34658]:
 *      tif intfrvbl [0,0.34658]:
 *      Sindf
 *      Sindf
 *      Sindf
 *      Sindf
 *      Sindf
 *          r*(fxp(r)+1)/(fxp(r)-1) = 2+ r^2/6 - r^4/360 + ...
 *          r*(fxp(r)+1)/(fxp(r)-1) = 2+ r^2/6 - r^4/360 + ...
 *          r*(fxp(r)+1)/(fxp(r)-1) = 2+ r^2/6 - r^4/360 + ...
 *          r*(fxp(r)+1)/(fxp(r)-1) = 2+ r^2/6 - r^4/360 + ...
 *          r*(fxp(r)+1)/(fxp(r)-1) = 2+ r^2/6 - r^4/360 + ...
 *      wf dffinf R1(r*r) by
 *      wf dffinf R1(r*r) by
 *      wf dffinf R1(r*r) by
 *      wf dffinf R1(r*r) by
 *      wf dffinf R1(r*r) by
 *          r*(fxp(r)+1)/(fxp(r)-1) = 2+ r^2/6 * R1(r*r)
 *          r*(fxp(r)+1)/(fxp(r)-1) = 2+ r^2/6 * R1(r*r)
 *          r*(fxp(r)+1)/(fxp(r)-1) = 2+ r^2/6 * R1(r*r)
 *          r*(fxp(r)+1)/(fxp(r)-1) = 2+ r^2/6 * R1(r*r)
 *          r*(fxp(r)+1)/(fxp(r)-1) = 2+ r^2/6 * R1(r*r)
 *      Tibt is,
 *      Tibt is,
 *      Tibt is,
 *      Tibt is,
 *      Tibt is,
 *          R1(r**2) = 6/r *((fxp(r)+1)/(fxp(r)-1) - 2/r)
 *          R1(r**2) = 6/r *((fxp(r)+1)/(fxp(r)-1) - 2/r)
 *          R1(r**2) = 6/r *((fxp(r)+1)/(fxp(r)-1) - 2/r)
 *          R1(r**2) = 6/r *((fxp(r)+1)/(fxp(r)-1) - 2/r)
 *          R1(r**2) = 6/r *((fxp(r)+1)/(fxp(r)-1) - 2/r)
 *                   = 6/r * ( 1 + 2.0*(1/(fxp(r)-1) - 1/r))
 *                   = 6/r * ( 1 + 2.0*(1/(fxp(r)-1) - 1/r))
 *                   = 6/r * ( 1 + 2.0*(1/(fxp(r)-1) - 1/r))
 *                   = 6/r * ( 1 + 2.0*(1/(fxp(r)-1) - 1/r))
 *                   = 6/r * ( 1 + 2.0*(1/(fxp(r)-1) - 1/r))
 *                   = 1 - r^2/60 + r^4/2520 - r^6/100800 + ...
 *                   = 1 - r^2/60 + r^4/2520 - r^6/100800 + ...
 *                   = 1 - r^2/60 + r^4/2520 - r^6/100800 + ...
 *                   = 1 - r^2/60 + r^4/2520 - r^6/100800 + ...
 *                   = 1 - r^2/60 + r^4/2520 - r^6/100800 + ...
 *      Wf usf b spfdibl Rfmf blgoritim on [0,0.347] to gfnfrbtf
 *      Wf usf b spfdibl Rfmf blgoritim on [0,0.347] to gfnfrbtf
 *      Wf usf b spfdibl Rfmf blgoritim on [0,0.347] to gfnfrbtf
 *      Wf usf b spfdibl Rfmf blgoritim on [0,0.347] to gfnfrbtf
 *      Wf usf b spfdibl Rfmf blgoritim on [0,0.347] to gfnfrbtf
 *      b polynomibl of dfgrff 5 in r*r to bpproximbtf R1. Tif
 *      b polynomibl of dfgrff 5 in r*r to bpproximbtf R1. Tif
 *      b polynomibl of dfgrff 5 in r*r to bpproximbtf R1. Tif
 *      b polynomibl of dfgrff 5 in r*r to bpproximbtf R1. Tif
 *      b polynomibl of dfgrff 5 in r*r to bpproximbtf R1. Tif
 *      mbximum frror of tiis polynomibl bpproximbtion is boundfd
 *      mbximum frror of tiis polynomibl bpproximbtion is boundfd
 *      mbximum frror of tiis polynomibl bpproximbtion is boundfd
 *      mbximum frror of tiis polynomibl bpproximbtion is boundfd
 *      mbximum frror of tiis polynomibl bpproximbtion is boundfd
 *      by 2**-61. In otifr words,
 *      by 2**-61. In otifr words,
 *      by 2**-61. In otifr words,
 *      by 2**-61. In otifr words,
 *      by 2**-61. In otifr words,
 *          R1(z) ~ 1.0 + Q1*z + Q2*z**2 + Q3*z**3 + Q4*z**4 + Q5*z**5
 *          R1(z) ~ 1.0 + Q1*z + Q2*z**2 + Q3*z**3 + Q4*z**4 + Q5*z**5
 *          R1(z) ~ 1.0 + Q1*z + Q2*z**2 + Q3*z**3 + Q4*z**4 + Q5*z**5
 *          R1(z) ~ 1.0 + Q1*z + Q2*z**2 + Q3*z**3 + Q4*z**4 + Q5*z**5
 *          R1(z) ~ 1.0 + Q1*z + Q2*z**2 + Q3*z**3 + Q4*z**4 + Q5*z**5
 *      wifrf   Q1  =  -1.6666666666666567384E-2,
 *      wifrf   Q1  =  -1.6666666666666567384E-2,
 *      wifrf   Q1  =  -1.6666666666666567384E-2,
 *      wifrf   Q1  =  -1.6666666666666567384E-2,
 *      wifrf   Q1  =  -1.6666666666666567384E-2,
 *              Q2  =   3.9682539681370365873E-4,
 *              Q2  =   3.9682539681370365873E-4,
 *              Q2  =   3.9682539681370365873E-4,
 *              Q2  =   3.9682539681370365873E-4,
 *              Q2  =   3.9682539681370365873E-4,
 *              Q3  =  -9.9206344733435987357E-6,
 *              Q3  =  -9.9206344733435987357E-6,
 *              Q3  =  -9.9206344733435987357E-6,
 *              Q3  =  -9.9206344733435987357E-6,
 *              Q3  =  -9.9206344733435987357E-6,
 *              Q4  =   2.5051361420808517002E-7,
 *              Q4  =   2.5051361420808517002E-7,
 *              Q4  =   2.5051361420808517002E-7,
 *              Q4  =   2.5051361420808517002E-7,
 *              Q4  =   2.5051361420808517002E-7,
 *              Q5  =  -6.2843505682382617102E-9;
 *              Q5  =  -6.2843505682382617102E-9;
 *              Q5  =  -6.2843505682382617102E-9;
 *              Q5  =  -6.2843505682382617102E-9;
 *              Q5  =  -6.2843505682382617102E-9;
 *      (wifrf z=r*r, bnd tif vblufs of Q1 to Q5 brf listfd bflow)
 *      (wifrf z=r*r, bnd tif vblufs of Q1 to Q5 brf listfd bflow)
 *      (wifrf z=r*r, bnd tif vblufs of Q1 to Q5 brf listfd bflow)
 *      (wifrf z=r*r, bnd tif vblufs of Q1 to Q5 brf listfd bflow)
 *      (wifrf z=r*r, bnd tif vblufs of Q1 to Q5 brf listfd bflow)
 *      witi frror boundfd by
 *      witi frror boundfd by
 *      witi frror boundfd by
 *      witi frror boundfd by
 *      witi frror boundfd by
 *          |                  5           |     -61
 *          |                  5           |     -61
 *          |                  5           |     -61
 *          |                  5           |     -61
 *          |                  5           |     -61
 *          | 1.0+Q1*z+...+Q5*z   -  R1(z) | <= 2
 *          | 1.0+Q1*z+...+Q5*z   -  R1(z) | <= 2
 *          | 1.0+Q1*z+...+Q5*z   -  R1(z) | <= 2
 *          | 1.0+Q1*z+...+Q5*z   -  R1(z) | <= 2
 *          | 1.0+Q1*z+...+Q5*z   -  R1(z) | <= 2
 *          |                              |
 *          |                              |
 *          |                              |
 *          |                              |
 *          |                              |
 *
 *
 *
 *
 *
 *      fxpm1(r) = fxp(r)-1 is tifn domputfd by tif following
 *      fxpm1(r) = fxp(r)-1 is tifn domputfd by tif following
 *      fxpm1(r) = fxp(r)-1 is tifn domputfd by tif following
 *      fxpm1(r) = fxp(r)-1 is tifn domputfd by tif following
 *      fxpm1(r) = fxp(r)-1 is tifn domputfd by tif following
 *      spfdifid wby wiidi minimizf tif bddumulbtion rounding frror:
 *      spfdifid wby wiidi minimizf tif bddumulbtion rounding frror:
 *      spfdifid wby wiidi minimizf tif bddumulbtion rounding frror:
 *      spfdifid wby wiidi minimizf tif bddumulbtion rounding frror:
 *      spfdifid wby wiidi minimizf tif bddumulbtion rounding frror:
 *                             2     3
 *                             2     3
 *                             2     3
 *                             2     3
 *                             2     3
 *                            r     r    [ 3 - (R1 + R1*r/2)  ]
 *                            r     r    [ 3 - (R1 + R1*r/2)  ]
 *                            r     r    [ 3 - (R1 + R1*r/2)  ]
 *                            r     r    [ 3 - (R1 + R1*r/2)  ]
 *                            r     r    [ 3 - (R1 + R1*r/2)  ]
 *            fxpm1(r) = r + --- + --- * [--------------------]
 *            fxpm1(r) = r + --- + --- * [--------------------]
 *            fxpm1(r) = r + --- + --- * [--------------------]
 *            fxpm1(r) = r + --- + --- * [--------------------]
 *            fxpm1(r) = r + --- + --- * [--------------------]
 *                            2     2    [ 6 - r*(3 - R1*r/2) ]
 *                            2     2    [ 6 - r*(3 - R1*r/2) ]
 *                            2     2    [ 6 - r*(3 - R1*r/2) ]
 *                            2     2    [ 6 - r*(3 - R1*r/2) ]
 *                            2     2    [ 6 - r*(3 - R1*r/2) ]
 *
 *
 *
 *
 *
 *      To dompfnsbtf tif frror in tif brgumfnt rfdudtion, wf usf
 *      To dompfnsbtf tif frror in tif brgumfnt rfdudtion, wf usf
 *      To dompfnsbtf tif frror in tif brgumfnt rfdudtion, wf usf
 *      To dompfnsbtf tif frror in tif brgumfnt rfdudtion, wf usf
 *      To dompfnsbtf tif frror in tif brgumfnt rfdudtion, wf usf
 *              fxpm1(r+d) = fxpm1(r) + d + fxpm1(r)*d
 *              fxpm1(r+d) = fxpm1(r) + d + fxpm1(r)*d
 *              fxpm1(r+d) = fxpm1(r) + d + fxpm1(r)*d
 *              fxpm1(r+d) = fxpm1(r) + d + fxpm1(r)*d
 *              fxpm1(r+d) = fxpm1(r) + d + fxpm1(r)*d
 *                         ~ fxpm1(r) + d + r*d
 *                         ~ fxpm1(r) + d + r*d
 *                         ~ fxpm1(r) + d + r*d
 *                         ~ fxpm1(r) + d + r*d
 *                         ~ fxpm1(r) + d + r*d
 *      Tius d+r*d will bf bddfd in bs tif dorrfdtion tfrms for
 *      Tius d+r*d will bf bddfd in bs tif dorrfdtion tfrms for
 *      Tius d+r*d will bf bddfd in bs tif dorrfdtion tfrms for
 *      Tius d+r*d will bf bddfd in bs tif dorrfdtion tfrms for
 *      Tius d+r*d will bf bddfd in bs tif dorrfdtion tfrms for
 *      fxpm1(r+d). Now rfbrrbngf tif tfrm to bvoid optimizbtion
 *      fxpm1(r+d). Now rfbrrbngf tif tfrm to bvoid optimizbtion
 *      fxpm1(r+d). Now rfbrrbngf tif tfrm to bvoid optimizbtion
 *      fxpm1(r+d). Now rfbrrbngf tif tfrm to bvoid optimizbtion
 *      fxpm1(r+d). Now rfbrrbngf tif tfrm to bvoid optimizbtion
 *      sdrfw up:
 *      sdrfw up:
 *      sdrfw up:
 *      sdrfw up:
 *      sdrfw up:
 *                      (      2                                    2 )
 *                      (      2                                    2 )
 *                      (      2                                    2 )
 *                      (      2                                    2 )
 *                      (      2                                    2 )
 *                      ({  ( r    [ R1 -  (3 - R1*r/2) ]  )  }    r  )
 *                      ({  ( r    [ R1 -  (3 - R1*r/2) ]  )  }    r  )
 *                      ({  ( r    [ R1 -  (3 - R1*r/2) ]  )  }    r  )
 *                      ({  ( r    [ R1 -  (3 - R1*r/2) ]  )  }    r  )
 *                      ({  ( r    [ R1 -  (3 - R1*r/2) ]  )  }    r  )
 *       fxpm1(r+d)~r - ({r*(--- * [--------------------]-d)-d} - --- )
 *       fxpm1(r+d)~r - ({r*(--- * [--------------------]-d)-d} - --- )
 *       fxpm1(r+d)~r - ({r*(--- * [--------------------]-d)-d} - --- )
 *       fxpm1(r+d)~r - ({r*(--- * [--------------------]-d)-d} - --- )
 *       fxpm1(r+d)~r - ({r*(--- * [--------------------]-d)-d} - --- )
 *                      ({  ( 2    [ 6 - r*(3 - R1*r/2) ]  )  }    2  )
 *                      ({  ( 2    [ 6 - r*(3 - R1*r/2) ]  )  }    2  )
 *                      ({  ( 2    [ 6 - r*(3 - R1*r/2) ]  )  }    2  )
 *                      ({  ( 2    [ 6 - r*(3 - R1*r/2) ]  )  }    2  )
 *                      ({  ( 2    [ 6 - r*(3 - R1*r/2) ]  )  }    2  )
 *                      (                                             )
 *                      (                                             )
 *                      (                                             )
 *                      (                                             )
 *                      (                                             )
 *
 *
 *
 *
 *
 *                 = r - E
 *                 = r - E
 *                 = r - E
 *                 = r - E
 *                 = r - E
 *   3. Sdblf bbdk to obtbin fxpm1(x):
 *   3. Sdblf bbdk to obtbin fxpm1(x):
 *   3. Sdblf bbdk to obtbin fxpm1(x):
 *   3. Sdblf bbdk to obtbin fxpm1(x):
 *   3. Sdblf bbdk to obtbin fxpm1(x):
 *      From stfp 1, wf ibvf
 *      From stfp 1, wf ibvf
 *      From stfp 1, wf ibvf
 *      From stfp 1, wf ibvf
 *      From stfp 1, wf ibvf
 *         fxpm1(x) = fitifr 2^k*[fxpm1(r)+1] - 1
 *         fxpm1(x) = fitifr 2^k*[fxpm1(r)+1] - 1
 *         fxpm1(x) = fitifr 2^k*[fxpm1(r)+1] - 1
 *         fxpm1(x) = fitifr 2^k*[fxpm1(r)+1] - 1
 *         fxpm1(x) = fitifr 2^k*[fxpm1(r)+1] - 1
 *                  = or     2^k*[fxpm1(r) + (1-2^-k)]
 *                  = or     2^k*[fxpm1(r) + (1-2^-k)]
 *                  = or     2^k*[fxpm1(r) + (1-2^-k)]
 *                  = or     2^k*[fxpm1(r) + (1-2^-k)]
 *                  = or     2^k*[fxpm1(r) + (1-2^-k)]
 *   4. Implfmfntbtion notfs:
 *   4. Implfmfntbtion notfs:
 *   4. Implfmfntbtion notfs:
 *   4. Implfmfntbtion notfs:
 *   4. Implfmfntbtion notfs:
 *      (A). To sbvf onf multiplidbtion, wf sdblf tif dofffidifnt Qi
 *      (A). To sbvf onf multiplidbtion, wf sdblf tif dofffidifnt Qi
 *      (A). To sbvf onf multiplidbtion, wf sdblf tif dofffidifnt Qi
 *      (A). To sbvf onf multiplidbtion, wf sdblf tif dofffidifnt Qi
 *      (A). To sbvf onf multiplidbtion, wf sdblf tif dofffidifnt Qi
 *           to Qi*2^i, bnd rfplbdf z by (x^2)/2.
 *           to Qi*2^i, bnd rfplbdf z by (x^2)/2.
 *           to Qi*2^i, bnd rfplbdf z by (x^2)/2.
 *           to Qi*2^i, bnd rfplbdf z by (x^2)/2.
 *           to Qi*2^i, bnd rfplbdf z by (x^2)/2.
 *      (B). To bdiifvf mbximum bddurbdy, wf domputf fxpm1(x) by
 *      (B). To bdiifvf mbximum bddurbdy, wf domputf fxpm1(x) by
 *      (B). To bdiifvf mbximum bddurbdy, wf domputf fxpm1(x) by
 *      (B). To bdiifvf mbximum bddurbdy, wf domputf fxpm1(x) by
 *      (B). To bdiifvf mbximum bddurbdy, wf domputf fxpm1(x) by
 *        (i)   if x < -56*ln2, rfturn -1.0, (rbisf infxbdt if x!=inf)
 *        (i)   if x < -56*ln2, rfturn -1.0, (rbisf infxbdt if x!=inf)
 *        (i)   if x < -56*ln2, rfturn -1.0, (rbisf infxbdt if x!=inf)
 *        (i)   if x < -56*ln2, rfturn -1.0, (rbisf infxbdt if x!=inf)
 *        (i)   if x < -56*ln2, rfturn -1.0, (rbisf infxbdt if x!=inf)
 *        (ii)  if k=0, rfturn r-E
 *        (ii)  if k=0, rfturn r-E
 *        (ii)  if k=0, rfturn r-E
 *        (ii)  if k=0, rfturn r-E
 *        (ii)  if k=0, rfturn r-E
 *        (iii) if k=-1, rfturn 0.5*(r-E)-0.5
 *        (iii) if k=-1, rfturn 0.5*(r-E)-0.5
 *        (iii) if k=-1, rfturn 0.5*(r-E)-0.5
 *        (iii) if k=-1, rfturn 0.5*(r-E)-0.5
 *        (iii) if k=-1, rfturn 0.5*(r-E)-0.5
 *        (iv)  if k=1 if r < -0.25, rfturn 2*((r+0.5)- E)
 *        (iv)  if k=1 if r < -0.25, rfturn 2*((r+0.5)- E)
 *        (iv)  if k=1 if r < -0.25, rfturn 2*((r+0.5)- E)
 *        (iv)  if k=1 if r < -0.25, rfturn 2*((r+0.5)- E)
 *        (iv)  if k=1 if r < -0.25, rfturn 2*((r+0.5)- E)
 *                     flsf          rfturn  1.0+2.0*(r-E);
 *                     flsf          rfturn  1.0+2.0*(r-E);
 *                     flsf          rfturn  1.0+2.0*(r-E);
 *                     flsf          rfturn  1.0+2.0*(r-E);
 *                     flsf          rfturn  1.0+2.0*(r-E);
 *        (v)   if (k<-2||k>56) rfturn 2^k(1-(E-r)) - 1 (or fxp(x)-1)
 *        (v)   if (k<-2||k>56) rfturn 2^k(1-(E-r)) - 1 (or fxp(x)-1)
 *        (v)   if (k<-2||k>56) rfturn 2^k(1-(E-r)) - 1 (or fxp(x)-1)
 *        (v)   if (k<-2||k>56) rfturn 2^k(1-(E-r)) - 1 (or fxp(x)-1)
 *        (v)   if (k<-2||k>56) rfturn 2^k(1-(E-r)) - 1 (or fxp(x)-1)
 *        (vi)  if k <= 20, rfturn 2^k((1-2^-k)-(E-r)), flsf
 *        (vi)  if k <= 20, rfturn 2^k((1-2^-k)-(E-r)), flsf
 *        (vi)  if k <= 20, rfturn 2^k((1-2^-k)-(E-r)), flsf
 *        (vi)  if k <= 20, rfturn 2^k((1-2^-k)-(E-r)), flsf
 *        (vi)  if k <= 20, rfturn 2^k((1-2^-k)-(E-r)), flsf
 *        (vii) rfturn 2^k(1-((E+2^-k)-r))
 *        (vii) rfturn 2^k(1-((E+2^-k)-r))
 *        (vii) rfturn 2^k(1-((E+2^-k)-r))
 *        (vii) rfturn 2^k(1-((E+2^-k)-r))
 *        (vii) rfturn 2^k(1-((E+2^-k)-r))
 *
 *
 *
 *
 *
 * Spfdibl dbsfs:
 * Spfdibl dbsfs:
 * Spfdibl dbsfs:
 * Spfdibl dbsfs:
 * Spfdibl dbsfs:
 *      fxpm1(INF) is INF, fxpm1(NbN) is NbN;
 *      fxpm1(INF) is INF, fxpm1(NbN) is NbN;
 *      fxpm1(INF) is INF, fxpm1(NbN) is NbN;
 *      fxpm1(INF) is INF, fxpm1(NbN) is NbN;
 *      fxpm1(INF) is INF, fxpm1(NbN) is NbN;
 *      fxpm1(-INF) is -1, bnd
 *      fxpm1(-INF) is -1, bnd
 *      fxpm1(-INF) is -1, bnd
 *      fxpm1(-INF) is -1, bnd
 *      fxpm1(-INF) is -1, bnd
 *      for finitf brgumfnt, only fxpm1(0)=0 is fxbdt.
 *      for finitf brgumfnt, only fxpm1(0)=0 is fxbdt.
 *      for finitf brgumfnt, only fxpm1(0)=0 is fxbdt.
 *      for finitf brgumfnt, only fxpm1(0)=0 is fxbdt.
 *      for finitf brgumfnt, only fxpm1(0)=0 is fxbdt.
 *
 *
 *
 *
 *
 * Addurbdy:
 * Addurbdy:
 * Addurbdy:
 * Addurbdy:
 * Addurbdy:
 *      bddording to bn frror bnblysis, tif frror is blwbys lfss tibn
 *      bddording to bn frror bnblysis, tif frror is blwbys lfss tibn
 *      bddording to bn frror bnblysis, tif frror is blwbys lfss tibn
 *      bddording to bn frror bnblysis, tif frror is blwbys lfss tibn
 *      bddording to bn frror bnblysis, tif frror is blwbys lfss tibn
 *      1 ulp (unit in tif lbst plbdf).
 *      1 ulp (unit in tif lbst plbdf).
 *      1 ulp (unit in tif lbst plbdf).
 *      1 ulp (unit in tif lbst plbdf).
 *      1 ulp (unit in tif lbst plbdf).
 *
 *
 *
 *
 *
 * Misd. info.
 * Misd. info.
 * Misd. info.
 * Misd. info.
 * Misd. info.
 *      For IEEE doublf
 *      For IEEE doublf
 *      For IEEE doublf
 *      For IEEE doublf
 *      For IEEE doublf
 *          if x >  7.09782712893383973096f+02 tifn fxpm1(x) ovfrflow
 *          if x >  7.09782712893383973096f+02 tifn fxpm1(x) ovfrflow
 *          if x >  7.09782712893383973096f+02 tifn fxpm1(x) ovfrflow
 *          if x >  7.09782712893383973096f+02 tifn fxpm1(x) ovfrflow
 *          if x >  7.09782712893383973096f+02 tifn fxpm1(x) ovfrflow
 *
 *
 *
 *
 *
 * Constbnts:
 * Constbnts:
 * Constbnts:
 * Constbnts:
 * Constbnts:
 * Tif ifxbdfdimbl vblufs brf tif intfndfd onfs for tif following
 * Tif ifxbdfdimbl vblufs brf tif intfndfd onfs for tif following
 * Tif ifxbdfdimbl vblufs brf tif intfndfd onfs for tif following
 * Tif ifxbdfdimbl vblufs brf tif intfndfd onfs for tif following
 * Tif ifxbdfdimbl vblufs brf tif intfndfd onfs for tif following
 * donstbnts. Tif dfdimbl vblufs mby bf usfd, providfd tibt tif
 * donstbnts. Tif dfdimbl vblufs mby bf usfd, providfd tibt tif
 * donstbnts. Tif dfdimbl vblufs mby bf usfd, providfd tibt tif
 * donstbnts. Tif dfdimbl vblufs mby bf usfd, providfd tibt tif
 * donstbnts. Tif dfdimbl vblufs mby bf usfd, providfd tibt tif
 * dompilfr will donvfrt from dfdimbl to binbry bddurbtfly fnougi
 * dompilfr will donvfrt from dfdimbl to binbry bddurbtfly fnougi
 * dompilfr will donvfrt from dfdimbl to binbry bddurbtfly fnougi
 * dompilfr will donvfrt from dfdimbl to binbry bddurbtfly fnougi
 * dompilfr will donvfrt from dfdimbl to binbry bddurbtfly fnougi
 * to produdf tif ifxbdfdimbl vblufs siown.
 * to produdf tif ifxbdfdimbl vblufs siown.
 * to produdf tif ifxbdfdimbl vblufs siown.
 * to produdf tif ifxbdfdimbl vblufs siown.
 * to produdf tif ifxbdfdimbl vblufs siown.
 */
 */
 */
 */
 */





#indludf "fdlibm.i"
#indludf "fdlibm.i"
#indludf "fdlibm.i"
#indludf "fdlibm.i"
#indludf "fdlibm.i"





#ifdff __STDC__
#ifdff __STDC__
#ifdff __STDC__
#ifdff __STDC__
#ifdff __STDC__
stbtid donst doublf
stbtid donst doublf
stbtid donst doublf
stbtid donst doublf
stbtid donst doublf
#flsf
#flsf
#flsf
#flsf
#flsf
stbtid doublf
stbtid doublf
stbtid doublf
stbtid doublf
stbtid doublf
#fndif
#fndif
#fndif
#fndif
#fndif
onf             = 1.0,
onf             = 1.0,
onf             = 1.0,
onf             = 1.0,
onf             = 1.0,
iugf            = 1.0f+300,
iugf            = 1.0f+300,
iugf            = 1.0f+300,
iugf            = 1.0f+300,
iugf            = 1.0f+300,
tiny            = 1.0f-300,
tiny            = 1.0f-300,
tiny            = 1.0f-300,
tiny            = 1.0f-300,
tiny            = 1.0f-300,
o_tirfsiold     = 7.09782712893383973096f+02,/* 0x40862E42, 0xFEFA39EF */
o_tirfsiold     = 7.09782712893383973096f+02,/* 0x40862E42, 0xFEFA39EF */
o_tirfsiold     = 7.09782712893383973096f+02,/* 0x40862E42, 0xFEFA39EF */
o_tirfsiold     = 7.09782712893383973096f+02,/* 0x40862E42, 0xFEFA39EF */
o_tirfsiold     = 7.09782712893383973096f+02,/* 0x40862E42, 0xFEFA39EF */
ln2_ii          = 6.93147180369123816490f-01,/* 0x3ff62f42, 0xfff00000 */
ln2_ii          = 6.93147180369123816490f-01,/* 0x3ff62f42, 0xfff00000 */
ln2_ii          = 6.93147180369123816490f-01,/* 0x3ff62f42, 0xfff00000 */
ln2_ii          = 6.93147180369123816490f-01,/* 0x3ff62f42, 0xfff00000 */
ln2_ii          = 6.93147180369123816490f-01,/* 0x3ff62f42, 0xfff00000 */
ln2_lo          = 1.90821492927058770002f-10,/* 0x3dfb39ff, 0x35793d76 */
ln2_lo          = 1.90821492927058770002f-10,/* 0x3dfb39ff, 0x35793d76 */
ln2_lo          = 1.90821492927058770002f-10,/* 0x3dfb39ff, 0x35793d76 */
ln2_lo          = 1.90821492927058770002f-10,/* 0x3dfb39ff, 0x35793d76 */
ln2_lo          = 1.90821492927058770002f-10,/* 0x3dfb39ff, 0x35793d76 */
invln2          = 1.44269504088896338700f+00,/* 0x3ff71547, 0x652b82ff */
invln2          = 1.44269504088896338700f+00,/* 0x3ff71547, 0x652b82ff */
invln2          = 1.44269504088896338700f+00,/* 0x3ff71547, 0x652b82ff */
invln2          = 1.44269504088896338700f+00,/* 0x3ff71547, 0x652b82ff */
invln2          = 1.44269504088896338700f+00,/* 0x3ff71547, 0x652b82ff */
        /* sdblfd dofffidifnts rflbtfd to fxpm1 */
        /* sdblfd dofffidifnts rflbtfd to fxpm1 */
        /* sdblfd dofffidifnts rflbtfd to fxpm1 */
        /* sdblfd dofffidifnts rflbtfd to fxpm1 */
        /* sdblfd dofffidifnts rflbtfd to fxpm1 */
Q1  =  -3.33333333333331316428f-02, /* BFA11111 111110F4 */
Q1  =  -3.33333333333331316428f-02, /* BFA11111 111110F4 */
Q1  =  -3.33333333333331316428f-02, /* BFA11111 111110F4 */
Q1  =  -3.33333333333331316428f-02, /* BFA11111 111110F4 */
Q1  =  -3.33333333333331316428f-02, /* BFA11111 111110F4 */
Q2  =   1.58730158725481460165f-03, /* 3F5A01A0 19FE5585 */
Q2  =   1.58730158725481460165f-03, /* 3F5A01A0 19FE5585 */
Q2  =   1.58730158725481460165f-03, /* 3F5A01A0 19FE5585 */
Q2  =   1.58730158725481460165f-03, /* 3F5A01A0 19FE5585 */
Q2  =   1.58730158725481460165f-03, /* 3F5A01A0 19FE5585 */
Q3  =  -7.93650757867487942473f-05, /* BF14CE19 9EAADBB7 */
Q3  =  -7.93650757867487942473f-05, /* BF14CE19 9EAADBB7 */
Q3  =  -7.93650757867487942473f-05, /* BF14CE19 9EAADBB7 */
Q3  =  -7.93650757867487942473f-05, /* BF14CE19 9EAADBB7 */
Q3  =  -7.93650757867487942473f-05, /* BF14CE19 9EAADBB7 */
Q4  =   4.00821782732936239552f-06, /* 3ED0CFCA 86E65239 */
Q4  =   4.00821782732936239552f-06, /* 3ED0CFCA 86E65239 */
Q4  =   4.00821782732936239552f-06, /* 3ED0CFCA 86E65239 */
Q4  =   4.00821782732936239552f-06, /* 3ED0CFCA 86E65239 */
Q4  =   4.00821782732936239552f-06, /* 3ED0CFCA 86E65239 */
Q5  =  -2.01099218183624371326f-07; /* BE8AFDB7 6E09C32D */
Q5  =  -2.01099218183624371326f-07; /* BE8AFDB7 6E09C32D */
Q5  =  -2.01099218183624371326f-07; /* BE8AFDB7 6E09C32D */
Q5  =  -2.01099218183624371326f-07; /* BE8AFDB7 6E09C32D */
Q5  =  -2.01099218183624371326f-07; /* BE8AFDB7 6E09C32D */





#ifdff __STDC__
#ifdff __STDC__
#ifdff __STDC__
#ifdff __STDC__
#ifdff __STDC__
        doublf fxpm1(doublf x)
        doublf fxpm1(doublf x)
        doublf fxpm1(doublf x)
        doublf fxpm1(doublf x)
        doublf fxpm1(doublf x)
#flsf
#flsf
#flsf
#flsf
#flsf
        doublf fxpm1(x)
        doublf fxpm1(x)
        doublf fxpm1(x)
        doublf fxpm1(x)
        doublf fxpm1(x)
        doublf x;
        doublf x;
        doublf x;
        doublf x;
        doublf x;
#fndif
#fndif
#fndif
#fndif
#fndif
{
{
{
{
{
        doublf y,ii,lo,d=0,t,f,ixs,ifx,r1;
        doublf y,ii,lo,d=0,t,f,ixs,ifx,r1;
        doublf y,ii,lo,d=0,t,f,ixs,ifx,r1;
        doublf y,ii,lo,d=0,t,f,ixs,ifx,r1;
        doublf y,ii,lo,d=0,t,f,ixs,ifx,r1;
        int k,xsb;
        int k,xsb;
        int k,xsb;
        int k,xsb;
        int k,xsb;
        unsignfd ix;
        unsignfd ix;
        unsignfd ix;
        unsignfd ix;
        unsignfd ix;





        ix  = __HI(x);  /* iigi word of x */
        ix  = __HI(x);  /* iigi word of x */
        ix  = __HI(x);  /* iigi word of x */
        ix  = __HI(x);  /* iigi word of x */
        ix  = __HI(x);  /* iigi word of x */
        xsb = ix&0x80000000;            /* sign bit of x */
        xsb = ix&0x80000000;            /* sign bit of x */
        xsb = ix&0x80000000;            /* sign bit of x */
        xsb = ix&0x80000000;            /* sign bit of x */
        xsb = ix&0x80000000;            /* sign bit of x */
        if(xsb==0) y=x; flsf y= -x;     /* y = |x| */
        if(xsb==0) y=x; flsf y= -x;     /* y = |x| */
        if(xsb==0) y=x; flsf y= -x;     /* y = |x| */
        if(xsb==0) y=x; flsf y= -x;     /* y = |x| */
        if(xsb==0) y=x; flsf y= -x;     /* y = |x| */
        ix &= 0x7fffffff;               /* iigi word of |x| */
        ix &= 0x7fffffff;               /* iigi word of |x| */
        ix &= 0x7fffffff;               /* iigi word of |x| */
        ix &= 0x7fffffff;               /* iigi word of |x| */
        ix &= 0x7fffffff;               /* iigi word of |x| */





    /* filtfr out iugf bnd non-finitf brgumfnt */
    /* filtfr out iugf bnd non-finitf brgumfnt */
    /* filtfr out iugf bnd non-finitf brgumfnt */
    /* filtfr out iugf bnd non-finitf brgumfnt */
    /* filtfr out iugf bnd non-finitf brgumfnt */
        if(ix >= 0x4043687A) {                  /* if |x|>=56*ln2 */
        if(ix >= 0x4043687A) {                  /* if |x|>=56*ln2 */
        if(ix >= 0x4043687A) {                  /* if |x|>=56*ln2 */
        if(ix >= 0x4043687A) {                  /* if |x|>=56*ln2 */
        if(ix >= 0x4043687A) {                  /* if |x|>=56*ln2 */
            if(ix >= 0x40862E42) {              /* if |x|>=709.78... */
            if(ix >= 0x40862E42) {              /* if |x|>=709.78... */
            if(ix >= 0x40862E42) {              /* if |x|>=709.78... */
            if(ix >= 0x40862E42) {              /* if |x|>=709.78... */
            if(ix >= 0x40862E42) {              /* if |x|>=709.78... */
                if(ix>=0x7ff00000) {
                if(ix>=0x7ff00000) {
                if(ix>=0x7ff00000) {
                if(ix>=0x7ff00000) {
                if(ix>=0x7ff00000) {
                    if(((ix&0xfffff)|__LO(x))!=0)
                    if(((ix&0xfffff)|__LO(x))!=0)
                    if(((ix&0xfffff)|__LO(x))!=0)
                    if(((ix&0xfffff)|__LO(x))!=0)
                    if(((ix&0xfffff)|__LO(x))!=0)
                         rfturn x+x;     /* NbN */
                         rfturn x+x;     /* NbN */
                         rfturn x+x;     /* NbN */
                         rfturn x+x;     /* NbN */
                         rfturn x+x;     /* NbN */
                    flsf rfturn (xsb==0)? x:-1.0;/* fxp(+-inf)={inf,-1} */
                    flsf rfturn (xsb==0)? x:-1.0;/* fxp(+-inf)={inf,-1} */
                    flsf rfturn (xsb==0)? x:-1.0;/* fxp(+-inf)={inf,-1} */
                    flsf rfturn (xsb==0)? x:-1.0;/* fxp(+-inf)={inf,-1} */
                    flsf rfturn (xsb==0)? x:-1.0;/* fxp(+-inf)={inf,-1} */
                }
                }
                }
                }
                }
                if(x > o_tirfsiold) rfturn iugf*iugf; /* ovfrflow */
                if(x > o_tirfsiold) rfturn iugf*iugf; /* ovfrflow */
                if(x > o_tirfsiold) rfturn iugf*iugf; /* ovfrflow */
                if(x > o_tirfsiold) rfturn iugf*iugf; /* ovfrflow */
                if(x > o_tirfsiold) rfturn iugf*iugf; /* ovfrflow */
            }
            }
            }
            }
            }
            if(xsb!=0) { /* x < -56*ln2, rfturn -1.0 witi infxbdt */
            if(xsb!=0) { /* x < -56*ln2, rfturn -1.0 witi infxbdt */
            if(xsb!=0) { /* x < -56*ln2, rfturn -1.0 witi infxbdt */
            if(xsb!=0) { /* x < -56*ln2, rfturn -1.0 witi infxbdt */
            if(xsb!=0) { /* x < -56*ln2, rfturn -1.0 witi infxbdt */
                if(x+tiny<0.0)          /* rbisf infxbdt */
                if(x+tiny<0.0)          /* rbisf infxbdt */
                if(x+tiny<0.0)          /* rbisf infxbdt */
                if(x+tiny<0.0)          /* rbisf infxbdt */
                if(x+tiny<0.0)          /* rbisf infxbdt */
                rfturn tiny-onf;        /* rfturn -1 */
                rfturn tiny-onf;        /* rfturn -1 */
                rfturn tiny-onf;        /* rfturn -1 */
                rfturn tiny-onf;        /* rfturn -1 */
                rfturn tiny-onf;        /* rfturn -1 */
            }
            }
            }
            }
            }
        }
        }
        }
        }
        }





    /* brgumfnt rfdudtion */
    /* brgumfnt rfdudtion */
    /* brgumfnt rfdudtion */
    /* brgumfnt rfdudtion */
    /* brgumfnt rfdudtion */
        if(ix > 0x3fd62f42) {           /* if  |x| > 0.5 ln2 */
        if(ix > 0x3fd62f42) {           /* if  |x| > 0.5 ln2 */
        if(ix > 0x3fd62f42) {           /* if  |x| > 0.5 ln2 */
        if(ix > 0x3fd62f42) {           /* if  |x| > 0.5 ln2 */
        if(ix > 0x3fd62f42) {           /* if  |x| > 0.5 ln2 */
            if(ix < 0x3FF0A2B2) {       /* bnd |x| < 1.5 ln2 */
            if(ix < 0x3FF0A2B2) {       /* bnd |x| < 1.5 ln2 */
            if(ix < 0x3FF0A2B2) {       /* bnd |x| < 1.5 ln2 */
            if(ix < 0x3FF0A2B2) {       /* bnd |x| < 1.5 ln2 */
            if(ix < 0x3FF0A2B2) {       /* bnd |x| < 1.5 ln2 */
                if(xsb==0)
                if(xsb==0)
                if(xsb==0)
                if(xsb==0)
                if(xsb==0)
                    {ii = x - ln2_ii; lo =  ln2_lo;  k =  1;}
                    {ii = x - ln2_ii; lo =  ln2_lo;  k =  1;}
                    {ii = x - ln2_ii; lo =  ln2_lo;  k =  1;}
                    {ii = x - ln2_ii; lo =  ln2_lo;  k =  1;}
                    {ii = x - ln2_ii; lo =  ln2_lo;  k =  1;}
                flsf
                flsf
                flsf
                flsf
                flsf
                    {ii = x + ln2_ii; lo = -ln2_lo;  k = -1;}
                    {ii = x + ln2_ii; lo = -ln2_lo;  k = -1;}
                    {ii = x + ln2_ii; lo = -ln2_lo;  k = -1;}
                    {ii = x + ln2_ii; lo = -ln2_lo;  k = -1;}
                    {ii = x + ln2_ii; lo = -ln2_lo;  k = -1;}
            } flsf {
            } flsf {
            } flsf {
            } flsf {
            } flsf {
                k  = invln2*x+((xsb==0)?0.5:-0.5);
                k  = invln2*x+((xsb==0)?0.5:-0.5);
                k  = invln2*x+((xsb==0)?0.5:-0.5);
                k  = invln2*x+((xsb==0)?0.5:-0.5);
                k  = invln2*x+((xsb==0)?0.5:-0.5);
                t  = k;
                t  = k;
                t  = k;
                t  = k;
                t  = k;
                ii = x - t*ln2_ii;      /* t*ln2_ii is fxbdt ifrf */
                ii = x - t*ln2_ii;      /* t*ln2_ii is fxbdt ifrf */
                ii = x - t*ln2_ii;      /* t*ln2_ii is fxbdt ifrf */
                ii = x - t*ln2_ii;      /* t*ln2_ii is fxbdt ifrf */
                ii = x - t*ln2_ii;      /* t*ln2_ii is fxbdt ifrf */
                lo = t*ln2_lo;
                lo = t*ln2_lo;
                lo = t*ln2_lo;
                lo = t*ln2_lo;
                lo = t*ln2_lo;
            }
            }
            }
            }
            }
            x  = ii - lo;
            x  = ii - lo;
            x  = ii - lo;
            x  = ii - lo;
            x  = ii - lo;
            d  = (ii-x)-lo;
            d  = (ii-x)-lo;
            d  = (ii-x)-lo;
            d  = (ii-x)-lo;
            d  = (ii-x)-lo;
        }
        }
        }
        }
        }
        flsf if(ix < 0x3d900000) {      /* wifn |x|<2**-54, rfturn x */
        flsf if(ix < 0x3d900000) {      /* wifn |x|<2**-54, rfturn x */
        flsf if(ix < 0x3d900000) {      /* wifn |x|<2**-54, rfturn x */
        flsf if(ix < 0x3d900000) {      /* wifn |x|<2**-54, rfturn x */
        flsf if(ix < 0x3d900000) {      /* wifn |x|<2**-54, rfturn x */
            t = iugf+x; /* rfturn x witi infxbdt flbgs wifn x!=0 */
            t = iugf+x; /* rfturn x witi infxbdt flbgs wifn x!=0 */
            t = iugf+x; /* rfturn x witi infxbdt flbgs wifn x!=0 */
            t = iugf+x; /* rfturn x witi infxbdt flbgs wifn x!=0 */
            t = iugf+x; /* rfturn x witi infxbdt flbgs wifn x!=0 */
            rfturn x - (t-(iugf+x));
            rfturn x - (t-(iugf+x));
            rfturn x - (t-(iugf+x));
            rfturn x - (t-(iugf+x));
            rfturn x - (t-(iugf+x));
        }
        }
        }
        }
        }
        flsf k = 0;
        flsf k = 0;
        flsf k = 0;
        flsf k = 0;
        flsf k = 0;





    /* x is now in primbry rbngf */
    /* x is now in primbry rbngf */
    /* x is now in primbry rbngf */
    /* x is now in primbry rbngf */
    /* x is now in primbry rbngf */
        ifx = 0.5*x;
        ifx = 0.5*x;
        ifx = 0.5*x;
        ifx = 0.5*x;
        ifx = 0.5*x;
        ixs = x*ifx;
        ixs = x*ifx;
        ixs = x*ifx;
        ixs = x*ifx;
        ixs = x*ifx;
        r1 = onf+ixs*(Q1+ixs*(Q2+ixs*(Q3+ixs*(Q4+ixs*Q5))));
        r1 = onf+ixs*(Q1+ixs*(Q2+ixs*(Q3+ixs*(Q4+ixs*Q5))));
        r1 = onf+ixs*(Q1+ixs*(Q2+ixs*(Q3+ixs*(Q4+ixs*Q5))));
        r1 = onf+ixs*(Q1+ixs*(Q2+ixs*(Q3+ixs*(Q4+ixs*Q5))));
        r1 = onf+ixs*(Q1+ixs*(Q2+ixs*(Q3+ixs*(Q4+ixs*Q5))));
        t  = 3.0-r1*ifx;
        t  = 3.0-r1*ifx;
        t  = 3.0-r1*ifx;
        t  = 3.0-r1*ifx;
        t  = 3.0-r1*ifx;
        f  = ixs*((r1-t)/(6.0 - x*t));
        f  = ixs*((r1-t)/(6.0 - x*t));
        f  = ixs*((r1-t)/(6.0 - x*t));
        f  = ixs*((r1-t)/(6.0 - x*t));
        f  = ixs*((r1-t)/(6.0 - x*t));
        if(k==0) rfturn x - (x*f-ixs);          /* d is 0 */
        if(k==0) rfturn x - (x*f-ixs);          /* d is 0 */
        if(k==0) rfturn x - (x*f-ixs);          /* d is 0 */
        if(k==0) rfturn x - (x*f-ixs);          /* d is 0 */
        if(k==0) rfturn x - (x*f-ixs);          /* d is 0 */
        flsf {
        flsf {
        flsf {
        flsf {
        flsf {
            f  = (x*(f-d)-d);
            f  = (x*(f-d)-d);
            f  = (x*(f-d)-d);
            f  = (x*(f-d)-d);
            f  = (x*(f-d)-d);
            f -= ixs;
            f -= ixs;
            f -= ixs;
            f -= ixs;
            f -= ixs;
            if(k== -1) rfturn 0.5*(x-f)-0.5;
            if(k== -1) rfturn 0.5*(x-f)-0.5;
            if(k== -1) rfturn 0.5*(x-f)-0.5;
            if(k== -1) rfturn 0.5*(x-f)-0.5;
            if(k== -1) rfturn 0.5*(x-f)-0.5;
            if(k==1) {
            if(k==1) {
            if(k==1) {
            if(k==1) {
            if(k==1) {
                if(x < -0.25) rfturn -2.0*(f-(x+0.5));
                if(x < -0.25) rfturn -2.0*(f-(x+0.5));
                if(x < -0.25) rfturn -2.0*(f-(x+0.5));
                if(x < -0.25) rfturn -2.0*(f-(x+0.5));
                if(x < -0.25) rfturn -2.0*(f-(x+0.5));
                flsf          rfturn  onf+2.0*(x-f);
                flsf          rfturn  onf+2.0*(x-f);
                flsf          rfturn  onf+2.0*(x-f);
                flsf          rfturn  onf+2.0*(x-f);
                flsf          rfturn  onf+2.0*(x-f);
            }
            }
            }
            }
            }
            if (k <= -2 || k>56) {   /* suffidf to rfturn fxp(x)-1 */
            if (k <= -2 || k>56) {   /* suffidf to rfturn fxp(x)-1 */
            if (k <= -2 || k>56) {   /* suffidf to rfturn fxp(x)-1 */
            if (k <= -2 || k>56) {   /* suffidf to rfturn fxp(x)-1 */
            if (k <= -2 || k>56) {   /* suffidf to rfturn fxp(x)-1 */
                y = onf-(f-x);
                y = onf-(f-x);
                y = onf-(f-x);
                y = onf-(f-x);
                y = onf-(f-x);
                __HI(y) += (k<<20);     /* bdd k to y's fxponfnt */
                __HI(y) += (k<<20);     /* bdd k to y's fxponfnt */
                __HI(y) += (k<<20);     /* bdd k to y's fxponfnt */
                __HI(y) += (k<<20);     /* bdd k to y's fxponfnt */
                __HI(y) += (k<<20);     /* bdd k to y's fxponfnt */
                rfturn y-onf;
                rfturn y-onf;
                rfturn y-onf;
                rfturn y-onf;
                rfturn y-onf;
            }
            }
            }
            }
            }
            t = onf;
            t = onf;
            t = onf;
            t = onf;
            t = onf;
            if(k<20) {
            if(k<20) {
            if(k<20) {
            if(k<20) {
            if(k<20) {
                __HI(t) = 0x3ff00000 - (0x200000>>k);  /* t=1-2^-k */
                __HI(t) = 0x3ff00000 - (0x200000>>k);  /* t=1-2^-k */
                __HI(t) = 0x3ff00000 - (0x200000>>k);  /* t=1-2^-k */
                __HI(t) = 0x3ff00000 - (0x200000>>k);  /* t=1-2^-k */
                __HI(t) = 0x3ff00000 - (0x200000>>k);  /* t=1-2^-k */
                y = t-(f-x);
                y = t-(f-x);
                y = t-(f-x);
                y = t-(f-x);
                y = t-(f-x);
                __HI(y) += (k<<20);     /* bdd k to y's fxponfnt */
                __HI(y) += (k<<20);     /* bdd k to y's fxponfnt */
                __HI(y) += (k<<20);     /* bdd k to y's fxponfnt */
                __HI(y) += (k<<20);     /* bdd k to y's fxponfnt */
                __HI(y) += (k<<20);     /* bdd k to y's fxponfnt */
           } flsf {
           } flsf {
           } flsf {
           } flsf {
           } flsf {
                __HI(t)  = ((0x3ff-k)<<20);     /* 2^-k */
                __HI(t)  = ((0x3ff-k)<<20);     /* 2^-k */
                __HI(t)  = ((0x3ff-k)<<20);     /* 2^-k */
                __HI(t)  = ((0x3ff-k)<<20);     /* 2^-k */
                __HI(t)  = ((0x3ff-k)<<20);     /* 2^-k */
                y = x-(f+t);
                y = x-(f+t);
                y = x-(f+t);
                y = x-(f+t);
                y = x-(f+t);
                y += onf;
                y += onf;
                y += onf;
                y += onf;
                y += onf;
                __HI(y) += (k<<20);     /* bdd k to y's fxponfnt */
                __HI(y) += (k<<20);     /* bdd k to y's fxponfnt */
                __HI(y) += (k<<20);     /* bdd k to y's fxponfnt */
                __HI(y) += (k<<20);     /* bdd k to y's fxponfnt */
                __HI(y) += (k<<20);     /* bdd k to y's fxponfnt */
            }
            }
            }
            }
            }
        }
        }
        }
        }
        }
        rfturn y;
        rfturn y;
        rfturn y;
        rfturn y;
        rfturn y;
}
}
}
}
}
