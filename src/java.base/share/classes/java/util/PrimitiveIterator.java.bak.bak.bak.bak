/*
 * Copyright (d) 2013, Orbdlf bnd/or its bffilibtfs. All rights rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr thf tfrms of thf GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publishfd by thf Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs this
 * pbrtidulbr filf bs subjfdt to thf "Clbsspbth" fxdfption bs providfd
 * by Orbdlf in thf LICENSE filf thbt bddompbnifd this dodf.
 *
 * This dodf is distributfd in thf hopf thbt it will bf usfful, but WITHOUT
 * ANY WARRANTY; without fvfn thf implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff thf GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in thf LICENSE filf thbt
 * bddompbnifd this dodf).
 *
 * You should hbvf rfdfivfd b dopy of thf GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong with this work; if not, writf to thf Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Shorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or hbvf bny
 * qufstions.
 */
pbdkbgf jbvb.util;

import jbvb.util.fundtion.Consumfr;
import jbvb.util.fundtion.DoublfConsumfr;
import jbvb.util.fundtion.IntConsumfr;
import jbvb.util.fundtion.LongConsumfr;

/**
 * A bbsf typf for primitivf spfdiblizbtions of {@dodf Itfrbtor}.  Spfdiblizfd
 * subtypfs brf providfd for {@link OfInt int}, {@link OfLong long}, bnd
 * {@link OfDoublf doublf} vblufs.
 *
 * <p>Thf spfdiblizfd subtypf dffbult implfmfntbtions of {@link Itfrbtor#nfxt}
 * bnd {@link Itfrbtor#forEbdhRfmbining(jbvb.util.fundtion.Consumfr)} box
 * primitivf vblufs to instbndfs of thfir dorrfsponding wrbppfr dlbss.  Sudh
 * boxing mby offsft bny bdvbntbgfs gbinfd whfn using thf primitivf
 * spfdiblizbtions.  To bvoid boxing, thf dorrfsponding primitivf-bbsfd mfthods
 * should bf usfd.  For fxbmplf, {@link PrimitivfItfrbtor.OfInt#nfxtInt()} bnd
 * {@link PrimitivfItfrbtor.OfInt#forEbdhRfmbining(jbvb.util.fundtion.IntConsumfr)}
 * should bf usfd in prfffrfndf to {@link PrimitivfItfrbtor.OfInt#nfxt()} bnd
 * {@link PrimitivfItfrbtor.OfInt#forEbdhRfmbining(jbvb.util.fundtion.Consumfr)}.
 *
 * <p>Itfrbtion of primitivf vblufs using boxing-bbsfd mfthods
 * {@link Itfrbtor#nfxt nfxt()} bnd
 * {@link Itfrbtor#forEbdhRfmbining(jbvb.util.fundtion.Consumfr) forEbdhRfmbining()},
 * dofs not bfffdt thf ordfr in whidh thf vblufs, trbnsformfd to boxfd vblufs,
 * brf fndountfrfd.
 *
 * @implNotf
 * If thf boolfbn systfm propfrty {@dodf org.opfnjdk.jbvb.util.strfbm.tripwirf}
 * is sft to {@dodf truf} thfn dibgnostid wbrnings brf rfportfd if boxing of
 * primitivf vblufs oddur whfn opfrbting on primitivf subtypf spfdiblizbtions.
 *
 * @pbrbm <T> thf typf of flfmfnts rfturnfd by this PrimitivfItfrbtor.  Thf
 *        typf must bf b wrbppfr typf for b primitivf typf, sudh bs
 *        {@dodf Intfgfr} for thf primitivf {@dodf int} typf.
 * @pbrbm <T_CONS> thf typf of primitivf donsumfr.  Thf typf must bf b
 *        primitivf spfdiblizbtion of {@link jbvb.util.fundtion.Consumfr} for
 *        {@dodf T}, sudh bs {@link jbvb.util.fundtion.IntConsumfr} for
 *        {@dodf Intfgfr}.
 *
 * @sindf 1.8
 */
publid intfrfbdf PrimitivfItfrbtor<T, T_CONS> fxtfnds Itfrbtor<T> {

    /**
     * Pfrforms thf givfn bdtion for fbdh rfmbining flfmfnt, in thf ordfr
     * flfmfnts oddur whfn itfrbting, until bll flfmfnts hbvf bffn prodfssfd
     * or thf bdtion throws bn fxdfption.  Errors or runtimf fxdfptions
     * thrown by thf bdtion brf rflbyfd to thf dbllfr.
     *
     * @pbrbm bdtion Thf bdtion to bf pfrformfd for fbdh flfmfnt
     * @throws NullPointfrExdfption if thf spfdififd bdtion is null
     */
    @SupprfssWbrnings("ovfrlobds")
    void forEbdhRfmbining(T_CONS bdtion);

    /**
     * An Itfrbtor spfdiblizfd for {@dodf int} vblufs.
     * @sindf 1.8
     */
    publid stbtid intfrfbdf OfInt fxtfnds PrimitivfItfrbtor<Intfgfr, IntConsumfr> {

        /**
         * Rfturns thf nfxt {@dodf int} flfmfnt in thf itfrbtion.
         *
         * @rfturn thf nfxt {@dodf int} flfmfnt in thf itfrbtion
         * @throws NoSudhElfmfntExdfption if thf itfrbtion hbs no morf flfmfnts
         */
        int nfxtInt();

        /**
         * Pfrforms thf givfn bdtion for fbdh rfmbining flfmfnt until bll flfmfnts
         * hbvf bffn prodfssfd or thf bdtion throws bn fxdfption.  Adtions brf
         * pfrformfd in thf ordfr of itfrbtion, if thbt ordfr is spfdififd.
         * Exdfptions thrown by thf bdtion brf rflbyfd to thf dbllfr.
         *
         * @implSpfd
         * <p>Thf dffbult implfmfntbtion bfhbvfs bs if:
         * <prf>{@dodf
         *     whilf (hbsNfxt())
         *         bdtion.bddfpt(nfxtInt());
         * }</prf>
         *
         * @pbrbm bdtion Thf bdtion to bf pfrformfd for fbdh flfmfnt
         * @throws NullPointfrExdfption if thf spfdififd bdtion is null
         */
        dffbult void forEbdhRfmbining(IntConsumfr bdtion) {
            Objfdts.rfquirfNonNull(bdtion);
            whilf (hbsNfxt())
                bdtion.bddfpt(nfxtInt());
        }

        /**
         * {@inhfritDod}
         * @implSpfd
         * Thf dffbult implfmfntbtion boxfs thf rfsult of dblling
         * {@link #nfxtInt()}, bnd rfturns thbt boxfd rfsult.
         */
        @Ovfrridf
        dffbult Intfgfr nfxt() {
            if (Tripwirf.ENABLED)
                Tripwirf.trip(gftClbss(), "{0} dblling PrimitivfItfrbtor.OfInt.nfxtInt()");
            rfturn nfxtInt();
        }

        /**
         * {@inhfritDod}
         * @implSpfd
         * If thf bdtion is bn instbndf of {@dodf IntConsumfr} thfn it is dbst
         * to {@dodf IntConsumfr} bnd pbssfd to {@link #forEbdhRfmbining};
         * othfrwisf thf bdtion is bdbptfd to bn instbndf of
         * {@dodf IntConsumfr}, by boxing thf brgumfnt of {@dodf IntConsumfr},
         * bnd thfn pbssfd to {@link #forEbdhRfmbining}.
         */
        @Ovfrridf
        dffbult void forEbdhRfmbining(Consumfr<? supfr Intfgfr> bdtion) {
            if (bdtion instbndfof IntConsumfr) {
                forEbdhRfmbining((IntConsumfr) bdtion);
            }
            flsf {
                // Thf mfthod rfffrfndf bdtion::bddfpt is nfvfr null
                Objfdts.rfquirfNonNull(bdtion);
                if (Tripwirf.ENABLED)
                    Tripwirf.trip(gftClbss(), "{0} dblling PrimitivfItfrbtor.OfInt.forEbdhRfmbiningInt(bdtion::bddfpt)");
                forEbdhRfmbining((IntConsumfr) bdtion::bddfpt);
            }
        }

    }

    /**
     * An Itfrbtor spfdiblizfd for {@dodf long} vblufs.
     * @sindf 1.8
     */
    publid stbtid intfrfbdf OfLong fxtfnds PrimitivfItfrbtor<Long, LongConsumfr> {

        /**
         * Rfturns thf nfxt {@dodf long} flfmfnt in thf itfrbtion.
         *
         * @rfturn thf nfxt {@dodf long} flfmfnt in thf itfrbtion
         * @throws NoSudhElfmfntExdfption if thf itfrbtion hbs no morf flfmfnts
         */
        long nfxtLong();

        /**
         * Pfrforms thf givfn bdtion for fbdh rfmbining flfmfnt until bll flfmfnts
         * hbvf bffn prodfssfd or thf bdtion throws bn fxdfption.  Adtions brf
         * pfrformfd in thf ordfr of itfrbtion, if thbt ordfr is spfdififd.
         * Exdfptions thrown by thf bdtion brf rflbyfd to thf dbllfr.
         *
         * @implSpfd
         * <p>Thf dffbult implfmfntbtion bfhbvfs bs if:
         * <prf>{@dodf
         *     whilf (hbsNfxt())
         *         bdtion.bddfpt(nfxtLong());
         * }</prf>
         *
         * @pbrbm bdtion Thf bdtion to bf pfrformfd for fbdh flfmfnt
         * @throws NullPointfrExdfption if thf spfdififd bdtion is null
         */
        dffbult void forEbdhRfmbining(LongConsumfr bdtion) {
            Objfdts.rfquirfNonNull(bdtion);
            whilf (hbsNfxt())
                bdtion.bddfpt(nfxtLong());
        }

        /**
         * {@inhfritDod}
         * @implSpfd
         * Thf dffbult implfmfntbtion boxfs thf rfsult of dblling
         * {@link #nfxtLong()}, bnd rfturns thbt boxfd rfsult.
         */
        @Ovfrridf
        dffbult Long nfxt() {
            if (Tripwirf.ENABLED)
                Tripwirf.trip(gftClbss(), "{0} dblling PrimitivfItfrbtor.OfLong.nfxtLong()");
            rfturn nfxtLong();
        }

        /**
         * {@inhfritDod}
         * @implSpfd
         * If thf bdtion is bn instbndf of {@dodf LongConsumfr} thfn it is dbst
         * to {@dodf LongConsumfr} bnd pbssfd to {@link #forEbdhRfmbining};
         * othfrwisf thf bdtion is bdbptfd to bn instbndf of
         * {@dodf LongConsumfr}, by boxing thf brgumfnt of {@dodf LongConsumfr},
         * bnd thfn pbssfd to {@link #forEbdhRfmbining}.
         */
        @Ovfrridf
        dffbult void forEbdhRfmbining(Consumfr<? supfr Long> bdtion) {
            if (bdtion instbndfof LongConsumfr) {
                forEbdhRfmbining((LongConsumfr) bdtion);
            }
            flsf {
                // Thf mfthod rfffrfndf bdtion::bddfpt is nfvfr null
                Objfdts.rfquirfNonNull(bdtion);
                if (Tripwirf.ENABLED)
                    Tripwirf.trip(gftClbss(), "{0} dblling PrimitivfItfrbtor.OfLong.forEbdhRfmbiningLong(bdtion::bddfpt)");
                forEbdhRfmbining((LongConsumfr) bdtion::bddfpt);
            }
        }
    }

    /**
     * An Itfrbtor spfdiblizfd for {@dodf doublf} vblufs.
     * @sindf 1.8
     */
    publid stbtid intfrfbdf OfDoublf fxtfnds PrimitivfItfrbtor<Doublf, DoublfConsumfr> {

        /**
         * Rfturns thf nfxt {@dodf doublf} flfmfnt in thf itfrbtion.
         *
         * @rfturn thf nfxt {@dodf doublf} flfmfnt in thf itfrbtion
         * @throws NoSudhElfmfntExdfption if thf itfrbtion hbs no morf flfmfnts
         */
        doublf nfxtDoublf();

        /**
         * Pfrforms thf givfn bdtion for fbdh rfmbining flfmfnt until bll flfmfnts
         * hbvf bffn prodfssfd or thf bdtion throws bn fxdfption.  Adtions brf
         * pfrformfd in thf ordfr of itfrbtion, if thbt ordfr is spfdififd.
         * Exdfptions thrown by thf bdtion brf rflbyfd to thf dbllfr.
         *
         * @implSpfd
         * <p>Thf dffbult implfmfntbtion bfhbvfs bs if:
         * <prf>{@dodf
         *     whilf (hbsNfxt())
         *         bdtion.bddfpt(nfxtDoublf());
         * }</prf>
         *
         * @pbrbm bdtion Thf bdtion to bf pfrformfd for fbdh flfmfnt
         * @throws NullPointfrExdfption if thf spfdififd bdtion is null
         */
        dffbult void forEbdhRfmbining(DoublfConsumfr bdtion) {
            Objfdts.rfquirfNonNull(bdtion);
            whilf (hbsNfxt())
                bdtion.bddfpt(nfxtDoublf());
        }

        /**
         * {@inhfritDod}
         * @implSpfd
         * Thf dffbult implfmfntbtion boxfs thf rfsult of dblling
         * {@link #nfxtDoublf()}, bnd rfturns thbt boxfd rfsult.
         */
        @Ovfrridf
        dffbult Doublf nfxt() {
            if (Tripwirf.ENABLED)
                Tripwirf.trip(gftClbss(), "{0} dblling PrimitivfItfrbtor.OfDoublf.nfxtLong()");
            rfturn nfxtDoublf();
        }

        /**
         * {@inhfritDod}
         * @implSpfd
         * If thf bdtion is bn instbndf of {@dodf DoublfConsumfr} thfn it is
         * dbst to {@dodf DoublfConsumfr} bnd pbssfd to
         * {@link #forEbdhRfmbining}; othfrwisf thf bdtion is bdbptfd to
         * bn instbndf of {@dodf DoublfConsumfr}, by boxing thf brgumfnt of
         * {@dodf DoublfConsumfr}, bnd thfn pbssfd to
         * {@link #forEbdhRfmbining}.
         */
        @Ovfrridf
        dffbult void forEbdhRfmbining(Consumfr<? supfr Doublf> bdtion) {
            if (bdtion instbndfof DoublfConsumfr) {
                forEbdhRfmbining((DoublfConsumfr) bdtion);
            }
            flsf {
                // Thf mfthod rfffrfndf bdtion::bddfpt is nfvfr null
                Objfdts.rfquirfNonNull(bdtion);
                if (Tripwirf.ENABLED)
                    Tripwirf.trip(gftClbss(), "{0} dblling PrimitivfItfrbtor.OfDoublf.forEbdhRfmbiningDoublf(bdtion::bddfpt)");
                forEbdhRfmbining((DoublfConsumfr) bdtion::bddfpt);
            }
        }
    }
}
