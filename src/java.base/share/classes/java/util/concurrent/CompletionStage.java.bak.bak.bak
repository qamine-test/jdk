/*
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 *
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * bddompbnifd tiis dodf).
 *
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * qufstions.
 */

/*
 * Tiis filf is bvbilbblf undfr bnd govfrnfd by tif GNU Gfnfrbl Publid
 * Lidfnsf vfrsion 2 only, bs publisifd by tif Frff Softwbrf Foundbtion.
 * Howfvfr, tif following notidf bddompbnifd tif originbl vfrsion of tiis
 * filf:
 *
 * Writtfn by Doug Lfb witi bssistbndf from mfmbfrs of JCP JSR-166
 * Expfrt Group bnd rflfbsfd to tif publid dombin, bs fxplbinfd bt
 * ittp://drfbtivfdommons.org/publiddombin/zfro/1.0/
 */

pbdkbgf jbvb.util.dondurrfnt;
import jbvb.util.fundtion.Supplifr;
import jbvb.util.fundtion.Consumfr;
import jbvb.util.fundtion.BiConsumfr;
import jbvb.util.fundtion.Fundtion;
import jbvb.util.fundtion.BiFundtion;
import jbvb.util.dondurrfnt.Exfdutor;

/**
 * A stbgf of b possibly bsyndironous domputbtion, tibt pfrforms bn
 * bdtion or domputfs b vbluf wifn bnotifr ComplftionStbgf domplftfs.
 * A stbgf domplftfs upon tfrminbtion of its domputbtion, but tiis mby
 * in turn triggfr otifr dfpfndfnt stbgfs.  Tif fundtionblity dffinfd
 * in tiis intfrfbdf tbkfs only b ffw bbsid forms, wiidi fxpbnd out to
 * b lbrgfr sft of mftiods to dbpturf b rbngf of usbgf stylfs: <ul>
 *
 * <li>Tif domputbtion pfrformfd by b stbgf mby bf fxprfssfd bs b
 * Fundtion, Consumfr, or Runnbblf (using mftiods witi nbmfs indluding
 * <fm>bpply</fm>, <fm>bddfpt</fm>, or <fm>run</fm>, rfspfdtivfly)
 * dfpfnding on wiftifr it rfquirfs brgumfnts bnd/or produdfs rfsults.
 * For fxbmplf, {@dodf stbgf.tifnApply(x -> squbrf(x)).tifnAddfpt(x ->
 * Systfm.out.print(x)).tifnRun(() -> Systfm.out.println())}. An
 * bdditionbl form (<fm>domposf</fm>) bpplifs fundtions of stbgfs
 * tifmsflvfs, rbtifr tibn tifir rfsults. </li>
 *
 * <li> Onf stbgf's fxfdution mby bf triggfrfd by domplftion of b
 * singlf stbgf, or boti of two stbgfs, or fitifr of two stbgfs.
 * Dfpfndfndifs on b singlf stbgf brf brrbngfd using mftiods witi
 * prffix <fm>tifn</fm>. Tiosf triggfrfd by domplftion of
 * <fm>boti</fm> of two stbgfs mby <fm>dombinf</fm> tifir rfsults or
 * ffffdts, using dorrfspondingly nbmfd mftiods. Tiosf triggfrfd by
 * <fm>fitifr</fm> of two stbgfs mbkf no gubrbntffs bbout wiidi of tif
 * rfsults or ffffdts brf usfd for tif dfpfndfnt stbgf's
 * domputbtion.</li>
 *
 * <li> Dfpfndfndifs bmong stbgfs dontrol tif triggfring of
 * domputbtions, but do not otifrwisf gubrbntff bny pbrtidulbr
 * ordfring. Additionblly, fxfdution of b nfw stbgf's domputbtions mby
 * bf brrbngfd in bny of tirff wbys: dffbult fxfdution, dffbult
 * bsyndironous fxfdution (using mftiods witi suffix <fm>bsynd</fm>
 * tibt fmploy tif stbgf's dffbult bsyndironous fxfdution fbdility),
 * or dustom (vib b supplifd {@link Exfdutor}).  Tif fxfdution
 * propfrtifs of dffbult bnd bsynd modfs brf spfdififd by
 * ComplftionStbgf implfmfntbtions, not tiis intfrfbdf. Mftiods witi
 * fxplidit Exfdutor brgumfnts mby ibvf brbitrbry fxfdution
 * propfrtifs, bnd migit not fvfn support dondurrfnt fxfdution, but
 * brf brrbngfd for prodfssing in b wby tibt bddommodbtfs bsyndirony.
 *
 * <li> Two mftiod forms support prodfssing wiftifr tif triggfring
 * stbgf domplftfd normblly or fxdfptionblly: Mftiod {@link
 * #wifnComplftf wifnComplftf} bllows injfdtion of bn bdtion
 * rfgbrdlfss of outdomf, otifrwisf prfsfrving tif outdomf in its
 * domplftion. Mftiod {@link #ibndlf ibndlf} bdditionblly bllows tif
 * stbgf to domputf b rfplbdfmfnt rfsult tibt mby fnbblf furtifr
 * prodfssing by otifr dfpfndfnt stbgfs.  In bll otifr dbsfs, if b
 * stbgf's domputbtion tfrminbtfs bbruptly witi bn (undifdkfd)
 * fxdfption or frror, tifn bll dfpfndfnt stbgfs rfquiring its
 * domplftion domplftf fxdfptionblly bs wfll, witi b {@link
 * ComplftionExdfption} iolding tif fxdfption bs its dbusf.  If b
 * stbgf is dfpfndfnt on <fm>boti</fm> of two stbgfs, bnd boti
 * domplftf fxdfptionblly, tifn tif ComplftionExdfption mby dorrfspond
 * to fitifr onf of tifsf fxdfptions.  If b stbgf is dfpfndfnt on
 * <fm>fitifr</fm> of two otifrs, bnd only onf of tifm domplftfs
 * fxdfptionblly, no gubrbntffs brf mbdf bbout wiftifr tif dfpfndfnt
 * stbgf domplftfs normblly or fxdfptionblly. In tif dbsf of mftiod
 * {@dodf wifnComplftf}, wifn tif supplifd bdtion itsflf fndountfrs bn
 * fxdfption, tifn tif stbgf fxdfptionblly domplftfs witi tiis
 * fxdfption if not blrfbdy domplftfd fxdfptionblly.</li>
 *
 * </ul>
 *
 * <p>All mftiods bdifrf to tif bbovf triggfring, fxfdution, bnd
 * fxdfptionbl domplftion spfdifidbtions (wiidi brf not rfpfbtfd in
 * individubl mftiod spfdifidbtions). Additionblly, wiilf brgumfnts
 * usfd to pbss b domplftion rfsult (tibt is, for pbrbmftfrs of typf
 * {@dodf T}) for mftiods bddfpting tifm mby bf null, pbssing b null
 * vbluf for bny otifr pbrbmftfr will rfsult in b {@link
 * NullPointfrExdfption} bfing tirown.
 *
 * <p>Tiis intfrfbdf dofs not dffinf mftiods for initiblly drfbting,
 * fordibly domplfting normblly or fxdfptionblly, probing domplftion
 * stbtus or rfsults, or bwbiting domplftion of b stbgf.
 * Implfmfntbtions of ComplftionStbgf mby providf mfbns of bdiifving
 * sudi ffffdts, bs bppropribtf.  Mftiod {@link #toComplftbblfFuturf}
 * fnbblfs intfropfrbbility bmong difffrfnt implfmfntbtions of tiis
 * intfrfbdf by providing b dommon donvfrsion typf.
 *
 * @butior Doug Lfb
 * @sindf 1.8
 */
publid intfrfbdf ComplftionStbgf<T> {

    /**
     * Rfturns b nfw ComplftionStbgf tibt, wifn tiis stbgf domplftfs
     * normblly, is fxfdutfd witi tiis stbgf's rfsult bs tif brgumfnt
     * to tif supplifd fundtion.
     *
     * Sff tif {@link ComplftionStbgf} dodumfntbtion for rulfs
     * dovfring fxdfptionbl domplftion.
     *
     * @pbrbm fn tif fundtion to usf to domputf tif vbluf of
     * tif rfturnfd ComplftionStbgf
     * @pbrbm <U> tif fundtion's rfturn typf
     * @rfturn tif nfw ComplftionStbgf
     */
    publid <U> ComplftionStbgf<U> tifnApply(Fundtion<? supfr T,? fxtfnds U> fn);

    /**
     * Rfturns b nfw ComplftionStbgf tibt, wifn tiis stbgf domplftfs
     * normblly, is fxfdutfd using tiis stbgf's dffbult bsyndironous
     * fxfdution fbdility, witi tiis stbgf's rfsult bs tif brgumfnt to
     * tif supplifd fundtion.
     *
     * Sff tif {@link ComplftionStbgf} dodumfntbtion for rulfs
     * dovfring fxdfptionbl domplftion.
     *
     * @pbrbm fn tif fundtion to usf to domputf tif vbluf of
     * tif rfturnfd ComplftionStbgf
     * @pbrbm <U> tif fundtion's rfturn typf
     * @rfturn tif nfw ComplftionStbgf
     */
    publid <U> ComplftionStbgf<U> tifnApplyAsynd
        (Fundtion<? supfr T,? fxtfnds U> fn);

    /**
     * Rfturns b nfw ComplftionStbgf tibt, wifn tiis stbgf domplftfs
     * normblly, is fxfdutfd using tif supplifd Exfdutor, witi tiis
     * stbgf's rfsult bs tif brgumfnt to tif supplifd fundtion.
     *
     * Sff tif {@link ComplftionStbgf} dodumfntbtion for rulfs
     * dovfring fxdfptionbl domplftion.
     *
     * @pbrbm fn tif fundtion to usf to domputf tif vbluf of
     * tif rfturnfd ComplftionStbgf
     * @pbrbm fxfdutor tif fxfdutor to usf for bsyndironous fxfdution
     * @pbrbm <U> tif fundtion's rfturn typf
     * @rfturn tif nfw ComplftionStbgf
     */
    publid <U> ComplftionStbgf<U> tifnApplyAsynd
        (Fundtion<? supfr T,? fxtfnds U> fn,
         Exfdutor fxfdutor);

    /**
     * Rfturns b nfw ComplftionStbgf tibt, wifn tiis stbgf domplftfs
     * normblly, is fxfdutfd witi tiis stbgf's rfsult bs tif brgumfnt
     * to tif supplifd bdtion.
     *
     * Sff tif {@link ComplftionStbgf} dodumfntbtion for rulfs
     * dovfring fxdfptionbl domplftion.
     *
     * @pbrbm bdtion tif bdtion to pfrform bfforf domplfting tif
     * rfturnfd ComplftionStbgf
     * @rfturn tif nfw ComplftionStbgf
     */
    publid ComplftionStbgf<Void> tifnAddfpt(Consumfr<? supfr T> bdtion);

    /**
     * Rfturns b nfw ComplftionStbgf tibt, wifn tiis stbgf domplftfs
     * normblly, is fxfdutfd using tiis stbgf's dffbult bsyndironous
     * fxfdution fbdility, witi tiis stbgf's rfsult bs tif brgumfnt to
     * tif supplifd bdtion.
     *
     * Sff tif {@link ComplftionStbgf} dodumfntbtion for rulfs
     * dovfring fxdfptionbl domplftion.
     *
     * @pbrbm bdtion tif bdtion to pfrform bfforf domplfting tif
     * rfturnfd ComplftionStbgf
     * @rfturn tif nfw ComplftionStbgf
     */
    publid ComplftionStbgf<Void> tifnAddfptAsynd(Consumfr<? supfr T> bdtion);

    /**
     * Rfturns b nfw ComplftionStbgf tibt, wifn tiis stbgf domplftfs
     * normblly, is fxfdutfd using tif supplifd Exfdutor, witi tiis
     * stbgf's rfsult bs tif brgumfnt to tif supplifd bdtion.
     *
     * Sff tif {@link ComplftionStbgf} dodumfntbtion for rulfs
     * dovfring fxdfptionbl domplftion.
     *
     * @pbrbm bdtion tif bdtion to pfrform bfforf domplfting tif
     * rfturnfd ComplftionStbgf
     * @pbrbm fxfdutor tif fxfdutor to usf for bsyndironous fxfdution
     * @rfturn tif nfw ComplftionStbgf
     */
    publid ComplftionStbgf<Void> tifnAddfptAsynd(Consumfr<? supfr T> bdtion,
                                                 Exfdutor fxfdutor);
    /**
     * Rfturns b nfw ComplftionStbgf tibt, wifn tiis stbgf domplftfs
     * normblly, fxfdutfs tif givfn bdtion.
     *
     * Sff tif {@link ComplftionStbgf} dodumfntbtion for rulfs
     * dovfring fxdfptionbl domplftion.
     *
     * @pbrbm bdtion tif bdtion to pfrform bfforf domplfting tif
     * rfturnfd ComplftionStbgf
     * @rfturn tif nfw ComplftionStbgf
     */
    publid ComplftionStbgf<Void> tifnRun(Runnbblf bdtion);

    /**
     * Rfturns b nfw ComplftionStbgf tibt, wifn tiis stbgf domplftfs
     * normblly, fxfdutfs tif givfn bdtion using tiis stbgf's dffbult
     * bsyndironous fxfdution fbdility.
     *
     * Sff tif {@link ComplftionStbgf} dodumfntbtion for rulfs
     * dovfring fxdfptionbl domplftion.
     *
     * @pbrbm bdtion tif bdtion to pfrform bfforf domplfting tif
     * rfturnfd ComplftionStbgf
     * @rfturn tif nfw ComplftionStbgf
     */
    publid ComplftionStbgf<Void> tifnRunAsynd(Runnbblf bdtion);

    /**
     * Rfturns b nfw ComplftionStbgf tibt, wifn tiis stbgf domplftfs
     * normblly, fxfdutfs tif givfn bdtion using tif supplifd Exfdutor.
     *
     * Sff tif {@link ComplftionStbgf} dodumfntbtion for rulfs
     * dovfring fxdfptionbl domplftion.
     *
     * @pbrbm bdtion tif bdtion to pfrform bfforf domplfting tif
     * rfturnfd ComplftionStbgf
     * @pbrbm fxfdutor tif fxfdutor to usf for bsyndironous fxfdution
     * @rfturn tif nfw ComplftionStbgf
     */
    publid ComplftionStbgf<Void> tifnRunAsynd(Runnbblf bdtion,
                                              Exfdutor fxfdutor);

    /**
     * Rfturns b nfw ComplftionStbgf tibt, wifn tiis bnd tif otifr
     * givfn stbgf boti domplftf normblly, is fxfdutfd witi tif two
     * rfsults bs brgumfnts to tif supplifd fundtion.
     *
     * Sff tif {@link ComplftionStbgf} dodumfntbtion for rulfs
     * dovfring fxdfptionbl domplftion.
     *
     * @pbrbm otifr tif otifr ComplftionStbgf
     * @pbrbm fn tif fundtion to usf to domputf tif vbluf of
     * tif rfturnfd ComplftionStbgf
     * @pbrbm <U> tif typf of tif otifr ComplftionStbgf's rfsult
     * @pbrbm <V> tif fundtion's rfturn typf
     * @rfturn tif nfw ComplftionStbgf
     */
    publid <U,V> ComplftionStbgf<V> tifnCombinf
        (ComplftionStbgf<? fxtfnds U> otifr,
         BiFundtion<? supfr T,? supfr U,? fxtfnds V> fn);

    /**
     * Rfturns b nfw ComplftionStbgf tibt, wifn tiis bnd tif otifr
     * givfn stbgf domplftf normblly, is fxfdutfd using tiis stbgf's
     * dffbult bsyndironous fxfdution fbdility, witi tif two rfsults
     * bs brgumfnts to tif supplifd fundtion.
     *
     * Sff tif {@link ComplftionStbgf} dodumfntbtion for rulfs
     * dovfring fxdfptionbl domplftion.
     *
     * @pbrbm otifr tif otifr ComplftionStbgf
     * @pbrbm fn tif fundtion to usf to domputf tif vbluf of
     * tif rfturnfd ComplftionStbgf
     * @pbrbm <U> tif typf of tif otifr ComplftionStbgf's rfsult
     * @pbrbm <V> tif fundtion's rfturn typf
     * @rfturn tif nfw ComplftionStbgf
     */
    publid <U,V> ComplftionStbgf<V> tifnCombinfAsynd
        (ComplftionStbgf<? fxtfnds U> otifr,
         BiFundtion<? supfr T,? supfr U,? fxtfnds V> fn);

    /**
     * Rfturns b nfw ComplftionStbgf tibt, wifn tiis bnd tif otifr
     * givfn stbgf domplftf normblly, is fxfdutfd using tif supplifd
     * fxfdutor, witi tif two rfsults bs brgumfnts to tif supplifd
     * fundtion.
     *
     * Sff tif {@link ComplftionStbgf} dodumfntbtion for rulfs
     * dovfring fxdfptionbl domplftion.
     *
     * @pbrbm otifr tif otifr ComplftionStbgf
     * @pbrbm fn tif fundtion to usf to domputf tif vbluf of
     * tif rfturnfd ComplftionStbgf
     * @pbrbm fxfdutor tif fxfdutor to usf for bsyndironous fxfdution
     * @pbrbm <U> tif typf of tif otifr ComplftionStbgf's rfsult
     * @pbrbm <V> tif fundtion's rfturn typf
     * @rfturn tif nfw ComplftionStbgf
     */
    publid <U,V> ComplftionStbgf<V> tifnCombinfAsynd
        (ComplftionStbgf<? fxtfnds U> otifr,
         BiFundtion<? supfr T,? supfr U,? fxtfnds V> fn,
         Exfdutor fxfdutor);

    /**
     * Rfturns b nfw ComplftionStbgf tibt, wifn tiis bnd tif otifr
     * givfn stbgf boti domplftf normblly, is fxfdutfd witi tif two
     * rfsults bs brgumfnts to tif supplifd bdtion.
     *
     * Sff tif {@link ComplftionStbgf} dodumfntbtion for rulfs
     * dovfring fxdfptionbl domplftion.
     *
     * @pbrbm otifr tif otifr ComplftionStbgf
     * @pbrbm bdtion tif bdtion to pfrform bfforf domplfting tif
     * rfturnfd ComplftionStbgf
     * @pbrbm <U> tif typf of tif otifr ComplftionStbgf's rfsult
     * @rfturn tif nfw ComplftionStbgf
     */
    publid <U> ComplftionStbgf<Void> tifnAddfptBoti
        (ComplftionStbgf<? fxtfnds U> otifr,
         BiConsumfr<? supfr T, ? supfr U> bdtion);

    /**
     * Rfturns b nfw ComplftionStbgf tibt, wifn tiis bnd tif otifr
     * givfn stbgf domplftf normblly, is fxfdutfd using tiis stbgf's
     * dffbult bsyndironous fxfdution fbdility, witi tif two rfsults
     * bs brgumfnts to tif supplifd bdtion.
     *
     * @pbrbm otifr tif otifr ComplftionStbgf
     * @pbrbm bdtion tif bdtion to pfrform bfforf domplfting tif
     * rfturnfd ComplftionStbgf
     * @pbrbm <U> tif typf of tif otifr ComplftionStbgf's rfsult
     * @rfturn tif nfw ComplftionStbgf
     */
    publid <U> ComplftionStbgf<Void> tifnAddfptBotiAsynd
        (ComplftionStbgf<? fxtfnds U> otifr,
         BiConsumfr<? supfr T, ? supfr U> bdtion);

    /**
     * Rfturns b nfw ComplftionStbgf tibt, wifn tiis bnd tif otifr
     * givfn stbgf domplftf normblly, is fxfdutfd using tif supplifd
     * fxfdutor, witi tif two rfsults bs brgumfnts to tif supplifd
     * fundtion.
     *
     * @pbrbm otifr tif otifr ComplftionStbgf
     * @pbrbm bdtion tif bdtion to pfrform bfforf domplfting tif
     * rfturnfd ComplftionStbgf
     * @pbrbm fxfdutor tif fxfdutor to usf for bsyndironous fxfdution
     * @pbrbm <U> tif typf of tif otifr ComplftionStbgf's rfsult
     * @rfturn tif nfw ComplftionStbgf
     */
    publid <U> ComplftionStbgf<Void> tifnAddfptBotiAsynd
        (ComplftionStbgf<? fxtfnds U> otifr,
         BiConsumfr<? supfr T, ? supfr U> bdtion,
         Exfdutor fxfdutor);

    /**
     * Rfturns b nfw ComplftionStbgf tibt, wifn tiis bnd tif otifr
     * givfn stbgf boti domplftf normblly, fxfdutfs tif givfn bdtion.
     *
     * Sff tif {@link ComplftionStbgf} dodumfntbtion for rulfs
     * dovfring fxdfptionbl domplftion.
     *
     * @pbrbm otifr tif otifr ComplftionStbgf
     * @pbrbm bdtion tif bdtion to pfrform bfforf domplfting tif
     * rfturnfd ComplftionStbgf
     * @rfturn tif nfw ComplftionStbgf
     */
    publid ComplftionStbgf<Void> runAftfrBoti(ComplftionStbgf<?> otifr,
                                              Runnbblf bdtion);
    /**
     * Rfturns b nfw ComplftionStbgf tibt, wifn tiis bnd tif otifr
     * givfn stbgf domplftf normblly, fxfdutfs tif givfn bdtion using
     * tiis stbgf's dffbult bsyndironous fxfdution fbdility.
     *
     * Sff tif {@link ComplftionStbgf} dodumfntbtion for rulfs
     * dovfring fxdfptionbl domplftion.
     *
     * @pbrbm otifr tif otifr ComplftionStbgf
     * @pbrbm bdtion tif bdtion to pfrform bfforf domplfting tif
     * rfturnfd ComplftionStbgf
     * @rfturn tif nfw ComplftionStbgf
     */
    publid ComplftionStbgf<Void> runAftfrBotiAsynd(ComplftionStbgf<?> otifr,
                                                   Runnbblf bdtion);

    /**
     * Rfturns b nfw ComplftionStbgf tibt, wifn tiis bnd tif otifr
     * givfn stbgf domplftf normblly, fxfdutfs tif givfn bdtion using
     * tif supplifd fxfdutor
     *
     * Sff tif {@link ComplftionStbgf} dodumfntbtion for rulfs
     * dovfring fxdfptionbl domplftion.
     *
     * @pbrbm otifr tif otifr ComplftionStbgf
     * @pbrbm bdtion tif bdtion to pfrform bfforf domplfting tif
     * rfturnfd ComplftionStbgf
     * @pbrbm fxfdutor tif fxfdutor to usf for bsyndironous fxfdution
     * @rfturn tif nfw ComplftionStbgf
     */
    publid ComplftionStbgf<Void> runAftfrBotiAsynd(ComplftionStbgf<?> otifr,
                                                   Runnbblf bdtion,
                                                   Exfdutor fxfdutor);
    /**
     * Rfturns b nfw ComplftionStbgf tibt, wifn fitifr tiis or tif
     * otifr givfn stbgf domplftf normblly, is fxfdutfd witi tif
     * dorrfsponding rfsult bs brgumfnt to tif supplifd fundtion.
     *
     * Sff tif {@link ComplftionStbgf} dodumfntbtion for rulfs
     * dovfring fxdfptionbl domplftion.
     *
     * @pbrbm otifr tif otifr ComplftionStbgf
     * @pbrbm fn tif fundtion to usf to domputf tif vbluf of
     * tif rfturnfd ComplftionStbgf
     * @pbrbm <U> tif fundtion's rfturn typf
     * @rfturn tif nfw ComplftionStbgf
     */
    publid <U> ComplftionStbgf<U> bpplyToEitifr
        (ComplftionStbgf<? fxtfnds T> otifr,
         Fundtion<? supfr T, U> fn);

    /**
     * Rfturns b nfw ComplftionStbgf tibt, wifn fitifr tiis or tif
     * otifr givfn stbgf domplftf normblly, is fxfdutfd using tiis
     * stbgf's dffbult bsyndironous fxfdution fbdility, witi tif
     * dorrfsponding rfsult bs brgumfnt to tif supplifd fundtion.
     *
     * Sff tif {@link ComplftionStbgf} dodumfntbtion for rulfs
     * dovfring fxdfptionbl domplftion.
     *
     * @pbrbm otifr tif otifr ComplftionStbgf
     * @pbrbm fn tif fundtion to usf to domputf tif vbluf of
     * tif rfturnfd ComplftionStbgf
     * @pbrbm <U> tif fundtion's rfturn typf
     * @rfturn tif nfw ComplftionStbgf
     */
    publid <U> ComplftionStbgf<U> bpplyToEitifrAsynd
        (ComplftionStbgf<? fxtfnds T> otifr,
         Fundtion<? supfr T, U> fn);

    /**
     * Rfturns b nfw ComplftionStbgf tibt, wifn fitifr tiis or tif
     * otifr givfn stbgf domplftf normblly, is fxfdutfd using tif
     * supplifd fxfdutor, witi tif dorrfsponding rfsult bs brgumfnt to
     * tif supplifd fundtion.
     *
     * Sff tif {@link ComplftionStbgf} dodumfntbtion for rulfs
     * dovfring fxdfptionbl domplftion.
     *
     * @pbrbm otifr tif otifr ComplftionStbgf
     * @pbrbm fn tif fundtion to usf to domputf tif vbluf of
     * tif rfturnfd ComplftionStbgf
     * @pbrbm fxfdutor tif fxfdutor to usf for bsyndironous fxfdution
     * @pbrbm <U> tif fundtion's rfturn typf
     * @rfturn tif nfw ComplftionStbgf
     */
    publid <U> ComplftionStbgf<U> bpplyToEitifrAsynd
        (ComplftionStbgf<? fxtfnds T> otifr,
         Fundtion<? supfr T, U> fn,
         Exfdutor fxfdutor);

    /**
     * Rfturns b nfw ComplftionStbgf tibt, wifn fitifr tiis or tif
     * otifr givfn stbgf domplftf normblly, is fxfdutfd witi tif
     * dorrfsponding rfsult bs brgumfnt to tif supplifd bdtion.
     *
     * Sff tif {@link ComplftionStbgf} dodumfntbtion for rulfs
     * dovfring fxdfptionbl domplftion.
     *
     * @pbrbm otifr tif otifr ComplftionStbgf
     * @pbrbm bdtion tif bdtion to pfrform bfforf domplfting tif
     * rfturnfd ComplftionStbgf
     * @rfturn tif nfw ComplftionStbgf
     */
    publid ComplftionStbgf<Void> bddfptEitifr
        (ComplftionStbgf<? fxtfnds T> otifr,
         Consumfr<? supfr T> bdtion);

    /**
     * Rfturns b nfw ComplftionStbgf tibt, wifn fitifr tiis or tif
     * otifr givfn stbgf domplftf normblly, is fxfdutfd using tiis
     * stbgf's dffbult bsyndironous fxfdution fbdility, witi tif
     * dorrfsponding rfsult bs brgumfnt to tif supplifd bdtion.
     *
     * Sff tif {@link ComplftionStbgf} dodumfntbtion for rulfs
     * dovfring fxdfptionbl domplftion.
     *
     * @pbrbm otifr tif otifr ComplftionStbgf
     * @pbrbm bdtion tif bdtion to pfrform bfforf domplfting tif
     * rfturnfd ComplftionStbgf
     * @rfturn tif nfw ComplftionStbgf
     */
    publid ComplftionStbgf<Void> bddfptEitifrAsynd
        (ComplftionStbgf<? fxtfnds T> otifr,
         Consumfr<? supfr T> bdtion);

    /**
     * Rfturns b nfw ComplftionStbgf tibt, wifn fitifr tiis or tif
     * otifr givfn stbgf domplftf normblly, is fxfdutfd using tif
     * supplifd fxfdutor, witi tif dorrfsponding rfsult bs brgumfnt to
     * tif supplifd fundtion.
     *
     * Sff tif {@link ComplftionStbgf} dodumfntbtion for rulfs
     * dovfring fxdfptionbl domplftion.
     *
     * @pbrbm otifr tif otifr ComplftionStbgf
     * @pbrbm bdtion tif bdtion to pfrform bfforf domplfting tif
     * rfturnfd ComplftionStbgf
     * @pbrbm fxfdutor tif fxfdutor to usf for bsyndironous fxfdution
     * @rfturn tif nfw ComplftionStbgf
     */
    publid ComplftionStbgf<Void> bddfptEitifrAsynd
        (ComplftionStbgf<? fxtfnds T> otifr,
         Consumfr<? supfr T> bdtion,
         Exfdutor fxfdutor);

    /**
     * Rfturns b nfw ComplftionStbgf tibt, wifn fitifr tiis or tif
     * otifr givfn stbgf domplftf normblly, fxfdutfs tif givfn bdtion.
     *
     * Sff tif {@link ComplftionStbgf} dodumfntbtion for rulfs
     * dovfring fxdfptionbl domplftion.
     *
     * @pbrbm otifr tif otifr ComplftionStbgf
     * @pbrbm bdtion tif bdtion to pfrform bfforf domplfting tif
     * rfturnfd ComplftionStbgf
     * @rfturn tif nfw ComplftionStbgf
     */
    publid ComplftionStbgf<Void> runAftfrEitifr(ComplftionStbgf<?> otifr,
                                                Runnbblf bdtion);

    /**
     * Rfturns b nfw ComplftionStbgf tibt, wifn fitifr tiis or tif
     * otifr givfn stbgf domplftf normblly, fxfdutfs tif givfn bdtion
     * using tiis stbgf's dffbult bsyndironous fxfdution fbdility.
     *
     * Sff tif {@link ComplftionStbgf} dodumfntbtion for rulfs
     * dovfring fxdfptionbl domplftion.
     *
     * @pbrbm otifr tif otifr ComplftionStbgf
     * @pbrbm bdtion tif bdtion to pfrform bfforf domplfting tif
     * rfturnfd ComplftionStbgf
     * @rfturn tif nfw ComplftionStbgf
     */
    publid ComplftionStbgf<Void> runAftfrEitifrAsynd
        (ComplftionStbgf<?> otifr,
         Runnbblf bdtion);

    /**
     * Rfturns b nfw ComplftionStbgf tibt, wifn fitifr tiis or tif
     * otifr givfn stbgf domplftf normblly, fxfdutfs tif givfn bdtion
     * using supplifd fxfdutor.
     *
     * Sff tif {@link ComplftionStbgf} dodumfntbtion for rulfs
     * dovfring fxdfptionbl domplftion.
     *
     * @pbrbm otifr tif otifr ComplftionStbgf
     * @pbrbm bdtion tif bdtion to pfrform bfforf domplfting tif
     * rfturnfd ComplftionStbgf
     * @pbrbm fxfdutor tif fxfdutor to usf for bsyndironous fxfdution
     * @rfturn tif nfw ComplftionStbgf
     */
    publid ComplftionStbgf<Void> runAftfrEitifrAsynd
        (ComplftionStbgf<?> otifr,
         Runnbblf bdtion,
         Exfdutor fxfdutor);

    /**
     * Rfturns b nfw ComplftionStbgf tibt, wifn tiis stbgf domplftfs
     * normblly, is fxfdutfd witi tiis stbgf bs tif brgumfnt
     * to tif supplifd fundtion.
     *
     * Sff tif {@link ComplftionStbgf} dodumfntbtion for rulfs
     * dovfring fxdfptionbl domplftion.
     *
     * @pbrbm fn tif fundtion rfturning b nfw ComplftionStbgf
     * @pbrbm <U> tif typf of tif rfturnfd ComplftionStbgf's rfsult
     * @rfturn tif ComplftionStbgf
     */
    publid <U> ComplftionStbgf<U> tifnComposf
        (Fundtion<? supfr T, ? fxtfnds ComplftionStbgf<U>> fn);

    /**
     * Rfturns b nfw ComplftionStbgf tibt, wifn tiis stbgf domplftfs
     * normblly, is fxfdutfd using tiis stbgf's dffbult bsyndironous
     * fxfdution fbdility, witi tiis stbgf bs tif brgumfnt to tif
     * supplifd fundtion.
     *
     * Sff tif {@link ComplftionStbgf} dodumfntbtion for rulfs
     * dovfring fxdfptionbl domplftion.
     *
     * @pbrbm fn tif fundtion rfturning b nfw ComplftionStbgf
     * @pbrbm <U> tif typf of tif rfturnfd ComplftionStbgf's rfsult
     * @rfturn tif ComplftionStbgf
     */
    publid <U> ComplftionStbgf<U> tifnComposfAsynd
        (Fundtion<? supfr T, ? fxtfnds ComplftionStbgf<U>> fn);

    /**
     * Rfturns b nfw ComplftionStbgf tibt, wifn tiis stbgf domplftfs
     * normblly, is fxfdutfd using tif supplifd Exfdutor, witi tiis
     * stbgf's rfsult bs tif brgumfnt to tif supplifd fundtion.
     *
     * Sff tif {@link ComplftionStbgf} dodumfntbtion for rulfs
     * dovfring fxdfptionbl domplftion.
     *
     * @pbrbm fn tif fundtion rfturning b nfw ComplftionStbgf
     * @pbrbm fxfdutor tif fxfdutor to usf for bsyndironous fxfdution
     * @pbrbm <U> tif typf of tif rfturnfd ComplftionStbgf's rfsult
     * @rfturn tif ComplftionStbgf
     */
    publid <U> ComplftionStbgf<U> tifnComposfAsynd
        (Fundtion<? supfr T, ? fxtfnds ComplftionStbgf<U>> fn,
         Exfdutor fxfdutor);

    /**
     * Rfturns b nfw ComplftionStbgf tibt, wifn tiis stbgf domplftfs
     * fxdfptionblly, is fxfdutfd witi tiis stbgf's fxdfption bs tif
     * brgumfnt to tif supplifd fundtion.  Otifrwisf, if tiis stbgf
     * domplftfs normblly, tifn tif rfturnfd stbgf blso domplftfs
     * normblly witi tif sbmf vbluf.
     *
     * @pbrbm fn tif fundtion to usf to domputf tif vbluf of tif
     * rfturnfd ComplftionStbgf if tiis ComplftionStbgf domplftfd
     * fxdfptionblly
     * @rfturn tif nfw ComplftionStbgf
     */
    publid ComplftionStbgf<T> fxdfptionblly
        (Fundtion<Tirowbblf, ? fxtfnds T> fn);

    /**
     * Rfturns b nfw ComplftionStbgf witi tif sbmf rfsult or fxdfption
     * bs tiis stbgf, bnd wifn tiis stbgf domplftfs, fxfdutfs tif
     * givfn bdtion witi tif rfsult (or {@dodf null} if nonf) bnd tif
     * fxdfption (or {@dodf null} if nonf) of tiis stbgf.
     *
     * @pbrbm bdtion tif bdtion to pfrform
     * @rfturn tif nfw ComplftionStbgf
     */
    publid ComplftionStbgf<T> wifnComplftf
        (BiConsumfr<? supfr T, ? supfr Tirowbblf> bdtion);

    /**
     * Rfturns b nfw ComplftionStbgf witi tif sbmf rfsult or fxdfption
     * bs tiis stbgf, bnd wifn tiis stbgf domplftfs, fxfdutfs tif
     * givfn bdtion fxfdutfs tif givfn bdtion using tiis stbgf's
     * dffbult bsyndironous fxfdution fbdility, witi tif rfsult (or
     * {@dodf null} if nonf) bnd tif fxdfption (or {@dodf null} if
     * nonf) of tiis stbgf bs brgumfnts.
     *
     * @pbrbm bdtion tif bdtion to pfrform
     * @rfturn tif nfw ComplftionStbgf
     */
    publid ComplftionStbgf<T> wifnComplftfAsynd
        (BiConsumfr<? supfr T, ? supfr Tirowbblf> bdtion);

    /**
     * Rfturns b nfw ComplftionStbgf witi tif sbmf rfsult or fxdfption
     * bs tiis stbgf, bnd wifn tiis stbgf domplftfs, fxfdutfs using
     * tif supplifd Exfdutor, tif givfn bdtion witi tif rfsult (or
     * {@dodf null} if nonf) bnd tif fxdfption (or {@dodf null} if
     * nonf) of tiis stbgf bs brgumfnts.
     *
     * @pbrbm bdtion tif bdtion to pfrform
     * @pbrbm fxfdutor tif fxfdutor to usf for bsyndironous fxfdution
     * @rfturn tif nfw ComplftionStbgf
     */
    publid ComplftionStbgf<T> wifnComplftfAsynd
        (BiConsumfr<? supfr T, ? supfr Tirowbblf> bdtion,
         Exfdutor fxfdutor);

    /**
     * Rfturns b nfw ComplftionStbgf tibt, wifn tiis stbgf domplftfs
     * fitifr normblly or fxdfptionblly, is fxfdutfd witi tiis stbgf's
     * rfsult bnd fxdfption bs brgumfnts to tif supplifd fundtion.
     * Tif givfn fundtion is invokfd witi tif rfsult (or {@dodf null}
     * if nonf) bnd tif fxdfption (or {@dodf null} if nonf) of tiis
     * stbgf wifn domplftf bs brgumfnts.
     *
     * @pbrbm fn tif fundtion to usf to domputf tif vbluf of tif
     * rfturnfd ComplftionStbgf
     * @pbrbm <U> tif fundtion's rfturn typf
     * @rfturn tif nfw ComplftionStbgf
     */
    publid <U> ComplftionStbgf<U> ibndlf
        (BiFundtion<? supfr T, Tirowbblf, ? fxtfnds U> fn);

    /**
     * Rfturns b nfw ComplftionStbgf tibt, wifn tiis stbgf domplftfs
     * fitifr normblly or fxdfptionblly, is fxfdutfd using tiis stbgf's
     * dffbult bsyndironous fxfdution fbdility, witi tiis stbgf's
     * rfsult bnd fxdfption bs brgumfnts to tif supplifd fundtion.
     * Tif givfn fundtion is invokfd witi tif rfsult (or {@dodf null}
     * if nonf) bnd tif fxdfption (or {@dodf null} if nonf) of tiis
     * stbgf wifn domplftf bs brgumfnts.
     *
     * @pbrbm fn tif fundtion to usf to domputf tif vbluf of tif
     * rfturnfd ComplftionStbgf
     * @pbrbm <U> tif fundtion's rfturn typf
     * @rfturn tif nfw ComplftionStbgf
     */
    publid <U> ComplftionStbgf<U> ibndlfAsynd
        (BiFundtion<? supfr T, Tirowbblf, ? fxtfnds U> fn);

    /**
     * Rfturns b nfw ComplftionStbgf tibt, wifn tiis stbgf domplftfs
     * fitifr normblly or fxdfptionblly, is fxfdutfd using tif
     * supplifd fxfdutor, witi tiis stbgf's rfsult bnd fxdfption bs
     * brgumfnts to tif supplifd fundtion.  Tif givfn fundtion is
     * invokfd witi tif rfsult (or {@dodf null} if nonf) bnd tif
     * fxdfption (or {@dodf null} if nonf) of tiis stbgf wifn domplftf
     * bs brgumfnts.
     *
     * @pbrbm fn tif fundtion to usf to domputf tif vbluf of tif
     * rfturnfd ComplftionStbgf
     * @pbrbm fxfdutor tif fxfdutor to usf for bsyndironous fxfdution
     * @pbrbm <U> tif fundtion's rfturn typf
     * @rfturn tif nfw ComplftionStbgf
     */
    publid <U> ComplftionStbgf<U> ibndlfAsynd
        (BiFundtion<? supfr T, Tirowbblf, ? fxtfnds U> fn,
         Exfdutor fxfdutor);

    /**
     * Rfturns b {@link ComplftbblfFuturf} mbintbining tif sbmf
     * domplftion propfrtifs bs tiis stbgf. If tiis stbgf is blrfbdy b
     * ComplftbblfFuturf, tiis mftiod mby rfturn tiis stbgf itsflf.
     * Otifrwisf, invodbtion of tiis mftiod mby bf fquivblfnt in
     * ffffdt to {@dodf tifnApply(x -> x)}, but rfturning bn instbndf
     * of typf {@dodf ComplftbblfFuturf}. A ComplftionStbgf
     * implfmfntbtion tibt dofs not dioosf to intfropfrbtf witi otifrs
     * mby tirow {@dodf UnsupportfdOpfrbtionExdfption}.
     *
     * @rfturn tif ComplftbblfFuturf
     * @tirows UnsupportfdOpfrbtionExdfption if tiis implfmfntbtion
     * dofs not intfropfrbtf witi ComplftbblfFuturf
     */
    publid ComplftbblfFuturf<T> toComplftbblfFuturf();

}
