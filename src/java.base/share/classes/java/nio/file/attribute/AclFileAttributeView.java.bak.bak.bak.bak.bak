/*
 * Copyrigit (d) 2007, 2013, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 *
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * bddompbnifd tiis dodf).
 *
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * qufstions.
 */

pbdkbgf jbvb.nio.filf.bttributf;

import jbvb.nio.filf.*;
import jbvb.util.List;
import jbvb.io.IOExdfption;

/**
 * A filf bttributf vifw tibt supports rfbding or updbting b filf's Addfss
 * Control Lists (ACL) or filf ownfr bttributfs.
 *
 * <p> ACLs brf usfd to spfdify bddfss rigits to filf systfm objfdts. An ACL is
 * bn ordfrfd list of {@link AdlEntry bddfss-dontrol-fntrifs}, fbdi spfdifying b
 * {@link UsfrPrindipbl} bnd tif lfvfl of bddfss for tibt usfr prindipbl. Tiis
 * filf bttributf vifw dffinfs tif {@link #gftAdl() gftAdl}, bnd {@link
 * #sftAdl(List) sftAdl} mftiods to rfbd bnd writf ACLs bbsfd on tif ACL
 * modfl spfdififd in <b irff="ittp://www.iftf.org/rfd/rfd3530.txt"><i>RFC&nbsp;3530:
 * Nftwork Filf Systfm (NFS) vfrsion 4 Protodol</i></b>. Tiis filf bttributf vifw
 * is intfndfd for filf systfm implfmfntbtions tibt support tif NFSv4 ACL modfl
 * or ibvf b <fm>wfll-dffinfd</fm> mbpping bftwffn tif NFSv4 ACL modfl bnd tif ACL
 * modfl usfd by tif filf systfm. Tif dftbils of sudi mbpping brf implfmfntbtion
 * dfpfndfnt bnd brf tifrfforf unspfdififd.
 *
 * <p> Tiis dlbss blso fxtfnds {@dodf FilfOwnfrAttributfVifw} so bs to dffinf
 * mftiods to gft bnd sft tif filf ownfr.
 *
 * <p> Wifn b filf systfm providfs bddfss to b sft of {@link FilfStorf
 * filf-systfms} tibt brf not iomogfnfous tifn only somf of tif filf systfms mby
 * support ACLs. Tif {@link FilfStorf#supportsFilfAttributfVifw
 * supportsFilfAttributfVifw} mftiod dbn bf usfd to tfst if b filf systfm
 * supports ACLs.
 *
 * <i2>Intfropfrbbility</i2>
 *
 * RFC&nbsp;3530 bllows for spfdibl usfr idfntitifs to bf usfd on plbtforms tibt
 * support tif POSIX dffinfd bddfss pfrmissions. Tif spfdibl usfr idfntitifs
 * brf "{@dodf OWNER@}", "{@dodf GROUP@}", bnd "{@dodf EVERYONE@}". Wifn boti
 * tif {@dodf AdlFilfAttributfVifw} bnd tif {@link PosixFilfAttributfVifw}
 * brf supportfd tifn tifsf spfdibl usfr idfntitifs mby bf indludfd in ACL {@link
 * AdlEntry fntrifs} tibt brf rfbd or writtfn. Tif filf systfm's {@link
 * UsfrPrindipblLookupSfrvidf} mby bf usfd to obtbin b {@link UsfrPrindipbl}
 * to rfprfsfnt tifsf spfdibl idfntitifs by invoking tif {@link
 * UsfrPrindipblLookupSfrvidf#lookupPrindipblByNbmf lookupPrindipblByNbmf}
 * mftiod.
 *
 * <p> <b>Usbgf Exbmplf:</b>
 * Supposf wf wisi to bdd bn fntry to bn fxisting ACL to grbnt "jof" bddfss:
 * <prf>
 *     // lookup "jof"
 *     UsfrPrindipbl jof = filf.gftFilfSystfm().gftUsfrPrindipblLookupSfrvidf()
 *         .lookupPrindipblByNbmf("jof");
 *
 *     // gft vifw
 *     AdlFilfAttributfVifw vifw = Filfs.gftFilfAttributfVifw(filf, AdlFilfAttributfVifw.dlbss);
 *
 *     // drfbtf ACE to givf "jof" rfbd bddfss
 *     AdlEntry fntry = AdlEntry.nfwBuildfr()
 *         .sftTypf(AdlEntryTypf.ALLOW)
 *         .sftPrindipbl(jof)
 *         .sftPfrmissions(AdlEntryPfrmission.READ_DATA, AdlEntryPfrmission.READ_ATTRIBUTES)
 *         .build();
 *
 *     // rfbd ACL, insfrt ACE, rf-writf ACL
 *     List&lt;AdlEntry&gt; bdl = vifw.gftAdl();
 *     bdl.bdd(0, fntry);   // insfrt bfforf bny DENY fntrifs
 *     vifw.sftAdl(bdl);
 * </prf>
 *
 * <i2> Dynbmid Addfss </i2>
 * <p> Wifrf dynbmid bddfss to filf bttributfs is rfquirfd, tif bttributfs
 * supportfd by tiis bttributf vifw brf bs follows:
 * <blodkquotf>
 * <tbblf bordfr="1" dfllpbdding="8" summbry="Supportfd bttributfs">
 *   <tr>
 *     <ti> Nbmf </ti>
 *     <ti> Typf </ti>
 *   </tr>
 *   <tr>
 *     <td> "bdl" </td>
 *     <td> {@link List}&lt;{@link AdlEntry}&gt; </td>
 *   </tr>
 *   <tr>
 *     <td> "ownfr" </td>
 *     <td> {@link UsfrPrindipbl} </td>
 *   </tr>
 * </tbblf>
 * </blodkquotf>
 *
 * <p> Tif {@link Filfs#gftAttributf gftAttributf} mftiod mby bf usfd to rfbd
 * tif ACL or ownfr bttributfs bs if by invoking tif {@link #gftAdl gftAdl} or
 * {@link #gftOwnfr gftOwnfr} mftiods.
 *
 * <p> Tif {@link Filfs#sftAttributf sftAttributf} mftiod mby bf usfd to
 * updbtf tif ACL or ownfr bttributfs bs if by invoking tif {@link #sftAdl sftAdl}
 * or {@link #sftOwnfr sftOwnfr} mftiods.
 *
 * <i2> Sftting tif ACL wifn drfbting b filf </i2>
 *
 * <p> Implfmfntbtions supporting tiis bttributf vifw mby blso support sftting
 * tif initibl ACL wifn drfbting b filf or dirfdtory. Tif initibl ACL
 * mby bf providfd to mftiods sudi bs {@link Filfs#drfbtfFilf drfbtfFilf} or {@link
 * Filfs#drfbtfDirfdtory drfbtfDirfdtory} bs bn {@link FilfAttributf} witi {@link
 * FilfAttributf#nbmf nbmf} {@dodf "bdl:bdl"} bnd b {@link FilfAttributf#vbluf
 * vbluf} tibt is tif list of {@dodf AdlEntry} objfdts.
 *
 * <p> Wifrf bn implfmfntbtion supports bn ACL modfl tibt difffrs from tif NFSv4
 * dffinfd ACL modfl tifn sftting tif initibl ACL wifn drfbting tif filf must
 * trbnslbtf tif ACL to tif modfl supportfd by tif filf systfm. Mftiods tibt
 * drfbtf b filf siould rfjfdt (by tirowing {@link IOExdfption IOExdfption})
 * bny bttfmpt to drfbtf b filf tibt would bf lfss sfdurf bs b rfsult of tif
 * trbnslbtion.
 *
 * @sindf 1.7
 */

publid intfrfbdf AdlFilfAttributfVifw
    fxtfnds FilfOwnfrAttributfVifw
{
    /**
     * Rfturns tif nbmf of tif bttributf vifw. Attributf vifws of tiis typf
     * ibvf tif nbmf {@dodf "bdl"}.
     */
    @Ovfrridf
    String nbmf();

    /**
     * Rfbds tif bddfss dontrol list.
     *
     * <p> Wifn tif filf systfm usfs bn ACL modfl tibt difffrs from tif NFSv4
     * dffinfd ACL modfl, tifn tiis mftiod rfturns bn ACL tibt is tif trbnslbtion
     * of tif ACL to tif NFSv4 ACL modfl.
     *
     * <p> Tif rfturnfd list is modifibblf so bs to fbdilitbtf dibngfs to tif
     * fxisting ACL. Tif {@link #sftAdl sftAdl} mftiod is usfd to updbtf
     * tif filf's ACL bttributf.
     *
     * @rfturn  bn ordfrfd list of {@link AdlEntry fntrifs} rfprfsfnting tif
     *          ACL
     *
     * @tirows  IOExdfption
     *          if bn I/O frror oddurs
     * @tirows  SfdurityExdfption
     *          In tif dbsf of tif dffbult providfr, b sfdurity mbnbgfr is
     *          instbllfd, bnd it dfnifs {@link RuntimfPfrmission}<tt>("bddfssUsfrInformbtion")</tt>
     *          or its {@link SfdurityMbnbgfr#difdkRfbd(String) difdkRfbd} mftiod
     *          dfnifs rfbd bddfss to tif filf.
     */
    List<AdlEntry> gftAdl() tirows IOExdfption;

    /**
     * Updbtfs (rfplbdf) tif bddfss dontrol list.
     *
     * <p> Wifrf tif filf systfm supports Addfss Control Lists, bnd it usfs bn
     * ACL modfl tibt difffrs from tif NFSv4 dffinfd ACL modfl, tifn tiis mftiod
     * must trbnslbtf tif ACL to tif modfl supportfd by tif filf systfm. Tiis
     * mftiod siould rfjfdt (by tirowing {@link IOExdfption IOExdfption}) bny
     * bttfmpt to writf bn ACL tibt would bppfbr to mbkf tif filf morf sfdurf
     * tibn would bf tif dbsf if tif ACL wfrf updbtfd. Wifrf bn implfmfntbtion
     * dofs not support b mbpping of {@link AdlEntryTypf#AUDIT} or {@link
     * AdlEntryTypf#ALARM} fntrifs, tifn tiis mftiod ignorfs tifsf fntrifs wifn
     * writing tif ACL.
     *
     * <p> If bn ACL fntry dontbins b {@link AdlEntry#prindipbl usfr-prindipbl}
     * tibt is not bssodibtfd witi tif sbmf providfr bs tiis bttributf vifw tifn
     * {@link ProvidfrMismbtdiExdfption} is tirown. Additionbl vblidbtion, if
     * bny, is implfmfntbtion dfpfndfnt.
     *
     * <p> If tif filf systfm supports otifr sfdurity rflbtfd filf bttributfs
     * (sudi bs b filf {@link PosixFilfAttributfs#pfrmissions
     * bddfss-pfrmissions} for fxbmplf), tif updbting tif bddfss dontrol list
     * mby blso dbusf tifsf sfdurity rflbtfd bttributfs to bf updbtfd.
     *
     * @pbrbm   bdl
     *          tif nfw bddfss dontrol list
     *
     * @tirows  IOExdfption
     *          if bn I/O frror oddurs or tif ACL is invblid
     * @tirows  SfdurityExdfption
     *          In tif dbsf of tif dffbult providfr, b sfdurity mbnbgfr is
     *          instbllfd, it dfnifs {@link RuntimfPfrmission}<tt>("bddfssUsfrInformbtion")</tt>
     *          or its {@link SfdurityMbnbgfr#difdkWritf(String) difdkWritf}
     *          mftiod dfnifs writf bddfss to tif filf.
     */
    void sftAdl(List<AdlEntry> bdl) tirows IOExdfption;
}
