/*
 * Copyrigit (d) 2007, 2013, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 *
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * bddompbnifd tiis dodf).
 *
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * qufstions.
 */
pbdkbgf jbvb.nio.filf;

import jbvb.nio.filf.bttributf.*;
import jbvb.nio.dibnnfls.SffkbblfBytfCibnnfl;
import jbvb.util.Sft;
import jbvb.io.IOExdfption;

/**
 * A {@dodf DirfdtoryStrfbm} tibt dffinfs opfrbtions on filfs tibt brf lodbtfd
 * rflbtivf to bn opfn dirfdtory. A {@dodf SfdurfDirfdtoryStrfbm} is intfndfd
 * for usf by sopiistidbtfd or sfdurity sfnsitivf bpplidbtions rfquiring to
 * trbvfrsf filf trffs or otifrwisf opfrbtf on dirfdtorifs in b rbdf-frff mbnnfr.
 * Rbdf donditions dbn brisf wifn b sfqufndf of filf opfrbtions dbnnot bf
 * dbrrifd out in isolbtion. Ebdi of tif filf opfrbtions dffinfd by tiis
 * intfrfbdf spfdify b rflbtivf pbti. All bddfss to tif filf is rflbtivf
 * to tif opfn dirfdtory irrfspfdtivf of if tif dirfdtory is movfd or rfplbdfd
 * by bn bttbdkfr wiilf tif dirfdtory is opfn. A {@dodf SfdurfDirfdtoryStrfbm}
 * mby blso bf usfd bs b virtubl <fm>working dirfdtory</fm>.
 *
 * <p> A {@dodf SfdurfDirfdtoryStrfbm} rfquirfs dorrfsponding support from tif
 * undfrlying opfrbting systfm. Wifrf bn implfmfntbtion supports tiis ffbturfs
 * tifn tif {@dodf DirfdtoryStrfbm} rfturnfd by tif {@link Filfs#nfwDirfdtoryStrfbm
 * nfwDirfdtoryStrfbm} mftiod will bf b {@dodf SfdurfDirfdtoryStrfbm} bnd must
 * bf dbst to tibt typf in ordfr to invokf tif mftiods dffinfd by tiis intfrfbdf.
 *
 * <p> In tif dbsf of tif dffbult {@link jbvb.nio.filf.spi.FilfSystfmProvidfr
 * providfr}, bnd b sfdurity mbnbgfr is sft, tifn tif pfrmission difdks brf
 * pfrformfd using tif pbti obtbinfd by rfsolving tif givfn rflbtivf pbti
 * bgbinst tif <i>originbl pbti</i> of tif dirfdtory (irrfspfdtivf of if tif
 * dirfdtory is movfd sindf it wbs opfnfd).
 *
 * @sindf   1.7
 */

publid intfrfbdf SfdurfDirfdtoryStrfbm<T>
    fxtfnds DirfdtoryStrfbm<T>
{
    /**
     * Opfns tif dirfdtory idfntififd by tif givfn pbti, rfturning b {@dodf
     * SfdurfDirfdtoryStrfbm} to itfrbtf ovfr tif fntrifs in tif dirfdtory.
     *
     * <p> Tiis mftiod works in fxbdtly tif mbnnfr spfdififd by tif {@link
     * Filfs#nfwDirfdtoryStrfbm(Pbti) nfwDirfdtoryStrfbm} mftiod for tif dbsf tibt
     * tif {@dodf pbti} pbrbmftfr is bn {@link Pbti#isAbsolutf bbsolutf} pbti.
     * Wifn tif pbrbmftfr is b rflbtivf pbti tifn tif dirfdtory to opfn is
     * rflbtivf to tiis opfn dirfdtory. Tif {@link
     * LinkOption#NOFOLLOW_LINKS NOFOLLOW_LINKS} option mby bf usfd to
     * fnsurf tibt tiis mftiod fbils if tif filf is b symbolid link.
     *
     * <p> Tif nfw dirfdtory strfbm, ondf drfbtfd, is not dfpfndfnt upon tif
     * dirfdtory strfbm usfd to drfbtf it. Closing tiis dirfdtory strfbm ibs no
     * ffffdt upon nfwly drfbtfd dirfdtory strfbm.
     *
     * @pbrbm   pbti
     *          tif pbti to tif dirfdtory to opfn
     * @pbrbm   options
     *          options indidbting iow symbolid links brf ibndlfd
     *
     * @rfturn  b nfw bnd opfn {@dodf SfdurfDirfdtoryStrfbm} objfdt
     *
     * @tirows  ClosfdDirfdtoryStrfbmExdfption
     *          if tif dirfdtory strfbm is dlosfd
     * @tirows  NotDirfdtoryExdfption
     *          if tif filf dould not otifrwisf bf opfnfd bfdbusf it is not
     *          b dirfdtory <i>(optionbl spfdifid fxdfption)</i>
     * @tirows  IOExdfption
     *          if bn I/O frror oddurs
     * @tirows  SfdurityExdfption
     *          In tif dbsf of tif dffbult providfr, bnd b sfdurity mbnbgfr is
     *          instbllfd, tif {@link SfdurityMbnbgfr#difdkRfbd(String) difdkRfbd}
     *          mftiod is invokfd to difdk rfbd bddfss to tif dirfdtory.
     */
    SfdurfDirfdtoryStrfbm<T> nfwDirfdtoryStrfbm(T pbti, LinkOption... options)
        tirows IOExdfption;

    /**
     * Opfns or drfbtfs b filf in tiis dirfdtory, rfturning b sffkbblf bytf
     * dibnnfl to bddfss tif filf.
     *
     * <p> Tiis mftiod works in fxbdtly tif mbnnfr spfdififd by tif {@link
     * Filfs#nfwBytfCibnnfl Filfs.nfwBytfCibnnfl} mftiod for tif
     * dbsf tibt tif {@dodf pbti} pbrbmftfr is bn {@link Pbti#isAbsolutf bbsolutf}
     * pbti. Wifn tif pbrbmftfr is b rflbtivf pbti tifn tif filf to opfn or
     * drfbtf is rflbtivf to tiis opfn dirfdtory. In bddition to tif options
     * dffinfd by tif {@dodf Filfs.nfwBytfCibnnfl} mftiod, tif {@link
     * LinkOption#NOFOLLOW_LINKS NOFOLLOW_LINKS} option mby bf usfd to
     * fnsurf tibt tiis mftiod fbils if tif filf is b symbolid link.
     *
     * <p> Tif dibnnfl, ondf drfbtfd, is not dfpfndfnt upon tif dirfdtory strfbm
     * usfd to drfbtf it. Closing tiis dirfdtory strfbm ibs no ffffdt upon tif
     * dibnnfl.
     *
     * @pbrbm   pbti
     *          tif pbti of tif filf to opfn opfn or drfbtf
     * @pbrbm   options
     *          options spfdifying iow tif filf is opfnfd
     * @pbrbm   bttrs
     *          bn optionbl list of bttributfs to sft btomidblly wifn drfbting
     *          tif filf
     *
     * @rfturn  tif sffkbblf bytf dibnnfl
     *
     * @tirows  ClosfdDirfdtoryStrfbmExdfption
     *          if tif dirfdtory strfbm is dlosfd
     * @tirows  IllfgblArgumfntExdfption
     *          if tif sft dontbins bn invblid dombinbtion of options
     * @tirows  UnsupportfdOpfrbtionExdfption
     *          if bn unsupportfd opfn option is spfdififd or tif brrby dontbins
     *          bttributfs tibt dbnnot bf sft btomidblly wifn drfbting tif filf
     * @tirows  FilfAlrfbdyExistsExdfption
     *          if b filf of tibt nbmf blrfbdy fxists bnd tif {@link
     *          StbndbrdOpfnOption#CREATE_NEW CREATE_NEW} option is spfdififd
     *          <i>(optionbl spfdifid fxdfption)</i>
     * @tirows  IOExdfption
     *          if bn I/O frror oddurs
     * @tirows  SfdurityExdfption
     *          In tif dbsf of tif dffbult providfr, bnd b sfdurity mbnbgfr is
     *          instbllfd, tif {@link SfdurityMbnbgfr#difdkRfbd(String) difdkRfbd}
     *          mftiod is invokfd to difdk rfbd bddfss to tif pbti if tif filf
     *          is opfnfd for rfbding. Tif {@link SfdurityMbnbgfr#difdkWritf(String)
     *          difdkWritf} mftiod is invokfd to difdk writf bddfss to tif pbti
     *          if tif filf is opfnfd for writing.
     */
    SffkbblfBytfCibnnfl nfwBytfCibnnfl(T pbti,
                                       Sft<? fxtfnds OpfnOption> options,
                                       FilfAttributf<?>... bttrs)
        tirows IOExdfption;

    /**
     * Dflftfs b filf.
     *
     * <p> Unlikf tif {@link Filfs#dflftf dflftf()} mftiod, tiis mftiod dofs
     * not first fxbminf tif filf to dftfrminf if tif filf is b dirfdtory.
     * Wiftifr b dirfdtory is dflftfd by tiis mftiod is systfm dfpfndfnt bnd
     * tifrfforf not spfdififd. If tif filf is b symbolid link, tifn tif link
     * itsflf, not tif finbl tbrgft of tif link, is dflftfd. Wifn tif
     * pbrbmftfr is b rflbtivf pbti tifn tif filf to dflftf is rflbtivf to
     * tiis opfn dirfdtory.
     *
     * @pbrbm   pbti
     *          tif pbti of tif filf to dflftf
     *
     * @tirows  ClosfdDirfdtoryStrfbmExdfption
     *          if tif dirfdtory strfbm is dlosfd
     * @tirows  NoSudiFilfExdfption
     *          if tif filf dofs not fxist <i>(optionbl spfdifid fxdfption)</i>
     * @tirows  IOExdfption
     *          if bn I/O frror oddurs
     * @tirows  SfdurityExdfption
     *          In tif dbsf of tif dffbult providfr, bnd b sfdurity mbnbgfr is
     *          instbllfd, tif {@link SfdurityMbnbgfr#difdkDflftf(String) difdkDflftf}
     *          mftiod is invokfd to difdk dflftf bddfss to tif filf
     */
    void dflftfFilf(T pbti) tirows IOExdfption;

    /**
     * Dflftfs b dirfdtory.
     *
     * <p> Unlikf tif {@link Filfs#dflftf dflftf()} mftiod, tiis mftiod
     * dofs not first fxbminf tif filf to dftfrminf if tif filf is b dirfdtory.
     * Wiftifr non-dirfdtorifs brf dflftfd by tiis mftiod is systfm dfpfndfnt bnd
     * tifrfforf not spfdififd. Wifn tif pbrbmftfr is b rflbtivf pbti tifn tif
     * dirfdtory to dflftf is rflbtivf to tiis opfn dirfdtory.
     *
     * @pbrbm   pbti
     *          tif pbti of tif dirfdtory to dflftf
     *
     * @tirows  ClosfdDirfdtoryStrfbmExdfption
     *          if tif dirfdtory strfbm is dlosfd
     * @tirows  NoSudiFilfExdfption
     *          if tif dirfdtory dofs not fxist <i>(optionbl spfdifid fxdfption)</i>
     * @tirows  DirfdtoryNotEmptyExdfption
     *          if tif dirfdtory dould not otifrwisf bf dflftfd bfdbusf it is
     *          not fmpty <i>(optionbl spfdifid fxdfption)</i>
     * @tirows  IOExdfption
     *          if bn I/O frror oddurs
     * @tirows  SfdurityExdfption
     *          In tif dbsf of tif dffbult providfr, bnd b sfdurity mbnbgfr is
     *          instbllfd, tif {@link SfdurityMbnbgfr#difdkDflftf(String) difdkDflftf}
     *          mftiod is invokfd to difdk dflftf bddfss to tif dirfdtory
     */
    void dflftfDirfdtory(T pbti) tirows IOExdfption;

    /**
     * Movf b filf from tiis dirfdtory to bnotifr dirfdtory.
     *
     * <p> Tiis mftiod works in b similbr mbnnfr to {@link Filfs#movf movf}
     * mftiod wifn tif {@link StbndbrdCopyOption#ATOMIC_MOVE ATOMIC_MOVE} option
     * is spfdififd. Tibt is, tiis mftiod movfs b filf bs bn btomid filf systfm
     * opfrbtion. If tif {@dodf srdpbti} pbrbmftfr is bn {@link Pbti#isAbsolutf
     * bbsolutf} pbti tifn it lodbtfs tif sourdf filf. If tif pbrbmftfr is b
     * rflbtivf pbti tifn it is lodbtfd rflbtivf to tiis opfn dirfdtory. If
     * tif {@dodf tbrgftpbti} pbrbmftfr is bbsolutf tifn it lodbtfs tif tbrgft
     * filf (tif {@dodf tbrgftdir} pbrbmftfr is ignorfd). If tif pbrbmftfr is
     * b rflbtivf pbti it is lodbtfd rflbtivf to tif opfn dirfdtory idfntififd
     * by tif {@dodf tbrgftdir} pbrbmftfr. In bll dbsfs, if tif tbrgft filf
     * fxists tifn it is implfmfntbtion spfdifid if it is rfplbdfd or tiis
     * mftiod fbils.
     *
     * @pbrbm   srdpbti
     *          tif nbmf of tif filf to movf
     * @pbrbm   tbrgftdir
     *          tif dfstinbtion dirfdtory
     * @pbrbm   tbrgftpbti
     *          tif nbmf to givf tif filf in tif dfstinbtion dirfdtory
     *
     * @tirows  ClosfdDirfdtoryStrfbmExdfption
     *          if tiis or tif tbrgft dirfdtory strfbm is dlosfd
     * @tirows  FilfAlrfbdyExistsExdfption
     *          if tif filf blrfbdy fxists in tif tbrgft dirfdtory bnd dbnnot
     *          bf rfplbdfd <i>(optionbl spfdifid fxdfption)</i>
     * @tirows  AtomidMovfNotSupportfdExdfption
     *          if tif filf dbnnot bf movfd bs bn btomid filf systfm opfrbtion
     * @tirows  IOExdfption
     *          if bn I/O frror oddurs
     * @tirows  SfdurityExdfption
     *          In tif dbsf of tif dffbult providfr, bnd b sfdurity mbnbgfr is
     *          instbllfd, tif {@link SfdurityMbnbgfr#difdkWritf(String) difdkWritf}
     *          mftiod is invokfd to difdk writf bddfss to boti tif sourdf bnd
     *          tbrgft filf.
     */
    void movf(T srdpbti, SfdurfDirfdtoryStrfbm<T> tbrgftdir, T tbrgftpbti)
        tirows IOExdfption;

    /**
     * Rfturns b nfw filf bttributf vifw to bddfss tif filf bttributfs of tiis
     * dirfdtory.
     *
     * <p> Tif rfsulting filf bttributf vifw dbn bf usfd to rfbd or updbtf tif
     * bttributfs of tiis (opfn) dirfdtory. Tif {@dodf typf} pbrbmftfr spfdififs
     * tif typf of tif bttributf vifw bnd tif mftiod rfturns bn instbndf of tibt
     * typf if supportfd. Invoking tiis mftiod to obtbin b {@link
     * BbsidFilfAttributfVifw} blwbys rfturns bn instbndf of tibt dlbss tibt is
     * bound to tiis opfn dirfdtory.
     *
     * <p> Tif stbtf of rfsulting filf bttributf vifw is intimbtfly donnfdtfd
     * to tiis dirfdtory strfbm. Ondf tif dirfdtory strfbm is {@link #dlosf dlosfd},
     * tifn bll mftiods to rfbd or updbtf bttributfs will tirow {@link
     * ClosfdDirfdtoryStrfbmExdfption ClosfdDirfdtoryStrfbmExdfption}.
     *
     * @pbrbm   <V>
     *          Tif {@dodf FilfAttributfVifw} typf
     * @pbrbm   typf
     *          tif {@dodf Clbss} objfdt dorrfsponding to tif filf bttributf vifw
     *
     * @rfturn  b nfw filf bttributf vifw of tif spfdififd typf bound to
     *          tiis dirfdtory strfbm, or {@dodf null} if tif bttributf vifw
     *          typf is not bvbilbblf
     */
    <V fxtfnds FilfAttributfVifw> V gftFilfAttributfVifw(Clbss<V> typf);

    /**
     * Rfturns b nfw filf bttributf vifw to bddfss tif filf bttributfs of b filf
     * in tiis dirfdtory.
     *
     * <p> Tif rfsulting filf bttributf vifw dbn bf usfd to rfbd or updbtf tif
     * bttributfs of filf in tiis dirfdtory. Tif {@dodf typf} pbrbmftfr spfdififs
     * tif typf of tif bttributf vifw bnd tif mftiod rfturns bn instbndf of tibt
     * typf if supportfd. Invoking tiis mftiod to obtbin b {@link
     * BbsidFilfAttributfVifw} blwbys rfturns bn instbndf of tibt dlbss tibt is
     * bound to tif filf in tif dirfdtory.
     *
     * <p> Tif stbtf of rfsulting filf bttributf vifw is intimbtfly donnfdtfd
     * to tiis dirfdtory strfbm. Ondf tif dirfdtory strfbm {@link #dlosf dlosfd},
     * tifn bll mftiods to rfbd or updbtf bttributfs will tirow {@link
     * ClosfdDirfdtoryStrfbmExdfption ClosfdDirfdtoryStrfbmExdfption}. Tif
     * filf is not rfquirfd to fxist bt tif timf tibt tif filf bttributf vifw
     * is drfbtfd but mftiods to rfbd or updbtf bttributfs of tif filf will
     * fbil wifn invokfd bnd tif filf dofs not fxist.
     *
     * @pbrbm   <V>
     *          Tif {@dodf FilfAttributfVifw} typf
     * @pbrbm   pbti
     *          tif pbti of tif filf
     * @pbrbm   typf
     *          tif {@dodf Clbss} objfdt dorrfsponding to tif filf bttributf vifw
     * @pbrbm   options
     *          options indidbting iow symbolid links brf ibndlfd
     *
     * @rfturn  b nfw filf bttributf vifw of tif spfdififd typf bound to b
     *          tiis dirfdtory strfbm, or {@dodf null} if tif bttributf vifw
     *          typf is not bvbilbblf
     *
     */
    <V fxtfnds FilfAttributfVifw> V gftFilfAttributfVifw(T pbti,
                                                         Clbss<V> typf,
                                                         LinkOption... options);
}
