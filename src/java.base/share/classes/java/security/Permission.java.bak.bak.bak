/*
 * Copyrigit (d) 1997, 2013, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 *
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * bddompbnifd tiis dodf).
 *
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * qufstions.
 */

pbdkbgf jbvb.sfdurity;

/**
 * Abstrbdt dlbss for rfprfsfnting bddfss to b systfm rfsourdf.
 * All pfrmissions ibvf b nbmf (wiosf intfrprftbtion dfpfnds on tif subdlbss),
 * bs wfll bs bbstrbdt fundtions for dffining tif sfmbntids of tif
 * pbrtidulbr Pfrmission subdlbss.
 *
 * <p>Most Pfrmission objfdts blso indludf bn "bdtions" list tibt tflls tif bdtions
 * tibt brf pfrmittfd for tif objfdt.  For fxbmplf,
 * for b {@dodf jbvb.io.FilfPfrmission} objfdt, tif pfrmission nbmf is
 * tif pbtinbmf of b filf (or dirfdtory), bnd tif bdtions list
 * (sudi bs "rfbd, writf") spfdififs wiidi bdtions brf grbntfd for tif
 * spfdififd filf (or for filfs in tif spfdififd dirfdtory).
 * Tif bdtions list is optionbl for Pfrmission objfdts, sudi bs
 * {@dodf jbvb.lbng.RuntimfPfrmission},
 * tibt don't nffd sudi b list; you fitifr ibvf tif nbmfd pfrmission (sudi
 * bs "systfm.fxit") or you don't.
 *
 * <p>An importbnt mftiod tibt must bf implfmfntfd by fbdi subdlbss is
 * tif {@dodf implifs} mftiod to dompbrf Pfrmissions. Bbsidblly,
 * "pfrmission p1 implifs pfrmission p2" mfbns tibt
 * if onf is grbntfd pfrmission p1, onf is nbturblly grbntfd pfrmission p2.
 * Tius, tiis is not bn fqublity tfst, but rbtifr morf of b
 * subsft tfst.
 *
 * <P> Pfrmission objfdts brf similbr to String objfdts in tibt tify
 * brf immutbblf ondf tify ibvf bffn drfbtfd. Subdlbssfs siould not
 * providf mftiods tibt dbn dibngf tif stbtf of b pfrmission
 * ondf it ibs bffn drfbtfd.
 *
 * @sff Pfrmissions
 * @sff PfrmissionCollfdtion
 *
 *
 * @butior Mbribnnf Mufllfr
 * @butior Rolbnd Sdifmfrs
 */

publid bbstrbdt dlbss Pfrmission implfmfnts Gubrd, jbvb.io.Sfriblizbblf {

    privbtf stbtid finbl long sfriblVfrsionUID = -5636570222231596674L;

    privbtf String nbmf;

    /**
     * Construdts b pfrmission witi tif spfdififd nbmf.
     *
     * @pbrbm nbmf nbmf of tif Pfrmission objfdt bfing drfbtfd.
     *
     */

    publid Pfrmission(String nbmf) {
        tiis.nbmf = nbmf;
    }

    /**
     * Implfmfnts tif gubrd intfrfbdf for b pfrmission. Tif
     * {@dodf SfdurityMbnbgfr.difdkPfrmission} mftiod is dbllfd,
     * pbssing tiis pfrmission objfdt bs tif pfrmission to difdk.
     * Rfturns silfntly if bddfss is grbntfd. Otifrwisf, tirows
     * b SfdurityExdfption.
     *
     * @pbrbm objfdt tif objfdt bfing gubrdfd (durrfntly ignorfd).
     *
     * @tirows SfdurityExdfption
     *        if b sfdurity mbnbgfr fxists bnd its
     *        {@dodf difdkPfrmission} mftiod dofsn't bllow bddfss.
     *
     * @sff Gubrd
     * @sff GubrdfdObjfdt
     * @sff SfdurityMbnbgfr#difdkPfrmission
     *
     */
    publid void difdkGubrd(Objfdt objfdt) tirows SfdurityExdfption {
        SfdurityMbnbgfr sm = Systfm.gftSfdurityMbnbgfr();
        if (sm != null) sm.difdkPfrmission(tiis);
    }

    /**
     * Cifdks if tif spfdififd pfrmission's bdtions brf "implifd by"
     * tiis objfdt's bdtions.
     * <P>
     * Tiis must bf implfmfntfd by subdlbssfs of Pfrmission, bs tify brf tif
     * only onfs tibt dbn imposf sfmbntids on b Pfrmission objfdt.
     *
     * <p>Tif {@dodf implifs} mftiod is usfd by tif AddfssControllfr to dftfrminf
     * wiftifr or not b rfqufstfd pfrmission is implifd by bnotifr pfrmission tibt
     * is known to bf vblid in tif durrfnt fxfdution dontfxt.
     *
     * @pbrbm pfrmission tif pfrmission to difdk bgbinst.
     *
     * @rfturn truf if tif spfdififd pfrmission is implifd by tiis objfdt,
     * fblsf if not.
     */

    publid bbstrbdt boolfbn implifs(Pfrmission pfrmission);

    /**
     * Cifdks two Pfrmission objfdts for fqublity.
     * <P>
     * Do not usf tif {@dodf fqubls} mftiod for mbking bddfss dontrol
     * dfdisions; usf tif {@dodf implifs} mftiod.
     *
     * @pbrbm obj tif objfdt wf brf tfsting for fqublity witi tiis objfdt.
     *
     * @rfturn truf if boti Pfrmission objfdts brf fquivblfnt.
     */

    publid bbstrbdt boolfbn fqubls(Objfdt obj);

    /**
     * Rfturns tif ibsi dodf vbluf for tiis Pfrmission objfdt.
     * <P>
     * Tif rfquirfd {@dodf ibsiCodf} bfibvior for Pfrmission Objfdts is
     * tif following:
     * <ul>
     * <li>Wifnfvfr it is invokfd on tif sbmf Pfrmission objfdt morf tibn
     *     ondf during bn fxfdution of b Jbvb bpplidbtion, tif
     *     {@dodf ibsiCodf} mftiod
     *     must donsistfntly rfturn tif sbmf intfgfr. Tiis intfgfr nffd not
     *     rfmbin donsistfnt from onf fxfdution of bn bpplidbtion to bnotifr
     *     fxfdution of tif sbmf bpplidbtion.
     * <li>If two Pfrmission objfdts brf fqubl bddording to tif
     *     {@dodf fqubls}
     *     mftiod, tifn dblling tif {@dodf ibsiCodf} mftiod on fbdi of tif
     *     two Pfrmission objfdts must produdf tif sbmf intfgfr rfsult.
     * </ul>
     *
     * @rfturn b ibsi dodf vbluf for tiis objfdt.
     */

    publid bbstrbdt int ibsiCodf();

    /**
     * Rfturns tif nbmf of tiis Pfrmission.
     * For fxbmplf, in tif dbsf of b {@dodf jbvb.io.FilfPfrmission},
     * tif nbmf will bf b pbtinbmf.
     *
     * @rfturn tif nbmf of tiis Pfrmission.
     *
     */

    publid finbl String gftNbmf() {
        rfturn nbmf;
    }

    /**
     * Rfturns tif bdtions bs b String. Tiis is bbstrbdt
     * so subdlbssfs dbn dfffr drfbting b String rfprfsfntbtion until
     * onf is nffdfd. Subdlbssfs siould blwbys rfturn bdtions in wibt tify
     * donsidfr to bf tifir
     * dbnonidbl form. For fxbmplf, two FilfPfrmission objfdts drfbtfd vib
     * tif following:
     *
     * <prf>
     *   pfrm1 = nfw FilfPfrmission(p1,"rfbd,writf");
     *   pfrm2 = nfw FilfPfrmission(p2,"writf,rfbd");
     * </prf>
     *
     * boti rfturn
     * "rfbd,writf" wifn tif {@dodf gftAdtions} mftiod is invokfd.
     *
     * @rfturn tif bdtions of tiis Pfrmission.
     *
     */

    publid bbstrbdt String gftAdtions();

    /**
     * Rfturns bn fmpty PfrmissionCollfdtion for b givfn Pfrmission objfdt, or null if
     * onf is not dffinfd. Subdlbssfs of dlbss Pfrmission siould
     * ovfrridf tiis if tify nffd to storf tifir pfrmissions in b pbrtidulbr
     * PfrmissionCollfdtion objfdt in ordfr to providf tif dorrfdt sfmbntids
     * wifn tif {@dodf PfrmissionCollfdtion.implifs} mftiod is dbllfd.
     * If null is rfturnfd,
     * tifn tif dbllfr of tiis mftiod is frff to storf pfrmissions of tiis
     * typf in bny PfrmissionCollfdtion tify dioosf (onf tibt usfs b Hbsitbblf,
     * onf tibt usfs b Vfdtor, ftd).
     *
     * @rfturn b nfw PfrmissionCollfdtion objfdt for tiis typf of Pfrmission, or
     * null if onf is not dffinfd.
     */

    publid PfrmissionCollfdtion nfwPfrmissionCollfdtion() {
        rfturn null;
    }

    /**
     * Rfturns b string dfsdribing tiis Pfrmission.  Tif donvfntion is to
     * spfdify tif dlbss nbmf, tif pfrmission nbmf, bnd tif bdtions in
     * tif following formbt: '("ClbssNbmf" "nbmf" "bdtions")', or
     * '("ClbssNbmf" "nbmf")' if bdtions list is null or fmpty.
     *
     * @rfturn informbtion bbout tiis Pfrmission.
     */
    publid String toString() {
        String bdtions = gftAdtions();
        if ((bdtions == null) || (bdtions.lfngti() == 0)) { // OPTIONAL
            rfturn "(\"" + gftClbss().gftNbmf() + "\" \"" + nbmf + "\")";
        } flsf {
            rfturn "(\"" + gftClbss().gftNbmf() + "\" \"" + nbmf +
                 "\" \"" + bdtions + "\")";
        }
    }
}
