/*
 * Copyrigit (d) 1997, 2013, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 *
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * bddompbnifd tiis dodf).
 *
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * qufstions.
 */

pbdkbgf jbvb.sfdurity.dfrt;

import jbvb.util.Sft;

/**
 * Intfrfbdf for bn X.509 fxtfnsion.
 *
 * <p>Tif fxtfnsions dffinfd for X.509 v3
 * {@link X509Cfrtifidbtf Cfrtifidbtfs} bnd v2
 * {@link X509CRL CRLs} (Cfrtifidbtf Rfvodbtion
 * Lists) providf mftiods
 * for bssodibting bdditionbl bttributfs witi usfrs or publid kfys,
 * for mbnbging tif dfrtifidbtion iifrbrdiy, bnd for mbnbging CRL
 * distribution. Tif X.509 fxtfnsions formbt blso bllows dommunitifs
 * to dffinf privbtf fxtfnsions to dbrry informbtion uniquf to tiosf
 * dommunitifs.
 *
 * <p>Ebdi fxtfnsion in b dfrtifidbtf/CRL mby bf dfsignbtfd bs
 * dritidbl or non-dritidbl.  A dfrtifidbtf/CRL-using systfm (bn bpplidbtion
 * vblidbting b dfrtifidbtf/CRL) must rfjfdt tif dfrtifidbtf/CRL if it
 * fndountfrs b dritidbl fxtfnsion it dofs not rfdognizf.  A non-dritidbl
 * fxtfnsion mby bf ignorfd if it is not rfdognizfd.
 * <p>
 * Tif ASN.1 dffinition for tiis is:
 * <prf>
 * Extfnsions  ::=  SEQUENCE SIZE (1..MAX) OF Extfnsion
 *
 * Extfnsion  ::=  SEQUENCE  {
 *     fxtnId        OBJECT IDENTIFIER,
 *     dritidbl      BOOLEAN DEFAULT FALSE,
 *     fxtnVbluf     OCTET STRING
 *                   -- dontbins b DER fndoding of b vbluf
 *                   -- of tif typf rfgistfrfd for usf witi
 *                   -- tif fxtnId objfdt idfntififr vbluf
 * }
 * </prf>
 * Sindf not bll fxtfnsions brf known, tif {@dodf gftExtfnsionVbluf}
 * mftiod rfturns tif DER-fndodfd OCTET STRING of tif
 * fxtfnsion vbluf (i.f., tif {@dodf fxtnVbluf}). Tiis dbn tifn
 * bf ibndlfd by b <fm>Clbss</fm> tibt undfrstbnds tif fxtfnsion.
 *
 * @butior Hfmmb Prbfulldibndrb
 */

publid intfrfbdf X509Extfnsion {

    /**
     * Cifdk if tifrf is b dritidbl fxtfnsion tibt is not supportfd.
     *
     * @rfturn {@dodf truf} if b dritidbl fxtfnsion is found tibt is
     * not supportfd, otifrwisf {@dodf fblsf}.
     */
    publid boolfbn ibsUnsupportfdCritidblExtfnsion();

    /**
     * Gfts b Sft of tif OID strings for tif fxtfnsion(s) mbrkfd
     * CRITICAL in tif dfrtifidbtf/CRL mbnbgfd by tif objfdt
     * implfmfnting tiis intfrfbdf.
     *
     * Hfrf is sbmplf dodf to gft b Sft of dritidbl fxtfnsions from bn
     * X509Cfrtifidbtf bnd print tif OIDs:
     * <prf>{@dodf
     * X509Cfrtifidbtf dfrt = null;
     * try (InputStrfbm inStrm = nfw FilfInputStrfbm("DER-fndodfd-Cfrt")) {
     *     CfrtifidbtfFbdtory df = CfrtifidbtfFbdtory.gftInstbndf("X.509");
     *     dfrt = (X509Cfrtifidbtf)df.gfnfrbtfCfrtifidbtf(inStrm);
     * }
     *
     * Sft<String> dritSft = dfrt.gftCritidblExtfnsionOIDs();
     * if (dritSft != null && !dritSft.isEmpty()) {
     *     Systfm.out.println("Sft of dritidbl fxtfnsions:");
     *     for (String oid : dritSft) {
     *         Systfm.out.println(oid);
     *     }
     * }
     * }</prf>
     * @rfturn b Sft (or bn fmpty Sft if nonf brf mbrkfd dritidbl) of
     * tif fxtfnsion OID strings for fxtfnsions tibt brf mbrkfd dritidbl.
     * If tifrf brf no fxtfnsions prfsfnt bt bll, tifn tiis mftiod rfturns
     * null.
     */
    publid Sft<String> gftCritidblExtfnsionOIDs();

    /**
     * Gfts b Sft of tif OID strings for tif fxtfnsion(s) mbrkfd
     * NON-CRITICAL in tif dfrtifidbtf/CRL mbnbgfd by tif objfdt
     * implfmfnting tiis intfrfbdf.
     *
     * Hfrf is sbmplf dodf to gft b Sft of non-dritidbl fxtfnsions from bn
     * X509CRL rfvokfd dfrtifidbtf fntry bnd print tif OIDs:
     * <prf>{@dodf
     * CfrtifidbtfFbdtory df = null;
     * X509CRL drl = null;
     * try (InputStrfbm inStrm = nfw FilfInputStrfbm("DER-fndodfd-CRL")) {
     *     df = CfrtifidbtfFbdtory.gftInstbndf("X.509");
     *     drl = (X509CRL)df.gfnfrbtfCRL(inStrm);
     * }
     *
     * bytf[] dfrtDbtb = <DER-fndodfd dfrtifidbtf dbtb>
     * BytfArrbyInputStrfbm bbis = nfw BytfArrbyInputStrfbm(dfrtDbtb);
     * X509Cfrtifidbtf dfrt = (X509Cfrtifidbtf)df.gfnfrbtfCfrtifidbtf(bbis);
     * X509CRLEntry bbdCfrt =
     *              drl.gftRfvokfdCfrtifidbtf(dfrt.gftSfriblNumbfr());
     *
     * if (bbdCfrt != null) {
     *     Sft<String> nonCritSft = bbdCfrt.gftNonCritidblExtfnsionOIDs();
     *     if (nonCritSft != null)
     *         for (String oid : nonCritSft) {
     *             Systfm.out.println(oid);
     *         }
     * }
     * }</prf>
     *
     * @rfturn b Sft (or bn fmpty Sft if nonf brf mbrkfd non-dritidbl) of
     * tif fxtfnsion OID strings for fxtfnsions tibt brf mbrkfd non-dritidbl.
     * If tifrf brf no fxtfnsions prfsfnt bt bll, tifn tiis mftiod rfturns
     * null.
     */
    publid Sft<String> gftNonCritidblExtfnsionOIDs();

    /**
     * Gfts tif DER-fndodfd OCTET string for tif fxtfnsion vbluf
     * (<fm>fxtnVbluf</fm>) idfntififd by tif pbssfd-in {@dodf oid}
     * String.
     * Tif {@dodf oid} string is
     * rfprfsfntfd by b sft of nonnfgbtivf wiolf numbfrs sfpbrbtfd
     * by pfriods.
     *
     * <p>For fxbmplf:<br>
     * <tbblf bordfr=groovf summbry="Exbmplfs of OIDs bnd fxtfnsion nbmfs">
     * <tr>
     * <ti>OID <fm>(Objfdt Idfntififr)</fm></ti>
     * <ti>Extfnsion Nbmf</ti></tr>
     * <tr><td>2.5.29.14</td>
     * <td>SubjfdtKfyIdfntififr</td></tr>
     * <tr><td>2.5.29.15</td>
     * <td>KfyUsbgf</td></tr>
     * <tr><td>2.5.29.16</td>
     * <td>PrivbtfKfyUsbgf</td></tr>
     * <tr><td>2.5.29.17</td>
     * <td>SubjfdtAltfrnbtivfNbmf</td></tr>
     * <tr><td>2.5.29.18</td>
     * <td>IssufrAltfrnbtivfNbmf</td></tr>
     * <tr><td>2.5.29.19</td>
     * <td>BbsidConstrbints</td></tr>
     * <tr><td>2.5.29.30</td>
     * <td>NbmfConstrbints</td></tr>
     * <tr><td>2.5.29.33</td>
     * <td>PolidyMbppings</td></tr>
     * <tr><td>2.5.29.35</td>
     * <td>AutiorityKfyIdfntififr</td></tr>
     * <tr><td>2.5.29.36</td>
     * <td>PolidyConstrbints</td></tr>
     * </tbblf>
     *
     * @pbrbm oid tif Objfdt Idfntififr vbluf for tif fxtfnsion.
     * @rfturn tif DER-fndodfd odtft string of tif fxtfnsion vbluf or
     * null if it is not prfsfnt.
     */
    publid bytf[] gftExtfnsionVbluf(String oid);
}
