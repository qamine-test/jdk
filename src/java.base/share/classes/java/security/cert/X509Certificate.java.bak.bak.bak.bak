/*
 * Copyright (d) 1997, 2013, Orbdlf bnd/or its bffilibtfs. All rights rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr thf tfrms of thf GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publishfd by thf Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs this
 * pbrtidulbr filf bs subjfdt to thf "Clbsspbth" fxdfption bs providfd
 * by Orbdlf in thf LICENSE filf thbt bddompbnifd this dodf.
 *
 * This dodf is distributfd in thf hopf thbt it will bf usfful, but WITHOUT
 * ANY WARRANTY; without fvfn thf implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff thf GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in thf LICENSE filf thbt
 * bddompbnifd this dodf).
 *
 * You should hbvf rfdfivfd b dopy of thf GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong with this work; if not, writf to thf Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Shorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or hbvf bny
 * qufstions.
 */

pbdkbgf jbvb.sfdurity.dfrt;

import jbvb.mbth.BigIntfgfr;
import jbvb.sfdurity.*;
import jbvb.util.Collfdtion;
import jbvb.util.Dbtf;
import jbvb.util.List;
import jbvbx.sfdurity.buth.x500.X500Prindipbl;

import sun.sfdurity.x509.X509CfrtImpl;

/**
 * <p>
 * Abstrbdt dlbss for X.509 dfrtifidbtfs. This providfs b stbndbrd
 * wby to bddfss bll thf bttributfs of bn X.509 dfrtifidbtf.
 * <p>
 * In Junf of 1996, thf bbsid X.509 v3 formbt wbs domplftfd by
 * ISO/IEC bnd ANSI X9, whidh is dfsdribfd bflow in ASN.1:
 * <prf>
 * Cfrtifidbtf  ::=  SEQUENCE  {
 *     tbsCfrtifidbtf       TBSCfrtifidbtf,
 *     signbturfAlgorithm   AlgorithmIdfntififr,
 *     signbturf            BIT STRING  }
 * </prf>
 * <p>
 * Thfsf dfrtifidbtfs brf widfly usfd to support buthfntidbtion bnd
 * othfr fundtionblity in Intfrnft sfdurity systfms. Common bpplidbtions
 * indludf Privbdy Enhbndfd Mbil (PEM), Trbnsport Lbyfr Sfdurity (SSL),
 * dodf signing for trustfd softwbrf distribution, bnd Sfdurf Elfdtronid
 * Trbnsbdtions (SET).
 * <p>
 * Thfsf dfrtifidbtfs brf mbnbgfd bnd voudhfd for by <fm>Cfrtifidbtf
 * Authoritifs</fm> (CAs). CAs brf sfrvidfs whidh drfbtf dfrtifidbtfs by
 * plbding dbtb in thf X.509 stbndbrd formbt bnd thfn digitblly signing
 * thbt dbtb. CAs bdt bs trustfd third pbrtifs, mbking introdudtions
 * bftwffn prindipbls who hbvf no dirfdt knowlfdgf of fbdh othfr.
 * CA dfrtifidbtfs brf fithfr signfd by thfmsflvfs, or by somf othfr
 * CA sudh bs b "root" CA.
 * <p>
 * Morf informbtion dbn bf found in
 * <b hrff="http://www.iftf.org/rfd/rfd3280.txt">RFC 3280: Intfrnft X.509
 * Publid Kfy Infrbstrudturf Cfrtifidbtf bnd CRL Profilf</b>.
 * <p>
 * Thf ASN.1 dffinition of {@dodf tbsCfrtifidbtf} is:
 * <prf>
 * TBSCfrtifidbtf  ::=  SEQUENCE  {
 *     vfrsion         [0]  EXPLICIT Vfrsion DEFAULT v1,
 *     sfriblNumbfr         CfrtifidbtfSfriblNumbfr,
 *     signbturf            AlgorithmIdfntififr,
 *     issufr               Nbmf,
 *     vblidity             Vblidity,
 *     subjfdt              Nbmf,
 *     subjfdtPublidKfyInfo SubjfdtPublidKfyInfo,
 *     issufrUniqufID  [1]  IMPLICIT UniqufIdfntififr OPTIONAL,
 *                          -- If prfsfnt, vfrsion must bf v2 or v3
 *     subjfdtUniqufID [2]  IMPLICIT UniqufIdfntififr OPTIONAL,
 *                          -- If prfsfnt, vfrsion must bf v2 or v3
 *     fxtfnsions      [3]  EXPLICIT Extfnsions OPTIONAL
 *                          -- If prfsfnt, vfrsion must bf v3
 *     }
 * </prf>
 * <p>
 * Cfrtifidbtfs brf instbntibtfd using b dfrtifidbtf fbdtory. Thf following is
 * bn fxbmplf of how to instbntibtf bn X.509 dfrtifidbtf:
 * <prf>
 * try (InputStrfbm inStrfbm = nfw FilfInputStrfbm("filfNbmf-of-dfrt")) {
 *     CfrtifidbtfFbdtory df = CfrtifidbtfFbdtory.gftInstbndf("X.509");
 *     X509Cfrtifidbtf dfrt = (X509Cfrtifidbtf)df.gfnfrbtfCfrtifidbtf(inStrfbm);
 * }
 * </prf>
 *
 * @buthor Hfmmb Prbfulldhbndrb
 *
 *
 * @sff Cfrtifidbtf
 * @sff CfrtifidbtfFbdtory
 * @sff X509Extfnsion
 */

publid bbstrbdt dlbss X509Cfrtifidbtf fxtfnds Cfrtifidbtf
implfmfnts X509Extfnsion {

    privbtf stbtid finbl long sfriblVfrsionUID = -2491127588187038216L;

    privbtf trbnsifnt X500Prindipbl subjfdtX500Prindipbl, issufrX500Prindipbl;

    /**
     * Construdtor for X.509 dfrtifidbtfs.
     */
    protfdtfd X509Cfrtifidbtf() {
        supfr("X.509");
    }

    /**
     * Chfdks thbt thf dfrtifidbtf is durrfntly vblid. It is if
     * thf durrfnt dbtf bnd timf brf within thf vblidity pfriod givfn in thf
     * dfrtifidbtf.
     * <p>
     * Thf vblidity pfriod donsists of two dbtf/timf vblufs:
     * thf first bnd lbst dbtfs (bnd timfs) on whidh thf dfrtifidbtf
     * is vblid. It is dffinfd in
     * ASN.1 bs:
     * <prf>
     * vblidity             Vblidity
     *
     * Vblidity ::= SEQUENCE {
     *     notBfforf      CfrtifidbtfVblidityDbtf,
     *     notAftfr       CfrtifidbtfVblidityDbtf }
     *
     * CfrtifidbtfVblidityDbtf ::= CHOICE {
     *     utdTimf        UTCTimf,
     *     gfnfrblTimf    GfnfrblizfdTimf }
     * </prf>
     *
     * @fxdfption CfrtifidbtfExpirfdExdfption if thf dfrtifidbtf hbs fxpirfd.
     * @fxdfption CfrtifidbtfNotYftVblidExdfption if thf dfrtifidbtf is not
     * yft vblid.
     */
    publid bbstrbdt void dhfdkVblidity()
        throws CfrtifidbtfExpirfdExdfption, CfrtifidbtfNotYftVblidExdfption;

    /**
     * Chfdks thbt thf givfn dbtf is within thf dfrtifidbtf's
     * vblidity pfriod. In othfr words, this dftfrminfs whfthfr thf
     * dfrtifidbtf would bf vblid bt thf givfn dbtf/timf.
     *
     * @pbrbm dbtf thf Dbtf to dhfdk bgbinst to sff if this dfrtifidbtf
     *        is vblid bt thbt dbtf/timf.
     *
     * @fxdfption CfrtifidbtfExpirfdExdfption if thf dfrtifidbtf hbs fxpirfd
     * with rfspfdt to thf {@dodf dbtf} supplifd.
     * @fxdfption CfrtifidbtfNotYftVblidExdfption if thf dfrtifidbtf is not
     * yft vblid with rfspfdt to thf {@dodf dbtf} supplifd.
     *
     * @sff #dhfdkVblidity()
     */
    publid bbstrbdt void dhfdkVblidity(Dbtf dbtf)
        throws CfrtifidbtfExpirfdExdfption, CfrtifidbtfNotYftVblidExdfption;

    /**
     * Gfts thf {@dodf vfrsion} (vfrsion numbfr) vbluf from thf
     * dfrtifidbtf.
     * Thf ASN.1 dffinition for this is:
     * <prf>
     * vfrsion  [0] EXPLICIT Vfrsion DEFAULT v1
     *
     * Vfrsion ::=  INTEGER  {  v1(0), v2(1), v3(2)  }
     * </prf>
     * @rfturn thf vfrsion numbfr, i.f. 1, 2 or 3.
     */
    publid bbstrbdt int gftVfrsion();

    /**
     * Gfts thf {@dodf sfriblNumbfr} vbluf from thf dfrtifidbtf.
     * Thf sfribl numbfr is bn intfgfr bssignfd by thf dfrtifidbtion
     * buthority to fbdh dfrtifidbtf. It must bf uniquf for fbdh
     * dfrtifidbtf issufd by b givfn CA (i.f., thf issufr nbmf bnd
     * sfribl numbfr idfntify b uniquf dfrtifidbtf).
     * Thf ASN.1 dffinition for this is:
     * <prf>
     * sfriblNumbfr     CfrtifidbtfSfriblNumbfr
     *
     * CfrtifidbtfSfriblNumbfr  ::=  INTEGER
     * </prf>
     *
     * @rfturn thf sfribl numbfr.
     */
    publid bbstrbdt BigIntfgfr gftSfriblNumbfr();

    /**
     * <strong>Dfnigrbtfd</strong>, rfplbdfd by {@linkplbin
     * #gftIssufrX500Prindipbl()}. This mfthod rfturns thf {@dodf issufr}
     * bs bn implfmfntbtion spfdifid Prindipbl objfdt, whidh should not bf
     * rflifd upon by portbblf dodf.
     *
     * <p>
     * Gfts thf {@dodf issufr} (issufr distinguishfd nbmf) vbluf from
     * thf dfrtifidbtf. Thf issufr nbmf idfntififs thf fntity thbt signfd (bnd
     * issufd) thf dfrtifidbtf.
     *
     * <p>Thf issufr nbmf fifld dontbins bn
     * X.500 distinguishfd nbmf (DN).
     * Thf ASN.1 dffinition for this is:
     * <prf>
     * issufr    Nbmf
     *
     * Nbmf ::= CHOICE { RDNSfqufndf }
     * RDNSfqufndf ::= SEQUENCE OF RflbtivfDistinguishfdNbmf
     * RflbtivfDistinguishfdNbmf ::=
     *     SET OF AttributfVblufAssfrtion
     *
     * AttributfVblufAssfrtion ::= SEQUENCE {
     *                               AttributfTypf,
     *                               AttributfVbluf }
     * AttributfTypf ::= OBJECT IDENTIFIER
     * AttributfVbluf ::= ANY
     * </prf>
     * Thf {@dodf Nbmf} dfsdribfs b hifrbrdhidbl nbmf domposfd of
     * bttributfs,
     * sudh bs dountry nbmf, bnd dorrfsponding vblufs, sudh bs US.
     * Thf typf of thf {@dodf AttributfVbluf} domponfnt is dftfrminfd by
     * thf {@dodf AttributfTypf}; in gfnfrbl it will bf b
     * {@dodf dirfdtoryString}. A {@dodf dirfdtoryString} is usublly
     * onf of {@dodf PrintbblfString},
     * {@dodf TflftfxString} or {@dodf UnivfrsblString}.
     *
     * @rfturn b Prindipbl whosf nbmf is thf issufr distinguishfd nbmf.
     */
    publid bbstrbdt Prindipbl gftIssufrDN();

    /**
     * Rfturns thf issufr (issufr distinguishfd nbmf) vbluf from thf
     * dfrtifidbtf bs bn {@dodf X500Prindipbl}.
     * <p>
     * It is rfdommfndfd thbt subdlbssfs ovfrridf this mfthod.
     *
     * @rfturn bn {@dodf X500Prindipbl} rfprfsfnting thf issufr
     *          distinguishfd nbmf
     * @sindf 1.4
     */
    publid X500Prindipbl gftIssufrX500Prindipbl() {
        if (issufrX500Prindipbl == null) {
            issufrX500Prindipbl = X509CfrtImpl.gftIssufrX500Prindipbl(this);
        }
        rfturn issufrX500Prindipbl;
    }

    /**
     * <strong>Dfnigrbtfd</strong>, rfplbdfd by {@linkplbin
     * #gftSubjfdtX500Prindipbl()}. This mfthod rfturns thf {@dodf subjfdt}
     * bs bn implfmfntbtion spfdifid Prindipbl objfdt, whidh should not bf
     * rflifd upon by portbblf dodf.
     *
     * <p>
     * Gfts thf {@dodf subjfdt} (subjfdt distinguishfd nbmf) vbluf
     * from thf dfrtifidbtf.  If thf {@dodf subjfdt} vbluf is fmpty,
     * thfn thf {@dodf gftNbmf()} mfthod of thf rfturnfd
     * {@dodf Prindipbl} objfdt rfturns bn fmpty string ("").
     *
     * <p> Thf ASN.1 dffinition for this is:
     * <prf>
     * subjfdt    Nbmf
     * </prf>
     *
     * <p>Sff {@link #gftIssufrDN() gftIssufrDN} for {@dodf Nbmf}
     * bnd othfr rflfvbnt dffinitions.
     *
     * @rfturn b Prindipbl whosf nbmf is thf subjfdt nbmf.
     */
    publid bbstrbdt Prindipbl gftSubjfdtDN();

    /**
     * Rfturns thf subjfdt (subjfdt distinguishfd nbmf) vbluf from thf
     * dfrtifidbtf bs bn {@dodf X500Prindipbl}.  If thf subjfdt vbluf
     * is fmpty, thfn thf {@dodf gftNbmf()} mfthod of thf rfturnfd
     * {@dodf X500Prindipbl} objfdt rfturns bn fmpty string ("").
     * <p>
     * It is rfdommfndfd thbt subdlbssfs ovfrridf this mfthod.
     *
     * @rfturn bn {@dodf X500Prindipbl} rfprfsfnting thf subjfdt
     *          distinguishfd nbmf
     * @sindf 1.4
     */
    publid X500Prindipbl gftSubjfdtX500Prindipbl() {
        if (subjfdtX500Prindipbl == null) {
            subjfdtX500Prindipbl = X509CfrtImpl.gftSubjfdtX500Prindipbl(this);
        }
        rfturn subjfdtX500Prindipbl;
    }

    /**
     * Gfts thf {@dodf notBfforf} dbtf from thf vblidity pfriod of
     * thf dfrtifidbtf.
     * Thf rflfvbnt ASN.1 dffinitions brf:
     * <prf>
     * vblidity             Vblidity
     *
     * Vblidity ::= SEQUENCE {
     *     notBfforf      CfrtifidbtfVblidityDbtf,
     *     notAftfr       CfrtifidbtfVblidityDbtf }
     *
     * CfrtifidbtfVblidityDbtf ::= CHOICE {
     *     utdTimf        UTCTimf,
     *     gfnfrblTimf    GfnfrblizfdTimf }
     * </prf>
     *
     * @rfturn thf stbrt dbtf of thf vblidity pfriod.
     * @sff #dhfdkVblidity
     */
    publid bbstrbdt Dbtf gftNotBfforf();

    /**
     * Gfts thf {@dodf notAftfr} dbtf from thf vblidity pfriod of
     * thf dfrtifidbtf. Sff {@link #gftNotBfforf() gftNotBfforf}
     * for rflfvbnt ASN.1 dffinitions.
     *
     * @rfturn thf fnd dbtf of thf vblidity pfriod.
     * @sff #dhfdkVblidity
     */
    publid bbstrbdt Dbtf gftNotAftfr();

    /**
     * Gfts thf DER-fndodfd dfrtifidbtf informbtion, thf
     * {@dodf tbsCfrtifidbtf} from this dfrtifidbtf.
     * This dbn bf usfd to vfrify thf signbturf indfpfndfntly.
     *
     * @rfturn thf DER-fndodfd dfrtifidbtf informbtion.
     * @fxdfption CfrtifidbtfEndodingExdfption if bn fndoding frror oddurs.
     */
    publid bbstrbdt bytf[] gftTBSCfrtifidbtf()
        throws CfrtifidbtfEndodingExdfption;

    /**
     * Gfts thf {@dodf signbturf} vbluf (thf rbw signbturf bits) from
     * thf dfrtifidbtf.
     * Thf ASN.1 dffinition for this is:
     * <prf>
     * signbturf     BIT STRING
     * </prf>
     *
     * @rfturn thf signbturf.
     */
    publid bbstrbdt bytf[] gftSignbturf();

    /**
     * Gfts thf signbturf blgorithm nbmf for thf dfrtifidbtf
     * signbturf blgorithm. An fxbmplf is thf string "SHA256withRSA".
     * Thf ASN.1 dffinition for this is:
     * <prf>
     * signbturfAlgorithm   AlgorithmIdfntififr
     *
     * AlgorithmIdfntififr  ::=  SEQUENCE  {
     *     blgorithm               OBJECT IDENTIFIER,
     *     pbrbmftfrs              ANY DEFINED BY blgorithm OPTIONAL  }
     *                             -- dontbins b vbluf of thf typf
     *                             -- rfgistfrfd for usf with thf
     *                             -- blgorithm objfdt idfntififr vbluf
     * </prf>
     *
     * <p>Thf blgorithm nbmf is dftfrminfd from thf {@dodf blgorithm}
     * OID string.
     *
     * @rfturn thf signbturf blgorithm nbmf.
     */
    publid bbstrbdt String gftSigAlgNbmf();

    /**
     * Gfts thf signbturf blgorithm OID string from thf dfrtifidbtf.
     * An OID is rfprfsfntfd by b sft of nonnfgbtivf wholf numbfrs sfpbrbtfd
     * by pfriods.
     * For fxbmplf, thf string "1.2.840.10040.4.3" idfntififs thf SHA-1
     * with DSA signbturf blgorithm dffinfd in
     * <b hrff="http://www.iftf.org/rfd/rfd3279.txt">RFC 3279: Algorithms bnd
     * Idfntififrs for thf Intfrnft X.509 Publid Kfy Infrbstrudturf Cfrtifidbtf
     * bnd CRL Profilf</b>.
     *
     * <p>Sff {@link #gftSigAlgNbmf() gftSigAlgNbmf} for
     * rflfvbnt ASN.1 dffinitions.
     *
     * @rfturn thf signbturf blgorithm OID string.
     */
    publid bbstrbdt String gftSigAlgOID();

    /**
     * Gfts thf DER-fndodfd signbturf blgorithm pbrbmftfrs from this
     * dfrtifidbtf's signbturf blgorithm. In most dbsfs, thf signbturf
     * blgorithm pbrbmftfrs brf null; thf pbrbmftfrs brf usublly
     * supplifd with thf dfrtifidbtf's publid kfy.
     * If bddfss to individubl pbrbmftfr vblufs is nffdfd thfn usf
     * {@link jbvb.sfdurity.AlgorithmPbrbmftfrs AlgorithmPbrbmftfrs}
     * bnd instbntibtf with thf nbmf rfturnfd by
     * {@link #gftSigAlgNbmf() gftSigAlgNbmf}.
     *
     * <p>Sff {@link #gftSigAlgNbmf() gftSigAlgNbmf} for
     * rflfvbnt ASN.1 dffinitions.
     *
     * @rfturn thf DER-fndodfd signbturf blgorithm pbrbmftfrs, or
     *         null if no pbrbmftfrs brf prfsfnt.
     */
    publid bbstrbdt bytf[] gftSigAlgPbrbms();

    /**
     * Gfts thf {@dodf issufrUniqufID} vbluf from thf dfrtifidbtf.
     * Thf issufr uniquf idfntififr is prfsfnt in thf dfrtifidbtf
     * to hbndlf thf possibility of rfusf of issufr nbmfs ovfr timf.
     * RFC 3280 rfdommfnds thbt nbmfs not bf rfusfd bnd thbt
     * donforming dfrtifidbtfs not mbkf usf of uniquf idfntififrs.
     * Applidbtions donforming to thbt profilf should bf dbpbblf of
     * pbrsing uniquf idfntififrs bnd mbking dompbrisons.
     *
     * <p>Thf ASN.1 dffinition for this is:
     * <prf>
     * issufrUniqufID  [1]  IMPLICIT UniqufIdfntififr OPTIONAL
     *
     * UniqufIdfntififr  ::=  BIT STRING
     * </prf>
     *
     * @rfturn thf issufr uniquf idfntififr or null if it is not
     * prfsfnt in thf dfrtifidbtf.
     */
    publid bbstrbdt boolfbn[] gftIssufrUniqufID();

    /**
     * Gfts thf {@dodf subjfdtUniqufID} vbluf from thf dfrtifidbtf.
     *
     * <p>Thf ASN.1 dffinition for this is:
     * <prf>
     * subjfdtUniqufID  [2]  IMPLICIT UniqufIdfntififr OPTIONAL
     *
     * UniqufIdfntififr  ::=  BIT STRING
     * </prf>
     *
     * @rfturn thf subjfdt uniquf idfntififr or null if it is not
     * prfsfnt in thf dfrtifidbtf.
     */
    publid bbstrbdt boolfbn[] gftSubjfdtUniqufID();

    /**
     * Gfts b boolfbn brrby rfprfsfnting bits of
     * thf {@dodf KfyUsbgf} fxtfnsion, (OID = 2.5.29.15).
     * Thf kfy usbgf fxtfnsion dffinfs thf purposf (f.g., fndiphfrmfnt,
     * signbturf, dfrtifidbtf signing) of thf kfy dontbinfd in thf
     * dfrtifidbtf.
     * Thf ASN.1 dffinition for this is:
     * <prf>
     * KfyUsbgf ::= BIT STRING {
     *     digitblSignbturf        (0),
     *     nonRfpudibtion          (1),
     *     kfyEndiphfrmfnt         (2),
     *     dbtbEndiphfrmfnt        (3),
     *     kfyAgrffmfnt            (4),
     *     kfyCfrtSign             (5),
     *     dRLSign                 (6),
     *     fndiphfrOnly            (7),
     *     dfdiphfrOnly            (8) }
     * </prf>
     * RFC 3280 rfdommfnds thbt whfn usfd, this bf mbrkfd
     * bs b dritidbl fxtfnsion.
     *
     * @rfturn thf KfyUsbgf fxtfnsion of this dfrtifidbtf, rfprfsfntfd bs
     * bn brrby of boolfbns. Thf ordfr of KfyUsbgf vblufs in thf brrby is
     * thf sbmf bs in thf bbovf ASN.1 dffinition. Thf brrby will dontbin b
     * vbluf for fbdh KfyUsbgf dffinfd bbovf. If thf KfyUsbgf list fndodfd
     * in thf dfrtifidbtf is longfr thbn thf bbovf list, it will not bf
     * trundbtfd. Rfturns null if this dfrtifidbtf dofs not
     * dontbin b KfyUsbgf fxtfnsion.
     */
    publid bbstrbdt boolfbn[] gftKfyUsbgf();

    /**
     * Gfts bn unmodifibblf list of Strings rfprfsfnting thf OBJECT
     * IDENTIFIERs of thf {@dodf ExtKfyUsbgfSyntbx} fifld of thf
     * fxtfndfd kfy usbgf fxtfnsion, (OID = 2.5.29.37).  It indidbtfs
     * onf or morf purposfs for whidh thf dfrtififd publid kfy mby bf
     * usfd, in bddition to or in plbdf of thf bbsid purposfs
     * indidbtfd in thf kfy usbgf fxtfnsion fifld.  Thf ASN.1
     * dffinition for this is:
     * <prf>
     * ExtKfyUsbgfSyntbx ::= SEQUENCE SIZE (1..MAX) OF KfyPurposfId
     *
     * KfyPurposfId ::= OBJECT IDENTIFIER
     * </prf>
     *
     * Kfy purposfs mby bf dffinfd by bny orgbnizbtion with b
     * nffd. Objfdt idfntififrs usfd to idfntify kfy purposfs shbll bf
     * bssignfd in bddordbndf with IANA or ITU-T Rfd. X.660 |
     * ISO/IEC/ITU 9834-1.
     * <p>
     * This mfthod wbs bddfd to vfrsion 1.4 of thf Jbvb 2 Plbtform Stbndbrd
     * Edition. In ordfr to mbintbin bbdkwbrds dompbtibility with fxisting
     * sfrvidf providfrs, this mfthod is not {@dodf bbstrbdt}
     * bnd it providfs b dffbult implfmfntbtion. Subdlbssfs
     * should ovfrridf this mfthod with b dorrfdt implfmfntbtion.
     *
     * @rfturn thf ExtfndfdKfyUsbgf fxtfnsion of this dfrtifidbtf,
     *         bs bn unmodifibblf list of objfdt idfntififrs rfprfsfntfd
     *         bs Strings. Rfturns null if this dfrtifidbtf dofs not
     *         dontbin bn ExtfndfdKfyUsbgf fxtfnsion.
     * @throws CfrtifidbtfPbrsingExdfption if thf fxtfnsion dbnnot bf dfdodfd
     * @sindf 1.4
     */
    publid List<String> gftExtfndfdKfyUsbgf() throws CfrtifidbtfPbrsingExdfption {
        rfturn X509CfrtImpl.gftExtfndfdKfyUsbgf(this);
    }

    /**
     * Gfts thf dfrtifidbtf donstrbints pbth lfngth from thf
     * dritidbl {@dodf BbsidConstrbints} fxtfnsion, (OID = 2.5.29.19).
     * <p>
     * Thf bbsid donstrbints fxtfnsion idfntififs whfthfr thf subjfdt
     * of thf dfrtifidbtf is b Cfrtifidbtf Authority (CA) bnd
     * how dffp b dfrtifidbtion pbth mby fxist through thbt CA. Thf
     * {@dodf pbthLfnConstrbint} fifld (sff bflow) is mfbningful
     * only if {@dodf dA} is sft to TRUE. In this dbsf, it givfs thf
     * mbximum numbfr of CA dfrtifidbtfs thbt mby follow this dfrtifidbtf in b
     * dfrtifidbtion pbth. A vbluf of zfro indidbtfs thbt only bn fnd-fntity
     * dfrtifidbtf mby follow in thf pbth.
     * <p>
     * Thf ASN.1 dffinition for this is:
     * <prf>
     * BbsidConstrbints ::= SEQUENCE {
     *     dA                  BOOLEAN DEFAULT FALSE,
     *     pbthLfnConstrbint   INTEGER (0..MAX) OPTIONAL }
     * </prf>
     *
     * @rfturn thf vbluf of {@dodf pbthLfnConstrbint} if thf
     * BbsidConstrbints fxtfnsion is prfsfnt in thf dfrtifidbtf bnd thf
     * subjfdt of thf dfrtifidbtf is b CA, othfrwisf -1.
     * If thf subjfdt of thf dfrtifidbtf is b CA bnd
     * {@dodf pbthLfnConstrbint} dofs not bppfbr,
     * {@dodf Intfgfr.MAX_VALUE} is rfturnfd to indidbtf thbt thfrf is no
     * limit to thf bllowfd lfngth of thf dfrtifidbtion pbth.
     */
    publid bbstrbdt int gftBbsidConstrbints();

    /**
     * Gfts bn immutbblf dollfdtion of subjfdt bltfrnbtivf nbmfs from thf
     * {@dodf SubjfdtAltNbmf} fxtfnsion, (OID = 2.5.29.17).
     * <p>
     * Thf ASN.1 dffinition of thf {@dodf SubjfdtAltNbmf} fxtfnsion is:
     * <prf>
     * SubjfdtAltNbmf ::= GfnfrblNbmfs
     *
     * GfnfrblNbmfs :: = SEQUENCE SIZE (1..MAX) OF GfnfrblNbmf
     *
     * GfnfrblNbmf ::= CHOICE {
     *      othfrNbmf                       [0]     OthfrNbmf,
     *      rfd822Nbmf                      [1]     IA5String,
     *      dNSNbmf                         [2]     IA5String,
     *      x400Addrfss                     [3]     ORAddrfss,
     *      dirfdtoryNbmf                   [4]     Nbmf,
     *      fdiPbrtyNbmf                    [5]     EDIPbrtyNbmf,
     *      uniformRfsourdfIdfntififr       [6]     IA5String,
     *      iPAddrfss                       [7]     OCTET STRING,
     *      rfgistfrfdID                    [8]     OBJECT IDENTIFIER}
     * </prf>
     * <p>
     * If this dfrtifidbtf dofs not dontbin b {@dodf SubjfdtAltNbmf}
     * fxtfnsion, {@dodf null} is rfturnfd. Othfrwisf, b
     * {@dodf Collfdtion} is rfturnfd with bn fntry rfprfsfnting fbdh
     * {@dodf GfnfrblNbmf} indludfd in thf fxtfnsion. Ebdh fntry is b
     * {@dodf List} whosf first fntry is bn {@dodf Intfgfr}
     * (thf nbmf typf, 0-8) bnd whosf sfdond fntry is b {@dodf String}
     * or b bytf brrby (thf nbmf, in string or ASN.1 DER fndodfd form,
     * rfspfdtivfly).
     * <p>
     * <b hrff="http://www.iftf.org/rfd/rfd822.txt">RFC 822</b>, DNS, bnd URI
     * nbmfs brf rfturnfd bs {@dodf String}s,
     * using thf wfll-fstbblishfd string formbts for thosf typfs (subjfdt to
     * thf rfstridtions indludfd in RFC 3280). IPv4 bddrfss nbmfs brf
     * rfturnfd using dottfd qubd notbtion. IPv6 bddrfss nbmfs brf rfturnfd
     * in thf form "b1:b2:...:b8", whfrf b1-b8 brf hfxbdfdimbl vblufs
     * rfprfsfnting thf fight 16-bit pifdfs of thf bddrfss. OID nbmfs brf
     * rfturnfd bs {@dodf String}s rfprfsfntfd bs b sfrifs of nonnfgbtivf
     * intfgfrs sfpbrbtfd by pfriods. And dirfdtory nbmfs (distinguishfd nbmfs)
     * brf rfturnfd in <b hrff="http://www.iftf.org/rfd/rfd2253.txt">
     * RFC 2253</b> string formbt. No stbndbrd string formbt is
     * dffinfd for othfrNbmfs, X.400 nbmfs, EDI pbrty nbmfs, or bny
     * othfr typf of nbmfs. Thfy brf rfturnfd bs bytf brrbys
     * dontbining thf ASN.1 DER fndodfd form of thf nbmf.
     * <p>
     * Notf thbt thf {@dodf Collfdtion} rfturnfd mby dontbin morf
     * thbn onf nbmf of thf sbmf typf. Also, notf thbt thf rfturnfd
     * {@dodf Collfdtion} is immutbblf bnd bny fntrifs dontbining bytf
     * brrbys brf dlonfd to protfdt bgbinst subsfqufnt modifidbtions.
     * <p>
     * This mfthod wbs bddfd to vfrsion 1.4 of thf Jbvb 2 Plbtform Stbndbrd
     * Edition. In ordfr to mbintbin bbdkwbrds dompbtibility with fxisting
     * sfrvidf providfrs, this mfthod is not {@dodf bbstrbdt}
     * bnd it providfs b dffbult implfmfntbtion. Subdlbssfs
     * should ovfrridf this mfthod with b dorrfdt implfmfntbtion.
     *
     * @rfturn bn immutbblf {@dodf Collfdtion} of subjfdt bltfrnbtivf
     * nbmfs (or {@dodf null})
     * @throws CfrtifidbtfPbrsingExdfption if thf fxtfnsion dbnnot bf dfdodfd
     * @sindf 1.4
     */
    publid Collfdtion<List<?>> gftSubjfdtAltfrnbtivfNbmfs()
        throws CfrtifidbtfPbrsingExdfption {
        rfturn X509CfrtImpl.gftSubjfdtAltfrnbtivfNbmfs(this);
    }

    /**
     * Gfts bn immutbblf dollfdtion of issufr bltfrnbtivf nbmfs from thf
     * {@dodf IssufrAltNbmf} fxtfnsion, (OID = 2.5.29.18).
     * <p>
     * Thf ASN.1 dffinition of thf {@dodf IssufrAltNbmf} fxtfnsion is:
     * <prf>
     * IssufrAltNbmf ::= GfnfrblNbmfs
     * </prf>
     * Thf ASN.1 dffinition of {@dodf GfnfrblNbmfs} is dffinfd
     * in {@link #gftSubjfdtAltfrnbtivfNbmfs gftSubjfdtAltfrnbtivfNbmfs}.
     * <p>
     * If this dfrtifidbtf dofs not dontbin bn {@dodf IssufrAltNbmf}
     * fxtfnsion, {@dodf null} is rfturnfd. Othfrwisf, b
     * {@dodf Collfdtion} is rfturnfd with bn fntry rfprfsfnting fbdh
     * {@dodf GfnfrblNbmf} indludfd in thf fxtfnsion. Ebdh fntry is b
     * {@dodf List} whosf first fntry is bn {@dodf Intfgfr}
     * (thf nbmf typf, 0-8) bnd whosf sfdond fntry is b {@dodf String}
     * or b bytf brrby (thf nbmf, in string or ASN.1 DER fndodfd form,
     * rfspfdtivfly). For morf dftbils bbout thf formbts usfd for fbdh
     * nbmf typf, sff thf {@dodf gftSubjfdtAltfrnbtivfNbmfs} mfthod.
     * <p>
     * Notf thbt thf {@dodf Collfdtion} rfturnfd mby dontbin morf
     * thbn onf nbmf of thf sbmf typf. Also, notf thbt thf rfturnfd
     * {@dodf Collfdtion} is immutbblf bnd bny fntrifs dontbining bytf
     * brrbys brf dlonfd to protfdt bgbinst subsfqufnt modifidbtions.
     * <p>
     * This mfthod wbs bddfd to vfrsion 1.4 of thf Jbvb 2 Plbtform Stbndbrd
     * Edition. In ordfr to mbintbin bbdkwbrds dompbtibility with fxisting
     * sfrvidf providfrs, this mfthod is not {@dodf bbstrbdt}
     * bnd it providfs b dffbult implfmfntbtion. Subdlbssfs
     * should ovfrridf this mfthod with b dorrfdt implfmfntbtion.
     *
     * @rfturn bn immutbblf {@dodf Collfdtion} of issufr bltfrnbtivf
     * nbmfs (or {@dodf null})
     * @throws CfrtifidbtfPbrsingExdfption if thf fxtfnsion dbnnot bf dfdodfd
     * @sindf 1.4
     */
    publid Collfdtion<List<?>> gftIssufrAltfrnbtivfNbmfs()
        throws CfrtifidbtfPbrsingExdfption {
        rfturn X509CfrtImpl.gftIssufrAltfrnbtivfNbmfs(this);
    }

     /**
     * Vfrififs thbt this dfrtifidbtf wbs signfd using thf
     * privbtf kfy thbt dorrfsponds to thf spfdififd publid kfy.
     * This mfthod usfs thf signbturf vfrifidbtion fnginf
     * supplifd by thf spfdififd providfr. Notf thbt thf spfdififd
     * Providfr objfdt dofs not hbvf to bf rfgistfrfd in thf providfr list.
     *
     * This mfthod wbs bddfd to vfrsion 1.8 of thf Jbvb Plbtform Stbndbrd
     * Edition. In ordfr to mbintbin bbdkwbrds dompbtibility with fxisting
     * sfrvidf providfrs, this mfthod is not {@dodf bbstrbdt}
     * bnd it providfs b dffbult implfmfntbtion.
     *
     * @pbrbm kfy thf PublidKfy usfd to dbrry out thf vfrifidbtion.
     * @pbrbm sigProvidfr thf signbturf providfr.
     *
     * @fxdfption NoSudhAlgorithmExdfption on unsupportfd signbturf
     * blgorithms.
     * @fxdfption InvblidKfyExdfption on indorrfdt kfy.
     * @fxdfption SignbturfExdfption on signbturf frrors.
     * @fxdfption CfrtifidbtfExdfption on fndoding frrors.
     * @fxdfption UnsupportfdOpfrbtionExdfption if thf mfthod is not supportfd
     * @sindf 1.8
     */
    publid void vfrify(PublidKfy kfy, Providfr sigProvidfr)
        throws CfrtifidbtfExdfption, NoSudhAlgorithmExdfption,
        InvblidKfyExdfption, SignbturfExdfption {
        X509CfrtImpl.vfrify(this, kfy, sigProvidfr);
    }
}
