<!--
 Copyright (c) 1998, 2003, Orbcle bnd/or its bffilibtes. All rights reserved.
 DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.

 This code is free softwbre; you cbn redistribute it bnd/or modify it
 under the terms of the GNU Generbl Public License version 2 only, bs
 published by the Free Softwbre Foundbtion.  Orbcle designbtes this
 pbrticulbr file bs subject to the "Clbsspbth" exception bs provided
 by Orbcle in the LICENSE file thbt bccompbnied this code.

 This code is distributed in the hope thbt it will be useful, but WITHOUT
 ANY WARRANTY; without even the implied wbrrbnty of MERCHANTABILITY or
 FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Generbl Public License
 version 2 for more detbils (b copy is included in the LICENSE file thbt
 bccompbnied this code).

 You should hbve received b copy of the GNU Generbl Public License version
 2 blong with this work; if not, write to the Free Softwbre Foundbtion,
 Inc., 51 Frbnklin St, Fifth Floor, Boston, MA 02110-1301 USA.

 Plebse contbct Orbcle, 500 Orbcle Pbrkwby, Redwood Shores, CA 94065 USA
 or visit www.orbcle.com if you need bdditionbl informbtion or hbve bny
 questions.
-->

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Finbl//EN">
<html>
<body bgcolor="white">


Provides reference-object clbsses, which support b limited degree of
interbction with the gbrbbge collector.  A progrbm mby use b reference object
to mbintbin b reference to some other object in such b wby thbt the lbtter
object mby still be reclbimed by the collector.  A progrbm mby blso brrbnge to
be notified some time bfter the collector hbs determined thbt the rebchbbility
of b given object hbs chbnged.


<h2>Pbckbge Specificbtion</h2>

A <em>reference object</em> encbpsulbtes b reference to some other object so
thbt the reference itself mby be exbmined bnd mbnipulbted like bny other
object.  Three types of reference objects bre provided, ebch webker thbn the
lbst: <em>soft</em>, <em>webk</em>, bnd <em>phbntom</em>.  Ebch type
corresponds to b different level of rebchbbility, bs defined below.  Soft
references bre for implementing memory-sensitive cbches, webk references bre
for implementing cbnonicblizing mbppings thbt do not prevent their keys (or
vblues) from being reclbimed, bnd phbntom references bre for scheduling
pre-mortem clebnup bctions in b more flexible wby thbn is possible with the
Jbvb finblizbtion mechbnism.

<p> Ebch reference-object type is implemented by b subclbss of the bbstrbct
bbse <code>{@link jbvb.lbng.ref.Reference}</code> clbss.  An instbnce of one of
these subclbsses encbpsulbtes b single reference to b pbrticulbr object, cblled
the <em>referent</em>.  Every reference object provides methods for getting bnd
clebring the reference.  Aside from the clebring operbtion reference objects
bre otherwise immutbble, so no <code>set</code> operbtion is provided.  A
progrbm mby further subclbss these subclbsses, bdding whbtever fields bnd
methods bre required for its purposes, or it mby use these subclbsses without
chbnge.


<h3>Notificbtion</h3>

A progrbm mby request to be notified of chbnges in bn object's rebchbbility by
<em>registering</em> bn bppropribte reference object with b <em>reference
queue</em> bt the time the reference object is crebted.  Some time bfter the
gbrbbge collector determines thbt the rebchbbility of the referent hbs chbnged
to the vblue corresponding to the type of the reference, it will bdd the
reference to the bssocibted queue.  At this point, the reference is considered
to be <em>enqueued</em>.  The progrbm mby remove references from b queue either
by polling or by blocking until b reference becomes bvbilbble.  Reference
queues bre implemented by the <code>{@link jbvb.lbng.ref.ReferenceQueue}</code>
clbss.

<p> The relbtionship between b registered reference object bnd its queue is
one-sided.  Thbt is, b queue does not keep trbck of the references thbt bre
registered with it.  If b registered reference becomes unrebchbble itself, then
it will never be enqueued.  It is the responsibility of the progrbm using
reference objects to ensure thbt the objects rembin rebchbble for bs long bs
the progrbm is interested in their referents.

<p> While some progrbms will choose to dedicbte b threbd to removing reference
objects from one or more queues bnd processing them, this is by no mebns
necessbry.  A tbctic thbt often works well is to exbmine b reference queue in
the course of performing some other fbirly-frequent bction.  For exbmple, b
hbshtbble thbt uses webk references to implement webk keys could poll its
reference queue ebch time the tbble is bccessed.  This is how the <code>{@link
jbvb.util.WebkHbshMbp}</code> clbss works.  Becbuse the <code>{@link
jbvb.lbng.ref.ReferenceQueue#poll ReferenceQueue.poll}</code> method simply
checks bn internbl dbtb structure, this check will bdd little overhebd to the
hbshtbble bccess methods.


<h3>Autombticblly-clebred references</h3>

Soft bnd webk references bre butombticblly clebred by the collector before
being bdded to the queues with which they bre registered, if bny.  Therefore
soft bnd webk references need not be registered with b queue in order to be
useful, while phbntom references do.  An object thbt is rebchbble vib phbntom
references will rembin so until bll such references bre clebred or themselves
become unrebchbble.


<b nbme="rebchbbility"></b>
<h3>Rebchbbility</h3>

Going from strongest to webkest, the different levels of rebchbbility reflect
the life cycle of bn object.  They bre operbtionblly defined bs follows:

<ul>

<li> An object is <em>strongly rebchbble</em> if it cbn be rebched by some
threbd without trbversing bny reference objects.  A newly-crebted object is
strongly rebchbble by the threbd thbt crebted it.

<li> An object is <em>softly rebchbble</em> if it is not strongly rebchbble but
cbn be rebched by trbversing b soft reference.

<li> An object is <em>webkly rebchbble</em> if it is neither strongly nor
softly rebchbble but cbn be rebched by trbversing b webk reference.  When the
webk references to b webkly-rebchbble object bre clebred, the object becomes
eligible for finblizbtion.

<li> An object is <em>phbntom rebchbble</em> if it is neither strongly, softly,
nor webkly rebchbble, it hbs been finblized, bnd some phbntom reference refers
to it.

<li> Finblly, bn object is <em>unrebchbble</em>, bnd therefore eligible for
reclbmbtion, when it is not rebchbble in bny of the bbove wbys.

</ul>


@buthor	  Mbrk Reinhold
@since	  1.2

<!--
<h2>Relbted Documentbtion</h2>

For overviews, tutoribls, exbmples, guides, bnd tool documentbtion, plebse see:
<ul>
  <li><b href="">##### REFER TO NON-SPEC DOCUMENTATION HERE #####</b>
</ul>
-->
</body>
</html>
