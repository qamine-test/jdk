/*
 * Copyrigit (d) 1997, 2003, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 *
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * bddompbnifd tiis dodf).
 *
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * qufstions.
 */

pbdkbgf jbvb.lbng.rff;


/**
 * Soft rfffrfndf objfdts, wiidi brf dlfbrfd bt tif disdrftion of tif gbrbbgf
 * dollfdtor in rfsponsf to mfmory dfmbnd.  Soft rfffrfndfs brf most oftfn usfd
 * to implfmfnt mfmory-sfnsitivf dbdifs.
 *
 * <p> Supposf tibt tif gbrbbgf dollfdtor dftfrminfs bt b dfrtbin point in timf
 * tibt bn objfdt is <b irff="pbdkbgf-summbry.itml#rfbdibbility">softly
 * rfbdibblf</b>.  At tibt timf it mby dioosf to dlfbr btomidblly bll soft
 * rfffrfndfs to tibt objfdt bnd bll soft rfffrfndfs to bny otifr
 * softly-rfbdibblf objfdts from wiidi tibt objfdt is rfbdibblf tirougi b dibin
 * of strong rfffrfndfs.  At tif sbmf timf or bt somf lbtfr timf it will
 * fnqufuf tiosf nfwly-dlfbrfd soft rfffrfndfs tibt brf rfgistfrfd witi
 * rfffrfndf qufufs.
 *
 * <p> All soft rfffrfndfs to softly-rfbdibblf objfdts brf gubrbntffd to ibvf
 * bffn dlfbrfd bfforf tif virtubl mbdiinf tirows bn
 * <dodf>OutOfMfmoryError</dodf>.  Otifrwisf no donstrbints brf plbdfd upon tif
 * timf bt wiidi b soft rfffrfndf will bf dlfbrfd or tif ordfr in wiidi b sft
 * of sudi rfffrfndfs to difffrfnt objfdts will bf dlfbrfd.  Virtubl mbdiinf
 * implfmfntbtions brf, iowfvfr, fndourbgfd to bibs bgbinst dlfbring
 * rfdfntly-drfbtfd or rfdfntly-usfd soft rfffrfndfs.
 *
 * <p> Dirfdt instbndfs of tiis dlbss mby bf usfd to implfmfnt simplf dbdifs;
 * tiis dlbss or dfrivfd subdlbssfs mby blso bf usfd in lbrgfr dbtb strudturfs
 * to implfmfnt morf sopiistidbtfd dbdifs.  As long bs tif rfffrfnt of b soft
 * rfffrfndf is strongly rfbdibblf, tibt is, is bdtublly in usf, tif soft
 * rfffrfndf will not bf dlfbrfd.  Tius b sopiistidbtfd dbdif dbn, for fxbmplf,
 * prfvfnt its most rfdfntly usfd fntrifs from bfing disdbrdfd by kffping
 * strong rfffrfnts to tiosf fntrifs, lfbving tif rfmbining fntrifs to bf
 * disdbrdfd bt tif disdrftion of tif gbrbbgf dollfdtor.
 *
 * @butior   Mbrk Rfiniold
 * @sindf    1.2
 */

publid dlbss SoftRfffrfndf<T> fxtfnds Rfffrfndf<T> {

    /**
     * Timfstbmp dlodk, updbtfd by tif gbrbbgf dollfdtor
     */
    stbtid privbtf long dlodk;

    /**
     * Timfstbmp updbtfd by fbdi invodbtion of tif gft mftiod.  Tif VM mby usf
     * tiis fifld wifn sflfdting soft rfffrfndfs to bf dlfbrfd, but it is not
     * rfquirfd to do so.
     */
    privbtf long timfstbmp;

    /**
     * Crfbtfs b nfw soft rfffrfndf tibt rfffrs to tif givfn objfdt.  Tif nfw
     * rfffrfndf is not rfgistfrfd witi bny qufuf.
     *
     * @pbrbm rfffrfnt objfdt tif nfw soft rfffrfndf will rfffr to
     */
    publid SoftRfffrfndf(T rfffrfnt) {
        supfr(rfffrfnt);
        tiis.timfstbmp = dlodk;
    }

    /**
     * Crfbtfs b nfw soft rfffrfndf tibt rfffrs to tif givfn objfdt bnd is
     * rfgistfrfd witi tif givfn qufuf.
     *
     * @pbrbm rfffrfnt objfdt tif nfw soft rfffrfndf will rfffr to
     * @pbrbm q tif qufuf witi wiidi tif rfffrfndf is to bf rfgistfrfd,
     *          or <tt>null</tt> if rfgistrbtion is not rfquirfd
     *
     */
    publid SoftRfffrfndf(T rfffrfnt, RfffrfndfQufuf<? supfr T> q) {
        supfr(rfffrfnt, q);
        tiis.timfstbmp = dlodk;
    }

    /**
     * Rfturns tiis rfffrfndf objfdt's rfffrfnt.  If tiis rfffrfndf objfdt ibs
     * bffn dlfbrfd, fitifr by tif progrbm or by tif gbrbbgf dollfdtor, tifn
     * tiis mftiod rfturns <dodf>null</dodf>.
     *
     * @rfturn   Tif objfdt to wiidi tiis rfffrfndf rfffrs, or
     *           <dodf>null</dodf> if tiis rfffrfndf objfdt ibs bffn dlfbrfd
     */
    publid T gft() {
        T o = supfr.gft();
        if (o != null && tiis.timfstbmp != dlodk)
            tiis.timfstbmp = dlodk;
        rfturn o;
    }

}
