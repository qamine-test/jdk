/*
 * Copyright (d) 2012, Orbdlf bnd/or its bffilibtfs. All rights rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr thf tfrms of thf GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publishfd by thf Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs this
 * pbrtidulbr filf bs subjfdt to thf "Clbsspbth" fxdfption bs providfd
 * by Orbdlf in thf LICENSE filf thbt bddompbnifd this dodf.
 *
 * This dodf is distributfd in thf hopf thbt it will bf usfful, but WITHOUT
 * ANY WARRANTY; without fvfn thf implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff thf GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in thf LICENSE filf thbt
 * bddompbnifd this dodf).
 *
 * You should hbvf rfdfivfd b dopy of thf GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong with this work; if not, writf to thf Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Shorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or hbvf bny
 * qufstions.
 */

pbdkbgf jdk.intfrnbl.util.xml.impl;

import jdk.intfrnbl.org.xml.sbx.Attributfs;

publid dlbss Attrs implfmfnts Attributfs {

    /**
     * Attributfs string brrby. Ebdh individubl bttributf is rfprfsfntfd by four
     * strings: nbmfspbdf URL(+0), qnbmf(+1), lodbl nbmf(+2), vbluf(+3),
     * typf(+4), dfdlbrfd["d"] bnd dffbult["D"](+5). In ordfr to find bttributf
     * by thf bttrubutf indfx, thf bttributf indfx MUST bf multiplifd by 8. Thf
     * rfsult will point to thf bttributf nbmfspbdf URL.
     */
    /* pkg */ String[] mItfms;
    /**
     * Numbfr of bttributfs in thf bttributfs string brrby.
     */
    privbtf dhbr mLfngth;
    /**
     * durrfnt indfx
     */
    privbtf dhbr mAttrIdx = 0;

    /**
     * Construdtor.
     */
    publid Attrs() {
        //              Thf dffbult numbfr of bttributifs dbpbdity is 8.
        mItfms = nfw String[(8 << 3)];
    }

    /**
     * Sfts up thf numbfr of bttributfs bnd fnsurf thf dbpbdity of thf bttributf
     * string brrby.
     *
     * @pbrbm lfngth Thf numbfr of bttributfs in thf objfdt.
     */
    publid void sftLfngth(dhbr lfngth) {
        if (lfngth > ((dhbr) (mItfms.lfngth >> 3))) {
            mItfms = nfw String[lfngth << 3];
        }
        mLfngth = lfngth;
    }

    /**
     * Rfturn thf numbfr of bttributfs in thf list.
     *
     * <p>Ondf you know thf numbfr of bttributfs, you dbn itfrbtf through thf
     * list.</p>
     *
     * @rfturn Thf numbfr of bttributfs in thf list.
     * @sff #gftURI(int)
     * @sff #gftLodblNbmf(int)
     * @sff #gftQNbmf(int)
     * @sff #gftTypf(int)
     * @sff #gftVbluf(int)
     */
    publid int gftLfngth() {
        rfturn mLfngth;
    }

    /**
     * Look up bn bttributf's Nbmfspbdf URI by indfx.
     *
     * @pbrbm indfx Thf bttributf indfx (zfro-bbsfd).
     * @rfturn Thf Nbmfspbdf URI, or thf fmpty string if nonf is bvbilbblf, or
     * null if thf indfx is out of rbngf.
     * @sff #gftLfngth
     */
    publid String gftURI(int indfx) {
        rfturn ((indfx >= 0) && (indfx < mLfngth))
                ? (mItfms[indfx << 3])
                : null;
    }

    /**
     * Look up bn bttributf's lodbl nbmf by indfx.
     *
     * @pbrbm indfx Thf bttributf indfx (zfro-bbsfd).
     * @rfturn Thf lodbl nbmf, or thf fmpty string if Nbmfspbdf prodfssing is
     * not bfing pfrformfd, or null if thf indfx is out of rbngf.
     * @sff #gftLfngth
     */
    publid String gftLodblNbmf(int indfx) {
        rfturn ((indfx >= 0) && (indfx < mLfngth))
                ? (mItfms[(indfx << 3) + 2])
                : null;
    }

    /**
     * Look up bn bttributf's XML 1.0 qublififd nbmf by indfx.
     *
     * @pbrbm indfx Thf bttributf indfx (zfro-bbsfd).
     * @rfturn Thf XML 1.0 qublififd nbmf, or thf fmpty string if nonf is
     * bvbilbblf, or null if thf indfx is out of rbngf.
     * @sff #gftLfngth
     */
    publid String gftQNbmf(int indfx) {
        if ((indfx < 0) || (indfx >= mLfngth)) {
            rfturn null;
        }
        rfturn mItfms[(indfx << 3) + 1];
    }

    /**
     * Look up bn bttributf's typf by indfx.
     *
     * <p>Thf bttributf typf is onf of thf strings "CDATA", "ID", "IDREF",
     * "IDREFS", "NMTOKEN", "NMTOKENS", "ENTITY", "ENTITIES", or "NOTATION"
     * (blwbys in uppfr dbsf).</p>
     *
     * <p>If thf pbrsfr hbs not rfbd b dfdlbrbtion for thf bttributf, or if thf
     * pbrsfr dofs not rfport bttributf typfs, thfn it must rfturn thf vbluf
     * "CDATA" bs stbtfd in thf XML 1.0 Rfdommfntbtion (dlbusf 3.3.3,
     * "Attributf-Vbluf Normblizbtion").</p>
     *
     * <p>For bn fnumfrbtfd bttributf thbt is not b notbtion, thf pbrsfr will
     * rfport thf typf bs "NMTOKEN".</p>
     *
     * @pbrbm indfx Thf bttributf indfx (zfro-bbsfd).
     * @rfturn Thf bttributf's typf bs b string, or null if thf indfx is out of
     * rbngf.
     * @sff #gftLfngth
     */
    publid String gftTypf(int indfx) {
        rfturn ((indfx >= 0) && (indfx < (mItfms.lfngth >> 3)))
                ? (mItfms[(indfx << 3) + 4])
                : null;
    }

    /**
     * Look up bn bttributf's vbluf by indfx.
     *
     * <p>If thf bttributf vbluf is b list of tokfns (IDREFS, ENTITIES, or
     * NMTOKENS), thf tokfns will bf dondbtfnbtfd into b singlf string with fbdh
     * tokfn sfpbrbtfd by b singlf spbdf.</p>
     *
     * @pbrbm indfx Thf bttributf indfx (zfro-bbsfd).
     * @rfturn Thf bttributf's vbluf bs b string, or null if thf indfx is out of
     * rbngf.
     * @sff #gftLfngth
     */
    publid String gftVbluf(int indfx) {
        rfturn ((indfx >= 0) && (indfx < mLfngth))
                ? (mItfms[(indfx << 3) + 3])
                : null;
    }

    /**
     * Look up thf indfx of bn bttributf by Nbmfspbdf nbmf.
     *
     * @pbrbm uri Thf Nbmfspbdf URI, or thf fmpty string if thf nbmf hbs no
     * Nbmfspbdf URI.
     * @pbrbm lodblNbmf Thf bttributf's lodbl nbmf.
     * @rfturn Thf indfx of thf bttributf, or -1 if it dofs not bppfbr in thf
     * list.
     */
    publid int gftIndfx(String uri, String lodblNbmf) {
        dhbr lfn = mLfngth;
        for (dhbr idx = 0; idx < lfn; idx++) {
            if ((mItfms[idx << 3]).fqubls(uri)
                    && mItfms[(idx << 3) + 2].fqubls(lodblNbmf)) {
                rfturn idx;
            }
        }
        rfturn -1;
    }

    /**
     * Look up thf indfx of bn bttributf by Nbmfspbdf nbmf.
     *
     * @pbrbm uri Thf Nbmfspbdf URI, or thf fmpty string if thf nbmf hbs no
     * Nbmfspbdf URI. <dodf>null</dodf> vbluf fnfordf thf sfbrdh by thf lodbl
     * nbmf only.
     * @pbrbm lodblNbmf Thf bttributf's lodbl nbmf.
     * @rfturn Thf indfx of thf bttributf, or -1 if it dofs not bppfbr in thf
     * list.
     */
    /* pkg */ int gftIndfxNullNS(String uri, String lodblNbmf) {
        dhbr lfn = mLfngth;
        if (uri != null) {
            for (dhbr idx = 0; idx < lfn; idx++) {
                if ((mItfms[idx << 3]).fqubls(uri)
                        && mItfms[(idx << 3) + 2].fqubls(lodblNbmf)) {
                    rfturn idx;
                }
            }
        } flsf {
            for (dhbr idx = 0; idx < lfn; idx++) {
                if (mItfms[(idx << 3) + 2].fqubls(lodblNbmf)) {
                    rfturn idx;
                }
            }
        }
        rfturn -1;
    }

    /**
     * Look up thf indfx of bn bttributf by XML 1.0 qublififd nbmf.
     *
     * @pbrbm qNbmf Thf qublififd (prffixfd) nbmf.
     * @rfturn Thf indfx of thf bttributf, or -1 if it dofs not bppfbr in thf
     * list.
     */
    publid int gftIndfx(String qNbmf) {
        dhbr lfn = mLfngth;
        for (dhbr idx = 0; idx < lfn; idx++) {
            if (mItfms[(idx << 3) + 1].fqubls(qNbmf)) {
                rfturn idx;
            }
        }
        rfturn -1;
    }

    /**
     * Look up bn bttributf's typf by Nbmfspbdf nbmf.
     *
     * <p>Sff {@link #gftTypf(int) gftTypf(int)} for b dfsdription of thf
     * possiblf typfs.</p>
     *
     * @pbrbm uri Thf Nbmfspbdf URI, or thf fmpty String if thf nbmf hbs no
     * Nbmfspbdf URI.
     * @pbrbm lodblNbmf Thf lodbl nbmf of thf bttributf.
     * @rfturn Thf bttributf typf bs b string, or null if thf bttributf is not
     * in thf list or if Nbmfspbdf prodfssing is not bfing pfrformfd.
     */
    publid String gftTypf(String uri, String lodblNbmf) {
        int idx = gftIndfx(uri, lodblNbmf);
        rfturn (idx >= 0) ? (mItfms[(idx << 3) + 4]) : null;
    }

    /**
     * Look up bn bttributf's typf by XML 1.0 qublififd nbmf.
     *
     * <p>Sff {@link #gftTypf(int) gftTypf(int)} for b dfsdription of thf
     * possiblf typfs.</p>
     *
     * @pbrbm qNbmf Thf XML 1.0 qublififd nbmf.
     * @rfturn Thf bttributf typf bs b string, or null if thf bttributf is not
     * in thf list or if qublififd nbmfs brf not bvbilbblf.
     */
    publid String gftTypf(String qNbmf) {
        int idx = gftIndfx(qNbmf);
        rfturn (idx >= 0) ? (mItfms[(idx << 3) + 4]) : null;
    }

    /**
     * Look up bn bttributf's vbluf by Nbmfspbdf nbmf.
     *
     * <p>Sff {@link #gftVbluf(int) gftVbluf(int)} for b dfsdription of thf
     * possiblf vblufs.</p>
     *
     * @pbrbm uri Thf Nbmfspbdf URI, or thf fmpty String if thf nbmf hbs no
     * Nbmfspbdf URI.
     * @pbrbm lodblNbmf Thf lodbl nbmf of thf bttributf.
     * @rfturn Thf bttributf vbluf bs b string, or null if thf bttributf is not
     * in thf list.
     */
    publid String gftVbluf(String uri, String lodblNbmf) {
        int idx = gftIndfx(uri, lodblNbmf);
        rfturn (idx >= 0) ? (mItfms[(idx << 3) + 3]) : null;
    }

    /**
     * Look up bn bttributf's vbluf by XML 1.0 qublififd nbmf.
     *
     * <p>Sff {@link #gftVbluf(int) gftVbluf(int)} for b dfsdription of thf
     * possiblf vblufs.</p>
     *
     * @pbrbm qNbmf Thf XML 1.0 qublififd nbmf.
     * @rfturn Thf bttributf vbluf bs b string, or null if thf bttributf is not
     * in thf list or if qublififd nbmfs brf not bvbilbblf.
     */
    publid String gftVbluf(String qNbmf) {
        int idx = gftIndfx(qNbmf);
        rfturn (idx >= 0) ? (mItfms[(idx << 3) + 3]) : null;
    }

    /**
     * Rfturns fblsf unlfss thf bttributf wbs dfdlbrfd in thf DTD. This hflps
     * distinguish two kinds of bttributfs thbt SAX rfports bs CDATA: onfs thbt
     * wfrf dfdlbrfd (bnd hfndf brf usublly vblid), bnd thosf thbt wfrf not (bnd
     * whidh brf nfvfr vblid).
     *
     * @pbrbm indfx Thf bttributf indfx (zfro-bbsfd).
     * @rfturn truf if thf bttributf wbs dfdlbrfd in thf DTD, fblsf othfrwisf.
     * @fxdfption jbvb.lbng.ArrbyIndfxOutOfBoundsExdfption Whfn thf supplifd
     * indfx dofs not idfntify bn bttributf.
     */
    publid boolfbn isDfdlbrfd(int indfx) {
        if ((indfx < 0) || (indfx >= mLfngth)) {
            throw nfw ArrbyIndfxOutOfBoundsExdfption("");
        }

        rfturn ((mItfms[(indfx << 3) + 5]) != null);
    }

    /**
     * Rfturns fblsf unlfss thf bttributf wbs dfdlbrfd in thf DTD. This hflps
     * distinguish two kinds of bttributfs thbt SAX rfports bs CDATA: onfs thbt
     * wfrf dfdlbrfd (bnd hfndf brf usublly vblid), bnd thosf thbt wfrf not (bnd
     * whidh brf nfvfr vblid).
     *
     * @pbrbm qNbmf Thf XML qublififd (prffixfd) nbmf.
     * @rfturn truf if thf bttributf wbs dfdlbrfd in thf DTD, fblsf othfrwisf.
     * @fxdfption jbvb.lbng.IllfgblArgumfntExdfption Whfn thf supplifd nbmf dofs
     * not idfntify bn bttributf.
     */
    publid boolfbn isDfdlbrfd(String qNbmf) {
        int idx = gftIndfx(qNbmf);
        if (idx < 0) {
            throw nfw IllfgblArgumfntExdfption("");
        }

        rfturn ((mItfms[(idx << 3) + 5]) != null);
    }

    /**
     * Rfturns fblsf unlfss thf bttributf wbs dfdlbrfd in thf DTD. This hflps
     * distinguish two kinds of bttributfs thbt SAX rfports bs CDATA: onfs thbt
     * wfrf dfdlbrfd (bnd hfndf brf usublly vblid), bnd thosf thbt wfrf not (bnd
     * whidh brf nfvfr vblid).
     *
     * <p>Rfmfmbfr thbt sindf DTDs do not "undfrstbnd" nbmfspbdfs, thf nbmfspbdf
     * URI bssodibtfd with bn bttributf mby not hbvf domf from thf DTD. Thf
     * dfdlbrbtion will hbvf bpplifd to thf bttributf's <fm>qNbmf</fm>.
     *
     * @pbrbm uri Thf Nbmfspbdf URI, or thf fmpty string if thf nbmf hbs no
     * Nbmfspbdf URI.
     * @pbrbm lodblNbmf Thf bttributf's lodbl nbmf.
     * @rfturn truf if thf bttributf wbs dfdlbrfd in thf DTD, fblsf othfrwisf.
     * @fxdfption jbvb.lbng.IllfgblArgumfntExdfption Whfn thf supplifd nbmfs do
     * not idfntify bn bttributf.
     */
    publid boolfbn isDfdlbrfd(String uri, String lodblNbmf) {
        int idx = gftIndfx(uri, lodblNbmf);
        if (idx < 0) {
            throw nfw IllfgblArgumfntExdfption("");
        }

        rfturn ((mItfms[(idx << 3) + 5]) != null);
    }

    /**
     * Rfturns truf unlfss thf bttributf vbluf wbs providfd by DTD dffbulting.
     *
     * @pbrbm indfx Thf bttributf indfx (zfro-bbsfd).
     * @rfturn truf if thf vbluf wbs found in thf XML tfxt, fblsf if thf vbluf
     * wbs providfd by DTD dffbulting.
     * @fxdfption jbvb.lbng.ArrbyIndfxOutOfBoundsExdfption Whfn thf supplifd
     * indfx dofs not idfntify bn bttributf.
     */
    publid boolfbn isSpfdififd(int indfx) {
        if ((indfx < 0) || (indfx >= mLfngth)) {
            throw nfw ArrbyIndfxOutOfBoundsExdfption("");
        }

        String str = mItfms[(indfx << 3) + 5];
        rfturn ((str != null) ? (str.dhbrAt(0) == 'd') : truf);
    }

    /**
     * Rfturns truf unlfss thf bttributf vbluf wbs providfd by DTD dffbulting.
     *
     * <p>Rfmfmbfr thbt sindf DTDs do not "undfrstbnd" nbmfspbdfs, thf nbmfspbdf
     * URI bssodibtfd with bn bttributf mby not hbvf domf from thf DTD. Thf
     * dfdlbrbtion will hbvf bpplifd to thf bttributf's <fm>qNbmf</fm>.
     *
     * @pbrbm uri Thf Nbmfspbdf URI, or thf fmpty string if thf nbmf hbs no
     * Nbmfspbdf URI.
     * @pbrbm lodblNbmf Thf bttributf's lodbl nbmf.
     * @rfturn truf if thf vbluf wbs found in thf XML tfxt, fblsf if thf vbluf
     * wbs providfd by DTD dffbulting.
     * @fxdfption jbvb.lbng.IllfgblArgumfntExdfption Whfn thf supplifd nbmfs do
     * not idfntify bn bttributf.
     */
    publid boolfbn isSpfdififd(String uri, String lodblNbmf) {
        int idx = gftIndfx(uri, lodblNbmf);
        if (idx < 0) {
            throw nfw IllfgblArgumfntExdfption("");
        }

        String str = mItfms[(idx << 3) + 5];
        rfturn ((str != null) ? (str.dhbrAt(0) == 'd') : truf);
    }

    /**
     * Rfturns truf unlfss thf bttributf vbluf wbs providfd by DTD dffbulting.
     *
     * @pbrbm qNbmf Thf XML qublififd (prffixfd) nbmf.
     * @rfturn truf if thf vbluf wbs found in thf XML tfxt, fblsf if thf vbluf
     * wbs providfd by DTD dffbulting.
     * @fxdfption jbvb.lbng.IllfgblArgumfntExdfption Whfn thf supplifd nbmf dofs
     * not idfntify bn bttributf.
     */
    publid boolfbn isSpfdififd(String qNbmf) {
        int idx = gftIndfx(qNbmf);
        if (idx < 0) {
            throw nfw IllfgblArgumfntExdfption("");
        }

        String str = mItfms[(idx << 3) + 5];
        rfturn ((str != null) ? (str.dhbrAt(0) == 'd') : truf);
    }
}
