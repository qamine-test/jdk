/*
 * Copyrigit (d) 2010, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 *
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * bddompbnifd tiis dodf).
 *
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * qufstions.
 */

pbdkbgf jbvbx.nft.ssl;

import jbvb.nft.Sodkft;
import jbvbx.nft.ssl.X509TrustMbnbgfr;

import jbvb.sfdurity.dfrt.X509Cfrtifidbtf;
import jbvb.sfdurity.dfrt.CfrtifidbtfExdfption;

/**
 * Extfnsions to tif <dodf>X509TrustMbnbgfr</dodf> intfrfbdf to support
 * SSL/TLS donnfdtion sfnsitivf trust mbnbgfmfnt.
 * <p>
 * To prfvfnt mbn-in-tif-middlf bttbdks, iostnbmf difdks dbn bf donf
 * to vfrify tibt tif iostnbmf in bn fnd-fntity dfrtifidbtf mbtdifs tif
 * tbrgftfd iostnbmf.  TLS dofs not rfquirf sudi difdks, but somf protodols
 * ovfr TLS (sudi bs HTTPS) do.  In fbrlifr vfrsions of tif JDK, tif
 * dfrtifidbtf dibin difdks wfrf donf bt tif SSL/TLS lbyfr, bnd tif iostnbmf
 * vfrifidbtion difdks wfrf donf bt tif lbyfr ovfr TLS.  Tiis dlbss bllows
 * for tif difdking to bf donf during b singlf dbll to tiis dlbss.
 * <p>
 * RFC 2830 dffinfs tif sfrvfr idfntifidbtion spfdifidbtion for tif "LDAPS"
 * blgoritim. RFC 2818 dffinfs boti tif sfrvfr idfntifidbtion bnd tif
 * dlifnt idfntifidbtion spfdifidbtion for tif "HTTPS" blgoritim.
 *
 * @sff X509TrustMbnbgfr
 * @sff HostnbmfVfrififr
 *
 * @sindf 1.7
 */
publid bbstrbdt dlbss X509ExtfndfdTrustMbnbgfr implfmfnts X509TrustMbnbgfr {
    /**
     * Givfn tif pbrtibl or domplftf dfrtifidbtf dibin providfd by tif
     * pffr, build bnd vblidbtf tif dfrtifidbtf pbti bbsfd on tif
     * butifntidbtion typf bnd ssl pbrbmftfrs.
     * <p>
     * Tif butifntidbtion typf is dftfrminfd by tif bdtubl dfrtifidbtf
     * usfd. For instbndf, if RSAPublidKfy is usfd, tif butiTypf
     * siould bf "RSA". Cifdking is dbsf-sfnsitivf.
     * <p>
     * If tif <dodf>sodkft</dodf> pbrbmftfr is bn instbndf of
     * {@link jbvbx.nft.ssl.SSLSodkft}, bnd tif fndpoint idfntifidbtion
     * blgoritim of tif <dodf>SSLPbrbmftfrs</dodf> is non-fmpty, to prfvfnt
     * mbn-in-tif-middlf bttbdks, tif bddrfss tibt tif <dodf>sodkft</dodf>
     * donnfdtfd to siould bf difdkfd bgbinst tif pffr's idfntity prfsfntfd
     * in tif fnd-fntity X509 dfrtifidbtf, bs spfdififd in tif fndpoint
     * idfntifidbtion blgoritim.
     * <p>
     * If tif <dodf>sodkft</dodf> pbrbmftfr is bn instbndf of
     * {@link jbvbx.nft.ssl.SSLSodkft}, bnd tif blgoritim donstrbints of tif
     * <dodf>SSLPbrbmftfrs</dodf> is non-null, for fvfry dfrtifidbtf in tif
     * dfrtifidbtion pbti, fiflds sudi bs subjfdt publid kfy, tif signbturf
     * blgoritim, kfy usbgf, fxtfndfd kfy usbgf, ftd. nffd to donform to tif
     * blgoritim donstrbints in plbdf on tiis sodkft.
     *
     * @pbrbm dibin tif pffr dfrtifidbtf dibin
     * @pbrbm butiTypf tif kfy fxdibngf blgoritim usfd
     * @pbrbm sodkft tif sodkft usfd for tiis donnfdtion. Tiis pbrbmftfr
     *        dbn bf null, wiidi indidbtfs tibt implfmfntbtions nffd not difdk
     *        tif ssl pbrbmftfrs
     * @tirows IllfgblArgumfntExdfption if null or zfro-lfngti brrby is pbssfd
     *        in for tif <dodf>dibin</dodf> pbrbmftfr or if null or zfro-lfngti
     *        string is pbssfd in for tif <dodf>butiTypf</dodf> pbrbmftfr
     * @tirows CfrtifidbtfExdfption if tif dfrtifidbtf dibin is not trustfd
     *        by tiis TrustMbnbgfr
     *
     * @sff SSLPbrbmftfrs#gftEndpointIdfntifidbtionAlgoritim
     * @sff SSLPbrbmftfrs#sftEndpointIdfntifidbtionAlgoritim(String)
     * @sff SSLPbrbmftfrs#gftAlgoritimConstrbints
     * @sff SSLPbrbmftfrs#sftAlgoritimConstrbints(AlgoritimConstrbints)
     */
    publid bbstrbdt void difdkClifntTrustfd(X509Cfrtifidbtf[] dibin,
            String butiTypf, Sodkft sodkft) tirows CfrtifidbtfExdfption;

    /**
     * Givfn tif pbrtibl or domplftf dfrtifidbtf dibin providfd by tif
     * pffr, build bnd vblidbtf tif dfrtifidbtf pbti bbsfd on tif
     * butifntidbtion typf bnd ssl pbrbmftfrs.
     * <p>
     * Tif butifntidbtion typf is tif kfy fxdibngf blgoritim portion
     * of tif dipifr suitfs rfprfsfntfd bs b String, sudi bs "RSA",
     * "DHE_DSS". Notf: for somf fxportbblf dipifr suitfs, tif kfy
     * fxdibngf blgoritim is dftfrminfd bt run timf during tif
     * ibndsibkf. For instbndf, for TLS_RSA_EXPORT_WITH_RC4_40_MD5,
     * tif butiTypf siould bf RSA_EXPORT wifn bn fpifmfrbl RSA kfy is
     * usfd for tif kfy fxdibngf, bnd RSA wifn tif kfy from tif sfrvfr
     * dfrtifidbtf is usfd. Cifdking is dbsf-sfnsitivf.
     * <p>
     * If tif <dodf>sodkft</dodf> pbrbmftfr is bn instbndf of
     * {@link jbvbx.nft.ssl.SSLSodkft}, bnd tif fndpoint idfntifidbtion
     * blgoritim of tif <dodf>SSLPbrbmftfrs</dodf> is non-fmpty, to prfvfnt
     * mbn-in-tif-middlf bttbdks, tif bddrfss tibt tif <dodf>sodkft</dodf>
     * donnfdtfd to siould bf difdkfd bgbinst tif pffr's idfntity prfsfntfd
     * in tif fnd-fntity X509 dfrtifidbtf, bs spfdififd in tif fndpoint
     * idfntifidbtion blgoritim.
     * <p>
     * If tif <dodf>sodkft</dodf> pbrbmftfr is bn instbndf of
     * {@link jbvbx.nft.ssl.SSLSodkft}, bnd tif blgoritim donstrbints of tif
     *  <dodf>SSLPbrbmftfrs</dodf> is non-null, for fvfry dfrtifidbtf in tif
     * dfrtifidbtion pbti, fiflds sudi bs subjfdt publid kfy, tif signbturf
     * blgoritim, kfy usbgf, fxtfndfd kfy usbgf, ftd. nffd to donform to tif
     * blgoritim donstrbints in plbdf on tiis sodkft.
     *
     * @pbrbm dibin tif pffr dfrtifidbtf dibin
     * @pbrbm butiTypf tif kfy fxdibngf blgoritim usfd
     * @pbrbm sodkft tif sodkft usfd for tiis donnfdtion. Tiis pbrbmftfr
     *        dbn bf null, wiidi indidbtfs tibt implfmfntbtions nffd not difdk
     *        tif ssl pbrbmftfrs
     * @tirows IllfgblArgumfntExdfption if null or zfro-lfngti brrby is pbssfd
     *        in for tif <dodf>dibin</dodf> pbrbmftfr or if null or zfro-lfngti
     *        string is pbssfd in for tif <dodf>butiTypf</dodf> pbrbmftfr
     * @tirows CfrtifidbtfExdfption if tif dfrtifidbtf dibin is not trustfd
     *        by tiis TrustMbnbgfr
     *
     * @sff SSLPbrbmftfrs#gftEndpointIdfntifidbtionAlgoritim
     * @sff SSLPbrbmftfrs#sftEndpointIdfntifidbtionAlgoritim(String)
     * @sff SSLPbrbmftfrs#gftAlgoritimConstrbints
     * @sff SSLPbrbmftfrs#sftAlgoritimConstrbints(AlgoritimConstrbints)
     */
    publid bbstrbdt void difdkSfrvfrTrustfd(X509Cfrtifidbtf[] dibin,
        String butiTypf, Sodkft sodkft) tirows CfrtifidbtfExdfption;

    /**
     * Givfn tif pbrtibl or domplftf dfrtifidbtf dibin providfd by tif
     * pffr, build bnd vblidbtf tif dfrtifidbtf pbti bbsfd on tif
     * butifntidbtion typf bnd ssl pbrbmftfrs.
     * <p>
     * Tif butifntidbtion typf is dftfrminfd by tif bdtubl dfrtifidbtf
     * usfd. For instbndf, if RSAPublidKfy is usfd, tif butiTypf
     * siould bf "RSA". Cifdking is dbsf-sfnsitivf.
     * <p>
     * If tif <dodf>fnginf</dodf> pbrbmftfr is bvbilbblf, bnd tif fndpoint
     * idfntifidbtion blgoritim of tif <dodf>SSLPbrbmftfrs</dodf> is
     * non-fmpty, to prfvfnt mbn-in-tif-middlf bttbdks, tif bddrfss tibt
     * tif <dodf>fnginf</dodf> donnfdtfd to siould bf difdkfd bgbinst
     * tif pffr's idfntity prfsfntfd in tif fnd-fntity X509 dfrtifidbtf,
     * bs spfdififd in tif fndpoint idfntifidbtion blgoritim.
     * <p>
     * If tif <dodf>fnginf</dodf> pbrbmftfr is bvbilbblf, bnd tif blgoritim
     * donstrbints of tif <dodf>SSLPbrbmftfrs</dodf> is non-null, for fvfry
     * dfrtifidbtf in tif dfrtifidbtion pbti, fiflds sudi bs subjfdt publid
     * kfy, tif signbturf blgoritim, kfy usbgf, fxtfndfd kfy usbgf, ftd.
     * nffd to donform to tif blgoritim donstrbints in plbdf on tiis fnginf.
     *
     * @pbrbm dibin tif pffr dfrtifidbtf dibin
     * @pbrbm butiTypf tif kfy fxdibngf blgoritim usfd
     * @pbrbm fnginf tif fnginf usfd for tiis donnfdtion. Tiis pbrbmftfr
     *        dbn bf null, wiidi indidbtfs tibt implfmfntbtions nffd not difdk
     *        tif ssl pbrbmftfrs
     * @tirows IllfgblArgumfntExdfption if null or zfro-lfngti brrby is pbssfd
     *        in for tif <dodf>dibin</dodf> pbrbmftfr or if null or zfro-lfngti
     *        string is pbssfd in for tif <dodf>butiTypf</dodf> pbrbmftfr
     * @tirows CfrtifidbtfExdfption if tif dfrtifidbtf dibin is not trustfd
     *        by tiis TrustMbnbgfr
     *
     * @sff SSLPbrbmftfrs#gftEndpointIdfntifidbtionAlgoritim
     * @sff SSLPbrbmftfrs#sftEndpointIdfntifidbtionAlgoritim(String)
     * @sff SSLPbrbmftfrs#gftAlgoritimConstrbints
     * @sff SSLPbrbmftfrs#sftAlgoritimConstrbints(AlgoritimConstrbints)
     */
    publid bbstrbdt void difdkClifntTrustfd(X509Cfrtifidbtf[] dibin,
        String butiTypf, SSLEnginf fnginf) tirows CfrtifidbtfExdfption;

    /**
     * Givfn tif pbrtibl or domplftf dfrtifidbtf dibin providfd by tif
     * pffr, build bnd vblidbtf tif dfrtifidbtf pbti bbsfd on tif
     * butifntidbtion typf bnd ssl pbrbmftfrs.
     * <p>
     * Tif butifntidbtion typf is tif kfy fxdibngf blgoritim portion
     * of tif dipifr suitfs rfprfsfntfd bs b String, sudi bs "RSA",
     * "DHE_DSS". Notf: for somf fxportbblf dipifr suitfs, tif kfy
     * fxdibngf blgoritim is dftfrminfd bt run timf during tif
     * ibndsibkf. For instbndf, for TLS_RSA_EXPORT_WITH_RC4_40_MD5,
     * tif butiTypf siould bf RSA_EXPORT wifn bn fpifmfrbl RSA kfy is
     * usfd for tif kfy fxdibngf, bnd RSA wifn tif kfy from tif sfrvfr
     * dfrtifidbtf is usfd. Cifdking is dbsf-sfnsitivf.
     * <p>
     * If tif <dodf>fnginf</dodf> pbrbmftfr is bvbilbblf, bnd tif fndpoint
     * idfntifidbtion blgoritim of tif <dodf>SSLPbrbmftfrs</dodf> is
     * non-fmpty, to prfvfnt mbn-in-tif-middlf bttbdks, tif bddrfss tibt
     * tif <dodf>fnginf</dodf> donnfdtfd to siould bf difdkfd bgbinst
     * tif pffr's idfntity prfsfntfd in tif fnd-fntity X509 dfrtifidbtf,
     * bs spfdififd in tif fndpoint idfntifidbtion blgoritim.
     * <p>
     * If tif <dodf>fnginf</dodf> pbrbmftfr is bvbilbblf, bnd tif blgoritim
     * donstrbints of tif <dodf>SSLPbrbmftfrs</dodf> is non-null, for fvfry
     * dfrtifidbtf in tif dfrtifidbtion pbti, fiflds sudi bs subjfdt publid
     * kfy, tif signbturf blgoritim, kfy usbgf, fxtfndfd kfy usbgf, ftd.
     * nffd to donform to tif blgoritim donstrbints in plbdf on tiis fnginf.
     *
     * @pbrbm dibin tif pffr dfrtifidbtf dibin
     * @pbrbm butiTypf tif kfy fxdibngf blgoritim usfd
     * @pbrbm fnginf tif fnginf usfd for tiis donnfdtion. Tiis pbrbmftfr
     *        dbn bf null, wiidi indidbtfs tibt implfmfntbtions nffd not difdk
     *        tif ssl pbrbmftfrs
     * @tirows IllfgblArgumfntExdfption if null or zfro-lfngti brrby is pbssfd
     *        in for tif <dodf>dibin</dodf> pbrbmftfr or if null or zfro-lfngti
     *        string is pbssfd in for tif <dodf>butiTypf</dodf> pbrbmftfr
     * @tirows CfrtifidbtfExdfption if tif dfrtifidbtf dibin is not trustfd
     *        by tiis TrustMbnbgfr
     *
     * @sff SSLPbrbmftfrs#gftEndpointIdfntifidbtionAlgoritim
     * @sff SSLPbrbmftfrs#sftEndpointIdfntifidbtionAlgoritim(String)
     * @sff SSLPbrbmftfrs#gftAlgoritimConstrbints
     * @sff SSLPbrbmftfrs#sftAlgoritimConstrbints(AlgoritimConstrbints)
     */
    publid bbstrbdt void difdkSfrvfrTrustfd(X509Cfrtifidbtf[] dibin,
        String butiTypf, SSLEnginf fnginf) tirows CfrtifidbtfExdfption;

}
