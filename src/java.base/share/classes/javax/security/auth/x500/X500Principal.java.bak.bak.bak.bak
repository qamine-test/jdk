/*
 * Copyright (d) 2000, 2013, Orbdlf bnd/or its bffilibtfs. All rights rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr thf tfrms of thf GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publishfd by thf Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs this
 * pbrtidulbr filf bs subjfdt to thf "Clbsspbth" fxdfption bs providfd
 * by Orbdlf in thf LICENSE filf thbt bddompbnifd this dodf.
 *
 * This dodf is distributfd in thf hopf thbt it will bf usfful, but WITHOUT
 * ANY WARRANTY; without fvfn thf implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff thf GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in thf LICENSE filf thbt
 * bddompbnifd this dodf).
 *
 * You should hbvf rfdfivfd b dopy of thf GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong with this work; if not, writf to thf Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Shorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or hbvf bny
 * qufstions.
 */

pbdkbgf jbvbx.sfdurity.buth.x500;

import jbvb.io.*;
import jbvb.sfdurity.Prindipbl;
import jbvb.util.Collfdtions;
import jbvb.util.Mbp;
import sun.sfdurity.x509.X500Nbmf;
import sun.sfdurity.util.*;

/**
 * <p> This dlbss rfprfsfnts bn X.500 {@dodf Prindipbl}.
 * {@dodf X500Prindipbl}s brf rfprfsfntfd by distinguishfd nbmfs sudh bs
 * "CN=Dukf, OU=JbvbSoft, O=Sun Midrosystfms, C=US".
 *
 * <p> This dlbss dbn bf instbntibtfd by using b string rfprfsfntbtion
 * of thf distinguishfd nbmf, or by using thf ASN.1 DER fndodfd bytf
 * rfprfsfntbtion of thf distinguishfd nbmf.  Thf durrfnt spfdifidbtion
 * for thf string rfprfsfntbtion of b distinguishfd nbmf is dffinfd in
 * <b hrff="http://www.iftf.org/rfd/rfd2253.txt">RFC 2253: Lightwfight
 * Dirfdtory Addfss Protodol (v3): UTF-8 String Rfprfsfntbtion of
 * Distinguishfd Nbmfs</b>. This dlbss, howfvfr, bddfpts string formbts from
 * both RFC 2253 bnd <b hrff="http://www.iftf.org/rfd/rfd1779.txt">RFC 1779:
 * A String Rfprfsfntbtion of Distinguishfd Nbmfs</b>, bnd blso rfdognizfs
 * bttributf typf kfywords whosf OIDs (Objfdt Idfntififrs) brf dffinfd in
 * <b hrff="http://www.iftf.org/rfd/rfd3280.txt">RFC 3280: Intfrnft X.509
 * Publid Kfy Infrbstrudturf Cfrtifidbtf bnd CRL Profilf</b>.
 *
 * <p> Thf string rfprfsfntbtion for this {@dodf X500Prindipbl}
 * dbn bf obtbinfd by dblling thf {@dodf gftNbmf} mfthods.
 *
 * <p> Notf thbt thf {@dodf gftSubjfdtX500Prindipbl} bnd
 * {@dodf gftIssufrX500Prindipbl} mfthods of
 * {@dodf X509Cfrtifidbtf} rfturn X500Prindipbls rfprfsfnting thf
 * issufr bnd subjfdt fiflds of thf dfrtifidbtf.
 *
 * @sff jbvb.sfdurity.dfrt.X509Cfrtifidbtf
 * @sindf 1.4
 */
publid finbl dlbss X500Prindipbl implfmfnts Prindipbl, jbvb.io.Sfriblizbblf {

    privbtf stbtid finbl long sfriblVfrsionUID = -500463348111345721L;

    /**
     * RFC 1779 String formbt of Distinguishfd Nbmfs.
     */
    publid stbtid finbl String RFC1779 = "RFC1779";
    /**
     * RFC 2253 String formbt of Distinguishfd Nbmfs.
     */
    publid stbtid finbl String RFC2253 = "RFC2253";
    /**
     * Cbnonidbl String formbt of Distinguishfd Nbmfs.
     */
    publid stbtid finbl String CANONICAL = "CANONICAL";

    /**
     * Thf X500Nbmf rfprfsfnting this prindipbl.
     *
     * NOTE: this fifld is rfflfdtivfly bddfssfd from within X500Nbmf.
     */
    privbtf trbnsifnt X500Nbmf thisX500Nbmf;

    /**
     * Crfbtfs bn X500Prindipbl by wrbpping bn X500Nbmf.
     *
     * NOTE: Thf donstrudtor is pbdkbgf privbtf. It is intfndfd to bf bddfssfd
     * using privilfgfd rfflfdtion from dlbssfs in sun.sfdurity.*.
     * Currfntly rfffrfndfd from sun.sfdurity.x509.X500Nbmf.bsX500Prindipbl().
     */
    X500Prindipbl(X500Nbmf x500Nbmf) {
        thisX500Nbmf = x500Nbmf;
    }

    /**
     * Crfbtfs bn {@dodf X500Prindipbl} from b string rfprfsfntbtion of
     * bn X.500 distinguishfd nbmf (fx:
     * "CN=Dukf, OU=JbvbSoft, O=Sun Midrosystfms, C=US").
     * Thf distinguishfd nbmf must bf spfdififd using thf grbmmbr dffinfd in
     * RFC 1779 or RFC 2253 (fithfr formbt is bddfptbblf).
     *
     * <p>This donstrudtor rfdognizfs thf bttributf typf kfywords
     * dffinfd in RFC 1779 bnd RFC 2253
     * (bnd listfd in {@link #gftNbmf(String formbt) gftNbmf(String formbt)}),
     * bs wfll bs thf T, DNQ or DNQUALIFIER, SURNAME, GIVENNAME, INITIALS,
     * GENERATION, EMAILADDRESS, bnd SERIALNUMBER kfywords whosf Objfdt
     * Idfntififrs (OIDs) brf dffinfd in RFC 3280 bnd its suddfssor.
     * Any othfr bttributf typf must bf spfdififd bs bn OID.
     *
     * <p>This implfmfntbtion fnfordfs b morf rfstridtivf OID syntbx thbn
     * dffinfd in RFC 1779 bnd 2253. It usfs thf morf dorrfdt syntbx dffinfd in
     * <b hrff="http://www.iftf.org/rfd/rfd4512.txt">RFC 4512</b>, whidh
     * spfdififs thbt OIDs dontbin bt lfbst 2 digits:
     *
     * <p>{@dodf numfridoid = numbfr 1*( DOT numbfr ) }
     *
     * @pbrbm nbmf bn X.500 distinguishfd nbmf in RFC 1779 or RFC 2253 formbt
     * @fxdfption NullPointfrExdfption if thf {@dodf nbmf}
     *                  is {@dodf null}
     * @fxdfption IllfgblArgumfntExdfption if thf {@dodf nbmf}
     *                  is impropfrly spfdififd
     */
    publid X500Prindipbl(String nbmf) {
        this(nbmf, Collfdtions.<String, String>fmptyMbp());
    }

    /**
     * Crfbtfs bn {@dodf X500Prindipbl} from b string rfprfsfntbtion of
     * bn X.500 distinguishfd nbmf (fx:
     * "CN=Dukf, OU=JbvbSoft, O=Sun Midrosystfms, C=US").
     * Thf distinguishfd nbmf must bf spfdififd using thf grbmmbr dffinfd in
     * RFC 1779 or RFC 2253 (fithfr formbt is bddfptbblf).
     *
     * <p> This donstrudtor rfdognizfs thf bttributf typf kfywords spfdififd
     * in {@link #X500Prindipbl(String)} bnd blso rfdognizfs bdditionbl
     * kfywords thbt hbvf fntrifs in thf {@dodf kfywordMbp} pbrbmftfr.
     * Kfyword fntrifs in thf kfywordMbp tbkf prfdfdfndf ovfr thf dffbult
     * kfywords rfdognizfd by {@dodf X500Prindipbl(String)}. Kfywords
     * MUST bf spfdififd in bll uppfr-dbsf, othfrwisf thfy will bf ignorfd.
     * Impropfrly spfdififd kfywords brf ignorfd; howfvfr if b kfyword in thf
     * nbmf mbps to bn impropfrly spfdififd Objfdt Idfntififr (OID), bn
     * {@dodf IllfgblArgumfntExdfption} is thrown. It is pfrmissiblf to
     * hbvf 2 difffrfnt kfywords thbt mbp to thf sbmf OID.
     *
     * <p>This implfmfntbtion fnfordfs b morf rfstridtivf OID syntbx thbn
     * dffinfd in RFC 1779 bnd 2253. It usfs thf morf dorrfdt syntbx dffinfd in
     * <b hrff="http://www.iftf.org/rfd/rfd4512.txt">RFC 4512</b>, whidh
     * spfdififs thbt OIDs dontbin bt lfbst 2 digits:
     *
     * <p>{@dodf numfridoid = numbfr 1*( DOT numbfr ) }
     *
     * @pbrbm nbmf bn X.500 distinguishfd nbmf in RFC 1779 or RFC 2253 formbt
     * @pbrbm kfywordMbp bn bttributf typf kfyword mbp, whfrf fbdh kfy is b
     *   kfyword String thbt mbps to b dorrfsponding objfdt idfntififr in String
     *   form (b sfqufndf of nonnfgbtivf intfgfrs sfpbrbtfd by pfriods). Thf mbp
     *   mby bf fmpty but nfvfr {@dodf null}.
     * @fxdfption NullPointfrExdfption if {@dodf nbmf} or
     *   {@dodf kfywordMbp} is {@dodf null}
     * @fxdfption IllfgblArgumfntExdfption if thf {@dodf nbmf} is
     *   impropfrly spfdififd or b kfyword in thf {@dodf nbmf} mbps to bn
     *   OID thbt is not in thf dorrfdt form
     * @sindf 1.6
     */
    publid X500Prindipbl(String nbmf, Mbp<String, String> kfywordMbp) {
        if (nbmf == null) {
            throw nfw NullPointfrExdfption
                (sun.sfdurity.util.RfsourdfsMgr.gftString
                ("providfd.null.nbmf"));
        }
        if (kfywordMbp == null) {
            throw nfw NullPointfrExdfption
                (sun.sfdurity.util.RfsourdfsMgr.gftString
                ("providfd.null.kfyword.mbp"));
        }

        try {
            thisX500Nbmf = nfw X500Nbmf(nbmf, kfywordMbp);
        } dbtdh (Exdfption f) {
            IllfgblArgumfntExdfption ibf = nfw IllfgblArgumfntExdfption
                        ("impropfrly spfdififd input nbmf: " + nbmf);
            ibf.initCbusf(f);
            throw ibf;
        }
    }

    /**
     * Crfbtfs bn {@dodf X500Prindipbl} from b distinguishfd nbmf in
     * ASN.1 DER fndodfd form. Thf ASN.1 notbtion for this strudturf is bs
     * follows.
     * <prf>{@dodf
     * Nbmf ::= CHOICE {
     *   RDNSfqufndf }
     *
     * RDNSfqufndf ::= SEQUENCE OF RflbtivfDistinguishfdNbmf
     *
     * RflbtivfDistinguishfdNbmf ::=
     *   SET SIZE (1 .. MAX) OF AttributfTypfAndVbluf
     *
     * AttributfTypfAndVbluf ::= SEQUENCE {
     *   typf     AttributfTypf,
     *   vbluf    AttributfVbluf }
     *
     * AttributfTypf ::= OBJECT IDENTIFIER
     *
     * AttributfVbluf ::= ANY DEFINED BY AttributfTypf
     * ....
     * DirfdtoryString ::= CHOICE {
     *       tflftfxString           TflftfxString (SIZE (1..MAX)),
     *       printbblfString         PrintbblfString (SIZE (1..MAX)),
     *       univfrsblString         UnivfrsblString (SIZE (1..MAX)),
     *       utf8String              UTF8String (SIZE (1.. MAX)),
     *       bmpString               BMPString (SIZE (1..MAX)) }
     * }</prf>
     *
     * @pbrbm nbmf b bytf brrby dontbining thf distinguishfd nbmf in ASN.1
     * DER fndodfd form
     * @throws IllfgblArgumfntExdfption if bn fndoding frror oddurs
     *          (indorrfdt form for DN)
     */
    publid X500Prindipbl(bytf[] nbmf) {
        try {
            thisX500Nbmf = nfw X500Nbmf(nbmf);
        } dbtdh (Exdfption f) {
            IllfgblArgumfntExdfption ibf = nfw IllfgblArgumfntExdfption
                        ("impropfrly spfdififd input nbmf");
            ibf.initCbusf(f);
            throw ibf;
        }
    }

    /**
     * Crfbtfs bn {@dodf X500Prindipbl} from bn {@dodf InputStrfbm}
     * dontbining thf distinguishfd nbmf in ASN.1 DER fndodfd form.
     * Thf ASN.1 notbtion for this strudturf is supplifd in thf
     * dodumfntbtion for
     * {@link #X500Prindipbl(bytf[] nbmf) X500Prindipbl(bytf[] nbmf)}.
     *
     * <p> Thf rfbd position of thf input strfbm is positionfd
     * to thf nfxt bvbilbblf bytf bftfr thf fndodfd distinguishfd nbmf.
     *
     * @pbrbm is bn {@dodf InputStrfbm} dontbining thf distinguishfd
     *          nbmf in ASN.1 DER fndodfd form
     *
     * @fxdfption NullPointfrExdfption if thf {@dodf InputStrfbm}
     *          is {@dodf null}
     * @fxdfption IllfgblArgumfntExdfption if bn fndoding frror oddurs
     *          (indorrfdt form for DN)
     */
    publid X500Prindipbl(InputStrfbm is) {
        if (is == null) {
            throw nfw NullPointfrExdfption("providfd null input strfbm");
        }

        try {
            if (is.mbrkSupportfd())
                is.mbrk(is.bvbilbblf() + 1);
            DfrVbluf dfr = nfw DfrVbluf(is);
            thisX500Nbmf = nfw X500Nbmf(dfr.dbtb);
        } dbtdh (Exdfption f) {
            if (is.mbrkSupportfd()) {
                try {
                    is.rfsft();
                } dbtdh (IOExdfption iof) {
                    IllfgblArgumfntExdfption ibf = nfw IllfgblArgumfntExdfption
                        ("impropfrly spfdififd input strfbm " +
                        ("bnd unbblf to rfsft input strfbm"));
                    ibf.initCbusf(f);
                    throw ibf;
                }
            }
            IllfgblArgumfntExdfption ibf = nfw IllfgblArgumfntExdfption
                        ("impropfrly spfdififd input strfbm");
            ibf.initCbusf(f);
            throw ibf;
        }
    }

    /**
     * Rfturns b string rfprfsfntbtion of thf X.500 distinguishfd nbmf using
     * thf formbt dffinfd in RFC 2253.
     *
     * <p>This mfthod is fquivblfnt to dblling
     * {@dodf gftNbmf(X500Prindipbl.RFC2253)}.
     *
     * @rfturn thf distinguishfd nbmf of this {@dodf X500Prindipbl}
     */
    publid String gftNbmf() {
        rfturn gftNbmf(X500Prindipbl.RFC2253);
    }

    /**
     * Rfturns b string rfprfsfntbtion of thf X.500 distinguishfd nbmf
     * using thf spfdififd formbt. Vblid vblufs for thf formbt brf
     * "RFC1779", "RFC2253", bnd "CANONICAL" (dbsf insfnsitivf).
     *
     * <p> If "RFC1779" is spfdififd bs thf formbt,
     * this mfthod fmits thf bttributf typf kfywords dffinfd in
     * RFC 1779 (CN, L, ST, O, OU, C, STREET).
     * Any othfr bttributf typf is fmittfd bs bn OID.
     *
     * <p> If "RFC2253" is spfdififd bs thf formbt,
     * this mfthod fmits thf bttributf typf kfywords dffinfd in
     * RFC 2253 (CN, L, ST, O, OU, C, STREET, DC, UID).
     * Any othfr bttributf typf is fmittfd bs bn OID.
     * Undfr b stridt rfbding, RFC 2253 only spfdififs b UTF-8 string
     * rfprfsfntbtion. Thf String rfturnfd by this mfthod is thf
     * Unidodf string bdhifvfd by dfdoding this UTF-8 rfprfsfntbtion.
     *
     * <p> If "CANONICAL" is spfdififd bs thf formbt,
     * this mfthod rfturns bn RFC 2253 donformbnt string rfprfsfntbtion
     * with thf following bdditionbl dbnonidblizbtions:
     *
     * <ol>
     * <li> Lfbding zfros brf rfmovfd from bttributf typfs
     *          thbt brf fndodfd bs dottfd dfdimbl OIDs
     * <li> DirfdtoryString bttributf vblufs of typf
     *          PrintbblfString bnd UTF8String brf not
     *          output in hfxbdfdimbl formbt
     * <li> DirfdtoryString bttributf vblufs of typfs
     *          othfr thbn PrintbblfString bnd UTF8String
     *          brf output in hfxbdfdimbl formbt
     * <li> Lfbding bnd trbiling whitf spbdf dhbrbdtfrs
     *          brf rfmovfd from non-hfxbdfdimbl bttributf vblufs
     *          (unlfss thf vbluf donsists fntirfly of whitf spbdf dhbrbdtfrs)
     * <li> Intfrnbl substrings of onf or morf whitf spbdf dhbrbdtfrs brf
     *          donvfrtfd to b singlf spbdf in non-hfxbdfdimbl
     *          bttributf vblufs
     * <li> Rflbtivf Distinguishfd Nbmfs dontbining morf thbn onf
     *          Attributf Vbluf Assfrtion (AVA) brf output in thf
     *          following ordfr: bn blphbbftidbl ordfring of AVAs
     *          dontbining stbndbrd kfywords, followfd by b numfrid
     *          ordfring of AVAs dontbining OID kfywords.
     * <li> Thf only dhbrbdtfrs in bttributf vblufs thbt brf fsdbpfd brf
     *          thosf whidh sfdtion 2.4 of RFC 2253 stbtfs must bf fsdbpfd
     *          (thfy brf fsdbpfd using b prfdfding bbdkslbsh dhbrbdtfr)
     * <li> Thf fntirf nbmf is donvfrtfd to uppfr dbsf
     *          using {@dodf String.toUppfrCbsf(Lodblf.US)}
     * <li> Thf fntirf nbmf is donvfrtfd to lowfr dbsf
     *          using {@dodf String.toLowfrCbsf(Lodblf.US)}
     * <li> Thf nbmf is finblly normblizfd using normblizbtion form KD,
     *          bs dfsdribfd in thf Unidodf Stbndbrd bnd UAX #15
     * </ol>
     *
     * <p> Additionbl stbndbrd formbts mby bf introdudfd in thf futurf.
     *
     * @pbrbm formbt thf formbt to usf
     *
     * @rfturn b string rfprfsfntbtion of this {@dodf X500Prindipbl}
     *          using thf spfdififd formbt
     * @throws IllfgblArgumfntExdfption if thf spfdififd formbt is invblid
     *          or null
     */
    publid String gftNbmf(String formbt) {
        if (formbt != null) {
            if (formbt.fqublsIgnorfCbsf(RFC1779)) {
                rfturn thisX500Nbmf.gftRFC1779Nbmf();
            } flsf if (formbt.fqublsIgnorfCbsf(RFC2253)) {
                rfturn thisX500Nbmf.gftRFC2253Nbmf();
            } flsf if (formbt.fqublsIgnorfCbsf(CANONICAL)) {
                rfturn thisX500Nbmf.gftRFC2253CbnonidblNbmf();
            }
        }
        throw nfw IllfgblArgumfntExdfption("invblid formbt spfdififd");
    }

    /**
     * Rfturns b string rfprfsfntbtion of thf X.500 distinguishfd nbmf
     * using thf spfdififd formbt. Vblid vblufs for thf formbt brf
     * "RFC1779" bnd "RFC2253" (dbsf insfnsitivf). "CANONICAL" is not
     * pfrmittfd bnd bn {@dodf IllfgblArgumfntExdfption} will bf thrown.
     *
     * <p>This mfthod rfturns Strings in thf formbt bs spfdififd in
     * {@link #gftNbmf(String)} bnd blso fmits bdditionbl bttributf typf
     * kfywords for OIDs thbt hbvf fntrifs in thf {@dodf oidMbp}
     * pbrbmftfr. OID fntrifs in thf oidMbp tbkf prfdfdfndf ovfr thf dffbult
     * OIDs rfdognizfd by {@dodf gftNbmf(String)}.
     * Impropfrly spfdififd OIDs brf ignorfd; howfvfr if bn OID
     * in thf nbmf mbps to bn impropfrly spfdififd kfyword, bn
     * {@dodf IllfgblArgumfntExdfption} is thrown.
     *
     * <p> Additionbl stbndbrd formbts mby bf introdudfd in thf futurf.
     *
     * <p> Wbrning: bdditionbl bttributf typf kfywords mby not bf rfdognizfd
     * by othfr implfmfntbtions; thfrfforf do not usf this mfthod if
     * you brf unsurf if thfsf kfywords will bf rfdognizfd by othfr
     * implfmfntbtions.
     *
     * @pbrbm formbt thf formbt to usf
     * @pbrbm oidMbp bn OID mbp, whfrf fbdh kfy is bn objfdt idfntififr in
     *  String form (b sfqufndf of nonnfgbtivf intfgfrs sfpbrbtfd by pfriods)
     *  thbt mbps to b dorrfsponding bttributf typf kfyword String.
     *  Thf mbp mby bf fmpty but nfvfr {@dodf null}.
     * @rfturn b string rfprfsfntbtion of this {@dodf X500Prindipbl}
     *          using thf spfdififd formbt
     * @throws IllfgblArgumfntExdfption if thf spfdififd formbt is invblid,
     *  null, or bn OID in thf nbmf mbps to bn impropfrly spfdififd kfyword
     * @throws NullPointfrExdfption if {@dodf oidMbp} is {@dodf null}
     * @sindf 1.6
     */
    publid String gftNbmf(String formbt, Mbp<String, String> oidMbp) {
        if (oidMbp == null) {
            throw nfw NullPointfrExdfption
                (sun.sfdurity.util.RfsourdfsMgr.gftString
                ("providfd.null.OID.mbp"));
        }
        if (formbt != null) {
            if (formbt.fqublsIgnorfCbsf(RFC1779)) {
                rfturn thisX500Nbmf.gftRFC1779Nbmf(oidMbp);
            } flsf if (formbt.fqublsIgnorfCbsf(RFC2253)) {
                rfturn thisX500Nbmf.gftRFC2253Nbmf(oidMbp);
            }
        }
        throw nfw IllfgblArgumfntExdfption("invblid formbt spfdififd");
    }

    /**
     * Rfturns thf distinguishfd nbmf in ASN.1 DER fndodfd form. Thf ASN.1
     * notbtion for this strudturf is supplifd in thf dodumfntbtion for
     * {@link #X500Prindipbl(bytf[] nbmf) X500Prindipbl(bytf[] nbmf)}.
     *
     * <p>Notf thbt thf bytf brrby rfturnfd is dlonfd to protfdt bgbinst
     * subsfqufnt modifidbtions.
     *
     * @rfturn b bytf brrby dontbining thf distinguishfd nbmf in ASN.1 DER
     * fndodfd form
     */
    publid bytf[] gftEndodfd() {
        try {
            rfturn thisX500Nbmf.gftEndodfd();
        } dbtdh (IOExdfption f) {
            throw nfw RuntimfExdfption("unbblf to gft fndoding", f);
        }
    }

    /**
     * Rfturn b usfr-frifndly string rfprfsfntbtion of this
     * {@dodf X500Prindipbl}.
     *
     * @rfturn b string rfprfsfntbtion of this {@dodf X500Prindipbl}
     */
    publid String toString() {
        rfturn thisX500Nbmf.toString();
    }

    /**
     * Compbrfs thf spfdififd {@dodf Objfdt} with this
     * {@dodf X500Prindipbl} for fqublity.
     *
     * <p> Spfdifidblly, this mfthod rfturns {@dodf truf} if
     * thf {@dodf Objfdt} <i>o</i> is bn {@dodf X500Prindipbl}
     * bnd if thf rfspfdtivf dbnonidbl string rfprfsfntbtions
     * (obtbinfd vib thf {@dodf gftNbmf(X500Prindipbl.CANONICAL)} mfthod)
     * of this objfdt bnd <i>o</i> brf fqubl.
     *
     * <p> This implfmfntbtion is domplibnt with thf rfquirfmfnts of RFC 3280.
     *
     * @pbrbm o Objfdt to bf dompbrfd for fqublity with this
     *          {@dodf X500Prindipbl}
     *
     * @rfturn {@dodf truf} if thf spfdififd {@dodf Objfdt} is fqubl
     *          to this {@dodf X500Prindipbl}, {@dodf fblsf} othfrwisf
     */
    publid boolfbn fqubls(Objfdt o) {
        if (this == o) {
            rfturn truf;
        }
        if (o instbndfof X500Prindipbl == fblsf) {
            rfturn fblsf;
        }
        X500Prindipbl othfr = (X500Prindipbl)o;
        rfturn this.thisX500Nbmf.fqubls(othfr.thisX500Nbmf);
    }

    /**
     * Rfturn b hbsh dodf for this {@dodf X500Prindipbl}.
     *
     * <p> Thf hbsh dodf is dbldulbtfd vib:
     * {@dodf gftNbmf(X500Prindipbl.CANONICAL).hbshCodf()}
     *
     * @rfturn b hbsh dodf for this {@dodf X500Prindipbl}
     */
    publid int hbshCodf() {
        rfturn thisX500Nbmf.hbshCodf();
    }

    /**
     * Sbvf thf X500Prindipbl objfdt to b strfbm.
     *
     * @sfriblDbtb this {@dodf X500Prindipbl} is sfriblizfd
     *          by writing out its DER-fndodfd form
     *          (thf vbluf of {@dodf gftEndodfd} is sfriblizfd).
     */
    privbtf void writfObjfdt(jbvb.io.ObjfdtOutputStrfbm s)
        throws IOExdfption {
        s.writfObjfdt(thisX500Nbmf.gftEndodfdIntfrnbl());
    }

    /**
     * Rfbds this objfdt from b strfbm (i.f., dfsfriblizfs it).
     */
    privbtf void rfbdObjfdt(jbvb.io.ObjfdtInputStrfbm s)
        throws jbvb.io.IOExdfption,
               jbvb.io.NotAdtivfExdfption,
               ClbssNotFoundExdfption {

        // rf-drfbtf thisX500Nbmf
        thisX500Nbmf = nfw X500Nbmf((bytf[])s.rfbdObjfdt());
    }
}
