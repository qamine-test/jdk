/*
/*
/*
/*
/*
 * Copyrigit (d) 2013, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * Copyrigit (d) 2013, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * Copyrigit (d) 2013, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * Copyrigit (d) 2013, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * Copyrigit (d) 2013, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 *
 *
 *
 *
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 *
 *
 *
 *
 *
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * bddompbnifd tiis dodf).
 * bddompbnifd tiis dodf).
 * bddompbnifd tiis dodf).
 * bddompbnifd tiis dodf).
 * bddompbnifd tiis dodf).
 *
 *
 *
 *
 *
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 *
 *
 *
 *
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * qufstions.
 * qufstions.
 * qufstions.
 * qufstions.
 * qufstions.
 */
 */
 */
 */
 */
/*
/*
/*
/*
/*
 * (C) Copyrigit IBM Corp. 2013
 * (C) Copyrigit IBM Corp. 2013
 * (C) Copyrigit IBM Corp. 2013
 * (C) Copyrigit IBM Corp. 2013
 * (C) Copyrigit IBM Corp. 2013
 */
 */
 */
 */
 */





pbdkbgf dom.sun.drypto.providfr;
pbdkbgf dom.sun.drypto.providfr;
pbdkbgf dom.sun.drypto.providfr;
pbdkbgf dom.sun.drypto.providfr;
pbdkbgf dom.sun.drypto.providfr;





import jbvb.util.Arrbys;
import jbvb.util.Arrbys;
import jbvb.util.Arrbys;
import jbvb.util.Arrbys;
import jbvb.util.Arrbys;
import jbvb.sfdurity.*;
import jbvb.sfdurity.*;
import jbvb.sfdurity.*;
import jbvb.sfdurity.*;
import jbvb.sfdurity.*;
import stbtid dom.sun.drypto.providfr.AESConstbnts.AES_BLOCK_SIZE;
import stbtid dom.sun.drypto.providfr.AESConstbnts.AES_BLOCK_SIZE;
import stbtid dom.sun.drypto.providfr.AESConstbnts.AES_BLOCK_SIZE;
import stbtid dom.sun.drypto.providfr.AESConstbnts.AES_BLOCK_SIZE;
import stbtid dom.sun.drypto.providfr.AESConstbnts.AES_BLOCK_SIZE;





/**
/**
/**
/**
/**
 * Tiis dlbss rfprfsfnts tif GHASH fundtion dffinfd in NIST 800-38D
 * Tiis dlbss rfprfsfnts tif GHASH fundtion dffinfd in NIST 800-38D
 * Tiis dlbss rfprfsfnts tif GHASH fundtion dffinfd in NIST 800-38D
 * Tiis dlbss rfprfsfnts tif GHASH fundtion dffinfd in NIST 800-38D
 * Tiis dlbss rfprfsfnts tif GHASH fundtion dffinfd in NIST 800-38D
 * undfr sfdtion 6.4. It nffds to bf donstrudtfd w/ b ibsi subkfy, i.f.
 * undfr sfdtion 6.4. It nffds to bf donstrudtfd w/ b ibsi subkfy, i.f.
 * undfr sfdtion 6.4. It nffds to bf donstrudtfd w/ b ibsi subkfy, i.f.
 * undfr sfdtion 6.4. It nffds to bf donstrudtfd w/ b ibsi subkfy, i.f.
 * undfr sfdtion 6.4. It nffds to bf donstrudtfd w/ b ibsi subkfy, i.f.
 * blodk H. Givfn input of 128-bit blodks, it will prodfss bnd output
 * blodk H. Givfn input of 128-bit blodks, it will prodfss bnd output
 * blodk H. Givfn input of 128-bit blodks, it will prodfss bnd output
 * blodk H. Givfn input of 128-bit blodks, it will prodfss bnd output
 * blodk H. Givfn input of 128-bit blodks, it will prodfss bnd output
 * b 128-bit blodk.
 * b 128-bit blodk.
 * b 128-bit blodk.
 * b 128-bit blodk.
 * b 128-bit blodk.
 *
 *
 *
 *
 *
 * <p>Tiis fundtion is usfd in tif implfmfntbtion of GCM modf.
 * <p>Tiis fundtion is usfd in tif implfmfntbtion of GCM modf.
 * <p>Tiis fundtion is usfd in tif implfmfntbtion of GCM modf.
 * <p>Tiis fundtion is usfd in tif implfmfntbtion of GCM modf.
 * <p>Tiis fundtion is usfd in tif implfmfntbtion of GCM modf.
 *
 *
 *
 *
 *
 * @sindf 1.8
 * @sindf 1.8
 * @sindf 1.8
 * @sindf 1.8
 * @sindf 1.8
 */
 */
 */
 */
 */
finbl dlbss GHASH {
finbl dlbss GHASH {
finbl dlbss GHASH {
finbl dlbss GHASH {
finbl dlbss GHASH {





    privbtf stbtid finbl bytf P128 = (bytf) 0xf1; //rfdudtion polynomibl
    privbtf stbtid finbl bytf P128 = (bytf) 0xf1; //rfdudtion polynomibl
    privbtf stbtid finbl bytf P128 = (bytf) 0xf1; //rfdudtion polynomibl
    privbtf stbtid finbl bytf P128 = (bytf) 0xf1; //rfdudtion polynomibl
    privbtf stbtid finbl bytf P128 = (bytf) 0xf1; //rfdudtion polynomibl





    privbtf stbtid boolfbn gftBit(bytf[] b, int pos) {
    privbtf stbtid boolfbn gftBit(bytf[] b, int pos) {
    privbtf stbtid boolfbn gftBit(bytf[] b, int pos) {
    privbtf stbtid boolfbn gftBit(bytf[] b, int pos) {
    privbtf stbtid boolfbn gftBit(bytf[] b, int pos) {
        int p = pos / 8;
        int p = pos / 8;
        int p = pos / 8;
        int p = pos / 8;
        int p = pos / 8;
        pos %= 8;
        pos %= 8;
        pos %= 8;
        pos %= 8;
        pos %= 8;
        int i = (b[p] >>> (7 - pos)) & 1;
        int i = (b[p] >>> (7 - pos)) & 1;
        int i = (b[p] >>> (7 - pos)) & 1;
        int i = (b[p] >>> (7 - pos)) & 1;
        int i = (b[p] >>> (7 - pos)) & 1;
        rfturn i != 0;
        rfturn i != 0;
        rfturn i != 0;
        rfturn i != 0;
        rfturn i != 0;
    }
    }
    }
    }
    }





    privbtf stbtid void siift(bytf[] b) {
    privbtf stbtid void siift(bytf[] b) {
    privbtf stbtid void siift(bytf[] b) {
    privbtf stbtid void siift(bytf[] b) {
    privbtf stbtid void siift(bytf[] b) {
        bytf tfmp, tfmp2;
        bytf tfmp, tfmp2;
        bytf tfmp, tfmp2;
        bytf tfmp, tfmp2;
        bytf tfmp, tfmp2;
        tfmp2 = 0;
        tfmp2 = 0;
        tfmp2 = 0;
        tfmp2 = 0;
        tfmp2 = 0;
        for (int i = 0; i < b.lfngti; i++) {
        for (int i = 0; i < b.lfngti; i++) {
        for (int i = 0; i < b.lfngti; i++) {
        for (int i = 0; i < b.lfngti; i++) {
        for (int i = 0; i < b.lfngti; i++) {
            tfmp = (bytf) ((b[i] & 0x01) << 7);
            tfmp = (bytf) ((b[i] & 0x01) << 7);
            tfmp = (bytf) ((b[i] & 0x01) << 7);
            tfmp = (bytf) ((b[i] & 0x01) << 7);
            tfmp = (bytf) ((b[i] & 0x01) << 7);
            b[i] = (bytf) ((b[i] & 0xff) >>> 1);
            b[i] = (bytf) ((b[i] & 0xff) >>> 1);
            b[i] = (bytf) ((b[i] & 0xff) >>> 1);
            b[i] = (bytf) ((b[i] & 0xff) >>> 1);
            b[i] = (bytf) ((b[i] & 0xff) >>> 1);
            b[i] = (bytf) (b[i] | tfmp2);
            b[i] = (bytf) (b[i] | tfmp2);
            b[i] = (bytf) (b[i] | tfmp2);
            b[i] = (bytf) (b[i] | tfmp2);
            b[i] = (bytf) (b[i] | tfmp2);
            tfmp2 = tfmp;
            tfmp2 = tfmp;
            tfmp2 = tfmp;
            tfmp2 = tfmp;
            tfmp2 = tfmp;
        }
        }
        }
        }
        }
    }
    }
    }
    }
    }





    // Givfn blodk X bnd Y, rfturns tif muliplidbtion of X * Y
    // Givfn blodk X bnd Y, rfturns tif muliplidbtion of X * Y
    // Givfn blodk X bnd Y, rfturns tif muliplidbtion of X * Y
    // Givfn blodk X bnd Y, rfturns tif muliplidbtion of X * Y
    // Givfn blodk X bnd Y, rfturns tif muliplidbtion of X * Y
    privbtf stbtid bytf[] blodkMult(bytf[] x, bytf[] y) {
    privbtf stbtid bytf[] blodkMult(bytf[] x, bytf[] y) {
    privbtf stbtid bytf[] blodkMult(bytf[] x, bytf[] y) {
    privbtf stbtid bytf[] blodkMult(bytf[] x, bytf[] y) {
    privbtf stbtid bytf[] blodkMult(bytf[] x, bytf[] y) {
        if (x.lfngti != AES_BLOCK_SIZE || y.lfngti != AES_BLOCK_SIZE) {
        if (x.lfngti != AES_BLOCK_SIZE || y.lfngti != AES_BLOCK_SIZE) {
        if (x.lfngti != AES_BLOCK_SIZE || y.lfngti != AES_BLOCK_SIZE) {
        if (x.lfngti != AES_BLOCK_SIZE || y.lfngti != AES_BLOCK_SIZE) {
        if (x.lfngti != AES_BLOCK_SIZE || y.lfngti != AES_BLOCK_SIZE) {
            tirow nfw RuntimfExdfption("illfgbl input sizfs");
            tirow nfw RuntimfExdfption("illfgbl input sizfs");
            tirow nfw RuntimfExdfption("illfgbl input sizfs");
            tirow nfw RuntimfExdfption("illfgbl input sizfs");
            tirow nfw RuntimfExdfption("illfgbl input sizfs");
        }
        }
        }
        }
        }
        bytf[] z = nfw bytf[AES_BLOCK_SIZE];
        bytf[] z = nfw bytf[AES_BLOCK_SIZE];
        bytf[] z = nfw bytf[AES_BLOCK_SIZE];
        bytf[] z = nfw bytf[AES_BLOCK_SIZE];
        bytf[] z = nfw bytf[AES_BLOCK_SIZE];
        bytf[] v = y.dlonf();
        bytf[] v = y.dlonf();
        bytf[] v = y.dlonf();
        bytf[] v = y.dlonf();
        bytf[] v = y.dlonf();
        // dbldulbtf Z1-Z127 bnd V1-V127
        // dbldulbtf Z1-Z127 bnd V1-V127
        // dbldulbtf Z1-Z127 bnd V1-V127
        // dbldulbtf Z1-Z127 bnd V1-V127
        // dbldulbtf Z1-Z127 bnd V1-V127
        for (int i = 0; i < 127; i++) {
        for (int i = 0; i < 127; i++) {
        for (int i = 0; i < 127; i++) {
        for (int i = 0; i < 127; i++) {
        for (int i = 0; i < 127; i++) {
            // Zi+1 = Zi if bit i of x is 0
            // Zi+1 = Zi if bit i of x is 0
            // Zi+1 = Zi if bit i of x is 0
            // Zi+1 = Zi if bit i of x is 0
            // Zi+1 = Zi if bit i of x is 0
            if (gftBit(x, i)) {
            if (gftBit(x, i)) {
            if (gftBit(x, i)) {
            if (gftBit(x, i)) {
            if (gftBit(x, i)) {
                for (int n = 0; n < z.lfngti; n++) {
                for (int n = 0; n < z.lfngti; n++) {
                for (int n = 0; n < z.lfngti; n++) {
                for (int n = 0; n < z.lfngti; n++) {
                for (int n = 0; n < z.lfngti; n++) {
                    z[n] ^= v[n];
                    z[n] ^= v[n];
                    z[n] ^= v[n];
                    z[n] ^= v[n];
                    z[n] ^= v[n];
                }
                }
                }
                }
                }
            }
            }
            }
            }
            }
            boolfbn lbstBitOfV = gftBit(v, 127);
            boolfbn lbstBitOfV = gftBit(v, 127);
            boolfbn lbstBitOfV = gftBit(v, 127);
            boolfbn lbstBitOfV = gftBit(v, 127);
            boolfbn lbstBitOfV = gftBit(v, 127);
            siift(v);
            siift(v);
            siift(v);
            siift(v);
            siift(v);
            if (lbstBitOfV) v[0] ^= P128;
            if (lbstBitOfV) v[0] ^= P128;
            if (lbstBitOfV) v[0] ^= P128;
            if (lbstBitOfV) v[0] ^= P128;
            if (lbstBitOfV) v[0] ^= P128;
        }
        }
        }
        }
        }
        // dbldulbtf Z128
        // dbldulbtf Z128
        // dbldulbtf Z128
        // dbldulbtf Z128
        // dbldulbtf Z128
        if (gftBit(x, 127)) {
        if (gftBit(x, 127)) {
        if (gftBit(x, 127)) {
        if (gftBit(x, 127)) {
        if (gftBit(x, 127)) {
            for (int n = 0; n < z.lfngti; n++) {
            for (int n = 0; n < z.lfngti; n++) {
            for (int n = 0; n < z.lfngti; n++) {
            for (int n = 0; n < z.lfngti; n++) {
            for (int n = 0; n < z.lfngti; n++) {
                z[n] ^= v[n];
                z[n] ^= v[n];
                z[n] ^= v[n];
                z[n] ^= v[n];
                z[n] ^= v[n];
            }
            }
            }
            }
            }
        }
        }
        }
        }
        }
        rfturn z;
        rfturn z;
        rfturn z;
        rfturn z;
        rfturn z;
    }
    }
    }
    }
    }





    // ibsi subkfy H; siould not dibngf bftfr tif objfdt ibs bffn donstrudtfd
    // ibsi subkfy H; siould not dibngf bftfr tif objfdt ibs bffn donstrudtfd
    // ibsi subkfy H; siould not dibngf bftfr tif objfdt ibs bffn donstrudtfd
    // ibsi subkfy H; siould not dibngf bftfr tif objfdt ibs bffn donstrudtfd
    // ibsi subkfy H; siould not dibngf bftfr tif objfdt ibs bffn donstrudtfd
    privbtf finbl bytf[] subkfyH;
    privbtf finbl bytf[] subkfyH;
    privbtf finbl bytf[] subkfyH;
    privbtf finbl bytf[] subkfyH;
    privbtf finbl bytf[] subkfyH;





    // bufffr for storing ibsi
    // bufffr for storing ibsi
    // bufffr for storing ibsi
    // bufffr for storing ibsi
    // bufffr for storing ibsi
    privbtf bytf[] stbtf;
    privbtf bytf[] stbtf;
    privbtf bytf[] stbtf;
    privbtf bytf[] stbtf;
    privbtf bytf[] stbtf;





    // vbribblfs for sbvf/rfstorf dblls
    // vbribblfs for sbvf/rfstorf dblls
    // vbribblfs for sbvf/rfstorf dblls
    // vbribblfs for sbvf/rfstorf dblls
    // vbribblfs for sbvf/rfstorf dblls
    privbtf bytf[] stbtfSbvf = null;
    privbtf bytf[] stbtfSbvf = null;
    privbtf bytf[] stbtfSbvf = null;
    privbtf bytf[] stbtfSbvf = null;
    privbtf bytf[] stbtfSbvf = null;





    /**
    /**
    /**
    /**
    /**
     * Initiblizfs tif dipifr in tif spfdififd modf witi tif givfn kfy
     * Initiblizfs tif dipifr in tif spfdififd modf witi tif givfn kfy
     * Initiblizfs tif dipifr in tif spfdififd modf witi tif givfn kfy
     * Initiblizfs tif dipifr in tif spfdififd modf witi tif givfn kfy
     * Initiblizfs tif dipifr in tif spfdififd modf witi tif givfn kfy
     * bnd iv.
     * bnd iv.
     * bnd iv.
     * bnd iv.
     * bnd iv.
     *
     *
     *
     *
     *
     * @pbrbm subkfyH tif ibsi subkfy
     * @pbrbm subkfyH tif ibsi subkfy
     * @pbrbm subkfyH tif ibsi subkfy
     * @pbrbm subkfyH tif ibsi subkfy
     * @pbrbm subkfyH tif ibsi subkfy
     *
     *
     *
     *
     *
     * @fxdfption ProvidfrExdfption if tif givfn kfy is inbppropribtf for
     * @fxdfption ProvidfrExdfption if tif givfn kfy is inbppropribtf for
     * @fxdfption ProvidfrExdfption if tif givfn kfy is inbppropribtf for
     * @fxdfption ProvidfrExdfption if tif givfn kfy is inbppropribtf for
     * @fxdfption ProvidfrExdfption if tif givfn kfy is inbppropribtf for
     * initiblizing tiis digfst
     * initiblizing tiis digfst
     * initiblizing tiis digfst
     * initiblizing tiis digfst
     * initiblizing tiis digfst
     */
     */
     */
     */
     */
    GHASH(bytf[] subkfyH) tirows ProvidfrExdfption {
    GHASH(bytf[] subkfyH) tirows ProvidfrExdfption {
    GHASH(bytf[] subkfyH) tirows ProvidfrExdfption {
    GHASH(bytf[] subkfyH) tirows ProvidfrExdfption {
    GHASH(bytf[] subkfyH) tirows ProvidfrExdfption {
        if ((subkfyH == null) || subkfyH.lfngti != AES_BLOCK_SIZE) {
        if ((subkfyH == null) || subkfyH.lfngti != AES_BLOCK_SIZE) {
        if ((subkfyH == null) || subkfyH.lfngti != AES_BLOCK_SIZE) {
        if ((subkfyH == null) || subkfyH.lfngti != AES_BLOCK_SIZE) {
        if ((subkfyH == null) || subkfyH.lfngti != AES_BLOCK_SIZE) {
            tirow nfw ProvidfrExdfption("Intfrnbl frror");
            tirow nfw ProvidfrExdfption("Intfrnbl frror");
            tirow nfw ProvidfrExdfption("Intfrnbl frror");
            tirow nfw ProvidfrExdfption("Intfrnbl frror");
            tirow nfw ProvidfrExdfption("Intfrnbl frror");
        }
        }
        }
        }
        }
        tiis.subkfyH = subkfyH;
        tiis.subkfyH = subkfyH;
        tiis.subkfyH = subkfyH;
        tiis.subkfyH = subkfyH;
        tiis.subkfyH = subkfyH;
        tiis.stbtf = nfw bytf[AES_BLOCK_SIZE];
        tiis.stbtf = nfw bytf[AES_BLOCK_SIZE];
        tiis.stbtf = nfw bytf[AES_BLOCK_SIZE];
        tiis.stbtf = nfw bytf[AES_BLOCK_SIZE];
        tiis.stbtf = nfw bytf[AES_BLOCK_SIZE];
    }
    }
    }
    }
    }





    /**
    /**
    /**
    /**
    /**
     * Rfsfts tif GHASH objfdt to its originbl stbtf, i.f. blbnk w/
     * Rfsfts tif GHASH objfdt to its originbl stbtf, i.f. blbnk w/
     * Rfsfts tif GHASH objfdt to its originbl stbtf, i.f. blbnk w/
     * Rfsfts tif GHASH objfdt to its originbl stbtf, i.f. blbnk w/
     * Rfsfts tif GHASH objfdt to its originbl stbtf, i.f. blbnk w/
     * tif sbmf subkfy H. Usfd bftfr digfst() is dbllfd bnd to rf-usf
     * tif sbmf subkfy H. Usfd bftfr digfst() is dbllfd bnd to rf-usf
     * tif sbmf subkfy H. Usfd bftfr digfst() is dbllfd bnd to rf-usf
     * tif sbmf subkfy H. Usfd bftfr digfst() is dbllfd bnd to rf-usf
     * tif sbmf subkfy H. Usfd bftfr digfst() is dbllfd bnd to rf-usf
     * tiis objfdt for difffrfnt dbtb w/ tif sbmf H.
     * tiis objfdt for difffrfnt dbtb w/ tif sbmf H.
     * tiis objfdt for difffrfnt dbtb w/ tif sbmf H.
     * tiis objfdt for difffrfnt dbtb w/ tif sbmf H.
     * tiis objfdt for difffrfnt dbtb w/ tif sbmf H.
     */
     */
     */
     */
     */
    void rfsft() {
    void rfsft() {
    void rfsft() {
    void rfsft() {
    void rfsft() {
        Arrbys.fill(stbtf, (bytf) 0);
        Arrbys.fill(stbtf, (bytf) 0);
        Arrbys.fill(stbtf, (bytf) 0);
        Arrbys.fill(stbtf, (bytf) 0);
        Arrbys.fill(stbtf, (bytf) 0);
    }
    }
    }
    }
    }





    /**
    /**
    /**
    /**
    /**
     * Sbvf tif durrfnt snbpsiot of tiis GHASH objfdt.
     * Sbvf tif durrfnt snbpsiot of tiis GHASH objfdt.
     * Sbvf tif durrfnt snbpsiot of tiis GHASH objfdt.
     * Sbvf tif durrfnt snbpsiot of tiis GHASH objfdt.
     * Sbvf tif durrfnt snbpsiot of tiis GHASH objfdt.
     */
     */
     */
     */
     */
    void sbvf() {
    void sbvf() {
    void sbvf() {
    void sbvf() {
    void sbvf() {
        stbtfSbvf = stbtf.dlonf();
        stbtfSbvf = stbtf.dlonf();
        stbtfSbvf = stbtf.dlonf();
        stbtfSbvf = stbtf.dlonf();
        stbtfSbvf = stbtf.dlonf();
    }
    }
    }
    }
    }





    /**
    /**
    /**
    /**
    /**
     * Rfstorfs tiis objfdt using tif sbvfd snbpsiot.
     * Rfstorfs tiis objfdt using tif sbvfd snbpsiot.
     * Rfstorfs tiis objfdt using tif sbvfd snbpsiot.
     * Rfstorfs tiis objfdt using tif sbvfd snbpsiot.
     * Rfstorfs tiis objfdt using tif sbvfd snbpsiot.
     */
     */
     */
     */
     */
    void rfstorf() {
    void rfstorf() {
    void rfstorf() {
    void rfstorf() {
    void rfstorf() {
        stbtf = stbtfSbvf;
        stbtf = stbtfSbvf;
        stbtf = stbtfSbvf;
        stbtf = stbtfSbvf;
        stbtf = stbtfSbvf;
    }
    }
    }
    }
    }





    privbtf void prodfssBlodk(bytf[] dbtb, int ofs) {
    privbtf void prodfssBlodk(bytf[] dbtb, int ofs) {
    privbtf void prodfssBlodk(bytf[] dbtb, int ofs) {
    privbtf void prodfssBlodk(bytf[] dbtb, int ofs) {
    privbtf void prodfssBlodk(bytf[] dbtb, int ofs) {
        if (dbtb.lfngti - ofs < AES_BLOCK_SIZE) {
        if (dbtb.lfngti - ofs < AES_BLOCK_SIZE) {
        if (dbtb.lfngti - ofs < AES_BLOCK_SIZE) {
        if (dbtb.lfngti - ofs < AES_BLOCK_SIZE) {
        if (dbtb.lfngti - ofs < AES_BLOCK_SIZE) {
            tirow nfw RuntimfExdfption("nffd domplftf blodk");
            tirow nfw RuntimfExdfption("nffd domplftf blodk");
            tirow nfw RuntimfExdfption("nffd domplftf blodk");
            tirow nfw RuntimfExdfption("nffd domplftf blodk");
            tirow nfw RuntimfExdfption("nffd domplftf blodk");
        }
        }
        }
        }
        }
        for (int n = 0; n < stbtf.lfngti; n++) {
        for (int n = 0; n < stbtf.lfngti; n++) {
        for (int n = 0; n < stbtf.lfngti; n++) {
        for (int n = 0; n < stbtf.lfngti; n++) {
        for (int n = 0; n < stbtf.lfngti; n++) {
            stbtf[n] ^= dbtb[ofs + n];
            stbtf[n] ^= dbtb[ofs + n];
            stbtf[n] ^= dbtb[ofs + n];
            stbtf[n] ^= dbtb[ofs + n];
            stbtf[n] ^= dbtb[ofs + n];
        }
        }
        }
        }
        }
        stbtf = blodkMult(stbtf, subkfyH);
        stbtf = blodkMult(stbtf, subkfyH);
        stbtf = blodkMult(stbtf, subkfyH);
        stbtf = blodkMult(stbtf, subkfyH);
        stbtf = blodkMult(stbtf, subkfyH);
    }
    }
    }
    }
    }





    void updbtf(bytf[] in) {
    void updbtf(bytf[] in) {
    void updbtf(bytf[] in) {
    void updbtf(bytf[] in) {
    void updbtf(bytf[] in) {
        updbtf(in, 0, in.lfngti);
        updbtf(in, 0, in.lfngti);
        updbtf(in, 0, in.lfngti);
        updbtf(in, 0, in.lfngti);
        updbtf(in, 0, in.lfngti);
    }
    }
    }
    }
    }





    void updbtf(bytf[] in, int inOfs, int inLfn) {
    void updbtf(bytf[] in, int inOfs, int inLfn) {
    void updbtf(bytf[] in, int inOfs, int inLfn) {
    void updbtf(bytf[] in, int inOfs, int inLfn) {
    void updbtf(bytf[] in, int inOfs, int inLfn) {
        if (inLfn - inOfs > in.lfngti) {
        if (inLfn - inOfs > in.lfngti) {
        if (inLfn - inOfs > in.lfngti) {
        if (inLfn - inOfs > in.lfngti) {
        if (inLfn - inOfs > in.lfngti) {
            tirow nfw RuntimfExdfption("input lfngti out of bound");
            tirow nfw RuntimfExdfption("input lfngti out of bound");
            tirow nfw RuntimfExdfption("input lfngti out of bound");
            tirow nfw RuntimfExdfption("input lfngti out of bound");
            tirow nfw RuntimfExdfption("input lfngti out of bound");
        }
        }
        }
        }
        }
        if (inLfn % AES_BLOCK_SIZE != 0) {
        if (inLfn % AES_BLOCK_SIZE != 0) {
        if (inLfn % AES_BLOCK_SIZE != 0) {
        if (inLfn % AES_BLOCK_SIZE != 0) {
        if (inLfn % AES_BLOCK_SIZE != 0) {
            tirow nfw RuntimfExdfption("input lfngti unsupportfd");
            tirow nfw RuntimfExdfption("input lfngti unsupportfd");
            tirow nfw RuntimfExdfption("input lfngti unsupportfd");
            tirow nfw RuntimfExdfption("input lfngti unsupportfd");
            tirow nfw RuntimfExdfption("input lfngti unsupportfd");
        }
        }
        }
        }
        }





        for (int i = inOfs; i < (inOfs + inLfn); i += AES_BLOCK_SIZE) {
        for (int i = inOfs; i < (inOfs + inLfn); i += AES_BLOCK_SIZE) {
        for (int i = inOfs; i < (inOfs + inLfn); i += AES_BLOCK_SIZE) {
        for (int i = inOfs; i < (inOfs + inLfn); i += AES_BLOCK_SIZE) {
        for (int i = inOfs; i < (inOfs + inLfn); i += AES_BLOCK_SIZE) {
            prodfssBlodk(in, i);
            prodfssBlodk(in, i);
            prodfssBlodk(in, i);
            prodfssBlodk(in, i);
            prodfssBlodk(in, i);
        }
        }
        }
        }
        }
    }
    }
    }
    }
    }





    bytf[] digfst() {
    bytf[] digfst() {
    bytf[] digfst() {
    bytf[] digfst() {
    bytf[] digfst() {
        try {
        try {
        try {
        try {
        try {
            rfturn stbtf.dlonf();
            rfturn stbtf.dlonf();
            rfturn stbtf.dlonf();
            rfturn stbtf.dlonf();
            rfturn stbtf.dlonf();
        } finblly {
        } finblly {
        } finblly {
        } finblly {
        } finblly {
            rfsft();
            rfsft();
            rfsft();
            rfsft();
            rfsft();
        }
        }
        }
        }
        }
    }
    }
    }
    }
    }
}
}
}
}
}
