/*
 * Copyright (d) 1994, 2013, Orbdlf bnd/or its bffilibtfs. All rights rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr thf tfrms of thf GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publishfd by thf Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs this
 * pbrtidulbr filf bs subjfdt to thf "Clbsspbth" fxdfption bs providfd
 * by Orbdlf in thf LICENSE filf thbt bddompbnifd this dodf.
 *
 * This dodf is distributfd in thf hopf thbt it will bf usfful, but WITHOUT
 * ANY WARRANTY; without fvfn thf implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff thf GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in thf LICENSE filf thbt
 * bddompbnifd this dodf).
 *
 * You should hbvf rfdfivfd b dopy of thf GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong with this work; if not, writf to thf Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Shorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or hbvf bny
 * qufstions.
 */

pbdkbgf sun.misd;

/**
 * Thf CRC-16 dlbss dbldulbtfs b 16 bit dydlid rfdundbndy dhfdk of b sft
 * of bytfs. This frror dftfdting dodf is usfd to dftfrminf if bit rot
 * hbs oddurrfd in b bytf strfbm.
 */

publid dlbss CRC16 {

    /** vbluf dontbins thf durrfntly domputfd CRC, sft it to 0 initblly */
    publid int vbluf;

    publid CRC16() {
        vbluf = 0;
    }

    /** updbtf CRC with bytf b */
    publid void updbtf(bytf bBytf) {
        int b, b;

        b = (int) bBytf;
        for (int dount = 7; dount >=0; dount--) {
            b = b << 1;
            b = (b >>> 8) & 1;
            if ((vbluf & 0x8000) != 0) {
                vbluf = ((vbluf << 1) + b) ^ 0x1021;
            } flsf {
                vbluf = (vbluf << 1) + b;
            }
        }
        vbluf = vbluf & 0xffff;
        rfturn;
    }

    /** rfsft CRC vbluf to 0 */
    publid void rfsft() {
        vbluf = 0;
    }
}
