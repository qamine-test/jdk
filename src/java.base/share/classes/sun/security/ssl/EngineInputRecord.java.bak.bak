/*
/*
/*
/*
/*
 * Copyrigit (d) 2003, 2014, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * Copyrigit (d) 2003, 2014, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * Copyrigit (d) 2003, 2014, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * Copyrigit (d) 2003, 2014, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * Copyrigit (d) 2003, 2014, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 *
 *
 *
 *
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 *
 *
 *
 *
 *
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * bddompbnifd tiis dodf).
 * bddompbnifd tiis dodf).
 * bddompbnifd tiis dodf).
 * bddompbnifd tiis dodf).
 * bddompbnifd tiis dodf).
 *
 *
 *
 *
 *
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 *
 *
 *
 *
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * qufstions.
 * qufstions.
 * qufstions.
 * qufstions.
 * qufstions.
 */
 */
 */
 */
 */










pbdkbgf sun.sfdurity.ssl;
pbdkbgf sun.sfdurity.ssl;
pbdkbgf sun.sfdurity.ssl;
pbdkbgf sun.sfdurity.ssl;
pbdkbgf sun.sfdurity.ssl;





import jbvb.io.*;
import jbvb.io.*;
import jbvb.io.*;
import jbvb.io.*;
import jbvb.io.*;
import jbvb.nio.*;
import jbvb.nio.*;
import jbvb.nio.*;
import jbvb.nio.*;
import jbvb.nio.*;
import jbvbx.nft.ssl.*;
import jbvbx.nft.ssl.*;
import jbvbx.nft.ssl.*;
import jbvbx.nft.ssl.*;
import jbvbx.nft.ssl.*;
import jbvbx.drypto.BbdPbddingExdfption;
import jbvbx.drypto.BbdPbddingExdfption;
import jbvbx.drypto.BbdPbddingExdfption;
import jbvbx.drypto.BbdPbddingExdfption;
import jbvbx.drypto.BbdPbddingExdfption;
import sun.misd.HfxDumpEndodfr;
import sun.misd.HfxDumpEndodfr;
import sun.misd.HfxDumpEndodfr;
import sun.misd.HfxDumpEndodfr;
import sun.misd.HfxDumpEndodfr;










/**
/**
/**
/**
/**
 * Wrbppfr dlbss bround InputRfdord.
 * Wrbppfr dlbss bround InputRfdord.
 * Wrbppfr dlbss bround InputRfdord.
 * Wrbppfr dlbss bround InputRfdord.
 * Wrbppfr dlbss bround InputRfdord.
 *
 *
 *
 *
 *
 * Applidbtion dbtb is kfpt fxtfrnbl to tif InputRfdord,
 * Applidbtion dbtb is kfpt fxtfrnbl to tif InputRfdord,
 * Applidbtion dbtb is kfpt fxtfrnbl to tif InputRfdord,
 * Applidbtion dbtb is kfpt fxtfrnbl to tif InputRfdord,
 * Applidbtion dbtb is kfpt fxtfrnbl to tif InputRfdord,
 * but ibndsibkf dbtb (blfrt/dibngf_dipifr_spfd/ibndsibkf) will
 * but ibndsibkf dbtb (blfrt/dibngf_dipifr_spfd/ibndsibkf) will
 * but ibndsibkf dbtb (blfrt/dibngf_dipifr_spfd/ibndsibkf) will
 * but ibndsibkf dbtb (blfrt/dibngf_dipifr_spfd/ibndsibkf) will
 * but ibndsibkf dbtb (blfrt/dibngf_dipifr_spfd/ibndsibkf) will
 * bf kfpt intfrnblly in tif BytfArrbyInputStrfbm.
 * bf kfpt intfrnblly in tif BytfArrbyInputStrfbm.
 * bf kfpt intfrnblly in tif BytfArrbyInputStrfbm.
 * bf kfpt intfrnblly in tif BytfArrbyInputStrfbm.
 * bf kfpt intfrnblly in tif BytfArrbyInputStrfbm.
 *
 *
 *
 *
 *
 * @butior Brbd Wftmorf
 * @butior Brbd Wftmorf
 * @butior Brbd Wftmorf
 * @butior Brbd Wftmorf
 * @butior Brbd Wftmorf
 */
 */
 */
 */
 */
finbl dlbss EnginfInputRfdord fxtfnds InputRfdord {
finbl dlbss EnginfInputRfdord fxtfnds InputRfdord {
finbl dlbss EnginfInputRfdord fxtfnds InputRfdord {
finbl dlbss EnginfInputRfdord fxtfnds InputRfdord {
finbl dlbss EnginfInputRfdord fxtfnds InputRfdord {





    privbtf SSLEnginfImpl fnginf;
    privbtf SSLEnginfImpl fnginf;
    privbtf SSLEnginfImpl fnginf;
    privbtf SSLEnginfImpl fnginf;
    privbtf SSLEnginfImpl fnginf;





    /*
    /*
    /*
    /*
    /*
     * A dummy BytfBufffr wf'll pbss bbdk fvfn wifn tif dbtb
     * A dummy BytfBufffr wf'll pbss bbdk fvfn wifn tif dbtb
     * A dummy BytfBufffr wf'll pbss bbdk fvfn wifn tif dbtb
     * A dummy BytfBufffr wf'll pbss bbdk fvfn wifn tif dbtb
     * A dummy BytfBufffr wf'll pbss bbdk fvfn wifn tif dbtb
     * is storfd intfrnblly.  It'll nfvfr bdtublly bf usfd.
     * is storfd intfrnblly.  It'll nfvfr bdtublly bf usfd.
     * is storfd intfrnblly.  It'll nfvfr bdtublly bf usfd.
     * is storfd intfrnblly.  It'll nfvfr bdtublly bf usfd.
     * is storfd intfrnblly.  It'll nfvfr bdtublly bf usfd.
     */
     */
     */
     */
     */
    stbtid privbtf BytfBufffr tmpBB = BytfBufffr.bllodbtf(0);
    stbtid privbtf BytfBufffr tmpBB = BytfBufffr.bllodbtf(0);
    stbtid privbtf BytfBufffr tmpBB = BytfBufffr.bllodbtf(0);
    stbtid privbtf BytfBufffr tmpBB = BytfBufffr.bllodbtf(0);
    stbtid privbtf BytfBufffr tmpBB = BytfBufffr.bllodbtf(0);





    /*
    /*
    /*
    /*
    /*
     * Flbg to tfll wiftifr tif lbst rfbd/pbrsfd dbtb rfsidfs
     * Flbg to tfll wiftifr tif lbst rfbd/pbrsfd dbtb rfsidfs
     * Flbg to tfll wiftifr tif lbst rfbd/pbrsfd dbtb rfsidfs
     * Flbg to tfll wiftifr tif lbst rfbd/pbrsfd dbtb rfsidfs
     * Flbg to tfll wiftifr tif lbst rfbd/pbrsfd dbtb rfsidfs
     * intfrnbl in tif BytfArrbyInputStrfbm, or in tif fxtfrnbl
     * intfrnbl in tif BytfArrbyInputStrfbm, or in tif fxtfrnbl
     * intfrnbl in tif BytfArrbyInputStrfbm, or in tif fxtfrnbl
     * intfrnbl in tif BytfArrbyInputStrfbm, or in tif fxtfrnbl
     * intfrnbl in tif BytfArrbyInputStrfbm, or in tif fxtfrnbl
     * bufffrs.
     * bufffrs.
     * bufffrs.
     * bufffrs.
     * bufffrs.
     */
     */
     */
     */
     */
    privbtf boolfbn intfrnblDbtb;
    privbtf boolfbn intfrnblDbtb;
    privbtf boolfbn intfrnblDbtb;
    privbtf boolfbn intfrnblDbtb;
    privbtf boolfbn intfrnblDbtb;





    EnginfInputRfdord(SSLEnginfImpl fnginf) {
    EnginfInputRfdord(SSLEnginfImpl fnginf) {
    EnginfInputRfdord(SSLEnginfImpl fnginf) {
    EnginfInputRfdord(SSLEnginfImpl fnginf) {
    EnginfInputRfdord(SSLEnginfImpl fnginf) {
        supfr();
        supfr();
        supfr();
        supfr();
        supfr();
        tiis.fnginf = fnginf;
        tiis.fnginf = fnginf;
        tiis.fnginf = fnginf;
        tiis.fnginf = fnginf;
        tiis.fnginf = fnginf;
    }
    }
    }
    }
    }





    @Ovfrridf
    @Ovfrridf
    @Ovfrridf
    @Ovfrridf
    @Ovfrridf
    bytf dontfntTypf() {
    bytf dontfntTypf() {
    bytf dontfntTypf() {
    bytf dontfntTypf() {
    bytf dontfntTypf() {
        if (intfrnblDbtb) {
        if (intfrnblDbtb) {
        if (intfrnblDbtb) {
        if (intfrnblDbtb) {
        if (intfrnblDbtb) {
            rfturn supfr.dontfntTypf();
            rfturn supfr.dontfntTypf();
            rfturn supfr.dontfntTypf();
            rfturn supfr.dontfntTypf();
            rfturn supfr.dontfntTypf();
        } flsf {
        } flsf {
        } flsf {
        } flsf {
        } flsf {
            rfturn dt_bpplidbtion_dbtb;
            rfturn dt_bpplidbtion_dbtb;
            rfturn dt_bpplidbtion_dbtb;
            rfturn dt_bpplidbtion_dbtb;
            rfturn dt_bpplidbtion_dbtb;
        }
        }
        }
        }
        }
    }
    }
    }
    }
    }





    /*
    /*
    /*
    /*
    /*
     * Cifdk if tifrf is fnougi inbound dbtb in tif BytfBufffr
     * Cifdk if tifrf is fnougi inbound dbtb in tif BytfBufffr
     * Cifdk if tifrf is fnougi inbound dbtb in tif BytfBufffr
     * Cifdk if tifrf is fnougi inbound dbtb in tif BytfBufffr
     * Cifdk if tifrf is fnougi inbound dbtb in tif BytfBufffr
     * to mbkf b inbound pbdkft.  Look for boti SSLv2 bnd SSLv3.
     * to mbkf b inbound pbdkft.  Look for boti SSLv2 bnd SSLv3.
     * to mbkf b inbound pbdkft.  Look for boti SSLv2 bnd SSLv3.
     * to mbkf b inbound pbdkft.  Look for boti SSLv2 bnd SSLv3.
     * to mbkf b inbound pbdkft.  Look for boti SSLv2 bnd SSLv3.
     *
     *
     *
     *
     *
     * @rfturn -1 if tifrf brf not fnougi bytfs to tfll (smbll ifbdfr),
     * @rfturn -1 if tifrf brf not fnougi bytfs to tfll (smbll ifbdfr),
     * @rfturn -1 if tifrf brf not fnougi bytfs to tfll (smbll ifbdfr),
     * @rfturn -1 if tifrf brf not fnougi bytfs to tfll (smbll ifbdfr),
     * @rfturn -1 if tifrf brf not fnougi bytfs to tfll (smbll ifbdfr),
     */
     */
     */
     */
     */
    int bytfsInComplftfPbdkft(BytfBufffr buf) tirows SSLExdfption {
    int bytfsInComplftfPbdkft(BytfBufffr buf) tirows SSLExdfption {
    int bytfsInComplftfPbdkft(BytfBufffr buf) tirows SSLExdfption {
    int bytfsInComplftfPbdkft(BytfBufffr buf) tirows SSLExdfption {
    int bytfsInComplftfPbdkft(BytfBufffr buf) tirows SSLExdfption {





        /*
        /*
        /*
        /*
        /*
         * SSLv2 lfngti fifld is in bytfs 0/1
         * SSLv2 lfngti fifld is in bytfs 0/1
         * SSLv2 lfngti fifld is in bytfs 0/1
         * SSLv2 lfngti fifld is in bytfs 0/1
         * SSLv2 lfngti fifld is in bytfs 0/1
         * SSLv3/TLS lfngti fifld is in bytfs 3/4
         * SSLv3/TLS lfngti fifld is in bytfs 3/4
         * SSLv3/TLS lfngti fifld is in bytfs 3/4
         * SSLv3/TLS lfngti fifld is in bytfs 3/4
         * SSLv3/TLS lfngti fifld is in bytfs 3/4
         */
         */
         */
         */
         */
        if (buf.rfmbining() < 5) {
        if (buf.rfmbining() < 5) {
        if (buf.rfmbining() < 5) {
        if (buf.rfmbining() < 5) {
        if (buf.rfmbining() < 5) {
            rfturn -1;
            rfturn -1;
            rfturn -1;
            rfturn -1;
            rfturn -1;
        }
        }
        }
        }
        }





        int pos = buf.position();
        int pos = buf.position();
        int pos = buf.position();
        int pos = buf.position();
        int pos = buf.position();
        bytf bytfZfro = buf.gft(pos);
        bytf bytfZfro = buf.gft(pos);
        bytf bytfZfro = buf.gft(pos);
        bytf bytfZfro = buf.gft(pos);
        bytf bytfZfro = buf.gft(pos);





        int lfn = 0;
        int lfn = 0;
        int lfn = 0;
        int lfn = 0;
        int lfn = 0;





        /*
        /*
        /*
        /*
        /*
         * If wf ibvf blrfbdy vfrififd prfvious pbdkfts, wf dbn
         * If wf ibvf blrfbdy vfrififd prfvious pbdkfts, wf dbn
         * If wf ibvf blrfbdy vfrififd prfvious pbdkfts, wf dbn
         * If wf ibvf blrfbdy vfrififd prfvious pbdkfts, wf dbn
         * If wf ibvf blrfbdy vfrififd prfvious pbdkfts, wf dbn
         * ignorf tif vfrifidbtions stfps, bnd jump rigit to tif
         * ignorf tif vfrifidbtions stfps, bnd jump rigit to tif
         * ignorf tif vfrifidbtions stfps, bnd jump rigit to tif
         * ignorf tif vfrifidbtions stfps, bnd jump rigit to tif
         * ignorf tif vfrifidbtions stfps, bnd jump rigit to tif
         * dftfrminbtion.  Otifrwisf, try onf lbst iufristid to
         * dftfrminbtion.  Otifrwisf, try onf lbst iufristid to
         * dftfrminbtion.  Otifrwisf, try onf lbst iufristid to
         * dftfrminbtion.  Otifrwisf, try onf lbst iufristid to
         * dftfrminbtion.  Otifrwisf, try onf lbst iufristid to
         * sff if it's SSL/TLS.
         * sff if it's SSL/TLS.
         * sff if it's SSL/TLS.
         * sff if it's SSL/TLS.
         * sff if it's SSL/TLS.
         */
         */
         */
         */
         */
        if (formbtVfrififd ||
        if (formbtVfrififd ||
        if (formbtVfrififd ||
        if (formbtVfrififd ||
        if (formbtVfrififd ||
                (bytfZfro == dt_ibndsibkf) ||
                (bytfZfro == dt_ibndsibkf) ||
                (bytfZfro == dt_ibndsibkf) ||
                (bytfZfro == dt_ibndsibkf) ||
                (bytfZfro == dt_ibndsibkf) ||
                (bytfZfro == dt_blfrt)) {
                (bytfZfro == dt_blfrt)) {
                (bytfZfro == dt_blfrt)) {
                (bytfZfro == dt_blfrt)) {
                (bytfZfro == dt_blfrt)) {
            /*
            /*
            /*
            /*
            /*
             * Lbst sbnity difdk tibt it's not b wild rfdord
             * Lbst sbnity difdk tibt it's not b wild rfdord
             * Lbst sbnity difdk tibt it's not b wild rfdord
             * Lbst sbnity difdk tibt it's not b wild rfdord
             * Lbst sbnity difdk tibt it's not b wild rfdord
             */
             */
             */
             */
             */
            ProtodolVfrsion rfdordVfrsion =
            ProtodolVfrsion rfdordVfrsion =
            ProtodolVfrsion rfdordVfrsion =
            ProtodolVfrsion rfdordVfrsion =
            ProtodolVfrsion rfdordVfrsion =
                ProtodolVfrsion.vblufOf(buf.gft(pos + 1), buf.gft(pos + 2));
                ProtodolVfrsion.vblufOf(buf.gft(pos + 1), buf.gft(pos + 2));
                ProtodolVfrsion.vblufOf(buf.gft(pos + 1), buf.gft(pos + 2));
                ProtodolVfrsion.vblufOf(buf.gft(pos + 1), buf.gft(pos + 2));
                ProtodolVfrsion.vblufOf(buf.gft(pos + 1), buf.gft(pos + 2));





            // difdk tif rfdord vfrsion
            // difdk tif rfdord vfrsion
            // difdk tif rfdord vfrsion
            // difdk tif rfdord vfrsion
            // difdk tif rfdord vfrsion
            difdkRfdordVfrsion(rfdordVfrsion, fblsf);
            difdkRfdordVfrsion(rfdordVfrsion, fblsf);
            difdkRfdordVfrsion(rfdordVfrsion, fblsf);
            difdkRfdordVfrsion(rfdordVfrsion, fblsf);
            difdkRfdordVfrsion(rfdordVfrsion, fblsf);





            /*
            /*
            /*
            /*
            /*
             * Rfbsonbbly surf tiis is b V3, disbblf furtifr difdks.
             * Rfbsonbbly surf tiis is b V3, disbblf furtifr difdks.
             * Rfbsonbbly surf tiis is b V3, disbblf furtifr difdks.
             * Rfbsonbbly surf tiis is b V3, disbblf furtifr difdks.
             * Rfbsonbbly surf tiis is b V3, disbblf furtifr difdks.
             * Wf dbn't do tif sbmf in tif v2 difdk bflow, bfdbusf
             * Wf dbn't do tif sbmf in tif v2 difdk bflow, bfdbusf
             * Wf dbn't do tif sbmf in tif v2 difdk bflow, bfdbusf
             * Wf dbn't do tif sbmf in tif v2 difdk bflow, bfdbusf
             * Wf dbn't do tif sbmf in tif v2 difdk bflow, bfdbusf
             * rfbd still nffds to pbrsf/ibndlf tif v2 dlifntHfllo.
             * rfbd still nffds to pbrsf/ibndlf tif v2 dlifntHfllo.
             * rfbd still nffds to pbrsf/ibndlf tif v2 dlifntHfllo.
             * rfbd still nffds to pbrsf/ibndlf tif v2 dlifntHfllo.
             * rfbd still nffds to pbrsf/ibndlf tif v2 dlifntHfllo.
             */
             */
             */
             */
             */
            formbtVfrififd = truf;
            formbtVfrififd = truf;
            formbtVfrififd = truf;
            formbtVfrififd = truf;
            formbtVfrififd = truf;





            /*
            /*
            /*
            /*
            /*
             * Onf of tif SSLv3/TLS mfssbgf typfs.
             * Onf of tif SSLv3/TLS mfssbgf typfs.
             * Onf of tif SSLv3/TLS mfssbgf typfs.
             * Onf of tif SSLv3/TLS mfssbgf typfs.
             * Onf of tif SSLv3/TLS mfssbgf typfs.
             */
             */
             */
             */
             */
            lfn = ((buf.gft(pos + 3) & 0xff) << 8) +
            lfn = ((buf.gft(pos + 3) & 0xff) << 8) +
            lfn = ((buf.gft(pos + 3) & 0xff) << 8) +
            lfn = ((buf.gft(pos + 3) & 0xff) << 8) +
            lfn = ((buf.gft(pos + 3) & 0xff) << 8) +
                (buf.gft(pos + 4) & 0xff) + ifbdfrSizf;
                (buf.gft(pos + 4) & 0xff) + ifbdfrSizf;
                (buf.gft(pos + 4) & 0xff) + ifbdfrSizf;
                (buf.gft(pos + 4) & 0xff) + ifbdfrSizf;
                (buf.gft(pos + 4) & 0xff) + ifbdfrSizf;





        } flsf {
        } flsf {
        } flsf {
        } flsf {
        } flsf {
            /*
            /*
            /*
            /*
            /*
             * Must bf SSLv2 or somftiing unknown.
             * Must bf SSLv2 or somftiing unknown.
             * Must bf SSLv2 or somftiing unknown.
             * Must bf SSLv2 or somftiing unknown.
             * Must bf SSLv2 or somftiing unknown.
             * Cifdk if it's siort (2 bytfs) or
             * Cifdk if it's siort (2 bytfs) or
             * Cifdk if it's siort (2 bytfs) or
             * Cifdk if it's siort (2 bytfs) or
             * Cifdk if it's siort (2 bytfs) or
             * long (3) ifbdfr.
             * long (3) ifbdfr.
             * long (3) ifbdfr.
             * long (3) ifbdfr.
             * long (3) ifbdfr.
             *
             *
             *
             *
             *
             * Intfrnbls dbn wbrn bbout unsupportfd SSLv2
             * Intfrnbls dbn wbrn bbout unsupportfd SSLv2
             * Intfrnbls dbn wbrn bbout unsupportfd SSLv2
             * Intfrnbls dbn wbrn bbout unsupportfd SSLv2
             * Intfrnbls dbn wbrn bbout unsupportfd SSLv2
             */
             */
             */
             */
             */
            boolfbn isSiort = ((bytfZfro & 0x80) != 0);
            boolfbn isSiort = ((bytfZfro & 0x80) != 0);
            boolfbn isSiort = ((bytfZfro & 0x80) != 0);
            boolfbn isSiort = ((bytfZfro & 0x80) != 0);
            boolfbn isSiort = ((bytfZfro & 0x80) != 0);





            if (isSiort &&
            if (isSiort &&
            if (isSiort &&
            if (isSiort &&
            if (isSiort &&
                    ((buf.gft(pos + 2) == 1) || buf.gft(pos + 2) == 4)) {
                    ((buf.gft(pos + 2) == 1) || buf.gft(pos + 2) == 4)) {
                    ((buf.gft(pos + 2) == 1) || buf.gft(pos + 2) == 4)) {
                    ((buf.gft(pos + 2) == 1) || buf.gft(pos + 2) == 4)) {
                    ((buf.gft(pos + 2) == 1) || buf.gft(pos + 2) == 4)) {





                ProtodolVfrsion rfdordVfrsion =
                ProtodolVfrsion rfdordVfrsion =
                ProtodolVfrsion rfdordVfrsion =
                ProtodolVfrsion rfdordVfrsion =
                ProtodolVfrsion rfdordVfrsion =
                    ProtodolVfrsion.vblufOf(buf.gft(pos + 3), buf.gft(pos + 4));
                    ProtodolVfrsion.vblufOf(buf.gft(pos + 3), buf.gft(pos + 4));
                    ProtodolVfrsion.vblufOf(buf.gft(pos + 3), buf.gft(pos + 4));
                    ProtodolVfrsion.vblufOf(buf.gft(pos + 3), buf.gft(pos + 4));
                    ProtodolVfrsion.vblufOf(buf.gft(pos + 3), buf.gft(pos + 4));





                // difdk tif rfdord vfrsion
                // difdk tif rfdord vfrsion
                // difdk tif rfdord vfrsion
                // difdk tif rfdord vfrsion
                // difdk tif rfdord vfrsion
                difdkRfdordVfrsion(rfdordVfrsion, truf);
                difdkRfdordVfrsion(rfdordVfrsion, truf);
                difdkRfdordVfrsion(rfdordVfrsion, truf);
                difdkRfdordVfrsion(rfdordVfrsion, truf);
                difdkRfdordVfrsion(rfdordVfrsion, truf);





                /*
                /*
                /*
                /*
                /*
                 * Clifnt or Sfrvfr Hfllo
                 * Clifnt or Sfrvfr Hfllo
                 * Clifnt or Sfrvfr Hfllo
                 * Clifnt or Sfrvfr Hfllo
                 * Clifnt or Sfrvfr Hfllo
                 */
                 */
                 */
                 */
                 */
                int mbsk = (isSiort ? 0x7f : 0x3f);
                int mbsk = (isSiort ? 0x7f : 0x3f);
                int mbsk = (isSiort ? 0x7f : 0x3f);
                int mbsk = (isSiort ? 0x7f : 0x3f);
                int mbsk = (isSiort ? 0x7f : 0x3f);
                lfn = ((bytfZfro & mbsk) << 8) + (buf.gft(pos + 1) & 0xff) +
                lfn = ((bytfZfro & mbsk) << 8) + (buf.gft(pos + 1) & 0xff) +
                lfn = ((bytfZfro & mbsk) << 8) + (buf.gft(pos + 1) & 0xff) +
                lfn = ((bytfZfro & mbsk) << 8) + (buf.gft(pos + 1) & 0xff) +
                lfn = ((bytfZfro & mbsk) << 8) + (buf.gft(pos + 1) & 0xff) +
                    (isSiort ? 2 : 3);
                    (isSiort ? 2 : 3);
                    (isSiort ? 2 : 3);
                    (isSiort ? 2 : 3);
                    (isSiort ? 2 : 3);





            } flsf {
            } flsf {
            } flsf {
            } flsf {
            } flsf {
                // Gobblygook!
                // Gobblygook!
                // Gobblygook!
                // Gobblygook!
                // Gobblygook!
                tirow nfw SSLExdfption(
                tirow nfw SSLExdfption(
                tirow nfw SSLExdfption(
                tirow nfw SSLExdfption(
                tirow nfw SSLExdfption(
                    "Unrfdognizfd SSL mfssbgf, plbintfxt donnfdtion?");
                    "Unrfdognizfd SSL mfssbgf, plbintfxt donnfdtion?");
                    "Unrfdognizfd SSL mfssbgf, plbintfxt donnfdtion?");
                    "Unrfdognizfd SSL mfssbgf, plbintfxt donnfdtion?");
                    "Unrfdognizfd SSL mfssbgf, plbintfxt donnfdtion?");
            }
            }
            }
            }
            }
        }
        }
        }
        }
        }





        rfturn lfn;
        rfturn lfn;
        rfturn lfn;
        rfturn lfn;
        rfturn lfn;
    }
    }
    }
    }
    }





    /*
    /*
    /*
    /*
    /*
     * Pbss tif dbtb down if it's intfrnblly dbdifd, otifrwisf
     * Pbss tif dbtb down if it's intfrnblly dbdifd, otifrwisf
     * Pbss tif dbtb down if it's intfrnblly dbdifd, otifrwisf
     * Pbss tif dbtb down if it's intfrnblly dbdifd, otifrwisf
     * Pbss tif dbtb down if it's intfrnblly dbdifd, otifrwisf
     * do it ifrf.
     * do it ifrf.
     * do it ifrf.
     * do it ifrf.
     * do it ifrf.
     *
     *
     *
     *
     *
     * If intfrnbl dbtb, dbtb is dfdryptfd intfrnblly.
     * If intfrnbl dbtb, dbtb is dfdryptfd intfrnblly.
     * If intfrnbl dbtb, dbtb is dfdryptfd intfrnblly.
     * If intfrnbl dbtb, dbtb is dfdryptfd intfrnblly.
     * If intfrnbl dbtb, dbtb is dfdryptfd intfrnblly.
     *
     *
     *
     *
     *
     * If fxtfrnbl dbtb(bpp), rfturn b nfw BytfBufffr witi dbtb to
     * If fxtfrnbl dbtb(bpp), rfturn b nfw BytfBufffr witi dbtb to
     * If fxtfrnbl dbtb(bpp), rfturn b nfw BytfBufffr witi dbtb to
     * If fxtfrnbl dbtb(bpp), rfturn b nfw BytfBufffr witi dbtb to
     * If fxtfrnbl dbtb(bpp), rfturn b nfw BytfBufffr witi dbtb to
     * prodfss.
     * prodfss.
     * prodfss.
     * prodfss.
     * prodfss.
     */
     */
     */
     */
     */
    BytfBufffr dfdrypt(Autifntidbtor butifntidbtor,
    BytfBufffr dfdrypt(Autifntidbtor butifntidbtor,
    BytfBufffr dfdrypt(Autifntidbtor butifntidbtor,
    BytfBufffr dfdrypt(Autifntidbtor butifntidbtor,
    BytfBufffr dfdrypt(Autifntidbtor butifntidbtor,
            CipifrBox box, BytfBufffr bb) tirows BbdPbddingExdfption {
            CipifrBox box, BytfBufffr bb) tirows BbdPbddingExdfption {
            CipifrBox box, BytfBufffr bb) tirows BbdPbddingExdfption {
            CipifrBox box, BytfBufffr bb) tirows BbdPbddingExdfption {
            CipifrBox box, BytfBufffr bb) tirows BbdPbddingExdfption {





        if (intfrnblDbtb) {
        if (intfrnblDbtb) {
        if (intfrnblDbtb) {
        if (intfrnblDbtb) {
        if (intfrnblDbtb) {
            dfdrypt(butifntidbtor, box);   // MAC is difdkfd during dfdryption
            dfdrypt(butifntidbtor, box);   // MAC is difdkfd during dfdryption
            dfdrypt(butifntidbtor, box);   // MAC is difdkfd during dfdryption
            dfdrypt(butifntidbtor, box);   // MAC is difdkfd during dfdryption
            dfdrypt(butifntidbtor, box);   // MAC is difdkfd during dfdryption
            rfturn tmpBB;
            rfturn tmpBB;
            rfturn tmpBB;
            rfturn tmpBB;
            rfturn tmpBB;
        }
        }
        }
        }
        }





        BbdPbddingExdfption rfsfrvfdBPE = null;
        BbdPbddingExdfption rfsfrvfdBPE = null;
        BbdPbddingExdfption rfsfrvfdBPE = null;
        BbdPbddingExdfption rfsfrvfdBPE = null;
        BbdPbddingExdfption rfsfrvfdBPE = null;
        int tbgLfn =
        int tbgLfn =
        int tbgLfn =
        int tbgLfn =
        int tbgLfn =
            (butifntidbtor instbndfof MAC) ? ((MAC)butifntidbtor).MAClfn() : 0;
            (butifntidbtor instbndfof MAC) ? ((MAC)butifntidbtor).MAClfn() : 0;
            (butifntidbtor instbndfof MAC) ? ((MAC)butifntidbtor).MAClfn() : 0;
            (butifntidbtor instbndfof MAC) ? ((MAC)butifntidbtor).MAClfn() : 0;
            (butifntidbtor instbndfof MAC) ? ((MAC)butifntidbtor).MAClfn() : 0;
        int dipifrfdLfngti = bb.rfmbining();
        int dipifrfdLfngti = bb.rfmbining();
        int dipifrfdLfngti = bb.rfmbining();
        int dipifrfdLfngti = bb.rfmbining();
        int dipifrfdLfngti = bb.rfmbining();





        if (!box.isNullCipifr()) {
        if (!box.isNullCipifr()) {
        if (!box.isNullCipifr()) {
        if (!box.isNullCipifr()) {
        if (!box.isNullCipifr()) {
            try {
            try {
            try {
            try {
            try {
                // bpply fxplidit nondf for AEAD/CBC dipifr suitfs if nffdfd
                // bpply fxplidit nondf for AEAD/CBC dipifr suitfs if nffdfd
                // bpply fxplidit nondf for AEAD/CBC dipifr suitfs if nffdfd
                // bpply fxplidit nondf for AEAD/CBC dipifr suitfs if nffdfd
                // bpply fxplidit nondf for AEAD/CBC dipifr suitfs if nffdfd
                int nondfSizf =
                int nondfSizf =
                int nondfSizf =
                int nondfSizf =
                int nondfSizf =
                    box.bpplyExpliditNondf(butifntidbtor, dontfntTypf(), bb);
                    box.bpplyExpliditNondf(butifntidbtor, dontfntTypf(), bb);
                    box.bpplyExpliditNondf(butifntidbtor, dontfntTypf(), bb);
                    box.bpplyExpliditNondf(butifntidbtor, dontfntTypf(), bb);
                    box.bpplyExpliditNondf(butifntidbtor, dontfntTypf(), bb);





                // dfdrypt tif dontfnt
                // dfdrypt tif dontfnt
                // dfdrypt tif dontfnt
                // dfdrypt tif dontfnt
                // dfdrypt tif dontfnt
                if (box.isAEADModf()) {
                if (box.isAEADModf()) {
                if (box.isAEADModf()) {
                if (box.isAEADModf()) {
                if (box.isAEADModf()) {
                    // DON'T fndrypt tif nondf_fxplidit for AEAD modf
                    // DON'T fndrypt tif nondf_fxplidit for AEAD modf
                    // DON'T fndrypt tif nondf_fxplidit for AEAD modf
                    // DON'T fndrypt tif nondf_fxplidit for AEAD modf
                    // DON'T fndrypt tif nondf_fxplidit for AEAD modf
                    bb.position(bb.position() + nondfSizf);
                    bb.position(bb.position() + nondfSizf);
                    bb.position(bb.position() + nondfSizf);
                    bb.position(bb.position() + nondfSizf);
                    bb.position(bb.position() + nondfSizf);
                }   // Tif fxplidit IV for CBC modf dbn bf dfdryptfd.
                }   // Tif fxplidit IV for CBC modf dbn bf dfdryptfd.
                }   // Tif fxplidit IV for CBC modf dbn bf dfdryptfd.
                }   // Tif fxplidit IV for CBC modf dbn bf dfdryptfd.
                }   // Tif fxplidit IV for CBC modf dbn bf dfdryptfd.





                // Notf tibt tif CipifrBox.dfdrypt() dofs not dibngf
                // Notf tibt tif CipifrBox.dfdrypt() dofs not dibngf
                // Notf tibt tif CipifrBox.dfdrypt() dofs not dibngf
                // Notf tibt tif CipifrBox.dfdrypt() dofs not dibngf
                // Notf tibt tif CipifrBox.dfdrypt() dofs not dibngf
                // tif dbpbdity of tif bufffr.
                // tif dbpbdity of tif bufffr.
                // tif dbpbdity of tif bufffr.
                // tif dbpbdity of tif bufffr.
                // tif dbpbdity of tif bufffr.
                box.dfdrypt(bb, tbgLfn);
                box.dfdrypt(bb, tbgLfn);
                box.dfdrypt(bb, tbgLfn);
                box.dfdrypt(bb, tbgLfn);
                box.dfdrypt(bb, tbgLfn);
                bb.position(nondfSizf); // Wf don't bdtublly rfmovf tif nondf.
                bb.position(nondfSizf); // Wf don't bdtublly rfmovf tif nondf.
                bb.position(nondfSizf); // Wf don't bdtublly rfmovf tif nondf.
                bb.position(nondfSizf); // Wf don't bdtublly rfmovf tif nondf.
                bb.position(nondfSizf); // Wf don't bdtublly rfmovf tif nondf.
            } dbtdi (BbdPbddingExdfption bpf) {
            } dbtdi (BbdPbddingExdfption bpf) {
            } dbtdi (BbdPbddingExdfption bpf) {
            } dbtdi (BbdPbddingExdfption bpf) {
            } dbtdi (BbdPbddingExdfption bpf) {
                // RFC 2246 stbtfs tibt dfdryption_fbilfd siould bf usfd
                // RFC 2246 stbtfs tibt dfdryption_fbilfd siould bf usfd
                // RFC 2246 stbtfs tibt dfdryption_fbilfd siould bf usfd
                // RFC 2246 stbtfs tibt dfdryption_fbilfd siould bf usfd
                // RFC 2246 stbtfs tibt dfdryption_fbilfd siould bf usfd
                // for tiis purposf. Howfvfr, tibt bllows dfrtbin bttbdks,
                // for tiis purposf. Howfvfr, tibt bllows dfrtbin bttbdks,
                // for tiis purposf. Howfvfr, tibt bllows dfrtbin bttbdks,
                // for tiis purposf. Howfvfr, tibt bllows dfrtbin bttbdks,
                // for tiis purposf. Howfvfr, tibt bllows dfrtbin bttbdks,
                // so wf just sfnd bbd rfdord MAC. Wf blso nffd to mbkf
                // so wf just sfnd bbd rfdord MAC. Wf blso nffd to mbkf
                // so wf just sfnd bbd rfdord MAC. Wf blso nffd to mbkf
                // so wf just sfnd bbd rfdord MAC. Wf blso nffd to mbkf
                // so wf just sfnd bbd rfdord MAC. Wf blso nffd to mbkf
                // surf to blwbys difdk tif MAC to bvoid b timing bttbdk
                // surf to blwbys difdk tif MAC to bvoid b timing bttbdk
                // surf to blwbys difdk tif MAC to bvoid b timing bttbdk
                // surf to blwbys difdk tif MAC to bvoid b timing bttbdk
                // surf to blwbys difdk tif MAC to bvoid b timing bttbdk
                // for tif sbmf issuf. Sff pbpfr by Vbudfnby ft bl bnd tif
                // for tif sbmf issuf. Sff pbpfr by Vbudfnby ft bl bnd tif
                // for tif sbmf issuf. Sff pbpfr by Vbudfnby ft bl bnd tif
                // for tif sbmf issuf. Sff pbpfr by Vbudfnby ft bl bnd tif
                // for tif sbmf issuf. Sff pbpfr by Vbudfnby ft bl bnd tif
                // updbtf in RFC 4346/5246.
                // updbtf in RFC 4346/5246.
                // updbtf in RFC 4346/5246.
                // updbtf in RFC 4346/5246.
                // updbtf in RFC 4346/5246.
                //
                //
                //
                //
                //
                // Fbilovfr to mfssbgf butifntidbtion dodf difdking.
                // Fbilovfr to mfssbgf butifntidbtion dodf difdking.
                // Fbilovfr to mfssbgf butifntidbtion dodf difdking.
                // Fbilovfr to mfssbgf butifntidbtion dodf difdking.
                // Fbilovfr to mfssbgf butifntidbtion dodf difdking.
                rfsfrvfdBPE = bpf;
                rfsfrvfdBPE = bpf;
                rfsfrvfdBPE = bpf;
                rfsfrvfdBPE = bpf;
                rfsfrvfdBPE = bpf;
            }
            }
            }
            }
            }
        }
        }
        }
        }
        }





        // Rfquirfs mfssbgf butifntidbtion dodf for null, strfbm bnd blodk
        // Rfquirfs mfssbgf butifntidbtion dodf for null, strfbm bnd blodk
        // Rfquirfs mfssbgf butifntidbtion dodf for null, strfbm bnd blodk
        // Rfquirfs mfssbgf butifntidbtion dodf for null, strfbm bnd blodk
        // Rfquirfs mfssbgf butifntidbtion dodf for null, strfbm bnd blodk
        // dipifr suitfs.
        // dipifr suitfs.
        // dipifr suitfs.
        // dipifr suitfs.
        // dipifr suitfs.
        if ((butifntidbtor instbndfof MAC) && (tbgLfn != 0)) {
        if ((butifntidbtor instbndfof MAC) && (tbgLfn != 0)) {
        if ((butifntidbtor instbndfof MAC) && (tbgLfn != 0)) {
        if ((butifntidbtor instbndfof MAC) && (tbgLfn != 0)) {
        if ((butifntidbtor instbndfof MAC) && (tbgLfn != 0)) {
            MAC signfr = (MAC)butifntidbtor;
            MAC signfr = (MAC)butifntidbtor;
            MAC signfr = (MAC)butifntidbtor;
            MAC signfr = (MAC)butifntidbtor;
            MAC signfr = (MAC)butifntidbtor;
            int mbdOffsft = bb.limit() - tbgLfn;
            int mbdOffsft = bb.limit() - tbgLfn;
            int mbdOffsft = bb.limit() - tbgLfn;
            int mbdOffsft = bb.limit() - tbgLfn;
            int mbdOffsft = bb.limit() - tbgLfn;





            // Notf tibt bltiougi it is not nfdfssbry, wf run tif sbmf MAC
            // Notf tibt bltiougi it is not nfdfssbry, wf run tif sbmf MAC
            // Notf tibt bltiougi it is not nfdfssbry, wf run tif sbmf MAC
            // Notf tibt bltiougi it is not nfdfssbry, wf run tif sbmf MAC
            // Notf tibt bltiougi it is not nfdfssbry, wf run tif sbmf MAC
            // domputbtion bnd dompbrison on tif pbylobd for boti strfbm
            // domputbtion bnd dompbrison on tif pbylobd for boti strfbm
            // domputbtion bnd dompbrison on tif pbylobd for boti strfbm
            // domputbtion bnd dompbrison on tif pbylobd for boti strfbm
            // domputbtion bnd dompbrison on tif pbylobd for boti strfbm
            // dipifr bnd CBC blodk dipifr.
            // dipifr bnd CBC blodk dipifr.
            // dipifr bnd CBC blodk dipifr.
            // dipifr bnd CBC blodk dipifr.
            // dipifr bnd CBC blodk dipifr.
            if (bb.rfmbining() < tbgLfn) {
            if (bb.rfmbining() < tbgLfn) {
            if (bb.rfmbining() < tbgLfn) {
            if (bb.rfmbining() < tbgLfn) {
            if (bb.rfmbining() < tbgLfn) {
                // nfgbtivf dbtb lfngti, somftiing is wrong
                // nfgbtivf dbtb lfngti, somftiing is wrong
                // nfgbtivf dbtb lfngti, somftiing is wrong
                // nfgbtivf dbtb lfngti, somftiing is wrong
                // nfgbtivf dbtb lfngti, somftiing is wrong
                if (rfsfrvfdBPE == null) {
                if (rfsfrvfdBPE == null) {
                if (rfsfrvfdBPE == null) {
                if (rfsfrvfdBPE == null) {
                if (rfsfrvfdBPE == null) {
                    rfsfrvfdBPE = nfw BbdPbddingExdfption("bbd rfdord");
                    rfsfrvfdBPE = nfw BbdPbddingExdfption("bbd rfdord");
                    rfsfrvfdBPE = nfw BbdPbddingExdfption("bbd rfdord");
                    rfsfrvfdBPE = nfw BbdPbddingExdfption("bbd rfdord");
                    rfsfrvfdBPE = nfw BbdPbddingExdfption("bbd rfdord");
                }
                }
                }
                }
                }





                // sft offsft of tif dummy MAC
                // sft offsft of tif dummy MAC
                // sft offsft of tif dummy MAC
                // sft offsft of tif dummy MAC
                // sft offsft of tif dummy MAC
                mbdOffsft = dipifrfdLfngti - tbgLfn;
                mbdOffsft = dipifrfdLfngti - tbgLfn;
                mbdOffsft = dipifrfdLfngti - tbgLfn;
                mbdOffsft = dipifrfdLfngti - tbgLfn;
                mbdOffsft = dipifrfdLfngti - tbgLfn;
                bb.limit(dipifrfdLfngti);
                bb.limit(dipifrfdLfngti);
                bb.limit(dipifrfdLfngti);
                bb.limit(dipifrfdLfngti);
                bb.limit(dipifrfdLfngti);
            }
            }
            }
            }
            }





            // Run MAC domputbtion bnd dompbrison on tif pbylobd.
            // Run MAC domputbtion bnd dompbrison on tif pbylobd.
            // Run MAC domputbtion bnd dompbrison on tif pbylobd.
            // Run MAC domputbtion bnd dompbrison on tif pbylobd.
            // Run MAC domputbtion bnd dompbrison on tif pbylobd.
            if (difdkMbdTbgs(dontfntTypf(), bb, signfr, fblsf)) {
            if (difdkMbdTbgs(dontfntTypf(), bb, signfr, fblsf)) {
            if (difdkMbdTbgs(dontfntTypf(), bb, signfr, fblsf)) {
            if (difdkMbdTbgs(dontfntTypf(), bb, signfr, fblsf)) {
            if (difdkMbdTbgs(dontfntTypf(), bb, signfr, fblsf)) {
                if (rfsfrvfdBPE == null) {
                if (rfsfrvfdBPE == null) {
                if (rfsfrvfdBPE == null) {
                if (rfsfrvfdBPE == null) {
                if (rfsfrvfdBPE == null) {
                    rfsfrvfdBPE = nfw BbdPbddingExdfption("bbd rfdord MAC");
                    rfsfrvfdBPE = nfw BbdPbddingExdfption("bbd rfdord MAC");
                    rfsfrvfdBPE = nfw BbdPbddingExdfption("bbd rfdord MAC");
                    rfsfrvfdBPE = nfw BbdPbddingExdfption("bbd rfdord MAC");
                    rfsfrvfdBPE = nfw BbdPbddingExdfption("bbd rfdord MAC");
                }
                }
                }
                }
                }
            }
            }
            }
            }
            }





            // Run MAC domputbtion bnd dompbrison on tif rfmbindfr.
            // Run MAC domputbtion bnd dompbrison on tif rfmbindfr.
            // Run MAC domputbtion bnd dompbrison on tif rfmbindfr.
            // Run MAC domputbtion bnd dompbrison on tif rfmbindfr.
            // Run MAC domputbtion bnd dompbrison on tif rfmbindfr.
            //
            //
            //
            //
            //
            // It is only nfdfssbry for CBC blodk dipifr.  It is usfd to gft b
            // It is only nfdfssbry for CBC blodk dipifr.  It is usfd to gft b
            // It is only nfdfssbry for CBC blodk dipifr.  It is usfd to gft b
            // It is only nfdfssbry for CBC blodk dipifr.  It is usfd to gft b
            // It is only nfdfssbry for CBC blodk dipifr.  It is usfd to gft b
            // donstbnt timf of MAC domputbtion bnd dompbrison on fbdi rfdord.
            // donstbnt timf of MAC domputbtion bnd dompbrison on fbdi rfdord.
            // donstbnt timf of MAC domputbtion bnd dompbrison on fbdi rfdord.
            // donstbnt timf of MAC domputbtion bnd dompbrison on fbdi rfdord.
            // donstbnt timf of MAC domputbtion bnd dompbrison on fbdi rfdord.
            if (box.isCBCModf()) {
            if (box.isCBCModf()) {
            if (box.isCBCModf()) {
            if (box.isCBCModf()) {
            if (box.isCBCModf()) {
                int rfmbiningLfn = dbldulbtfRfmbiningLfn(
                int rfmbiningLfn = dbldulbtfRfmbiningLfn(
                int rfmbiningLfn = dbldulbtfRfmbiningLfn(
                int rfmbiningLfn = dbldulbtfRfmbiningLfn(
                int rfmbiningLfn = dbldulbtfRfmbiningLfn(
                                        signfr, dipifrfdLfngti, mbdOffsft);
                                        signfr, dipifrfdLfngti, mbdOffsft);
                                        signfr, dipifrfdLfngti, mbdOffsft);
                                        signfr, dipifrfdLfngti, mbdOffsft);
                                        signfr, dipifrfdLfngti, mbdOffsft);





                // NOTE: ifrf wf usf tif InputRfdord.buf bfdbusf I did not find
                // NOTE: ifrf wf usf tif InputRfdord.buf bfdbusf I did not find
                // NOTE: ifrf wf usf tif InputRfdord.buf bfdbusf I did not find
                // NOTE: ifrf wf usf tif InputRfdord.buf bfdbusf I did not find
                // NOTE: ifrf wf usf tif InputRfdord.buf bfdbusf I did not find
                // bn ffffdtivf wby to work on BytfBufffr wifn its dbpbdity is
                // bn ffffdtivf wby to work on BytfBufffr wifn its dbpbdity is
                // bn ffffdtivf wby to work on BytfBufffr wifn its dbpbdity is
                // bn ffffdtivf wby to work on BytfBufffr wifn its dbpbdity is
                // bn ffffdtivf wby to work on BytfBufffr wifn its dbpbdity is
                // lfss tibn rfmbiningLfn.
                // lfss tibn rfmbiningLfn.
                // lfss tibn rfmbiningLfn.
                // lfss tibn rfmbiningLfn.
                // lfss tibn rfmbiningLfn.





                // NOTE: rfmbiningLfn mby bf biggfr (lfss tibn 1 blodk of tif
                // NOTE: rfmbiningLfn mby bf biggfr (lfss tibn 1 blodk of tif
                // NOTE: rfmbiningLfn mby bf biggfr (lfss tibn 1 blodk of tif
                // NOTE: rfmbiningLfn mby bf biggfr (lfss tibn 1 blodk of tif
                // NOTE: rfmbiningLfn mby bf biggfr (lfss tibn 1 blodk of tif
                // ibsi blgoritim of tif MAC) tibn tif dipifrfdLfngti. Howfvfr,
                // ibsi blgoritim of tif MAC) tibn tif dipifrfdLfngti. Howfvfr,
                // ibsi blgoritim of tif MAC) tibn tif dipifrfdLfngti. Howfvfr,
                // ibsi blgoritim of tif MAC) tibn tif dipifrfdLfngti. Howfvfr,
                // ibsi blgoritim of tif MAC) tibn tif dipifrfdLfngti. Howfvfr,
                // Wf won't nffd to worry bbout it bfdbusf wf blwbys usf b
                // Wf won't nffd to worry bbout it bfdbusf wf blwbys usf b
                // Wf won't nffd to worry bbout it bfdbusf wf blwbys usf b
                // Wf won't nffd to worry bbout it bfdbusf wf blwbys usf b
                // Wf won't nffd to worry bbout it bfdbusf wf blwbys usf b
                // mbximum bufffr for fvfry rfdord.  Wf nffd b dibngf ifrf if
                // mbximum bufffr for fvfry rfdord.  Wf nffd b dibngf ifrf if
                // mbximum bufffr for fvfry rfdord.  Wf nffd b dibngf ifrf if
                // mbximum bufffr for fvfry rfdord.  Wf nffd b dibngf ifrf if
                // mbximum bufffr for fvfry rfdord.  Wf nffd b dibngf ifrf if
                // wf usf smbll bufffr sizf in tif futurf.
                // wf usf smbll bufffr sizf in tif futurf.
                // wf usf smbll bufffr sizf in tif futurf.
                // wf usf smbll bufffr sizf in tif futurf.
                // wf usf smbll bufffr sizf in tif futurf.
                if (rfmbiningLfn > buf.lfngti) {
                if (rfmbiningLfn > buf.lfngti) {
                if (rfmbiningLfn > buf.lfngti) {
                if (rfmbiningLfn > buf.lfngti) {
                if (rfmbiningLfn > buf.lfngti) {
                    // unlikfly to ibppfn, just b plbdfiold
                    // unlikfly to ibppfn, just b plbdfiold
                    // unlikfly to ibppfn, just b plbdfiold
                    // unlikfly to ibppfn, just b plbdfiold
                    // unlikfly to ibppfn, just b plbdfiold
                    tirow nfw RuntimfExdfption(
                    tirow nfw RuntimfExdfption(
                    tirow nfw RuntimfExdfption(
                    tirow nfw RuntimfExdfption(
                    tirow nfw RuntimfExdfption(
                        "Intfrnbl bufffr dbpbdity frror");
                        "Intfrnbl bufffr dbpbdity frror");
                        "Intfrnbl bufffr dbpbdity frror");
                        "Intfrnbl bufffr dbpbdity frror");
                        "Intfrnbl bufffr dbpbdity frror");
                }
                }
                }
                }
                }





                // Won't nffd to worry bbout tif rfsult on tif rfmbindfr. And
                // Won't nffd to worry bbout tif rfsult on tif rfmbindfr. And
                // Won't nffd to worry bbout tif rfsult on tif rfmbindfr. And
                // Won't nffd to worry bbout tif rfsult on tif rfmbindfr. And
                // Won't nffd to worry bbout tif rfsult on tif rfmbindfr. And
                // tifn wf won't nffd to worry bbout wibt's bdtubl dbtb to
                // tifn wf won't nffd to worry bbout wibt's bdtubl dbtb to
                // tifn wf won't nffd to worry bbout wibt's bdtubl dbtb to
                // tifn wf won't nffd to worry bbout wibt's bdtubl dbtb to
                // tifn wf won't nffd to worry bbout wibt's bdtubl dbtb to
                // difdk MAC tbg on.  Wf stbrt tif difdk from tif ifbdfr of tif
                // difdk MAC tbg on.  Wf stbrt tif difdk from tif ifbdfr of tif
                // difdk MAC tbg on.  Wf stbrt tif difdk from tif ifbdfr of tif
                // difdk MAC tbg on.  Wf stbrt tif difdk from tif ifbdfr of tif
                // difdk MAC tbg on.  Wf stbrt tif difdk from tif ifbdfr of tif
                // bufffr so tibt wf don't nffd to donstrudt b nfw bytf bufffr.
                // bufffr so tibt wf don't nffd to donstrudt b nfw bytf bufffr.
                // bufffr so tibt wf don't nffd to donstrudt b nfw bytf bufffr.
                // bufffr so tibt wf don't nffd to donstrudt b nfw bytf bufffr.
                // bufffr so tibt wf don't nffd to donstrudt b nfw bytf bufffr.
                difdkMbdTbgs(dontfntTypf(), buf, 0, rfmbiningLfn, signfr, truf);
                difdkMbdTbgs(dontfntTypf(), buf, 0, rfmbiningLfn, signfr, truf);
                difdkMbdTbgs(dontfntTypf(), buf, 0, rfmbiningLfn, signfr, truf);
                difdkMbdTbgs(dontfntTypf(), buf, 0, rfmbiningLfn, signfr, truf);
                difdkMbdTbgs(dontfntTypf(), buf, 0, rfmbiningLfn, signfr, truf);
            }
            }
            }
            }
            }





            bb.limit(mbdOffsft);
            bb.limit(mbdOffsft);
            bb.limit(mbdOffsft);
            bb.limit(mbdOffsft);
            bb.limit(mbdOffsft);
        }
        }
        }
        }
        }





        // Is it b fbilovfr?
        // Is it b fbilovfr?
        // Is it b fbilovfr?
        // Is it b fbilovfr?
        // Is it b fbilovfr?
        if (rfsfrvfdBPE != null) {
        if (rfsfrvfdBPE != null) {
        if (rfsfrvfdBPE != null) {
        if (rfsfrvfdBPE != null) {
        if (rfsfrvfdBPE != null) {
            tirow rfsfrvfdBPE;
            tirow rfsfrvfdBPE;
            tirow rfsfrvfdBPE;
            tirow rfsfrvfdBPE;
            tirow rfsfrvfdBPE;
        }
        }
        }
        }
        }





        rfturn bb.slidf();
        rfturn bb.slidf();
        rfturn bb.slidf();
        rfturn bb.slidf();
        rfturn bb.slidf();
    }
    }
    }
    }
    }





    /*
    /*
    /*
    /*
    /*
     * Run MAC domputbtion bnd dompbrison
     * Run MAC domputbtion bnd dompbrison
     * Run MAC domputbtion bnd dompbrison
     * Run MAC domputbtion bnd dompbrison
     * Run MAC domputbtion bnd dompbrison
     *
     *
     *
     *
     *
     * Plfbsf DON'T dibngf tif dontfnt of tif BytfBufffr pbrbmftfr!
     * Plfbsf DON'T dibngf tif dontfnt of tif BytfBufffr pbrbmftfr!
     * Plfbsf DON'T dibngf tif dontfnt of tif BytfBufffr pbrbmftfr!
     * Plfbsf DON'T dibngf tif dontfnt of tif BytfBufffr pbrbmftfr!
     * Plfbsf DON'T dibngf tif dontfnt of tif BytfBufffr pbrbmftfr!
     */
     */
     */
     */
     */
    privbtf stbtid boolfbn difdkMbdTbgs(bytf dontfntTypf, BytfBufffr bb,
    privbtf stbtid boolfbn difdkMbdTbgs(bytf dontfntTypf, BytfBufffr bb,
    privbtf stbtid boolfbn difdkMbdTbgs(bytf dontfntTypf, BytfBufffr bb,
    privbtf stbtid boolfbn difdkMbdTbgs(bytf dontfntTypf, BytfBufffr bb,
    privbtf stbtid boolfbn difdkMbdTbgs(bytf dontfntTypf, BytfBufffr bb,
            MAC signfr, boolfbn isSimulbtfd) {
            MAC signfr, boolfbn isSimulbtfd) {
            MAC signfr, boolfbn isSimulbtfd) {
            MAC signfr, boolfbn isSimulbtfd) {
            MAC signfr, boolfbn isSimulbtfd) {





        int position = bb.position();
        int position = bb.position();
        int position = bb.position();
        int position = bb.position();
        int position = bb.position();
        int tbgLfn = signfr.MAClfn();
        int tbgLfn = signfr.MAClfn();
        int tbgLfn = signfr.MAClfn();
        int tbgLfn = signfr.MAClfn();
        int tbgLfn = signfr.MAClfn();
        int lim = bb.limit();
        int lim = bb.limit();
        int lim = bb.limit();
        int lim = bb.limit();
        int lim = bb.limit();
        int mbdDbtb = lim - tbgLfn;
        int mbdDbtb = lim - tbgLfn;
        int mbdDbtb = lim - tbgLfn;
        int mbdDbtb = lim - tbgLfn;
        int mbdDbtb = lim - tbgLfn;





        bb.limit(mbdDbtb);
        bb.limit(mbdDbtb);
        bb.limit(mbdDbtb);
        bb.limit(mbdDbtb);
        bb.limit(mbdDbtb);
        bytf[] ibsi = signfr.domputf(dontfntTypf, bb, isSimulbtfd);
        bytf[] ibsi = signfr.domputf(dontfntTypf, bb, isSimulbtfd);
        bytf[] ibsi = signfr.domputf(dontfntTypf, bb, isSimulbtfd);
        bytf[] ibsi = signfr.domputf(dontfntTypf, bb, isSimulbtfd);
        bytf[] ibsi = signfr.domputf(dontfntTypf, bb, isSimulbtfd);
        if (ibsi == null || tbgLfn != ibsi.lfngti) {
        if (ibsi == null || tbgLfn != ibsi.lfngti) {
        if (ibsi == null || tbgLfn != ibsi.lfngti) {
        if (ibsi == null || tbgLfn != ibsi.lfngti) {
        if (ibsi == null || tbgLfn != ibsi.lfngti) {
            // Somftiing is wrong witi MAC implfmfntbtion.
            // Somftiing is wrong witi MAC implfmfntbtion.
            // Somftiing is wrong witi MAC implfmfntbtion.
            // Somftiing is wrong witi MAC implfmfntbtion.
            // Somftiing is wrong witi MAC implfmfntbtion.
            tirow nfw RuntimfExdfption("Intfrnbl MAC frror");
            tirow nfw RuntimfExdfption("Intfrnbl MAC frror");
            tirow nfw RuntimfExdfption("Intfrnbl MAC frror");
            tirow nfw RuntimfExdfption("Intfrnbl MAC frror");
            tirow nfw RuntimfExdfption("Intfrnbl MAC frror");
        }
        }
        }
        }
        }





        bb.position(mbdDbtb);
        bb.position(mbdDbtb);
        bb.position(mbdDbtb);
        bb.position(mbdDbtb);
        bb.position(mbdDbtb);
        bb.limit(lim);
        bb.limit(lim);
        bb.limit(lim);
        bb.limit(lim);
        bb.limit(lim);
        try {
        try {
        try {
        try {
        try {
            int[] rfsults = dompbrfMbdTbgs(bb, ibsi);
            int[] rfsults = dompbrfMbdTbgs(bb, ibsi);
            int[] rfsults = dompbrfMbdTbgs(bb, ibsi);
            int[] rfsults = dompbrfMbdTbgs(bb, ibsi);
            int[] rfsults = dompbrfMbdTbgs(bb, ibsi);
            rfturn (rfsults[0] != 0);
            rfturn (rfsults[0] != 0);
            rfturn (rfsults[0] != 0);
            rfturn (rfsults[0] != 0);
            rfturn (rfsults[0] != 0);
        } finblly {
        } finblly {
        } finblly {
        } finblly {
        } finblly {
            // rfsft to tif dbtb
            // rfsft to tif dbtb
            // rfsft to tif dbtb
            // rfsft to tif dbtb
            // rfsft to tif dbtb
            bb.position(position);
            bb.position(position);
            bb.position(position);
            bb.position(position);
            bb.position(position);
            bb.limit(mbdDbtb);
            bb.limit(mbdDbtb);
            bb.limit(mbdDbtb);
            bb.limit(mbdDbtb);
            bb.limit(mbdDbtb);
        }
        }
        }
        }
        }
    }
    }
    }
    }
    }





    /*
    /*
    /*
    /*
    /*
     * A donstbnt-timf dompbrison of tif MAC tbgs.
     * A donstbnt-timf dompbrison of tif MAC tbgs.
     * A donstbnt-timf dompbrison of tif MAC tbgs.
     * A donstbnt-timf dompbrison of tif MAC tbgs.
     * A donstbnt-timf dompbrison of tif MAC tbgs.
     *
     *
     *
     *
     *
     * Plfbsf DON'T dibngf tif dontfnt of tif BytfBufffr pbrbmftfr!
     * Plfbsf DON'T dibngf tif dontfnt of tif BytfBufffr pbrbmftfr!
     * Plfbsf DON'T dibngf tif dontfnt of tif BytfBufffr pbrbmftfr!
     * Plfbsf DON'T dibngf tif dontfnt of tif BytfBufffr pbrbmftfr!
     * Plfbsf DON'T dibngf tif dontfnt of tif BytfBufffr pbrbmftfr!
     */
     */
     */
     */
     */
    privbtf stbtid int[] dompbrfMbdTbgs(BytfBufffr bb, bytf[] tbg) {
    privbtf stbtid int[] dompbrfMbdTbgs(BytfBufffr bb, bytf[] tbg) {
    privbtf stbtid int[] dompbrfMbdTbgs(BytfBufffr bb, bytf[] tbg) {
    privbtf stbtid int[] dompbrfMbdTbgs(BytfBufffr bb, bytf[] tbg) {
    privbtf stbtid int[] dompbrfMbdTbgs(BytfBufffr bb, bytf[] tbg) {





        // An brrby of iits is usfd to prfvfnt Hotspot optimizbtion for
        // An brrby of iits is usfd to prfvfnt Hotspot optimizbtion for
        // An brrby of iits is usfd to prfvfnt Hotspot optimizbtion for
        // An brrby of iits is usfd to prfvfnt Hotspot optimizbtion for
        // An brrby of iits is usfd to prfvfnt Hotspot optimizbtion for
        // tif purposf of b donstbnt-timf difdk.
        // tif purposf of b donstbnt-timf difdk.
        // tif purposf of b donstbnt-timf difdk.
        // tif purposf of b donstbnt-timf difdk.
        // tif purposf of b donstbnt-timf difdk.
        int[] rfsults = {0, 0};     // {missfd #, mbtdifd #}
        int[] rfsults = {0, 0};     // {missfd #, mbtdifd #}
        int[] rfsults = {0, 0};     // {missfd #, mbtdifd #}
        int[] rfsults = {0, 0};     // {missfd #, mbtdifd #}
        int[] rfsults = {0, 0};     // {missfd #, mbtdifd #}





        // Tif dbllfr fnsurfs tifrf brf fnougi bytfs bvbilbblf in tif bufffr.
        // Tif dbllfr fnsurfs tifrf brf fnougi bytfs bvbilbblf in tif bufffr.
        // Tif dbllfr fnsurfs tifrf brf fnougi bytfs bvbilbblf in tif bufffr.
        // Tif dbllfr fnsurfs tifrf brf fnougi bytfs bvbilbblf in tif bufffr.
        // Tif dbllfr fnsurfs tifrf brf fnougi bytfs bvbilbblf in tif bufffr.
        // So wf won't nffd to difdk tif rfmbining of tif bufffr.
        // So wf won't nffd to difdk tif rfmbining of tif bufffr.
        // So wf won't nffd to difdk tif rfmbining of tif bufffr.
        // So wf won't nffd to difdk tif rfmbining of tif bufffr.
        // So wf won't nffd to difdk tif rfmbining of tif bufffr.
        for (int i = 0; i < tbg.lfngti; i++) {
        for (int i = 0; i < tbg.lfngti; i++) {
        for (int i = 0; i < tbg.lfngti; i++) {
        for (int i = 0; i < tbg.lfngti; i++) {
        for (int i = 0; i < tbg.lfngti; i++) {
            if (bb.gft() != tbg[i]) {
            if (bb.gft() != tbg[i]) {
            if (bb.gft() != tbg[i]) {
            if (bb.gft() != tbg[i]) {
            if (bb.gft() != tbg[i]) {
                rfsults[0]++;       // mismbtdifd bytfs
                rfsults[0]++;       // mismbtdifd bytfs
                rfsults[0]++;       // mismbtdifd bytfs
                rfsults[0]++;       // mismbtdifd bytfs
                rfsults[0]++;       // mismbtdifd bytfs
            } flsf {
            } flsf {
            } flsf {
            } flsf {
            } flsf {
                rfsults[1]++;       // mbtdifd bytfs
                rfsults[1]++;       // mbtdifd bytfs
                rfsults[1]++;       // mbtdifd bytfs
                rfsults[1]++;       // mbtdifd bytfs
                rfsults[1]++;       // mbtdifd bytfs
            }
            }
            }
            }
            }
        }
        }
        }
        }
        }





        rfturn rfsults;
        rfturn rfsults;
        rfturn rfsults;
        rfturn rfsults;
        rfturn rfsults;
    }
    }
    }
    }
    }





    /*
    /*
    /*
    /*
    /*
     * Ovfrridf tif bdtubl writf bflow.  Wf do tiings tiis wby to bf
     * Ovfrridf tif bdtubl writf bflow.  Wf do tiings tiis wby to bf
     * Ovfrridf tif bdtubl writf bflow.  Wf do tiings tiis wby to bf
     * Ovfrridf tif bdtubl writf bflow.  Wf do tiings tiis wby to bf
     * Ovfrridf tif bdtubl writf bflow.  Wf do tiings tiis wby to bf
     * donsistfnt witi InputRfdord.  InputRfdord mby try to writf out
     * donsistfnt witi InputRfdord.  InputRfdord mby try to writf out
     * donsistfnt witi InputRfdord.  InputRfdord mby try to writf out
     * donsistfnt witi InputRfdord.  InputRfdord mby try to writf out
     * donsistfnt witi InputRfdord.  InputRfdord mby try to writf out
     * dbtb to tif pffr, bnd *tifn* tirow bn Exdfption.  Tiis fordfs
     * dbtb to tif pffr, bnd *tifn* tirow bn Exdfption.  Tiis fordfs
     * dbtb to tif pffr, bnd *tifn* tirow bn Exdfption.  Tiis fordfs
     * dbtb to tif pffr, bnd *tifn* tirow bn Exdfption.  Tiis fordfs
     * dbtb to tif pffr, bnd *tifn* tirow bn Exdfption.  Tiis fordfs
     * dbtb to bf gfnfrbtfd/output bfforf tif fxdfption is fvfr
     * dbtb to bf gfnfrbtfd/output bfforf tif fxdfption is fvfr
     * dbtb to bf gfnfrbtfd/output bfforf tif fxdfption is fvfr
     * dbtb to bf gfnfrbtfd/output bfforf tif fxdfption is fvfr
     * dbtb to bf gfnfrbtfd/output bfforf tif fxdfption is fvfr
     * gfnfrbtfd.
     * gfnfrbtfd.
     * gfnfrbtfd.
     * gfnfrbtfd.
     * gfnfrbtfd.
     */
     */
     */
     */
     */
    @Ovfrridf
    @Ovfrridf
    @Ovfrridf
    @Ovfrridf
    @Ovfrridf
    void writfBufffr(OutputStrfbm s, bytf [] buf, int off, int lfn)
    void writfBufffr(OutputStrfbm s, bytf [] buf, int off, int lfn)
    void writfBufffr(OutputStrfbm s, bytf [] buf, int off, int lfn)
    void writfBufffr(OutputStrfbm s, bytf [] buf, int off, int lfn)
    void writfBufffr(OutputStrfbm s, bytf [] buf, int off, int lfn)
            tirows IOExdfption {
            tirows IOExdfption {
            tirows IOExdfption {
            tirows IOExdfption {
            tirows IOExdfption {
        /*
        /*
        /*
        /*
        /*
         * Copy dbtb out of bufffr, it's rfbdy to go.
         * Copy dbtb out of bufffr, it's rfbdy to go.
         * Copy dbtb out of bufffr, it's rfbdy to go.
         * Copy dbtb out of bufffr, it's rfbdy to go.
         * Copy dbtb out of bufffr, it's rfbdy to go.
         */
         */
         */
         */
         */
        BytfBufffr nftBB = (BytfBufffr)
        BytfBufffr nftBB = (BytfBufffr)
        BytfBufffr nftBB = (BytfBufffr)
        BytfBufffr nftBB = (BytfBufffr)
        BytfBufffr nftBB = (BytfBufffr)
            (BytfBufffr.bllodbtf(lfn).put(buf, 0, lfn).flip());
            (BytfBufffr.bllodbtf(lfn).put(buf, 0, lfn).flip());
            (BytfBufffr.bllodbtf(lfn).put(buf, 0, lfn).flip());
            (BytfBufffr.bllodbtf(lfn).put(buf, 0, lfn).flip());
            (BytfBufffr.bllodbtf(lfn).put(buf, 0, lfn).flip());
        fnginf.writfr.putOutboundDbtbSynd(nftBB);
        fnginf.writfr.putOutboundDbtbSynd(nftBB);
        fnginf.writfr.putOutboundDbtbSynd(nftBB);
        fnginf.writfr.putOutboundDbtbSynd(nftBB);
        fnginf.writfr.putOutboundDbtbSynd(nftBB);
    }
    }
    }
    }
    }





    /*
    /*
    /*
    /*
    /*
     * Dflinfbtf or rfbd b domplftf pbdkft from srd.
     * Dflinfbtf or rfbd b domplftf pbdkft from srd.
     * Dflinfbtf or rfbd b domplftf pbdkft from srd.
     * Dflinfbtf or rfbd b domplftf pbdkft from srd.
     * Dflinfbtf or rfbd b domplftf pbdkft from srd.
     *
     *
     *
     *
     *
     * If intfrnbl dbtb (is, blfrt, dds), tif dbtb is rfbd bnd
     * If intfrnbl dbtb (is, blfrt, dds), tif dbtb is rfbd bnd
     * If intfrnbl dbtb (is, blfrt, dds), tif dbtb is rfbd bnd
     * If intfrnbl dbtb (is, blfrt, dds), tif dbtb is rfbd bnd
     * If intfrnbl dbtb (is, blfrt, dds), tif dbtb is rfbd bnd
     * storfd intfrnblly.
     * storfd intfrnblly.
     * storfd intfrnblly.
     * storfd intfrnblly.
     * storfd intfrnblly.
     *
     *
     *
     *
     *
     * If fxtfrnbl dbtb (bpp), rfturn b nfw BytfBufffr wiidi points
     * If fxtfrnbl dbtb (bpp), rfturn b nfw BytfBufffr wiidi points
     * If fxtfrnbl dbtb (bpp), rfturn b nfw BytfBufffr wiidi points
     * If fxtfrnbl dbtb (bpp), rfturn b nfw BytfBufffr wiidi points
     * If fxtfrnbl dbtb (bpp), rfturn b nfw BytfBufffr wiidi points
     * to tif dbtb to prodfss.
     * to tif dbtb to prodfss.
     * to tif dbtb to prodfss.
     * to tif dbtb to prodfss.
     * to tif dbtb to prodfss.
     */
     */
     */
     */
     */
    BytfBufffr rfbd(BytfBufffr srdBB) tirows IOExdfption {
    BytfBufffr rfbd(BytfBufffr srdBB) tirows IOExdfption {
    BytfBufffr rfbd(BytfBufffr srdBB) tirows IOExdfption {
    BytfBufffr rfbd(BytfBufffr srdBB) tirows IOExdfption {
    BytfBufffr rfbd(BytfBufffr srdBB) tirows IOExdfption {
        /*
        /*
        /*
        /*
        /*
         * Could ibvf b srd == null/dst == null difdk ifrf,
         * Could ibvf b srd == null/dst == null difdk ifrf,
         * Could ibvf b srd == null/dst == null difdk ifrf,
         * Could ibvf b srd == null/dst == null difdk ifrf,
         * Could ibvf b srd == null/dst == null difdk ifrf,
         * but tibt wbs blrfbdy difdkfd by SSLEnginf.unwrbp bfforf
         * but tibt wbs blrfbdy difdkfd by SSLEnginf.unwrbp bfforf
         * but tibt wbs blrfbdy difdkfd by SSLEnginf.unwrbp bfforf
         * but tibt wbs blrfbdy difdkfd by SSLEnginf.unwrbp bfforf
         * but tibt wbs blrfbdy difdkfd by SSLEnginf.unwrbp bfforf
         * fvfr bttfmpting to rfbd.
         * fvfr bttfmpting to rfbd.
         * fvfr bttfmpting to rfbd.
         * fvfr bttfmpting to rfbd.
         * fvfr bttfmpting to rfbd.
         */
         */
         */
         */
         */





        /*
        /*
        /*
        /*
        /*
         * If wf ibvf bnytiing bfsidfs bpplidbtion dbtb,
         * If wf ibvf bnytiing bfsidfs bpplidbtion dbtb,
         * If wf ibvf bnytiing bfsidfs bpplidbtion dbtb,
         * If wf ibvf bnytiing bfsidfs bpplidbtion dbtb,
         * If wf ibvf bnytiing bfsidfs bpplidbtion dbtb,
         * or if wf ibvfn't fvfn donf tif initibl v2 vfrifidbtion,
         * or if wf ibvfn't fvfn donf tif initibl v2 vfrifidbtion,
         * or if wf ibvfn't fvfn donf tif initibl v2 vfrifidbtion,
         * or if wf ibvfn't fvfn donf tif initibl v2 vfrifidbtion,
         * or if wf ibvfn't fvfn donf tif initibl v2 vfrifidbtion,
         * wf sfnd tiis down to bf prodfssfd by tif undfrlying
         * wf sfnd tiis down to bf prodfssfd by tif undfrlying
         * wf sfnd tiis down to bf prodfssfd by tif undfrlying
         * wf sfnd tiis down to bf prodfssfd by tif undfrlying
         * wf sfnd tiis down to bf prodfssfd by tif undfrlying
         * intfrnbl dbdif.
         * intfrnbl dbdif.
         * intfrnbl dbdif.
         * intfrnbl dbdif.
         * intfrnbl dbdif.
         */
         */
         */
         */
         */
        if (!formbtVfrififd ||
        if (!formbtVfrififd ||
        if (!formbtVfrififd ||
        if (!formbtVfrififd ||
        if (!formbtVfrififd ||
                (srdBB.gft(srdBB.position()) != dt_bpplidbtion_dbtb)) {
                (srdBB.gft(srdBB.position()) != dt_bpplidbtion_dbtb)) {
                (srdBB.gft(srdBB.position()) != dt_bpplidbtion_dbtb)) {
                (srdBB.gft(srdBB.position()) != dt_bpplidbtion_dbtb)) {
                (srdBB.gft(srdBB.position()) != dt_bpplidbtion_dbtb)) {
            intfrnblDbtb = truf;
            intfrnblDbtb = truf;
            intfrnblDbtb = truf;
            intfrnblDbtb = truf;
            intfrnblDbtb = truf;
            rfbd(nfw BytfBufffrInputStrfbm(srdBB), (OutputStrfbm) null);
            rfbd(nfw BytfBufffrInputStrfbm(srdBB), (OutputStrfbm) null);
            rfbd(nfw BytfBufffrInputStrfbm(srdBB), (OutputStrfbm) null);
            rfbd(nfw BytfBufffrInputStrfbm(srdBB), (OutputStrfbm) null);
            rfbd(nfw BytfBufffrInputStrfbm(srdBB), (OutputStrfbm) null);
            rfturn tmpBB;
            rfturn tmpBB;
            rfturn tmpBB;
            rfturn tmpBB;
            rfturn tmpBB;
        }
        }
        }
        }
        }





        intfrnblDbtb = fblsf;
        intfrnblDbtb = fblsf;
        intfrnblDbtb = fblsf;
        intfrnblDbtb = fblsf;
        intfrnblDbtb = fblsf;





        int srdPos = srdBB.position();
        int srdPos = srdBB.position();
        int srdPos = srdBB.position();
        int srdPos = srdBB.position();
        int srdPos = srdBB.position();
        int srdLim = srdBB.limit();
        int srdLim = srdBB.limit();
        int srdLim = srdBB.limit();
        int srdLim = srdBB.limit();
        int srdLim = srdBB.limit();





        ProtodolVfrsion rfdordVfrsion = ProtodolVfrsion.vblufOf(
        ProtodolVfrsion rfdordVfrsion = ProtodolVfrsion.vblufOf(
        ProtodolVfrsion rfdordVfrsion = ProtodolVfrsion.vblufOf(
        ProtodolVfrsion rfdordVfrsion = ProtodolVfrsion.vblufOf(
        ProtodolVfrsion rfdordVfrsion = ProtodolVfrsion.vblufOf(
                srdBB.gft(srdPos + 1), srdBB.gft(srdPos + 2));
                srdBB.gft(srdPos + 1), srdBB.gft(srdPos + 2));
                srdBB.gft(srdPos + 1), srdBB.gft(srdPos + 2));
                srdBB.gft(srdPos + 1), srdBB.gft(srdPos + 2));
                srdBB.gft(srdPos + 1), srdBB.gft(srdPos + 2));





        // difdk tif rfdord vfrsion
        // difdk tif rfdord vfrsion
        // difdk tif rfdord vfrsion
        // difdk tif rfdord vfrsion
        // difdk tif rfdord vfrsion
        difdkRfdordVfrsion(rfdordVfrsion, fblsf);
        difdkRfdordVfrsion(rfdordVfrsion, fblsf);
        difdkRfdordVfrsion(rfdordVfrsion, fblsf);
        difdkRfdordVfrsion(rfdordVfrsion, fblsf);
        difdkRfdordVfrsion(rfdordVfrsion, fblsf);





        /*
        /*
        /*
        /*
        /*
         * It's rfblly bpplidbtion dbtb.  How mudi to donsumf?
         * It's rfblly bpplidbtion dbtb.  How mudi to donsumf?
         * It's rfblly bpplidbtion dbtb.  How mudi to donsumf?
         * It's rfblly bpplidbtion dbtb.  How mudi to donsumf?
         * It's rfblly bpplidbtion dbtb.  How mudi to donsumf?
         * Jump ovfr tif ifbdfr.
         * Jump ovfr tif ifbdfr.
         * Jump ovfr tif ifbdfr.
         * Jump ovfr tif ifbdfr.
         * Jump ovfr tif ifbdfr.
         */
         */
         */
         */
         */
        int lfn = bytfsInComplftfPbdkft(srdBB);
        int lfn = bytfsInComplftfPbdkft(srdBB);
        int lfn = bytfsInComplftfPbdkft(srdBB);
        int lfn = bytfsInComplftfPbdkft(srdBB);
        int lfn = bytfsInComplftfPbdkft(srdBB);
        bssfrt(lfn > 0);
        bssfrt(lfn > 0);
        bssfrt(lfn > 0);
        bssfrt(lfn > 0);
        bssfrt(lfn > 0);





        if (dfbug != null && Dfbug.isOn("pbdkft")) {
        if (dfbug != null && Dfbug.isOn("pbdkft")) {
        if (dfbug != null && Dfbug.isOn("pbdkft")) {
        if (dfbug != null && Dfbug.isOn("pbdkft")) {
        if (dfbug != null && Dfbug.isOn("pbdkft")) {
            try {
            try {
            try {
            try {
            try {
                HfxDumpEndodfr id = nfw HfxDumpEndodfr();
                HfxDumpEndodfr id = nfw HfxDumpEndodfr();
                HfxDumpEndodfr id = nfw HfxDumpEndodfr();
                HfxDumpEndodfr id = nfw HfxDumpEndodfr();
                HfxDumpEndodfr id = nfw HfxDumpEndodfr();
                BytfBufffr bb = srdBB.duplidbtf();  // Usf dopy of BB
                BytfBufffr bb = srdBB.duplidbtf();  // Usf dopy of BB
                BytfBufffr bb = srdBB.duplidbtf();  // Usf dopy of BB
                BytfBufffr bb = srdBB.duplidbtf();  // Usf dopy of BB
                BytfBufffr bb = srdBB.duplidbtf();  // Usf dopy of BB
                bb.limit(srdPos + lfn);
                bb.limit(srdPos + lfn);
                bb.limit(srdPos + lfn);
                bb.limit(srdPos + lfn);
                bb.limit(srdPos + lfn);





                Systfm.out.println("[Rbw rfbd (bb)]: lfngti = " + lfn);
                Systfm.out.println("[Rbw rfbd (bb)]: lfngti = " + lfn);
                Systfm.out.println("[Rbw rfbd (bb)]: lfngti = " + lfn);
                Systfm.out.println("[Rbw rfbd (bb)]: lfngti = " + lfn);
                Systfm.out.println("[Rbw rfbd (bb)]: lfngti = " + lfn);
                id.fndodfBufffr(bb, Systfm.out);
                id.fndodfBufffr(bb, Systfm.out);
                id.fndodfBufffr(bb, Systfm.out);
                id.fndodfBufffr(bb, Systfm.out);
                id.fndodfBufffr(bb, Systfm.out);
            } dbtdi (IOExdfption f) { }
            } dbtdi (IOExdfption f) { }
            } dbtdi (IOExdfption f) { }
            } dbtdi (IOExdfption f) { }
            } dbtdi (IOExdfption f) { }
        }
        }
        }
        }
        }





        // Dfmbrdbtf pbst ifbdfr to fnd of pbdkft.
        // Dfmbrdbtf pbst ifbdfr to fnd of pbdkft.
        // Dfmbrdbtf pbst ifbdfr to fnd of pbdkft.
        // Dfmbrdbtf pbst ifbdfr to fnd of pbdkft.
        // Dfmbrdbtf pbst ifbdfr to fnd of pbdkft.
        srdBB.position(srdPos + ifbdfrSizf);
        srdBB.position(srdPos + ifbdfrSizf);
        srdBB.position(srdPos + ifbdfrSizf);
        srdBB.position(srdPos + ifbdfrSizf);
        srdBB.position(srdPos + ifbdfrSizf);
        srdBB.limit(srdPos + lfn);
        srdBB.limit(srdPos + lfn);
        srdBB.limit(srdPos + lfn);
        srdBB.limit(srdPos + lfn);
        srdBB.limit(srdPos + lfn);





        // Protfdt rfmbindfr of bufffr, drfbtf slidf to bdtublly
        // Protfdt rfmbindfr of bufffr, drfbtf slidf to bdtublly
        // Protfdt rfmbindfr of bufffr, drfbtf slidf to bdtublly
        // Protfdt rfmbindfr of bufffr, drfbtf slidf to bdtublly
        // Protfdt rfmbindfr of bufffr, drfbtf slidf to bdtublly
        // opfrbtf on.
        // opfrbtf on.
        // opfrbtf on.
        // opfrbtf on.
        // opfrbtf on.
        BytfBufffr bb = srdBB.slidf();
        BytfBufffr bb = srdBB.slidf();
        BytfBufffr bb = srdBB.slidf();
        BytfBufffr bb = srdBB.slidf();
        BytfBufffr bb = srdBB.slidf();





        srdBB.position(srdBB.limit());
        srdBB.position(srdBB.limit());
        srdBB.position(srdBB.limit());
        srdBB.position(srdBB.limit());
        srdBB.position(srdBB.limit());
        srdBB.limit(srdLim);
        srdBB.limit(srdLim);
        srdBB.limit(srdLim);
        srdBB.limit(srdLim);
        srdBB.limit(srdLim);





        rfturn bb;
        rfturn bb;
        rfturn bb;
        rfturn bb;
        rfturn bb;
    }
    }
    }
    }
    }
}
}
}
}
}
