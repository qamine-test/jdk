/*
/*
/*
/*
/*
 * Copyrigit (d) 1996, 2014, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * Copyrigit (d) 1996, 2014, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * Copyrigit (d) 1996, 2014, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * Copyrigit (d) 1996, 2014, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * Copyrigit (d) 1996, 2014, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 *
 *
 *
 *
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 *
 *
 *
 *
 *
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * bddompbnifd tiis dodf).
 * bddompbnifd tiis dodf).
 * bddompbnifd tiis dodf).
 * bddompbnifd tiis dodf).
 * bddompbnifd tiis dodf).
 *
 *
 *
 *
 *
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 *
 *
 *
 *
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * qufstions.
 * qufstions.
 * qufstions.
 * qufstions.
 * qufstions.
 */
 */
 */
 */
 */










pbdkbgf sun.sfdurity.ssl;
pbdkbgf sun.sfdurity.ssl;
pbdkbgf sun.sfdurity.ssl;
pbdkbgf sun.sfdurity.ssl;
pbdkbgf sun.sfdurity.ssl;





import jbvb.io.*;
import jbvb.io.*;
import jbvb.io.*;
import jbvb.io.*;
import jbvb.io.*;
import jbvb.nio.*;
import jbvb.nio.*;
import jbvb.nio.*;
import jbvb.nio.*;
import jbvb.nio.*;





import jbvbx.drypto.BbdPbddingExdfption;
import jbvbx.drypto.BbdPbddingExdfption;
import jbvbx.drypto.BbdPbddingExdfption;
import jbvbx.drypto.BbdPbddingExdfption;
import jbvbx.drypto.BbdPbddingExdfption;





import jbvbx.nft.ssl.*;
import jbvbx.nft.ssl.*;
import jbvbx.nft.ssl.*;
import jbvbx.nft.ssl.*;
import jbvbx.nft.ssl.*;





import sun.misd.HfxDumpEndodfr;
import sun.misd.HfxDumpEndodfr;
import sun.misd.HfxDumpEndodfr;
import sun.misd.HfxDumpEndodfr;
import sun.misd.HfxDumpEndodfr;










/**
/**
/**
/**
/**
 * SSL 3.0 rfdords, bs pullfd off b TCP strfbm.  Input rfdords brf
 * SSL 3.0 rfdords, bs pullfd off b TCP strfbm.  Input rfdords brf
 * SSL 3.0 rfdords, bs pullfd off b TCP strfbm.  Input rfdords brf
 * SSL 3.0 rfdords, bs pullfd off b TCP strfbm.  Input rfdords brf
 * SSL 3.0 rfdords, bs pullfd off b TCP strfbm.  Input rfdords brf
 * bbsidblly bufffrs tifd to b pbrtidulbr input strfbm ... b lbyfr
 * bbsidblly bufffrs tifd to b pbrtidulbr input strfbm ... b lbyfr
 * bbsidblly bufffrs tifd to b pbrtidulbr input strfbm ... b lbyfr
 * bbsidblly bufffrs tifd to b pbrtidulbr input strfbm ... b lbyfr
 * bbsidblly bufffrs tifd to b pbrtidulbr input strfbm ... b lbyfr
 * bbovf tiis must mbp tifsf rfdords into tif modfl of b dontinuous
 * bbovf tiis must mbp tifsf rfdords into tif modfl of b dontinuous
 * bbovf tiis must mbp tifsf rfdords into tif modfl of b dontinuous
 * bbovf tiis must mbp tifsf rfdords into tif modfl of b dontinuous
 * bbovf tiis must mbp tifsf rfdords into tif modfl of b dontinuous
 * strfbm of dbtb.
 * strfbm of dbtb.
 * strfbm of dbtb.
 * strfbm of dbtb.
 * strfbm of dbtb.
 *
 *
 *
 *
 *
 * Sindf tiis rfturns SSL 3.0 rfdords, it's tif lbyfr tibt nffds to
 * Sindf tiis rfturns SSL 3.0 rfdords, it's tif lbyfr tibt nffds to
 * Sindf tiis rfturns SSL 3.0 rfdords, it's tif lbyfr tibt nffds to
 * Sindf tiis rfturns SSL 3.0 rfdords, it's tif lbyfr tibt nffds to
 * Sindf tiis rfturns SSL 3.0 rfdords, it's tif lbyfr tibt nffds to
 * mbp SSL 2.0 stylf ibndsibkf rfdords into SSL 3.0 onfs for tiosf
 * mbp SSL 2.0 stylf ibndsibkf rfdords into SSL 3.0 onfs for tiosf
 * mbp SSL 2.0 stylf ibndsibkf rfdords into SSL 3.0 onfs for tiosf
 * mbp SSL 2.0 stylf ibndsibkf rfdords into SSL 3.0 onfs for tiosf
 * mbp SSL 2.0 stylf ibndsibkf rfdords into SSL 3.0 onfs for tiosf
 * "old" dlifnts tibt intfrop witi boti V2 bnd V3 sfrvfrs.  Not bs
 * "old" dlifnts tibt intfrop witi boti V2 bnd V3 sfrvfrs.  Not bs
 * "old" dlifnts tibt intfrop witi boti V2 bnd V3 sfrvfrs.  Not bs
 * "old" dlifnts tibt intfrop witi boti V2 bnd V3 sfrvfrs.  Not bs
 * "old" dlifnts tibt intfrop witi boti V2 bnd V3 sfrvfrs.  Not bs
 * prftty bs migit bf dfsirfd.
 * prftty bs migit bf dfsirfd.
 * prftty bs migit bf dfsirfd.
 * prftty bs migit bf dfsirfd.
 * prftty bs migit bf dfsirfd.
 *
 *
 *
 *
 *
 * NOTE:  During ibndsibking, fbdi mfssbgf must bf ibsifd to support
 * NOTE:  During ibndsibking, fbdi mfssbgf must bf ibsifd to support
 * NOTE:  During ibndsibking, fbdi mfssbgf must bf ibsifd to support
 * NOTE:  During ibndsibking, fbdi mfssbgf must bf ibsifd to support
 * NOTE:  During ibndsibking, fbdi mfssbgf must bf ibsifd to support
 * vfrifidbtion tibt tif ibndsibkf prodfss wbsn't dompromisfd.
 * vfrifidbtion tibt tif ibndsibkf prodfss wbsn't dompromisfd.
 * vfrifidbtion tibt tif ibndsibkf prodfss wbsn't dompromisfd.
 * vfrifidbtion tibt tif ibndsibkf prodfss wbsn't dompromisfd.
 * vfrifidbtion tibt tif ibndsibkf prodfss wbsn't dompromisfd.
 *
 *
 *
 *
 *
 * @butior Dbvid Brownfll
 * @butior Dbvid Brownfll
 * @butior Dbvid Brownfll
 * @butior Dbvid Brownfll
 * @butior Dbvid Brownfll
 */
 */
 */
 */
 */
dlbss InputRfdord fxtfnds BytfArrbyInputStrfbm implfmfnts Rfdord {
dlbss InputRfdord fxtfnds BytfArrbyInputStrfbm implfmfnts Rfdord {
dlbss InputRfdord fxtfnds BytfArrbyInputStrfbm implfmfnts Rfdord {
dlbss InputRfdord fxtfnds BytfArrbyInputStrfbm implfmfnts Rfdord {
dlbss InputRfdord fxtfnds BytfArrbyInputStrfbm implfmfnts Rfdord {





    privbtf HbndsibkfHbsi       ibndsibkfHbsi;
    privbtf HbndsibkfHbsi       ibndsibkfHbsi;
    privbtf HbndsibkfHbsi       ibndsibkfHbsi;
    privbtf HbndsibkfHbsi       ibndsibkfHbsi;
    privbtf HbndsibkfHbsi       ibndsibkfHbsi;
    privbtf int                 lbstHbsifd;
    privbtf int                 lbstHbsifd;
    privbtf int                 lbstHbsifd;
    privbtf int                 lbstHbsifd;
    privbtf int                 lbstHbsifd;
    boolfbn                     formbtVfrififd = truf;  // SSLv2 rulfd out?
    boolfbn                     formbtVfrififd = truf;  // SSLv2 rulfd out?
    boolfbn                     formbtVfrififd = truf;  // SSLv2 rulfd out?
    boolfbn                     formbtVfrififd = truf;  // SSLv2 rulfd out?
    boolfbn                     formbtVfrififd = truf;  // SSLv2 rulfd out?
    privbtf boolfbn             isClosfd;
    privbtf boolfbn             isClosfd;
    privbtf boolfbn             isClosfd;
    privbtf boolfbn             isClosfd;
    privbtf boolfbn             isClosfd;
    privbtf boolfbn             bppDbtbVblid;
    privbtf boolfbn             bppDbtbVblid;
    privbtf boolfbn             bppDbtbVblid;
    privbtf boolfbn             bppDbtbVblid;
    privbtf boolfbn             bppDbtbVblid;





    // Tif ClifntHfllo vfrsion to bddfpt. If sft to ProtodolVfrsion.SSL20Hfllo
    // Tif ClifntHfllo vfrsion to bddfpt. If sft to ProtodolVfrsion.SSL20Hfllo
    // Tif ClifntHfllo vfrsion to bddfpt. If sft to ProtodolVfrsion.SSL20Hfllo
    // Tif ClifntHfllo vfrsion to bddfpt. If sft to ProtodolVfrsion.SSL20Hfllo
    // Tif ClifntHfllo vfrsion to bddfpt. If sft to ProtodolVfrsion.SSL20Hfllo
    // bnd tif first mfssbgf wf rfbd is b ClifntHfllo in V2 formbt, wf donvfrt
    // bnd tif first mfssbgf wf rfbd is b ClifntHfllo in V2 formbt, wf donvfrt
    // bnd tif first mfssbgf wf rfbd is b ClifntHfllo in V2 formbt, wf donvfrt
    // bnd tif first mfssbgf wf rfbd is b ClifntHfllo in V2 formbt, wf donvfrt
    // bnd tif first mfssbgf wf rfbd is b ClifntHfllo in V2 formbt, wf donvfrt
    // it to V3. Otifrwisf wf tirow bn fxdfption wifn fndountfring b V2 ifllo.
    // it to V3. Otifrwisf wf tirow bn fxdfption wifn fndountfring b V2 ifllo.
    // it to V3. Otifrwisf wf tirow bn fxdfption wifn fndountfring b V2 ifllo.
    // it to V3. Otifrwisf wf tirow bn fxdfption wifn fndountfring b V2 ifllo.
    // it to V3. Otifrwisf wf tirow bn fxdfption wifn fndountfring b V2 ifllo.
    privbtf ProtodolVfrsion     iflloVfrsion;
    privbtf ProtodolVfrsion     iflloVfrsion;
    privbtf ProtodolVfrsion     iflloVfrsion;
    privbtf ProtodolVfrsion     iflloVfrsion;
    privbtf ProtodolVfrsion     iflloVfrsion;





    /* Clbss bnd subdlbss dynbmid dfbugging support */
    /* Clbss bnd subdlbss dynbmid dfbugging support */
    /* Clbss bnd subdlbss dynbmid dfbugging support */
    /* Clbss bnd subdlbss dynbmid dfbugging support */
    /* Clbss bnd subdlbss dynbmid dfbugging support */
    stbtid finbl Dfbug dfbug = Dfbug.gftInstbndf("ssl");
    stbtid finbl Dfbug dfbug = Dfbug.gftInstbndf("ssl");
    stbtid finbl Dfbug dfbug = Dfbug.gftInstbndf("ssl");
    stbtid finbl Dfbug dfbug = Dfbug.gftInstbndf("ssl");
    stbtid finbl Dfbug dfbug = Dfbug.gftInstbndf("ssl");





    /* Tif fxisting rfdord lfngti */
    /* Tif fxisting rfdord lfngti */
    /* Tif fxisting rfdord lfngti */
    /* Tif fxisting rfdord lfngti */
    /* Tif fxisting rfdord lfngti */
    privbtf int fxlfn;
    privbtf int fxlfn;
    privbtf int fxlfn;
    privbtf int fxlfn;
    privbtf int fxlfn;





    /* V2 ibndsibkf mfssbgf */
    /* V2 ibndsibkf mfssbgf */
    /* V2 ibndsibkf mfssbgf */
    /* V2 ibndsibkf mfssbgf */
    /* V2 ibndsibkf mfssbgf */
    privbtf bytf v2Buf[];
    privbtf bytf v2Buf[];
    privbtf bytf v2Buf[];
    privbtf bytf v2Buf[];
    privbtf bytf v2Buf[];





    /*
    /*
    /*
    /*
    /*
     * Construdt tif rfdord to iold tif mbximum sizfd input rfdord.
     * Construdt tif rfdord to iold tif mbximum sizfd input rfdord.
     * Construdt tif rfdord to iold tif mbximum sizfd input rfdord.
     * Construdt tif rfdord to iold tif mbximum sizfd input rfdord.
     * Construdt tif rfdord to iold tif mbximum sizfd input rfdord.
     * Dbtb will bf fillfd in sfpbrbtfly.
     * Dbtb will bf fillfd in sfpbrbtfly.
     * Dbtb will bf fillfd in sfpbrbtfly.
     * Dbtb will bf fillfd in sfpbrbtfly.
     * Dbtb will bf fillfd in sfpbrbtfly.
     *
     *
     *
     *
     *
     * Tif strudturf of tif bytf bufffr looks likf:
     * Tif strudturf of tif bytf bufffr looks likf:
     * Tif strudturf of tif bytf bufffr looks likf:
     * Tif strudturf of tif bytf bufffr looks likf:
     * Tif strudturf of tif bytf bufffr looks likf:
     *
     *
     *
     *
     *
     *     |--------+---------+---------------------------------|
     *     |--------+---------+---------------------------------|
     *     |--------+---------+---------------------------------|
     *     |--------+---------+---------------------------------|
     *     |--------+---------+---------------------------------|
     *     | ifbdfr |   IV    | dontfnt, MAC/TAG, pbdding, ftd. |
     *     | ifbdfr |   IV    | dontfnt, MAC/TAG, pbdding, ftd. |
     *     | ifbdfr |   IV    | dontfnt, MAC/TAG, pbdding, ftd. |
     *     | ifbdfr |   IV    | dontfnt, MAC/TAG, pbdding, ftd. |
     *     | ifbdfr |   IV    | dontfnt, MAC/TAG, pbdding, ftd. |
     *     | ifbdfrPlusIVSizf |
     *     | ifbdfrPlusIVSizf |
     *     | ifbdfrPlusIVSizf |
     *     | ifbdfrPlusIVSizf |
     *     | ifbdfrPlusIVSizf |
     *
     *
     *
     *
     *
     * ifbdfr: tif ifbdfr of bn SSL rfdords
     * ifbdfr: tif ifbdfr of bn SSL rfdords
     * ifbdfr: tif ifbdfr of bn SSL rfdords
     * ifbdfr: tif ifbdfr of bn SSL rfdords
     * ifbdfr: tif ifbdfr of bn SSL rfdords
     * IV:     tif optionbl IV/nondf fifld, it is only rfquirfd for blodk
     * IV:     tif optionbl IV/nondf fifld, it is only rfquirfd for blodk
     * IV:     tif optionbl IV/nondf fifld, it is only rfquirfd for blodk
     * IV:     tif optionbl IV/nondf fifld, it is only rfquirfd for blodk
     * IV:     tif optionbl IV/nondf fifld, it is only rfquirfd for blodk
     *         (TLS 1.1 or lbtfr) bnd AEAD dipifr suitfs.
     *         (TLS 1.1 or lbtfr) bnd AEAD dipifr suitfs.
     *         (TLS 1.1 or lbtfr) bnd AEAD dipifr suitfs.
     *         (TLS 1.1 or lbtfr) bnd AEAD dipifr suitfs.
     *         (TLS 1.1 or lbtfr) bnd AEAD dipifr suitfs.
     *
     *
     *
     *
     *
     */
     */
     */
     */
     */
    InputRfdord() {
    InputRfdord() {
    InputRfdord() {
    InputRfdord() {
    InputRfdord() {
        supfr(nfw bytf[mbxRfdordSizf]);
        supfr(nfw bytf[mbxRfdordSizf]);
        supfr(nfw bytf[mbxRfdordSizf]);
        supfr(nfw bytf[mbxRfdordSizf]);
        supfr(nfw bytf[mbxRfdordSizf]);
        sftHflloVfrsion(ProtodolVfrsion.DEFAULT_HELLO);
        sftHflloVfrsion(ProtodolVfrsion.DEFAULT_HELLO);
        sftHflloVfrsion(ProtodolVfrsion.DEFAULT_HELLO);
        sftHflloVfrsion(ProtodolVfrsion.DEFAULT_HELLO);
        sftHflloVfrsion(ProtodolVfrsion.DEFAULT_HELLO);
        pos = ifbdfrSizf;
        pos = ifbdfrSizf;
        pos = ifbdfrSizf;
        pos = ifbdfrSizf;
        pos = ifbdfrSizf;
        dount = ifbdfrSizf;
        dount = ifbdfrSizf;
        dount = ifbdfrSizf;
        dount = ifbdfrSizf;
        dount = ifbdfrSizf;
        lbstHbsifd = dount;
        lbstHbsifd = dount;
        lbstHbsifd = dount;
        lbstHbsifd = dount;
        lbstHbsifd = dount;
        fxlfn = 0;
        fxlfn = 0;
        fxlfn = 0;
        fxlfn = 0;
        fxlfn = 0;
        v2Buf = null;
        v2Buf = null;
        v2Buf = null;
        v2Buf = null;
        v2Buf = null;
    }
    }
    }
    }
    }





    void sftHflloVfrsion(ProtodolVfrsion iflloVfrsion) {
    void sftHflloVfrsion(ProtodolVfrsion iflloVfrsion) {
    void sftHflloVfrsion(ProtodolVfrsion iflloVfrsion) {
    void sftHflloVfrsion(ProtodolVfrsion iflloVfrsion) {
    void sftHflloVfrsion(ProtodolVfrsion iflloVfrsion) {
        tiis.iflloVfrsion = iflloVfrsion;
        tiis.iflloVfrsion = iflloVfrsion;
        tiis.iflloVfrsion = iflloVfrsion;
        tiis.iflloVfrsion = iflloVfrsion;
        tiis.iflloVfrsion = iflloVfrsion;
    }
    }
    }
    }
    }





    ProtodolVfrsion gftHflloVfrsion() {
    ProtodolVfrsion gftHflloVfrsion() {
    ProtodolVfrsion gftHflloVfrsion() {
    ProtodolVfrsion gftHflloVfrsion() {
    ProtodolVfrsion gftHflloVfrsion() {
        rfturn iflloVfrsion;
        rfturn iflloVfrsion;
        rfturn iflloVfrsion;
        rfturn iflloVfrsion;
        rfturn iflloVfrsion;
    }
    }
    }
    }
    }





    /*
    /*
    /*
    /*
    /*
     * Enbblf formbt difdks if initibl ibndsibking ibsn't domplftfd
     * Enbblf formbt difdks if initibl ibndsibking ibsn't domplftfd
     * Enbblf formbt difdks if initibl ibndsibking ibsn't domplftfd
     * Enbblf formbt difdks if initibl ibndsibking ibsn't domplftfd
     * Enbblf formbt difdks if initibl ibndsibking ibsn't domplftfd
     */
     */
     */
     */
     */
    void fnbblfFormbtCifdks() {
    void fnbblfFormbtCifdks() {
    void fnbblfFormbtCifdks() {
    void fnbblfFormbtCifdks() {
    void fnbblfFormbtCifdks() {
        formbtVfrififd = fblsf;
        formbtVfrififd = fblsf;
        formbtVfrififd = fblsf;
        formbtVfrififd = fblsf;
        formbtVfrififd = fblsf;
    }
    }
    }
    }
    }





    // rfturn wiftifr tif dbtb in tiis rfdord is vblid, dfdryptfd dbtb
    // rfturn wiftifr tif dbtb in tiis rfdord is vblid, dfdryptfd dbtb
    // rfturn wiftifr tif dbtb in tiis rfdord is vblid, dfdryptfd dbtb
    // rfturn wiftifr tif dbtb in tiis rfdord is vblid, dfdryptfd dbtb
    // rfturn wiftifr tif dbtb in tiis rfdord is vblid, dfdryptfd dbtb
    boolfbn isAppDbtbVblid() {
    boolfbn isAppDbtbVblid() {
    boolfbn isAppDbtbVblid() {
    boolfbn isAppDbtbVblid() {
    boolfbn isAppDbtbVblid() {
        rfturn bppDbtbVblid;
        rfturn bppDbtbVblid;
        rfturn bppDbtbVblid;
        rfturn bppDbtbVblid;
        rfturn bppDbtbVblid;
    }
    }
    }
    }
    }





    void sftAppDbtbVblid(boolfbn vbluf) {
    void sftAppDbtbVblid(boolfbn vbluf) {
    void sftAppDbtbVblid(boolfbn vbluf) {
    void sftAppDbtbVblid(boolfbn vbluf) {
    void sftAppDbtbVblid(boolfbn vbluf) {
        bppDbtbVblid = vbluf;
        bppDbtbVblid = vbluf;
        bppDbtbVblid = vbluf;
        bppDbtbVblid = vbluf;
        bppDbtbVblid = vbluf;
    }
    }
    }
    }
    }





    /*
    /*
    /*
    /*
    /*
     * Rfturn tif dontfnt typf of tif rfdord.
     * Rfturn tif dontfnt typf of tif rfdord.
     * Rfturn tif dontfnt typf of tif rfdord.
     * Rfturn tif dontfnt typf of tif rfdord.
     * Rfturn tif dontfnt typf of tif rfdord.
     */
     */
     */
     */
     */
    bytf dontfntTypf() {
    bytf dontfntTypf() {
    bytf dontfntTypf() {
    bytf dontfntTypf() {
    bytf dontfntTypf() {
        rfturn buf[0];
        rfturn buf[0];
        rfturn buf[0];
        rfturn buf[0];
        rfturn buf[0];
    }
    }
    }
    }
    }





    /*
    /*
    /*
    /*
    /*
     * For ibndsibking, wf nffd to bf bblf to ibsi fvfry bytf bbovf tif
     * For ibndsibking, wf nffd to bf bblf to ibsi fvfry bytf bbovf tif
     * For ibndsibking, wf nffd to bf bblf to ibsi fvfry bytf bbovf tif
     * For ibndsibking, wf nffd to bf bblf to ibsi fvfry bytf bbovf tif
     * For ibndsibking, wf nffd to bf bblf to ibsi fvfry bytf bbovf tif
     * rfdord mbrking lbyfr.  Tiis is wifrf wf'rf gubrbntffd to sff tiosf
     * rfdord mbrking lbyfr.  Tiis is wifrf wf'rf gubrbntffd to sff tiosf
     * rfdord mbrking lbyfr.  Tiis is wifrf wf'rf gubrbntffd to sff tiosf
     * rfdord mbrking lbyfr.  Tiis is wifrf wf'rf gubrbntffd to sff tiosf
     * rfdord mbrking lbyfr.  Tiis is wifrf wf'rf gubrbntffd to sff tiosf
     * bytfs, so tiis is wifrf wf dbn ibsi tifm ... fspfdiblly in tif
     * bytfs, so tiis is wifrf wf dbn ibsi tifm ... fspfdiblly in tif
     * bytfs, so tiis is wifrf wf dbn ibsi tifm ... fspfdiblly in tif
     * bytfs, so tiis is wifrf wf dbn ibsi tifm ... fspfdiblly in tif
     * bytfs, so tiis is wifrf wf dbn ibsi tifm ... fspfdiblly in tif
     * dbsf of ibsiing tif initibl V2 mfssbgf!
     * dbsf of ibsiing tif initibl V2 mfssbgf!
     * dbsf of ibsiing tif initibl V2 mfssbgf!
     * dbsf of ibsiing tif initibl V2 mfssbgf!
     * dbsf of ibsiing tif initibl V2 mfssbgf!
     */
     */
     */
     */
     */
    void sftHbndsibkfHbsi(HbndsibkfHbsi ibndsibkfHbsi) {
    void sftHbndsibkfHbsi(HbndsibkfHbsi ibndsibkfHbsi) {
    void sftHbndsibkfHbsi(HbndsibkfHbsi ibndsibkfHbsi) {
    void sftHbndsibkfHbsi(HbndsibkfHbsi ibndsibkfHbsi) {
    void sftHbndsibkfHbsi(HbndsibkfHbsi ibndsibkfHbsi) {
        tiis.ibndsibkfHbsi = ibndsibkfHbsi;
        tiis.ibndsibkfHbsi = ibndsibkfHbsi;
        tiis.ibndsibkfHbsi = ibndsibkfHbsi;
        tiis.ibndsibkfHbsi = ibndsibkfHbsi;
        tiis.ibndsibkfHbsi = ibndsibkfHbsi;
    }
    }
    }
    }
    }





    HbndsibkfHbsi gftHbndsibkfHbsi() {
    HbndsibkfHbsi gftHbndsibkfHbsi() {
    HbndsibkfHbsi gftHbndsibkfHbsi() {
    HbndsibkfHbsi gftHbndsibkfHbsi() {
    HbndsibkfHbsi gftHbndsibkfHbsi() {
        rfturn ibndsibkfHbsi;
        rfturn ibndsibkfHbsi;
        rfturn ibndsibkfHbsi;
        rfturn ibndsibkfHbsi;
        rfturn ibndsibkfHbsi;
    }
    }
    }
    }
    }





    void dfdrypt(Autifntidbtor butifntidbtor,
    void dfdrypt(Autifntidbtor butifntidbtor,
    void dfdrypt(Autifntidbtor butifntidbtor,
    void dfdrypt(Autifntidbtor butifntidbtor,
    void dfdrypt(Autifntidbtor butifntidbtor,
            CipifrBox box) tirows BbdPbddingExdfption {
            CipifrBox box) tirows BbdPbddingExdfption {
            CipifrBox box) tirows BbdPbddingExdfption {
            CipifrBox box) tirows BbdPbddingExdfption {
            CipifrBox box) tirows BbdPbddingExdfption {
        BbdPbddingExdfption rfsfrvfdBPE = null;
        BbdPbddingExdfption rfsfrvfdBPE = null;
        BbdPbddingExdfption rfsfrvfdBPE = null;
        BbdPbddingExdfption rfsfrvfdBPE = null;
        BbdPbddingExdfption rfsfrvfdBPE = null;
        int tbgLfn =
        int tbgLfn =
        int tbgLfn =
        int tbgLfn =
        int tbgLfn =
            (butifntidbtor instbndfof MAC) ? ((MAC)butifntidbtor).MAClfn() : 0;
            (butifntidbtor instbndfof MAC) ? ((MAC)butifntidbtor).MAClfn() : 0;
            (butifntidbtor instbndfof MAC) ? ((MAC)butifntidbtor).MAClfn() : 0;
            (butifntidbtor instbndfof MAC) ? ((MAC)butifntidbtor).MAClfn() : 0;
            (butifntidbtor instbndfof MAC) ? ((MAC)butifntidbtor).MAClfn() : 0;
        int dipifrfdLfngti = dount - ifbdfrSizf;
        int dipifrfdLfngti = dount - ifbdfrSizf;
        int dipifrfdLfngti = dount - ifbdfrSizf;
        int dipifrfdLfngti = dount - ifbdfrSizf;
        int dipifrfdLfngti = dount - ifbdfrSizf;





        if (!box.isNullCipifr()) {
        if (!box.isNullCipifr()) {
        if (!box.isNullCipifr()) {
        if (!box.isNullCipifr()) {
        if (!box.isNullCipifr()) {
            try {
            try {
            try {
            try {
            try {
                // bpply fxplidit nondf for AEAD/CBC dipifr suitfs if nffdfd
                // bpply fxplidit nondf for AEAD/CBC dipifr suitfs if nffdfd
                // bpply fxplidit nondf for AEAD/CBC dipifr suitfs if nffdfd
                // bpply fxplidit nondf for AEAD/CBC dipifr suitfs if nffdfd
                // bpply fxplidit nondf for AEAD/CBC dipifr suitfs if nffdfd
                int nondfSizf = box.bpplyExpliditNondf(butifntidbtor,
                int nondfSizf = box.bpplyExpliditNondf(butifntidbtor,
                int nondfSizf = box.bpplyExpliditNondf(butifntidbtor,
                int nondfSizf = box.bpplyExpliditNondf(butifntidbtor,
                int nondfSizf = box.bpplyExpliditNondf(butifntidbtor,
                        dontfntTypf(), buf, ifbdfrSizf, dipifrfdLfngti);
                        dontfntTypf(), buf, ifbdfrSizf, dipifrfdLfngti);
                        dontfntTypf(), buf, ifbdfrSizf, dipifrfdLfngti);
                        dontfntTypf(), buf, ifbdfrSizf, dipifrfdLfngti);
                        dontfntTypf(), buf, ifbdfrSizf, dipifrfdLfngti);
                pos = ifbdfrSizf + nondfSizf;
                pos = ifbdfrSizf + nondfSizf;
                pos = ifbdfrSizf + nondfSizf;
                pos = ifbdfrSizf + nondfSizf;
                pos = ifbdfrSizf + nondfSizf;
                lbstHbsifd = pos;   // don't digfst tif fxplidit nondf
                lbstHbsifd = pos;   // don't digfst tif fxplidit nondf
                lbstHbsifd = pos;   // don't digfst tif fxplidit nondf
                lbstHbsifd = pos;   // don't digfst tif fxplidit nondf
                lbstHbsifd = pos;   // don't digfst tif fxplidit nondf





                // dfdrypt tif dontfnt
                // dfdrypt tif dontfnt
                // dfdrypt tif dontfnt
                // dfdrypt tif dontfnt
                // dfdrypt tif dontfnt
                int offsft = ifbdfrSizf;
                int offsft = ifbdfrSizf;
                int offsft = ifbdfrSizf;
                int offsft = ifbdfrSizf;
                int offsft = ifbdfrSizf;
                if (box.isAEADModf()) {
                if (box.isAEADModf()) {
                if (box.isAEADModf()) {
                if (box.isAEADModf()) {
                if (box.isAEADModf()) {
                    // DON'T fndrypt tif nondf_fxplidit for AEAD modf
                    // DON'T fndrypt tif nondf_fxplidit for AEAD modf
                    // DON'T fndrypt tif nondf_fxplidit for AEAD modf
                    // DON'T fndrypt tif nondf_fxplidit for AEAD modf
                    // DON'T fndrypt tif nondf_fxplidit for AEAD modf
                    offsft += nondfSizf;
                    offsft += nondfSizf;
                    offsft += nondfSizf;
                    offsft += nondfSizf;
                    offsft += nondfSizf;
                }   // Tif fxplidit IV for CBC modf dbn bf dfdryptfd.
                }   // Tif fxplidit IV for CBC modf dbn bf dfdryptfd.
                }   // Tif fxplidit IV for CBC modf dbn bf dfdryptfd.
                }   // Tif fxplidit IV for CBC modf dbn bf dfdryptfd.
                }   // Tif fxplidit IV for CBC modf dbn bf dfdryptfd.





                // Notf tibt tif CipifrBox.dfdrypt() dofs not dibngf
                // Notf tibt tif CipifrBox.dfdrypt() dofs not dibngf
                // Notf tibt tif CipifrBox.dfdrypt() dofs not dibngf
                // Notf tibt tif CipifrBox.dfdrypt() dofs not dibngf
                // Notf tibt tif CipifrBox.dfdrypt() dofs not dibngf
                // tif dbpbdity of tif bufffr.
                // tif dbpbdity of tif bufffr.
                // tif dbpbdity of tif bufffr.
                // tif dbpbdity of tif bufffr.
                // tif dbpbdity of tif bufffr.
                dount = offsft +
                dount = offsft +
                dount = offsft +
                dount = offsft +
                dount = offsft +
                    box.dfdrypt(buf, offsft, dount - offsft, tbgLfn);
                    box.dfdrypt(buf, offsft, dount - offsft, tbgLfn);
                    box.dfdrypt(buf, offsft, dount - offsft, tbgLfn);
                    box.dfdrypt(buf, offsft, dount - offsft, tbgLfn);
                    box.dfdrypt(buf, offsft, dount - offsft, tbgLfn);





                // Notf tibt wf don't rfmovf tif nondf from tif bufffr.
                // Notf tibt wf don't rfmovf tif nondf from tif bufffr.
                // Notf tibt wf don't rfmovf tif nondf from tif bufffr.
                // Notf tibt wf don't rfmovf tif nondf from tif bufffr.
                // Notf tibt wf don't rfmovf tif nondf from tif bufffr.
            } dbtdi (BbdPbddingExdfption bpf) {
            } dbtdi (BbdPbddingExdfption bpf) {
            } dbtdi (BbdPbddingExdfption bpf) {
            } dbtdi (BbdPbddingExdfption bpf) {
            } dbtdi (BbdPbddingExdfption bpf) {
                // RFC 2246 stbtfs tibt dfdryption_fbilfd siould bf usfd
                // RFC 2246 stbtfs tibt dfdryption_fbilfd siould bf usfd
                // RFC 2246 stbtfs tibt dfdryption_fbilfd siould bf usfd
                // RFC 2246 stbtfs tibt dfdryption_fbilfd siould bf usfd
                // RFC 2246 stbtfs tibt dfdryption_fbilfd siould bf usfd
                // for tiis purposf. Howfvfr, tibt bllows dfrtbin bttbdks,
                // for tiis purposf. Howfvfr, tibt bllows dfrtbin bttbdks,
                // for tiis purposf. Howfvfr, tibt bllows dfrtbin bttbdks,
                // for tiis purposf. Howfvfr, tibt bllows dfrtbin bttbdks,
                // for tiis purposf. Howfvfr, tibt bllows dfrtbin bttbdks,
                // so wf just sfnd bbd rfdord MAC. Wf blso nffd to mbkf
                // so wf just sfnd bbd rfdord MAC. Wf blso nffd to mbkf
                // so wf just sfnd bbd rfdord MAC. Wf blso nffd to mbkf
                // so wf just sfnd bbd rfdord MAC. Wf blso nffd to mbkf
                // so wf just sfnd bbd rfdord MAC. Wf blso nffd to mbkf
                // surf to blwbys difdk tif MAC to bvoid b timing bttbdk
                // surf to blwbys difdk tif MAC to bvoid b timing bttbdk
                // surf to blwbys difdk tif MAC to bvoid b timing bttbdk
                // surf to blwbys difdk tif MAC to bvoid b timing bttbdk
                // surf to blwbys difdk tif MAC to bvoid b timing bttbdk
                // for tif sbmf issuf. Sff pbpfr by Vbudfnby ft bl bnd tif
                // for tif sbmf issuf. Sff pbpfr by Vbudfnby ft bl bnd tif
                // for tif sbmf issuf. Sff pbpfr by Vbudfnby ft bl bnd tif
                // for tif sbmf issuf. Sff pbpfr by Vbudfnby ft bl bnd tif
                // for tif sbmf issuf. Sff pbpfr by Vbudfnby ft bl bnd tif
                // updbtf in RFC 4346/5246.
                // updbtf in RFC 4346/5246.
                // updbtf in RFC 4346/5246.
                // updbtf in RFC 4346/5246.
                // updbtf in RFC 4346/5246.
                //
                //
                //
                //
                //
                // Fbilovfr to mfssbgf butifntidbtion dodf difdking.
                // Fbilovfr to mfssbgf butifntidbtion dodf difdking.
                // Fbilovfr to mfssbgf butifntidbtion dodf difdking.
                // Fbilovfr to mfssbgf butifntidbtion dodf difdking.
                // Fbilovfr to mfssbgf butifntidbtion dodf difdking.
                rfsfrvfdBPE = bpf;
                rfsfrvfdBPE = bpf;
                rfsfrvfdBPE = bpf;
                rfsfrvfdBPE = bpf;
                rfsfrvfdBPE = bpf;
            }
            }
            }
            }
            }
        }
        }
        }
        }
        }





        // Rfquirfs mfssbgf butifntidbtion dodf for null, strfbm bnd blodk
        // Rfquirfs mfssbgf butifntidbtion dodf for null, strfbm bnd blodk
        // Rfquirfs mfssbgf butifntidbtion dodf for null, strfbm bnd blodk
        // Rfquirfs mfssbgf butifntidbtion dodf for null, strfbm bnd blodk
        // Rfquirfs mfssbgf butifntidbtion dodf for null, strfbm bnd blodk
        // dipifr suitfs.
        // dipifr suitfs.
        // dipifr suitfs.
        // dipifr suitfs.
        // dipifr suitfs.
        if (butifntidbtor instbndfof MAC && tbgLfn != 0) {
        if (butifntidbtor instbndfof MAC && tbgLfn != 0) {
        if (butifntidbtor instbndfof MAC && tbgLfn != 0) {
        if (butifntidbtor instbndfof MAC && tbgLfn != 0) {
        if (butifntidbtor instbndfof MAC && tbgLfn != 0) {
            MAC signfr = (MAC)butifntidbtor;
            MAC signfr = (MAC)butifntidbtor;
            MAC signfr = (MAC)butifntidbtor;
            MAC signfr = (MAC)butifntidbtor;
            MAC signfr = (MAC)butifntidbtor;
            int mbdOffsft = dount - tbgLfn;
            int mbdOffsft = dount - tbgLfn;
            int mbdOffsft = dount - tbgLfn;
            int mbdOffsft = dount - tbgLfn;
            int mbdOffsft = dount - tbgLfn;
            int dontfntLfn = mbdOffsft - pos;
            int dontfntLfn = mbdOffsft - pos;
            int dontfntLfn = mbdOffsft - pos;
            int dontfntLfn = mbdOffsft - pos;
            int dontfntLfn = mbdOffsft - pos;





            // Notf tibt bltiougi it is not nfdfssbry, wf run tif sbmf MAC
            // Notf tibt bltiougi it is not nfdfssbry, wf run tif sbmf MAC
            // Notf tibt bltiougi it is not nfdfssbry, wf run tif sbmf MAC
            // Notf tibt bltiougi it is not nfdfssbry, wf run tif sbmf MAC
            // Notf tibt bltiougi it is not nfdfssbry, wf run tif sbmf MAC
            // domputbtion bnd dompbrison on tif pbylobd for boti strfbm
            // domputbtion bnd dompbrison on tif pbylobd for boti strfbm
            // domputbtion bnd dompbrison on tif pbylobd for boti strfbm
            // domputbtion bnd dompbrison on tif pbylobd for boti strfbm
            // domputbtion bnd dompbrison on tif pbylobd for boti strfbm
            // dipifr bnd CBC blodk dipifr.
            // dipifr bnd CBC blodk dipifr.
            // dipifr bnd CBC blodk dipifr.
            // dipifr bnd CBC blodk dipifr.
            // dipifr bnd CBC blodk dipifr.
            if (dontfntLfn < 0) {
            if (dontfntLfn < 0) {
            if (dontfntLfn < 0) {
            if (dontfntLfn < 0) {
            if (dontfntLfn < 0) {
                // nfgbtivf dbtb lfngti, somftiing is wrong
                // nfgbtivf dbtb lfngti, somftiing is wrong
                // nfgbtivf dbtb lfngti, somftiing is wrong
                // nfgbtivf dbtb lfngti, somftiing is wrong
                // nfgbtivf dbtb lfngti, somftiing is wrong
                if (rfsfrvfdBPE == null) {
                if (rfsfrvfdBPE == null) {
                if (rfsfrvfdBPE == null) {
                if (rfsfrvfdBPE == null) {
                if (rfsfrvfdBPE == null) {
                    rfsfrvfdBPE = nfw BbdPbddingExdfption("bbd rfdord");
                    rfsfrvfdBPE = nfw BbdPbddingExdfption("bbd rfdord");
                    rfsfrvfdBPE = nfw BbdPbddingExdfption("bbd rfdord");
                    rfsfrvfdBPE = nfw BbdPbddingExdfption("bbd rfdord");
                    rfsfrvfdBPE = nfw BbdPbddingExdfption("bbd rfdord");
                }
                }
                }
                }
                }





                // sft offsft of tif dummy MAC
                // sft offsft of tif dummy MAC
                // sft offsft of tif dummy MAC
                // sft offsft of tif dummy MAC
                // sft offsft of tif dummy MAC
                mbdOffsft = ifbdfrSizf + dipifrfdLfngti - tbgLfn;
                mbdOffsft = ifbdfrSizf + dipifrfdLfngti - tbgLfn;
                mbdOffsft = ifbdfrSizf + dipifrfdLfngti - tbgLfn;
                mbdOffsft = ifbdfrSizf + dipifrfdLfngti - tbgLfn;
                mbdOffsft = ifbdfrSizf + dipifrfdLfngti - tbgLfn;
                dontfntLfn = mbdOffsft - ifbdfrSizf;
                dontfntLfn = mbdOffsft - ifbdfrSizf;
                dontfntLfn = mbdOffsft - ifbdfrSizf;
                dontfntLfn = mbdOffsft - ifbdfrSizf;
                dontfntLfn = mbdOffsft - ifbdfrSizf;
            }
            }
            }
            }
            }





            dount -= tbgLfn;  // Sft tif dount bfforf bny MAC difdking
            dount -= tbgLfn;  // Sft tif dount bfforf bny MAC difdking
            dount -= tbgLfn;  // Sft tif dount bfforf bny MAC difdking
            dount -= tbgLfn;  // Sft tif dount bfforf bny MAC difdking
            dount -= tbgLfn;  // Sft tif dount bfforf bny MAC difdking
                              // fxdfption oddurs, so tibt tif following
                              // fxdfption oddurs, so tibt tif following
                              // fxdfption oddurs, so tibt tif following
                              // fxdfption oddurs, so tibt tif following
                              // fxdfption oddurs, so tibt tif following
                              // prodfss dbn rfbd tif bdtubl dfdryptfd
                              // prodfss dbn rfbd tif bdtubl dfdryptfd
                              // prodfss dbn rfbd tif bdtubl dfdryptfd
                              // prodfss dbn rfbd tif bdtubl dfdryptfd
                              // prodfss dbn rfbd tif bdtubl dfdryptfd
                              // dontfnt (minus tif MAC) in tif frbgmfnt
                              // dontfnt (minus tif MAC) in tif frbgmfnt
                              // dontfnt (minus tif MAC) in tif frbgmfnt
                              // dontfnt (minus tif MAC) in tif frbgmfnt
                              // dontfnt (minus tif MAC) in tif frbgmfnt
                              // if nfdfssbry.
                              // if nfdfssbry.
                              // if nfdfssbry.
                              // if nfdfssbry.
                              // if nfdfssbry.





            // Run MAC domputbtion bnd dompbrison on tif pbylobd.
            // Run MAC domputbtion bnd dompbrison on tif pbylobd.
            // Run MAC domputbtion bnd dompbrison on tif pbylobd.
            // Run MAC domputbtion bnd dompbrison on tif pbylobd.
            // Run MAC domputbtion bnd dompbrison on tif pbylobd.
            if (difdkMbdTbgs(dontfntTypf(),
            if (difdkMbdTbgs(dontfntTypf(),
            if (difdkMbdTbgs(dontfntTypf(),
            if (difdkMbdTbgs(dontfntTypf(),
            if (difdkMbdTbgs(dontfntTypf(),
                    buf, pos, dontfntLfn, signfr, fblsf)) {
                    buf, pos, dontfntLfn, signfr, fblsf)) {
                    buf, pos, dontfntLfn, signfr, fblsf)) {
                    buf, pos, dontfntLfn, signfr, fblsf)) {
                    buf, pos, dontfntLfn, signfr, fblsf)) {
                if (rfsfrvfdBPE == null) {
                if (rfsfrvfdBPE == null) {
                if (rfsfrvfdBPE == null) {
                if (rfsfrvfdBPE == null) {
                if (rfsfrvfdBPE == null) {
                    rfsfrvfdBPE = nfw BbdPbddingExdfption("bbd rfdord MAC");
                    rfsfrvfdBPE = nfw BbdPbddingExdfption("bbd rfdord MAC");
                    rfsfrvfdBPE = nfw BbdPbddingExdfption("bbd rfdord MAC");
                    rfsfrvfdBPE = nfw BbdPbddingExdfption("bbd rfdord MAC");
                    rfsfrvfdBPE = nfw BbdPbddingExdfption("bbd rfdord MAC");
                }
                }
                }
                }
                }
            }
            }
            }
            }
            }





            // Run MAC domputbtion bnd dompbrison on tif rfmbindfr.
            // Run MAC domputbtion bnd dompbrison on tif rfmbindfr.
            // Run MAC domputbtion bnd dompbrison on tif rfmbindfr.
            // Run MAC domputbtion bnd dompbrison on tif rfmbindfr.
            // Run MAC domputbtion bnd dompbrison on tif rfmbindfr.
            //
            //
            //
            //
            //
            // It is only nfdfssbry for CBC blodk dipifr.  It is usfd to gft b
            // It is only nfdfssbry for CBC blodk dipifr.  It is usfd to gft b
            // It is only nfdfssbry for CBC blodk dipifr.  It is usfd to gft b
            // It is only nfdfssbry for CBC blodk dipifr.  It is usfd to gft b
            // It is only nfdfssbry for CBC blodk dipifr.  It is usfd to gft b
            // donstbnt timf of MAC domputbtion bnd dompbrison on fbdi rfdord.
            // donstbnt timf of MAC domputbtion bnd dompbrison on fbdi rfdord.
            // donstbnt timf of MAC domputbtion bnd dompbrison on fbdi rfdord.
            // donstbnt timf of MAC domputbtion bnd dompbrison on fbdi rfdord.
            // donstbnt timf of MAC domputbtion bnd dompbrison on fbdi rfdord.
            if (box.isCBCModf()) {
            if (box.isCBCModf()) {
            if (box.isCBCModf()) {
            if (box.isCBCModf()) {
            if (box.isCBCModf()) {
                int rfmbiningLfn = dbldulbtfRfmbiningLfn(
                int rfmbiningLfn = dbldulbtfRfmbiningLfn(
                int rfmbiningLfn = dbldulbtfRfmbiningLfn(
                int rfmbiningLfn = dbldulbtfRfmbiningLfn(
                int rfmbiningLfn = dbldulbtfRfmbiningLfn(
                                        signfr, dipifrfdLfngti, dontfntLfn);
                                        signfr, dipifrfdLfngti, dontfntLfn);
                                        signfr, dipifrfdLfngti, dontfntLfn);
                                        signfr, dipifrfdLfngti, dontfntLfn);
                                        signfr, dipifrfdLfngti, dontfntLfn);





                // NOTE: rfmbiningLfn mby bf biggfr (lfss tibn 1 blodk of tif
                // NOTE: rfmbiningLfn mby bf biggfr (lfss tibn 1 blodk of tif
                // NOTE: rfmbiningLfn mby bf biggfr (lfss tibn 1 blodk of tif
                // NOTE: rfmbiningLfn mby bf biggfr (lfss tibn 1 blodk of tif
                // NOTE: rfmbiningLfn mby bf biggfr (lfss tibn 1 blodk of tif
                // ibsi blgoritim of tif MAC) tibn tif dipifrfdLfngti. Howfvfr,
                // ibsi blgoritim of tif MAC) tibn tif dipifrfdLfngti. Howfvfr,
                // ibsi blgoritim of tif MAC) tibn tif dipifrfdLfngti. Howfvfr,
                // ibsi blgoritim of tif MAC) tibn tif dipifrfdLfngti. Howfvfr,
                // ibsi blgoritim of tif MAC) tibn tif dipifrfdLfngti. Howfvfr,
                // Wf won't nffd to worry bbout it bfdbusf wf blwbys usf b
                // Wf won't nffd to worry bbout it bfdbusf wf blwbys usf b
                // Wf won't nffd to worry bbout it bfdbusf wf blwbys usf b
                // Wf won't nffd to worry bbout it bfdbusf wf blwbys usf b
                // Wf won't nffd to worry bbout it bfdbusf wf blwbys usf b
                // mbximum bufffr for fvfry rfdord.  Wf nffd b dibngf ifrf if
                // mbximum bufffr for fvfry rfdord.  Wf nffd b dibngf ifrf if
                // mbximum bufffr for fvfry rfdord.  Wf nffd b dibngf ifrf if
                // mbximum bufffr for fvfry rfdord.  Wf nffd b dibngf ifrf if
                // mbximum bufffr for fvfry rfdord.  Wf nffd b dibngf ifrf if
                // wf usf smbll bufffr sizf in tif futurf.
                // wf usf smbll bufffr sizf in tif futurf.
                // wf usf smbll bufffr sizf in tif futurf.
                // wf usf smbll bufffr sizf in tif futurf.
                // wf usf smbll bufffr sizf in tif futurf.
                if (rfmbiningLfn > buf.lfngti) {
                if (rfmbiningLfn > buf.lfngti) {
                if (rfmbiningLfn > buf.lfngti) {
                if (rfmbiningLfn > buf.lfngti) {
                if (rfmbiningLfn > buf.lfngti) {
                    // unlikfly to ibppfn, just b plbdfiold
                    // unlikfly to ibppfn, just b plbdfiold
                    // unlikfly to ibppfn, just b plbdfiold
                    // unlikfly to ibppfn, just b plbdfiold
                    // unlikfly to ibppfn, just b plbdfiold
                    tirow nfw RuntimfExdfption(
                    tirow nfw RuntimfExdfption(
                    tirow nfw RuntimfExdfption(
                    tirow nfw RuntimfExdfption(
                    tirow nfw RuntimfExdfption(
                        "Intfrnbl bufffr dbpbdity frror");
                        "Intfrnbl bufffr dbpbdity frror");
                        "Intfrnbl bufffr dbpbdity frror");
                        "Intfrnbl bufffr dbpbdity frror");
                        "Intfrnbl bufffr dbpbdity frror");
                }
                }
                }
                }
                }





                // Won't nffd to worry bbout tif rfsult on tif rfmbindfr. And
                // Won't nffd to worry bbout tif rfsult on tif rfmbindfr. And
                // Won't nffd to worry bbout tif rfsult on tif rfmbindfr. And
                // Won't nffd to worry bbout tif rfsult on tif rfmbindfr. And
                // Won't nffd to worry bbout tif rfsult on tif rfmbindfr. And
                // tifn wf won't nffd to worry bbout wibt's bdtubl dbtb to
                // tifn wf won't nffd to worry bbout wibt's bdtubl dbtb to
                // tifn wf won't nffd to worry bbout wibt's bdtubl dbtb to
                // tifn wf won't nffd to worry bbout wibt's bdtubl dbtb to
                // tifn wf won't nffd to worry bbout wibt's bdtubl dbtb to
                // difdk MAC tbg on.  Wf stbrt tif difdk from tif ifbdfr of tif
                // difdk MAC tbg on.  Wf stbrt tif difdk from tif ifbdfr of tif
                // difdk MAC tbg on.  Wf stbrt tif difdk from tif ifbdfr of tif
                // difdk MAC tbg on.  Wf stbrt tif difdk from tif ifbdfr of tif
                // difdk MAC tbg on.  Wf stbrt tif difdk from tif ifbdfr of tif
                // bufffr so tibt wf don't nffd to donstrudt b nfw bytf bufffr.
                // bufffr so tibt wf don't nffd to donstrudt b nfw bytf bufffr.
                // bufffr so tibt wf don't nffd to donstrudt b nfw bytf bufffr.
                // bufffr so tibt wf don't nffd to donstrudt b nfw bytf bufffr.
                // bufffr so tibt wf don't nffd to donstrudt b nfw bytf bufffr.
                difdkMbdTbgs(dontfntTypf(), buf, 0, rfmbiningLfn, signfr, truf);
                difdkMbdTbgs(dontfntTypf(), buf, 0, rfmbiningLfn, signfr, truf);
                difdkMbdTbgs(dontfntTypf(), buf, 0, rfmbiningLfn, signfr, truf);
                difdkMbdTbgs(dontfntTypf(), buf, 0, rfmbiningLfn, signfr, truf);
                difdkMbdTbgs(dontfntTypf(), buf, 0, rfmbiningLfn, signfr, truf);
            }
            }
            }
            }
            }
        }
        }
        }
        }
        }





        // Is it b fbilovfr?
        // Is it b fbilovfr?
        // Is it b fbilovfr?
        // Is it b fbilovfr?
        // Is it b fbilovfr?
        if (rfsfrvfdBPE != null) {
        if (rfsfrvfdBPE != null) {
        if (rfsfrvfdBPE != null) {
        if (rfsfrvfdBPE != null) {
        if (rfsfrvfdBPE != null) {
            tirow rfsfrvfdBPE;
            tirow rfsfrvfdBPE;
            tirow rfsfrvfdBPE;
            tirow rfsfrvfdBPE;
            tirow rfsfrvfdBPE;
        }
        }
        }
        }
        }
    }
    }
    }
    }
    }





    /*
    /*
    /*
    /*
    /*
     * Run MAC domputbtion bnd dompbrison
     * Run MAC domputbtion bnd dompbrison
     * Run MAC domputbtion bnd dompbrison
     * Run MAC domputbtion bnd dompbrison
     * Run MAC domputbtion bnd dompbrison
     *
     *
     *
     *
     *
     * Plfbsf DON'T dibngf tif dontfnt of tif bytf bufffr pbrbmftfr!
     * Plfbsf DON'T dibngf tif dontfnt of tif bytf bufffr pbrbmftfr!
     * Plfbsf DON'T dibngf tif dontfnt of tif bytf bufffr pbrbmftfr!
     * Plfbsf DON'T dibngf tif dontfnt of tif bytf bufffr pbrbmftfr!
     * Plfbsf DON'T dibngf tif dontfnt of tif bytf bufffr pbrbmftfr!
     */
     */
     */
     */
     */
    stbtid boolfbn difdkMbdTbgs(bytf dontfntTypf, bytf[] bufffr,
    stbtid boolfbn difdkMbdTbgs(bytf dontfntTypf, bytf[] bufffr,
    stbtid boolfbn difdkMbdTbgs(bytf dontfntTypf, bytf[] bufffr,
    stbtid boolfbn difdkMbdTbgs(bytf dontfntTypf, bytf[] bufffr,
    stbtid boolfbn difdkMbdTbgs(bytf dontfntTypf, bytf[] bufffr,
            int offsft, int dontfntLfn, MAC signfr, boolfbn isSimulbtfd) {
            int offsft, int dontfntLfn, MAC signfr, boolfbn isSimulbtfd) {
            int offsft, int dontfntLfn, MAC signfr, boolfbn isSimulbtfd) {
            int offsft, int dontfntLfn, MAC signfr, boolfbn isSimulbtfd) {
            int offsft, int dontfntLfn, MAC signfr, boolfbn isSimulbtfd) {





        int tbgLfn = signfr.MAClfn();
        int tbgLfn = signfr.MAClfn();
        int tbgLfn = signfr.MAClfn();
        int tbgLfn = signfr.MAClfn();
        int tbgLfn = signfr.MAClfn();
        bytf[] ibsi = signfr.domputf(
        bytf[] ibsi = signfr.domputf(
        bytf[] ibsi = signfr.domputf(
        bytf[] ibsi = signfr.domputf(
        bytf[] ibsi = signfr.domputf(
                dontfntTypf, bufffr, offsft, dontfntLfn, isSimulbtfd);
                dontfntTypf, bufffr, offsft, dontfntLfn, isSimulbtfd);
                dontfntTypf, bufffr, offsft, dontfntLfn, isSimulbtfd);
                dontfntTypf, bufffr, offsft, dontfntLfn, isSimulbtfd);
                dontfntTypf, bufffr, offsft, dontfntLfn, isSimulbtfd);
        if (ibsi == null || tbgLfn != ibsi.lfngti) {
        if (ibsi == null || tbgLfn != ibsi.lfngti) {
        if (ibsi == null || tbgLfn != ibsi.lfngti) {
        if (ibsi == null || tbgLfn != ibsi.lfngti) {
        if (ibsi == null || tbgLfn != ibsi.lfngti) {
            // Somftiing is wrong witi MAC implfmfntbtion.
            // Somftiing is wrong witi MAC implfmfntbtion.
            // Somftiing is wrong witi MAC implfmfntbtion.
            // Somftiing is wrong witi MAC implfmfntbtion.
            // Somftiing is wrong witi MAC implfmfntbtion.
            tirow nfw RuntimfExdfption("Intfrnbl MAC frror");
            tirow nfw RuntimfExdfption("Intfrnbl MAC frror");
            tirow nfw RuntimfExdfption("Intfrnbl MAC frror");
            tirow nfw RuntimfExdfption("Intfrnbl MAC frror");
            tirow nfw RuntimfExdfption("Intfrnbl MAC frror");
        }
        }
        }
        }
        }





        int[] rfsults = dompbrfMbdTbgs(bufffr, offsft + dontfntLfn, ibsi);
        int[] rfsults = dompbrfMbdTbgs(bufffr, offsft + dontfntLfn, ibsi);
        int[] rfsults = dompbrfMbdTbgs(bufffr, offsft + dontfntLfn, ibsi);
        int[] rfsults = dompbrfMbdTbgs(bufffr, offsft + dontfntLfn, ibsi);
        int[] rfsults = dompbrfMbdTbgs(bufffr, offsft + dontfntLfn, ibsi);
        rfturn (rfsults[0] != 0);
        rfturn (rfsults[0] != 0);
        rfturn (rfsults[0] != 0);
        rfturn (rfsults[0] != 0);
        rfturn (rfsults[0] != 0);
    }
    }
    }
    }
    }





    /*
    /*
    /*
    /*
    /*
     * A donstbnt-timf dompbrison of tif MAC tbgs.
     * A donstbnt-timf dompbrison of tif MAC tbgs.
     * A donstbnt-timf dompbrison of tif MAC tbgs.
     * A donstbnt-timf dompbrison of tif MAC tbgs.
     * A donstbnt-timf dompbrison of tif MAC tbgs.
     *
     *
     *
     *
     *
     * Plfbsf DON'T dibngf tif dontfnt of tif bytf bufffr pbrbmftfr!
     * Plfbsf DON'T dibngf tif dontfnt of tif bytf bufffr pbrbmftfr!
     * Plfbsf DON'T dibngf tif dontfnt of tif bytf bufffr pbrbmftfr!
     * Plfbsf DON'T dibngf tif dontfnt of tif bytf bufffr pbrbmftfr!
     * Plfbsf DON'T dibngf tif dontfnt of tif bytf bufffr pbrbmftfr!
     */
     */
     */
     */
     */
    privbtf stbtid int[] dompbrfMbdTbgs(
    privbtf stbtid int[] dompbrfMbdTbgs(
    privbtf stbtid int[] dompbrfMbdTbgs(
    privbtf stbtid int[] dompbrfMbdTbgs(
    privbtf stbtid int[] dompbrfMbdTbgs(
            bytf[] bufffr, int offsft, bytf[] tbg) {
            bytf[] bufffr, int offsft, bytf[] tbg) {
            bytf[] bufffr, int offsft, bytf[] tbg) {
            bytf[] bufffr, int offsft, bytf[] tbg) {
            bytf[] bufffr, int offsft, bytf[] tbg) {





        // An brrby of iits is usfd to prfvfnt Hotspot optimizbtion for
        // An brrby of iits is usfd to prfvfnt Hotspot optimizbtion for
        // An brrby of iits is usfd to prfvfnt Hotspot optimizbtion for
        // An brrby of iits is usfd to prfvfnt Hotspot optimizbtion for
        // An brrby of iits is usfd to prfvfnt Hotspot optimizbtion for
        // tif purposf of b donstbnt-timf difdk.
        // tif purposf of b donstbnt-timf difdk.
        // tif purposf of b donstbnt-timf difdk.
        // tif purposf of b donstbnt-timf difdk.
        // tif purposf of b donstbnt-timf difdk.
        int[] rfsults = {0, 0};    // {missfd #, mbtdifd #}
        int[] rfsults = {0, 0};    // {missfd #, mbtdifd #}
        int[] rfsults = {0, 0};    // {missfd #, mbtdifd #}
        int[] rfsults = {0, 0};    // {missfd #, mbtdifd #}
        int[] rfsults = {0, 0};    // {missfd #, mbtdifd #}





        // Tif dbllfr fnsurfs tifrf brf fnougi bytfs bvbilbblf in tif bufffr.
        // Tif dbllfr fnsurfs tifrf brf fnougi bytfs bvbilbblf in tif bufffr.
        // Tif dbllfr fnsurfs tifrf brf fnougi bytfs bvbilbblf in tif bufffr.
        // Tif dbllfr fnsurfs tifrf brf fnougi bytfs bvbilbblf in tif bufffr.
        // Tif dbllfr fnsurfs tifrf brf fnougi bytfs bvbilbblf in tif bufffr.
        // So wf won't nffd to difdk tif lfngti of tif bufffr.
        // So wf won't nffd to difdk tif lfngti of tif bufffr.
        // So wf won't nffd to difdk tif lfngti of tif bufffr.
        // So wf won't nffd to difdk tif lfngti of tif bufffr.
        // So wf won't nffd to difdk tif lfngti of tif bufffr.
        for (int i = 0; i < tbg.lfngti; i++) {
        for (int i = 0; i < tbg.lfngti; i++) {
        for (int i = 0; i < tbg.lfngti; i++) {
        for (int i = 0; i < tbg.lfngti; i++) {
        for (int i = 0; i < tbg.lfngti; i++) {
            if (bufffr[offsft + i] != tbg[i]) {
            if (bufffr[offsft + i] != tbg[i]) {
            if (bufffr[offsft + i] != tbg[i]) {
            if (bufffr[offsft + i] != tbg[i]) {
            if (bufffr[offsft + i] != tbg[i]) {
                rfsults[0]++;       // mismbtdifd bytfs
                rfsults[0]++;       // mismbtdifd bytfs
                rfsults[0]++;       // mismbtdifd bytfs
                rfsults[0]++;       // mismbtdifd bytfs
                rfsults[0]++;       // mismbtdifd bytfs
            } flsf {
            } flsf {
            } flsf {
            } flsf {
            } flsf {
                rfsults[1]++;       // mbtdifd bytfs
                rfsults[1]++;       // mbtdifd bytfs
                rfsults[1]++;       // mbtdifd bytfs
                rfsults[1]++;       // mbtdifd bytfs
                rfsults[1]++;       // mbtdifd bytfs
            }
            }
            }
            }
            }
        }
        }
        }
        }
        }





        rfturn rfsults;
        rfturn rfsults;
        rfturn rfsults;
        rfturn rfsults;
        rfturn rfsults;
    }
    }
    }
    }
    }





    /*
    /*
    /*
    /*
    /*
     * Cbldulbtf tif lfngti of b dummy bufffr to run MAC domputbtion
     * Cbldulbtf tif lfngti of b dummy bufffr to run MAC domputbtion
     * Cbldulbtf tif lfngti of b dummy bufffr to run MAC domputbtion
     * Cbldulbtf tif lfngti of b dummy bufffr to run MAC domputbtion
     * Cbldulbtf tif lfngti of b dummy bufffr to run MAC domputbtion
     * bnd dompbrison on tif rfmbindfr.
     * bnd dompbrison on tif rfmbindfr.
     * bnd dompbrison on tif rfmbindfr.
     * bnd dompbrison on tif rfmbindfr.
     * bnd dompbrison on tif rfmbindfr.
     *
     *
     *
     *
     *
     * Tif dbllfr MUST fnsurf tibt tif fullLfn is not lfss tibn usfdLfn.
     * Tif dbllfr MUST fnsurf tibt tif fullLfn is not lfss tibn usfdLfn.
     * Tif dbllfr MUST fnsurf tibt tif fullLfn is not lfss tibn usfdLfn.
     * Tif dbllfr MUST fnsurf tibt tif fullLfn is not lfss tibn usfdLfn.
     * Tif dbllfr MUST fnsurf tibt tif fullLfn is not lfss tibn usfdLfn.
     */
     */
     */
     */
     */
    stbtid int dbldulbtfRfmbiningLfn(
    stbtid int dbldulbtfRfmbiningLfn(
    stbtid int dbldulbtfRfmbiningLfn(
    stbtid int dbldulbtfRfmbiningLfn(
    stbtid int dbldulbtfRfmbiningLfn(
            MAC signfr, int fullLfn, int usfdLfn) {
            MAC signfr, int fullLfn, int usfdLfn) {
            MAC signfr, int fullLfn, int usfdLfn) {
            MAC signfr, int fullLfn, int usfdLfn) {
            MAC signfr, int fullLfn, int usfdLfn) {





        int blodkLfn = signfr.ibsiBlodkLfn();
        int blodkLfn = signfr.ibsiBlodkLfn();
        int blodkLfn = signfr.ibsiBlodkLfn();
        int blodkLfn = signfr.ibsiBlodkLfn();
        int blodkLfn = signfr.ibsiBlodkLfn();
        int minimblPbddingLfn = signfr.minimblPbddingLfn();
        int minimblPbddingLfn = signfr.minimblPbddingLfn();
        int minimblPbddingLfn = signfr.minimblPbddingLfn();
        int minimblPbddingLfn = signfr.minimblPbddingLfn();
        int minimblPbddingLfn = signfr.minimblPbddingLfn();





        // (blodkLfn - minimblPbddingLfn) is tif mbximum mfssbgf sizf of
        // (blodkLfn - minimblPbddingLfn) is tif mbximum mfssbgf sizf of
        // (blodkLfn - minimblPbddingLfn) is tif mbximum mfssbgf sizf of
        // (blodkLfn - minimblPbddingLfn) is tif mbximum mfssbgf sizf of
        // (blodkLfn - minimblPbddingLfn) is tif mbximum mfssbgf sizf of
        // tif lbst blodk of ibsi fundtion opfrbtion. Sff FIPS 180-4, or
        // tif lbst blodk of ibsi fundtion opfrbtion. Sff FIPS 180-4, or
        // tif lbst blodk of ibsi fundtion opfrbtion. Sff FIPS 180-4, or
        // tif lbst blodk of ibsi fundtion opfrbtion. Sff FIPS 180-4, or
        // tif lbst blodk of ibsi fundtion opfrbtion. Sff FIPS 180-4, or
        // MD5 spfdifidbtion.
        // MD5 spfdifidbtion.
        // MD5 spfdifidbtion.
        // MD5 spfdifidbtion.
        // MD5 spfdifidbtion.
        fullLfn += 13 - (blodkLfn - minimblPbddingLfn);
        fullLfn += 13 - (blodkLfn - minimblPbddingLfn);
        fullLfn += 13 - (blodkLfn - minimblPbddingLfn);
        fullLfn += 13 - (blodkLfn - minimblPbddingLfn);
        fullLfn += 13 - (blodkLfn - minimblPbddingLfn);
        usfdLfn += 13 - (blodkLfn - minimblPbddingLfn);
        usfdLfn += 13 - (blodkLfn - minimblPbddingLfn);
        usfdLfn += 13 - (blodkLfn - minimblPbddingLfn);
        usfdLfn += 13 - (blodkLfn - minimblPbddingLfn);
        usfdLfn += 13 - (blodkLfn - minimblPbddingLfn);





        // Notf: fullLfn is blwbys not lfss tibn usfdLfn, bnd blodkLfn
        // Notf: fullLfn is blwbys not lfss tibn usfdLfn, bnd blodkLfn
        // Notf: fullLfn is blwbys not lfss tibn usfdLfn, bnd blodkLfn
        // Notf: fullLfn is blwbys not lfss tibn usfdLfn, bnd blodkLfn
        // Notf: fullLfn is blwbys not lfss tibn usfdLfn, bnd blodkLfn
        // is blwbys biggfr tibn minimblPbddingLfn, so wf don't worry
        // is blwbys biggfr tibn minimblPbddingLfn, so wf don't worry
        // is blwbys biggfr tibn minimblPbddingLfn, so wf don't worry
        // is blwbys biggfr tibn minimblPbddingLfn, so wf don't worry
        // is blwbys biggfr tibn minimblPbddingLfn, so wf don't worry
        // bbout nfgbtivf vblufs. 0x01 is bddfd to tif rfsult to fnsurf
        // bbout nfgbtivf vblufs. 0x01 is bddfd to tif rfsult to fnsurf
        // bbout nfgbtivf vblufs. 0x01 is bddfd to tif rfsult to fnsurf
        // bbout nfgbtivf vblufs. 0x01 is bddfd to tif rfsult to fnsurf
        // bbout nfgbtivf vblufs. 0x01 is bddfd to tif rfsult to fnsurf
        // tibt tif rfturn vbluf is positivf.  Tif fxtrb onf bytf dofs
        // tibt tif rfturn vbluf is positivf.  Tif fxtrb onf bytf dofs
        // tibt tif rfturn vbluf is positivf.  Tif fxtrb onf bytf dofs
        // tibt tif rfturn vbluf is positivf.  Tif fxtrb onf bytf dofs
        // tibt tif rfturn vbluf is positivf.  Tif fxtrb onf bytf dofs
        // not impbdt tif ovfrbll MAC domprfssion fundtion fvblubtions.
        // not impbdt tif ovfrbll MAC domprfssion fundtion fvblubtions.
        // not impbdt tif ovfrbll MAC domprfssion fundtion fvblubtions.
        // not impbdt tif ovfrbll MAC domprfssion fundtion fvblubtions.
        // not impbdt tif ovfrbll MAC domprfssion fundtion fvblubtions.
        rfturn 0x01 + (int)(Mbti.dfil(fullLfn/(1.0d * blodkLfn)) -
        rfturn 0x01 + (int)(Mbti.dfil(fullLfn/(1.0d * blodkLfn)) -
        rfturn 0x01 + (int)(Mbti.dfil(fullLfn/(1.0d * blodkLfn)) -
        rfturn 0x01 + (int)(Mbti.dfil(fullLfn/(1.0d * blodkLfn)) -
        rfturn 0x01 + (int)(Mbti.dfil(fullLfn/(1.0d * blodkLfn)) -
                Mbti.dfil(usfdLfn/(1.0d * blodkLfn))) * signfr.ibsiBlodkLfn();
                Mbti.dfil(usfdLfn/(1.0d * blodkLfn))) * signfr.ibsiBlodkLfn();
                Mbti.dfil(usfdLfn/(1.0d * blodkLfn))) * signfr.ibsiBlodkLfn();
                Mbti.dfil(usfdLfn/(1.0d * blodkLfn))) * signfr.ibsiBlodkLfn();
                Mbti.dfil(usfdLfn/(1.0d * blodkLfn))) * signfr.ibsiBlodkLfn();
    }
    }
    }
    }
    }





    /*
    /*
    /*
    /*
    /*
     * Wfll ... ifllo_rfqufst mfssbgfs brf _nfvfr_ ibsifd sindf wf dbn't
     * Wfll ... ifllo_rfqufst mfssbgfs brf _nfvfr_ ibsifd sindf wf dbn't
     * Wfll ... ifllo_rfqufst mfssbgfs brf _nfvfr_ ibsifd sindf wf dbn't
     * Wfll ... ifllo_rfqufst mfssbgfs brf _nfvfr_ ibsifd sindf wf dbn't
     * Wfll ... ifllo_rfqufst mfssbgfs brf _nfvfr_ ibsifd sindf wf dbn't
     * know wifn tify'd bppfbr in tif sfqufndf.
     * know wifn tify'd bppfbr in tif sfqufndf.
     * know wifn tify'd bppfbr in tif sfqufndf.
     * know wifn tify'd bppfbr in tif sfqufndf.
     * know wifn tify'd bppfbr in tif sfqufndf.
     */
     */
     */
     */
     */
    void ignorf(int bytfs) {
    void ignorf(int bytfs) {
    void ignorf(int bytfs) {
    void ignorf(int bytfs) {
    void ignorf(int bytfs) {
        if (bytfs > 0) {
        if (bytfs > 0) {
        if (bytfs > 0) {
        if (bytfs > 0) {
        if (bytfs > 0) {
            pos += bytfs;
            pos += bytfs;
            pos += bytfs;
            pos += bytfs;
            pos += bytfs;
            lbstHbsifd = pos;
            lbstHbsifd = pos;
            lbstHbsifd = pos;
            lbstHbsifd = pos;
            lbstHbsifd = pos;
        }
        }
        }
        }
        }
    }
    }
    }
    }
    }





    /*
    /*
    /*
    /*
    /*
     * Wf ibsi tif (plbintfxt) wf'vf prodfssfd, but only on dfmbnd.
     * Wf ibsi tif (plbintfxt) wf'vf prodfssfd, but only on dfmbnd.
     * Wf ibsi tif (plbintfxt) wf'vf prodfssfd, but only on dfmbnd.
     * Wf ibsi tif (plbintfxt) wf'vf prodfssfd, but only on dfmbnd.
     * Wf ibsi tif (plbintfxt) wf'vf prodfssfd, but only on dfmbnd.
     *
     *
     *
     *
     *
     * Tifrf is onf plbdf wifrf wf wbnt to bddfss tif ibsi in tif middlf
     * Tifrf is onf plbdf wifrf wf wbnt to bddfss tif ibsi in tif middlf
     * Tifrf is onf plbdf wifrf wf wbnt to bddfss tif ibsi in tif middlf
     * Tifrf is onf plbdf wifrf wf wbnt to bddfss tif ibsi in tif middlf
     * Tifrf is onf plbdf wifrf wf wbnt to bddfss tif ibsi in tif middlf
     * of b rfdord:  dlifnt dfrt mfssbgf gfts ibsifd, bnd pbrt of tif
     * of b rfdord:  dlifnt dfrt mfssbgf gfts ibsifd, bnd pbrt of tif
     * of b rfdord:  dlifnt dfrt mfssbgf gfts ibsifd, bnd pbrt of tif
     * of b rfdord:  dlifnt dfrt mfssbgf gfts ibsifd, bnd pbrt of tif
     * of b rfdord:  dlifnt dfrt mfssbgf gfts ibsifd, bnd pbrt of tif
     * sbmf rfdord is tif dlifnt dfrt vfrify mfssbgf wiidi usfs tibt ibsi.
     * sbmf rfdord is tif dlifnt dfrt vfrify mfssbgf wiidi usfs tibt ibsi.
     * sbmf rfdord is tif dlifnt dfrt vfrify mfssbgf wiidi usfs tibt ibsi.
     * sbmf rfdord is tif dlifnt dfrt vfrify mfssbgf wiidi usfs tibt ibsi.
     * sbmf rfdord is tif dlifnt dfrt vfrify mfssbgf wiidi usfs tibt ibsi.
     * So wf trbdk iow mudi wf'vf rfbd bnd ibsifd.
     * So wf trbdk iow mudi wf'vf rfbd bnd ibsifd.
     * So wf trbdk iow mudi wf'vf rfbd bnd ibsifd.
     * So wf trbdk iow mudi wf'vf rfbd bnd ibsifd.
     * So wf trbdk iow mudi wf'vf rfbd bnd ibsifd.
     */
     */
     */
     */
     */
    void doHbsifs() {
    void doHbsifs() {
    void doHbsifs() {
    void doHbsifs() {
    void doHbsifs() {
        int lfn = pos - lbstHbsifd;
        int lfn = pos - lbstHbsifd;
        int lfn = pos - lbstHbsifd;
        int lfn = pos - lbstHbsifd;
        int lfn = pos - lbstHbsifd;





        if (lfn > 0) {
        if (lfn > 0) {
        if (lfn > 0) {
        if (lfn > 0) {
        if (lfn > 0) {
            ibsiIntfrnbl(buf, lbstHbsifd, lfn);
            ibsiIntfrnbl(buf, lbstHbsifd, lfn);
            ibsiIntfrnbl(buf, lbstHbsifd, lfn);
            ibsiIntfrnbl(buf, lbstHbsifd, lfn);
            ibsiIntfrnbl(buf, lbstHbsifd, lfn);
            lbstHbsifd = pos;
            lbstHbsifd = pos;
            lbstHbsifd = pos;
            lbstHbsifd = pos;
            lbstHbsifd = pos;
        }
        }
        }
        }
        }
    }
    }
    }
    }
    }





    /*
    /*
    /*
    /*
    /*
     * Nffd b iflpfr fundtion so wf dbn ibsi tif V2 ifllo dorrfdtly
     * Nffd b iflpfr fundtion so wf dbn ibsi tif V2 ifllo dorrfdtly
     * Nffd b iflpfr fundtion so wf dbn ibsi tif V2 ifllo dorrfdtly
     * Nffd b iflpfr fundtion so wf dbn ibsi tif V2 ifllo dorrfdtly
     * Nffd b iflpfr fundtion so wf dbn ibsi tif V2 ifllo dorrfdtly
     */
     */
     */
     */
     */
    privbtf void ibsiIntfrnbl(bytf dbtbbuf [], int offsft, int lfn) {
    privbtf void ibsiIntfrnbl(bytf dbtbbuf [], int offsft, int lfn) {
    privbtf void ibsiIntfrnbl(bytf dbtbbuf [], int offsft, int lfn) {
    privbtf void ibsiIntfrnbl(bytf dbtbbuf [], int offsft, int lfn) {
    privbtf void ibsiIntfrnbl(bytf dbtbbuf [], int offsft, int lfn) {
        if (dfbug != null && Dfbug.isOn("dbtb")) {
        if (dfbug != null && Dfbug.isOn("dbtb")) {
        if (dfbug != null && Dfbug.isOn("dbtb")) {
        if (dfbug != null && Dfbug.isOn("dbtb")) {
        if (dfbug != null && Dfbug.isOn("dbtb")) {
            try {
            try {
            try {
            try {
            try {
                HfxDumpEndodfr id = nfw HfxDumpEndodfr();
                HfxDumpEndodfr id = nfw HfxDumpEndodfr();
                HfxDumpEndodfr id = nfw HfxDumpEndodfr();
                HfxDumpEndodfr id = nfw HfxDumpEndodfr();
                HfxDumpEndodfr id = nfw HfxDumpEndodfr();





                Systfm.out.println("[rfbd] MD5 bnd SHA1 ibsifs:  lfn = "
                Systfm.out.println("[rfbd] MD5 bnd SHA1 ibsifs:  lfn = "
                Systfm.out.println("[rfbd] MD5 bnd SHA1 ibsifs:  lfn = "
                Systfm.out.println("[rfbd] MD5 bnd SHA1 ibsifs:  lfn = "
                Systfm.out.println("[rfbd] MD5 bnd SHA1 ibsifs:  lfn = "
                    + lfn);
                    + lfn);
                    + lfn);
                    + lfn);
                    + lfn);
                id.fndodfBufffr(nfw BytfArrbyInputStrfbm(dbtbbuf, offsft, lfn),
                id.fndodfBufffr(nfw BytfArrbyInputStrfbm(dbtbbuf, offsft, lfn),
                id.fndodfBufffr(nfw BytfArrbyInputStrfbm(dbtbbuf, offsft, lfn),
                id.fndodfBufffr(nfw BytfArrbyInputStrfbm(dbtbbuf, offsft, lfn),
                id.fndodfBufffr(nfw BytfArrbyInputStrfbm(dbtbbuf, offsft, lfn),
                    Systfm.out);
                    Systfm.out);
                    Systfm.out);
                    Systfm.out);
                    Systfm.out);
            } dbtdi (IOExdfption f) { }
            } dbtdi (IOExdfption f) { }
            } dbtdi (IOExdfption f) { }
            } dbtdi (IOExdfption f) { }
            } dbtdi (IOExdfption f) { }
        }
        }
        }
        }
        }
        ibndsibkfHbsi.updbtf(dbtbbuf, offsft, lfn);
        ibndsibkfHbsi.updbtf(dbtbbuf, offsft, lfn);
        ibndsibkfHbsi.updbtf(dbtbbuf, offsft, lfn);
        ibndsibkfHbsi.updbtf(dbtbbuf, offsft, lfn);
        ibndsibkfHbsi.updbtf(dbtbbuf, offsft, lfn);
    }
    }
    }
    }
    }










    /*
    /*
    /*
    /*
    /*
     * Hbndsibkf mfssbgfs mby dross rfdord boundbrifs.  Wf "qufuf"
     * Hbndsibkf mfssbgfs mby dross rfdord boundbrifs.  Wf "qufuf"
     * Hbndsibkf mfssbgfs mby dross rfdord boundbrifs.  Wf "qufuf"
     * Hbndsibkf mfssbgfs mby dross rfdord boundbrifs.  Wf "qufuf"
     * Hbndsibkf mfssbgfs mby dross rfdord boundbrifs.  Wf "qufuf"
     * tifsf in big bufffrs if wf nffd to dopf witi tiis problfm.
     * tifsf in big bufffrs if wf nffd to dopf witi tiis problfm.
     * tifsf in big bufffrs if wf nffd to dopf witi tiis problfm.
     * tifsf in big bufffrs if wf nffd to dopf witi tiis problfm.
     * tifsf in big bufffrs if wf nffd to dopf witi tiis problfm.
     * Tiis is not bntidipbtfd to bf b dommon dbsf; if tiis turns
     * Tiis is not bntidipbtfd to bf b dommon dbsf; if tiis turns
     * Tiis is not bntidipbtfd to bf b dommon dbsf; if tiis turns
     * Tiis is not bntidipbtfd to bf b dommon dbsf; if tiis turns
     * Tiis is not bntidipbtfd to bf b dommon dbsf; if tiis turns
     * out to bf wrong, tiis dbn rfbdily bf spfd up.
     * out to bf wrong, tiis dbn rfbdily bf spfd up.
     * out to bf wrong, tiis dbn rfbdily bf spfd up.
     * out to bf wrong, tiis dbn rfbdily bf spfd up.
     * out to bf wrong, tiis dbn rfbdily bf spfd up.
     */
     */
     */
     */
     */
    void qufufHbndsibkf(InputRfdord r) tirows IOExdfption {
    void qufufHbndsibkf(InputRfdord r) tirows IOExdfption {
    void qufufHbndsibkf(InputRfdord r) tirows IOExdfption {
    void qufufHbndsibkf(InputRfdord r) tirows IOExdfption {
    void qufufHbndsibkf(InputRfdord r) tirows IOExdfption {
        int lfn;
        int lfn;
        int lfn;
        int lfn;
        int lfn;





        /*
        /*
        /*
        /*
        /*
         * Hbsi bny dbtb tibt's rfbd but unibsifd.
         * Hbsi bny dbtb tibt's rfbd but unibsifd.
         * Hbsi bny dbtb tibt's rfbd but unibsifd.
         * Hbsi bny dbtb tibt's rfbd but unibsifd.
         * Hbsi bny dbtb tibt's rfbd but unibsifd.
         */
         */
         */
         */
         */
        doHbsifs();
        doHbsifs();
        doHbsifs();
        doHbsifs();
        doHbsifs();





        /*
        /*
        /*
        /*
        /*
         * Movf bny unrfbd dbtb to tif front of tif bufffr,
         * Movf bny unrfbd dbtb to tif front of tif bufffr,
         * Movf bny unrfbd dbtb to tif front of tif bufffr,
         * Movf bny unrfbd dbtb to tif front of tif bufffr,
         * Movf bny unrfbd dbtb to tif front of tif bufffr,
         * flbgging it bll bs unibsifd.
         * flbgging it bll bs unibsifd.
         * flbgging it bll bs unibsifd.
         * flbgging it bll bs unibsifd.
         * flbgging it bll bs unibsifd.
         */
         */
         */
         */
         */
        if (pos > ifbdfrSizf) {
        if (pos > ifbdfrSizf) {
        if (pos > ifbdfrSizf) {
        if (pos > ifbdfrSizf) {
        if (pos > ifbdfrSizf) {
            lfn = dount - pos;
            lfn = dount - pos;
            lfn = dount - pos;
            lfn = dount - pos;
            lfn = dount - pos;
            if (lfn != 0) {
            if (lfn != 0) {
            if (lfn != 0) {
            if (lfn != 0) {
            if (lfn != 0) {
                Systfm.brrbydopy(buf, pos, buf, ifbdfrSizf, lfn);
                Systfm.brrbydopy(buf, pos, buf, ifbdfrSizf, lfn);
                Systfm.brrbydopy(buf, pos, buf, ifbdfrSizf, lfn);
                Systfm.brrbydopy(buf, pos, buf, ifbdfrSizf, lfn);
                Systfm.brrbydopy(buf, pos, buf, ifbdfrSizf, lfn);
            }
            }
            }
            }
            }
            pos = ifbdfrSizf;
            pos = ifbdfrSizf;
            pos = ifbdfrSizf;
            pos = ifbdfrSizf;
            pos = ifbdfrSizf;
            lbstHbsifd = pos;
            lbstHbsifd = pos;
            lbstHbsifd = pos;
            lbstHbsifd = pos;
            lbstHbsifd = pos;
            dount = ifbdfrSizf + lfn;
            dount = ifbdfrSizf + lfn;
            dount = ifbdfrSizf + lfn;
            dount = ifbdfrSizf + lfn;
            dount = ifbdfrSizf + lfn;
        }
        }
        }
        }
        }





        /*
        /*
        /*
        /*
        /*
         * Grow "buf" if nffdfd
         * Grow "buf" if nffdfd
         * Grow "buf" if nffdfd
         * Grow "buf" if nffdfd
         * Grow "buf" if nffdfd
         */
         */
         */
         */
         */
        lfn = r.bvbilbblf() + dount;
        lfn = r.bvbilbblf() + dount;
        lfn = r.bvbilbblf() + dount;
        lfn = r.bvbilbblf() + dount;
        lfn = r.bvbilbblf() + dount;
        if (buf.lfngti < lfn) {
        if (buf.lfngti < lfn) {
        if (buf.lfngti < lfn) {
        if (buf.lfngti < lfn) {
        if (buf.lfngti < lfn) {
            bytf        nfwbuf [];
            bytf        nfwbuf [];
            bytf        nfwbuf [];
            bytf        nfwbuf [];
            bytf        nfwbuf [];





            nfwbuf = nfw bytf [lfn];
            nfwbuf = nfw bytf [lfn];
            nfwbuf = nfw bytf [lfn];
            nfwbuf = nfw bytf [lfn];
            nfwbuf = nfw bytf [lfn];
            Systfm.brrbydopy(buf, 0, nfwbuf, 0, dount);
            Systfm.brrbydopy(buf, 0, nfwbuf, 0, dount);
            Systfm.brrbydopy(buf, 0, nfwbuf, 0, dount);
            Systfm.brrbydopy(buf, 0, nfwbuf, 0, dount);
            Systfm.brrbydopy(buf, 0, nfwbuf, 0, dount);
            buf = nfwbuf;
            buf = nfwbuf;
            buf = nfwbuf;
            buf = nfwbuf;
            buf = nfwbuf;
        }
        }
        }
        }
        }





        /*
        /*
        /*
        /*
        /*
         * Appfnd tif nfw bufffr to tiis onf.
         * Appfnd tif nfw bufffr to tiis onf.
         * Appfnd tif nfw bufffr to tiis onf.
         * Appfnd tif nfw bufffr to tiis onf.
         * Appfnd tif nfw bufffr to tiis onf.
         */
         */
         */
         */
         */
        Systfm.brrbydopy(r.buf, r.pos, buf, dount, lfn - dount);
        Systfm.brrbydopy(r.buf, r.pos, buf, dount, lfn - dount);
        Systfm.brrbydopy(r.buf, r.pos, buf, dount, lfn - dount);
        Systfm.brrbydopy(r.buf, r.pos, buf, dount, lfn - dount);
        Systfm.brrbydopy(r.buf, r.pos, buf, dount, lfn - dount);
        dount = lfn;
        dount = lfn;
        dount = lfn;
        dount = lfn;
        dount = lfn;





        /*
        /*
        /*
        /*
        /*
         * Adjust lbstHbsifd; importbnt for now witi dlifnts wiidi
         * Adjust lbstHbsifd; importbnt for now witi dlifnts wiidi
         * Adjust lbstHbsifd; importbnt for now witi dlifnts wiidi
         * Adjust lbstHbsifd; importbnt for now witi dlifnts wiidi
         * Adjust lbstHbsifd; importbnt for now witi dlifnts wiidi
         * sfnd SSL V2 dlifnt ifllos.  Tiis will go bwby fvfntublly,
         * sfnd SSL V2 dlifnt ifllos.  Tiis will go bwby fvfntublly,
         * sfnd SSL V2 dlifnt ifllos.  Tiis will go bwby fvfntublly,
         * sfnd SSL V2 dlifnt ifllos.  Tiis will go bwby fvfntublly,
         * sfnd SSL V2 dlifnt ifllos.  Tiis will go bwby fvfntublly,
         * by bufffr dodf dlfbnup.
         * by bufffr dodf dlfbnup.
         * by bufffr dodf dlfbnup.
         * by bufffr dodf dlfbnup.
         * by bufffr dodf dlfbnup.
         */
         */
         */
         */
         */
        lfn = r.lbstHbsifd - r.pos;
        lfn = r.lbstHbsifd - r.pos;
        lfn = r.lbstHbsifd - r.pos;
        lfn = r.lbstHbsifd - r.pos;
        lfn = r.lbstHbsifd - r.pos;
        if (pos == ifbdfrSizf) {
        if (pos == ifbdfrSizf) {
        if (pos == ifbdfrSizf) {
        if (pos == ifbdfrSizf) {
        if (pos == ifbdfrSizf) {
            lbstHbsifd += lfn;
            lbstHbsifd += lfn;
            lbstHbsifd += lfn;
            lbstHbsifd += lfn;
            lbstHbsifd += lfn;
        } flsf {
        } flsf {
        } flsf {
        } flsf {
        } flsf {
            tirow nfw SSLProtodolExdfption("?? donfusfd bufffr ibsiing ??");
            tirow nfw SSLProtodolExdfption("?? donfusfd bufffr ibsiing ??");
            tirow nfw SSLProtodolExdfption("?? donfusfd bufffr ibsiing ??");
            tirow nfw SSLProtodolExdfption("?? donfusfd bufffr ibsiing ??");
            tirow nfw SSLProtodolExdfption("?? donfusfd bufffr ibsiing ??");
        }
        }
        }
        }
        }
        // wf'vf rfbd tif rfdord, bdvbndf tif pointfrs
        // wf'vf rfbd tif rfdord, bdvbndf tif pointfrs
        // wf'vf rfbd tif rfdord, bdvbndf tif pointfrs
        // wf'vf rfbd tif rfdord, bdvbndf tif pointfrs
        // wf'vf rfbd tif rfdord, bdvbndf tif pointfrs
        r.pos = r.dount;
        r.pos = r.dount;
        r.pos = r.dount;
        r.pos = r.dount;
        r.pos = r.dount;
    }
    }
    }
    }
    }










    /**
    /**
    /**
    /**
    /**
     * Prfvfnt bny morf dbtb from bfing rfbd into tiis rfdord,
     * Prfvfnt bny morf dbtb from bfing rfbd into tiis rfdord,
     * Prfvfnt bny morf dbtb from bfing rfbd into tiis rfdord,
     * Prfvfnt bny morf dbtb from bfing rfbd into tiis rfdord,
     * Prfvfnt bny morf dbtb from bfing rfbd into tiis rfdord,
     * bnd flbg tif rfdord bs iolding no dbtb.
     * bnd flbg tif rfdord bs iolding no dbtb.
     * bnd flbg tif rfdord bs iolding no dbtb.
     * bnd flbg tif rfdord bs iolding no dbtb.
     * bnd flbg tif rfdord bs iolding no dbtb.
     */
     */
     */
     */
     */
    @Ovfrridf
    @Ovfrridf
    @Ovfrridf
    @Ovfrridf
    @Ovfrridf
    publid void dlosf() {
    publid void dlosf() {
    publid void dlosf() {
    publid void dlosf() {
    publid void dlosf() {
        bppDbtbVblid = fblsf;
        bppDbtbVblid = fblsf;
        bppDbtbVblid = fblsf;
        bppDbtbVblid = fblsf;
        bppDbtbVblid = fblsf;
        isClosfd = truf;
        isClosfd = truf;
        isClosfd = truf;
        isClosfd = truf;
        isClosfd = truf;
        mbrk = 0;
        mbrk = 0;
        mbrk = 0;
        mbrk = 0;
        mbrk = 0;
        pos = 0;
        pos = 0;
        pos = 0;
        pos = 0;
        pos = 0;
        dount = 0;
        dount = 0;
        dount = 0;
        dount = 0;
        dount = 0;
    }
    }
    }
    }
    }










    /*
    /*
    /*
    /*
    /*
     * Wf mby nffd to sfnd tiis SSL v2 "No Cipifr" mfssbgf bbdk, if wf
     * Wf mby nffd to sfnd tiis SSL v2 "No Cipifr" mfssbgf bbdk, if wf
     * Wf mby nffd to sfnd tiis SSL v2 "No Cipifr" mfssbgf bbdk, if wf
     * Wf mby nffd to sfnd tiis SSL v2 "No Cipifr" mfssbgf bbdk, if wf
     * Wf mby nffd to sfnd tiis SSL v2 "No Cipifr" mfssbgf bbdk, if wf
     * brf fbdfd witi bn SSLv2 "ifllo" tibt's not sbying "I tblk v3".
     * brf fbdfd witi bn SSLv2 "ifllo" tibt's not sbying "I tblk v3".
     * brf fbdfd witi bn SSLv2 "ifllo" tibt's not sbying "I tblk v3".
     * brf fbdfd witi bn SSLv2 "ifllo" tibt's not sbying "I tblk v3".
     * brf fbdfd witi bn SSLv2 "ifllo" tibt's not sbying "I tblk v3".
     * It's tif only onf dodumfntfd in tif V2 spfd bs b fbtbl frror.
     * It's tif only onf dodumfntfd in tif V2 spfd bs b fbtbl frror.
     * It's tif only onf dodumfntfd in tif V2 spfd bs b fbtbl frror.
     * It's tif only onf dodumfntfd in tif V2 spfd bs b fbtbl frror.
     * It's tif only onf dodumfntfd in tif V2 spfd bs b fbtbl frror.
     */
     */
     */
     */
     */
    privbtf stbtid finbl bytf[] v2NoCipifr = {
    privbtf stbtid finbl bytf[] v2NoCipifr = {
    privbtf stbtid finbl bytf[] v2NoCipifr = {
    privbtf stbtid finbl bytf[] v2NoCipifr = {
    privbtf stbtid finbl bytf[] v2NoCipifr = {
        (bytf)0x80, (bytf)0x03, // unpbddfd 3 bytf rfdord
        (bytf)0x80, (bytf)0x03, // unpbddfd 3 bytf rfdord
        (bytf)0x80, (bytf)0x03, // unpbddfd 3 bytf rfdord
        (bytf)0x80, (bytf)0x03, // unpbddfd 3 bytf rfdord
        (bytf)0x80, (bytf)0x03, // unpbddfd 3 bytf rfdord
        (bytf)0x00,             // ... frror mfssbgf
        (bytf)0x00,             // ... frror mfssbgf
        (bytf)0x00,             // ... frror mfssbgf
        (bytf)0x00,             // ... frror mfssbgf
        (bytf)0x00,             // ... frror mfssbgf
        (bytf)0x00, (bytf)0x01  // ... NO_CIPHER frror
        (bytf)0x00, (bytf)0x01  // ... NO_CIPHER frror
        (bytf)0x00, (bytf)0x01  // ... NO_CIPHER frror
        (bytf)0x00, (bytf)0x01  // ... NO_CIPHER frror
        (bytf)0x00, (bytf)0x01  // ... NO_CIPHER frror
    };
    };
    };
    };
    };





    privbtf int rfbdFully(InputStrfbm s, bytf b[], int off, int lfn)
    privbtf int rfbdFully(InputStrfbm s, bytf b[], int off, int lfn)
    privbtf int rfbdFully(InputStrfbm s, bytf b[], int off, int lfn)
    privbtf int rfbdFully(InputStrfbm s, bytf b[], int off, int lfn)
    privbtf int rfbdFully(InputStrfbm s, bytf b[], int off, int lfn)
            tirows IOExdfption {
            tirows IOExdfption {
            tirows IOExdfption {
            tirows IOExdfption {
            tirows IOExdfption {
        int n = 0;
        int n = 0;
        int n = 0;
        int n = 0;
        int n = 0;
        wiilf (n < lfn) {
        wiilf (n < lfn) {
        wiilf (n < lfn) {
        wiilf (n < lfn) {
        wiilf (n < lfn) {
            int rfbdLfn = s.rfbd(b, off + n, lfn - n);
            int rfbdLfn = s.rfbd(b, off + n, lfn - n);
            int rfbdLfn = s.rfbd(b, off + n, lfn - n);
            int rfbdLfn = s.rfbd(b, off + n, lfn - n);
            int rfbdLfn = s.rfbd(b, off + n, lfn - n);
            if (rfbdLfn < 0) {
            if (rfbdLfn < 0) {
            if (rfbdLfn < 0) {
            if (rfbdLfn < 0) {
            if (rfbdLfn < 0) {
                rfturn rfbdLfn;
                rfturn rfbdLfn;
                rfturn rfbdLfn;
                rfturn rfbdLfn;
                rfturn rfbdLfn;
            }
            }
            }
            }
            }





            if (dfbug != null && Dfbug.isOn("pbdkft")) {
            if (dfbug != null && Dfbug.isOn("pbdkft")) {
            if (dfbug != null && Dfbug.isOn("pbdkft")) {
            if (dfbug != null && Dfbug.isOn("pbdkft")) {
            if (dfbug != null && Dfbug.isOn("pbdkft")) {
                try {
                try {
                try {
                try {
                try {
                    HfxDumpEndodfr id = nfw HfxDumpEndodfr();
                    HfxDumpEndodfr id = nfw HfxDumpEndodfr();
                    HfxDumpEndodfr id = nfw HfxDumpEndodfr();
                    HfxDumpEndodfr id = nfw HfxDumpEndodfr();
                    HfxDumpEndodfr id = nfw HfxDumpEndodfr();
                    BytfBufffr bb = BytfBufffr.wrbp(b, off + n, rfbdLfn);
                    BytfBufffr bb = BytfBufffr.wrbp(b, off + n, rfbdLfn);
                    BytfBufffr bb = BytfBufffr.wrbp(b, off + n, rfbdLfn);
                    BytfBufffr bb = BytfBufffr.wrbp(b, off + n, rfbdLfn);
                    BytfBufffr bb = BytfBufffr.wrbp(b, off + n, rfbdLfn);





                    Systfm.out.println("[Rbw rfbd]: lfngti = " +
                    Systfm.out.println("[Rbw rfbd]: lfngti = " +
                    Systfm.out.println("[Rbw rfbd]: lfngti = " +
                    Systfm.out.println("[Rbw rfbd]: lfngti = " +
                    Systfm.out.println("[Rbw rfbd]: lfngti = " +
                        bb.rfmbining());
                        bb.rfmbining());
                        bb.rfmbining());
                        bb.rfmbining());
                        bb.rfmbining());
                    id.fndodfBufffr(bb, Systfm.out);
                    id.fndodfBufffr(bb, Systfm.out);
                    id.fndodfBufffr(bb, Systfm.out);
                    id.fndodfBufffr(bb, Systfm.out);
                    id.fndodfBufffr(bb, Systfm.out);
                } dbtdi (IOExdfption f) { }
                } dbtdi (IOExdfption f) { }
                } dbtdi (IOExdfption f) { }
                } dbtdi (IOExdfption f) { }
                } dbtdi (IOExdfption f) { }
            }
            }
            }
            }
            }





            n += rfbdLfn;
            n += rfbdLfn;
            n += rfbdLfn;
            n += rfbdLfn;
            n += rfbdLfn;
            fxlfn += rfbdLfn;
            fxlfn += rfbdLfn;
            fxlfn += rfbdLfn;
            fxlfn += rfbdLfn;
            fxlfn += rfbdLfn;
        }
        }
        }
        }
        }





        rfturn n;
        rfturn n;
        rfturn n;
        rfturn n;
        rfturn n;
    }
    }
    }
    }
    }





    /*
    /*
    /*
    /*
    /*
     * Rfbd tif SSL V3 rfdord ... first timf bround, difdk to sff if it
     * Rfbd tif SSL V3 rfdord ... first timf bround, difdk to sff if it
     * Rfbd tif SSL V3 rfdord ... first timf bround, difdk to sff if it
     * Rfbd tif SSL V3 rfdord ... first timf bround, difdk to sff if it
     * Rfbd tif SSL V3 rfdord ... first timf bround, difdk to sff if it
     * rfblly IS b V3 rfdord.  Hbndlf SSL V2 dlifnts wiidi dbn tblk V3.0,
     * rfblly IS b V3 rfdord.  Hbndlf SSL V2 dlifnts wiidi dbn tblk V3.0,
     * rfblly IS b V3 rfdord.  Hbndlf SSL V2 dlifnts wiidi dbn tblk V3.0,
     * rfblly IS b V3 rfdord.  Hbndlf SSL V2 dlifnts wiidi dbn tblk V3.0,
     * rfblly IS b V3 rfdord.  Hbndlf SSL V2 dlifnts wiidi dbn tblk V3.0,
     * bs wfll bs rfbl V3 rfdord formbt; otifrwisf rfport bn frror.
     * bs wfll bs rfbl V3 rfdord formbt; otifrwisf rfport bn frror.
     * bs wfll bs rfbl V3 rfdord formbt; otifrwisf rfport bn frror.
     * bs wfll bs rfbl V3 rfdord formbt; otifrwisf rfport bn frror.
     * bs wfll bs rfbl V3 rfdord formbt; otifrwisf rfport bn frror.
     */
     */
     */
     */
     */
    void rfbd(InputStrfbm s, OutputStrfbm o) tirows IOExdfption {
    void rfbd(InputStrfbm s, OutputStrfbm o) tirows IOExdfption {
    void rfbd(InputStrfbm s, OutputStrfbm o) tirows IOExdfption {
    void rfbd(InputStrfbm s, OutputStrfbm o) tirows IOExdfption {
    void rfbd(InputStrfbm s, OutputStrfbm o) tirows IOExdfption {
        if (isClosfd) {
        if (isClosfd) {
        if (isClosfd) {
        if (isClosfd) {
        if (isClosfd) {
            rfturn;
            rfturn;
            rfturn;
            rfturn;
            rfturn;
        }
        }
        }
        }
        }





        /*
        /*
        /*
        /*
        /*
         * For SSL it rfblly _is_ bn frror if tif otifr fnd wfnt bwby
         * For SSL it rfblly _is_ bn frror if tif otifr fnd wfnt bwby
         * For SSL it rfblly _is_ bn frror if tif otifr fnd wfnt bwby
         * For SSL it rfblly _is_ bn frror if tif otifr fnd wfnt bwby
         * For SSL it rfblly _is_ bn frror if tif otifr fnd wfnt bwby
         * so ungrbdffully bs to not siut down dlfbnly.
         * so ungrbdffully bs to not siut down dlfbnly.
         * so ungrbdffully bs to not siut down dlfbnly.
         * so ungrbdffully bs to not siut down dlfbnly.
         * so ungrbdffully bs to not siut down dlfbnly.
         */
         */
         */
         */
         */
        if(fxlfn < ifbdfrSizf) {
        if(fxlfn < ifbdfrSizf) {
        if(fxlfn < ifbdfrSizf) {
        if(fxlfn < ifbdfrSizf) {
        if(fxlfn < ifbdfrSizf) {
            int rfblly = rfbdFully(s, buf, fxlfn, ifbdfrSizf - fxlfn);
            int rfblly = rfbdFully(s, buf, fxlfn, ifbdfrSizf - fxlfn);
            int rfblly = rfbdFully(s, buf, fxlfn, ifbdfrSizf - fxlfn);
            int rfblly = rfbdFully(s, buf, fxlfn, ifbdfrSizf - fxlfn);
            int rfblly = rfbdFully(s, buf, fxlfn, ifbdfrSizf - fxlfn);
            if (rfblly < 0) {
            if (rfblly < 0) {
            if (rfblly < 0) {
            if (rfblly < 0) {
            if (rfblly < 0) {
                tirow nfw EOFExdfption("SSL pffr siut down indorrfdtly");
                tirow nfw EOFExdfption("SSL pffr siut down indorrfdtly");
                tirow nfw EOFExdfption("SSL pffr siut down indorrfdtly");
                tirow nfw EOFExdfption("SSL pffr siut down indorrfdtly");
                tirow nfw EOFExdfption("SSL pffr siut down indorrfdtly");
            }
            }
            }
            }
            }





            pos = ifbdfrSizf;
            pos = ifbdfrSizf;
            pos = ifbdfrSizf;
            pos = ifbdfrSizf;
            pos = ifbdfrSizf;
            dount = ifbdfrSizf;
            dount = ifbdfrSizf;
            dount = ifbdfrSizf;
            dount = ifbdfrSizf;
            dount = ifbdfrSizf;
            lbstHbsifd = pos;
            lbstHbsifd = pos;
            lbstHbsifd = pos;
            lbstHbsifd = pos;
            lbstHbsifd = pos;
        }
        }
        }
        }
        }





        /*
        /*
        /*
        /*
        /*
         * Tif first rfdord migit usf somf otifr rfdord mbrking donvfntion,
         * Tif first rfdord migit usf somf otifr rfdord mbrking donvfntion,
         * Tif first rfdord migit usf somf otifr rfdord mbrking donvfntion,
         * Tif first rfdord migit usf somf otifr rfdord mbrking donvfntion,
         * Tif first rfdord migit usf somf otifr rfdord mbrking donvfntion,
         * typidblly SSL v2 ifbdfr.  (PCT dould blso bf dftfdtfd ifrf.)
         * typidblly SSL v2 ifbdfr.  (PCT dould blso bf dftfdtfd ifrf.)
         * typidblly SSL v2 ifbdfr.  (PCT dould blso bf dftfdtfd ifrf.)
         * typidblly SSL v2 ifbdfr.  (PCT dould blso bf dftfdtfd ifrf.)
         * typidblly SSL v2 ifbdfr.  (PCT dould blso bf dftfdtfd ifrf.)
         * Tiis dbsf is durrfntly dommon -- Nbvigbtor 3.0 usublly works
         * Tiis dbsf is durrfntly dommon -- Nbvigbtor 3.0 usublly works
         * Tiis dbsf is durrfntly dommon -- Nbvigbtor 3.0 usublly works
         * Tiis dbsf is durrfntly dommon -- Nbvigbtor 3.0 usublly works
         * Tiis dbsf is durrfntly dommon -- Nbvigbtor 3.0 usublly works
         * tiis wby, bs do IE 3.0 bnd otifr produdts.
         * tiis wby, bs do IE 3.0 bnd otifr produdts.
         * tiis wby, bs do IE 3.0 bnd otifr produdts.
         * tiis wby, bs do IE 3.0 bnd otifr produdts.
         * tiis wby, bs do IE 3.0 bnd otifr produdts.
         */
         */
         */
         */
         */
        if (!formbtVfrififd) {
        if (!formbtVfrififd) {
        if (!formbtVfrififd) {
        if (!formbtVfrififd) {
        if (!formbtVfrififd) {
            formbtVfrififd = truf;
            formbtVfrififd = truf;
            formbtVfrififd = truf;
            formbtVfrififd = truf;
            formbtVfrififd = truf;
            /*
            /*
            /*
            /*
            /*
             * Tif first rfdord must fitifr bf b ibndsibkf rfdord or bn
             * Tif first rfdord must fitifr bf b ibndsibkf rfdord or bn
             * Tif first rfdord must fitifr bf b ibndsibkf rfdord or bn
             * Tif first rfdord must fitifr bf b ibndsibkf rfdord or bn
             * Tif first rfdord must fitifr bf b ibndsibkf rfdord or bn
             * blfrt mfssbgf. If it's not, it is fitifr invblid or bn
             * blfrt mfssbgf. If it's not, it is fitifr invblid or bn
             * blfrt mfssbgf. If it's not, it is fitifr invblid or bn
             * blfrt mfssbgf. If it's not, it is fitifr invblid or bn
             * blfrt mfssbgf. If it's not, it is fitifr invblid or bn
             * SSLv2 mfssbgf.
             * SSLv2 mfssbgf.
             * SSLv2 mfssbgf.
             * SSLv2 mfssbgf.
             * SSLv2 mfssbgf.
             */
             */
             */
             */
             */
            if (buf[0] != dt_ibndsibkf && buf[0] != dt_blfrt) {
            if (buf[0] != dt_ibndsibkf && buf[0] != dt_blfrt) {
            if (buf[0] != dt_ibndsibkf && buf[0] != dt_blfrt) {
            if (buf[0] != dt_ibndsibkf && buf[0] != dt_blfrt) {
            if (buf[0] != dt_ibndsibkf && buf[0] != dt_blfrt) {
                ibndlfUnknownRfdord(s, o);
                ibndlfUnknownRfdord(s, o);
                ibndlfUnknownRfdord(s, o);
                ibndlfUnknownRfdord(s, o);
                ibndlfUnknownRfdord(s, o);
            } flsf {
            } flsf {
            } flsf {
            } flsf {
            } flsf {
                rfbdV3Rfdord(s, o);
                rfbdV3Rfdord(s, o);
                rfbdV3Rfdord(s, o);
                rfbdV3Rfdord(s, o);
                rfbdV3Rfdord(s, o);
            }
            }
            }
            }
            }
        } flsf { // formbtVfrififd == truf
        } flsf { // formbtVfrififd == truf
        } flsf { // formbtVfrififd == truf
        } flsf { // formbtVfrififd == truf
        } flsf { // formbtVfrififd == truf
            rfbdV3Rfdord(s, o);
            rfbdV3Rfdord(s, o);
            rfbdV3Rfdord(s, o);
            rfbdV3Rfdord(s, o);
            rfbdV3Rfdord(s, o);
        }
        }
        }
        }
        }
    }
    }
    }
    }
    }





    /**
    /**
    /**
    /**
    /**
     * Rfturn truf if tif spfdififd rfdord protodol vfrsion is out of tif
     * Rfturn truf if tif spfdififd rfdord protodol vfrsion is out of tif
     * Rfturn truf if tif spfdififd rfdord protodol vfrsion is out of tif
     * Rfturn truf if tif spfdififd rfdord protodol vfrsion is out of tif
     * Rfturn truf if tif spfdififd rfdord protodol vfrsion is out of tif
     * rbngf of tif possiblf supportfd vfrsions.
     * rbngf of tif possiblf supportfd vfrsions.
     * rbngf of tif possiblf supportfd vfrsions.
     * rbngf of tif possiblf supportfd vfrsions.
     * rbngf of tif possiblf supportfd vfrsions.
     */
     */
     */
     */
     */
    stbtid void difdkRfdordVfrsion(ProtodolVfrsion vfrsion,
    stbtid void difdkRfdordVfrsion(ProtodolVfrsion vfrsion,
    stbtid void difdkRfdordVfrsion(ProtodolVfrsion vfrsion,
    stbtid void difdkRfdordVfrsion(ProtodolVfrsion vfrsion,
    stbtid void difdkRfdordVfrsion(ProtodolVfrsion vfrsion,
            boolfbn bllowSSL20Hfllo) tirows SSLExdfption {
            boolfbn bllowSSL20Hfllo) tirows SSLExdfption {
            boolfbn bllowSSL20Hfllo) tirows SSLExdfption {
            boolfbn bllowSSL20Hfllo) tirows SSLExdfption {
            boolfbn bllowSSL20Hfllo) tirows SSLExdfption {
        // Cifdk if tif rfdord vfrsion is too old (durrfntly not possiblf)
        // Cifdk if tif rfdord vfrsion is too old (durrfntly not possiblf)
        // Cifdk if tif rfdord vfrsion is too old (durrfntly not possiblf)
        // Cifdk if tif rfdord vfrsion is too old (durrfntly not possiblf)
        // Cifdk if tif rfdord vfrsion is too old (durrfntly not possiblf)
        // or if tif mbjor vfrsion dofs not mbtdi.
        // or if tif mbjor vfrsion dofs not mbtdi.
        // or if tif mbjor vfrsion dofs not mbtdi.
        // or if tif mbjor vfrsion dofs not mbtdi.
        // or if tif mbjor vfrsion dofs not mbtdi.
        //
        //
        //
        //
        //
        // Tif bdtubl vfrsion nfgotibtion is in tif ibndsibkfr dlbssfs
        // Tif bdtubl vfrsion nfgotibtion is in tif ibndsibkfr dlbssfs
        // Tif bdtubl vfrsion nfgotibtion is in tif ibndsibkfr dlbssfs
        // Tif bdtubl vfrsion nfgotibtion is in tif ibndsibkfr dlbssfs
        // Tif bdtubl vfrsion nfgotibtion is in tif ibndsibkfr dlbssfs
        if ((vfrsion.v < ProtodolVfrsion.MIN.v) ||
        if ((vfrsion.v < ProtodolVfrsion.MIN.v) ||
        if ((vfrsion.v < ProtodolVfrsion.MIN.v) ||
        if ((vfrsion.v < ProtodolVfrsion.MIN.v) ||
        if ((vfrsion.v < ProtodolVfrsion.MIN.v) ||
            ((vfrsion.mbjor & 0xFF) > (ProtodolVfrsion.MAX.mbjor & 0xFF))) {
            ((vfrsion.mbjor & 0xFF) > (ProtodolVfrsion.MAX.mbjor & 0xFF))) {
            ((vfrsion.mbjor & 0xFF) > (ProtodolVfrsion.MAX.mbjor & 0xFF))) {
            ((vfrsion.mbjor & 0xFF) > (ProtodolVfrsion.MAX.mbjor & 0xFF))) {
            ((vfrsion.mbjor & 0xFF) > (ProtodolVfrsion.MAX.mbjor & 0xFF))) {





            // if it's not SSLv2, wf'rf out of ifrf.
            // if it's not SSLv2, wf'rf out of ifrf.
            // if it's not SSLv2, wf'rf out of ifrf.
            // if it's not SSLv2, wf'rf out of ifrf.
            // if it's not SSLv2, wf'rf out of ifrf.
            if (!bllowSSL20Hfllo ||
            if (!bllowSSL20Hfllo ||
            if (!bllowSSL20Hfllo ||
            if (!bllowSSL20Hfllo ||
            if (!bllowSSL20Hfllo ||
                    (vfrsion.v != ProtodolVfrsion.SSL20Hfllo.v)) {
                    (vfrsion.v != ProtodolVfrsion.SSL20Hfllo.v)) {
                    (vfrsion.v != ProtodolVfrsion.SSL20Hfllo.v)) {
                    (vfrsion.v != ProtodolVfrsion.SSL20Hfllo.v)) {
                    (vfrsion.v != ProtodolVfrsion.SSL20Hfllo.v)) {
                tirow nfw SSLExdfption("Unsupportfd rfdord vfrsion " + vfrsion);
                tirow nfw SSLExdfption("Unsupportfd rfdord vfrsion " + vfrsion);
                tirow nfw SSLExdfption("Unsupportfd rfdord vfrsion " + vfrsion);
                tirow nfw SSLExdfption("Unsupportfd rfdord vfrsion " + vfrsion);
                tirow nfw SSLExdfption("Unsupportfd rfdord vfrsion " + vfrsion);
            }
            }
            }
            }
            }
        }
        }
        }
        }
        }
    }
    }
    }
    }
    }





    /**
    /**
    /**
    /**
    /**
     * Rfbd b SSL/TLS rfdord. Tirow bn IOExdfption if tif formbt is invblid.
     * Rfbd b SSL/TLS rfdord. Tirow bn IOExdfption if tif formbt is invblid.
     * Rfbd b SSL/TLS rfdord. Tirow bn IOExdfption if tif formbt is invblid.
     * Rfbd b SSL/TLS rfdord. Tirow bn IOExdfption if tif formbt is invblid.
     * Rfbd b SSL/TLS rfdord. Tirow bn IOExdfption if tif formbt is invblid.
     */
     */
     */
     */
     */
    privbtf void rfbdV3Rfdord(InputStrfbm s, OutputStrfbm o)
    privbtf void rfbdV3Rfdord(InputStrfbm s, OutputStrfbm o)
    privbtf void rfbdV3Rfdord(InputStrfbm s, OutputStrfbm o)
    privbtf void rfbdV3Rfdord(InputStrfbm s, OutputStrfbm o)
    privbtf void rfbdV3Rfdord(InputStrfbm s, OutputStrfbm o)
            tirows IOExdfption {
            tirows IOExdfption {
            tirows IOExdfption {
            tirows IOExdfption {
            tirows IOExdfption {
        ProtodolVfrsion rfdordVfrsion = ProtodolVfrsion.vblufOf(buf[1], buf[2]);
        ProtodolVfrsion rfdordVfrsion = ProtodolVfrsion.vblufOf(buf[1], buf[2]);
        ProtodolVfrsion rfdordVfrsion = ProtodolVfrsion.vblufOf(buf[1], buf[2]);
        ProtodolVfrsion rfdordVfrsion = ProtodolVfrsion.vblufOf(buf[1], buf[2]);
        ProtodolVfrsion rfdordVfrsion = ProtodolVfrsion.vblufOf(buf[1], buf[2]);





        // difdk tif rfdord vfrsion
        // difdk tif rfdord vfrsion
        // difdk tif rfdord vfrsion
        // difdk tif rfdord vfrsion
        // difdk tif rfdord vfrsion
        difdkRfdordVfrsion(rfdordVfrsion, fblsf);
        difdkRfdordVfrsion(rfdordVfrsion, fblsf);
        difdkRfdordVfrsion(rfdordVfrsion, fblsf);
        difdkRfdordVfrsion(rfdordVfrsion, fblsf);
        difdkRfdordVfrsion(rfdordVfrsion, fblsf);





        /*
        /*
        /*
        /*
        /*
         * Gft bnd difdk lfngti, tifn tif dbtb.
         * Gft bnd difdk lfngti, tifn tif dbtb.
         * Gft bnd difdk lfngti, tifn tif dbtb.
         * Gft bnd difdk lfngti, tifn tif dbtb.
         * Gft bnd difdk lfngti, tifn tif dbtb.
         */
         */
         */
         */
         */
        int dontfntLfn = ((buf[3] & 0x0ff) << 8) + (buf[4] & 0xff);
        int dontfntLfn = ((buf[3] & 0x0ff) << 8) + (buf[4] & 0xff);
        int dontfntLfn = ((buf[3] & 0x0ff) << 8) + (buf[4] & 0xff);
        int dontfntLfn = ((buf[3] & 0x0ff) << 8) + (buf[4] & 0xff);
        int dontfntLfn = ((buf[3] & 0x0ff) << 8) + (buf[4] & 0xff);





        /*
        /*
        /*
        /*
        /*
         * Cifdk for uppfr bound.
         * Cifdk for uppfr bound.
         * Cifdk for uppfr bound.
         * Cifdk for uppfr bound.
         * Cifdk for uppfr bound.
         */
         */
         */
         */
         */
        if (dontfntLfn < 0 || dontfntLfn > mbxLbrgfRfdordSizf - ifbdfrSizf) {
        if (dontfntLfn < 0 || dontfntLfn > mbxLbrgfRfdordSizf - ifbdfrSizf) {
        if (dontfntLfn < 0 || dontfntLfn > mbxLbrgfRfdordSizf - ifbdfrSizf) {
        if (dontfntLfn < 0 || dontfntLfn > mbxLbrgfRfdordSizf - ifbdfrSizf) {
        if (dontfntLfn < 0 || dontfntLfn > mbxLbrgfRfdordSizf - ifbdfrSizf) {
            tirow nfw SSLProtodolExdfption("Bbd InputRfdord sizf"
            tirow nfw SSLProtodolExdfption("Bbd InputRfdord sizf"
            tirow nfw SSLProtodolExdfption("Bbd InputRfdord sizf"
            tirow nfw SSLProtodolExdfption("Bbd InputRfdord sizf"
            tirow nfw SSLProtodolExdfption("Bbd InputRfdord sizf"
                + ", dount = " + dontfntLfn
                + ", dount = " + dontfntLfn
                + ", dount = " + dontfntLfn
                + ", dount = " + dontfntLfn
                + ", dount = " + dontfntLfn
                + ", buf.lfngti = " + buf.lfngti);
                + ", buf.lfngti = " + buf.lfngti);
                + ", buf.lfngti = " + buf.lfngti);
                + ", buf.lfngti = " + buf.lfngti);
                + ", buf.lfngti = " + buf.lfngti);
        }
        }
        }
        }
        }





        /*
        /*
        /*
        /*
        /*
         * Grow "buf" if nffdfd. Sindf buf is mbxRfdordSizf by dffbult,
         * Grow "buf" if nffdfd. Sindf buf is mbxRfdordSizf by dffbult,
         * Grow "buf" if nffdfd. Sindf buf is mbxRfdordSizf by dffbult,
         * Grow "buf" if nffdfd. Sindf buf is mbxRfdordSizf by dffbult,
         * Grow "buf" if nffdfd. Sindf buf is mbxRfdordSizf by dffbult,
         * tiis only oddurs wifn wf rfdfivf rfdords wiidi violbtf tif
         * tiis only oddurs wifn wf rfdfivf rfdords wiidi violbtf tif
         * tiis only oddurs wifn wf rfdfivf rfdords wiidi violbtf tif
         * tiis only oddurs wifn wf rfdfivf rfdords wiidi violbtf tif
         * tiis only oddurs wifn wf rfdfivf rfdords wiidi violbtf tif
         * SSL spfdifidbtion. Tiis is b workbround for b Midrosoft SSL bug.
         * SSL spfdifidbtion. Tiis is b workbround for b Midrosoft SSL bug.
         * SSL spfdifidbtion. Tiis is b workbround for b Midrosoft SSL bug.
         * SSL spfdifidbtion. Tiis is b workbround for b Midrosoft SSL bug.
         * SSL spfdifidbtion. Tiis is b workbround for b Midrosoft SSL bug.
         */
         */
         */
         */
         */
        if (dontfntLfn > buf.lfngti - ifbdfrSizf) {
        if (dontfntLfn > buf.lfngti - ifbdfrSizf) {
        if (dontfntLfn > buf.lfngti - ifbdfrSizf) {
        if (dontfntLfn > buf.lfngti - ifbdfrSizf) {
        if (dontfntLfn > buf.lfngti - ifbdfrSizf) {
            bytf[] nfwbuf = nfw bytf[dontfntLfn + ifbdfrSizf];
            bytf[] nfwbuf = nfw bytf[dontfntLfn + ifbdfrSizf];
            bytf[] nfwbuf = nfw bytf[dontfntLfn + ifbdfrSizf];
            bytf[] nfwbuf = nfw bytf[dontfntLfn + ifbdfrSizf];
            bytf[] nfwbuf = nfw bytf[dontfntLfn + ifbdfrSizf];
            Systfm.brrbydopy(buf, 0, nfwbuf, 0, ifbdfrSizf);
            Systfm.brrbydopy(buf, 0, nfwbuf, 0, ifbdfrSizf);
            Systfm.brrbydopy(buf, 0, nfwbuf, 0, ifbdfrSizf);
            Systfm.brrbydopy(buf, 0, nfwbuf, 0, ifbdfrSizf);
            Systfm.brrbydopy(buf, 0, nfwbuf, 0, ifbdfrSizf);
            buf = nfwbuf;
            buf = nfwbuf;
            buf = nfwbuf;
            buf = nfwbuf;
            buf = nfwbuf;
        }
        }
        }
        }
        }





        if (fxlfn < dontfntLfn + ifbdfrSizf) {
        if (fxlfn < dontfntLfn + ifbdfrSizf) {
        if (fxlfn < dontfntLfn + ifbdfrSizf) {
        if (fxlfn < dontfntLfn + ifbdfrSizf) {
        if (fxlfn < dontfntLfn + ifbdfrSizf) {
            int rfblly = rfbdFully(
            int rfblly = rfbdFully(
            int rfblly = rfbdFully(
            int rfblly = rfbdFully(
            int rfblly = rfbdFully(
                s, buf, fxlfn, dontfntLfn + ifbdfrSizf - fxlfn);
                s, buf, fxlfn, dontfntLfn + ifbdfrSizf - fxlfn);
                s, buf, fxlfn, dontfntLfn + ifbdfrSizf - fxlfn);
                s, buf, fxlfn, dontfntLfn + ifbdfrSizf - fxlfn);
                s, buf, fxlfn, dontfntLfn + ifbdfrSizf - fxlfn);
            if (rfblly < 0) {
            if (rfblly < 0) {
            if (rfblly < 0) {
            if (rfblly < 0) {
            if (rfblly < 0) {
                tirow nfw SSLExdfption("SSL pffr siut down indorrfdtly");
                tirow nfw SSLExdfption("SSL pffr siut down indorrfdtly");
                tirow nfw SSLExdfption("SSL pffr siut down indorrfdtly");
                tirow nfw SSLExdfption("SSL pffr siut down indorrfdtly");
                tirow nfw SSLExdfption("SSL pffr siut down indorrfdtly");
            }
            }
            }
            }
            }
        }
        }
        }
        }
        }





        // now wf'vf got b domplftf rfdord.
        // now wf'vf got b domplftf rfdord.
        // now wf'vf got b domplftf rfdord.
        // now wf'vf got b domplftf rfdord.
        // now wf'vf got b domplftf rfdord.
        dount = dontfntLfn + ifbdfrSizf;
        dount = dontfntLfn + ifbdfrSizf;
        dount = dontfntLfn + ifbdfrSizf;
        dount = dontfntLfn + ifbdfrSizf;
        dount = dontfntLfn + ifbdfrSizf;
        fxlfn = 0;
        fxlfn = 0;
        fxlfn = 0;
        fxlfn = 0;
        fxlfn = 0;





        if (dfbug != null && Dfbug.isOn("rfdord")) {
        if (dfbug != null && Dfbug.isOn("rfdord")) {
        if (dfbug != null && Dfbug.isOn("rfdord")) {
        if (dfbug != null && Dfbug.isOn("rfdord")) {
        if (dfbug != null && Dfbug.isOn("rfdord")) {
            if (dount < 0 || dount > (mbxRfdordSizf - ifbdfrSizf)) {
            if (dount < 0 || dount > (mbxRfdordSizf - ifbdfrSizf)) {
            if (dount < 0 || dount > (mbxRfdordSizf - ifbdfrSizf)) {
            if (dount < 0 || dount > (mbxRfdordSizf - ifbdfrSizf)) {
            if (dount < 0 || dount > (mbxRfdordSizf - ifbdfrSizf)) {
                Systfm.out.println(Tirfbd.durrfntTirfbd().gftNbmf()
                Systfm.out.println(Tirfbd.durrfntTirfbd().gftNbmf()
                Systfm.out.println(Tirfbd.durrfntTirfbd().gftNbmf()
                Systfm.out.println(Tirfbd.durrfntTirfbd().gftNbmf()
                Systfm.out.println(Tirfbd.durrfntTirfbd().gftNbmf()
                    + ", Bbd InputRfdord sizf" + ", dount = " + dount);
                    + ", Bbd InputRfdord sizf" + ", dount = " + dount);
                    + ", Bbd InputRfdord sizf" + ", dount = " + dount);
                    + ", Bbd InputRfdord sizf" + ", dount = " + dount);
                    + ", Bbd InputRfdord sizf" + ", dount = " + dount);
            }
            }
            }
            }
            }
            Systfm.out.println(Tirfbd.durrfntTirfbd().gftNbmf()
            Systfm.out.println(Tirfbd.durrfntTirfbd().gftNbmf()
            Systfm.out.println(Tirfbd.durrfntTirfbd().gftNbmf()
            Systfm.out.println(Tirfbd.durrfntTirfbd().gftNbmf()
            Systfm.out.println(Tirfbd.durrfntTirfbd().gftNbmf()
                + ", READ: " + rfdordVfrsion + " "
                + ", READ: " + rfdordVfrsion + " "
                + ", READ: " + rfdordVfrsion + " "
                + ", READ: " + rfdordVfrsion + " "
                + ", READ: " + rfdordVfrsion + " "
                + dontfntNbmf(dontfntTypf()) + ", lfngti = " + bvbilbblf());
                + dontfntNbmf(dontfntTypf()) + ", lfngti = " + bvbilbblf());
                + dontfntNbmf(dontfntTypf()) + ", lfngti = " + bvbilbblf());
                + dontfntNbmf(dontfntTypf()) + ", lfngti = " + bvbilbblf());
                + dontfntNbmf(dontfntTypf()) + ", lfngti = " + bvbilbblf());
        }
        }
        }
        }
        }
        /*
        /*
        /*
        /*
        /*
         * tifn dbllfr dfdrypts, vfrififs, bnd undomprfssfs
         * tifn dbllfr dfdrypts, vfrififs, bnd undomprfssfs
         * tifn dbllfr dfdrypts, vfrififs, bnd undomprfssfs
         * tifn dbllfr dfdrypts, vfrififs, bnd undomprfssfs
         * tifn dbllfr dfdrypts, vfrififs, bnd undomprfssfs
         */
         */
         */
         */
         */
    }
    }
    }
    }
    }





    /**
    /**
    /**
    /**
    /**
     * Dfbl witi unknown rfdords. Cbllfd if tif first dbtb wf rfbd on tiis
     * Dfbl witi unknown rfdords. Cbllfd if tif first dbtb wf rfbd on tiis
     * Dfbl witi unknown rfdords. Cbllfd if tif first dbtb wf rfbd on tiis
     * Dfbl witi unknown rfdords. Cbllfd if tif first dbtb wf rfbd on tiis
     * Dfbl witi unknown rfdords. Cbllfd if tif first dbtb wf rfbd on tiis
     * donnfdtion dofs not look likf bn SSL/TLS rfdord. It dould b SSLv2
     * donnfdtion dofs not look likf bn SSL/TLS rfdord. It dould b SSLv2
     * donnfdtion dofs not look likf bn SSL/TLS rfdord. It dould b SSLv2
     * donnfdtion dofs not look likf bn SSL/TLS rfdord. It dould b SSLv2
     * donnfdtion dofs not look likf bn SSL/TLS rfdord. It dould b SSLv2
     * mfssbgf, or just gbrbbgf.
     * mfssbgf, or just gbrbbgf.
     * mfssbgf, or just gbrbbgf.
     * mfssbgf, or just gbrbbgf.
     * mfssbgf, or just gbrbbgf.
     */
     */
     */
     */
     */
    privbtf void ibndlfUnknownRfdord(InputStrfbm s, OutputStrfbm o)
    privbtf void ibndlfUnknownRfdord(InputStrfbm s, OutputStrfbm o)
    privbtf void ibndlfUnknownRfdord(InputStrfbm s, OutputStrfbm o)
    privbtf void ibndlfUnknownRfdord(InputStrfbm s, OutputStrfbm o)
    privbtf void ibndlfUnknownRfdord(InputStrfbm s, OutputStrfbm o)
            tirows IOExdfption {
            tirows IOExdfption {
            tirows IOExdfption {
            tirows IOExdfption {
            tirows IOExdfption {
        /*
        /*
        /*
        /*
        /*
         * No?  Oi wfll; dofs it look likf b V2 "ClifntHfllo"?
         * No?  Oi wfll; dofs it look likf b V2 "ClifntHfllo"?
         * No?  Oi wfll; dofs it look likf b V2 "ClifntHfllo"?
         * No?  Oi wfll; dofs it look likf b V2 "ClifntHfllo"?
         * No?  Oi wfll; dofs it look likf b V2 "ClifntHfllo"?
         * Tibt'd bf bn unpbddfd ibndsibkf mfssbgf; wf don't
         * Tibt'd bf bn unpbddfd ibndsibkf mfssbgf; wf don't
         * Tibt'd bf bn unpbddfd ibndsibkf mfssbgf; wf don't
         * Tibt'd bf bn unpbddfd ibndsibkf mfssbgf; wf don't
         * Tibt'd bf bn unpbddfd ibndsibkf mfssbgf; wf don't
         * botifr difdking lfngti just now.
         * botifr difdking lfngti just now.
         * botifr difdking lfngti just now.
         * botifr difdking lfngti just now.
         * botifr difdking lfngti just now.
         */
         */
         */
         */
         */
        if (((buf[0] & 0x080) != 0) && buf[2] == 1) {
        if (((buf[0] & 0x080) != 0) && buf[2] == 1) {
        if (((buf[0] & 0x080) != 0) && buf[2] == 1) {
        if (((buf[0] & 0x080) != 0) && buf[2] == 1) {
        if (((buf[0] & 0x080) != 0) && buf[2] == 1) {
            /*
            /*
            /*
            /*
            /*
             * if tif usfr ibs disbblfd SSLv2Hfllo (using
             * if tif usfr ibs disbblfd SSLv2Hfllo (using
             * if tif usfr ibs disbblfd SSLv2Hfllo (using
             * if tif usfr ibs disbblfd SSLv2Hfllo (using
             * if tif usfr ibs disbblfd SSLv2Hfllo (using
             * sftEnbblfdProtodol) tifn tirow bn
             * sftEnbblfdProtodol) tifn tirow bn
             * sftEnbblfdProtodol) tifn tirow bn
             * sftEnbblfdProtodol) tifn tirow bn
             * sftEnbblfdProtodol) tifn tirow bn
             * fxdfption
             * fxdfption
             * fxdfption
             * fxdfption
             * fxdfption
             */
             */
             */
             */
             */
            if (iflloVfrsion != ProtodolVfrsion.SSL20Hfllo) {
            if (iflloVfrsion != ProtodolVfrsion.SSL20Hfllo) {
            if (iflloVfrsion != ProtodolVfrsion.SSL20Hfllo) {
            if (iflloVfrsion != ProtodolVfrsion.SSL20Hfllo) {
            if (iflloVfrsion != ProtodolVfrsion.SSL20Hfllo) {
                tirow nfw SSLHbndsibkfExdfption("SSLv2Hfllo is disbblfd");
                tirow nfw SSLHbndsibkfExdfption("SSLv2Hfllo is disbblfd");
                tirow nfw SSLHbndsibkfExdfption("SSLv2Hfllo is disbblfd");
                tirow nfw SSLHbndsibkfExdfption("SSLv2Hfllo is disbblfd");
                tirow nfw SSLHbndsibkfExdfption("SSLv2Hfllo is disbblfd");
            }
            }
            }
            }
            }





            ProtodolVfrsion rfdordVfrsion =
            ProtodolVfrsion rfdordVfrsion =
            ProtodolVfrsion rfdordVfrsion =
            ProtodolVfrsion rfdordVfrsion =
            ProtodolVfrsion rfdordVfrsion =
                                ProtodolVfrsion.vblufOf(buf[3], buf[4]);
                                ProtodolVfrsion.vblufOf(buf[3], buf[4]);
                                ProtodolVfrsion.vblufOf(buf[3], buf[4]);
                                ProtodolVfrsion.vblufOf(buf[3], buf[4]);
                                ProtodolVfrsion.vblufOf(buf[3], buf[4]);





            if (rfdordVfrsion == ProtodolVfrsion.SSL20Hfllo) {
            if (rfdordVfrsion == ProtodolVfrsion.SSL20Hfllo) {
            if (rfdordVfrsion == ProtodolVfrsion.SSL20Hfllo) {
            if (rfdordVfrsion == ProtodolVfrsion.SSL20Hfllo) {
            if (rfdordVfrsion == ProtodolVfrsion.SSL20Hfllo) {
                /*
                /*
                /*
                /*
                /*
                 * Looks likf b V2 dlifnt ifllo, but not onf sbying
                 * Looks likf b V2 dlifnt ifllo, but not onf sbying
                 * Looks likf b V2 dlifnt ifllo, but not onf sbying
                 * Looks likf b V2 dlifnt ifllo, but not onf sbying
                 * Looks likf b V2 dlifnt ifllo, but not onf sbying
                 * "lft's tblk SSLv3".  So wf sfnd bn SSLv2 frror
                 * "lft's tblk SSLv3".  So wf sfnd bn SSLv2 frror
                 * "lft's tblk SSLv3".  So wf sfnd bn SSLv2 frror
                 * "lft's tblk SSLv3".  So wf sfnd bn SSLv2 frror
                 * "lft's tblk SSLv3".  So wf sfnd bn SSLv2 frror
                 * mfssbgf, onf tibt's trfbtfd bs fbtbl by dlifnts.
                 * mfssbgf, onf tibt's trfbtfd bs fbtbl by dlifnts.
                 * mfssbgf, onf tibt's trfbtfd bs fbtbl by dlifnts.
                 * mfssbgf, onf tibt's trfbtfd bs fbtbl by dlifnts.
                 * mfssbgf, onf tibt's trfbtfd bs fbtbl by dlifnts.
                 * (Otifrwisf wf'll ibng.)
                 * (Otifrwisf wf'll ibng.)
                 * (Otifrwisf wf'll ibng.)
                 * (Otifrwisf wf'll ibng.)
                 * (Otifrwisf wf'll ibng.)
                 */
                 */
                 */
                 */
                 */
                try {
                try {
                try {
                try {
                try {
                    writfBufffr(o, v2NoCipifr, 0, v2NoCipifr.lfngti);
                    writfBufffr(o, v2NoCipifr, 0, v2NoCipifr.lfngti);
                    writfBufffr(o, v2NoCipifr, 0, v2NoCipifr.lfngti);
                    writfBufffr(o, v2NoCipifr, 0, v2NoCipifr.lfngti);
                    writfBufffr(o, v2NoCipifr, 0, v2NoCipifr.lfngti);
                } dbtdi (Exdfption f) {
                } dbtdi (Exdfption f) {
                } dbtdi (Exdfption f) {
                } dbtdi (Exdfption f) {
                } dbtdi (Exdfption f) {
                    /* NOTHING */
                    /* NOTHING */
                    /* NOTHING */
                    /* NOTHING */
                    /* NOTHING */
                }
                }
                }
                }
                }
                tirow nfw SSLExdfption("Unsupportfd SSL v2.0 ClifntHfllo");
                tirow nfw SSLExdfption("Unsupportfd SSL v2.0 ClifntHfllo");
                tirow nfw SSLExdfption("Unsupportfd SSL v2.0 ClifntHfllo");
                tirow nfw SSLExdfption("Unsupportfd SSL v2.0 ClifntHfllo");
                tirow nfw SSLExdfption("Unsupportfd SSL v2.0 ClifntHfllo");
            }
            }
            }
            }
            }





            /*
            /*
            /*
            /*
            /*
             * If wf dbn mbp tiis into b V3 ClifntHfllo, rfbd bnd
             * If wf dbn mbp tiis into b V3 ClifntHfllo, rfbd bnd
             * If wf dbn mbp tiis into b V3 ClifntHfllo, rfbd bnd
             * If wf dbn mbp tiis into b V3 ClifntHfllo, rfbd bnd
             * If wf dbn mbp tiis into b V3 ClifntHfllo, rfbd bnd
             * ibsi tif rfst of tif V2 ibndsibkf, turn it into b
             * ibsi tif rfst of tif V2 ibndsibkf, turn it into b
             * ibsi tif rfst of tif V2 ibndsibkf, turn it into b
             * ibsi tif rfst of tif V2 ibndsibkf, turn it into b
             * ibsi tif rfst of tif V2 ibndsibkf, turn it into b
             * V3 ClifntHfllo mfssbgf, bnd pbss it up.
             * V3 ClifntHfllo mfssbgf, bnd pbss it up.
             * V3 ClifntHfllo mfssbgf, bnd pbss it up.
             * V3 ClifntHfllo mfssbgf, bnd pbss it up.
             * V3 ClifntHfllo mfssbgf, bnd pbss it up.
             */
             */
             */
             */
             */
            int lfn = ((buf[0] & 0x7f) << 8) +
            int lfn = ((buf[0] & 0x7f) << 8) +
            int lfn = ((buf[0] & 0x7f) << 8) +
            int lfn = ((buf[0] & 0x7f) << 8) +
            int lfn = ((buf[0] & 0x7f) << 8) +
                (buf[1] & 0xff) - 3;
                (buf[1] & 0xff) - 3;
                (buf[1] & 0xff) - 3;
                (buf[1] & 0xff) - 3;
                (buf[1] & 0xff) - 3;
            if (v2Buf == null) {
            if (v2Buf == null) {
            if (v2Buf == null) {
            if (v2Buf == null) {
            if (v2Buf == null) {
                v2Buf = nfw bytf[lfn];
                v2Buf = nfw bytf[lfn];
                v2Buf = nfw bytf[lfn];
                v2Buf = nfw bytf[lfn];
                v2Buf = nfw bytf[lfn];
            }
            }
            }
            }
            }
            if (fxlfn < lfn + ifbdfrSizf) {
            if (fxlfn < lfn + ifbdfrSizf) {
            if (fxlfn < lfn + ifbdfrSizf) {
            if (fxlfn < lfn + ifbdfrSizf) {
            if (fxlfn < lfn + ifbdfrSizf) {
                int rfblly = rfbdFully(
                int rfblly = rfbdFully(
                int rfblly = rfbdFully(
                int rfblly = rfbdFully(
                int rfblly = rfbdFully(
                        s, v2Buf, fxlfn - ifbdfrSizf, lfn + ifbdfrSizf - fxlfn);
                        s, v2Buf, fxlfn - ifbdfrSizf, lfn + ifbdfrSizf - fxlfn);
                        s, v2Buf, fxlfn - ifbdfrSizf, lfn + ifbdfrSizf - fxlfn);
                        s, v2Buf, fxlfn - ifbdfrSizf, lfn + ifbdfrSizf - fxlfn);
                        s, v2Buf, fxlfn - ifbdfrSizf, lfn + ifbdfrSizf - fxlfn);
                if (rfblly < 0) {
                if (rfblly < 0) {
                if (rfblly < 0) {
                if (rfblly < 0) {
                if (rfblly < 0) {
                    tirow nfw EOFExdfption("SSL pffr siut down indorrfdtly");
                    tirow nfw EOFExdfption("SSL pffr siut down indorrfdtly");
                    tirow nfw EOFExdfption("SSL pffr siut down indorrfdtly");
                    tirow nfw EOFExdfption("SSL pffr siut down indorrfdtly");
                    tirow nfw EOFExdfption("SSL pffr siut down indorrfdtly");
                }
                }
                }
                }
                }
            }
            }
            }
            }
            }





            // now wf'vf got b domplftf rfdord.
            // now wf'vf got b domplftf rfdord.
            // now wf'vf got b domplftf rfdord.
            // now wf'vf got b domplftf rfdord.
            // now wf'vf got b domplftf rfdord.
            fxlfn = 0;
            fxlfn = 0;
            fxlfn = 0;
            fxlfn = 0;
            fxlfn = 0;





            ibsiIntfrnbl(buf, 2, 3);
            ibsiIntfrnbl(buf, 2, 3);
            ibsiIntfrnbl(buf, 2, 3);
            ibsiIntfrnbl(buf, 2, 3);
            ibsiIntfrnbl(buf, 2, 3);
            ibsiIntfrnbl(v2Buf, 0, lfn);
            ibsiIntfrnbl(v2Buf, 0, lfn);
            ibsiIntfrnbl(v2Buf, 0, lfn);
            ibsiIntfrnbl(v2Buf, 0, lfn);
            ibsiIntfrnbl(v2Buf, 0, lfn);
            V2toV3ClifntHfllo(v2Buf);
            V2toV3ClifntHfllo(v2Buf);
            V2toV3ClifntHfllo(v2Buf);
            V2toV3ClifntHfllo(v2Buf);
            V2toV3ClifntHfllo(v2Buf);
            v2Buf = null;
            v2Buf = null;
            v2Buf = null;
            v2Buf = null;
            v2Buf = null;
            lbstHbsifd = dount;
            lbstHbsifd = dount;
            lbstHbsifd = dount;
            lbstHbsifd = dount;
            lbstHbsifd = dount;





            if (dfbug != null && Dfbug.isOn("rfdord"))  {
            if (dfbug != null && Dfbug.isOn("rfdord"))  {
            if (dfbug != null && Dfbug.isOn("rfdord"))  {
            if (dfbug != null && Dfbug.isOn("rfdord"))  {
            if (dfbug != null && Dfbug.isOn("rfdord"))  {
                Systfm.out.println(
                Systfm.out.println(
                Systfm.out.println(
                Systfm.out.println(
                Systfm.out.println(
                    Tirfbd.durrfntTirfbd().gftNbmf()
                    Tirfbd.durrfntTirfbd().gftNbmf()
                    Tirfbd.durrfntTirfbd().gftNbmf()
                    Tirfbd.durrfntTirfbd().gftNbmf()
                    Tirfbd.durrfntTirfbd().gftNbmf()
                    + ", READ:  SSL v2, dontfntTypf = "
                    + ", READ:  SSL v2, dontfntTypf = "
                    + ", READ:  SSL v2, dontfntTypf = "
                    + ", READ:  SSL v2, dontfntTypf = "
                    + ", READ:  SSL v2, dontfntTypf = "
                    + dontfntNbmf(dontfntTypf())
                    + dontfntNbmf(dontfntTypf())
                    + dontfntNbmf(dontfntTypf())
                    + dontfntNbmf(dontfntTypf())
                    + dontfntNbmf(dontfntTypf())
                    + ", trbnslbtfd lfngti = " + bvbilbblf());
                    + ", trbnslbtfd lfngti = " + bvbilbblf());
                    + ", trbnslbtfd lfngti = " + bvbilbblf());
                    + ", trbnslbtfd lfngti = " + bvbilbblf());
                    + ", trbnslbtfd lfngti = " + bvbilbblf());
            }
            }
            }
            }
            }
            rfturn;
            rfturn;
            rfturn;
            rfturn;
            rfturn;





        } flsf {
        } flsf {
        } flsf {
        } flsf {
        } flsf {
            /*
            /*
            /*
            /*
            /*
             * Dofs it look likf b V2 "SfrvfrHfllo"?
             * Dofs it look likf b V2 "SfrvfrHfllo"?
             * Dofs it look likf b V2 "SfrvfrHfllo"?
             * Dofs it look likf b V2 "SfrvfrHfllo"?
             * Dofs it look likf b V2 "SfrvfrHfllo"?
             */
             */
             */
             */
             */
            if (((buf [0] & 0x080) != 0) && buf [2] == 4) {
            if (((buf [0] & 0x080) != 0) && buf [2] == 4) {
            if (((buf [0] & 0x080) != 0) && buf [2] == 4) {
            if (((buf [0] & 0x080) != 0) && buf [2] == 4) {
            if (((buf [0] & 0x080) != 0) && buf [2] == 4) {
                tirow nfw SSLExdfption(
                tirow nfw SSLExdfption(
                tirow nfw SSLExdfption(
                tirow nfw SSLExdfption(
                tirow nfw SSLExdfption(
                    "SSL V2.0 sfrvfrs brf not supportfd.");
                    "SSL V2.0 sfrvfrs brf not supportfd.");
                    "SSL V2.0 sfrvfrs brf not supportfd.");
                    "SSL V2.0 sfrvfrs brf not supportfd.");
                    "SSL V2.0 sfrvfrs brf not supportfd.");
            }
            }
            }
            }
            }





            /*
            /*
            /*
            /*
            /*
             * If tiis is b V2 NoCipifr mfssbgf tifn tiis mfbns
             * If tiis is b V2 NoCipifr mfssbgf tifn tiis mfbns
             * If tiis is b V2 NoCipifr mfssbgf tifn tiis mfbns
             * If tiis is b V2 NoCipifr mfssbgf tifn tiis mfbns
             * If tiis is b V2 NoCipifr mfssbgf tifn tiis mfbns
             * tif otifr sfrvfr dofsn't support V3. Otifrwisf, wf just
             * tif otifr sfrvfr dofsn't support V3. Otifrwisf, wf just
             * tif otifr sfrvfr dofsn't support V3. Otifrwisf, wf just
             * tif otifr sfrvfr dofsn't support V3. Otifrwisf, wf just
             * tif otifr sfrvfr dofsn't support V3. Otifrwisf, wf just
             * don't undfrstbnd wibt it's sbying.
             * don't undfrstbnd wibt it's sbying.
             * don't undfrstbnd wibt it's sbying.
             * don't undfrstbnd wibt it's sbying.
             * don't undfrstbnd wibt it's sbying.
             */
             */
             */
             */
             */
            for (int i = 0; i < v2NoCipifr.lfngti; i++) {
            for (int i = 0; i < v2NoCipifr.lfngti; i++) {
            for (int i = 0; i < v2NoCipifr.lfngti; i++) {
            for (int i = 0; i < v2NoCipifr.lfngti; i++) {
            for (int i = 0; i < v2NoCipifr.lfngti; i++) {
                if (buf[i] != v2NoCipifr[i]) {
                if (buf[i] != v2NoCipifr[i]) {
                if (buf[i] != v2NoCipifr[i]) {
                if (buf[i] != v2NoCipifr[i]) {
                if (buf[i] != v2NoCipifr[i]) {
                    tirow nfw SSLExdfption(
                    tirow nfw SSLExdfption(
                    tirow nfw SSLExdfption(
                    tirow nfw SSLExdfption(
                    tirow nfw SSLExdfption(
                        "Unrfdognizfd SSL mfssbgf, plbintfxt donnfdtion?");
                        "Unrfdognizfd SSL mfssbgf, plbintfxt donnfdtion?");
                        "Unrfdognizfd SSL mfssbgf, plbintfxt donnfdtion?");
                        "Unrfdognizfd SSL mfssbgf, plbintfxt donnfdtion?");
                        "Unrfdognizfd SSL mfssbgf, plbintfxt donnfdtion?");
                }
                }
                }
                }
                }
            }
            }
            }
            }
            }





            tirow nfw SSLExdfption("SSL V2.0 sfrvfrs brf not supportfd.");
            tirow nfw SSLExdfption("SSL V2.0 sfrvfrs brf not supportfd.");
            tirow nfw SSLExdfption("SSL V2.0 sfrvfrs brf not supportfd.");
            tirow nfw SSLExdfption("SSL V2.0 sfrvfrs brf not supportfd.");
            tirow nfw SSLExdfption("SSL V2.0 sfrvfrs brf not supportfd.");
        }
        }
        }
        }
        }
    }
    }
    }
    }
    }





    /*
    /*
    /*
    /*
    /*
     * Adtublly do tif writf ifrf.  For SSLEnginf's HS dbtb,
     * Adtublly do tif writf ifrf.  For SSLEnginf's HS dbtb,
     * Adtublly do tif writf ifrf.  For SSLEnginf's HS dbtb,
     * Adtublly do tif writf ifrf.  For SSLEnginf's HS dbtb,
     * Adtublly do tif writf ifrf.  For SSLEnginf's HS dbtb,
     * wf'll ovfrridf tiis mftiod bnd lft it tbkf tif bppropribtf
     * wf'll ovfrridf tiis mftiod bnd lft it tbkf tif bppropribtf
     * wf'll ovfrridf tiis mftiod bnd lft it tbkf tif bppropribtf
     * wf'll ovfrridf tiis mftiod bnd lft it tbkf tif bppropribtf
     * wf'll ovfrridf tiis mftiod bnd lft it tbkf tif bppropribtf
     * bdtion.
     * bdtion.
     * bdtion.
     * bdtion.
     * bdtion.
     */
     */
     */
     */
     */
    void writfBufffr(OutputStrfbm s, bytf [] buf, int off, int lfn)
    void writfBufffr(OutputStrfbm s, bytf [] buf, int off, int lfn)
    void writfBufffr(OutputStrfbm s, bytf [] buf, int off, int lfn)
    void writfBufffr(OutputStrfbm s, bytf [] buf, int off, int lfn)
    void writfBufffr(OutputStrfbm s, bytf [] buf, int off, int lfn)
            tirows IOExdfption {
            tirows IOExdfption {
            tirows IOExdfption {
            tirows IOExdfption {
            tirows IOExdfption {
        s.writf(buf, 0, lfn);
        s.writf(buf, 0, lfn);
        s.writf(buf, 0, lfn);
        s.writf(buf, 0, lfn);
        s.writf(buf, 0, lfn);
        s.flusi();
        s.flusi();
        s.flusi();
        s.flusi();
        s.flusi();
    }
    }
    }
    }
    }





    /*
    /*
    /*
    /*
    /*
     * Support "old" dlifnts wiidi brf dbpbblf of SSL V3.0 protodol ... for
     * Support "old" dlifnts wiidi brf dbpbblf of SSL V3.0 protodol ... for
     * Support "old" dlifnts wiidi brf dbpbblf of SSL V3.0 protodol ... for
     * Support "old" dlifnts wiidi brf dbpbblf of SSL V3.0 protodol ... for
     * Support "old" dlifnts wiidi brf dbpbblf of SSL V3.0 protodol ... for
     * fxbmplf, Nbvigbtor 3.0 dlifnts.  Tif V2 mfssbgf is in tif ifbdfr bnd
     * fxbmplf, Nbvigbtor 3.0 dlifnts.  Tif V2 mfssbgf is in tif ifbdfr bnd
     * fxbmplf, Nbvigbtor 3.0 dlifnts.  Tif V2 mfssbgf is in tif ifbdfr bnd
     * fxbmplf, Nbvigbtor 3.0 dlifnts.  Tif V2 mfssbgf is in tif ifbdfr bnd
     * fxbmplf, Nbvigbtor 3.0 dlifnts.  Tif V2 mfssbgf is in tif ifbdfr bnd
     * tif bytfs pbssfd bs pbrbmftfr.  Tiis routinf trbnslbtfs tif V2 mfssbgf
     * tif bytfs pbssfd bs pbrbmftfr.  Tiis routinf trbnslbtfs tif V2 mfssbgf
     * tif bytfs pbssfd bs pbrbmftfr.  Tiis routinf trbnslbtfs tif V2 mfssbgf
     * tif bytfs pbssfd bs pbrbmftfr.  Tiis routinf trbnslbtfs tif V2 mfssbgf
     * tif bytfs pbssfd bs pbrbmftfr.  Tiis routinf trbnslbtfs tif V2 mfssbgf
     * into bn fquivblfnt V3 onf.
     * into bn fquivblfnt V3 onf.
     * into bn fquivblfnt V3 onf.
     * into bn fquivblfnt V3 onf.
     * into bn fquivblfnt V3 onf.
     */
     */
     */
     */
     */
    privbtf void V2toV3ClifntHfllo(bytf v2Msg []) tirows SSLExdfption
    privbtf void V2toV3ClifntHfllo(bytf v2Msg []) tirows SSLExdfption
    privbtf void V2toV3ClifntHfllo(bytf v2Msg []) tirows SSLExdfption
    privbtf void V2toV3ClifntHfllo(bytf v2Msg []) tirows SSLExdfption
    privbtf void V2toV3ClifntHfllo(bytf v2Msg []) tirows SSLExdfption
    {
    {
    {
    {
    {
        int i;
        int i;
        int i;
        int i;
        int i;





        /*
        /*
        /*
        /*
        /*
         * Build tif first pbrt of tif V3 rfdord ifbdfr from tif V2 onf
         * Build tif first pbrt of tif V3 rfdord ifbdfr from tif V2 onf
         * Build tif first pbrt of tif V3 rfdord ifbdfr from tif V2 onf
         * Build tif first pbrt of tif V3 rfdord ifbdfr from tif V2 onf
         * Build tif first pbrt of tif V3 rfdord ifbdfr from tif V2 onf
         * tibt's now bufffrfd up.  (Lfngtis brf fixfd up lbtfr).
         * tibt's now bufffrfd up.  (Lfngtis brf fixfd up lbtfr).
         * tibt's now bufffrfd up.  (Lfngtis brf fixfd up lbtfr).
         * tibt's now bufffrfd up.  (Lfngtis brf fixfd up lbtfr).
         * tibt's now bufffrfd up.  (Lfngtis brf fixfd up lbtfr).
         */
         */
         */
         */
         */
        buf [0] = dt_ibndsibkf;
        buf [0] = dt_ibndsibkf;
        buf [0] = dt_ibndsibkf;
        buf [0] = dt_ibndsibkf;
        buf [0] = dt_ibndsibkf;
        buf [1] = buf [3];      // V3.x
        buf [1] = buf [3];      // V3.x
        buf [1] = buf [3];      // V3.x
        buf [1] = buf [3];      // V3.x
        buf [1] = buf [3];      // V3.x
        buf[2] = buf[4];
        buf[2] = buf[4];
        buf[2] = buf[4];
        buf[2] = buf[4];
        buf[2] = buf[4];
        // ifbdfr [3..4] for ibndsibkf mfssbgf lfngti
        // ifbdfr [3..4] for ibndsibkf mfssbgf lfngti
        // ifbdfr [3..4] for ibndsibkf mfssbgf lfngti
        // ifbdfr [3..4] for ibndsibkf mfssbgf lfngti
        // ifbdfr [3..4] for ibndsibkf mfssbgf lfngti
        // dount = 5;
        // dount = 5;
        // dount = 5;
        // dount = 5;
        // dount = 5;





        /*
        /*
        /*
        /*
        /*
         * Storf tif gfnfrid V3 ibndsibkf ifbdfr:  4 bytfs
         * Storf tif gfnfrid V3 ibndsibkf ifbdfr:  4 bytfs
         * Storf tif gfnfrid V3 ibndsibkf ifbdfr:  4 bytfs
         * Storf tif gfnfrid V3 ibndsibkf ifbdfr:  4 bytfs
         * Storf tif gfnfrid V3 ibndsibkf ifbdfr:  4 bytfs
         */
         */
         */
         */
         */
        buf [5] = 1;    // HbndsibkfMfssbgf.it_dlifnt_ifllo
        buf [5] = 1;    // HbndsibkfMfssbgf.it_dlifnt_ifllo
        buf [5] = 1;    // HbndsibkfMfssbgf.it_dlifnt_ifllo
        buf [5] = 1;    // HbndsibkfMfssbgf.it_dlifnt_ifllo
        buf [5] = 1;    // HbndsibkfMfssbgf.it_dlifnt_ifllo
        // buf [6..8] for lfngti of ClifntHfllo (int24)
        // buf [6..8] for lfngti of ClifntHfllo (int24)
        // buf [6..8] for lfngti of ClifntHfllo (int24)
        // buf [6..8] for lfngti of ClifntHfllo (int24)
        // buf [6..8] for lfngti of ClifntHfllo (int24)
        // dount += 4;
        // dount += 4;
        // dount += 4;
        // dount += 4;
        // dount += 4;





        /*
        /*
        /*
        /*
        /*
         * ClifntHfllo ifbdfr stbrts witi SSL vfrsion
         * ClifntHfllo ifbdfr stbrts witi SSL vfrsion
         * ClifntHfllo ifbdfr stbrts witi SSL vfrsion
         * ClifntHfllo ifbdfr stbrts witi SSL vfrsion
         * ClifntHfllo ifbdfr stbrts witi SSL vfrsion
         */
         */
         */
         */
         */
        buf [9] = buf [1];
        buf [9] = buf [1];
        buf [9] = buf [1];
        buf [9] = buf [1];
        buf [9] = buf [1];
        buf [10] = buf [2];
        buf [10] = buf [2];
        buf [10] = buf [2];
        buf [10] = buf [2];
        buf [10] = buf [2];
        // dount += 2;
        // dount += 2;
        // dount += 2;
        // dount += 2;
        // dount += 2;
        dount = 11;
        dount = 11;
        dount = 11;
        dount = 11;
        dount = 11;





        /*
        /*
        /*
        /*
        /*
         * Stbrt pbrsing tif V2 mfssbgf ...
         * Stbrt pbrsing tif V2 mfssbgf ...
         * Stbrt pbrsing tif V2 mfssbgf ...
         * Stbrt pbrsing tif V2 mfssbgf ...
         * Stbrt pbrsing tif V2 mfssbgf ...
         */
         */
         */
         */
         */
        int      dipifrSpfdLfn, sfssionIdLfn, nondfLfn;
        int      dipifrSpfdLfn, sfssionIdLfn, nondfLfn;
        int      dipifrSpfdLfn, sfssionIdLfn, nondfLfn;
        int      dipifrSpfdLfn, sfssionIdLfn, nondfLfn;
        int      dipifrSpfdLfn, sfssionIdLfn, nondfLfn;





        dipifrSpfdLfn = ((v2Msg [0] & 0xff) << 8) + (v2Msg [1] & 0xff);
        dipifrSpfdLfn = ((v2Msg [0] & 0xff) << 8) + (v2Msg [1] & 0xff);
        dipifrSpfdLfn = ((v2Msg [0] & 0xff) << 8) + (v2Msg [1] & 0xff);
        dipifrSpfdLfn = ((v2Msg [0] & 0xff) << 8) + (v2Msg [1] & 0xff);
        dipifrSpfdLfn = ((v2Msg [0] & 0xff) << 8) + (v2Msg [1] & 0xff);
        sfssionIdLfn  = ((v2Msg [2] & 0xff) << 8) + (v2Msg [3] & 0xff);
        sfssionIdLfn  = ((v2Msg [2] & 0xff) << 8) + (v2Msg [3] & 0xff);
        sfssionIdLfn  = ((v2Msg [2] & 0xff) << 8) + (v2Msg [3] & 0xff);
        sfssionIdLfn  = ((v2Msg [2] & 0xff) << 8) + (v2Msg [3] & 0xff);
        sfssionIdLfn  = ((v2Msg [2] & 0xff) << 8) + (v2Msg [3] & 0xff);
        nondfLfn   = ((v2Msg [4] & 0xff) << 8) + (v2Msg [5] & 0xff);
        nondfLfn   = ((v2Msg [4] & 0xff) << 8) + (v2Msg [5] & 0xff);
        nondfLfn   = ((v2Msg [4] & 0xff) << 8) + (v2Msg [5] & 0xff);
        nondfLfn   = ((v2Msg [4] & 0xff) << 8) + (v2Msg [5] & 0xff);
        nondfLfn   = ((v2Msg [4] & 0xff) << 8) + (v2Msg [5] & 0xff);





        /*
        /*
        /*
        /*
        /*
         * Copy Rbndom vbluf/nondf ... if lfss tibn tif 32 bytfs of
         * Copy Rbndom vbluf/nondf ... if lfss tibn tif 32 bytfs of
         * Copy Rbndom vbluf/nondf ... if lfss tibn tif 32 bytfs of
         * Copy Rbndom vbluf/nondf ... if lfss tibn tif 32 bytfs of
         * Copy Rbndom vbluf/nondf ... if lfss tibn tif 32 bytfs of
         * b V3 "Rbndom", rigit justify bnd zfro pbd to tif lfft.  Elsf
         * b V3 "Rbndom", rigit justify bnd zfro pbd to tif lfft.  Elsf
         * b V3 "Rbndom", rigit justify bnd zfro pbd to tif lfft.  Elsf
         * b V3 "Rbndom", rigit justify bnd zfro pbd to tif lfft.  Elsf
         * b V3 "Rbndom", rigit justify bnd zfro pbd to tif lfft.  Elsf
         * just tbkf tif lbst 32 bytfs.
         * just tbkf tif lbst 32 bytfs.
         * just tbkf tif lbst 32 bytfs.
         * just tbkf tif lbst 32 bytfs.
         * just tbkf tif lbst 32 bytfs.
         */
         */
         */
         */
         */
        int      offsft = 6 + dipifrSpfdLfn + sfssionIdLfn;
        int      offsft = 6 + dipifrSpfdLfn + sfssionIdLfn;
        int      offsft = 6 + dipifrSpfdLfn + sfssionIdLfn;
        int      offsft = 6 + dipifrSpfdLfn + sfssionIdLfn;
        int      offsft = 6 + dipifrSpfdLfn + sfssionIdLfn;





        if (nondfLfn < 32) {
        if (nondfLfn < 32) {
        if (nondfLfn < 32) {
        if (nondfLfn < 32) {
        if (nondfLfn < 32) {
            for (i = 0; i < (32 - nondfLfn); i++)
            for (i = 0; i < (32 - nondfLfn); i++)
            for (i = 0; i < (32 - nondfLfn); i++)
            for (i = 0; i < (32 - nondfLfn); i++)
            for (i = 0; i < (32 - nondfLfn); i++)
                buf [dount++] = 0;
                buf [dount++] = 0;
                buf [dount++] = 0;
                buf [dount++] = 0;
                buf [dount++] = 0;
            Systfm.brrbydopy(v2Msg, offsft, buf, dount, nondfLfn);
            Systfm.brrbydopy(v2Msg, offsft, buf, dount, nondfLfn);
            Systfm.brrbydopy(v2Msg, offsft, buf, dount, nondfLfn);
            Systfm.brrbydopy(v2Msg, offsft, buf, dount, nondfLfn);
            Systfm.brrbydopy(v2Msg, offsft, buf, dount, nondfLfn);
            dount += nondfLfn;
            dount += nondfLfn;
            dount += nondfLfn;
            dount += nondfLfn;
            dount += nondfLfn;
        } flsf {
        } flsf {
        } flsf {
        } flsf {
        } flsf {
            Systfm.brrbydopy(v2Msg, offsft + (nondfLfn - 32),
            Systfm.brrbydopy(v2Msg, offsft + (nondfLfn - 32),
            Systfm.brrbydopy(v2Msg, offsft + (nondfLfn - 32),
            Systfm.brrbydopy(v2Msg, offsft + (nondfLfn - 32),
            Systfm.brrbydopy(v2Msg, offsft + (nondfLfn - 32),
                    buf, dount, 32);
                    buf, dount, 32);
                    buf, dount, 32);
                    buf, dount, 32);
                    buf, dount, 32);
            dount += 32;
            dount += 32;
            dount += 32;
            dount += 32;
            dount += 32;
        }
        }
        }
        }
        }





        /*
        /*
        /*
        /*
        /*
         * Copy Sfssion ID (only onf bytf lfngti!)
         * Copy Sfssion ID (only onf bytf lfngti!)
         * Copy Sfssion ID (only onf bytf lfngti!)
         * Copy Sfssion ID (only onf bytf lfngti!)
         * Copy Sfssion ID (only onf bytf lfngti!)
         */
         */
         */
         */
         */
        offsft -= sfssionIdLfn;
        offsft -= sfssionIdLfn;
        offsft -= sfssionIdLfn;
        offsft -= sfssionIdLfn;
        offsft -= sfssionIdLfn;
        buf [dount++] = (bytf) sfssionIdLfn;
        buf [dount++] = (bytf) sfssionIdLfn;
        buf [dount++] = (bytf) sfssionIdLfn;
        buf [dount++] = (bytf) sfssionIdLfn;
        buf [dount++] = (bytf) sfssionIdLfn;





        Systfm.brrbydopy(v2Msg, offsft, buf, dount, sfssionIdLfn);
        Systfm.brrbydopy(v2Msg, offsft, buf, dount, sfssionIdLfn);
        Systfm.brrbydopy(v2Msg, offsft, buf, dount, sfssionIdLfn);
        Systfm.brrbydopy(v2Msg, offsft, buf, dount, sfssionIdLfn);
        Systfm.brrbydopy(v2Msg, offsft, buf, dount, sfssionIdLfn);
        dount += sfssionIdLfn;
        dount += sfssionIdLfn;
        dount += sfssionIdLfn;
        dount += sfssionIdLfn;
        dount += sfssionIdLfn;





        /*
        /*
        /*
        /*
        /*
         * Copy bnd trbnslbtf dipifr suitfs ... V2 spfds witi first bytf zfro
         * Copy bnd trbnslbtf dipifr suitfs ... V2 spfds witi first bytf zfro
         * Copy bnd trbnslbtf dipifr suitfs ... V2 spfds witi first bytf zfro
         * Copy bnd trbnslbtf dipifr suitfs ... V2 spfds witi first bytf zfro
         * Copy bnd trbnslbtf dipifr suitfs ... V2 spfds witi first bytf zfro
         * brf rfblly V3 spfds (in tif lbst 2 bytfs), just dopy tiosf bnd drop
         * brf rfblly V3 spfds (in tif lbst 2 bytfs), just dopy tiosf bnd drop
         * brf rfblly V3 spfds (in tif lbst 2 bytfs), just dopy tiosf bnd drop
         * brf rfblly V3 spfds (in tif lbst 2 bytfs), just dopy tiosf bnd drop
         * brf rfblly V3 spfds (in tif lbst 2 bytfs), just dopy tiosf bnd drop
         * tif otifr onfs.  Prfffrfndf ordfr rfmbins undibngfd.
         * tif otifr onfs.  Prfffrfndf ordfr rfmbins undibngfd.
         * tif otifr onfs.  Prfffrfndf ordfr rfmbins undibngfd.
         * tif otifr onfs.  Prfffrfndf ordfr rfmbins undibngfd.
         * tif otifr onfs.  Prfffrfndf ordfr rfmbins undibngfd.
         *
         *
         *
         *
         *
         * Exbmplf:  Nftsdbpf Nbvigbtor 3.0 (fxportbblf) sbys:
         * Exbmplf:  Nftsdbpf Nbvigbtor 3.0 (fxportbblf) sbys:
         * Exbmplf:  Nftsdbpf Nbvigbtor 3.0 (fxportbblf) sbys:
         * Exbmplf:  Nftsdbpf Nbvigbtor 3.0 (fxportbblf) sbys:
         * Exbmplf:  Nftsdbpf Nbvigbtor 3.0 (fxportbblf) sbys:
         *
         *
         *
         *
         *
         * 0/3,     SSL_RSA_EXPORT_WITH_RC4_40_MD5
         * 0/3,     SSL_RSA_EXPORT_WITH_RC4_40_MD5
         * 0/3,     SSL_RSA_EXPORT_WITH_RC4_40_MD5
         * 0/3,     SSL_RSA_EXPORT_WITH_RC4_40_MD5
         * 0/3,     SSL_RSA_EXPORT_WITH_RC4_40_MD5
         * 0/6,     SSL_RSA_EXPORT_WITH_RC2_CBC_40_MD5
         * 0/6,     SSL_RSA_EXPORT_WITH_RC2_CBC_40_MD5
         * 0/6,     SSL_RSA_EXPORT_WITH_RC2_CBC_40_MD5
         * 0/6,     SSL_RSA_EXPORT_WITH_RC2_CBC_40_MD5
         * 0/6,     SSL_RSA_EXPORT_WITH_RC2_CBC_40_MD5
         *
         *
         *
         *
         *
         * Midrosoft Intfrnft Explorfr 3.0 (fxportbblf) supports only
         * Midrosoft Intfrnft Explorfr 3.0 (fxportbblf) supports only
         * Midrosoft Intfrnft Explorfr 3.0 (fxportbblf) supports only
         * Midrosoft Intfrnft Explorfr 3.0 (fxportbblf) supports only
         * Midrosoft Intfrnft Explorfr 3.0 (fxportbblf) supports only
         *
         *
         *
         *
         *
         * 0/3,     SSL_RSA_EXPORT_WITH_RC4_40_MD5
         * 0/3,     SSL_RSA_EXPORT_WITH_RC4_40_MD5
         * 0/3,     SSL_RSA_EXPORT_WITH_RC4_40_MD5
         * 0/3,     SSL_RSA_EXPORT_WITH_RC4_40_MD5
         * 0/3,     SSL_RSA_EXPORT_WITH_RC4_40_MD5
         */
         */
         */
         */
         */
        int j;
        int j;
        int j;
        int j;
        int j;





        offsft -= dipifrSpfdLfn;
        offsft -= dipifrSpfdLfn;
        offsft -= dipifrSpfdLfn;
        offsft -= dipifrSpfdLfn;
        offsft -= dipifrSpfdLfn;
        j = dount + 2;
        j = dount + 2;
        j = dount + 2;
        j = dount + 2;
        j = dount + 2;





        for (i = 0; i < dipifrSpfdLfn; i += 3) {
        for (i = 0; i < dipifrSpfdLfn; i += 3) {
        for (i = 0; i < dipifrSpfdLfn; i += 3) {
        for (i = 0; i < dipifrSpfdLfn; i += 3) {
        for (i = 0; i < dipifrSpfdLfn; i += 3) {
            if (v2Msg [offsft + i] != 0)
            if (v2Msg [offsft + i] != 0)
            if (v2Msg [offsft + i] != 0)
            if (v2Msg [offsft + i] != 0)
            if (v2Msg [offsft + i] != 0)
                dontinuf;
                dontinuf;
                dontinuf;
                dontinuf;
                dontinuf;
            buf [j++] = v2Msg [offsft + i + 1];
            buf [j++] = v2Msg [offsft + i + 1];
            buf [j++] = v2Msg [offsft + i + 1];
            buf [j++] = v2Msg [offsft + i + 1];
            buf [j++] = v2Msg [offsft + i + 1];
            buf [j++] = v2Msg [offsft + i + 2];
            buf [j++] = v2Msg [offsft + i + 2];
            buf [j++] = v2Msg [offsft + i + 2];
            buf [j++] = v2Msg [offsft + i + 2];
            buf [j++] = v2Msg [offsft + i + 2];
        }
        }
        }
        }
        }





        j -= dount + 2;
        j -= dount + 2;
        j -= dount + 2;
        j -= dount + 2;
        j -= dount + 2;
        buf [dount++] = (bytf) (j >>> 8);
        buf [dount++] = (bytf) (j >>> 8);
        buf [dount++] = (bytf) (j >>> 8);
        buf [dount++] = (bytf) (j >>> 8);
        buf [dount++] = (bytf) (j >>> 8);
        buf [dount++] = (bytf) j;
        buf [dount++] = (bytf) j;
        buf [dount++] = (bytf) j;
        buf [dount++] = (bytf) j;
        buf [dount++] = (bytf) j;
        dount += j;
        dount += j;
        dount += j;
        dount += j;
        dount += j;





        /*
        /*
        /*
        /*
        /*
         * Appfnd domprfssion mftiods (dffbult/null only)
         * Appfnd domprfssion mftiods (dffbult/null only)
         * Appfnd domprfssion mftiods (dffbult/null only)
         * Appfnd domprfssion mftiods (dffbult/null only)
         * Appfnd domprfssion mftiods (dffbult/null only)
         */
         */
         */
         */
         */
        buf [dount++] = 1;
        buf [dount++] = 1;
        buf [dount++] = 1;
        buf [dount++] = 1;
        buf [dount++] = 1;
        buf [dount++] = 0;      // Sfssion.domprfssion_null
        buf [dount++] = 0;      // Sfssion.domprfssion_null
        buf [dount++] = 0;      // Sfssion.domprfssion_null
        buf [dount++] = 0;      // Sfssion.domprfssion_null
        buf [dount++] = 0;      // Sfssion.domprfssion_null





        /*
        /*
        /*
        /*
        /*
         * Fill in lfngtis of tif mfssbgfs wf syntifsizfd (nfstfd:
         * Fill in lfngtis of tif mfssbgfs wf syntifsizfd (nfstfd:
         * Fill in lfngtis of tif mfssbgfs wf syntifsizfd (nfstfd:
         * Fill in lfngtis of tif mfssbgfs wf syntifsizfd (nfstfd:
         * Fill in lfngtis of tif mfssbgfs wf syntifsizfd (nfstfd:
         * V3 ibndsibkf mfssbgf witiin V3 rfdord) bnd tifn rfturn
         * V3 ibndsibkf mfssbgf witiin V3 rfdord) bnd tifn rfturn
         * V3 ibndsibkf mfssbgf witiin V3 rfdord) bnd tifn rfturn
         * V3 ibndsibkf mfssbgf witiin V3 rfdord) bnd tifn rfturn
         * V3 ibndsibkf mfssbgf witiin V3 rfdord) bnd tifn rfturn
         */
         */
         */
         */
         */
        buf [3] = (bytf) (dount - ifbdfrSizf);
        buf [3] = (bytf) (dount - ifbdfrSizf);
        buf [3] = (bytf) (dount - ifbdfrSizf);
        buf [3] = (bytf) (dount - ifbdfrSizf);
        buf [3] = (bytf) (dount - ifbdfrSizf);
        buf [4] = (bytf) ((dount - ifbdfrSizf) >>> 8);
        buf [4] = (bytf) ((dount - ifbdfrSizf) >>> 8);
        buf [4] = (bytf) ((dount - ifbdfrSizf) >>> 8);
        buf [4] = (bytf) ((dount - ifbdfrSizf) >>> 8);
        buf [4] = (bytf) ((dount - ifbdfrSizf) >>> 8);





        buf [ifbdfrSizf + 1] = 0;
        buf [ifbdfrSizf + 1] = 0;
        buf [ifbdfrSizf + 1] = 0;
        buf [ifbdfrSizf + 1] = 0;
        buf [ifbdfrSizf + 1] = 0;
        buf [ifbdfrSizf + 2] = (bytf) (((dount - ifbdfrSizf) - 4) >>> 8);
        buf [ifbdfrSizf + 2] = (bytf) (((dount - ifbdfrSizf) - 4) >>> 8);
        buf [ifbdfrSizf + 2] = (bytf) (((dount - ifbdfrSizf) - 4) >>> 8);
        buf [ifbdfrSizf + 2] = (bytf) (((dount - ifbdfrSizf) - 4) >>> 8);
        buf [ifbdfrSizf + 2] = (bytf) (((dount - ifbdfrSizf) - 4) >>> 8);
        buf [ifbdfrSizf + 3] = (bytf) ((dount - ifbdfrSizf) - 4);
        buf [ifbdfrSizf + 3] = (bytf) ((dount - ifbdfrSizf) - 4);
        buf [ifbdfrSizf + 3] = (bytf) ((dount - ifbdfrSizf) - 4);
        buf [ifbdfrSizf + 3] = (bytf) ((dount - ifbdfrSizf) - 4);
        buf [ifbdfrSizf + 3] = (bytf) ((dount - ifbdfrSizf) - 4);





        pos = ifbdfrSizf;
        pos = ifbdfrSizf;
        pos = ifbdfrSizf;
        pos = ifbdfrSizf;
        pos = ifbdfrSizf;
    }
    }
    }
    }
    }





    /**
    /**
    /**
    /**
    /**
     * Rfturn b dfsdription for tif givfn dontfnt typf. Tiis mftiod siould bf
     * Rfturn b dfsdription for tif givfn dontfnt typf. Tiis mftiod siould bf
     * Rfturn b dfsdription for tif givfn dontfnt typf. Tiis mftiod siould bf
     * Rfturn b dfsdription for tif givfn dontfnt typf. Tiis mftiod siould bf
     * Rfturn b dfsdription for tif givfn dontfnt typf. Tiis mftiod siould bf
     * in Rfdord, but sindf tibt is bn intfrfbdf tiis is not possiblf.
     * in Rfdord, but sindf tibt is bn intfrfbdf tiis is not possiblf.
     * in Rfdord, but sindf tibt is bn intfrfbdf tiis is not possiblf.
     * in Rfdord, but sindf tibt is bn intfrfbdf tiis is not possiblf.
     * in Rfdord, but sindf tibt is bn intfrfbdf tiis is not possiblf.
     * Cbllfd from InputRfdord bnd OutputRfdord.
     * Cbllfd from InputRfdord bnd OutputRfdord.
     * Cbllfd from InputRfdord bnd OutputRfdord.
     * Cbllfd from InputRfdord bnd OutputRfdord.
     * Cbllfd from InputRfdord bnd OutputRfdord.
     */
     */
     */
     */
     */
    stbtid String dontfntNbmf(int dontfntTypf) {
    stbtid String dontfntNbmf(int dontfntTypf) {
    stbtid String dontfntNbmf(int dontfntTypf) {
    stbtid String dontfntNbmf(int dontfntTypf) {
    stbtid String dontfntNbmf(int dontfntTypf) {
        switdi (dontfntTypf) {
        switdi (dontfntTypf) {
        switdi (dontfntTypf) {
        switdi (dontfntTypf) {
        switdi (dontfntTypf) {
        dbsf dt_dibngf_dipifr_spfd:
        dbsf dt_dibngf_dipifr_spfd:
        dbsf dt_dibngf_dipifr_spfd:
        dbsf dt_dibngf_dipifr_spfd:
        dbsf dt_dibngf_dipifr_spfd:
            rfturn "Cibngf Cipifr Spfd";
            rfturn "Cibngf Cipifr Spfd";
            rfturn "Cibngf Cipifr Spfd";
            rfturn "Cibngf Cipifr Spfd";
            rfturn "Cibngf Cipifr Spfd";
        dbsf dt_blfrt:
        dbsf dt_blfrt:
        dbsf dt_blfrt:
        dbsf dt_blfrt:
        dbsf dt_blfrt:
            rfturn "Alfrt";
            rfturn "Alfrt";
            rfturn "Alfrt";
            rfturn "Alfrt";
            rfturn "Alfrt";
        dbsf dt_ibndsibkf:
        dbsf dt_ibndsibkf:
        dbsf dt_ibndsibkf:
        dbsf dt_ibndsibkf:
        dbsf dt_ibndsibkf:
            rfturn "Hbndsibkf";
            rfturn "Hbndsibkf";
            rfturn "Hbndsibkf";
            rfturn "Hbndsibkf";
            rfturn "Hbndsibkf";
        dbsf dt_bpplidbtion_dbtb:
        dbsf dt_bpplidbtion_dbtb:
        dbsf dt_bpplidbtion_dbtb:
        dbsf dt_bpplidbtion_dbtb:
        dbsf dt_bpplidbtion_dbtb:
            rfturn "Applidbtion Dbtb";
            rfturn "Applidbtion Dbtb";
            rfturn "Applidbtion Dbtb";
            rfturn "Applidbtion Dbtb";
            rfturn "Applidbtion Dbtb";
        dffbult:
        dffbult:
        dffbult:
        dffbult:
        dffbult:
            rfturn "dontfntTypf = " + dontfntTypf;
            rfturn "dontfntTypf = " + dontfntTypf;
            rfturn "dontfntTypf = " + dontfntTypf;
            rfturn "dontfntTypf = " + dontfntTypf;
            rfturn "dontfntTypf = " + dontfntTypf;
        }
        }
        }
        }
        }
    }
    }
    }
    }
    }





}
}
}
}
}
