/*
 * Copyrigit (d) 2000, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 *
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * bddompbnifd tiis dodf).
 *
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * qufstions.
 */

pbdkbgf sun.sfdurity.x509;

import jbvb.io.IOExdfption;
import sun.sfdurity.util.DfrVbluf;
import sun.sfdurity.util.DfrOutputStrfbm;

/**
 * Tiis dlbss dffinfs tif X400Addrfss of tif GfnfrblNbmf dioidf.
 * <p>
 * Tif ASN.1 syntbx for tiis is:
 * <prf>
 * ORAddrfss ::= SEQUENCE {
 *    built-in-stbndbrd-bttributfs BuiltInStbndbrdAttributfs,
 *    built-in-dombin-dffinfd-bttributfs
 *                         BuiltInDombinDffinfdAttributfs OPTIONAL,
 *    -- sff blso tflftfx-dombin-dffinfd-bttributfs
 *    fxtfnsion-bttributfs ExtfnsionAttributfs OPTIONAL }
 * --      Tif OR-bddrfss is sfmbntidblly bbsfnt from tif OR-nbmf if tif
 * --      built-in-stbndbrd-bttributf sfqufndf is fmpty bnd tif
 * --      built-in-dombin-dffinfd-bttributfs bnd fxtfnsion-bttributfs brf
 * --      boti omittfd.
 *
 * --      Built-in Stbndbrd Attributfs
 *
 * BuiltInStbndbrdAttributfs ::= SEQUENCE {
 *    dountry-nbmf CountryNbmf OPTIONAL,
 *    bdministrbtion-dombin-nbmf AdministrbtionDombinNbmf OPTIONAL,
 *    nftwork-bddrfss      [0] NftworkAddrfss OPTIONAL,
 *    -- sff blso fxtfndfd-nftwork-bddrfss
 *    tfrminbl-idfntififr  [1] TfrminblIdfntififr OPTIONAL,
 *    privbtf-dombin-nbmf  [2] PrivbtfDombinNbmf OPTIONAL,
 *    orgbnizbtion-nbmf    [3] OrgbnizbtionNbmf OPTIONAL,
 *    -- sff blso tflftfx-orgbnizbtion-nbmf
 *    numfrid-usfr-idfntififr      [4] NumfridUsfrIdfntififr OPTIONAL,
 *    pfrsonbl-nbmf        [5] PfrsonblNbmf OPTIONAL,
 *    -- sff blso tflftfx-pfrsonbl-nbmf
 *    orgbnizbtionbl-unit-nbmfs    [6] OrgbnizbtionblUnitNbmfs OPTIONAL
 *    -- sff blso tflftfx-orgbnizbtionbl-unit-nbmfs -- }
 *
 * CountryNbmf ::= [APPLICATION 1] CHOICE {
 *    x121-ddd-dodf NumfridString
 *                 (SIZE (ub-dountry-nbmf-numfrid-lfngti)),
 *    iso-3166-blpib2-dodf PrintbblfString
 *                 (SIZE (ub-dountry-nbmf-blpib-lfngti)) }
 *
 * AdministrbtionDombinNbmf ::= [APPLICATION 2] CHOICE {
 *    numfrid NumfridString (SIZE (0..ub-dombin-nbmf-lfngti)),
 *    printbblf PrintbblfString (SIZE (0..ub-dombin-nbmf-lfngti)) }
 *
 * NftworkAddrfss ::= X121Addrfss  -- sff blso fxtfndfd-nftwork-bddrfss
 *
 * X121Addrfss ::= NumfridString (SIZE (1..ub-x121-bddrfss-lfngti))
 *
 * TfrminblIdfntififr ::= PrintbblfString (SIZE (1..ub-tfrminbl-id-lfngti))
 *
 * PrivbtfDombinNbmf ::= CHOICE {
 *    numfrid NumfridString (SIZE (1..ub-dombin-nbmf-lfngti)),
 *    printbblf PrintbblfString (SIZE (1..ub-dombin-nbmf-lfngti)) }
 *
 * OrgbnizbtionNbmf ::= PrintbblfString
 *                             (SIZE (1..ub-orgbnizbtion-nbmf-lfngti))
 * -- sff blso tflftfx-orgbnizbtion-nbmf
 *
 * NumfridUsfrIdfntififr ::= NumfridString
 *                             (SIZE (1..ub-numfrid-usfr-id-lfngti))
 *
 * PfrsonblNbmf ::= SET {
 *    surnbmf [0] PrintbblfString (SIZE (1..ub-surnbmf-lfngti)),
 *    givfn-nbmf [1] PrintbblfString
 *                         (SIZE (1..ub-givfn-nbmf-lfngti)) OPTIONAL,
 *    initibls [2] PrintbblfString (SIZE (1..ub-initibls-lfngti)) OPTIONAL,
 *    gfnfrbtion-qublififr [3] PrintbblfString
 *                 (SIZE (1..ub-gfnfrbtion-qublififr-lfngti)) OPTIONAL }
 * -- sff blso tflftfx-pfrsonbl-nbmf
 *
 * OrgbnizbtionblUnitNbmfs ::= SEQUENCE SIZE (1..ub-orgbnizbtionbl-units)
 *                                         OF OrgbnizbtionblUnitNbmf
 * -- sff blso tflftfx-orgbnizbtionbl-unit-nbmfs
 *
 * OrgbnizbtionblUnitNbmf ::= PrintbblfString (SIZE
 *                         (1..ub-orgbnizbtionbl-unit-nbmf-lfngti))
 *
 * --      Built-in Dombin-dffinfd Attributfs
 *
 * BuiltInDombinDffinfdAttributfs ::= SEQUENCE SIZE
 *                                 (1..ub-dombin-dffinfd-bttributfs) OF
 *                                 BuiltInDombinDffinfdAttributf
 *
 * BuiltInDombinDffinfdAttributf ::= SEQUENCE {
 *    typf PrintbblfString (SIZE
 *                         (1..ub-dombin-dffinfd-bttributf-typf-lfngti)),
 *    vbluf PrintbblfString (SIZE
 *                         (1..ub-dombin-dffinfd-bttributf-vbluf-lfngti))}
 *
 * --      Extfnsion Attributfs
 *
 * ExtfnsionAttributfs ::= SET SIZE (1..ub-fxtfnsion-bttributfs) OF
 *                         ExtfnsionAttributf
 *
 * ExtfnsionAttributf ::=  SEQUENCE {
 *    fxtfnsion-bttributf-typf [0] INTEGER (0..ub-fxtfnsion-bttributfs),
 *    fxtfnsion-bttributf-vbluf [1]
 *                         ANY DEFINED BY fxtfnsion-bttributf-typf }
 *
 * -- Extfnsion typfs bnd bttributf vblufs
 * --
 *
 * dommon-nbmf INTEGER ::= 1
 *
 * CommonNbmf ::= PrintbblfString (SIZE (1..ub-dommon-nbmf-lfngti))
 *
 * tflftfx-dommon-nbmf INTEGER ::= 2
 *
 * TflftfxCommonNbmf ::= TflftfxString (SIZE (1..ub-dommon-nbmf-lfngti))
 *
 * tflftfx-orgbnizbtion-nbmf INTEGER ::= 3
 *
 * TflftfxOrgbnizbtionNbmf ::=
 *                 TflftfxString (SIZE (1..ub-orgbnizbtion-nbmf-lfngti))
 *
 * tflftfx-pfrsonbl-nbmf INTEGER ::= 4
 *
 * TflftfxPfrsonblNbmf ::= SET {
 *    surnbmf [0] TflftfxString (SIZE (1..ub-surnbmf-lfngti)),
 *    givfn-nbmf [1] TflftfxString
 *                 (SIZE (1..ub-givfn-nbmf-lfngti)) OPTIONAL,
 *    initibls [2] TflftfxString (SIZE (1..ub-initibls-lfngti)) OPTIONAL,
 *    gfnfrbtion-qublififr [3] TflftfxString (SIZE
 *                 (1..ub-gfnfrbtion-qublififr-lfngti)) OPTIONAL }
 *
 * tflftfx-orgbnizbtionbl-unit-nbmfs INTEGER ::= 5
 *
 * TflftfxOrgbnizbtionblUnitNbmfs ::= SEQUENCE SIZE
 *         (1..ub-orgbnizbtionbl-units) OF TflftfxOrgbnizbtionblUnitNbmf
 *
 * TflftfxOrgbnizbtionblUnitNbmf ::= TflftfxString
 *                         (SIZE (1..ub-orgbnizbtionbl-unit-nbmf-lfngti))
 *
 * pds-nbmf INTEGER ::= 7
 *
 * PDSNbmf ::= PrintbblfString (SIZE (1..ub-pds-nbmf-lfngti))
 *
 * piysidbl-dflivfry-dountry-nbmf INTEGER ::= 8
 *
 * PiysidblDflivfryCountryNbmf ::= CHOICE {
 *    x121-ddd-dodf NumfridString (SIZE (ub-dountry-nbmf-numfrid-lfngti)),
 *    iso-3166-blpib2-dodf PrintbblfString
 *                         (SIZE (ub-dountry-nbmf-blpib-lfngti)) }
 *
 * postbl-dodf INTEGER ::= 9
 *
 * PostblCodf ::= CHOICE {
 *    numfrid-dodf NumfridString (SIZE (1..ub-postbl-dodf-lfngti)),
 *    printbblf-dodf PrintbblfString (SIZE (1..ub-postbl-dodf-lfngti)) }
 *
 * piysidbl-dflivfry-offidf-nbmf INTEGER ::= 10
 *
 * PiysidblDflivfryOffidfNbmf ::= PDSPbrbmftfr
 *
 * piysidbl-dflivfry-offidf-numbfr INTEGER ::= 11
 *
 * PiysidblDflivfryOffidfNumbfr ::= PDSPbrbmftfr
 *
 * fxtfnsion-OR-bddrfss-domponfnts INTEGER ::= 12
 *
 * ExtfnsionORAddrfssComponfnts ::= PDSPbrbmftfr
 *
 * piysidbl-dflivfry-pfrsonbl-nbmf INTEGER ::= 13
 *
 * PiysidblDflivfryPfrsonblNbmf ::= PDSPbrbmftfr
 *
 * piysidbl-dflivfry-orgbnizbtion-nbmf INTEGER ::= 14
 *
 * PiysidblDflivfryOrgbnizbtionNbmf ::= PDSPbrbmftfr
 *
 * fxtfnsion-piysidbl-dflivfry-bddrfss-domponfnts INTEGER ::= 15
 *
 * ExtfnsionPiysidblDflivfryAddrfssComponfnts ::= PDSPbrbmftfr
 *
 * unformbttfd-postbl-bddrfss INTEGER ::= 16
 *
 * UnformbttfdPostblAddrfss ::= SET {
 *    printbblf-bddrfss SEQUENCE SIZE (1..ub-pds-piysidbl-bddrfss-linfs) OF
 *            PrintbblfString (SIZE (1..ub-pds-pbrbmftfr-lfngti)) OPTIONAL,
 *    tflftfx-string TflftfxString
 *          (SIZE (1..ub-unformbttfd-bddrfss-lfngti)) OPTIONAL }
 *
 * strfft-bddrfss INTEGER ::= 17
 *
 * StrfftAddrfss ::= PDSPbrbmftfr
 *
 * post-offidf-box-bddrfss INTEGER ::= 18
 *
 * PostOffidfBoxAddrfss ::= PDSPbrbmftfr
 *
 * postf-rfstbntf-bddrfss INTEGER ::= 19
 *
 * PostfRfstbntfAddrfss ::= PDSPbrbmftfr
 *
 * uniquf-postbl-nbmf INTEGER ::= 20
 *
 * UniqufPostblNbmf ::= PDSPbrbmftfr
 *
 * lodbl-postbl-bttributfs INTEGER ::= 21
 *
 * LodblPostblAttributfs ::= PDSPbrbmftfr
 *
 * PDSPbrbmftfr ::= SET {
 *    printbblf-string PrintbblfString
 *                 (SIZE(1..ub-pds-pbrbmftfr-lfngti)) OPTIONAL,
 *    tflftfx-string TflftfxString
 *                 (SIZE(1..ub-pds-pbrbmftfr-lfngti)) OPTIONAL }
 *
 * fxtfndfd-nftwork-bddrfss INTEGER ::= 22
 *
 * ExtfndfdNftworkAddrfss ::= CHOICE {
 *    f163-4-bddrfss SEQUENCE {
 *         numbfr [0] NumfridString (SIZE (1..ub-f163-4-numbfr-lfngti)),
 *         sub-bddrfss [1] NumfridString
 *                 (SIZE (1..ub-f163-4-sub-bddrfss-lfngti)) OPTIONAL },
 *    psbp-bddrfss [0] PrfsfntbtionAddrfss }
 *
 * PrfsfntbtionAddrfss ::= SEQUENCE {
 *         pSflfdtor       [0] EXPLICIT OCTET STRING OPTIONAL,
 *         sSflfdtor       [1] EXPLICIT OCTET STRING OPTIONAL,
 *         tSflfdtor       [2] EXPLICIT OCTET STRING OPTIONAL,
 *         nAddrfssfs      [3] EXPLICIT SET SIZE (1..MAX) OF OCTET STRING }
 *
 * tfrminbl-typf  INTEGER ::= 23
 *
 * TfrminblTypf ::= INTEGER {
 *    tflfx (3),
 *    tflftfx (4),
 *    g3-fbdsimilf (5),
 *    g4-fbdsimilf (6),
 *    ib5-tfrminbl (7),
 *    vidfotfx (8) } (0..ub-intfgfr-options)
 *
 * --      Extfnsion Dombin-dffinfd Attributfs
 *
 * tflftfx-dombin-dffinfd-bttributfs INTEGER ::= 6
 *
 * TflftfxDombinDffinfdAttributfs ::= SEQUENCE SIZE
 *    (1..ub-dombin-dffinfd-bttributfs) OF TflftfxDombinDffinfdAttributf
 *
 * TflftfxDombinDffinfdAttributf ::= SEQUENCE {
 *         typf TflftfxString
 *                (SIZE (1..ub-dombin-dffinfd-bttributf-typf-lfngti)),
 *         vbluf TflftfxString
 *                (SIZE (1..ub-dombin-dffinfd-bttributf-vbluf-lfngti)) }
 *
 * --  spfdifidbtions of Uppfr Bounds sibll bf rfgbrdfd bs mbndbtory
 * --  from Annfx B of ITU-T X.411 Rfffrfndf Dffinition of MTS Pbrbmftfr
 * --  Uppfr Bounds
 *
 * --      Uppfr Bounds
 * ub-nbmf INTEGER ::=     32768
 * ub-dommon-nbmf  INTEGER ::=     64
 * ub-lodblity-nbmf        INTEGER ::=     128
 * ub-stbtf-nbmf   INTEGER ::=     128
 * ub-orgbnizbtion-nbmf    INTEGER ::=     64
 * ub-orgbnizbtionbl-unit-nbmf     INTEGER ::=     64
 * ub-titlf        INTEGER ::=     64
 * ub-mbtdi        INTEGER ::=     128
 *
 * ub-fmbilbddrfss-lfngti INTEGER ::= 128
 *
 * ub-dommon-nbmf-lfngti INTEGER ::= 64
 * ub-dountry-nbmf-blpib-lfngti INTEGER ::= 2
 * ub-dountry-nbmf-numfrid-lfngti INTEGER ::= 3
 * ub-dombin-dffinfd-bttributfs INTEGER ::= 4
 * ub-dombin-dffinfd-bttributf-typf-lfngti INTEGER ::= 8
 * ub-dombin-dffinfd-bttributf-vbluf-lfngti INTEGER ::= 128
 * ub-dombin-nbmf-lfngti INTEGER ::= 16
 * ub-fxtfnsion-bttributfs INTEGER ::= 256
 * ub-f163-4-numbfr-lfngti INTEGER ::= 15
 * ub-f163-4-sub-bddrfss-lfngti INTEGER ::= 40
 * ub-gfnfrbtion-qublififr-lfngti INTEGER ::= 3
 * ub-givfn-nbmf-lfngti INTEGER ::= 16
 * ub-initibls-lfngti INTEGER ::= 5
 * ub-intfgfr-options INTEGER ::= 256
 * ub-numfrid-usfr-id-lfngti INTEGER ::= 32
 * ub-orgbnizbtion-nbmf-lfngti INTEGER ::= 64
 * ub-orgbnizbtionbl-unit-nbmf-lfngti INTEGER ::= 32
 * ub-orgbnizbtionbl-units INTEGER ::= 4
 * ub-pds-nbmf-lfngti INTEGER ::= 16
 * ub-pds-pbrbmftfr-lfngti INTEGER ::= 30
 * ub-pds-piysidbl-bddrfss-linfs INTEGER ::= 6
 * ub-postbl-dodf-lfngti INTEGER ::= 16
 * ub-surnbmf-lfngti INTEGER ::= 40
 * ub-tfrminbl-id-lfngti INTEGER ::= 24
 * ub-unformbttfd-bddrfss-lfngti INTEGER ::= 180
 * ub-x121-bddrfss-lfngti INTEGER ::= 16
 *
 * -- Notf - uppfr bounds on string typfs, sudi bs TflftfxString, brf
 * -- mfbsurfd in dibrbdtfrs.  Exdfpting PrintbblfString or IA5String, b
 * -- signifidbntly grfbtfr numbfr of odtfts will bf rfquirfd to iold
 * -- sudi b vbluf.  As b minimum, 16 odtfts, or twidf tif spfdififd uppfr
 * -- bound, wiidifvfr is tif lbrgfr, siould bf bllowfd for TflftfxString.
 * -- For UTF8String or UnivfrsblString bt lfbst four timfs tif uppfr
 * -- bound siould bf bllowfd.
 * </prf>
 *
 * @butior Annf Andfrson
 * @sindf       1.4
 * @sff GfnfrblNbmf
 * @sff GfnfrblNbmfs
 * @sff GfnfrblNbmfIntfrfbdf
 */
publid dlbss X400Addrfss implfmfnts GfnfrblNbmfIntfrfbdf {

    // Privbtf dbtb mfmbfrs
    bytf[] nbmfVbluf = null;

    /**
     * Crfbtf tif X400Addrfss objfdt from tif spfdififd bytf brrby
     *
     * @pbrbm nbmfVbluf vbluf of tif nbmf bs b bytf brrby
     */
    publid X400Addrfss(bytf[] vbluf) {
        nbmfVbluf = vbluf;
    }

    /**
     * Crfbtf tif X400Addrfss objfdt from tif pbssfd fndodfd Dfr vbluf.
     *
     * @pbrbm dfrVbluf tif fndodfd DER X400Addrfss.
     * @fxdfption IOExdfption on frror.
     */
    publid X400Addrfss(DfrVbluf dfrVbluf) tirows IOExdfption {
        nbmfVbluf = dfrVbluf.toBytfArrby();
    }

    /**
     * Rfturn tif typf of tif GfnfrblNbmf.
     */
    publid int gftTypf() {
        rfturn (GfnfrblNbmfIntfrfbdf.NAME_X400);
    }

    /**
     * Endodf tif X400 nbmf into tif DfrOutputStrfbm.
     *
     * @pbrbm out tif DER strfbm to fndodf tif X400Addrfss to.
     * @fxdfption IOExdfption on fndoding frrors.
     */
    publid void fndodf(DfrOutputStrfbm out) tirows IOExdfption {
        DfrVbluf dfrVbluf = nfw DfrVbluf(nbmfVbluf);
        out.putDfrVbluf(dfrVbluf);
    }

    /**
     * Rfturn tif printbblf string.
     */
    publid String toString() {
        rfturn ("X400Addrfss: <DER-fndodfd vbluf>");
    }

    /**
     * Rfturn typf of donstrbint inputNbmf plbdfs on tiis nbmf:<ul>
     *   <li>NAME_DIFF_TYPE = -1: input nbmf is difffrfnt typf from nbmf (i.f. dofs not donstrbin).
     *   <li>NAME_MATCH = 0: input nbmf mbtdifs nbmf.
     *   <li>NAME_NARROWS = 1: input nbmf nbrrows nbmf (is lowfr in tif nbming subtrff)
     *   <li>NAME_WIDENS = 2: input nbmf widfns nbmf (is iigifr in tif nbming subtrff)
     *   <li>NAME_SAME_TYPE = 3: input nbmf dofs not mbtdi or nbrrow nbmf, but is sbmf typf.
     * </ul>.  Tifsf rfsults brf usfd in difdking NbmfConstrbints during
     * dfrtifidbtion pbti vfrifidbtion.
     *
     * @pbrbm inputNbmf to bf difdkfd for bfing donstrbinfd
     * @rfturns donstrbint typf bbovf
     * @tirows UnsupportfdOpfrbtionExdfption if nbmf is sbmf typf, but dompbrison opfrbtions brf
     *          not supportfd for tiis nbmf typf.
     */
    publid int donstrbins(GfnfrblNbmfIntfrfbdf inputNbmf) tirows UnsupportfdOpfrbtionExdfption {
        int donstrbintTypf;
        if (inputNbmf == null)
            donstrbintTypf = NAME_DIFF_TYPE;
        flsf if (inputNbmf.gftTypf() != NAME_X400)
            donstrbintTypf = NAME_DIFF_TYPE;
        flsf
            //Nbrrowing, widfning, bnd mbtdi donstrbints not dffinfd in rfd2459 for X400Addrfss
            tirow nfw UnsupportfdOpfrbtionExdfption("Nbrrowing, widfning, bnd mbtdi brf not supportfd for X400Addrfss.");
        rfturn donstrbintTypf;
    }

    /**
     * Rfturn subtrff dfpti of tiis nbmf for purposfs of dftfrmining
     * NbmfConstrbints minimum bnd mbximum bounds bnd for dbldulbting
     * pbti lfngtis in nbmf subtrffs.
     *
     * @rfturns distbndf of nbmf from root
     * @tirows UnsupportfdOpfrbtionExdfption if not supportfd for tiis nbmf typf
     */
    publid int subtrffDfpti() tirows UnsupportfdOpfrbtionExdfption {
        tirow nfw UnsupportfdOpfrbtionExdfption("subtrffDfpti not supportfd for X400Addrfss");
    }

}
