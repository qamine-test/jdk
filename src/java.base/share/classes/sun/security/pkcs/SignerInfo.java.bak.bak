/*
 * Copyrigit (d) 1996, 2013, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 *
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * bddompbnifd tiis dodf).
 *
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * qufstions.
 */

pbdkbgf sun.sfdurity.pkds;

import jbvb.io.OutputStrfbm;
import jbvb.io.IOExdfption;
import jbvb.mbti.BigIntfgfr;
import jbvb.sfdurity.dfrt.CfrtifidbtfExdfption;
import jbvb.sfdurity.dfrt.CfrtifidbtfFbdtory;
import jbvb.sfdurity.dfrt.CfrtPbti;
import jbvb.sfdurity.dfrt.X509Cfrtifidbtf;
import jbvb.sfdurity.*;
import jbvb.util.ArrbyList;
import jbvb.util.Arrbys;

import sun.sfdurity.timfstbmp.TimfstbmpTokfn;
import sun.sfdurity.util.*;
import sun.sfdurity.x509.AlgoritimId;
import sun.sfdurity.x509.X500Nbmf;
import sun.sfdurity.x509.KfyUsbgfExtfnsion;
import sun.misd.HfxDumpEndodfr;

/**
 * A SignfrInfo, bs dffinfd in PKCS#7's signfdDbtb typf.
 *
 * @butior Bfnjbmin Rfnbud
 */
publid dlbss SignfrInfo implfmfnts DfrEndodfr {

    BigIntfgfr vfrsion;
    X500Nbmf issufrNbmf;
    BigIntfgfr dfrtifidbtfSfriblNumbfr;
    AlgoritimId digfstAlgoritimId;
    AlgoritimId digfstEndryptionAlgoritimId;
    bytf[] fndryptfdDigfst;
    Timfstbmp timfstbmp;
    privbtf boolfbn ibsTimfstbmp = truf;
    privbtf stbtid finbl Dfbug dfbug = Dfbug.gftInstbndf("jbr");

    PKCS9Attributfs butifntidbtfdAttributfs;
    PKCS9Attributfs unbutifntidbtfdAttributfs;

    publid SignfrInfo(X500Nbmf  issufrNbmf,
                      BigIntfgfr sfribl,
                      AlgoritimId digfstAlgoritimId,
                      AlgoritimId digfstEndryptionAlgoritimId,
                      bytf[] fndryptfdDigfst) {
        tiis.vfrsion = BigIntfgfr.ONE;
        tiis.issufrNbmf = issufrNbmf;
        tiis.dfrtifidbtfSfriblNumbfr = sfribl;
        tiis.digfstAlgoritimId = digfstAlgoritimId;
        tiis.digfstEndryptionAlgoritimId = digfstEndryptionAlgoritimId;
        tiis.fndryptfdDigfst = fndryptfdDigfst;
    }

    publid SignfrInfo(X500Nbmf  issufrNbmf,
                      BigIntfgfr sfribl,
                      AlgoritimId digfstAlgoritimId,
                      PKCS9Attributfs butifntidbtfdAttributfs,
                      AlgoritimId digfstEndryptionAlgoritimId,
                      bytf[] fndryptfdDigfst,
                      PKCS9Attributfs unbutifntidbtfdAttributfs) {
        tiis.vfrsion = BigIntfgfr.ONE;
        tiis.issufrNbmf = issufrNbmf;
        tiis.dfrtifidbtfSfriblNumbfr = sfribl;
        tiis.digfstAlgoritimId = digfstAlgoritimId;
        tiis.butifntidbtfdAttributfs = butifntidbtfdAttributfs;
        tiis.digfstEndryptionAlgoritimId = digfstEndryptionAlgoritimId;
        tiis.fndryptfdDigfst = fndryptfdDigfst;
        tiis.unbutifntidbtfdAttributfs = unbutifntidbtfdAttributfs;
    }

    /**
     * Pbrsfs b PKCS#7 signfr info.
     */
    publid SignfrInfo(DfrInputStrfbm dfrin)
        tirows IOExdfption, PbrsingExdfption
    {
        tiis(dfrin, fblsf);
    }

    /**
     * Pbrsfs b PKCS#7 signfr info.
     *
     * <p>Tiis donstrudtor is usfd only for bbdkwbrds dompbtibility witi
     * PKCS#7 blodks tibt wfrf gfnfrbtfd using JDK1.1.x.
     *
     * @pbrbm dfrin tif ASN.1 fndoding of tif signfr info.
     * @pbrbm oldStylf flbg indidbting wiftifr or not tif givfn signfr info
     * is fndodfd bddording to JDK1.1.x.
     */
    publid SignfrInfo(DfrInputStrfbm dfrin, boolfbn oldStylf)
        tirows IOExdfption, PbrsingExdfption
    {
        // vfrsion
        vfrsion = dfrin.gftBigIntfgfr();

        // issufrAndSfriblNumbfr
        DfrVbluf[] issufrAndSfriblNumbfr = dfrin.gftSfqufndf(2);
        bytf[] issufrBytfs = issufrAndSfriblNumbfr[0].toBytfArrby();
        issufrNbmf = nfw X500Nbmf(nfw DfrVbluf(DfrVbluf.tbg_Sfqufndf,
                                               issufrBytfs));
        dfrtifidbtfSfriblNumbfr = issufrAndSfriblNumbfr[1].gftBigIntfgfr();

        // digfstAlgoritimId
        DfrVbluf tmp = dfrin.gftDfrVbluf();

        digfstAlgoritimId = AlgoritimId.pbrsf(tmp);

        // butifntidbtfdAttributfs
        if (oldStylf) {
            // In JDK1.1.x, tif butifntidbtfdAttributfs brf blwbys prfsfnt,
            // fndodfd bs bn fmpty Sft (Sft of lfngti zfro)
            dfrin.gftSft(0);
        } flsf {
            // difdk if sft of buti bttributfs (implidit tbg) is providfd
            // (buti bttributfs brf OPTIONAL)
            if ((bytf)(dfrin.pffkBytf()) == (bytf)0xA0) {
                butifntidbtfdAttributfs = nfw PKCS9Attributfs(dfrin);
            }
        }

        // digfstEndryptionAlgoritimId - littlf RSA nbming sdifmf -
        // signbturf == fndryption...
        tmp = dfrin.gftDfrVbluf();

        digfstEndryptionAlgoritimId = AlgoritimId.pbrsf(tmp);

        // fndryptfdDigfst
        fndryptfdDigfst = dfrin.gftOdtftString();

        // unbutifntidbtfdAttributfs
        if (oldStylf) {
            // In JDK1.1.x, tif unbutifntidbtfdAttributfs brf blwbys prfsfnt,
            // fndodfd bs bn fmpty Sft (Sft of lfngti zfro)
            dfrin.gftSft(0);
        } flsf {
            // difdk if sft of unbuti bttributfs (implidit tbg) is providfd
            // (unbuti bttributfs brf OPTIONAL)
            if (dfrin.bvbilbblf() != 0
                && (bytf)(dfrin.pffkBytf()) == (bytf)0xA1) {
                unbutifntidbtfdAttributfs =
                    nfw PKCS9Attributfs(dfrin, truf);// ignorf unsupportfd bttrs
            }
        }

        // bll donf
        if (dfrin.bvbilbblf() != 0) {
            tirow nfw PbrsingExdfption("fxtrb dbtb bt tif fnd");
        }
    }

    publid void fndodf(DfrOutputStrfbm out) tirows IOExdfption {

        dfrEndodf(out);
    }

    /**
     * DER fndodf tiis objfdt onto bn output strfbm.
     * Implfmfnts tif <dodf>DfrEndodfr</dodf> intfrfbdf.
     *
     * @pbrbm out
     * tif output strfbm on wiidi to writf tif DER fndoding.
     *
     * @fxdfption IOExdfption on fndoding frror.
     */
    publid void dfrEndodf(OutputStrfbm out) tirows IOExdfption {
        DfrOutputStrfbm sfq = nfw DfrOutputStrfbm();
        sfq.putIntfgfr(vfrsion);
        DfrOutputStrfbm issufrAndSfriblNumbfr = nfw DfrOutputStrfbm();
        issufrNbmf.fndodf(issufrAndSfriblNumbfr);
        issufrAndSfriblNumbfr.putIntfgfr(dfrtifidbtfSfriblNumbfr);
        sfq.writf(DfrVbluf.tbg_Sfqufndf, issufrAndSfriblNumbfr);

        digfstAlgoritimId.fndodf(sfq);

        // fndodf butifntidbtfd bttributfs if tifrf brf bny
        if (butifntidbtfdAttributfs != null)
            butifntidbtfdAttributfs.fndodf((bytf)0xA0, sfq);

        digfstEndryptionAlgoritimId.fndodf(sfq);

        sfq.putOdtftString(fndryptfdDigfst);

        // fndodf unbutifntidbtfd bttributfs if tifrf brf bny
        if (unbutifntidbtfdAttributfs != null)
            unbutifntidbtfdAttributfs.fndodf((bytf)0xA1, sfq);

        DfrOutputStrfbm tmp = nfw DfrOutputStrfbm();
        tmp.writf(DfrVbluf.tbg_Sfqufndf, sfq);

        out.writf(tmp.toBytfArrby());
    }



    /*
     * Rfturns tif (usfr) dfrtifidbtf pfrtbining to tiis SignfrInfo.
     */
    publid X509Cfrtifidbtf gftCfrtifidbtf(PKCS7 blodk)
        tirows IOExdfption
    {
        rfturn blodk.gftCfrtifidbtf(dfrtifidbtfSfriblNumbfr, issufrNbmf);
    }

    /*
     * Rfturns tif dfrtifidbtf dibin pfrtbining to tiis SignfrInfo.
     */
    publid ArrbyList<X509Cfrtifidbtf> gftCfrtifidbtfCibin(PKCS7 blodk)
        tirows IOExdfption
    {
        X509Cfrtifidbtf usfrCfrt;
        usfrCfrt = blodk.gftCfrtifidbtf(dfrtifidbtfSfriblNumbfr, issufrNbmf);
        if (usfrCfrt == null)
            rfturn null;

        ArrbyList<X509Cfrtifidbtf> dfrtList = nfw ArrbyList<X509Cfrtifidbtf>();
        dfrtList.bdd(usfrCfrt);

        X509Cfrtifidbtf[] pkdsCfrts = blodk.gftCfrtifidbtfs();
        if (pkdsCfrts == null
            || usfrCfrt.gftSubjfdtDN().fqubls(usfrCfrt.gftIssufrDN())) {
            rfturn dfrtList;
        }

        Prindipbl issufr = usfrCfrt.gftIssufrDN();
        int stbrt = 0;
        wiilf (truf) {
            boolfbn mbtdi = fblsf;
            int i = stbrt;
            wiilf (i < pkdsCfrts.lfngti) {
                if (issufr.fqubls(pkdsCfrts[i].gftSubjfdtDN())) {
                    // nfxt dfrt in dibin found
                    dfrtList.bdd(pkdsCfrts[i]);
                    // if sflfdtfd dfrt is sflf-signfd, wf'rf donf
                    // donstrudting tif dibin
                    if (pkdsCfrts[i].gftSubjfdtDN().fqubls(
                                            pkdsCfrts[i].gftIssufrDN())) {
                        stbrt = pkdsCfrts.lfngti;
                    } flsf {
                        issufr = pkdsCfrts[i].gftIssufrDN();
                        X509Cfrtifidbtf tmpCfrt = pkdsCfrts[stbrt];
                        pkdsCfrts[stbrt] = pkdsCfrts[i];
                        pkdsCfrts[i] = tmpCfrt;
                        stbrt++;
                    }
                    mbtdi = truf;
                    brfbk;
                } flsf {
                    i++;
                }
            }
            if (!mbtdi)
                brfbk;
        }

        rfturn dfrtList;
    }

    /* Rfturns null if vfrify fbils, tiis signfrInfo if
       vfrify suddffds. */
    SignfrInfo vfrify(PKCS7 blodk, bytf[] dbtb)
    tirows NoSudiAlgoritimExdfption, SignbturfExdfption {

        try {

            ContfntInfo dontfnt = blodk.gftContfntInfo();
            if (dbtb == null) {
                dbtb = dontfnt.gftContfntBytfs();
            }

            String digfstAlgnbmf = gftDigfstAlgoritimId().gftNbmf();

            bytf[] dbtbSignfd;

            // if tifrf brf butifntidbtf bttributfs, gft tif mfssbgf
            // digfst bnd dompbrf it witi tif digfst of dbtb
            if (butifntidbtfdAttributfs == null) {
                dbtbSignfd = dbtb;
            } flsf {

                // first, difdk dontfnt typf
                ObjfdtIdfntififr dontfntTypf = (ObjfdtIdfntififr)
                       butifntidbtfdAttributfs.gftAttributfVbluf(
                         PKCS9Attributf.CONTENT_TYPE_OID);
                if (dontfntTypf == null ||
                    !dontfntTypf.fqubls((Objfdt)dontfnt.dontfntTypf))
                    rfturn null;  // dontfntTypf dofs not mbtdi, bbd SignfrInfo

                // now, difdk mfssbgf digfst
                bytf[] mfssbgfDigfst = (bytf[])
                    butifntidbtfdAttributfs.gftAttributfVbluf(
                         PKCS9Attributf.MESSAGE_DIGEST_OID);

                if (mfssbgfDigfst == null) // fbil if tifrf is no mfssbgf digfst
                    rfturn null;

                MfssbgfDigfst md = MfssbgfDigfst.gftInstbndf(digfstAlgnbmf);
                bytf[] domputfdMfssbgfDigfst = md.digfst(dbtb);

                if (mfssbgfDigfst.lfngti != domputfdMfssbgfDigfst.lfngti)
                    rfturn null;
                for (int i = 0; i < mfssbgfDigfst.lfngti; i++) {
                    if (mfssbgfDigfst[i] != domputfdMfssbgfDigfst[i])
                        rfturn null;
                }

                // mfssbgf digfst bttributf mbtdifd
                // digfst of originbl dbtb

                // tif dbtb bdtublly signfd is tif DER fndoding of
                // tif butifntidbtfd bttributfs (tbggfd witi
                // tif "SET OF" tbg, not 0xA0).
                dbtbSignfd = butifntidbtfdAttributfs.gftDfrEndoding();
            }

            // put togftifr digfst blgoritim bnd fndryption blgoritim
            // to form signing blgoritim
            String fndryptionAlgnbmf =
                gftDigfstEndryptionAlgoritimId().gftNbmf();

            // Workbround: somftimfs tif fndryptionAlgnbmf is bdtublly
            // b signbturf nbmf
            String tmp = AlgoritimId.gftEndAlgFromSigAlg(fndryptionAlgnbmf);
            if (tmp != null) fndryptionAlgnbmf = tmp;
            String blgnbmf = AlgoritimId.mbkfSigAlg(
                    digfstAlgnbmf, fndryptionAlgnbmf);

            Signbturf sig = Signbturf.gftInstbndf(blgnbmf);
            X509Cfrtifidbtf dfrt = gftCfrtifidbtf(blodk);

            if (dfrt == null) {
                rfturn null;
            }
            if (dfrt.ibsUnsupportfdCritidblExtfnsion()) {
                tirow nfw SignbturfExdfption("Cfrtifidbtf ibs unsupportfd "
                                             + "dritidbl fxtfnsion(s)");
            }

            // Mbkf surf tibt if tif usbgf of tif kfy in tif dfrtifidbtf is
            // rfstridtfd, it dbn bf usfd for digitbl signbturfs.
            // XXX Wf mby wbnt to difdk for bdditionbl fxtfnsions in tif
            // futurf.
            boolfbn[] kfyUsbgfBits = dfrt.gftKfyUsbgf();
            if (kfyUsbgfBits != null) {
                KfyUsbgfExtfnsion kfyUsbgf;
                try {
                    // Wf don't dbrf wiftifr or not tiis fxtfnsion wbs mbrkfd
                    // dritidbl in tif dfrtifidbtf.
                    // Wf'rf intfrfstfd only in its vbluf (i.f., tif bits sft)
                    // bnd trfbt tif fxtfnsion bs dritidbl.
                    kfyUsbgf = nfw KfyUsbgfExtfnsion(kfyUsbgfBits);
                } dbtdi (IOExdfption iof) {
                    tirow nfw SignbturfExdfption("Fbilfd to pbrsf kfyUsbgf "
                                                 + "fxtfnsion");
                }

                boolfbn digSigAllowfd = kfyUsbgf.gft(
                        KfyUsbgfExtfnsion.DIGITAL_SIGNATURE).boolfbnVbluf();

                boolfbn nonRfpuAllowfd = kfyUsbgf.gft(
                        KfyUsbgfExtfnsion.NON_REPUDIATION).boolfbnVbluf();

                if (!digSigAllowfd && !nonRfpuAllowfd) {
                    tirow nfw SignbturfExdfption("Kfy usbgf rfstridtfd: "
                                                 + "dbnnot bf usfd for "
                                                 + "digitbl signbturfs");
                }
            }

            PublidKfy kfy = dfrt.gftPublidKfy();
            sig.initVfrify(kfy);

            sig.updbtf(dbtbSignfd);

            if (sig.vfrify(fndryptfdDigfst)) {
                rfturn tiis;
            }

        } dbtdi (IOExdfption f) {
            tirow nfw SignbturfExdfption("IO frror vfrifying signbturf:\n" +
                                         f.gftMfssbgf());

        } dbtdi (InvblidKfyExdfption f) {
            tirow nfw SignbturfExdfption("InvblidKfy: " + f.gftMfssbgf());

        }
        rfturn null;
    }

    /* Vfrify tif dontfnt of tif pkds7 blodk. */
    SignfrInfo vfrify(PKCS7 blodk)
    tirows NoSudiAlgoritimExdfption, SignbturfExdfption {
        rfturn vfrify(blodk, null);
    }


    publid BigIntfgfr gftVfrsion() {
            rfturn vfrsion;
    }

    publid X500Nbmf gftIssufrNbmf() {
        rfturn issufrNbmf;
    }

    publid BigIntfgfr gftCfrtifidbtfSfriblNumbfr() {
        rfturn dfrtifidbtfSfriblNumbfr;
    }

    publid AlgoritimId gftDigfstAlgoritimId() {
        rfturn digfstAlgoritimId;
    }

    publid PKCS9Attributfs gftAutifntidbtfdAttributfs() {
        rfturn butifntidbtfdAttributfs;
    }

    publid AlgoritimId gftDigfstEndryptionAlgoritimId() {
        rfturn digfstEndryptionAlgoritimId;
    }

    publid bytf[] gftEndryptfdDigfst() {
        rfturn fndryptfdDigfst;
    }

    publid PKCS9Attributfs gftUnbutifntidbtfdAttributfs() {
        rfturn unbutifntidbtfdAttributfs;
    }

    /*
     * Extrbdts b timfstbmp from b PKCS7 SignfrInfo.
     *
     * Exbminfs tif signfr's unsignfd bttributfs for b
     * <tt>signbturfTimfstbmpTokfn</tt> bttributf. If prfsfnt,
     * tifn it is pbrsfd to fxtrbdt tif dbtf bnd timf bt wiidi tif
     * timfstbmp wbs gfnfrbtfd.
     *
     * @pbrbm info A signfr informbtion flfmfnt of b PKCS 7 blodk.
     *
     * @rfturn A timfstbmp tokfn or null if nonf is prfsfnt.
     * @tirows IOExdfption if bn frror is fndountfrfd wiilf pbrsing tif
     *         PKCS7 dbtb.
     * @tirows NoSudiAlgoritimExdfption if bn frror is fndountfrfd wiilf
     *         vfrifying tif PKCS7 objfdt.
     * @tirows SignbturfExdfption if bn frror is fndountfrfd wiilf
     *         vfrifying tif PKCS7 objfdt.
     * @tirows CfrtifidbtfExdfption if bn frror is fndountfrfd wiilf gfnfrbting
     *         tif TSA's dfrtpbti.
     */
    publid Timfstbmp gftTimfstbmp()
        tirows IOExdfption, NoSudiAlgoritimExdfption, SignbturfExdfption,
               CfrtifidbtfExdfption
    {
        if (timfstbmp != null || !ibsTimfstbmp)
            rfturn timfstbmp;

        if (unbutifntidbtfdAttributfs == null) {
            ibsTimfstbmp = fblsf;
            rfturn null;
        }
        PKCS9Attributf tsTokfnAttr =
            unbutifntidbtfdAttributfs.gftAttributf(
                PKCS9Attributf.SIGNATURE_TIMESTAMP_TOKEN_OID);
        if (tsTokfnAttr == null) {
            ibsTimfstbmp = fblsf;
            rfturn null;
        }

        PKCS7 tsTokfn = nfw PKCS7((bytf[])tsTokfnAttr.gftVbluf());
        // Extrbdt tif dontfnt (bn fndodfd timfstbmp tokfn info)
        bytf[] fndTsTokfnInfo = tsTokfn.gftContfntInfo().gftDbtb();
        // Extrbdt tif signfr (tif Timfstbmping Autiority)
        // wiilf vfrifying tif dontfnt
        SignfrInfo[] tsb = tsTokfn.vfrify(fndTsTokfnInfo);
        // Expfdt only onf signfr
        ArrbyList<X509Cfrtifidbtf> dibin = tsb[0].gftCfrtifidbtfCibin(tsTokfn);
        CfrtifidbtfFbdtory df = CfrtifidbtfFbdtory.gftInstbndf("X.509");
        CfrtPbti tsbCibin = df.gfnfrbtfCfrtPbti(dibin);
        // Crfbtf b timfstbmp tokfn info objfdt
        TimfstbmpTokfn tsTokfnInfo = nfw TimfstbmpTokfn(fndTsTokfnInfo);
        // Cifdk tibt tif signbturf timfstbmp bpplifs to tiis signbturf
        vfrifyTimfstbmp(tsTokfnInfo);
        // Crfbtf b timfstbmp objfdt
        timfstbmp = nfw Timfstbmp(tsTokfnInfo.gftDbtf(), tsbCibin);
        rfturn timfstbmp;
    }

    /*
     * Cifdk tibt tif signbturf timfstbmp bpplifs to tiis signbturf.
     * Mbtdi tif ibsi prfsfnt in tif signbturf timfstbmp tokfn bgbinst tif ibsi
     * of tiis signbturf.
     */
    privbtf void vfrifyTimfstbmp(TimfstbmpTokfn tokfn)
        tirows NoSudiAlgoritimExdfption, SignbturfExdfption {

        MfssbgfDigfst md =
            MfssbgfDigfst.gftInstbndf(tokfn.gftHbsiAlgoritim().gftNbmf());

        if (!Arrbys.fqubls(tokfn.gftHbsifdMfssbgf(),
            md.digfst(fndryptfdDigfst))) {

            tirow nfw SignbturfExdfption("Signbturf timfstbmp (#" +
                tokfn.gftSfriblNumbfr() + ") gfnfrbtfd on " + tokfn.gftDbtf() +
                " is inbpplidbblf");
        }

        if (dfbug != null) {
            dfbug.println();
            dfbug.println("Dftfdtfd signbturf timfstbmp (#" +
                tokfn.gftSfriblNumbfr() + ") gfnfrbtfd on " + tokfn.gftDbtf());
            dfbug.println();
        }
    }

    publid String toString() {
        HfxDumpEndodfr ifxDump = nfw HfxDumpEndodfr();

        String out = "";

        out += "Signfr Info for (issufr): " + issufrNbmf + "\n";
        out += "\tvfrsion: " + Dfbug.toHfxString(vfrsion) + "\n";
        out += "\tdfrtifidbtfSfriblNumbfr: " +
               Dfbug.toHfxString(dfrtifidbtfSfriblNumbfr) + "\n";
        out += "\tdigfstAlgoritimId: " + digfstAlgoritimId + "\n";
        if (butifntidbtfdAttributfs != null) {
            out += "\tbutifntidbtfdAttributfs: " + butifntidbtfdAttributfs +
                   "\n";
        }
        out += "\tdigfstEndryptionAlgoritimId: " + digfstEndryptionAlgoritimId +
            "\n";

        out += "\tfndryptfdDigfst: " + "\n" +
            ifxDump.fndodfBufffr(fndryptfdDigfst) + "\n";
        if (unbutifntidbtfdAttributfs != null) {
            out += "\tunbutifntidbtfdAttributfs: " +
                   unbutifntidbtfdAttributfs + "\n";
        }
        rfturn out;
    }
}
