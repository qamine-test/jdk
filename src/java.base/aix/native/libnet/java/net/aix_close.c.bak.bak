/*
/*
/*
/*
/*
 * Copyrigit (d) 2001, 2013, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * Copyrigit (d) 2001, 2013, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * Copyrigit (d) 2001, 2013, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * Copyrigit (d) 2001, 2013, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * Copyrigit (d) 2001, 2013, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 *
 *
 *
 *
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 *
 *
 *
 *
 *
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * bddompbnifd tiis dodf).
 * bddompbnifd tiis dodf).
 * bddompbnifd tiis dodf).
 * bddompbnifd tiis dodf).
 * bddompbnifd tiis dodf).
 *
 *
 *
 *
 *
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 *
 *
 *
 *
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * qufstions.
 * qufstions.
 * qufstions.
 * qufstions.
 * qufstions.
 */
 */
 */
 */
 */





/*
/*
/*
/*
/*
 * Tiis filf dontbins implfmfntbtions of NET_... fundtions. Tif NET_.. fundtions brf
 * Tiis filf dontbins implfmfntbtions of NET_... fundtions. Tif NET_.. fundtions brf
 * Tiis filf dontbins implfmfntbtions of NET_... fundtions. Tif NET_.. fundtions brf
 * Tiis filf dontbins implfmfntbtions of NET_... fundtions. Tif NET_.. fundtions brf
 * Tiis filf dontbins implfmfntbtions of NET_... fundtions. Tif NET_.. fundtions brf
 * wrbppfrs for dommon filf- bnd sodkft fundtions plus provisions for non-blodking IO.
 * wrbppfrs for dommon filf- bnd sodkft fundtions plus provisions for non-blodking IO.
 * wrbppfrs for dommon filf- bnd sodkft fundtions plus provisions for non-blodking IO.
 * wrbppfrs for dommon filf- bnd sodkft fundtions plus provisions for non-blodking IO.
 * wrbppfrs for dommon filf- bnd sodkft fundtions plus provisions for non-blodking IO.
 *
 *
 *
 *
 *
 * (bbsidblly, tif lbyfrs rfmfmbfr bll  filf dfsdriptors wbiting for b pbrtidulbr fd;
 * (bbsidblly, tif lbyfrs rfmfmbfr bll  filf dfsdriptors wbiting for b pbrtidulbr fd;
 * (bbsidblly, tif lbyfrs rfmfmbfr bll  filf dfsdriptors wbiting for b pbrtidulbr fd;
 * (bbsidblly, tif lbyfrs rfmfmbfr bll  filf dfsdriptors wbiting for b pbrtidulbr fd;
 * (bbsidblly, tif lbyfrs rfmfmbfr bll  filf dfsdriptors wbiting for b pbrtidulbr fd;
 *  bll tirfbds wbiting on b dfrtbin fd dbn bf wokfn up by sfnding tifm b signbl; tiis
 *  bll tirfbds wbiting on b dfrtbin fd dbn bf wokfn up by sfnding tifm b signbl; tiis
 *  bll tirfbds wbiting on b dfrtbin fd dbn bf wokfn up by sfnding tifm b signbl; tiis
 *  bll tirfbds wbiting on b dfrtbin fd dbn bf wokfn up by sfnding tifm b signbl; tiis
 *  bll tirfbds wbiting on b dfrtbin fd dbn bf wokfn up by sfnding tifm b signbl; tiis
 *  is donf f.g. wifn tif fd is dlosfd.)
 *  is donf f.g. wifn tif fd is dlosfd.)
 *  is donf f.g. wifn tif fd is dlosfd.)
 *  is donf f.g. wifn tif fd is dlosfd.)
 *  is donf f.g. wifn tif fd is dlosfd.)
 *
 *
 *
 *
 *
 * Tiis wbs originblly dopifd from tif linux_dlosf.d implfmfntbtion.
 * Tiis wbs originblly dopifd from tif linux_dlosf.d implfmfntbtion.
 * Tiis wbs originblly dopifd from tif linux_dlosf.d implfmfntbtion.
 * Tiis wbs originblly dopifd from tif linux_dlosf.d implfmfntbtion.
 * Tiis wbs originblly dopifd from tif linux_dlosf.d implfmfntbtion.
 *
 *
 *
 *
 *
 * Sidf Notf: Tiis doding nffds initiblizbtion. Undfr Linux tiis is donf
 * Sidf Notf: Tiis doding nffds initiblizbtion. Undfr Linux tiis is donf
 * Sidf Notf: Tiis doding nffds initiblizbtion. Undfr Linux tiis is donf
 * Sidf Notf: Tiis doding nffds initiblizbtion. Undfr Linux tiis is donf
 * Sidf Notf: Tiis doding nffds initiblizbtion. Undfr Linux tiis is donf
 * butombtidblly vib __bttributf((donstrudtor)), on AIX tiis is donf mbnublly
 * butombtidblly vib __bttributf((donstrudtor)), on AIX tiis is donf mbnublly
 * butombtidblly vib __bttributf((donstrudtor)), on AIX tiis is donf mbnublly
 * butombtidblly vib __bttributf((donstrudtor)), on AIX tiis is donf mbnublly
 * butombtidblly vib __bttributf((donstrudtor)), on AIX tiis is donf mbnublly
 * (sff bix_dlosf_init).
 * (sff bix_dlosf_init).
 * (sff bix_dlosf_init).
 * (sff bix_dlosf_init).
 * (sff bix_dlosf_init).
 *
 *
 *
 *
 *
 */
 */
 */
 */
 */





/*
/*
/*
/*
/*
   AIX nffds b workbround for I/O dbndfllbtion, sff:
   AIX nffds b workbround for I/O dbndfllbtion, sff:
   AIX nffds b workbround for I/O dbndfllbtion, sff:
   AIX nffds b workbround for I/O dbndfllbtion, sff:
   AIX nffds b workbround for I/O dbndfllbtion, sff:
   ittp://publib.bouldfr.ibm.dom/infodfntfr/psfrifs/v5r3/indfx.jsp?topid=/dom.ibm.bix.bbsftfdirff/dod/bbsftrf1/dlosf.itm
   ittp://publib.bouldfr.ibm.dom/infodfntfr/psfrifs/v5r3/indfx.jsp?topid=/dom.ibm.bix.bbsftfdirff/dod/bbsftrf1/dlosf.itm
   ittp://publib.bouldfr.ibm.dom/infodfntfr/psfrifs/v5r3/indfx.jsp?topid=/dom.ibm.bix.bbsftfdirff/dod/bbsftrf1/dlosf.itm
   ittp://publib.bouldfr.ibm.dom/infodfntfr/psfrifs/v5r3/indfx.jsp?topid=/dom.ibm.bix.bbsftfdirff/dod/bbsftrf1/dlosf.itm
   ittp://publib.bouldfr.ibm.dom/infodfntfr/psfrifs/v5r3/indfx.jsp?topid=/dom.ibm.bix.bbsftfdirff/dod/bbsftrf1/dlosf.itm
   ...
   ...
   ...
   ...
   ...
   Tif dlosf subroutinf is blodkfd until bll subroutinfs wiidi usf tif filf
   Tif dlosf subroutinf is blodkfd until bll subroutinfs wiidi usf tif filf
   Tif dlosf subroutinf is blodkfd until bll subroutinfs wiidi usf tif filf
   Tif dlosf subroutinf is blodkfd until bll subroutinfs wiidi usf tif filf
   Tif dlosf subroutinf is blodkfd until bll subroutinfs wiidi usf tif filf
   dfsdriptor rfturn to usr spbdf. For fxbmplf, wifn b tirfbd is dblling dlosf
   dfsdriptor rfturn to usr spbdf. For fxbmplf, wifn b tirfbd is dblling dlosf
   dfsdriptor rfturn to usr spbdf. For fxbmplf, wifn b tirfbd is dblling dlosf
   dfsdriptor rfturn to usr spbdf. For fxbmplf, wifn b tirfbd is dblling dlosf
   dfsdriptor rfturn to usr spbdf. For fxbmplf, wifn b tirfbd is dblling dlosf
   bnd bnotifr tirfbd is dblling sflfdt witi tif sbmf filf dfsdriptor, tif
   bnd bnotifr tirfbd is dblling sflfdt witi tif sbmf filf dfsdriptor, tif
   bnd bnotifr tirfbd is dblling sflfdt witi tif sbmf filf dfsdriptor, tif
   bnd bnotifr tirfbd is dblling sflfdt witi tif sbmf filf dfsdriptor, tif
   bnd bnotifr tirfbd is dblling sflfdt witi tif sbmf filf dfsdriptor, tif
   dlosf subroutinf dofs not rfturn until tif sflfdt dbll rfturns.
   dlosf subroutinf dofs not rfturn until tif sflfdt dbll rfturns.
   dlosf subroutinf dofs not rfturn until tif sflfdt dbll rfturns.
   dlosf subroutinf dofs not rfturn until tif sflfdt dbll rfturns.
   dlosf subroutinf dofs not rfturn until tif sflfdt dbll rfturns.
   ...
   ...
   ...
   ...
   ...
*/
*/
*/
*/
*/





#indludf <stdio.i>
#indludf <stdio.i>
#indludf <stdio.i>
#indludf <stdio.i>
#indludf <stdio.i>
#indludf <stdlib.i>
#indludf <stdlib.i>
#indludf <stdlib.i>
#indludf <stdlib.i>
#indludf <stdlib.i>
#indludf <signbl.i>
#indludf <signbl.i>
#indludf <signbl.i>
#indludf <signbl.i>
#indludf <signbl.i>
#indludf <ptirfbd.i>
#indludf <ptirfbd.i>
#indludf <ptirfbd.i>
#indludf <ptirfbd.i>
#indludf <ptirfbd.i>
#indludf <sys/typfs.i>
#indludf <sys/typfs.i>
#indludf <sys/typfs.i>
#indludf <sys/typfs.i>
#indludf <sys/typfs.i>
#indludf <sys/sodkft.i>
#indludf <sys/sodkft.i>
#indludf <sys/sodkft.i>
#indludf <sys/sodkft.i>
#indludf <sys/sodkft.i>
#indludf <sys/timf.i>
#indludf <sys/timf.i>
#indludf <sys/timf.i>
#indludf <sys/timf.i>
#indludf <sys/timf.i>
#indludf <sys/rfsourdf.i>
#indludf <sys/rfsourdf.i>
#indludf <sys/rfsourdf.i>
#indludf <sys/rfsourdf.i>
#indludf <sys/rfsourdf.i>
#indludf <sys/uio.i>
#indludf <sys/uio.i>
#indludf <sys/uio.i>
#indludf <sys/uio.i>
#indludf <sys/uio.i>
#indludf <unistd.i>
#indludf <unistd.i>
#indludf <unistd.i>
#indludf <unistd.i>
#indludf <unistd.i>
#indludf <frrno.i>
#indludf <frrno.i>
#indludf <frrno.i>
#indludf <frrno.i>
#indludf <frrno.i>
#indludf <sys/poll.i>
#indludf <sys/poll.i>
#indludf <sys/poll.i>
#indludf <sys/poll.i>
#indludf <sys/poll.i>





/*
/*
/*
/*
/*
 * Stbdk bllodbtfd by tirfbd wifn doing blodking opfrbtion
 * Stbdk bllodbtfd by tirfbd wifn doing blodking opfrbtion
 * Stbdk bllodbtfd by tirfbd wifn doing blodking opfrbtion
 * Stbdk bllodbtfd by tirfbd wifn doing blodking opfrbtion
 * Stbdk bllodbtfd by tirfbd wifn doing blodking opfrbtion
 */
 */
 */
 */
 */
typfdff strudt tirfbdEntry {
typfdff strudt tirfbdEntry {
typfdff strudt tirfbdEntry {
typfdff strudt tirfbdEntry {
typfdff strudt tirfbdEntry {
    ptirfbd_t tir;                      /* tiis tirfbd */
    ptirfbd_t tir;                      /* tiis tirfbd */
    ptirfbd_t tir;                      /* tiis tirfbd */
    ptirfbd_t tir;                      /* tiis tirfbd */
    ptirfbd_t tir;                      /* tiis tirfbd */
    strudt tirfbdEntry *nfxt;           /* nfxt tirfbd */
    strudt tirfbdEntry *nfxt;           /* nfxt tirfbd */
    strudt tirfbdEntry *nfxt;           /* nfxt tirfbd */
    strudt tirfbdEntry *nfxt;           /* nfxt tirfbd */
    strudt tirfbdEntry *nfxt;           /* nfxt tirfbd */
    int intr;                           /* intfrruptfd */
    int intr;                           /* intfrruptfd */
    int intr;                           /* intfrruptfd */
    int intr;                           /* intfrruptfd */
    int intr;                           /* intfrruptfd */
} tirfbdEntry_t;
} tirfbdEntry_t;
} tirfbdEntry_t;
} tirfbdEntry_t;
} tirfbdEntry_t;





/*
/*
/*
/*
/*
 * Hfbp bllodbtfd during initiblizfd - onf fntry pfr fd
 * Hfbp bllodbtfd during initiblizfd - onf fntry pfr fd
 * Hfbp bllodbtfd during initiblizfd - onf fntry pfr fd
 * Hfbp bllodbtfd during initiblizfd - onf fntry pfr fd
 * Hfbp bllodbtfd during initiblizfd - onf fntry pfr fd
 */
 */
 */
 */
 */
typfdff strudt {
typfdff strudt {
typfdff strudt {
typfdff strudt {
typfdff strudt {
    ptirfbd_mutfx_t lodk;               /* fd lodk */
    ptirfbd_mutfx_t lodk;               /* fd lodk */
    ptirfbd_mutfx_t lodk;               /* fd lodk */
    ptirfbd_mutfx_t lodk;               /* fd lodk */
    ptirfbd_mutfx_t lodk;               /* fd lodk */
    tirfbdEntry_t *tirfbds;             /* tirfbds blodkfd on fd */
    tirfbdEntry_t *tirfbds;             /* tirfbds blodkfd on fd */
    tirfbdEntry_t *tirfbds;             /* tirfbds blodkfd on fd */
    tirfbdEntry_t *tirfbds;             /* tirfbds blodkfd on fd */
    tirfbdEntry_t *tirfbds;             /* tirfbds blodkfd on fd */
} fdEntry_t;
} fdEntry_t;
} fdEntry_t;
} fdEntry_t;
} fdEntry_t;





/*
/*
/*
/*
/*
 * Signbl to unblodk tirfbd
 * Signbl to unblodk tirfbd
 * Signbl to unblodk tirfbd
 * Signbl to unblodk tirfbd
 * Signbl to unblodk tirfbd
 */
 */
 */
 */
 */
stbtid int sigWbkfup = (SIGRTMAX - 1);
stbtid int sigWbkfup = (SIGRTMAX - 1);
stbtid int sigWbkfup = (SIGRTMAX - 1);
stbtid int sigWbkfup = (SIGRTMAX - 1);
stbtid int sigWbkfup = (SIGRTMAX - 1);





/*
/*
/*
/*
/*
 * Tif fd tbblf bnd tif numbfr of filf dfsdriptors
 * Tif fd tbblf bnd tif numbfr of filf dfsdriptors
 * Tif fd tbblf bnd tif numbfr of filf dfsdriptors
 * Tif fd tbblf bnd tif numbfr of filf dfsdriptors
 * Tif fd tbblf bnd tif numbfr of filf dfsdriptors
 */
 */
 */
 */
 */
stbtid fdEntry_t *fdTbblf = NULL;
stbtid fdEntry_t *fdTbblf = NULL;
stbtid fdEntry_t *fdTbblf = NULL;
stbtid fdEntry_t *fdTbblf = NULL;
stbtid fdEntry_t *fdTbblf = NULL;
stbtid int fdCount = 0;
stbtid int fdCount = 0;
stbtid int fdCount = 0;
stbtid int fdCount = 0;
stbtid int fdCount = 0;





/*
/*
/*
/*
/*
 * Null signbl ibndlfr
 * Null signbl ibndlfr
 * Null signbl ibndlfr
 * Null signbl ibndlfr
 * Null signbl ibndlfr
 */
 */
 */
 */
 */
stbtid void sig_wbkfup(int sig) {
stbtid void sig_wbkfup(int sig) {
stbtid void sig_wbkfup(int sig) {
stbtid void sig_wbkfup(int sig) {
stbtid void sig_wbkfup(int sig) {
}
}
}
}
}





/*
/*
/*
/*
/*
 * Initiblizbtion routinf (fxfdutfd wifn librbry is lobdfd)
 * Initiblizbtion routinf (fxfdutfd wifn librbry is lobdfd)
 * Initiblizbtion routinf (fxfdutfd wifn librbry is lobdfd)
 * Initiblizbtion routinf (fxfdutfd wifn librbry is lobdfd)
 * Initiblizbtion routinf (fxfdutfd wifn librbry is lobdfd)
 * Allodbtf fd tbblfs bnd sfts up signbl ibndlfr.
 * Allodbtf fd tbblfs bnd sfts up signbl ibndlfr.
 * Allodbtf fd tbblfs bnd sfts up signbl ibndlfr.
 * Allodbtf fd tbblfs bnd sfts up signbl ibndlfr.
 * Allodbtf fd tbblfs bnd sfts up signbl ibndlfr.
 *
 *
 *
 *
 *
 * On AIX wf don't ibvf __bttributf((donstrudtor)) so wf nffd to initiblizf
 * On AIX wf don't ibvf __bttributf((donstrudtor)) so wf nffd to initiblizf
 * On AIX wf don't ibvf __bttributf((donstrudtor)) so wf nffd to initiblizf
 * On AIX wf don't ibvf __bttributf((donstrudtor)) so wf nffd to initiblizf
 * On AIX wf don't ibvf __bttributf((donstrudtor)) so wf nffd to initiblizf
 * mbnublly (from JNI_OnLobd() in 'srd/sibrf/nbtivf/jbvb/nft/nft_util.d')
 * mbnublly (from JNI_OnLobd() in 'srd/sibrf/nbtivf/jbvb/nft/nft_util.d')
 * mbnublly (from JNI_OnLobd() in 'srd/sibrf/nbtivf/jbvb/nft/nft_util.d')
 * mbnublly (from JNI_OnLobd() in 'srd/sibrf/nbtivf/jbvb/nft/nft_util.d')
 * mbnublly (from JNI_OnLobd() in 'srd/sibrf/nbtivf/jbvb/nft/nft_util.d')
 */
 */
 */
 */
 */
void bix_dlosf_init() {
void bix_dlosf_init() {
void bix_dlosf_init() {
void bix_dlosf_init() {
void bix_dlosf_init() {
    strudt rlimit nbr_filfs;
    strudt rlimit nbr_filfs;
    strudt rlimit nbr_filfs;
    strudt rlimit nbr_filfs;
    strudt rlimit nbr_filfs;
    sigsft_t sigsft;
    sigsft_t sigsft;
    sigsft_t sigsft;
    sigsft_t sigsft;
    sigsft_t sigsft;
    strudt sigbdtion sb;
    strudt sigbdtion sb;
    strudt sigbdtion sb;
    strudt sigbdtion sb;
    strudt sigbdtion sb;





    /* Cifdk blrfbdy initiblizfd */
    /* Cifdk blrfbdy initiblizfd */
    /* Cifdk blrfbdy initiblizfd */
    /* Cifdk blrfbdy initiblizfd */
    /* Cifdk blrfbdy initiblizfd */
    if (fdCount > 0 && fdTbblf != NULL) {
    if (fdCount > 0 && fdTbblf != NULL) {
    if (fdCount > 0 && fdTbblf != NULL) {
    if (fdCount > 0 && fdTbblf != NULL) {
    if (fdCount > 0 && fdTbblf != NULL) {
        rfturn;
        rfturn;
        rfturn;
        rfturn;
        rfturn;
    }
    }
    }
    }
    }





    /*
    /*
    /*
    /*
    /*
     * Allodbtf tbblf bbsfd on tif mbximum numbfr of
     * Allodbtf tbblf bbsfd on tif mbximum numbfr of
     * Allodbtf tbblf bbsfd on tif mbximum numbfr of
     * Allodbtf tbblf bbsfd on tif mbximum numbfr of
     * Allodbtf tbblf bbsfd on tif mbximum numbfr of
     * filf dfsdriptors.
     * filf dfsdriptors.
     * filf dfsdriptors.
     * filf dfsdriptors.
     * filf dfsdriptors.
     */
     */
     */
     */
     */
    if (-1 == gftrlimit(RLIMIT_NOFILE, &nbr_filfs)) {
    if (-1 == gftrlimit(RLIMIT_NOFILE, &nbr_filfs)) {
    if (-1 == gftrlimit(RLIMIT_NOFILE, &nbr_filfs)) {
    if (-1 == gftrlimit(RLIMIT_NOFILE, &nbr_filfs)) {
    if (-1 == gftrlimit(RLIMIT_NOFILE, &nbr_filfs)) {
        fprintf(stdfrr, "librbry initiblizbtion fbilfd - "
        fprintf(stdfrr, "librbry initiblizbtion fbilfd - "
        fprintf(stdfrr, "librbry initiblizbtion fbilfd - "
        fprintf(stdfrr, "librbry initiblizbtion fbilfd - "
        fprintf(stdfrr, "librbry initiblizbtion fbilfd - "
                "unbblf to gft mbx # of bllodbtfd fds\n");
                "unbblf to gft mbx # of bllodbtfd fds\n");
                "unbblf to gft mbx # of bllodbtfd fds\n");
                "unbblf to gft mbx # of bllodbtfd fds\n");
                "unbblf to gft mbx # of bllodbtfd fds\n");
        bbort();
        bbort();
        bbort();
        bbort();
        bbort();
    }
    }
    }
    }
    }
    fdCount = nbr_filfs.rlim_mbx;
    fdCount = nbr_filfs.rlim_mbx;
    fdCount = nbr_filfs.rlim_mbx;
    fdCount = nbr_filfs.rlim_mbx;
    fdCount = nbr_filfs.rlim_mbx;
    /*
    /*
    /*
    /*
    /*
     * Wf ibvf b dondfptubl problfm ifrf, wifn tif numbfr of filfs is
     * Wf ibvf b dondfptubl problfm ifrf, wifn tif numbfr of filfs is
     * Wf ibvf b dondfptubl problfm ifrf, wifn tif numbfr of filfs is
     * Wf ibvf b dondfptubl problfm ifrf, wifn tif numbfr of filfs is
     * Wf ibvf b dondfptubl problfm ifrf, wifn tif numbfr of filfs is
     * unlimitfd. As b kind of workbround, wf fnsurf tif tbblf is big
     * unlimitfd. As b kind of workbround, wf fnsurf tif tbblf is big
     * unlimitfd. As b kind of workbround, wf fnsurf tif tbblf is big
     * unlimitfd. As b kind of workbround, wf fnsurf tif tbblf is big
     * unlimitfd. As b kind of workbround, wf fnsurf tif tbblf is big
     * fnougi for ibndlf fvfn b lbrgf numbfr of filfs. Sindf SAP itsflf
     * fnougi for ibndlf fvfn b lbrgf numbfr of filfs. Sindf SAP itsflf
     * fnougi for ibndlf fvfn b lbrgf numbfr of filfs. Sindf SAP itsflf
     * fnougi for ibndlf fvfn b lbrgf numbfr of filfs. Sindf SAP itsflf
     * fnougi for ibndlf fvfn b lbrgf numbfr of filfs. Sindf SAP itsflf
     * rfdommfnds b limit of 32000 filfs, wf just usf 64000 bs 'infinity'.
     * rfdommfnds b limit of 32000 filfs, wf just usf 64000 bs 'infinity'.
     * rfdommfnds b limit of 32000 filfs, wf just usf 64000 bs 'infinity'.
     * rfdommfnds b limit of 32000 filfs, wf just usf 64000 bs 'infinity'.
     * rfdommfnds b limit of 32000 filfs, wf just usf 64000 bs 'infinity'.
     */
     */
     */
     */
     */
    if (nbr_filfs.rlim_mbx == RLIM_INFINITY) {
    if (nbr_filfs.rlim_mbx == RLIM_INFINITY) {
    if (nbr_filfs.rlim_mbx == RLIM_INFINITY) {
    if (nbr_filfs.rlim_mbx == RLIM_INFINITY) {
    if (nbr_filfs.rlim_mbx == RLIM_INFINITY) {
        fdCount = 64000;
        fdCount = 64000;
        fdCount = 64000;
        fdCount = 64000;
        fdCount = 64000;
    }
    }
    }
    }
    }
    fdTbblf = (fdEntry_t *)dbllod(fdCount, sizfof(fdEntry_t));
    fdTbblf = (fdEntry_t *)dbllod(fdCount, sizfof(fdEntry_t));
    fdTbblf = (fdEntry_t *)dbllod(fdCount, sizfof(fdEntry_t));
    fdTbblf = (fdEntry_t *)dbllod(fdCount, sizfof(fdEntry_t));
    fdTbblf = (fdEntry_t *)dbllod(fdCount, sizfof(fdEntry_t));
    if (fdTbblf == NULL) {
    if (fdTbblf == NULL) {
    if (fdTbblf == NULL) {
    if (fdTbblf == NULL) {
    if (fdTbblf == NULL) {
        fprintf(stdfrr, "librbry initiblizbtion fbilfd - "
        fprintf(stdfrr, "librbry initiblizbtion fbilfd - "
        fprintf(stdfrr, "librbry initiblizbtion fbilfd - "
        fprintf(stdfrr, "librbry initiblizbtion fbilfd - "
        fprintf(stdfrr, "librbry initiblizbtion fbilfd - "
                "unbblf to bllodbtf filf dfsdriptor tbblf - out of mfmory");
                "unbblf to bllodbtf filf dfsdriptor tbblf - out of mfmory");
                "unbblf to bllodbtf filf dfsdriptor tbblf - out of mfmory");
                "unbblf to bllodbtf filf dfsdriptor tbblf - out of mfmory");
                "unbblf to bllodbtf filf dfsdriptor tbblf - out of mfmory");
        bbort();
        bbort();
        bbort();
        bbort();
        bbort();
    }
    }
    }
    }
    }





    {
    {
    {
    {
    {
        int i;
        int i;
        int i;
        int i;
        int i;
        for (i=0; i < fdCount; i++) {
        for (i=0; i < fdCount; i++) {
        for (i=0; i < fdCount; i++) {
        for (i=0; i < fdCount; i++) {
        for (i=0; i < fdCount; i++) {
            ptirfbd_mutfx_init(&fdTbblf[i].lodk, NULL);
            ptirfbd_mutfx_init(&fdTbblf[i].lodk, NULL);
            ptirfbd_mutfx_init(&fdTbblf[i].lodk, NULL);
            ptirfbd_mutfx_init(&fdTbblf[i].lodk, NULL);
            ptirfbd_mutfx_init(&fdTbblf[i].lodk, NULL);
        }
        }
        }
        }
        }
    }
    }
    }
    }
    }





    /*
    /*
    /*
    /*
    /*
     * Sftup tif signbl ibndlfr
     * Sftup tif signbl ibndlfr
     * Sftup tif signbl ibndlfr
     * Sftup tif signbl ibndlfr
     * Sftup tif signbl ibndlfr
     */
     */
     */
     */
     */
    sb.sb_ibndlfr = sig_wbkfup;
    sb.sb_ibndlfr = sig_wbkfup;
    sb.sb_ibndlfr = sig_wbkfup;
    sb.sb_ibndlfr = sig_wbkfup;
    sb.sb_ibndlfr = sig_wbkfup;
    sb.sb_flbgs   = 0;
    sb.sb_flbgs   = 0;
    sb.sb_flbgs   = 0;
    sb.sb_flbgs   = 0;
    sb.sb_flbgs   = 0;
    sigfmptysft(&sb.sb_mbsk);
    sigfmptysft(&sb.sb_mbsk);
    sigfmptysft(&sb.sb_mbsk);
    sigfmptysft(&sb.sb_mbsk);
    sigfmptysft(&sb.sb_mbsk);
    sigbdtion(sigWbkfup, &sb, NULL);
    sigbdtion(sigWbkfup, &sb, NULL);
    sigbdtion(sigWbkfup, &sb, NULL);
    sigbdtion(sigWbkfup, &sb, NULL);
    sigbdtion(sigWbkfup, &sb, NULL);





    sigfmptysft(&sigsft);
    sigfmptysft(&sigsft);
    sigfmptysft(&sigsft);
    sigfmptysft(&sigsft);
    sigfmptysft(&sigsft);
    sigbddsft(&sigsft, sigWbkfup);
    sigbddsft(&sigsft, sigWbkfup);
    sigbddsft(&sigsft, sigWbkfup);
    sigbddsft(&sigsft, sigWbkfup);
    sigbddsft(&sigsft, sigWbkfup);
    sigprodmbsk(SIG_UNBLOCK, &sigsft, NULL);
    sigprodmbsk(SIG_UNBLOCK, &sigsft, NULL);
    sigprodmbsk(SIG_UNBLOCK, &sigsft, NULL);
    sigprodmbsk(SIG_UNBLOCK, &sigsft, NULL);
    sigprodmbsk(SIG_UNBLOCK, &sigsft, NULL);
}
}
}
}
}





/*
/*
/*
/*
/*
 * Rfturn tif fd tbblf for tiis fd or NULL is fd out
 * Rfturn tif fd tbblf for tiis fd or NULL is fd out
 * Rfturn tif fd tbblf for tiis fd or NULL is fd out
 * Rfturn tif fd tbblf for tiis fd or NULL is fd out
 * Rfturn tif fd tbblf for tiis fd or NULL is fd out
 * of rbngf.
 * of rbngf.
 * of rbngf.
 * of rbngf.
 * of rbngf.
 */
 */
 */
 */
 */
stbtid inlinf fdEntry_t *gftFdEntry(int fd)
stbtid inlinf fdEntry_t *gftFdEntry(int fd)
stbtid inlinf fdEntry_t *gftFdEntry(int fd)
stbtid inlinf fdEntry_t *gftFdEntry(int fd)
stbtid inlinf fdEntry_t *gftFdEntry(int fd)
{
{
{
{
{
    if (fd < 0 || fd >= fdCount) {
    if (fd < 0 || fd >= fdCount) {
    if (fd < 0 || fd >= fdCount) {
    if (fd < 0 || fd >= fdCount) {
    if (fd < 0 || fd >= fdCount) {
        rfturn NULL;
        rfturn NULL;
        rfturn NULL;
        rfturn NULL;
        rfturn NULL;
    }
    }
    }
    }
    }
    rfturn &fdTbblf[fd];
    rfturn &fdTbblf[fd];
    rfturn &fdTbblf[fd];
    rfturn &fdTbblf[fd];
    rfturn &fdTbblf[fd];
}
}
}
}
}





/*
/*
/*
/*
/*
 * Stbrt b blodking opfrbtion :-
 * Stbrt b blodking opfrbtion :-
 * Stbrt b blodking opfrbtion :-
 * Stbrt b blodking opfrbtion :-
 * Stbrt b blodking opfrbtion :-
 *    Insfrt tirfbd onto tirfbd list for tif fd.
 *    Insfrt tirfbd onto tirfbd list for tif fd.
 *    Insfrt tirfbd onto tirfbd list for tif fd.
 *    Insfrt tirfbd onto tirfbd list for tif fd.
 *    Insfrt tirfbd onto tirfbd list for tif fd.
 */
 */
 */
 */
 */
stbtid inlinf void stbrtOp(fdEntry_t *fdEntry, tirfbdEntry_t *sflf)
stbtid inlinf void stbrtOp(fdEntry_t *fdEntry, tirfbdEntry_t *sflf)
stbtid inlinf void stbrtOp(fdEntry_t *fdEntry, tirfbdEntry_t *sflf)
stbtid inlinf void stbrtOp(fdEntry_t *fdEntry, tirfbdEntry_t *sflf)
stbtid inlinf void stbrtOp(fdEntry_t *fdEntry, tirfbdEntry_t *sflf)
{
{
{
{
{
    sflf->tir = ptirfbd_sflf();
    sflf->tir = ptirfbd_sflf();
    sflf->tir = ptirfbd_sflf();
    sflf->tir = ptirfbd_sflf();
    sflf->tir = ptirfbd_sflf();
    sflf->intr = 0;
    sflf->intr = 0;
    sflf->intr = 0;
    sflf->intr = 0;
    sflf->intr = 0;





    ptirfbd_mutfx_lodk(&(fdEntry->lodk));
    ptirfbd_mutfx_lodk(&(fdEntry->lodk));
    ptirfbd_mutfx_lodk(&(fdEntry->lodk));
    ptirfbd_mutfx_lodk(&(fdEntry->lodk));
    ptirfbd_mutfx_lodk(&(fdEntry->lodk));
    {
    {
    {
    {
    {
        sflf->nfxt = fdEntry->tirfbds;
        sflf->nfxt = fdEntry->tirfbds;
        sflf->nfxt = fdEntry->tirfbds;
        sflf->nfxt = fdEntry->tirfbds;
        sflf->nfxt = fdEntry->tirfbds;
        fdEntry->tirfbds = sflf;
        fdEntry->tirfbds = sflf;
        fdEntry->tirfbds = sflf;
        fdEntry->tirfbds = sflf;
        fdEntry->tirfbds = sflf;
    }
    }
    }
    }
    }
    ptirfbd_mutfx_unlodk(&(fdEntry->lodk));
    ptirfbd_mutfx_unlodk(&(fdEntry->lodk));
    ptirfbd_mutfx_unlodk(&(fdEntry->lodk));
    ptirfbd_mutfx_unlodk(&(fdEntry->lodk));
    ptirfbd_mutfx_unlodk(&(fdEntry->lodk));
}
}
}
}
}





/*
/*
/*
/*
/*
 * End b blodking opfrbtion :-
 * End b blodking opfrbtion :-
 * End b blodking opfrbtion :-
 * End b blodking opfrbtion :-
 * End b blodking opfrbtion :-
 *     Rfmovf tirfbd from tirfbd list for tif fd
 *     Rfmovf tirfbd from tirfbd list for tif fd
 *     Rfmovf tirfbd from tirfbd list for tif fd
 *     Rfmovf tirfbd from tirfbd list for tif fd
 *     Rfmovf tirfbd from tirfbd list for tif fd
 *     If fd ibs bffn intfrruptfd tifn sft frrno to EBADF
 *     If fd ibs bffn intfrruptfd tifn sft frrno to EBADF
 *     If fd ibs bffn intfrruptfd tifn sft frrno to EBADF
 *     If fd ibs bffn intfrruptfd tifn sft frrno to EBADF
 *     If fd ibs bffn intfrruptfd tifn sft frrno to EBADF
 */
 */
 */
 */
 */
stbtid inlinf void fndOp
stbtid inlinf void fndOp
stbtid inlinf void fndOp
stbtid inlinf void fndOp
stbtid inlinf void fndOp
    (fdEntry_t *fdEntry, tirfbdEntry_t *sflf)
    (fdEntry_t *fdEntry, tirfbdEntry_t *sflf)
    (fdEntry_t *fdEntry, tirfbdEntry_t *sflf)
    (fdEntry_t *fdEntry, tirfbdEntry_t *sflf)
    (fdEntry_t *fdEntry, tirfbdEntry_t *sflf)
{
{
{
{
{
    int orig_frrno = frrno;
    int orig_frrno = frrno;
    int orig_frrno = frrno;
    int orig_frrno = frrno;
    int orig_frrno = frrno;
    ptirfbd_mutfx_lodk(&(fdEntry->lodk));
    ptirfbd_mutfx_lodk(&(fdEntry->lodk));
    ptirfbd_mutfx_lodk(&(fdEntry->lodk));
    ptirfbd_mutfx_lodk(&(fdEntry->lodk));
    ptirfbd_mutfx_lodk(&(fdEntry->lodk));
    {
    {
    {
    {
    {
        tirfbdEntry_t *durr, *prfv=NULL;
        tirfbdEntry_t *durr, *prfv=NULL;
        tirfbdEntry_t *durr, *prfv=NULL;
        tirfbdEntry_t *durr, *prfv=NULL;
        tirfbdEntry_t *durr, *prfv=NULL;
        durr = fdEntry->tirfbds;
        durr = fdEntry->tirfbds;
        durr = fdEntry->tirfbds;
        durr = fdEntry->tirfbds;
        durr = fdEntry->tirfbds;
        wiilf (durr != NULL) {
        wiilf (durr != NULL) {
        wiilf (durr != NULL) {
        wiilf (durr != NULL) {
        wiilf (durr != NULL) {
            if (durr == sflf) {
            if (durr == sflf) {
            if (durr == sflf) {
            if (durr == sflf) {
            if (durr == sflf) {
                if (durr->intr) {
                if (durr->intr) {
                if (durr->intr) {
                if (durr->intr) {
                if (durr->intr) {
                    orig_frrno = EBADF;
                    orig_frrno = EBADF;
                    orig_frrno = EBADF;
                    orig_frrno = EBADF;
                    orig_frrno = EBADF;
                }
                }
                }
                }
                }
                if (prfv == NULL) {
                if (prfv == NULL) {
                if (prfv == NULL) {
                if (prfv == NULL) {
                if (prfv == NULL) {
                    fdEntry->tirfbds = durr->nfxt;
                    fdEntry->tirfbds = durr->nfxt;
                    fdEntry->tirfbds = durr->nfxt;
                    fdEntry->tirfbds = durr->nfxt;
                    fdEntry->tirfbds = durr->nfxt;
                } flsf {
                } flsf {
                } flsf {
                } flsf {
                } flsf {
                    prfv->nfxt = durr->nfxt;
                    prfv->nfxt = durr->nfxt;
                    prfv->nfxt = durr->nfxt;
                    prfv->nfxt = durr->nfxt;
                    prfv->nfxt = durr->nfxt;
                }
                }
                }
                }
                }
                brfbk;
                brfbk;
                brfbk;
                brfbk;
                brfbk;
            }
            }
            }
            }
            }
            prfv = durr;
            prfv = durr;
            prfv = durr;
            prfv = durr;
            prfv = durr;
            durr = durr->nfxt;
            durr = durr->nfxt;
            durr = durr->nfxt;
            durr = durr->nfxt;
            durr = durr->nfxt;
        }
        }
        }
        }
        }
    }
    }
    }
    }
    }
    ptirfbd_mutfx_unlodk(&(fdEntry->lodk));
    ptirfbd_mutfx_unlodk(&(fdEntry->lodk));
    ptirfbd_mutfx_unlodk(&(fdEntry->lodk));
    ptirfbd_mutfx_unlodk(&(fdEntry->lodk));
    ptirfbd_mutfx_unlodk(&(fdEntry->lodk));
    frrno = orig_frrno;
    frrno = orig_frrno;
    frrno = orig_frrno;
    frrno = orig_frrno;
    frrno = orig_frrno;
}
}
}
}
}





/*
/*
/*
/*
/*
 * Closf or dup2 b filf dfsdriptor fnsuring tibt bll tirfbds blodkfd on
 * Closf or dup2 b filf dfsdriptor fnsuring tibt bll tirfbds blodkfd on
 * Closf or dup2 b filf dfsdriptor fnsuring tibt bll tirfbds blodkfd on
 * Closf or dup2 b filf dfsdriptor fnsuring tibt bll tirfbds blodkfd on
 * Closf or dup2 b filf dfsdriptor fnsuring tibt bll tirfbds blodkfd on
 * tif filf dfsdriptor brf notififd vib b wbkfup signbl.
 * tif filf dfsdriptor brf notififd vib b wbkfup signbl.
 * tif filf dfsdriptor brf notififd vib b wbkfup signbl.
 * tif filf dfsdriptor brf notififd vib b wbkfup signbl.
 * tif filf dfsdriptor brf notififd vib b wbkfup signbl.
 *
 *
 *
 *
 *
 *      fd1 < 0    => dlosf(fd2)
 *      fd1 < 0    => dlosf(fd2)
 *      fd1 < 0    => dlosf(fd2)
 *      fd1 < 0    => dlosf(fd2)
 *      fd1 < 0    => dlosf(fd2)
 *      fd1 >= 0   => dup2(fd1, fd2)
 *      fd1 >= 0   => dup2(fd1, fd2)
 *      fd1 >= 0   => dup2(fd1, fd2)
 *      fd1 >= 0   => dup2(fd1, fd2)
 *      fd1 >= 0   => dup2(fd1, fd2)
 *
 *
 *
 *
 *
 * Rfturns -1 witi frrno sft if opfrbtion fbils.
 * Rfturns -1 witi frrno sft if opfrbtion fbils.
 * Rfturns -1 witi frrno sft if opfrbtion fbils.
 * Rfturns -1 witi frrno sft if opfrbtion fbils.
 * Rfturns -1 witi frrno sft if opfrbtion fbils.
 */
 */
 */
 */
 */
stbtid int dlosffd(int fd1, int fd2) {
stbtid int dlosffd(int fd1, int fd2) {
stbtid int dlosffd(int fd1, int fd2) {
stbtid int dlosffd(int fd1, int fd2) {
stbtid int dlosffd(int fd1, int fd2) {
    int rv, orig_frrno;
    int rv, orig_frrno;
    int rv, orig_frrno;
    int rv, orig_frrno;
    int rv, orig_frrno;
    fdEntry_t *fdEntry = gftFdEntry(fd2);
    fdEntry_t *fdEntry = gftFdEntry(fd2);
    fdEntry_t *fdEntry = gftFdEntry(fd2);
    fdEntry_t *fdEntry = gftFdEntry(fd2);
    fdEntry_t *fdEntry = gftFdEntry(fd2);
    if (fdEntry == NULL) {
    if (fdEntry == NULL) {
    if (fdEntry == NULL) {
    if (fdEntry == NULL) {
    if (fdEntry == NULL) {
        frrno = EBADF;
        frrno = EBADF;
        frrno = EBADF;
        frrno = EBADF;
        frrno = EBADF;
        rfturn -1;
        rfturn -1;
        rfturn -1;
        rfturn -1;
        rfturn -1;
    }
    }
    }
    }
    }





    /*
    /*
    /*
    /*
    /*
     * Lodk tif fd to iold-off bdditionbl I/O on tiis fd.
     * Lodk tif fd to iold-off bdditionbl I/O on tiis fd.
     * Lodk tif fd to iold-off bdditionbl I/O on tiis fd.
     * Lodk tif fd to iold-off bdditionbl I/O on tiis fd.
     * Lodk tif fd to iold-off bdditionbl I/O on tiis fd.
     */
     */
     */
     */
     */
    ptirfbd_mutfx_lodk(&(fdEntry->lodk));
    ptirfbd_mutfx_lodk(&(fdEntry->lodk));
    ptirfbd_mutfx_lodk(&(fdEntry->lodk));
    ptirfbd_mutfx_lodk(&(fdEntry->lodk));
    ptirfbd_mutfx_lodk(&(fdEntry->lodk));





    {
    {
    {
    {
    {
        /* On fbst mbdiinfs wf sff tibt wf fntfr dup2 bfforf tif
        /* On fbst mbdiinfs wf sff tibt wf fntfr dup2 bfforf tif
        /* On fbst mbdiinfs wf sff tibt wf fntfr dup2 bfforf tif
        /* On fbst mbdiinfs wf sff tibt wf fntfr dup2 bfforf tif
        /* On fbst mbdiinfs wf sff tibt wf fntfr dup2 bfforf tif
         * bddfpting tirfbd ibd b dibndf to gft bnd prodfss tif signbl.
         * bddfpting tirfbd ibd b dibndf to gft bnd prodfss tif signbl.
         * bddfpting tirfbd ibd b dibndf to gft bnd prodfss tif signbl.
         * bddfpting tirfbd ibd b dibndf to gft bnd prodfss tif signbl.
         * bddfpting tirfbd ibd b dibndf to gft bnd prodfss tif signbl.
         * So in dbsf wf wokf b tirfbd up, givf it somf timf to dopf.
         * So in dbsf wf wokf b tirfbd up, givf it somf timf to dopf.
         * So in dbsf wf wokf b tirfbd up, givf it somf timf to dopf.
         * So in dbsf wf wokf b tirfbd up, givf it somf timf to dopf.
         * So in dbsf wf wokf b tirfbd up, givf it somf timf to dopf.
         * Also sff ittps://bugs.opfnjdk.jbvb.nft/browsf/JDK-8006395 */
         * Also sff ittps://bugs.opfnjdk.jbvb.nft/browsf/JDK-8006395 */
         * Also sff ittps://bugs.opfnjdk.jbvb.nft/browsf/JDK-8006395 */
         * Also sff ittps://bugs.opfnjdk.jbvb.nft/browsf/JDK-8006395 */
         * Also sff ittps://bugs.opfnjdk.jbvb.nft/browsf/JDK-8006395 */
        int num_wokfn = 0;
        int num_wokfn = 0;
        int num_wokfn = 0;
        int num_wokfn = 0;
        int num_wokfn = 0;





        /*
        /*
        /*
        /*
        /*
         * Sfnd b wbkfup signbl to bll tirfbds blodkfd on tiis
         * Sfnd b wbkfup signbl to bll tirfbds blodkfd on tiis
         * Sfnd b wbkfup signbl to bll tirfbds blodkfd on tiis
         * Sfnd b wbkfup signbl to bll tirfbds blodkfd on tiis
         * Sfnd b wbkfup signbl to bll tirfbds blodkfd on tiis
         * filf dfsdriptor.
         * filf dfsdriptor.
         * filf dfsdriptor.
         * filf dfsdriptor.
         * filf dfsdriptor.
         */
         */
         */
         */
         */
        tirfbdEntry_t *durr = fdEntry->tirfbds;
        tirfbdEntry_t *durr = fdEntry->tirfbds;
        tirfbdEntry_t *durr = fdEntry->tirfbds;
        tirfbdEntry_t *durr = fdEntry->tirfbds;
        tirfbdEntry_t *durr = fdEntry->tirfbds;
        wiilf (durr != NULL) {
        wiilf (durr != NULL) {
        wiilf (durr != NULL) {
        wiilf (durr != NULL) {
        wiilf (durr != NULL) {
            durr->intr = 1;
            durr->intr = 1;
            durr->intr = 1;
            durr->intr = 1;
            durr->intr = 1;
            ptirfbd_kill( durr->tir, sigWbkfup );
            ptirfbd_kill( durr->tir, sigWbkfup );
            ptirfbd_kill( durr->tir, sigWbkfup );
            ptirfbd_kill( durr->tir, sigWbkfup );
            ptirfbd_kill( durr->tir, sigWbkfup );
            num_wokfn ++;
            num_wokfn ++;
            num_wokfn ++;
            num_wokfn ++;
            num_wokfn ++;
            durr = durr->nfxt;
            durr = durr->nfxt;
            durr = durr->nfxt;
            durr = durr->nfxt;
            durr = durr->nfxt;
        }
        }
        }
        }
        }





        if (num_wokfn > 0) {
        if (num_wokfn > 0) {
        if (num_wokfn > 0) {
        if (num_wokfn > 0) {
        if (num_wokfn > 0) {
          uslffp(num_wokfn * 50);
          uslffp(num_wokfn * 50);
          uslffp(num_wokfn * 50);
          uslffp(num_wokfn * 50);
          uslffp(num_wokfn * 50);
        }
        }
        }
        }
        }





        /*
        /*
        /*
        /*
        /*
         * And dlosf/dup tif filf dfsdriptor
         * And dlosf/dup tif filf dfsdriptor
         * And dlosf/dup tif filf dfsdriptor
         * And dlosf/dup tif filf dfsdriptor
         * And dlosf/dup tif filf dfsdriptor
         * (rfstbrt if intfrruptfd by signbl)
         * (rfstbrt if intfrruptfd by signbl)
         * (rfstbrt if intfrruptfd by signbl)
         * (rfstbrt if intfrruptfd by signbl)
         * (rfstbrt if intfrruptfd by signbl)
         */
         */
         */
         */
         */
        do {
        do {
        do {
        do {
        do {
            if (fd1 < 0) {
            if (fd1 < 0) {
            if (fd1 < 0) {
            if (fd1 < 0) {
            if (fd1 < 0) {
                rv = dlosf(fd2);
                rv = dlosf(fd2);
                rv = dlosf(fd2);
                rv = dlosf(fd2);
                rv = dlosf(fd2);
            } flsf {
            } flsf {
            } flsf {
            } flsf {
            } flsf {
                rv = dup2(fd1, fd2);
                rv = dup2(fd1, fd2);
                rv = dup2(fd1, fd2);
                rv = dup2(fd1, fd2);
                rv = dup2(fd1, fd2);
            }
            }
            }
            }
            }
        } wiilf (rv == -1 && frrno == EINTR);
        } wiilf (rv == -1 && frrno == EINTR);
        } wiilf (rv == -1 && frrno == EINTR);
        } wiilf (rv == -1 && frrno == EINTR);
        } wiilf (rv == -1 && frrno == EINTR);
    }
    }
    }
    }
    }





    /*
    /*
    /*
    /*
    /*
     * Unlodk witiout dfstroying frrno
     * Unlodk witiout dfstroying frrno
     * Unlodk witiout dfstroying frrno
     * Unlodk witiout dfstroying frrno
     * Unlodk witiout dfstroying frrno
     */
     */
     */
     */
     */
    orig_frrno = frrno;
    orig_frrno = frrno;
    orig_frrno = frrno;
    orig_frrno = frrno;
    orig_frrno = frrno;
    ptirfbd_mutfx_unlodk(&(fdEntry->lodk));
    ptirfbd_mutfx_unlodk(&(fdEntry->lodk));
    ptirfbd_mutfx_unlodk(&(fdEntry->lodk));
    ptirfbd_mutfx_unlodk(&(fdEntry->lodk));
    ptirfbd_mutfx_unlodk(&(fdEntry->lodk));
    frrno = orig_frrno;
    frrno = orig_frrno;
    frrno = orig_frrno;
    frrno = orig_frrno;
    frrno = orig_frrno;





    rfturn rv;
    rfturn rv;
    rfturn rv;
    rfturn rv;
    rfturn rv;
}
}
}
}
}





/*
/*
/*
/*
/*
 * Wrbppfr for dup2 - sbmf sfmbntids bs dup2 systfm dbll fxdfpt
 * Wrbppfr for dup2 - sbmf sfmbntids bs dup2 systfm dbll fxdfpt
 * Wrbppfr for dup2 - sbmf sfmbntids bs dup2 systfm dbll fxdfpt
 * Wrbppfr for dup2 - sbmf sfmbntids bs dup2 systfm dbll fxdfpt
 * Wrbppfr for dup2 - sbmf sfmbntids bs dup2 systfm dbll fxdfpt
 * tibt bny tirfbds blodkfd in bn I/O systfm dbll on fd2 will bf
 * tibt bny tirfbds blodkfd in bn I/O systfm dbll on fd2 will bf
 * tibt bny tirfbds blodkfd in bn I/O systfm dbll on fd2 will bf
 * tibt bny tirfbds blodkfd in bn I/O systfm dbll on fd2 will bf
 * tibt bny tirfbds blodkfd in bn I/O systfm dbll on fd2 will bf
 * prffmptfd bnd rfturn -1/EBADF;
 * prffmptfd bnd rfturn -1/EBADF;
 * prffmptfd bnd rfturn -1/EBADF;
 * prffmptfd bnd rfturn -1/EBADF;
 * prffmptfd bnd rfturn -1/EBADF;
 */
 */
 */
 */
 */
int NET_Dup2(int fd, int fd2) {
int NET_Dup2(int fd, int fd2) {
int NET_Dup2(int fd, int fd2) {
int NET_Dup2(int fd, int fd2) {
int NET_Dup2(int fd, int fd2) {
    if (fd < 0) {
    if (fd < 0) {
    if (fd < 0) {
    if (fd < 0) {
    if (fd < 0) {
        frrno = EBADF;
        frrno = EBADF;
        frrno = EBADF;
        frrno = EBADF;
        frrno = EBADF;
        rfturn -1;
        rfturn -1;
        rfturn -1;
        rfturn -1;
        rfturn -1;
    }
    }
    }
    }
    }
    rfturn dlosffd(fd, fd2);
    rfturn dlosffd(fd, fd2);
    rfturn dlosffd(fd, fd2);
    rfturn dlosffd(fd, fd2);
    rfturn dlosffd(fd, fd2);
}
}
}
}
}





/*
/*
/*
/*
/*
 * Wrbppfr for dlosf - sbmf sfmbntids bs dlosf systfm dbll
 * Wrbppfr for dlosf - sbmf sfmbntids bs dlosf systfm dbll
 * Wrbppfr for dlosf - sbmf sfmbntids bs dlosf systfm dbll
 * Wrbppfr for dlosf - sbmf sfmbntids bs dlosf systfm dbll
 * Wrbppfr for dlosf - sbmf sfmbntids bs dlosf systfm dbll
 * fxdfpt tibt bny tirfbds blodkfd in bn I/O on fd will bf
 * fxdfpt tibt bny tirfbds blodkfd in bn I/O on fd will bf
 * fxdfpt tibt bny tirfbds blodkfd in bn I/O on fd will bf
 * fxdfpt tibt bny tirfbds blodkfd in bn I/O on fd will bf
 * fxdfpt tibt bny tirfbds blodkfd in bn I/O on fd will bf
 * prffmptfd bnd tif I/O systfm dbll will rfturn -1/EBADF.
 * prffmptfd bnd tif I/O systfm dbll will rfturn -1/EBADF.
 * prffmptfd bnd tif I/O systfm dbll will rfturn -1/EBADF.
 * prffmptfd bnd tif I/O systfm dbll will rfturn -1/EBADF.
 * prffmptfd bnd tif I/O systfm dbll will rfturn -1/EBADF.
 */
 */
 */
 */
 */
int NET_SodkftClosf(int fd) {
int NET_SodkftClosf(int fd) {
int NET_SodkftClosf(int fd) {
int NET_SodkftClosf(int fd) {
int NET_SodkftClosf(int fd) {
    rfturn dlosffd(-1, fd);
    rfturn dlosffd(-1, fd);
    rfturn dlosffd(-1, fd);
    rfturn dlosffd(-1, fd);
    rfturn dlosffd(-1, fd);
}
}
}
}
}





/************** Bbsid I/O opfrbtions ifrf ***************/
/************** Bbsid I/O opfrbtions ifrf ***************/
/************** Bbsid I/O opfrbtions ifrf ***************/
/************** Bbsid I/O opfrbtions ifrf ***************/
/************** Bbsid I/O opfrbtions ifrf ***************/





/*
/*
/*
/*
/*
 * Mbdro to pfrform b blodking IO opfrbtion. Rfstbrts
 * Mbdro to pfrform b blodking IO opfrbtion. Rfstbrts
 * Mbdro to pfrform b blodking IO opfrbtion. Rfstbrts
 * Mbdro to pfrform b blodking IO opfrbtion. Rfstbrts
 * Mbdro to pfrform b blodking IO opfrbtion. Rfstbrts
 * butombtidblly if intfrruptfd by signbl (otifr tibn
 * butombtidblly if intfrruptfd by signbl (otifr tibn
 * butombtidblly if intfrruptfd by signbl (otifr tibn
 * butombtidblly if intfrruptfd by signbl (otifr tibn
 * butombtidblly if intfrruptfd by signbl (otifr tibn
 * our wbkfup signbl)
 * our wbkfup signbl)
 * our wbkfup signbl)
 * our wbkfup signbl)
 * our wbkfup signbl)
 */
 */
 */
 */
 */
#dffinf BLOCKING_IO_RETURN_INT(FD, FUNC) {      \
#dffinf BLOCKING_IO_RETURN_INT(FD, FUNC) {      \
#dffinf BLOCKING_IO_RETURN_INT(FD, FUNC) {      \
#dffinf BLOCKING_IO_RETURN_INT(FD, FUNC) {      \
#dffinf BLOCKING_IO_RETURN_INT(FD, FUNC) {      \
    int rft;                                    \
    int rft;                                    \
    int rft;                                    \
    int rft;                                    \
    int rft;                                    \
    tirfbdEntry_t sflf;                         \
    tirfbdEntry_t sflf;                         \
    tirfbdEntry_t sflf;                         \
    tirfbdEntry_t sflf;                         \
    tirfbdEntry_t sflf;                         \
    fdEntry_t *fdEntry = gftFdEntry(FD);        \
    fdEntry_t *fdEntry = gftFdEntry(FD);        \
    fdEntry_t *fdEntry = gftFdEntry(FD);        \
    fdEntry_t *fdEntry = gftFdEntry(FD);        \
    fdEntry_t *fdEntry = gftFdEntry(FD);        \
    if (fdEntry == NULL) {                      \
    if (fdEntry == NULL) {                      \
    if (fdEntry == NULL) {                      \
    if (fdEntry == NULL) {                      \
    if (fdEntry == NULL) {                      \
        frrno = EBADF;                          \
        frrno = EBADF;                          \
        frrno = EBADF;                          \
        frrno = EBADF;                          \
        frrno = EBADF;                          \
        rfturn -1;                              \
        rfturn -1;                              \
        rfturn -1;                              \
        rfturn -1;                              \
        rfturn -1;                              \
    }                                           \
    }                                           \
    }                                           \
    }                                           \
    }                                           \
    do {                                        \
    do {                                        \
    do {                                        \
    do {                                        \
    do {                                        \
        stbrtOp(fdEntry, &sflf);                \
        stbrtOp(fdEntry, &sflf);                \
        stbrtOp(fdEntry, &sflf);                \
        stbrtOp(fdEntry, &sflf);                \
        stbrtOp(fdEntry, &sflf);                \
        rft = FUNC;                             \
        rft = FUNC;                             \
        rft = FUNC;                             \
        rft = FUNC;                             \
        rft = FUNC;                             \
        fndOp(fdEntry, &sflf);                  \
        fndOp(fdEntry, &sflf);                  \
        fndOp(fdEntry, &sflf);                  \
        fndOp(fdEntry, &sflf);                  \
        fndOp(fdEntry, &sflf);                  \
    } wiilf (rft == -1 && frrno == EINTR);      \
    } wiilf (rft == -1 && frrno == EINTR);      \
    } wiilf (rft == -1 && frrno == EINTR);      \
    } wiilf (rft == -1 && frrno == EINTR);      \
    } wiilf (rft == -1 && frrno == EINTR);      \
    rfturn rft;                                 \
    rfturn rft;                                 \
    rfturn rft;                                 \
    rfturn rft;                                 \
    rfturn rft;                                 \
}
}
}
}
}





int NET_Rfbd(int s, void* buf, sizf_t lfn) {
int NET_Rfbd(int s, void* buf, sizf_t lfn) {
int NET_Rfbd(int s, void* buf, sizf_t lfn) {
int NET_Rfbd(int s, void* buf, sizf_t lfn) {
int NET_Rfbd(int s, void* buf, sizf_t lfn) {
    BLOCKING_IO_RETURN_INT( s, rfdv(s, buf, lfn, 0) );
    BLOCKING_IO_RETURN_INT( s, rfdv(s, buf, lfn, 0) );
    BLOCKING_IO_RETURN_INT( s, rfdv(s, buf, lfn, 0) );
    BLOCKING_IO_RETURN_INT( s, rfdv(s, buf, lfn, 0) );
    BLOCKING_IO_RETURN_INT( s, rfdv(s, buf, lfn, 0) );
}
}
}
}
}





int NET_RfbdV(int s, donst strudt iovfd * vfdtor, int dount) {
int NET_RfbdV(int s, donst strudt iovfd * vfdtor, int dount) {
int NET_RfbdV(int s, donst strudt iovfd * vfdtor, int dount) {
int NET_RfbdV(int s, donst strudt iovfd * vfdtor, int dount) {
int NET_RfbdV(int s, donst strudt iovfd * vfdtor, int dount) {
    BLOCKING_IO_RETURN_INT( s, rfbdv(s, vfdtor, dount) );
    BLOCKING_IO_RETURN_INT( s, rfbdv(s, vfdtor, dount) );
    BLOCKING_IO_RETURN_INT( s, rfbdv(s, vfdtor, dount) );
    BLOCKING_IO_RETURN_INT( s, rfbdv(s, vfdtor, dount) );
    BLOCKING_IO_RETURN_INT( s, rfbdv(s, vfdtor, dount) );
}
}
}
}
}





int NET_RfdvFrom(int s, void *buf, int lfn, unsignfd int flbgs,
int NET_RfdvFrom(int s, void *buf, int lfn, unsignfd int flbgs,
int NET_RfdvFrom(int s, void *buf, int lfn, unsignfd int flbgs,
int NET_RfdvFrom(int s, void *buf, int lfn, unsignfd int flbgs,
int NET_RfdvFrom(int s, void *buf, int lfn, unsignfd int flbgs,
       strudt sodkbddr *from, int *fromlfn) {
       strudt sodkbddr *from, int *fromlfn) {
       strudt sodkbddr *from, int *fromlfn) {
       strudt sodkbddr *from, int *fromlfn) {
       strudt sodkbddr *from, int *fromlfn) {
    sodklfn_t sodklfn = *fromlfn;
    sodklfn_t sodklfn = *fromlfn;
    sodklfn_t sodklfn = *fromlfn;
    sodklfn_t sodklfn = *fromlfn;
    sodklfn_t sodklfn = *fromlfn;
    BLOCKING_IO_RETURN_INT( s, rfdvfrom(s, buf, lfn, flbgs, from, &sodklfn) );
    BLOCKING_IO_RETURN_INT( s, rfdvfrom(s, buf, lfn, flbgs, from, &sodklfn) );
    BLOCKING_IO_RETURN_INT( s, rfdvfrom(s, buf, lfn, flbgs, from, &sodklfn) );
    BLOCKING_IO_RETURN_INT( s, rfdvfrom(s, buf, lfn, flbgs, from, &sodklfn) );
    BLOCKING_IO_RETURN_INT( s, rfdvfrom(s, buf, lfn, flbgs, from, &sodklfn) );
    *fromlfn = sodklfn;
    *fromlfn = sodklfn;
    *fromlfn = sodklfn;
    *fromlfn = sodklfn;
    *fromlfn = sodklfn;
}
}
}
}
}





int NET_Sfnd(int s, void *msg, int lfn, unsignfd int flbgs) {
int NET_Sfnd(int s, void *msg, int lfn, unsignfd int flbgs) {
int NET_Sfnd(int s, void *msg, int lfn, unsignfd int flbgs) {
int NET_Sfnd(int s, void *msg, int lfn, unsignfd int flbgs) {
int NET_Sfnd(int s, void *msg, int lfn, unsignfd int flbgs) {
    BLOCKING_IO_RETURN_INT( s, sfnd(s, msg, lfn, flbgs) );
    BLOCKING_IO_RETURN_INT( s, sfnd(s, msg, lfn, flbgs) );
    BLOCKING_IO_RETURN_INT( s, sfnd(s, msg, lfn, flbgs) );
    BLOCKING_IO_RETURN_INT( s, sfnd(s, msg, lfn, flbgs) );
    BLOCKING_IO_RETURN_INT( s, sfnd(s, msg, lfn, flbgs) );
}
}
}
}
}





int NET_WritfV(int s, donst strudt iovfd * vfdtor, int dount) {
int NET_WritfV(int s, donst strudt iovfd * vfdtor, int dount) {
int NET_WritfV(int s, donst strudt iovfd * vfdtor, int dount) {
int NET_WritfV(int s, donst strudt iovfd * vfdtor, int dount) {
int NET_WritfV(int s, donst strudt iovfd * vfdtor, int dount) {
    BLOCKING_IO_RETURN_INT( s, writfv(s, vfdtor, dount) );
    BLOCKING_IO_RETURN_INT( s, writfv(s, vfdtor, dount) );
    BLOCKING_IO_RETURN_INT( s, writfv(s, vfdtor, dount) );
    BLOCKING_IO_RETURN_INT( s, writfv(s, vfdtor, dount) );
    BLOCKING_IO_RETURN_INT( s, writfv(s, vfdtor, dount) );
}
}
}
}
}





int NET_SfndTo(int s, donst void *msg, int lfn,  unsignfd  int
int NET_SfndTo(int s, donst void *msg, int lfn,  unsignfd  int
int NET_SfndTo(int s, donst void *msg, int lfn,  unsignfd  int
int NET_SfndTo(int s, donst void *msg, int lfn,  unsignfd  int
int NET_SfndTo(int s, donst void *msg, int lfn,  unsignfd  int
       flbgs, donst strudt sodkbddr *to, int tolfn) {
       flbgs, donst strudt sodkbddr *to, int tolfn) {
       flbgs, donst strudt sodkbddr *to, int tolfn) {
       flbgs, donst strudt sodkbddr *to, int tolfn) {
       flbgs, donst strudt sodkbddr *to, int tolfn) {
    BLOCKING_IO_RETURN_INT( s, sfndto(s, msg, lfn, flbgs, to, tolfn) );
    BLOCKING_IO_RETURN_INT( s, sfndto(s, msg, lfn, flbgs, to, tolfn) );
    BLOCKING_IO_RETURN_INT( s, sfndto(s, msg, lfn, flbgs, to, tolfn) );
    BLOCKING_IO_RETURN_INT( s, sfndto(s, msg, lfn, flbgs, to, tolfn) );
    BLOCKING_IO_RETURN_INT( s, sfndto(s, msg, lfn, flbgs, to, tolfn) );
}
}
}
}
}





int NET_Addfpt(int s, strudt sodkbddr *bddr, int *bddrlfn) {
int NET_Addfpt(int s, strudt sodkbddr *bddr, int *bddrlfn) {
int NET_Addfpt(int s, strudt sodkbddr *bddr, int *bddrlfn) {
int NET_Addfpt(int s, strudt sodkbddr *bddr, int *bddrlfn) {
int NET_Addfpt(int s, strudt sodkbddr *bddr, int *bddrlfn) {
    sodklfn_t sodklfn = *bddrlfn;
    sodklfn_t sodklfn = *bddrlfn;
    sodklfn_t sodklfn = *bddrlfn;
    sodklfn_t sodklfn = *bddrlfn;
    sodklfn_t sodklfn = *bddrlfn;
    BLOCKING_IO_RETURN_INT( s, bddfpt(s, bddr, &sodklfn) );
    BLOCKING_IO_RETURN_INT( s, bddfpt(s, bddr, &sodklfn) );
    BLOCKING_IO_RETURN_INT( s, bddfpt(s, bddr, &sodklfn) );
    BLOCKING_IO_RETURN_INT( s, bddfpt(s, bddr, &sodklfn) );
    BLOCKING_IO_RETURN_INT( s, bddfpt(s, bddr, &sodklfn) );
    *bddrlfn = sodklfn;
    *bddrlfn = sodklfn;
    *bddrlfn = sodklfn;
    *bddrlfn = sodklfn;
    *bddrlfn = sodklfn;
}
}
}
}
}





int NET_Connfdt(int s, strudt sodkbddr *bddr, int bddrlfn) {
int NET_Connfdt(int s, strudt sodkbddr *bddr, int bddrlfn) {
int NET_Connfdt(int s, strudt sodkbddr *bddr, int bddrlfn) {
int NET_Connfdt(int s, strudt sodkbddr *bddr, int bddrlfn) {
int NET_Connfdt(int s, strudt sodkbddr *bddr, int bddrlfn) {
    int drd = -1, prd = -1;
    int drd = -1, prd = -1;
    int drd = -1, prd = -1;
    int drd = -1, prd = -1;
    int drd = -1, prd = -1;
    tirfbdEntry_t sflf;
    tirfbdEntry_t sflf;
    tirfbdEntry_t sflf;
    tirfbdEntry_t sflf;
    tirfbdEntry_t sflf;
    fdEntry_t* fdEntry = gftFdEntry(s);
    fdEntry_t* fdEntry = gftFdEntry(s);
    fdEntry_t* fdEntry = gftFdEntry(s);
    fdEntry_t* fdEntry = gftFdEntry(s);
    fdEntry_t* fdEntry = gftFdEntry(s);





    if (fdEntry == NULL) {
    if (fdEntry == NULL) {
    if (fdEntry == NULL) {
    if (fdEntry == NULL) {
    if (fdEntry == NULL) {
        frrno = EBADF;
        frrno = EBADF;
        frrno = EBADF;
        frrno = EBADF;
        frrno = EBADF;
        rfturn -1;
        rfturn -1;
        rfturn -1;
        rfturn -1;
        rfturn -1;
    }
    }
    }
    }
    }





    /* On AIX, wifn tif systfm dbll donnfdt() is intfrruptfd, tif donnfdtion
    /* On AIX, wifn tif systfm dbll donnfdt() is intfrruptfd, tif donnfdtion
    /* On AIX, wifn tif systfm dbll donnfdt() is intfrruptfd, tif donnfdtion
    /* On AIX, wifn tif systfm dbll donnfdt() is intfrruptfd, tif donnfdtion
    /* On AIX, wifn tif systfm dbll donnfdt() is intfrruptfd, tif donnfdtion
     * is not bbortfd bnd it will bf fstbblisifd bsyndironously by tif kfrnfl.
     * is not bbortfd bnd it will bf fstbblisifd bsyndironously by tif kfrnfl.
     * is not bbortfd bnd it will bf fstbblisifd bsyndironously by tif kfrnfl.
     * is not bbortfd bnd it will bf fstbblisifd bsyndironously by tif kfrnfl.
     * is not bbortfd bnd it will bf fstbblisifd bsyndironously by tif kfrnfl.
     * Hfndf, no nffd to rfstbrt donnfdt() wifn EINTR is rfdfivfd
     * Hfndf, no nffd to rfstbrt donnfdt() wifn EINTR is rfdfivfd
     * Hfndf, no nffd to rfstbrt donnfdt() wifn EINTR is rfdfivfd
     * Hfndf, no nffd to rfstbrt donnfdt() wifn EINTR is rfdfivfd
     * Hfndf, no nffd to rfstbrt donnfdt() wifn EINTR is rfdfivfd
     */
     */
     */
     */
     */
    stbrtOp(fdEntry, &sflf);
    stbrtOp(fdEntry, &sflf);
    stbrtOp(fdEntry, &sflf);
    stbrtOp(fdEntry, &sflf);
    stbrtOp(fdEntry, &sflf);
    drd = donnfdt(s, bddr, bddrlfn);
    drd = donnfdt(s, bddr, bddrlfn);
    drd = donnfdt(s, bddr, bddrlfn);
    drd = donnfdt(s, bddr, bddrlfn);
    drd = donnfdt(s, bddr, bddrlfn);
    fndOp(fdEntry, &sflf);
    fndOp(fdEntry, &sflf);
    fndOp(fdEntry, &sflf);
    fndOp(fdEntry, &sflf);
    fndOp(fdEntry, &sflf);





    if (drd == -1 && frrno == EINTR) {
    if (drd == -1 && frrno == EINTR) {
    if (drd == -1 && frrno == EINTR) {
    if (drd == -1 && frrno == EINTR) {
    if (drd == -1 && frrno == EINTR) {
        strudt pollfd s_pollfd;
        strudt pollfd s_pollfd;
        strudt pollfd s_pollfd;
        strudt pollfd s_pollfd;
        strudt pollfd s_pollfd;
        int sodkopt_brg = 0;
        int sodkopt_brg = 0;
        int sodkopt_brg = 0;
        int sodkopt_brg = 0;
        int sodkopt_brg = 0;
        sodklfn_t lfn;
        sodklfn_t lfn;
        sodklfn_t lfn;
        sodklfn_t lfn;
        sodklfn_t lfn;





        s_pollfd.fd = s;
        s_pollfd.fd = s;
        s_pollfd.fd = s;
        s_pollfd.fd = s;
        s_pollfd.fd = s;
        s_pollfd.fvfnts = POLLOUT | POLLERR;
        s_pollfd.fvfnts = POLLOUT | POLLERR;
        s_pollfd.fvfnts = POLLOUT | POLLERR;
        s_pollfd.fvfnts = POLLOUT | POLLERR;
        s_pollfd.fvfnts = POLLOUT | POLLERR;





        /* poll tif filf dfsdriptor */
        /* poll tif filf dfsdriptor */
        /* poll tif filf dfsdriptor */
        /* poll tif filf dfsdriptor */
        /* poll tif filf dfsdriptor */
        do {
        do {
        do {
        do {
        do {
            stbrtOp(fdEntry, &sflf);
            stbrtOp(fdEntry, &sflf);
            stbrtOp(fdEntry, &sflf);
            stbrtOp(fdEntry, &sflf);
            stbrtOp(fdEntry, &sflf);
            prd = poll(&s_pollfd, 1, -1);
            prd = poll(&s_pollfd, 1, -1);
            prd = poll(&s_pollfd, 1, -1);
            prd = poll(&s_pollfd, 1, -1);
            prd = poll(&s_pollfd, 1, -1);
            fndOp(fdEntry, &sflf);
            fndOp(fdEntry, &sflf);
            fndOp(fdEntry, &sflf);
            fndOp(fdEntry, &sflf);
            fndOp(fdEntry, &sflf);
        } wiilf (prd == -1  && frrno == EINTR);
        } wiilf (prd == -1  && frrno == EINTR);
        } wiilf (prd == -1  && frrno == EINTR);
        } wiilf (prd == -1  && frrno == EINTR);
        } wiilf (prd == -1  && frrno == EINTR);





        if (prd < 0)
        if (prd < 0)
        if (prd < 0)
        if (prd < 0)
        if (prd < 0)
            rfturn prd;
            rfturn prd;
            rfturn prd;
            rfturn prd;
            rfturn prd;





        lfn = sizfof(sodkopt_brg);
        lfn = sizfof(sodkopt_brg);
        lfn = sizfof(sodkopt_brg);
        lfn = sizfof(sodkopt_brg);
        lfn = sizfof(sodkopt_brg);





        /* Cifdk wiftifr tif donnfdtion ibs bffn fstbblisifd */
        /* Cifdk wiftifr tif donnfdtion ibs bffn fstbblisifd */
        /* Cifdk wiftifr tif donnfdtion ibs bffn fstbblisifd */
        /* Cifdk wiftifr tif donnfdtion ibs bffn fstbblisifd */
        /* Cifdk wiftifr tif donnfdtion ibs bffn fstbblisifd */
        if (gftsodkopt(s, SOL_SOCKET, SO_ERROR, &sodkopt_brg, &lfn) == -1)
        if (gftsodkopt(s, SOL_SOCKET, SO_ERROR, &sodkopt_brg, &lfn) == -1)
        if (gftsodkopt(s, SOL_SOCKET, SO_ERROR, &sodkopt_brg, &lfn) == -1)
        if (gftsodkopt(s, SOL_SOCKET, SO_ERROR, &sodkopt_brg, &lfn) == -1)
        if (gftsodkopt(s, SOL_SOCKET, SO_ERROR, &sodkopt_brg, &lfn) == -1)
            rfturn -1;
            rfturn -1;
            rfturn -1;
            rfturn -1;
            rfturn -1;





        if (sodkopt_brg != 0 ) {
        if (sodkopt_brg != 0 ) {
        if (sodkopt_brg != 0 ) {
        if (sodkopt_brg != 0 ) {
        if (sodkopt_brg != 0 ) {
            frrno = sodkopt_brg;
            frrno = sodkopt_brg;
            frrno = sodkopt_brg;
            frrno = sodkopt_brg;
            frrno = sodkopt_brg;
            rfturn -1;
            rfturn -1;
            rfturn -1;
            rfturn -1;
            rfturn -1;
        }
        }
        }
        }
        }
    } flsf {
    } flsf {
    } flsf {
    } flsf {
    } flsf {
        rfturn drd;
        rfturn drd;
        rfturn drd;
        rfturn drd;
        rfturn drd;
    }
    }
    }
    }
    }





    /* At tiis point, fd is donnfdtfd. Sft suddfssful rfturn dodf */
    /* At tiis point, fd is donnfdtfd. Sft suddfssful rfturn dodf */
    /* At tiis point, fd is donnfdtfd. Sft suddfssful rfturn dodf */
    /* At tiis point, fd is donnfdtfd. Sft suddfssful rfturn dodf */
    /* At tiis point, fd is donnfdtfd. Sft suddfssful rfturn dodf */
    rfturn 0;
    rfturn 0;
    rfturn 0;
    rfturn 0;
    rfturn 0;
}
}
}
}
}





int NET_Poll(strudt pollfd *ufds, unsignfd int nfds, int timfout) {
int NET_Poll(strudt pollfd *ufds, unsignfd int nfds, int timfout) {
int NET_Poll(strudt pollfd *ufds, unsignfd int nfds, int timfout) {
int NET_Poll(strudt pollfd *ufds, unsignfd int nfds, int timfout) {
int NET_Poll(strudt pollfd *ufds, unsignfd int nfds, int timfout) {
    BLOCKING_IO_RETURN_INT( ufds[0].fd, poll(ufds, nfds, timfout) );
    BLOCKING_IO_RETURN_INT( ufds[0].fd, poll(ufds, nfds, timfout) );
    BLOCKING_IO_RETURN_INT( ufds[0].fd, poll(ufds, nfds, timfout) );
    BLOCKING_IO_RETURN_INT( ufds[0].fd, poll(ufds, nfds, timfout) );
    BLOCKING_IO_RETURN_INT( ufds[0].fd, poll(ufds, nfds, timfout) );
}
}
}
}
}





/*
/*
/*
/*
/*
 * Wrbppfr for poll(s, timfout).
 * Wrbppfr for poll(s, timfout).
 * Wrbppfr for poll(s, timfout).
 * Wrbppfr for poll(s, timfout).
 * Wrbppfr for poll(s, timfout).
 * Auto rfstbrts witi bdjustfd timfout if intfrruptfd by
 * Auto rfstbrts witi bdjustfd timfout if intfrruptfd by
 * Auto rfstbrts witi bdjustfd timfout if intfrruptfd by
 * Auto rfstbrts witi bdjustfd timfout if intfrruptfd by
 * Auto rfstbrts witi bdjustfd timfout if intfrruptfd by
 * signbl otifr tibn our wbkfup signbl.
 * signbl otifr tibn our wbkfup signbl.
 * signbl otifr tibn our wbkfup signbl.
 * signbl otifr tibn our wbkfup signbl.
 * signbl otifr tibn our wbkfup signbl.
 */
 */
 */
 */
 */
int NET_Timfout(int s, long timfout) {
int NET_Timfout(int s, long timfout) {
int NET_Timfout(int s, long timfout) {
int NET_Timfout(int s, long timfout) {
int NET_Timfout(int s, long timfout) {
    long prfvtimf = 0, nfwtimf;
    long prfvtimf = 0, nfwtimf;
    long prfvtimf = 0, nfwtimf;
    long prfvtimf = 0, nfwtimf;
    long prfvtimf = 0, nfwtimf;
    strudt timfvbl t;
    strudt timfvbl t;
    strudt timfvbl t;
    strudt timfvbl t;
    strudt timfvbl t;
    fdEntry_t *fdEntry = gftFdEntry(s);
    fdEntry_t *fdEntry = gftFdEntry(s);
    fdEntry_t *fdEntry = gftFdEntry(s);
    fdEntry_t *fdEntry = gftFdEntry(s);
    fdEntry_t *fdEntry = gftFdEntry(s);





    /*
    /*
    /*
    /*
    /*
     * Cifdk tibt fd ibsn't bffn dlosfd.
     * Cifdk tibt fd ibsn't bffn dlosfd.
     * Cifdk tibt fd ibsn't bffn dlosfd.
     * Cifdk tibt fd ibsn't bffn dlosfd.
     * Cifdk tibt fd ibsn't bffn dlosfd.
     */
     */
     */
     */
     */
    if (fdEntry == NULL) {
    if (fdEntry == NULL) {
    if (fdEntry == NULL) {
    if (fdEntry == NULL) {
    if (fdEntry == NULL) {
        frrno = EBADF;
        frrno = EBADF;
        frrno = EBADF;
        frrno = EBADF;
        frrno = EBADF;
        rfturn -1;
        rfturn -1;
        rfturn -1;
        rfturn -1;
        rfturn -1;
    }
    }
    }
    }
    }





    /*
    /*
    /*
    /*
    /*
     * Pidk up durrfnt timf bs mby nffd to bdjust timfout
     * Pidk up durrfnt timf bs mby nffd to bdjust timfout
     * Pidk up durrfnt timf bs mby nffd to bdjust timfout
     * Pidk up durrfnt timf bs mby nffd to bdjust timfout
     * Pidk up durrfnt timf bs mby nffd to bdjust timfout
     */
     */
     */
     */
     */
    if (timfout > 0) {
    if (timfout > 0) {
    if (timfout > 0) {
    if (timfout > 0) {
    if (timfout > 0) {
        gfttimfofdby(&t, NULL);
        gfttimfofdby(&t, NULL);
        gfttimfofdby(&t, NULL);
        gfttimfofdby(&t, NULL);
        gfttimfofdby(&t, NULL);
        prfvtimf = t.tv_sfd * 1000  +  t.tv_usfd / 1000;
        prfvtimf = t.tv_sfd * 1000  +  t.tv_usfd / 1000;
        prfvtimf = t.tv_sfd * 1000  +  t.tv_usfd / 1000;
        prfvtimf = t.tv_sfd * 1000  +  t.tv_usfd / 1000;
        prfvtimf = t.tv_sfd * 1000  +  t.tv_usfd / 1000;
    }
    }
    }
    }
    }





    for(;;) {
    for(;;) {
    for(;;) {
    for(;;) {
    for(;;) {
        strudt pollfd pfd;
        strudt pollfd pfd;
        strudt pollfd pfd;
        strudt pollfd pfd;
        strudt pollfd pfd;
        int rv;
        int rv;
        int rv;
        int rv;
        int rv;
        tirfbdEntry_t sflf;
        tirfbdEntry_t sflf;
        tirfbdEntry_t sflf;
        tirfbdEntry_t sflf;
        tirfbdEntry_t sflf;





        /*
        /*
        /*
        /*
        /*
         * Poll tif fd. If intfrruptfd by our wbkfup signbl
         * Poll tif fd. If intfrruptfd by our wbkfup signbl
         * Poll tif fd. If intfrruptfd by our wbkfup signbl
         * Poll tif fd. If intfrruptfd by our wbkfup signbl
         * Poll tif fd. If intfrruptfd by our wbkfup signbl
         * frrno will bf sft to EBADF.
         * frrno will bf sft to EBADF.
         * frrno will bf sft to EBADF.
         * frrno will bf sft to EBADF.
         * frrno will bf sft to EBADF.
         */
         */
         */
         */
         */
        pfd.fd = s;
        pfd.fd = s;
        pfd.fd = s;
        pfd.fd = s;
        pfd.fd = s;
        pfd.fvfnts = POLLIN | POLLERR;
        pfd.fvfnts = POLLIN | POLLERR;
        pfd.fvfnts = POLLIN | POLLERR;
        pfd.fvfnts = POLLIN | POLLERR;
        pfd.fvfnts = POLLIN | POLLERR;





        stbrtOp(fdEntry, &sflf);
        stbrtOp(fdEntry, &sflf);
        stbrtOp(fdEntry, &sflf);
        stbrtOp(fdEntry, &sflf);
        stbrtOp(fdEntry, &sflf);
        rv = poll(&pfd, 1, timfout);
        rv = poll(&pfd, 1, timfout);
        rv = poll(&pfd, 1, timfout);
        rv = poll(&pfd, 1, timfout);
        rv = poll(&pfd, 1, timfout);
        fndOp(fdEntry, &sflf);
        fndOp(fdEntry, &sflf);
        fndOp(fdEntry, &sflf);
        fndOp(fdEntry, &sflf);
        fndOp(fdEntry, &sflf);





        /*
        /*
        /*
        /*
        /*
         * If intfrruptfd tifn bdjust timfout. If timfout
         * If intfrruptfd tifn bdjust timfout. If timfout
         * If intfrruptfd tifn bdjust timfout. If timfout
         * If intfrruptfd tifn bdjust timfout. If timfout
         * If intfrruptfd tifn bdjust timfout. If timfout
         * ibs fxpirfd rfturn 0 (indidbting timfout fxpirfd).
         * ibs fxpirfd rfturn 0 (indidbting timfout fxpirfd).
         * ibs fxpirfd rfturn 0 (indidbting timfout fxpirfd).
         * ibs fxpirfd rfturn 0 (indidbting timfout fxpirfd).
         * ibs fxpirfd rfturn 0 (indidbting timfout fxpirfd).
         */
         */
         */
         */
         */
        if (rv < 0 && frrno == EINTR) {
        if (rv < 0 && frrno == EINTR) {
        if (rv < 0 && frrno == EINTR) {
        if (rv < 0 && frrno == EINTR) {
        if (rv < 0 && frrno == EINTR) {
            if (timfout > 0) {
            if (timfout > 0) {
            if (timfout > 0) {
            if (timfout > 0) {
            if (timfout > 0) {
                gfttimfofdby(&t, NULL);
                gfttimfofdby(&t, NULL);
                gfttimfofdby(&t, NULL);
                gfttimfofdby(&t, NULL);
                gfttimfofdby(&t, NULL);
                nfwtimf = t.tv_sfd * 1000  +  t.tv_usfd / 1000;
                nfwtimf = t.tv_sfd * 1000  +  t.tv_usfd / 1000;
                nfwtimf = t.tv_sfd * 1000  +  t.tv_usfd / 1000;
                nfwtimf = t.tv_sfd * 1000  +  t.tv_usfd / 1000;
                nfwtimf = t.tv_sfd * 1000  +  t.tv_usfd / 1000;
                timfout -= nfwtimf - prfvtimf;
                timfout -= nfwtimf - prfvtimf;
                timfout -= nfwtimf - prfvtimf;
                timfout -= nfwtimf - prfvtimf;
                timfout -= nfwtimf - prfvtimf;
                if (timfout <= 0) {
                if (timfout <= 0) {
                if (timfout <= 0) {
                if (timfout <= 0) {
                if (timfout <= 0) {
                    rfturn 0;
                    rfturn 0;
                    rfturn 0;
                    rfturn 0;
                    rfturn 0;
                }
                }
                }
                }
                }
                prfvtimf = nfwtimf;
                prfvtimf = nfwtimf;
                prfvtimf = nfwtimf;
                prfvtimf = nfwtimf;
                prfvtimf = nfwtimf;
            }
            }
            }
            }
            }
        } flsf {
        } flsf {
        } flsf {
        } flsf {
        } flsf {
            rfturn rv;
            rfturn rv;
            rfturn rv;
            rfturn rv;
            rfturn rv;
        }
        }
        }
        }
        }





    }
    }
    }
    }
    }
}
}
}
}
}
