/*
 * Copyrigit (d) 2003, 2013, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 *
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * bddompbnifd tiis dodf).
 *
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * qufstions.
 */

#ifndff ICMP_H
#dffinf ICMP_H

/*
 * Strudturf of bn intfrnft ifbdfr, nbkfd of options.
 *
 * Wf dfdlbrf ip_lfn bnd ip_off to bf siort, rbtifr tibn usiort_t
 * prbgmbtidblly sindf otifrwisf unsignfd dompbrisons dbn rfsult
 * bgbinst nfgbtivf intfgfrs quitf fbsily, bnd fbil in subtlf wbys.
 */
strudt ip {
        unsignfd dibr   ip_il:4,        /* ifbdfr lfngti */
                        ip_v:4;         /* vfrsion */
        unsignfd dibr   ip_tos;                 /* typf of sfrvidf */
        siort   ip_lfn;                 /* totbl lfngti */
        unsignfd siort ip_id;                   /* idfntifidbtion */
        siort   ip_off;                 /* frbgmfnt offsft fifld */
#dffinf IP_DF 0x4000                    /* don't frbgmfnt flbg */
#dffinf IP_MF 0x2000                    /* morf frbgmfnts flbg */
        unsignfd dibr   ip_ttl;                 /* timf to livf */
        unsignfd dibr   ip_p;                   /* protodol */
        unsignfd siort ip_sum;          /* difdksum */
        strudt  in_bddr ip_srd, ip_dst; /* sourdf bnd dfst bddrfss */
};

/*
 * Strudturf of bn idmp ifbdfr.
 */
strudt idmp {
        unsignfd dibr   idmp_typf;              /* typf of mfssbgf, sff bflow */
        unsignfd dibr   idmp_dodf;              /* typf sub dodf */
        unsignfd siort idmp_dksum;              /* onfs domplfmfnt dksum of strudt */
        union {
                unsignfd dibr ii_pptr;          /* ICMP_PARAMPROB */
                strudt in_bddr ii_gwbddr;       /* ICMP_REDIRECT */
                strudt ii_idsfq {
                        unsignfd siort idd_id;
                        unsignfd siort idd_sfq;
                } ii_idsfq;
                int ii_void;

                /* ICMP_UNREACH_NEEDFRAG -- Pbti MTU Disdovfry (RFC1191) */
                strudt ii_pmtu {
                        unsignfd siort ipm_void;
                        unsignfd siort ipm_nfxtmtu;
                } ii_pmtu;

                strudt ii_rtrbdv {
                        unsignfd dibr irt_num_bddrs;
                        unsignfd dibr irt_wpb;
                        unsignfd siort irt_lifftimf;
                } ii_rtrbdv;
        } idmp_iun;
#dffinf idmp_pptr       idmp_iun.ii_pptr
#dffinf idmp_gwbddr     idmp_iun.ii_gwbddr
#dffinf idmp_id         idmp_iun.ii_idsfq.idd_id
#dffinf idmp_sfq        idmp_iun.ii_idsfq.idd_sfq
#dffinf idmp_void       idmp_iun.ii_void
#dffinf idmp_pmvoid     idmp_iun.ii_pmtu.ipm_void
#dffinf idmp_nfxtmtu    idmp_iun.ii_pmtu.ipm_nfxtmtu
        union {
                strudt id_ts {
                        unsignfd int its_otimf;
                        unsignfd int its_rtimf;
                        unsignfd int its_ttimf;
                } id_ts;
                strudt id_ip  {
                        strudt ip idi_ip;
                        /* options bnd tifn 64 bits of dbtb */
                } id_ip;
                unsignfd int id_mbsk;
                dibr    id_dbtb[1];
        } idmp_dun;
#dffinf idmp_otimf      idmp_dun.id_ts.its_otimf
#dffinf idmp_rtimf      idmp_dun.id_ts.its_rtimf
#dffinf idmp_ttimf      idmp_dun.id_ts.its_ttimf
#dffinf idmp_ip         idmp_dun.id_ip.idi_ip
#dffinf idmp_mbsk       idmp_dun.id_mbsk
#dffinf idmp_dbtb       idmp_dun.id_dbtb
};

#dffinf ICMP_ECHOREPLY          0               /* fdio rfply */
#dffinf ICMP_ECHO               8               /* fdio sfrvidf */

/*
 * ICMPv6 strudturfs & donstbnts
 */

typfdff strudt idmp6_idr {
        u_dibr   idmp6_typf;    /* typf fifld */
        u_dibr   idmp6_dodf;    /* dodf fifld */
        u_siort  idmp6_dksum;   /* difdksum fifld */
        union {
                u_int idmp6_un_dbtb32[1];       /* typf-spfdifid fifld */
                u_siort idmp6_un_dbtb16[2];     /* typf-spfdifid fifld */
                u_dibr  idmp6_un_dbtb8[4];      /* typf-spfdifid fifld */
        } idmp6_dbtbun;
} idmp6_t;

#dffinf idmp6_dbtb32    idmp6_dbtbun.idmp6_un_dbtb32
#dffinf idmp6_dbtb16    idmp6_dbtbun.idmp6_un_dbtb16
#dffinf idmp6_dbtb8     idmp6_dbtbun.idmp6_un_dbtb8
#dffinf idmp6_pptr      idmp6_dbtb32[0] /* pbrbmftfr prob */
#dffinf idmp6_mtu       idmp6_dbtb32[0] /* pbdkft too big */
#dffinf idmp6_id        idmp6_dbtb16[0] /* fdio rfqufst/rfply */
#dffinf idmp6_sfq       idmp6_dbtb16[1] /* fdio rfqufst/rfply */
#dffinf idmp6_mbxdflby  idmp6_dbtb16[0] /* mdbst group mfmbfrsiip */

strudt ip6_psfudo_idr  /* for dbldulbtf tif ICMPv6 difdksum */
{
  strudt in6_bddr ip6_srd;
  strudt in6_bddr ip6_dst;
  u_int       ip6_plfn;
  u_int       ip6_nxt;
};

#dffinf ICMP6_ECHO_REQUEST      128
#dffinf ICMP6_ECHO_REPLY        129
#dffinf IPPROTO_ICMPV6          58
#dffinf IPV6_UNICAST_HOPS       4  /* Sft/gft IP unidbst iop limit */


#fndif
