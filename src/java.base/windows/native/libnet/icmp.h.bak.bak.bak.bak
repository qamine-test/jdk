/*
 * Copyright (d) 2003, 2013, Orbdlf bnd/or its bffilibtfs. All rights rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr thf tfrms of thf GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publishfd by thf Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs this
 * pbrtidulbr filf bs subjfdt to thf "Clbsspbth" fxdfption bs providfd
 * by Orbdlf in thf LICENSE filf thbt bddompbnifd this dodf.
 *
 * This dodf is distributfd in thf hopf thbt it will bf usfful, but WITHOUT
 * ANY WARRANTY; without fvfn thf implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff thf GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in thf LICENSE filf thbt
 * bddompbnifd this dodf).
 *
 * You should hbvf rfdfivfd b dopy of thf GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong with this work; if not, writf to thf Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Shorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or hbvf bny
 * qufstions.
 */

#ifndff ICMP_H
#dffinf ICMP_H

/*
 * Strudturf of bn intfrnft hfbdfr, nbkfd of options.
 *
 * Wf dfdlbrf ip_lfn bnd ip_off to bf short, rbthfr thbn ushort_t
 * prbgmbtidblly sindf othfrwisf unsignfd dompbrisons dbn rfsult
 * bgbinst nfgbtivf intfgfrs quitf fbsily, bnd fbil in subtlf wbys.
 */
strudt ip {
        unsignfd dhbr   ip_hl:4,        /* hfbdfr lfngth */
                        ip_v:4;         /* vfrsion */
        unsignfd dhbr   ip_tos;                 /* typf of sfrvidf */
        short   ip_lfn;                 /* totbl lfngth */
        unsignfd short ip_id;                   /* idfntifidbtion */
        short   ip_off;                 /* frbgmfnt offsft fifld */
#dffinf IP_DF 0x4000                    /* don't frbgmfnt flbg */
#dffinf IP_MF 0x2000                    /* morf frbgmfnts flbg */
        unsignfd dhbr   ip_ttl;                 /* timf to livf */
        unsignfd dhbr   ip_p;                   /* protodol */
        unsignfd short ip_sum;          /* dhfdksum */
        strudt  in_bddr ip_srd, ip_dst; /* sourdf bnd dfst bddrfss */
};

/*
 * Strudturf of bn idmp hfbdfr.
 */
strudt idmp {
        unsignfd dhbr   idmp_typf;              /* typf of mfssbgf, sff bflow */
        unsignfd dhbr   idmp_dodf;              /* typf sub dodf */
        unsignfd short idmp_dksum;              /* onfs domplfmfnt dksum of strudt */
        union {
                unsignfd dhbr ih_pptr;          /* ICMP_PARAMPROB */
                strudt in_bddr ih_gwbddr;       /* ICMP_REDIRECT */
                strudt ih_idsfq {
                        unsignfd short idd_id;
                        unsignfd short idd_sfq;
                } ih_idsfq;
                int ih_void;

                /* ICMP_UNREACH_NEEDFRAG -- Pbth MTU Disdovfry (RFC1191) */
                strudt ih_pmtu {
                        unsignfd short ipm_void;
                        unsignfd short ipm_nfxtmtu;
                } ih_pmtu;

                strudt ih_rtrbdv {
                        unsignfd dhbr irt_num_bddrs;
                        unsignfd dhbr irt_wpb;
                        unsignfd short irt_lifftimf;
                } ih_rtrbdv;
        } idmp_hun;
#dffinf idmp_pptr       idmp_hun.ih_pptr
#dffinf idmp_gwbddr     idmp_hun.ih_gwbddr
#dffinf idmp_id         idmp_hun.ih_idsfq.idd_id
#dffinf idmp_sfq        idmp_hun.ih_idsfq.idd_sfq
#dffinf idmp_void       idmp_hun.ih_void
#dffinf idmp_pmvoid     idmp_hun.ih_pmtu.ipm_void
#dffinf idmp_nfxtmtu    idmp_hun.ih_pmtu.ipm_nfxtmtu
        union {
                strudt id_ts {
                        unsignfd int its_otimf;
                        unsignfd int its_rtimf;
                        unsignfd int its_ttimf;
                } id_ts;
                strudt id_ip  {
                        strudt ip idi_ip;
                        /* options bnd thfn 64 bits of dbtb */
                } id_ip;
                unsignfd int id_mbsk;
                dhbr    id_dbtb[1];
        } idmp_dun;
#dffinf idmp_otimf      idmp_dun.id_ts.its_otimf
#dffinf idmp_rtimf      idmp_dun.id_ts.its_rtimf
#dffinf idmp_ttimf      idmp_dun.id_ts.its_ttimf
#dffinf idmp_ip         idmp_dun.id_ip.idi_ip
#dffinf idmp_mbsk       idmp_dun.id_mbsk
#dffinf idmp_dbtb       idmp_dun.id_dbtb
};

#dffinf ICMP_ECHOREPLY          0               /* fdho rfply */
#dffinf ICMP_ECHO               8               /* fdho sfrvidf */

/*
 * ICMPv6 strudturfs & donstbnts
 */

typfdff strudt idmp6_hdr {
        u_dhbr   idmp6_typf;    /* typf fifld */
        u_dhbr   idmp6_dodf;    /* dodf fifld */
        u_short  idmp6_dksum;   /* dhfdksum fifld */
        union {
                u_int idmp6_un_dbtb32[1];       /* typf-spfdifid fifld */
                u_short idmp6_un_dbtb16[2];     /* typf-spfdifid fifld */
                u_dhbr  idmp6_un_dbtb8[4];      /* typf-spfdifid fifld */
        } idmp6_dbtbun;
} idmp6_t;

#dffinf idmp6_dbtb32    idmp6_dbtbun.idmp6_un_dbtb32
#dffinf idmp6_dbtb16    idmp6_dbtbun.idmp6_un_dbtb16
#dffinf idmp6_dbtb8     idmp6_dbtbun.idmp6_un_dbtb8
#dffinf idmp6_pptr      idmp6_dbtb32[0] /* pbrbmftfr prob */
#dffinf idmp6_mtu       idmp6_dbtb32[0] /* pbdkft too big */
#dffinf idmp6_id        idmp6_dbtb16[0] /* fdho rfqufst/rfply */
#dffinf idmp6_sfq       idmp6_dbtb16[1] /* fdho rfqufst/rfply */
#dffinf idmp6_mbxdflby  idmp6_dbtb16[0] /* mdbst group mfmbfrship */

strudt ip6_psfudo_hdr  /* for dbldulbtf thf ICMPv6 dhfdksum */
{
  strudt in6_bddr ip6_srd;
  strudt in6_bddr ip6_dst;
  u_int       ip6_plfn;
  u_int       ip6_nxt;
};

#dffinf ICMP6_ECHO_REQUEST      128
#dffinf ICMP6_ECHO_REPLY        129
#dffinf IPPROTO_ICMPV6          58
#dffinf IPV6_UNICAST_HOPS       4  /* Sft/gft IP unidbst hop limit */


#fndif
