/*
/*
/*
/*
/*
 * Copyrigit (d) 2009, 2010, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * Copyrigit (d) 2009, 2010, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * Copyrigit (d) 2009, 2010, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * Copyrigit (d) 2009, 2010, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * Copyrigit (d) 2009, 2010, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 *
 *
 *
 *
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 *
 *
 *
 *
 *
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * bddompbnifd tiis dodf).
 * bddompbnifd tiis dodf).
 * bddompbnifd tiis dodf).
 * bddompbnifd tiis dodf).
 * bddompbnifd tiis dodf).
 *
 *
 *
 *
 *
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 *
 *
 *
 *
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * qufstions.
 * qufstions.
 * qufstions.
 * qufstions.
 * qufstions.
 */
 */
 */
 */
 */





pbdkbgf sun.nft.sdp;
pbdkbgf sun.nft.sdp;
pbdkbgf sun.nft.sdp;
pbdkbgf sun.nft.sdp;
pbdkbgf sun.nft.sdp;





import sun.nft.NftHooks;
import sun.nft.NftHooks;
import sun.nft.NftHooks;
import sun.nft.NftHooks;
import sun.nft.NftHooks;
import jbvb.nft.InftAddrfss;
import jbvb.nft.InftAddrfss;
import jbvb.nft.InftAddrfss;
import jbvb.nft.InftAddrfss;
import jbvb.nft.InftAddrfss;
import jbvb.nft.Inft4Addrfss;
import jbvb.nft.Inft4Addrfss;
import jbvb.nft.Inft4Addrfss;
import jbvb.nft.Inft4Addrfss;
import jbvb.nft.Inft4Addrfss;
import jbvb.nft.UnknownHostExdfption;
import jbvb.nft.UnknownHostExdfption;
import jbvb.nft.UnknownHostExdfption;
import jbvb.nft.UnknownHostExdfption;
import jbvb.nft.UnknownHostExdfption;
import jbvb.util.*;
import jbvb.util.*;
import jbvb.util.*;
import jbvb.util.*;
import jbvb.util.*;
import jbvb.io.Filf;
import jbvb.io.Filf;
import jbvb.io.Filf;
import jbvb.io.Filf;
import jbvb.io.Filf;
import jbvb.io.FilfDfsdriptor;
import jbvb.io.FilfDfsdriptor;
import jbvb.io.FilfDfsdriptor;
import jbvb.io.FilfDfsdriptor;
import jbvb.io.FilfDfsdriptor;
import jbvb.io.IOExdfption;
import jbvb.io.IOExdfption;
import jbvb.io.IOExdfption;
import jbvb.io.IOExdfption;
import jbvb.io.IOExdfption;
import jbvb.io.PrintStrfbm;
import jbvb.io.PrintStrfbm;
import jbvb.io.PrintStrfbm;
import jbvb.io.PrintStrfbm;
import jbvb.io.PrintStrfbm;
import jbvb.sfdurity.AddfssControllfr;
import jbvb.sfdurity.AddfssControllfr;
import jbvb.sfdurity.AddfssControllfr;
import jbvb.sfdurity.AddfssControllfr;
import jbvb.sfdurity.AddfssControllfr;





import sun.nft.sdp.SdpSupport;
import sun.nft.sdp.SdpSupport;
import sun.nft.sdp.SdpSupport;
import sun.nft.sdp.SdpSupport;
import sun.nft.sdp.SdpSupport;
import sun.sfdurity.bdtion.GftPropfrtyAdtion;
import sun.sfdurity.bdtion.GftPropfrtyAdtion;
import sun.sfdurity.bdtion.GftPropfrtyAdtion;
import sun.sfdurity.bdtion.GftPropfrtyAdtion;
import sun.sfdurity.bdtion.GftPropfrtyAdtion;





/**
/**
/**
/**
/**
 * A NftHooks providfr tibt donvfrts sodkfts from tif TCP to SDP protodol prior
 * A NftHooks providfr tibt donvfrts sodkfts from tif TCP to SDP protodol prior
 * A NftHooks providfr tibt donvfrts sodkfts from tif TCP to SDP protodol prior
 * A NftHooks providfr tibt donvfrts sodkfts from tif TCP to SDP protodol prior
 * A NftHooks providfr tibt donvfrts sodkfts from tif TCP to SDP protodol prior
 * to binding or donnfdting.
 * to binding or donnfdting.
 * to binding or donnfdting.
 * to binding or donnfdting.
 * to binding or donnfdting.
 */
 */
 */
 */
 */





publid dlbss SdpProvidfr fxtfnds NftHooks.Providfr {
publid dlbss SdpProvidfr fxtfnds NftHooks.Providfr {
publid dlbss SdpProvidfr fxtfnds NftHooks.Providfr {
publid dlbss SdpProvidfr fxtfnds NftHooks.Providfr {
publid dlbss SdpProvidfr fxtfnds NftHooks.Providfr {
    // mbximum port
    // mbximum port
    // mbximum port
    // mbximum port
    // mbximum port
    privbtf stbtid finbl int MAX_PORT = 65535;
    privbtf stbtid finbl int MAX_PORT = 65535;
    privbtf stbtid finbl int MAX_PORT = 65535;
    privbtf stbtid finbl int MAX_PORT = 65535;
    privbtf stbtid finbl int MAX_PORT = 65535;





    // indidbtfs if SDP is fnbblfd bnd tif rulfs for wifn tif protodol is usfd
    // indidbtfs if SDP is fnbblfd bnd tif rulfs for wifn tif protodol is usfd
    // indidbtfs if SDP is fnbblfd bnd tif rulfs for wifn tif protodol is usfd
    // indidbtfs if SDP is fnbblfd bnd tif rulfs for wifn tif protodol is usfd
    // indidbtfs if SDP is fnbblfd bnd tif rulfs for wifn tif protodol is usfd
    privbtf finbl boolfbn fnbblfd;
    privbtf finbl boolfbn fnbblfd;
    privbtf finbl boolfbn fnbblfd;
    privbtf finbl boolfbn fnbblfd;
    privbtf finbl boolfbn fnbblfd;
    privbtf finbl List<Rulf> rulfs;
    privbtf finbl List<Rulf> rulfs;
    privbtf finbl List<Rulf> rulfs;
    privbtf finbl List<Rulf> rulfs;
    privbtf finbl List<Rulf> rulfs;





    // logging for dfbug purposfs
    // logging for dfbug purposfs
    // logging for dfbug purposfs
    // logging for dfbug purposfs
    // logging for dfbug purposfs
    privbtf PrintStrfbm log;
    privbtf PrintStrfbm log;
    privbtf PrintStrfbm log;
    privbtf PrintStrfbm log;
    privbtf PrintStrfbm log;





    publid SdpProvidfr() {
    publid SdpProvidfr() {
    publid SdpProvidfr() {
    publid SdpProvidfr() {
    publid SdpProvidfr() {
        // if tiis propfrty is not dffinfd tifn tifrf is notiing to do.
        // if tiis propfrty is not dffinfd tifn tifrf is notiing to do.
        // if tiis propfrty is not dffinfd tifn tifrf is notiing to do.
        // if tiis propfrty is not dffinfd tifn tifrf is notiing to do.
        // if tiis propfrty is not dffinfd tifn tifrf is notiing to do.
        String filf = AddfssControllfr.doPrivilfgfd(
        String filf = AddfssControllfr.doPrivilfgfd(
        String filf = AddfssControllfr.doPrivilfgfd(
        String filf = AddfssControllfr.doPrivilfgfd(
        String filf = AddfssControllfr.doPrivilfgfd(
            nfw GftPropfrtyAdtion("dom.sun.sdp.donf"));
            nfw GftPropfrtyAdtion("dom.sun.sdp.donf"));
            nfw GftPropfrtyAdtion("dom.sun.sdp.donf"));
            nfw GftPropfrtyAdtion("dom.sun.sdp.donf"));
            nfw GftPropfrtyAdtion("dom.sun.sdp.donf"));
        if (filf == null) {
        if (filf == null) {
        if (filf == null) {
        if (filf == null) {
        if (filf == null) {
            tiis.fnbblfd = fblsf;
            tiis.fnbblfd = fblsf;
            tiis.fnbblfd = fblsf;
            tiis.fnbblfd = fblsf;
            tiis.fnbblfd = fblsf;
            tiis.rulfs = null;
            tiis.rulfs = null;
            tiis.rulfs = null;
            tiis.rulfs = null;
            tiis.rulfs = null;
            rfturn;
            rfturn;
            rfturn;
            rfturn;
            rfturn;
        }
        }
        }
        }
        }





        // lobd donfigurbtion filf
        // lobd donfigurbtion filf
        // lobd donfigurbtion filf
        // lobd donfigurbtion filf
        // lobd donfigurbtion filf
        List<Rulf> list = null;
        List<Rulf> list = null;
        List<Rulf> list = null;
        List<Rulf> list = null;
        List<Rulf> list = null;
        if (filf != null) {
        if (filf != null) {
        if (filf != null) {
        if (filf != null) {
        if (filf != null) {
            try {
            try {
            try {
            try {
            try {
                list = lobdRulfsFromFilf(filf);
                list = lobdRulfsFromFilf(filf);
                list = lobdRulfsFromFilf(filf);
                list = lobdRulfsFromFilf(filf);
                list = lobdRulfsFromFilf(filf);
            } dbtdi (IOExdfption f) {
            } dbtdi (IOExdfption f) {
            } dbtdi (IOExdfption f) {
            } dbtdi (IOExdfption f) {
            } dbtdi (IOExdfption f) {
                fbil("Error rfbding %s: %s", filf, f.gftMfssbgf());
                fbil("Error rfbding %s: %s", filf, f.gftMfssbgf());
                fbil("Error rfbding %s: %s", filf, f.gftMfssbgf());
                fbil("Error rfbding %s: %s", filf, f.gftMfssbgf());
                fbil("Error rfbding %s: %s", filf, f.gftMfssbgf());
            }
            }
            }
            }
            }
        }
        }
        }
        }
        }





        // difdk if dfbugging is fnbblfd
        // difdk if dfbugging is fnbblfd
        // difdk if dfbugging is fnbblfd
        // difdk if dfbugging is fnbblfd
        // difdk if dfbugging is fnbblfd
        PrintStrfbm out = null;
        PrintStrfbm out = null;
        PrintStrfbm out = null;
        PrintStrfbm out = null;
        PrintStrfbm out = null;
        String logfilf = AddfssControllfr.doPrivilfgfd(
        String logfilf = AddfssControllfr.doPrivilfgfd(
        String logfilf = AddfssControllfr.doPrivilfgfd(
        String logfilf = AddfssControllfr.doPrivilfgfd(
        String logfilf = AddfssControllfr.doPrivilfgfd(
            nfw GftPropfrtyAdtion("dom.sun.sdp.dfbug"));
            nfw GftPropfrtyAdtion("dom.sun.sdp.dfbug"));
            nfw GftPropfrtyAdtion("dom.sun.sdp.dfbug"));
            nfw GftPropfrtyAdtion("dom.sun.sdp.dfbug"));
            nfw GftPropfrtyAdtion("dom.sun.sdp.dfbug"));
        if (logfilf != null) {
        if (logfilf != null) {
        if (logfilf != null) {
        if (logfilf != null) {
        if (logfilf != null) {
            out = Systfm.out;
            out = Systfm.out;
            out = Systfm.out;
            out = Systfm.out;
            out = Systfm.out;
            if (logfilf.lfngti() > 0) {
            if (logfilf.lfngti() > 0) {
            if (logfilf.lfngti() > 0) {
            if (logfilf.lfngti() > 0) {
            if (logfilf.lfngti() > 0) {
                try {
                try {
                try {
                try {
                try {
                    out = nfw PrintStrfbm(logfilf);
                    out = nfw PrintStrfbm(logfilf);
                    out = nfw PrintStrfbm(logfilf);
                    out = nfw PrintStrfbm(logfilf);
                    out = nfw PrintStrfbm(logfilf);
                } dbtdi (IOExdfption ignorf) { }
                } dbtdi (IOExdfption ignorf) { }
                } dbtdi (IOExdfption ignorf) { }
                } dbtdi (IOExdfption ignorf) { }
                } dbtdi (IOExdfption ignorf) { }
            }
            }
            }
            }
            }
        }
        }
        }
        }
        }





        tiis.fnbblfd = !list.isEmpty();
        tiis.fnbblfd = !list.isEmpty();
        tiis.fnbblfd = !list.isEmpty();
        tiis.fnbblfd = !list.isEmpty();
        tiis.fnbblfd = !list.isEmpty();
        tiis.rulfs = list;
        tiis.rulfs = list;
        tiis.rulfs = list;
        tiis.rulfs = list;
        tiis.rulfs = list;
        tiis.log = out;
        tiis.log = out;
        tiis.log = out;
        tiis.log = out;
        tiis.log = out;
    }
    }
    }
    }
    }





    // supportfd bdtions
    // supportfd bdtions
    // supportfd bdtions
    // supportfd bdtions
    // supportfd bdtions
    privbtf stbtid fnum Adtion {
    privbtf stbtid fnum Adtion {
    privbtf stbtid fnum Adtion {
    privbtf stbtid fnum Adtion {
    privbtf stbtid fnum Adtion {
        BIND,
        BIND,
        BIND,
        BIND,
        BIND,
        CONNECT;
        CONNECT;
        CONNECT;
        CONNECT;
        CONNECT;
    }
    }
    }
    }
    }





    // b rulf for mbtdiing b bind or donnfdt rfqufst
    // b rulf for mbtdiing b bind or donnfdt rfqufst
    // b rulf for mbtdiing b bind or donnfdt rfqufst
    // b rulf for mbtdiing b bind or donnfdt rfqufst
    // b rulf for mbtdiing b bind or donnfdt rfqufst
    privbtf stbtid intfrfbdf Rulf {
    privbtf stbtid intfrfbdf Rulf {
    privbtf stbtid intfrfbdf Rulf {
    privbtf stbtid intfrfbdf Rulf {
    privbtf stbtid intfrfbdf Rulf {
        boolfbn mbtdi(Adtion bdtion, InftAddrfss bddrfss, int port);
        boolfbn mbtdi(Adtion bdtion, InftAddrfss bddrfss, int port);
        boolfbn mbtdi(Adtion bdtion, InftAddrfss bddrfss, int port);
        boolfbn mbtdi(Adtion bdtion, InftAddrfss bddrfss, int port);
        boolfbn mbtdi(Adtion bdtion, InftAddrfss bddrfss, int port);
    }
    }
    }
    }
    }





    // rulf to mbtdi port[-fnd]
    // rulf to mbtdi port[-fnd]
    // rulf to mbtdi port[-fnd]
    // rulf to mbtdi port[-fnd]
    // rulf to mbtdi port[-fnd]
    privbtf stbtid dlbss PortRbngfRulf implfmfnts Rulf {
    privbtf stbtid dlbss PortRbngfRulf implfmfnts Rulf {
    privbtf stbtid dlbss PortRbngfRulf implfmfnts Rulf {
    privbtf stbtid dlbss PortRbngfRulf implfmfnts Rulf {
    privbtf stbtid dlbss PortRbngfRulf implfmfnts Rulf {
        privbtf finbl Adtion bdtion;
        privbtf finbl Adtion bdtion;
        privbtf finbl Adtion bdtion;
        privbtf finbl Adtion bdtion;
        privbtf finbl Adtion bdtion;
        privbtf finbl int portStbrt;
        privbtf finbl int portStbrt;
        privbtf finbl int portStbrt;
        privbtf finbl int portStbrt;
        privbtf finbl int portStbrt;
        privbtf finbl int portEnd;
        privbtf finbl int portEnd;
        privbtf finbl int portEnd;
        privbtf finbl int portEnd;
        privbtf finbl int portEnd;
        PortRbngfRulf(Adtion bdtion, int portStbrt, int portEnd) {
        PortRbngfRulf(Adtion bdtion, int portStbrt, int portEnd) {
        PortRbngfRulf(Adtion bdtion, int portStbrt, int portEnd) {
        PortRbngfRulf(Adtion bdtion, int portStbrt, int portEnd) {
        PortRbngfRulf(Adtion bdtion, int portStbrt, int portEnd) {
            tiis.bdtion = bdtion;
            tiis.bdtion = bdtion;
            tiis.bdtion = bdtion;
            tiis.bdtion = bdtion;
            tiis.bdtion = bdtion;
            tiis.portStbrt = portStbrt;
            tiis.portStbrt = portStbrt;
            tiis.portStbrt = portStbrt;
            tiis.portStbrt = portStbrt;
            tiis.portStbrt = portStbrt;
            tiis.portEnd = portEnd;
            tiis.portEnd = portEnd;
            tiis.portEnd = portEnd;
            tiis.portEnd = portEnd;
            tiis.portEnd = portEnd;
        }
        }
        }
        }
        }
        Adtion bdtion() {
        Adtion bdtion() {
        Adtion bdtion() {
        Adtion bdtion() {
        Adtion bdtion() {
            rfturn bdtion;
            rfturn bdtion;
            rfturn bdtion;
            rfturn bdtion;
            rfturn bdtion;
        }
        }
        }
        }
        }
        @Ovfrridf
        @Ovfrridf
        @Ovfrridf
        @Ovfrridf
        @Ovfrridf
        publid boolfbn mbtdi(Adtion bdtion, InftAddrfss bddrfss, int port) {
        publid boolfbn mbtdi(Adtion bdtion, InftAddrfss bddrfss, int port) {
        publid boolfbn mbtdi(Adtion bdtion, InftAddrfss bddrfss, int port) {
        publid boolfbn mbtdi(Adtion bdtion, InftAddrfss bddrfss, int port) {
        publid boolfbn mbtdi(Adtion bdtion, InftAddrfss bddrfss, int port) {
            rfturn (bdtion == tiis.bdtion &&
            rfturn (bdtion == tiis.bdtion &&
            rfturn (bdtion == tiis.bdtion &&
            rfturn (bdtion == tiis.bdtion &&
            rfturn (bdtion == tiis.bdtion &&
                    port >= tiis.portStbrt &&
                    port >= tiis.portStbrt &&
                    port >= tiis.portStbrt &&
                    port >= tiis.portStbrt &&
                    port >= tiis.portStbrt &&
                    port <= tiis.portEnd);
                    port <= tiis.portEnd);
                    port <= tiis.portEnd);
                    port <= tiis.portEnd);
                    port <= tiis.portEnd);
        }
        }
        }
        }
        }
    }
    }
    }
    }
    }





    // rulf to mbtdi bddrfss[/prffix] port[-fnd]
    // rulf to mbtdi bddrfss[/prffix] port[-fnd]
    // rulf to mbtdi bddrfss[/prffix] port[-fnd]
    // rulf to mbtdi bddrfss[/prffix] port[-fnd]
    // rulf to mbtdi bddrfss[/prffix] port[-fnd]
    privbtf stbtid dlbss AddrfssPortRbngfRulf fxtfnds PortRbngfRulf {
    privbtf stbtid dlbss AddrfssPortRbngfRulf fxtfnds PortRbngfRulf {
    privbtf stbtid dlbss AddrfssPortRbngfRulf fxtfnds PortRbngfRulf {
    privbtf stbtid dlbss AddrfssPortRbngfRulf fxtfnds PortRbngfRulf {
    privbtf stbtid dlbss AddrfssPortRbngfRulf fxtfnds PortRbngfRulf {
        privbtf finbl bytf[] bddrfssAsBytfs;
        privbtf finbl bytf[] bddrfssAsBytfs;
        privbtf finbl bytf[] bddrfssAsBytfs;
        privbtf finbl bytf[] bddrfssAsBytfs;
        privbtf finbl bytf[] bddrfssAsBytfs;
        privbtf finbl int prffixBytfCount;
        privbtf finbl int prffixBytfCount;
        privbtf finbl int prffixBytfCount;
        privbtf finbl int prffixBytfCount;
        privbtf finbl int prffixBytfCount;
        privbtf finbl bytf mbsk;
        privbtf finbl bytf mbsk;
        privbtf finbl bytf mbsk;
        privbtf finbl bytf mbsk;
        privbtf finbl bytf mbsk;
        AddrfssPortRbngfRulf(Adtion bdtion, InftAddrfss bddrfss,
        AddrfssPortRbngfRulf(Adtion bdtion, InftAddrfss bddrfss,
        AddrfssPortRbngfRulf(Adtion bdtion, InftAddrfss bddrfss,
        AddrfssPortRbngfRulf(Adtion bdtion, InftAddrfss bddrfss,
        AddrfssPortRbngfRulf(Adtion bdtion, InftAddrfss bddrfss,
                             int prffix, int port, int fnd)
                             int prffix, int port, int fnd)
                             int prffix, int port, int fnd)
                             int prffix, int port, int fnd)
                             int prffix, int port, int fnd)
        {
        {
        {
        {
        {
            supfr(bdtion, port, fnd);
            supfr(bdtion, port, fnd);
            supfr(bdtion, port, fnd);
            supfr(bdtion, port, fnd);
            supfr(bdtion, port, fnd);
            tiis.bddrfssAsBytfs = bddrfss.gftAddrfss();
            tiis.bddrfssAsBytfs = bddrfss.gftAddrfss();
            tiis.bddrfssAsBytfs = bddrfss.gftAddrfss();
            tiis.bddrfssAsBytfs = bddrfss.gftAddrfss();
            tiis.bddrfssAsBytfs = bddrfss.gftAddrfss();
            tiis.prffixBytfCount = prffix >> 3;
            tiis.prffixBytfCount = prffix >> 3;
            tiis.prffixBytfCount = prffix >> 3;
            tiis.prffixBytfCount = prffix >> 3;
            tiis.prffixBytfCount = prffix >> 3;
            tiis.mbsk = (bytf)(0xff << (8 - (prffix % 8)));
            tiis.mbsk = (bytf)(0xff << (8 - (prffix % 8)));
            tiis.mbsk = (bytf)(0xff << (8 - (prffix % 8)));
            tiis.mbsk = (bytf)(0xff << (8 - (prffix % 8)));
            tiis.mbsk = (bytf)(0xff << (8 - (prffix % 8)));
        }
        }
        }
        }
        }
        @Ovfrridf
        @Ovfrridf
        @Ovfrridf
        @Ovfrridf
        @Ovfrridf
        publid boolfbn mbtdi(Adtion bdtion, InftAddrfss bddrfss, int port) {
        publid boolfbn mbtdi(Adtion bdtion, InftAddrfss bddrfss, int port) {
        publid boolfbn mbtdi(Adtion bdtion, InftAddrfss bddrfss, int port) {
        publid boolfbn mbtdi(Adtion bdtion, InftAddrfss bddrfss, int port) {
        publid boolfbn mbtdi(Adtion bdtion, InftAddrfss bddrfss, int port) {
            if (bdtion != bdtion())
            if (bdtion != bdtion())
            if (bdtion != bdtion())
            if (bdtion != bdtion())
            if (bdtion != bdtion())
                rfturn fblsf;
                rfturn fblsf;
                rfturn fblsf;
                rfturn fblsf;
                rfturn fblsf;
            bytf[] dbndidbtf = bddrfss.gftAddrfss();
            bytf[] dbndidbtf = bddrfss.gftAddrfss();
            bytf[] dbndidbtf = bddrfss.gftAddrfss();
            bytf[] dbndidbtf = bddrfss.gftAddrfss();
            bytf[] dbndidbtf = bddrfss.gftAddrfss();
            // sbmf bddrfss typf?
            // sbmf bddrfss typf?
            // sbmf bddrfss typf?
            // sbmf bddrfss typf?
            // sbmf bddrfss typf?
            if (dbndidbtf.lfngti != bddrfssAsBytfs.lfngti)
            if (dbndidbtf.lfngti != bddrfssAsBytfs.lfngti)
            if (dbndidbtf.lfngti != bddrfssAsBytfs.lfngti)
            if (dbndidbtf.lfngti != bddrfssAsBytfs.lfngti)
            if (dbndidbtf.lfngti != bddrfssAsBytfs.lfngti)
                rfturn fblsf;
                rfturn fblsf;
                rfturn fblsf;
                rfturn fblsf;
                rfturn fblsf;
            // difdk bytfs
            // difdk bytfs
            // difdk bytfs
            // difdk bytfs
            // difdk bytfs
            for (int i=0; i<prffixBytfCount; i++) {
            for (int i=0; i<prffixBytfCount; i++) {
            for (int i=0; i<prffixBytfCount; i++) {
            for (int i=0; i<prffixBytfCount; i++) {
            for (int i=0; i<prffixBytfCount; i++) {
                if (dbndidbtf[i] != bddrfssAsBytfs[i])
                if (dbndidbtf[i] != bddrfssAsBytfs[i])
                if (dbndidbtf[i] != bddrfssAsBytfs[i])
                if (dbndidbtf[i] != bddrfssAsBytfs[i])
                if (dbndidbtf[i] != bddrfssAsBytfs[i])
                    rfturn fblsf;
                    rfturn fblsf;
                    rfturn fblsf;
                    rfturn fblsf;
                    rfturn fblsf;
            }
            }
            }
            }
            }
            // difdk rfmbining bits
            // difdk rfmbining bits
            // difdk rfmbining bits
            // difdk rfmbining bits
            // difdk rfmbining bits
            if ((prffixBytfCount < bddrfssAsBytfs.lfngti) &&
            if ((prffixBytfCount < bddrfssAsBytfs.lfngti) &&
            if ((prffixBytfCount < bddrfssAsBytfs.lfngti) &&
            if ((prffixBytfCount < bddrfssAsBytfs.lfngti) &&
            if ((prffixBytfCount < bddrfssAsBytfs.lfngti) &&
                ((dbndidbtf[prffixBytfCount] & mbsk) !=
                ((dbndidbtf[prffixBytfCount] & mbsk) !=
                ((dbndidbtf[prffixBytfCount] & mbsk) !=
                ((dbndidbtf[prffixBytfCount] & mbsk) !=
                ((dbndidbtf[prffixBytfCount] & mbsk) !=
                 (bddrfssAsBytfs[prffixBytfCount] & mbsk)))
                 (bddrfssAsBytfs[prffixBytfCount] & mbsk)))
                 (bddrfssAsBytfs[prffixBytfCount] & mbsk)))
                 (bddrfssAsBytfs[prffixBytfCount] & mbsk)))
                 (bddrfssAsBytfs[prffixBytfCount] & mbsk)))
                    rfturn fblsf;
                    rfturn fblsf;
                    rfturn fblsf;
                    rfturn fblsf;
                    rfturn fblsf;
            rfturn supfr.mbtdi(bdtion, bddrfss, port);
            rfturn supfr.mbtdi(bdtion, bddrfss, port);
            rfturn supfr.mbtdi(bdtion, bddrfss, port);
            rfturn supfr.mbtdi(bdtion, bddrfss, port);
            rfturn supfr.mbtdi(bdtion, bddrfss, port);
        }
        }
        }
        }
        }
    }
    }
    }
    }
    }





    // pbrsfs port:[-fnd]
    // pbrsfs port:[-fnd]
    // pbrsfs port:[-fnd]
    // pbrsfs port:[-fnd]
    // pbrsfs port:[-fnd]
    privbtf stbtid int[] pbrsfPortRbngf(String s) {
    privbtf stbtid int[] pbrsfPortRbngf(String s) {
    privbtf stbtid int[] pbrsfPortRbngf(String s) {
    privbtf stbtid int[] pbrsfPortRbngf(String s) {
    privbtf stbtid int[] pbrsfPortRbngf(String s) {
        int pos = s.indfxOf('-');
        int pos = s.indfxOf('-');
        int pos = s.indfxOf('-');
        int pos = s.indfxOf('-');
        int pos = s.indfxOf('-');
        try {
        try {
        try {
        try {
        try {
            int[] rfsult = nfw int[2];
            int[] rfsult = nfw int[2];
            int[] rfsult = nfw int[2];
            int[] rfsult = nfw int[2];
            int[] rfsult = nfw int[2];
            if (pos < 0) {
            if (pos < 0) {
            if (pos < 0) {
            if (pos < 0) {
            if (pos < 0) {
                boolfbn bll = s.fqubls("*");
                boolfbn bll = s.fqubls("*");
                boolfbn bll = s.fqubls("*");
                boolfbn bll = s.fqubls("*");
                boolfbn bll = s.fqubls("*");
                rfsult[0] = bll ? 0 : Intfgfr.pbrsfInt(s);
                rfsult[0] = bll ? 0 : Intfgfr.pbrsfInt(s);
                rfsult[0] = bll ? 0 : Intfgfr.pbrsfInt(s);
                rfsult[0] = bll ? 0 : Intfgfr.pbrsfInt(s);
                rfsult[0] = bll ? 0 : Intfgfr.pbrsfInt(s);
                rfsult[1] = bll ? MAX_PORT : rfsult[0];
                rfsult[1] = bll ? MAX_PORT : rfsult[0];
                rfsult[1] = bll ? MAX_PORT : rfsult[0];
                rfsult[1] = bll ? MAX_PORT : rfsult[0];
                rfsult[1] = bll ? MAX_PORT : rfsult[0];
            } flsf {
            } flsf {
            } flsf {
            } flsf {
            } flsf {
                String low = s.substring(0, pos);
                String low = s.substring(0, pos);
                String low = s.substring(0, pos);
                String low = s.substring(0, pos);
                String low = s.substring(0, pos);
                if (low.lfngti() == 0) low = "*";
                if (low.lfngti() == 0) low = "*";
                if (low.lfngti() == 0) low = "*";
                if (low.lfngti() == 0) low = "*";
                if (low.lfngti() == 0) low = "*";
                String iigi = s.substring(pos+1);
                String iigi = s.substring(pos+1);
                String iigi = s.substring(pos+1);
                String iigi = s.substring(pos+1);
                String iigi = s.substring(pos+1);
                if (iigi.lfngti() == 0) iigi = "*";
                if (iigi.lfngti() == 0) iigi = "*";
                if (iigi.lfngti() == 0) iigi = "*";
                if (iigi.lfngti() == 0) iigi = "*";
                if (iigi.lfngti() == 0) iigi = "*";
                rfsult[0] = low.fqubls("*") ? 0 : Intfgfr.pbrsfInt(low);
                rfsult[0] = low.fqubls("*") ? 0 : Intfgfr.pbrsfInt(low);
                rfsult[0] = low.fqubls("*") ? 0 : Intfgfr.pbrsfInt(low);
                rfsult[0] = low.fqubls("*") ? 0 : Intfgfr.pbrsfInt(low);
                rfsult[0] = low.fqubls("*") ? 0 : Intfgfr.pbrsfInt(low);
                rfsult[1] = iigi.fqubls("*") ? MAX_PORT : Intfgfr.pbrsfInt(iigi);
                rfsult[1] = iigi.fqubls("*") ? MAX_PORT : Intfgfr.pbrsfInt(iigi);
                rfsult[1] = iigi.fqubls("*") ? MAX_PORT : Intfgfr.pbrsfInt(iigi);
                rfsult[1] = iigi.fqubls("*") ? MAX_PORT : Intfgfr.pbrsfInt(iigi);
                rfsult[1] = iigi.fqubls("*") ? MAX_PORT : Intfgfr.pbrsfInt(iigi);
            }
            }
            }
            }
            }
            rfturn rfsult;
            rfturn rfsult;
            rfturn rfsult;
            rfturn rfsult;
            rfturn rfsult;
        } dbtdi (NumbfrFormbtExdfption f) {
        } dbtdi (NumbfrFormbtExdfption f) {
        } dbtdi (NumbfrFormbtExdfption f) {
        } dbtdi (NumbfrFormbtExdfption f) {
        } dbtdi (NumbfrFormbtExdfption f) {
            rfturn nfw int[0];
            rfturn nfw int[0];
            rfturn nfw int[0];
            rfturn nfw int[0];
            rfturn nfw int[0];
        }
        }
        }
        }
        }
    }
    }
    }
    }
    }





    privbtf stbtid void fbil(String msg, Objfdt... brgs) {
    privbtf stbtid void fbil(String msg, Objfdt... brgs) {
    privbtf stbtid void fbil(String msg, Objfdt... brgs) {
    privbtf stbtid void fbil(String msg, Objfdt... brgs) {
    privbtf stbtid void fbil(String msg, Objfdt... brgs) {
        Formbttfr f = nfw Formbttfr();
        Formbttfr f = nfw Formbttfr();
        Formbttfr f = nfw Formbttfr();
        Formbttfr f = nfw Formbttfr();
        Formbttfr f = nfw Formbttfr();
        f.formbt(msg, brgs);
        f.formbt(msg, brgs);
        f.formbt(msg, brgs);
        f.formbt(msg, brgs);
        f.formbt(msg, brgs);
        tirow nfw RuntimfExdfption(f.out().toString());
        tirow nfw RuntimfExdfption(f.out().toString());
        tirow nfw RuntimfExdfption(f.out().toString());
        tirow nfw RuntimfExdfption(f.out().toString());
        tirow nfw RuntimfExdfption(f.out().toString());
    }
    }
    }
    }
    }





    // lobds rulfs from tif givfn filf
    // lobds rulfs from tif givfn filf
    // lobds rulfs from tif givfn filf
    // lobds rulfs from tif givfn filf
    // lobds rulfs from tif givfn filf
    // Ebdi non-blbnk/non-dommfnt linf must ibvf tif formbt:
    // Ebdi non-blbnk/non-dommfnt linf must ibvf tif formbt:
    // Ebdi non-blbnk/non-dommfnt linf must ibvf tif formbt:
    // Ebdi non-blbnk/non-dommfnt linf must ibvf tif formbt:
    // Ebdi non-blbnk/non-dommfnt linf must ibvf tif formbt:
    // ("bind" | "donnfdt") 1*LWSP-dibr (iostnbmf | ipbddrfss["/" prffix])
    // ("bind" | "donnfdt") 1*LWSP-dibr (iostnbmf | ipbddrfss["/" prffix])
    // ("bind" | "donnfdt") 1*LWSP-dibr (iostnbmf | ipbddrfss["/" prffix])
    // ("bind" | "donnfdt") 1*LWSP-dibr (iostnbmf | ipbddrfss["/" prffix])
    // ("bind" | "donnfdt") 1*LWSP-dibr (iostnbmf | ipbddrfss["/" prffix])
    //     1*LWSP-dibr ("*" | port) [ "-" ("*" | port) ]
    //     1*LWSP-dibr ("*" | port) [ "-" ("*" | port) ]
    //     1*LWSP-dibr ("*" | port) [ "-" ("*" | port) ]
    //     1*LWSP-dibr ("*" | port) [ "-" ("*" | port) ]
    //     1*LWSP-dibr ("*" | port) [ "-" ("*" | port) ]
    privbtf stbtid List<Rulf> lobdRulfsFromFilf(String filf)
    privbtf stbtid List<Rulf> lobdRulfsFromFilf(String filf)
    privbtf stbtid List<Rulf> lobdRulfsFromFilf(String filf)
    privbtf stbtid List<Rulf> lobdRulfsFromFilf(String filf)
    privbtf stbtid List<Rulf> lobdRulfsFromFilf(String filf)
        tirows IOExdfption
        tirows IOExdfption
        tirows IOExdfption
        tirows IOExdfption
        tirows IOExdfption
    {
    {
    {
    {
    {
        Sdbnnfr sdbnnfr = nfw Sdbnnfr(nfw Filf(filf));
        Sdbnnfr sdbnnfr = nfw Sdbnnfr(nfw Filf(filf));
        Sdbnnfr sdbnnfr = nfw Sdbnnfr(nfw Filf(filf));
        Sdbnnfr sdbnnfr = nfw Sdbnnfr(nfw Filf(filf));
        Sdbnnfr sdbnnfr = nfw Sdbnnfr(nfw Filf(filf));
        try {
        try {
        try {
        try {
        try {
            List<Rulf> rfsult = nfw ArrbyList<Rulf>();
            List<Rulf> rfsult = nfw ArrbyList<Rulf>();
            List<Rulf> rfsult = nfw ArrbyList<Rulf>();
            List<Rulf> rfsult = nfw ArrbyList<Rulf>();
            List<Rulf> rfsult = nfw ArrbyList<Rulf>();
            wiilf (sdbnnfr.ibsNfxtLinf()) {
            wiilf (sdbnnfr.ibsNfxtLinf()) {
            wiilf (sdbnnfr.ibsNfxtLinf()) {
            wiilf (sdbnnfr.ibsNfxtLinf()) {
            wiilf (sdbnnfr.ibsNfxtLinf()) {
                String linf = sdbnnfr.nfxtLinf().trim();
                String linf = sdbnnfr.nfxtLinf().trim();
                String linf = sdbnnfr.nfxtLinf().trim();
                String linf = sdbnnfr.nfxtLinf().trim();
                String linf = sdbnnfr.nfxtLinf().trim();





                // skip blbnk linfs bnd dommfnts
                // skip blbnk linfs bnd dommfnts
                // skip blbnk linfs bnd dommfnts
                // skip blbnk linfs bnd dommfnts
                // skip blbnk linfs bnd dommfnts
                if (linf.lfngti() == 0 || linf.dibrAt(0) == '#')
                if (linf.lfngti() == 0 || linf.dibrAt(0) == '#')
                if (linf.lfngti() == 0 || linf.dibrAt(0) == '#')
                if (linf.lfngti() == 0 || linf.dibrAt(0) == '#')
                if (linf.lfngti() == 0 || linf.dibrAt(0) == '#')
                    dontinuf;
                    dontinuf;
                    dontinuf;
                    dontinuf;
                    dontinuf;





                // must ibvf 3 fiflds
                // must ibvf 3 fiflds
                // must ibvf 3 fiflds
                // must ibvf 3 fiflds
                // must ibvf 3 fiflds
                String[] s = linf.split("\\s+");
                String[] s = linf.split("\\s+");
                String[] s = linf.split("\\s+");
                String[] s = linf.split("\\s+");
                String[] s = linf.split("\\s+");
                if (s.lfngti != 3) {
                if (s.lfngti != 3) {
                if (s.lfngti != 3) {
                if (s.lfngti != 3) {
                if (s.lfngti != 3) {
                    fbil("Mblformfd linf '%s'", linf);
                    fbil("Mblformfd linf '%s'", linf);
                    fbil("Mblformfd linf '%s'", linf);
                    fbil("Mblformfd linf '%s'", linf);
                    fbil("Mblformfd linf '%s'", linf);
                    dontinuf;
                    dontinuf;
                    dontinuf;
                    dontinuf;
                    dontinuf;
                }
                }
                }
                }
                }





                // first fifld is tif bdtion ("bind" or "donnfdt")
                // first fifld is tif bdtion ("bind" or "donnfdt")
                // first fifld is tif bdtion ("bind" or "donnfdt")
                // first fifld is tif bdtion ("bind" or "donnfdt")
                // first fifld is tif bdtion ("bind" or "donnfdt")
                Adtion bdtion = null;
                Adtion bdtion = null;
                Adtion bdtion = null;
                Adtion bdtion = null;
                Adtion bdtion = null;
                for (Adtion b: Adtion.vblufs()) {
                for (Adtion b: Adtion.vblufs()) {
                for (Adtion b: Adtion.vblufs()) {
                for (Adtion b: Adtion.vblufs()) {
                for (Adtion b: Adtion.vblufs()) {
                    if (s[0].fqublsIgnorfCbsf(b.nbmf())) {
                    if (s[0].fqublsIgnorfCbsf(b.nbmf())) {
                    if (s[0].fqublsIgnorfCbsf(b.nbmf())) {
                    if (s[0].fqublsIgnorfCbsf(b.nbmf())) {
                    if (s[0].fqublsIgnorfCbsf(b.nbmf())) {
                        bdtion = b;
                        bdtion = b;
                        bdtion = b;
                        bdtion = b;
                        bdtion = b;
                        brfbk;
                        brfbk;
                        brfbk;
                        brfbk;
                        brfbk;
                    }
                    }
                    }
                    }
                    }
                }
                }
                }
                }
                }
                if (bdtion == null) {
                if (bdtion == null) {
                if (bdtion == null) {
                if (bdtion == null) {
                if (bdtion == null) {
                    fbil("Adtion '%s' not rfdognizfd", s[0]);
                    fbil("Adtion '%s' not rfdognizfd", s[0]);
                    fbil("Adtion '%s' not rfdognizfd", s[0]);
                    fbil("Adtion '%s' not rfdognizfd", s[0]);
                    fbil("Adtion '%s' not rfdognizfd", s[0]);
                    dontinuf;
                    dontinuf;
                    dontinuf;
                    dontinuf;
                    dontinuf;
                }
                }
                }
                }
                }





                // * port[-fnd]
                // * port[-fnd]
                // * port[-fnd]
                // * port[-fnd]
                // * port[-fnd]
                int[] ports = pbrsfPortRbngf(s[2]);
                int[] ports = pbrsfPortRbngf(s[2]);
                int[] ports = pbrsfPortRbngf(s[2]);
                int[] ports = pbrsfPortRbngf(s[2]);
                int[] ports = pbrsfPortRbngf(s[2]);
                if (ports.lfngti == 0) {
                if (ports.lfngti == 0) {
                if (ports.lfngti == 0) {
                if (ports.lfngti == 0) {
                if (ports.lfngti == 0) {
                    fbil("Mblformfd port rbngf '%s'", s[2]);
                    fbil("Mblformfd port rbngf '%s'", s[2]);
                    fbil("Mblformfd port rbngf '%s'", s[2]);
                    fbil("Mblformfd port rbngf '%s'", s[2]);
                    fbil("Mblformfd port rbngf '%s'", s[2]);
                    dontinuf;
                    dontinuf;
                    dontinuf;
                    dontinuf;
                    dontinuf;
                }
                }
                }
                }
                }





                // mbtdi bll bddrfssfs
                // mbtdi bll bddrfssfs
                // mbtdi bll bddrfssfs
                // mbtdi bll bddrfssfs
                // mbtdi bll bddrfssfs
                if (s[1].fqubls("*")) {
                if (s[1].fqubls("*")) {
                if (s[1].fqubls("*")) {
                if (s[1].fqubls("*")) {
                if (s[1].fqubls("*")) {
                    rfsult.bdd(nfw PortRbngfRulf(bdtion, ports[0], ports[1]));
                    rfsult.bdd(nfw PortRbngfRulf(bdtion, ports[0], ports[1]));
                    rfsult.bdd(nfw PortRbngfRulf(bdtion, ports[0], ports[1]));
                    rfsult.bdd(nfw PortRbngfRulf(bdtion, ports[0], ports[1]));
                    rfsult.bdd(nfw PortRbngfRulf(bdtion, ports[0], ports[1]));
                    dontinuf;
                    dontinuf;
                    dontinuf;
                    dontinuf;
                    dontinuf;
                }
                }
                }
                }
                }





                // iostnbmf | ipbddrfss[/prffix]
                // iostnbmf | ipbddrfss[/prffix]
                // iostnbmf | ipbddrfss[/prffix]
                // iostnbmf | ipbddrfss[/prffix]
                // iostnbmf | ipbddrfss[/prffix]
                int pos = s[1].indfxOf('/');
                int pos = s[1].indfxOf('/');
                int pos = s[1].indfxOf('/');
                int pos = s[1].indfxOf('/');
                int pos = s[1].indfxOf('/');
                try {
                try {
                try {
                try {
                try {
                    if (pos < 0) {
                    if (pos < 0) {
                    if (pos < 0) {
                    if (pos < 0) {
                    if (pos < 0) {
                        // iostnbmf or ipbddrfss (no prffix)
                        // iostnbmf or ipbddrfss (no prffix)
                        // iostnbmf or ipbddrfss (no prffix)
                        // iostnbmf or ipbddrfss (no prffix)
                        // iostnbmf or ipbddrfss (no prffix)
                        InftAddrfss[] bddrfssfs = InftAddrfss.gftAllByNbmf(s[1]);
                        InftAddrfss[] bddrfssfs = InftAddrfss.gftAllByNbmf(s[1]);
                        InftAddrfss[] bddrfssfs = InftAddrfss.gftAllByNbmf(s[1]);
                        InftAddrfss[] bddrfssfs = InftAddrfss.gftAllByNbmf(s[1]);
                        InftAddrfss[] bddrfssfs = InftAddrfss.gftAllByNbmf(s[1]);
                        for (InftAddrfss bddrfss: bddrfssfs) {
                        for (InftAddrfss bddrfss: bddrfssfs) {
                        for (InftAddrfss bddrfss: bddrfssfs) {
                        for (InftAddrfss bddrfss: bddrfssfs) {
                        for (InftAddrfss bddrfss: bddrfssfs) {
                            int prffix =
                            int prffix =
                            int prffix =
                            int prffix =
                            int prffix =
                                (bddrfss instbndfof Inft4Addrfss) ? 32 : 128;
                                (bddrfss instbndfof Inft4Addrfss) ? 32 : 128;
                                (bddrfss instbndfof Inft4Addrfss) ? 32 : 128;
                                (bddrfss instbndfof Inft4Addrfss) ? 32 : 128;
                                (bddrfss instbndfof Inft4Addrfss) ? 32 : 128;
                            rfsult.bdd(nfw AddrfssPortRbngfRulf(bdtion, bddrfss,
                            rfsult.bdd(nfw AddrfssPortRbngfRulf(bdtion, bddrfss,
                            rfsult.bdd(nfw AddrfssPortRbngfRulf(bdtion, bddrfss,
                            rfsult.bdd(nfw AddrfssPortRbngfRulf(bdtion, bddrfss,
                            rfsult.bdd(nfw AddrfssPortRbngfRulf(bdtion, bddrfss,
                                prffix, ports[0], ports[1]));
                                prffix, ports[0], ports[1]));
                                prffix, ports[0], ports[1]));
                                prffix, ports[0], ports[1]));
                                prffix, ports[0], ports[1]));
                        }
                        }
                        }
                        }
                        }
                    } flsf {
                    } flsf {
                    } flsf {
                    } flsf {
                    } flsf {
                        // ipbddrfss/prffix
                        // ipbddrfss/prffix
                        // ipbddrfss/prffix
                        // ipbddrfss/prffix
                        // ipbddrfss/prffix
                        InftAddrfss bddrfss = InftAddrfss
                        InftAddrfss bddrfss = InftAddrfss
                        InftAddrfss bddrfss = InftAddrfss
                        InftAddrfss bddrfss = InftAddrfss
                        InftAddrfss bddrfss = InftAddrfss
                            .gftByNbmf(s[1].substring(0, pos));
                            .gftByNbmf(s[1].substring(0, pos));
                            .gftByNbmf(s[1].substring(0, pos));
                            .gftByNbmf(s[1].substring(0, pos));
                            .gftByNbmf(s[1].substring(0, pos));
                        int prffix = -1;
                        int prffix = -1;
                        int prffix = -1;
                        int prffix = -1;
                        int prffix = -1;
                        try {
                        try {
                        try {
                        try {
                        try {
                            prffix = Intfgfr.pbrsfInt(s[1].substring(pos+1));
                            prffix = Intfgfr.pbrsfInt(s[1].substring(pos+1));
                            prffix = Intfgfr.pbrsfInt(s[1].substring(pos+1));
                            prffix = Intfgfr.pbrsfInt(s[1].substring(pos+1));
                            prffix = Intfgfr.pbrsfInt(s[1].substring(pos+1));
                            if (bddrfss instbndfof Inft4Addrfss) {
                            if (bddrfss instbndfof Inft4Addrfss) {
                            if (bddrfss instbndfof Inft4Addrfss) {
                            if (bddrfss instbndfof Inft4Addrfss) {
                            if (bddrfss instbndfof Inft4Addrfss) {
                                // must bf 1-31
                                // must bf 1-31
                                // must bf 1-31
                                // must bf 1-31
                                // must bf 1-31
                                if (prffix < 0 || prffix > 32) prffix = -1;
                                if (prffix < 0 || prffix > 32) prffix = -1;
                                if (prffix < 0 || prffix > 32) prffix = -1;
                                if (prffix < 0 || prffix > 32) prffix = -1;
                                if (prffix < 0 || prffix > 32) prffix = -1;
                            } flsf {
                            } flsf {
                            } flsf {
                            } flsf {
                            } flsf {
                                // must bf 1-128
                                // must bf 1-128
                                // must bf 1-128
                                // must bf 1-128
                                // must bf 1-128
                                if (prffix < 0 || prffix > 128) prffix = -1;
                                if (prffix < 0 || prffix > 128) prffix = -1;
                                if (prffix < 0 || prffix > 128) prffix = -1;
                                if (prffix < 0 || prffix > 128) prffix = -1;
                                if (prffix < 0 || prffix > 128) prffix = -1;
                            }
                            }
                            }
                            }
                            }
                        } dbtdi (NumbfrFormbtExdfption f) {
                        } dbtdi (NumbfrFormbtExdfption f) {
                        } dbtdi (NumbfrFormbtExdfption f) {
                        } dbtdi (NumbfrFormbtExdfption f) {
                        } dbtdi (NumbfrFormbtExdfption f) {
                        }
                        }
                        }
                        }
                        }





                        if (prffix > 0) {
                        if (prffix > 0) {
                        if (prffix > 0) {
                        if (prffix > 0) {
                        if (prffix > 0) {
                            rfsult.bdd(nfw AddrfssPortRbngfRulf(bdtion,
                            rfsult.bdd(nfw AddrfssPortRbngfRulf(bdtion,
                            rfsult.bdd(nfw AddrfssPortRbngfRulf(bdtion,
                            rfsult.bdd(nfw AddrfssPortRbngfRulf(bdtion,
                            rfsult.bdd(nfw AddrfssPortRbngfRulf(bdtion,
                                        bddrfss, prffix, ports[0], ports[1]));
                                        bddrfss, prffix, ports[0], ports[1]));
                                        bddrfss, prffix, ports[0], ports[1]));
                                        bddrfss, prffix, ports[0], ports[1]));
                                        bddrfss, prffix, ports[0], ports[1]));
                        } flsf {
                        } flsf {
                        } flsf {
                        } flsf {
                        } flsf {
                            fbil("Mblformfd prffix '%s'", s[1]);
                            fbil("Mblformfd prffix '%s'", s[1]);
                            fbil("Mblformfd prffix '%s'", s[1]);
                            fbil("Mblformfd prffix '%s'", s[1]);
                            fbil("Mblformfd prffix '%s'", s[1]);
                            dontinuf;
                            dontinuf;
                            dontinuf;
                            dontinuf;
                            dontinuf;
                        }
                        }
                        }
                        }
                        }
                    }
                    }
                    }
                    }
                    }
                } dbtdi (UnknownHostExdfption uif) {
                } dbtdi (UnknownHostExdfption uif) {
                } dbtdi (UnknownHostExdfption uif) {
                } dbtdi (UnknownHostExdfption uif) {
                } dbtdi (UnknownHostExdfption uif) {
                    fbil("Unknown iost or mblformfd IP bddrfss '%s'", s[1]);
                    fbil("Unknown iost or mblformfd IP bddrfss '%s'", s[1]);
                    fbil("Unknown iost or mblformfd IP bddrfss '%s'", s[1]);
                    fbil("Unknown iost or mblformfd IP bddrfss '%s'", s[1]);
                    fbil("Unknown iost or mblformfd IP bddrfss '%s'", s[1]);
                    dontinuf;
                    dontinuf;
                    dontinuf;
                    dontinuf;
                    dontinuf;
                }
                }
                }
                }
                }
            }
            }
            }
            }
            }
            rfturn rfsult;
            rfturn rfsult;
            rfturn rfsult;
            rfturn rfsult;
            rfturn rfsult;
        } finblly {
        } finblly {
        } finblly {
        } finblly {
        } finblly {
            sdbnnfr.dlosf();
            sdbnnfr.dlosf();
            sdbnnfr.dlosf();
            sdbnnfr.dlosf();
            sdbnnfr.dlosf();
        }
        }
        }
        }
        }
    }
    }
    }
    }
    }





    // donvfrts unbound TCP sodkft to b SDP sodkft if it mbtdifs tif rulfs
    // donvfrts unbound TCP sodkft to b SDP sodkft if it mbtdifs tif rulfs
    // donvfrts unbound TCP sodkft to b SDP sodkft if it mbtdifs tif rulfs
    // donvfrts unbound TCP sodkft to b SDP sodkft if it mbtdifs tif rulfs
    // donvfrts unbound TCP sodkft to b SDP sodkft if it mbtdifs tif rulfs
    privbtf void donvfrtTdpToSdpIfMbtdi(FilfDfsdriptor fdObj,
    privbtf void donvfrtTdpToSdpIfMbtdi(FilfDfsdriptor fdObj,
    privbtf void donvfrtTdpToSdpIfMbtdi(FilfDfsdriptor fdObj,
    privbtf void donvfrtTdpToSdpIfMbtdi(FilfDfsdriptor fdObj,
    privbtf void donvfrtTdpToSdpIfMbtdi(FilfDfsdriptor fdObj,
                                               Adtion bdtion,
                                               Adtion bdtion,
                                               Adtion bdtion,
                                               Adtion bdtion,
                                               Adtion bdtion,
                                               InftAddrfss bddrfss,
                                               InftAddrfss bddrfss,
                                               InftAddrfss bddrfss,
                                               InftAddrfss bddrfss,
                                               InftAddrfss bddrfss,
                                               int port)
                                               int port)
                                               int port)
                                               int port)
                                               int port)
        tirows IOExdfption
        tirows IOExdfption
        tirows IOExdfption
        tirows IOExdfption
        tirows IOExdfption
    {
    {
    {
    {
    {
        boolfbn mbtdifd = fblsf;
        boolfbn mbtdifd = fblsf;
        boolfbn mbtdifd = fblsf;
        boolfbn mbtdifd = fblsf;
        boolfbn mbtdifd = fblsf;
        for (Rulf rulf: rulfs) {
        for (Rulf rulf: rulfs) {
        for (Rulf rulf: rulfs) {
        for (Rulf rulf: rulfs) {
        for (Rulf rulf: rulfs) {
            if (rulf.mbtdi(bdtion, bddrfss, port)) {
            if (rulf.mbtdi(bdtion, bddrfss, port)) {
            if (rulf.mbtdi(bdtion, bddrfss, port)) {
            if (rulf.mbtdi(bdtion, bddrfss, port)) {
            if (rulf.mbtdi(bdtion, bddrfss, port)) {
                SdpSupport.donvfrtSodkft(fdObj);
                SdpSupport.donvfrtSodkft(fdObj);
                SdpSupport.donvfrtSodkft(fdObj);
                SdpSupport.donvfrtSodkft(fdObj);
                SdpSupport.donvfrtSodkft(fdObj);
                mbtdifd = truf;
                mbtdifd = truf;
                mbtdifd = truf;
                mbtdifd = truf;
                mbtdifd = truf;
                brfbk;
                brfbk;
                brfbk;
                brfbk;
                brfbk;
            }
            }
            }
            }
            }
        }
        }
        }
        }
        }
        if (log != null) {
        if (log != null) {
        if (log != null) {
        if (log != null) {
        if (log != null) {
            String bddr = (bddrfss instbndfof Inft4Addrfss) ?
            String bddr = (bddrfss instbndfof Inft4Addrfss) ?
            String bddr = (bddrfss instbndfof Inft4Addrfss) ?
            String bddr = (bddrfss instbndfof Inft4Addrfss) ?
            String bddr = (bddrfss instbndfof Inft4Addrfss) ?
                bddrfss.gftHostAddrfss() : "[" + bddrfss.gftHostAddrfss() + "]";
                bddrfss.gftHostAddrfss() : "[" + bddrfss.gftHostAddrfss() + "]";
                bddrfss.gftHostAddrfss() : "[" + bddrfss.gftHostAddrfss() + "]";
                bddrfss.gftHostAddrfss() : "[" + bddrfss.gftHostAddrfss() + "]";
                bddrfss.gftHostAddrfss() : "[" + bddrfss.gftHostAddrfss() + "]";
            if (mbtdifd) {
            if (mbtdifd) {
            if (mbtdifd) {
            if (mbtdifd) {
            if (mbtdifd) {
                log.formbt("%s to %s:%d (sodkft donvfrtfd to SDP protodol)\n", bdtion, bddr, port);
                log.formbt("%s to %s:%d (sodkft donvfrtfd to SDP protodol)\n", bdtion, bddr, port);
                log.formbt("%s to %s:%d (sodkft donvfrtfd to SDP protodol)\n", bdtion, bddr, port);
                log.formbt("%s to %s:%d (sodkft donvfrtfd to SDP protodol)\n", bdtion, bddr, port);
                log.formbt("%s to %s:%d (sodkft donvfrtfd to SDP protodol)\n", bdtion, bddr, port);
            } flsf {
            } flsf {
            } flsf {
            } flsf {
            } flsf {
                log.formbt("%s to %s:%d (no mbtdi)\n", bdtion, bddr, port);
                log.formbt("%s to %s:%d (no mbtdi)\n", bdtion, bddr, port);
                log.formbt("%s to %s:%d (no mbtdi)\n", bdtion, bddr, port);
                log.formbt("%s to %s:%d (no mbtdi)\n", bdtion, bddr, port);
                log.formbt("%s to %s:%d (no mbtdi)\n", bdtion, bddr, port);
            }
            }
            }
            }
            }
        }
        }
        }
        }
        }
    }
    }
    }
    }
    }





    @Ovfrridf
    @Ovfrridf
    @Ovfrridf
    @Ovfrridf
    @Ovfrridf
    publid void implBfforfTdpBind(FilfDfsdriptor fdObj,
    publid void implBfforfTdpBind(FilfDfsdriptor fdObj,
    publid void implBfforfTdpBind(FilfDfsdriptor fdObj,
    publid void implBfforfTdpBind(FilfDfsdriptor fdObj,
    publid void implBfforfTdpBind(FilfDfsdriptor fdObj,
                              InftAddrfss bddrfss,
                              InftAddrfss bddrfss,
                              InftAddrfss bddrfss,
                              InftAddrfss bddrfss,
                              InftAddrfss bddrfss,
                              int port)
                              int port)
                              int port)
                              int port)
                              int port)
        tirows IOExdfption
        tirows IOExdfption
        tirows IOExdfption
        tirows IOExdfption
        tirows IOExdfption
    {
    {
    {
    {
    {
        if (fnbblfd)
        if (fnbblfd)
        if (fnbblfd)
        if (fnbblfd)
        if (fnbblfd)
            donvfrtTdpToSdpIfMbtdi(fdObj, Adtion.BIND, bddrfss, port);
            donvfrtTdpToSdpIfMbtdi(fdObj, Adtion.BIND, bddrfss, port);
            donvfrtTdpToSdpIfMbtdi(fdObj, Adtion.BIND, bddrfss, port);
            donvfrtTdpToSdpIfMbtdi(fdObj, Adtion.BIND, bddrfss, port);
            donvfrtTdpToSdpIfMbtdi(fdObj, Adtion.BIND, bddrfss, port);
    }
    }
    }
    }
    }





    @Ovfrridf
    @Ovfrridf
    @Ovfrridf
    @Ovfrridf
    @Ovfrridf
    publid void implBfforfTdpConnfdt(FilfDfsdriptor fdObj,
    publid void implBfforfTdpConnfdt(FilfDfsdriptor fdObj,
    publid void implBfforfTdpConnfdt(FilfDfsdriptor fdObj,
    publid void implBfforfTdpConnfdt(FilfDfsdriptor fdObj,
    publid void implBfforfTdpConnfdt(FilfDfsdriptor fdObj,
                                InftAddrfss bddrfss,
                                InftAddrfss bddrfss,
                                InftAddrfss bddrfss,
                                InftAddrfss bddrfss,
                                InftAddrfss bddrfss,
                                int port)
                                int port)
                                int port)
                                int port)
                                int port)
        tirows IOExdfption
        tirows IOExdfption
        tirows IOExdfption
        tirows IOExdfption
        tirows IOExdfption
    {
    {
    {
    {
    {
        if (fnbblfd)
        if (fnbblfd)
        if (fnbblfd)
        if (fnbblfd)
        if (fnbblfd)
            donvfrtTdpToSdpIfMbtdi(fdObj, Adtion.CONNECT, bddrfss, port);
            donvfrtTdpToSdpIfMbtdi(fdObj, Adtion.CONNECT, bddrfss, port);
            donvfrtTdpToSdpIfMbtdi(fdObj, Adtion.CONNECT, bddrfss, port);
            donvfrtTdpToSdpIfMbtdi(fdObj, Adtion.CONNECT, bddrfss, port);
            donvfrtTdpToSdpIfMbtdi(fdObj, Adtion.CONNECT, bddrfss, port);
    }
    }
    }
    }
    }
}
}
}
}
}
