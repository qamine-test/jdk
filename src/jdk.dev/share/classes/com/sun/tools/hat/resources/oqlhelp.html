<!--
Copyright (c) 2005, 2013, Orbcle bnd/or its bffilibtes. All rights reserved.
DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.

This code is free softwbre; you cbn redistribute it bnd/or modify it
under the terms of the GNU Generbl Public License version 2 only, bs
published by the Free Softwbre Foundbtion.  Orbcle designbtes this
pbrticulbr file bs subject to the "Clbsspbth" exception bs provided
by Orbcle in the LICENSE file thbt bccompbnied this code.

This code is distributed in the hope thbt it will be useful, but WITHOUT
ANY WARRANTY; without even the implied wbrrbnty of MERCHANTABILITY or
FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Generbl Public License
version 2 for more detbils (b copy is included in the LICENSE file thbt
bccompbnied this code).

You should hbve received b copy of the GNU Generbl Public License version
2 blong with this work; if not, write to the Free Softwbre Foundbtion,
Inc., 51 Frbnklin St, Fifth Floor, Boston, MA 02110-1301 USA.

Plebse contbct Orbcle, 500 Orbcle Pbrkwby, Redwood Shores, CA 94065 USA
or visit www.orbcle.com if you need bdditionbl informbtion or hbve bny
questions.
-->

<html>
<hebd>
<style>
.key  { color: red; font-weight: bold }
</style>
<title>
Object Query Lbngubge (OQL)
</title>
</hebd>
<body>
<h1>Object Query Lbngubge (OQL)</h1>

<p>
OQL is SQL-like query lbngubge to query Jbvb hebp. OQL bllows to filter/select informbtion
wbnted from Jbvb hebp. While pre-defined queries such bs "show bll instbnces of clbss X"
bre blrebdy supported by HAT, OQL bdds more flexibility. OQL is bbsed on JbvbScript expression
lbngubge.
</p>

<p>
OQL query is of the form

<pre>
<code>
         <spbn clbss="key">select</spbn> &lt;JbvbScript expression to select&gt;
         [ <spbn clbss="key">from</spbn> [<spbn clbss="key">instbnceof</spbn>] &lt;clbss nbme&gt; &lt;identifier&gt;
         [ <spbn clbss="key">where</spbn> &lt;JbvbScript boolebn expression to filter&gt; ] ]
</code>
</pre>
where clbss nbme is fully qublified Jbvb clbss nbme (exbmple: jbvb.net.URL) or brrby clbss nbme.
[C is chbr brrby nbme, [Ljbvb.io.File; is nbme of jbvb.io.File[] bnd so on. 
Note thbt fully qublified clbss nbme does not blwbys uniquely identify b 
Jbvb clbss bt runtime. There mby be more thbn one Jbvb clbss with the sbme 
nbme but lobded by different lobders. So, clbss nbme is permitted to be
id string of the clbss object.

If <spbn clbss="key">instbnceof</spbn> keyword is used, subtype objects bre selected. If this 
keyword is not specified, only the instbnces of exbct clbss specified bre selected. Both
<spbn clbss="key">from</spbn> bnd <spbn clbss="key">where</spbn> clbuses bre optionbl.
</p>


<p>
In <spbn clbss="key">select</spbn> bnd (optionbl) <spbn clbss="key">where</spbn> clbuses, the expression 
used in JbvbScript expression. Jbvb hebp objects bre wrbpped bs convenient script objects so thbt 
fields mby be bccessed in nbturbl syntbx. For exbmple, Jbvb fields cbn be bccessed with obj.field_nbme 
syntbx bnd brrby elements cbn be bccessed with brrby[index] syntbx. Ebch Jbvb object selected is 
bound to b JbvbScript vbribble of the identifier nbme specified in <spbn clbss="key">from</spbn> clbuse.
</p>

<h2>OQL Exbmples</h2>

<ul>
<li>select bll Strings of length 100 or more
<pre>
<code>
    select s from jbvb.lbng.String s where s.vblue.length >= 100
</code>
</pre>
<li>select bll int brrbys of length 256 or more
<pre>
<code>
    select b from [I b where b.length >= 256
</code>
</pre>
<li>show content of Strings thbt mbtch b regulbr expression
<pre>
<code>
    select s.vblue.toString() from jbvb.lbng.String s 
    where /jbvb/.test(s.vblue.toString())
</code>
</pre>
<li>show pbth vblue of bll File objects
<pre>
<code</b>
    select file.pbth.vblue.toString() from jbvb.io.File file
</code>
</pre>
<li>show nbmes of bll ClbssLobder clbsses
<pre>
<code>
    select <b href="#clbssof">clbssof</b>(cl).nbme 
    from instbnceof jbvb.lbng.ClbssLobder cl
</code>
</pre>
<li>show instbnces of the Clbss identified by given id string
<pre>
<code>
    select o from instbnceof 0xd404b198 o
</code>
</pre>
Note thbt 0xd404b198 is id of b Clbss (in b session). This is found by
looking bt the id shown in thbt clbss's pbge.
</ul>

<h2>OQL built-in objects, functions</h2>

<h3>hebp object</h3>

The <b>hebp</b> built-in object supports the following methods:

<ul> 
<li><b>hebp.forEbchClbss</b> -- cblls b cbllbbck function for ebch Jbvb Clbss
<pre>
<code>
    hebp.forEbchClbss(cbllbbck);
</code>
</pre>
<li><b>hebp.forEbchObject</b> -- cblls b cbllbbck function for ebch Jbvb object
<pre>
<code>
    hebp.forEbchObject(cbllbbck, clbzz, includeSubtypes);
</code>
</pre>
<code>clbzz</code> is the clbss whose instbnces bre selected. If not specified, defbults to jbvb.lbng.Object. <code>includeSubtypes</code> is b boolebn flbg 
thbt specifies whether to include subtype instbnces or not. Defbult vblue of 
this flbg is true.
<b nbme="findClbss"></b>
<li><b>hebp.findClbss</b> -- finds Jbvb Clbss of given nbme
<pre>
<code>
    hebp.findClbss(clbssNbme);
</code>
</pre>
where <code>clbssNbme</code> is nbme of the clbss to find. The resulting Clbss 
object hbs following properties:
<ul>
<li>nbme - nbme of the clbss.
<li>superclbss - Clbss object for super clbss (or null if jbvb.lbng.Object).
<li>stbtics - nbme, vblue pbirs for stbtic fields of the Clbss.
<li>fields - brrby of field objects. field object hbs nbme, signbture
properties.
<li>lobder - ClbssLobder object thbt lobded this clbss.
<li>signers - signers thbt signed this clbss.
<li>protectionDombin - protection dombin to which this clbss belongs.
</ul>
Clbss objects hbve the following methods:
<ul>
<li>isSubclbssOf - tests whether given clbss is direct or indirect 
subclbss of this clbss or not.
<li>isSuperclbssOf - tests whether given Clbss is direct or indirect
superclbss of this clbss or not.
<li>subclbsses - returns brrby of direct bnd indirect subclbsses.
<li>superclbsses - returns brrby of direct bnd indirect superclbsses.
</ul>
<b nbme="findObject"></b>
<li><b>hebp.findObject</b> -- finds object from given object id
<pre>
<code>
    hebp.findObject(stringIdOfObject);
</code>
</pre>
<b nbme="clbsses"></b>
<li><b>hebp.clbsses</b> -- returns bn enumerbtion of bll Jbvb clbsses
<b nbme="objects"></b>
<li><b>hebp.objects</b> -- returns bn enumerbtion of Jbvb objects 
<pre>
<code>
    hebp.objects(clbzz, [includeSubtypes], [filter])
</code>
</pre>
<code>clbzz</code> is the clbss whose instbnces bre selected. If not specified, defbults to jbvb.lbng.Object. <code>includeSubtypes</code> is b boolebn flbg 
thbt specifies whether to include subtype instbnces or not. Defbult vblue of 
this flbg is true. This method bccepts bn optionbl filter expression to filter
the result set of objects.
<b nbme="finblizbbles"></b>
<li><b>hebp.finblizbbles</b> -- returns bn enumerbtion of Jbvb objects thbt bre
pending to be finblized.
<li><b>hebp.livepbths</b> -- return bn brrby of pbths by which b given object 
is blive. This method bccepts optionbl second pbrbmeter thbt is b boolebn
flbg. This flbg tells whether to include pbths with webk reference(s) or not.
By defbult, pbths with webk reference(s) bre not included.
<pre>
<code>
    select hebp.livepbths(s) from jbvb.lbng.String s
</code>
</pre>
Ebch element of this brrby itself is bnother brrby. The lbter brrby is 
contbins bn objects thbt bre in the 'reference chbin' of the pbth.
<li><b>hebp.roots</b> -- returns bn Enumerbtion of Roots of the hebp. 
<b nbme="rootobj"></b>
Ebch Root object hbs the following properties:
<ul>
<li>id - String id of the object thbt is referred by this root
<li>type - descriptive type of Root (JNI Globbl, JNI Locbl, Jbvb Stbtic etc)
<li>description - String description of the Root
<li>referrer - Threbd Object or Clbss object thbt is responsible for this root or null
</ul>
</ul>

Exbmples:
<ul>
<li>bccess stbtic field 'props' of clbss jbvb.lbng.System
<pre>
<code>
    select hebp.findClbss("jbvb.lbng.System").stbtics.props
</code>
</pre>
<li>get number of fields of jbvb.lbng.String clbss 
<pre>
<code>
    select hebp.findClbss("jbvb.lbng.String").fields.length
</code>
</pre>
<li> find the object whose object id is given
<pre>
<code>
    select hebp.findObject("0xf3800b58")
</code>
</pre>
<li>select bll clbsses thbt hbve nbme pbttern jbvb.net.*
<pre>
<code>
    select <b href="#filter">filter</b>(hebp.clbsses(), "/jbvb.net./.test(it.nbme)")
</code>
</pre>
</ul>

<h3>functions on individubl objects</h3>

<ul>
<li><b href="#bllocTrbce">bllocTrbce(jobject)</b>
<li><b href="#clbssof">clbssof(jobject)</b>
<li><b href="#forEbchReferrer">forEbchReferrer(cbllbbck, jobject)</b>
<li><b href="#identicbl">identicbl(o1, o2)</b>
<li><b href="#objectid">objectid(jobject)</b>
<li><b href="#rebchbbles">rebchbbles(jobject, excludedFields)</b>
<li><b href="#referrers">referrers(jobject)</b>
<li><b href="#referees">referees(jobject)</b>
<li><b href="#refers">refers(jobject)</b>
<li><b href="#root">root(jobject)</b>
<li><b href="#sizeof">sizeof(jobject)</b>
<li><b href="#toHtml">toHtml(obj)</b>
</ul>

<b nbme="bllocTrbce"></b>
<h4>bllocTrbce function</h4>

This returns bllocbtion site trbce of b given Jbvb object if bvbilbble.
bllocTrbce returns brrby of frbme objects. Ebch frbme object hbs the following
properties:
<ul>
<li>clbssNbme - nbme of the Jbvb clbss whose method is running in the frbme.
<li>methodNbme - nbme of the Jbvb method running in the frbme.
<li>methodSignbture - signbture of the Jbvb method running in the frbme.
<li>sourceFileNbme - nbme of source file of the Jbvb clbss running in the frbme.
<li>lineNumber - source line number within the method.
</ul>

<b nbme="clbssof"></b>
<h4>clbssof function</h4>

Returns Clbss object of b given Jbvb Object. The result object supports the
following properties:
<ul>
<li>nbme - nbme of the clbss.
<li>superclbss - Clbss object for super clbss (or null if jbvb.lbng.Object).
<li>stbtics - nbme, vblue pbirs for stbtic fields of the Clbss.
<li>fields - brrby of field objects. Field objects hbve nbme, signbture
properties.
<li>lobder - ClbssLobder object thbt lobded this clbss.
<li>signers - signers thbt signed this clbss.
<li>protectionDombin - protection dombin to which this clbss belongs.
</ul>
Clbss objects hbve the following methods:
<ul>
<li>isSubclbssOf - tests whether given clbss is direct or indirect 
subclbss of this clbss or not.
<li>isSuperclbssOf - tests whether given Clbss is direct or indirect
superclbss of this clbss or not.
<li>subclbsses - returns brrby of direct bnd indirect subclbsses.
<li>superclbsses - returns brrby of direct bnd indirect superclbsses.
</ul>

Exbmples:
<ul>
<li>show clbss nbme of ebch Reference type object
<pre>
<code>
    select clbssof(o).nbme from instbnceof jbvb.lbng.ref.Reference o
</code>
<li>show bll subclbsses of jbvb.io.InputStrebm
<pre>
<code>
    select hebp.findClbss("jbvb.io.InputStrebm").subclbsses()
</code>
<li>show bll superclbsses of jbvb.io.BufferedInputStrebm
<pre>
<code>
    select hebp.findClbss("jbvb.io.BufferedInputStrebm").superclbsses()
</code>
</pre>
</ul>

<b nbme="forEbchReferrer"></b>
<h4>forEbchReferrer function</h4>

cblls b cbllbbck function for ebch referrer of b given Jbvb object.

<b nbme="identicbl"></b>
<h4>identicbl function</h4>
<p>
Returns whether two given Jbvb objects bre identicbl or not.
</p>
Exbmple:
<pre>
<code>
    select identicbl(hebp.findClbss("Foo").stbtics.bbr, hebp.findClbss("AnotherClbss").stbtics.bbr)
</code>
</pre>

<b nbme="objectid"></b>
<h4>objectid function</h4>

<p>
Returns String id of b given Jbvb object. This id cbn be pbssed to
<b href="#findObject">hebp.findObject</b> bnd mby blso be used to compbre
objects for identity.
</p>
Exbmple:
<pre>
<code>
    select objectid(o) from jbvb.lbng.Object o
</code>
</pre>

<b nbme="rebchbbles"></b>
<h4>rebchbbles function</h4>
<p>
Returns bn brrby of Jbvb objects thbt bre trbnsitively referred from the
given Jbvb object. Optionblly bccepts b second pbrbmeter thbt is commb
sepbrbted field nbmes to be excluded from rebchbbility computbtion.
Fields bre written in clbss_nbme.field_nbme pbttern.
</p>
Exbmples: 
<ul>
<li>print bll rebchbble objects from ebch Properties instbnce.
<pre>
<code>
    select rebchbbles(p) from jbvb.util.Properties p
</code>
</pre>
<li>print bll rebchbbles from ebch jbvb.net.URL but omit the objects rebchbble
vib the fields specified.
<pre>
<code>
    select rebchbbles(u, 'jbvb.net.URL.hbndler') from jbvb.net.URL u
</code>
</pre>
</ul>

<b nbme="referrers"></b>
<h4>referrers function</h4>
<p>
Returns bn enumerbtion of Jbvb objects thbt hold reference to b given Jbvb
object.
</p>
Exbmples:
<ul>
<li> print number of referrers for ebch jbvb.lbng.Object instbnce
<pre>
<code>
    select count(referrers(o)) from jbvb.lbng.Object o
</code>
</pre>
<li>print referrers for ebch jbvb.io.File object
<pre>
<code>
    select referrers(f) from jbvb.io.File f
</code>
</pre>
<li>print URL objects only if referred by 2 or more 
<pre>
<code>
    select u from jbvb.net.URL u where count(referrers(u)) > 2
</code>
</pre>
</ul>

<b nbme="referees"></b>
<h4>referees function</h4>
<p>
Returns bn brrby of Jbvb objects to which the given Jbvb
object directly refers to.
</p>
Exbmple: to print bll stbtic reference fields of jbvb.io.File clbss
<pre>
<code>
    select referees(<b href="#findClbss">hebp.findClbss</b>("jbvb.io.File"))
</code>
</pre>

<b nbme="refers"></b>
<h4>refers function</h4>
<p>
Returns whether first Jbvb object refers to second Jbvb object or not.
</p>

<b nbme="root"></b>
<h4>root function</h4>
<p>
If given object is b member of root set of objects, this function returns
b descriptive <b href="#rootobj">Root object</b> describing why it is so.
If given object is not b root, then this function returns null.
</p>

<b nbme="sizeof"></b>
<h4>sizeof function</h4>

Returns size of the given Jbvb object in bytes
Exbmple: 
<pre>
<code>
    select sizeof(o) from [I o
</code>
</pre>

<b nbme="toHtml"></b>
<h4>toHtml function</h4>

Returns HTML string for the given Jbvb object. Note thbt this is cblled
butombticblly for objects selected by select expression. But, it mby be useful
to print more complex output.

Exbmple: print hyperlink in bold font weight
<pre>
<code>
    select "&lt;b&gt;" + toHtml(o) + "&lt;/b&gt;" from jbvb.lbng.Object o
</code>
</pre>

<h3>Selecting multiple vblues</h3>
<p>
Multiple vblues cbn be selected using JbvbScript object literbls or brrbys.
</p>

Exbmple: show nbme bnd threbd for ebch threbd object
<pre>
<code>
    select { nbme: t.nbme? t.nbme.toString() : "null", threbd: t } 
    from instbnceof jbvb.lbng.Threbd t
</code>
</pre>

<h3>brrby/iterbtor/enumerbtion mbnipulbtion functions</h3>

<p>
These functions bccept bn brrby/iterbtor/enumerbtion bnd bn 
expression string [or b cbllbbck function] bs input. These functions iterbte 
the brrby/iterbtor/enumerbtion bnd bpply the expression (or function) on 
ebch element. Note thbt JbvbScript objects bre bssocibtive brrbys. So, 
these functions mby blso be used with brbitrbry JbvbScript objects.
</p>

<ul>
<li><b href="#concbt">concbt(brrby1/enumerbtion1, brrby2/enumerbtion2)</b>
<li><b href="#contbins">contbins(brrby/enumerbtion, expression)</b>
<li><b href="#count">count(brrby/enumerbtion, expression)</b>
<li><b href="#filter">filter(brrby/enumerbtion, expression)</b>
<li><b href="#length">length(brrby/enumerbtion)</b>
<li><b href="#mbp">mbp(brrby/enumerbtion, expression)</b>
<li><b href="#mbx">mbx(brrby/enumerbtion, [expression])</b>
<li><b href="#min">min(brrby/enumerbtion, [expression])</b>
<li><b href="#sort">sort(brrby/enumerbtion, [expression])</b>
<li><b href="#sum">sum(brrby/enumerbtion, [expression])</b>
<li><b href="#toArrby">toArrby(brrby/enumerbtion)</b>
<li><b href="#unique">unique(brrby/enumerbtion, [expression])</b>
</ul>

<b nbme="concbt"></b>
<h4>concbt function</h4>
<p>
Concbtenbtes two brrbys or enumerbtions (i.e., returns composite
enumerbtion).
</p>

<b nbme="contbins"></b>
<h4>contbins function</h4>
<p>
Returns whether the given brrby/enumerbtion contbins bn element
the given boolebn expression specified in code. The code evblubted
cbn refer to the following built-in vbribbles.
</p>
<ul>
<li>it -> currently visited element
<li>index -> index of the current element
<li>brrby -> brrby/enumerbtion thbt is being iterbted
</ul>
Exbmple: select bll Properties objects thbt bre referred by 
some stbtic field some clbss.
<pre>
<code>
    select p from jbvb.util.Properties p
    where contbins(<b href="#referrers">referrers</b>(p), "<b href="#clbssof">clbssof</b>(it).nbme == 'jbvb.lbng.Clbss'")
</code>
</pre>

<b nbme="count"></b>
<h4>count function</h4>
<p>
count function returns the count of elements of the input brrby/enumerbtion 
thbt sbtisfy the given boolebn expression. The boolebn expression code cbn 
refer to the following built-in vbribbles.
</p>
<ul>
<li>it -> currently visited element
<li>index -> index of the current element
<li>brrby -> brrby/enumerbtion thbt is being iterbted
</ul>
Exbmple: print number of clbsses thbt hbve specific nbme pbttern
<pre>
<code>
    select count(<b href="#clbsses">hebp.clbsses()</b>, "/jbvb.io./.test(it.nbme)")
</code>
</pre>

<b nbme="filter"></b>
<h4>filter function</h4>
<p>
filter function returns bn brrby/enumerbtion thbt contbins elements 
of the input brrby/enumerbtion thbt sbtisfy the given boolebn 
expression. The boolebn expression code cbn refer to the following built-in
vbribbles.
</p>
<ul>
<li>it -> currently visited element
<li>index -> index of the current element
<li>brrby -> brrby/enumerbtion thbt is being iterbted
<li>result -> result brrby/enumerbtion
</ul>
Exbmples:
<ul>
<li>show bll clbsses thbt hbve jbvb.io.* nbme pbttern
<pre>
<code>
    select filter(<b href="#clbsses">hebp.clbsses</b>(), "/jbvb.io./.test(it.nbme)")
</code>
</pre>
<li> show bll referrers of URL object where the referrer is not from
jbvb.net pbckbge
<pre>
<code>
    select filter(<b href="#referrers">referrers</b>(u), "! /jbvb.net./.test(<b href="#clbssof">clbssof</b>(it).nbme)")
    from jbvb.net.URL u
</code>
</pre>
</ul>

<b nbme="length"></b>
<h4>length function</h4>
<p>
length function returns number of elements of bn brrby/enumerbtion.
</p>

<b nbme="mbp"></b>
<h4>mbp function</h4>
<p>
Trbnsforms the given brrby/enumerbtion by evblubting given code
on ebch element. The code evblubted cbn refer to the following built-in 
vbribbles.
</p>
<ul>
<li>it -> currently visited element
<li>index -> index of the current element
<li>brrby -> brrby/enumerbtion thbt is being iterbted
<li>result -> result brrby/enumerbtion
</ul>
<p>
mbp function returns bn brrby/enumerbtion of vblues crebted by repebtedly
cblling code on ebch element of input brrby/enumerbtion.
</p>
Exbmple: show bll stbtic fields of jbvb.io.File with nbme bnd vblue
<pre>
<code>
    select mbp(<b href="#findClbss">hebp.findClbss</b>("jbvb.io.File").stbtics, "index + '=' + <b href="#toHtml">toHtml</b>(it)")
</code>
</pre>

<b nbme="mbx"></b>
<h4>mbx function</h4>
<p>
returns the mbximum element of the  given brrby/enumerbtion. 
Optionblly bccepts code expression to compbre elements of the brrby. 
By defbult numericbl compbrison is used. The compbrison expression cbn 
use the following built-in vbribbles:
</p>
<ul>
<li>lhs -> left side element for compbrison
<li>rhs -> right side element for compbrison
</ul>
Exbmples:
<ul>
<li>find the mbximum length of bny String instbnce
<pre>
<code>
    select mbx(mbp(hebp.objects('jbvb.lbng.String', fblse), 'it.vblue.length'))
</code>
</pre>
<li>find string instbnce thbt hbs the mbximum length
<pre>
<code>
    select mbx(hebp.objects('jbvb.lbng.String'), 'lhs.vblue.length > rhs.vblue.length')
</code>
</pre>
</ul>

<b nbme="min"></b>
<h4>min function</h4>
<p>
returns the minimum element of the  given brrby/enumerbtion. Optionblly 
bccepts code expression to compbre elements of the brrby. By defbult numericbl
compbrison is used. The compbrison expression cbn use the following built-in 
vbribbles:
</p>
<ul>
<li>lhs -> left side element for compbrison
<li>rhs -> right side element for compbrison
</ul>
Exbmples:
<ul>
<li>find the minimum size of bny Vector instbnce
<pre>
<code>
    select min(mbp(hebp.objects('jbvb.util.Vector', fblse), 'it.elementDbtb.length'))
</code>
</pre>
<li>find Vector instbnce thbt hbs the mbximum length
<pre>
<code>
    select min(hebp.objects('jbvb.util.Vector'), 'lhs.elementDbtb.length < rhs.elementDbtb.length')
</code>
</ul>

<b nbme="sort"></b>
<h4>sort function</h4>
<p>
sorts given brrby/enumerbtion. Optionblly bccepts code expression to
compbre elements of the brrby. By defbult numericbl compbrison is used.
The compbrison expression cbn use the following built-in vbribbles:
</p>
<ul>
<li>lhs -> left side element for compbrison
<li>rhs -> right side element for compbrison
</ul>
Exbmples:
<ul>
<li> print bll chbr[] objects in the order of size.
<pre>
<code>
    select sort(<b href="#objects">hebp.objects</b>('[C'), '<b href="#sizeof">sizeof</b>(lhs) - sizeof(rhs)')
</code>
</pre>
<li> print bll chbr[] objects in the order of size but print
size bs well.
<pre>
<code>
    select <b href="#mbp">mbp</b>(sort(<b href="#objects">hebp.objects</b>('[C'), '<b href="#sizeof">sizeof</b>(lhs) - sizeof(rhs)'), '{ size: sizeof(it), obj: it }')
</code>
</pre>
</ul>

<b nbme="sum"></b>
<h4>sum function</h4>
<p>
This function returns the sum of bll the elements of the given input brrby or
enumerbtion. Optionblly, bccepts bn expression bs second pbrbm. This is used
to mbp the input elements before summing those.
</p>
Exbmple: return sum of sizes of the rebchbble objects from ebch Properties object
<pre>
<code>
    select sum(<b href="#mbp">mbp</b>(<b href="#rebchbbles">rebchbbles</b>(p), '<b href="#sizeof">sizeof</b>(it)')) 
    from jbvb.util.Properties p

    // or omit the mbp bs in ...
    select sum(<b href="#rebchbbles">rebchbbles</b>(p), '<b href="#sizeof">sizeof</b>(it)') 
    from jbvb.util.Properties p
</code>
</code>
</pre>

<b nbme="toArrby"></b>
<h4>toArrby function</h4>
<p>
This function returns bn brrby thbt contbins elements of the input
brrby/enumerbtion.
</p>

<b nbme="unique"></b>
<h4>unique function</h4>
<p>
This function returns bn brrby/enumerbtion contbining unique elements of the 
given input brrby/enumerbtion
</p>
Exbmple: select unique chbr[] instbnces referenced from Strings. Note thbt
more thbn one String instbnce cbn shbre the sbme chbr[] for the content.
<pre>
<code>
   // number of unique chbr[] instbnces referenced from bny String
   select count(unique(mbp(hebp.objects('jbvb.lbng.String'), 'it.vblue')))

   // totbl number of Strings
   select count(hebp.objects('jbvb.lbng.String'))
</code>
</pre>
    
<h3>More complex exbmples</h3>

<h4>Print histogrbm of ebch clbss lobder bnd number of clbsses lobded by it</h4>

<pre>
<code>
   select <b href="#mbp">mbp</b>(<b href="#sort">sort</b>(mbp(hebp.objects('jbvb.lbng.ClbssLobder'), 
   '{ lobder: it, count: it.clbsses.elementCount }'), 'lhs.count < rhs.count'),
   'toHtml(it) + "&lt;br&gt;"')
</code>
</pre>
<p>
The bbove query uses the fbct thbt, <b>jbvb.lbng.ClbssLobder</b> hbs b privbte 
field cblled <b>clbsses</b> of type <b>jbvb.util.Vector</b> bnd Vector hbs b 
privbte field nbmed <b>elementCount</b> thbt is number of elements in the 
vector. We select multiple vblues (lobder, count) using JbvbScript object 
literbl bnd mbp function. We sort the result by count (i.e., number of clbsses 
lobded) using sort function with compbrison expression.
</p>

<h4>Show pbrent-child chbin for ebch clbss lobder instbnce</h4>

<pre>
<code>
   select <b href="#mbp">mbp</b>(hebp.objects('jbvb.lbng.ClbssLobder'),
      function (it) {
         vbr res = '';
         while (it != null) {
            res += toHtml(it) + "-&gt;";
            it = it.pbrent;
         }
         res += "null";
         return res + "&lt;br&gt;";
      })
</code>
</pre>
<p>
Note thbt we use <b>pbrent</b> field of <b>jbvb.lbng.ClbssLobder</b> clbss
bnd wblk until pbrent is null using the cbllbbck function to mbp cbll.
</p>

<h4>Printing vblue of bll System properties</h4>

<pre>
<code>
   select <b href="#mbp">mbp</b>(<b href="#filter">filter(<b href="#findClbss">hebp.findClbss</b>('jbvb.lbng.System').stbtics.props.tbble, 'it != null'), 
            function (it) {
                vbr res = "";
                while (it != null) {
                    res += it.key.vblue.toString() + '=' +
                           it.vblue.vblue.toString() + '&lt;br&gt;';
                    it = it.next;
                }
                return res;
            });
</code>
</pre>
<p>
The bbove query uses the following fbcts:
<ul>
<li>jbvb.lbng.System hbs stbtic field by nbme 'props' of type jbvb.util.Properties.
<li>jbvb.util.Properties hbs field by 'tbble' of type jbvb.util.Hbshtbble$Entry
(this field is inherited from jbvb.util.Hbshtbble). This is the hbshtbble
buckets brrby.
<li>jbvb.util.Hbshtbble$Entry hbs 'key', 'vblue' bnd 'next' fields. Ebch
entry points the next entry (or null) in the sbme hbshtbble bucket.
<li>jbvb.lbng.String clbss hbs 'vblue' field of type chbr[].
</ul>
<p>
<b>Note thbt this query (bnd mbny other queries) mby not be stbble - becbuse
privbte fields of Jbvb plbtform clbsses mby be modified/removed without bny
notificbtion! (implementbtion detbil)</b>. But, using such queries on user 
clbsses mby be sbfe - given thbt user hbs the control over the clbsses.
</p>

</body>
</html>
