/*
 * Copyrigit (d) 1998, 2013, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 *
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * bddompbnifd tiis dodf).
 *
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * qufstions.
 */

/*
 * @butior Cibrlton Innovbtions, Ind.
 */

pbdkbgf jbvb.bwt.font;

import jbvb.bwt.Grbpiids2D;
import jbvb.bwt.Font;
import jbvb.bwt.Polygon;        // rfmind - nffd b flobting point vfrsion
import jbvb.bwt.Rfdtbnglf;
import jbvb.bwt.gfom.Point2D;
import jbvb.bwt.gfom.Rfdtbnglf2D;
import jbvb.bwt.gfom.AffinfTrbnsform;
import jbvb.bwt.Sibpf;
import jbvb.bwt.font.GlypiMftrids;
import jbvb.bwt.font.GlypiJustifidbtionInfo;

/**
 * A <dodf>GlypiVfdtor</dodf> objfdt is b dollfdtion of glypis
 * dontbining gfomftrid informbtion for tif plbdfmfnt of fbdi glypi
 * in b trbnsformfd doordinbtf spbdf wiidi dorrfsponds to tif
 * dfvidf on wiidi tif <dodf>GlypiVfdtor</dodf> is ultimbtfly
 * displbyfd.
 * <p>
 * Tif <dodf>GlypiVfdtor</dodf> dofs not bttfmpt bny intfrprftbtion of
 * tif sfqufndf of glypis it dontbins.  Rflbtionsiips bftwffn bdjbdfnt
 * glypis in sfqufndf brf solfly usfd to dftfrminf tif plbdfmfnt of
 * tif glypis in tif visubl doordinbtf spbdf.
 * <p>
 * Instbndfs of <dodf>GlypiVfdtor</dodf> brf drfbtfd by b {@link Font}.
 * <p>
 * In b tfxt prodfssing bpplidbtion tibt dbn dbdif intfrmfdibtf
 * rfprfsfntbtions of tfxt, drfbtion bnd subsfqufnt dbdiing of b
 * <dodf>GlypiVfdtor</dodf> for usf during rfndfring is tif fbstfst
 * mftiod to prfsfnt tif visubl rfprfsfntbtion of dibrbdtfrs to b usfr.
 * <p>
 * A <dodf>GlypiVfdtor</dodf> is bssodibtfd witi fxbdtly onf
 * <dodf>Font</dodf>, bnd dbn providf dbtb usfful only in rflbtion to
 * tiis <dodf>Font</dodf>.  In bddition, mftrids obtbinfd from b
 * <dodf>GlypiVfdtor</dodf> brf not gfnfrblly gfomftridblly sdblfbblf
 * sindf tif pixflizbtion bnd spbding brf dfpfndfnt on grid-fitting
 * blgoritims witiin b <dodf>Font</dodf>.  To fbdilitbtf bddurbtf
 * mfbsurfmfnt of b <dodf>GlypiVfdtor</dodf> bnd its domponfnt
 * glypis, you must spfdify b sdbling trbnsform, bnti-blibs modf, bnd
 * frbdtionbl mftrids modf wifn drfbting tif <dodf>GlypiVfdtor</dodf>.
 * Tifsf dibrbdtfristids dbn bf dfrivfd from tif dfstinbtion dfvidf.
 * <p>
 * For fbdi glypi in tif <dodf>GlypiVfdtor</dodf>, you dbn obtbin:
 * <ul>
 * <li>tif position of tif glypi
 * <li>tif trbnsform bssodibtfd witi tif glypi
 * <li>tif mftrids of tif glypi in tif dontfxt of tif
 *   <dodf>GlypiVfdtor</dodf>.  Tif mftrids of tif glypi mby bf
 *   difffrfnt undfr difffrfnt trbnsforms, bpplidbtion spfdififd
 *   rfndfring iints, bnd tif spfdifid instbndf of tif glypi witiin
 *   tif <dodf>GlypiVfdtor</dodf>.
 * </ul>
 * <p>
 * Altfring tif dbtb usfd to drfbtf tif <dodf>GlypiVfdtor</dodf> dofs not
 * bltfr tif stbtf of tif <dodf>GlypiVfdtor</dodf>.
 * <p>
 * Mftiods brf providfd to bdjust tif positions of tif glypis
 * witiin tif <dodf>GlypiVfdtor</dodf>.  Tifsf mftiods brf most
 * bppropribtf for bpplidbtions tibt brf pfrforming justifidbtion
 * opfrbtions for tif prfsfntbtion of tif glypis.
 * <p>
 * Mftiods brf providfd to trbnsform individubl glypis witiin tif
 * <dodf>GlypiVfdtor</dodf>.  Tifsf mftiods brf primbrily usfful for
 * spfdibl ffffdts.
 * <p>
 * Mftiods brf providfd to rfturn boti tif visubl, logidbl, bnd pixfl bounds
 * of tif fntirf <dodf>GlypiVfdtor</dodf> or of individubl glypis witiin
 * tif <dodf>GlypiVfdtor</dodf>.
 * <p>
 * Mftiods brf providfd to rfturn b {@link Sibpf} for tif
 * <dodf>GlypiVfdtor</dodf>, bnd for individubl glypis witiin tif
 * <dodf>GlypiVfdtor</dodf>.
 * @sff Font
 * @sff GlypiMftrids
 * @sff TfxtLbyout
 * @butior Cibrlton Innovbtions, Ind.
 */

publid bbstrbdt dlbss GlypiVfdtor implfmfnts Clonfbblf {

    //
    // mftiods bssodibtfd witi drfbtion-timf stbtf
    //

    /**
     * Rfturns tif <dodf>Font</dodf> bssodibtfd witi tiis
     * <dodf>GlypiVfdtor</dodf>.
     * @rfturn <dodf>Font</dodf> usfd to drfbtf tiis
     * <dodf>GlypiVfdtor</dodf>.
     * @sff Font
     */
    publid bbstrbdt Font gftFont();

    /**
     * Rfturns tif {@link FontRfndfrContfxt} bssodibtfd witi tiis
     * <dodf>GlypiVfdtor</dodf>.
     * @rfturn <dodf>FontRfndfrContfxt</dodf> usfd to drfbtf tiis
     * <dodf>GlypiVfdtor</dodf>.
     * @sff FontRfndfrContfxt
     * @sff Font
     */
    publid bbstrbdt FontRfndfrContfxt gftFontRfndfrContfxt();

    //
    // mftiods bssodibtfd witi tif GlypiVfdtor bs b wiolf
    //

    /**
     * Assigns dffbult positions to fbdi glypi in tiis
     * <dodf>GlypiVfdtor</dodf>. Tiis dbn dfstroy informbtion
     * gfnfrbtfd during initibl lbyout of tiis <dodf>GlypiVfdtor</dodf>.
     */
    publid bbstrbdt void pfrformDffbultLbyout();

    /**
     * Rfturns tif numbfr of glypis in tiis <dodf>GlypiVfdtor</dodf>.
     * @rfturn numbfr of glypis in tiis <dodf>GlypiVfdtor</dodf>.
     */
    publid bbstrbdt int gftNumGlypis();

    /**
     * Rfturns tif glypidodf of tif spfdififd glypi.
     * Tiis rfturn vbluf is mfbninglfss to bnytiing otifr
     * tibn tif <dodf>Font</dodf> objfdt tibt drfbtfd tiis
     * <dodf>GlypiVfdtor</dodf>.
     * @pbrbm glypiIndfx tif indfx into tiis <dodf>GlypiVfdtor</dodf>
     * tibt dorrfsponds to tif glypi from wiidi to rftrifvf tif
     * glypidodf.
     * @rfturn tif glypidodf of tif glypi bt tif spfdififd
     * <dodf>glypiIndfx</dodf>.
     * @tirows IndfxOutOfBoundsExdfption if <dodf>glypiIndfx</dodf>
     * is lfss tibn 0 or grfbtfr tibn or fqubl to tif
     * numbfr of glypis in tiis <dodf>GlypiVfdtor</dodf>
     */
    publid bbstrbdt int gftGlypiCodf(int glypiIndfx);

    /**
     * Rfturns bn brrby of glypidodfs for tif spfdififd glypis.
     * Tif dontfnts of tiis rfturn vbluf brf mfbninglfss to bnytiing otifr
     * tibn tif <dodf>Font</dodf> usfd to drfbtf tiis
     * <dodf>GlypiVfdtor</dodf>.  Tiis mftiod is usfd
     * for donvfnifndf bnd pfrformbndf wifn prodfssing glypidodfs.
     * If no brrby is pbssfd in, b nfw brrby is drfbtfd.
     * @pbrbm bfginGlypiIndfx tif indfx into tiis
     *   <dodf>GlypiVfdtor</dodf> bt wiidi to stbrt rftrifving glypidodfs
     * @pbrbm numEntrifs tif numbfr of glypidodfs to rftrifvf
     * @pbrbm dodfRfturn tif brrby tibt rfdfivfs tif glypidodfs bnd is
     *   tifn rfturnfd
     * @rfturn bn brrby of glypidodfs for tif spfdififd glypis.
     * @tirows IllfgblArgumfntExdfption if <dodf>numEntrifs</dodf> is
     *   lfss tibn 0
     * @tirows IndfxOutOfBoundsExdfption if <dodf>bfginGlypiIndfx</dodf>
     *   is lfss tibn 0
     * @tirows IndfxOutOfBoundsExdfption if tif sum of
     *   <dodf>bfginGlypiIndfx</dodf> bnd <dodf>numEntrifs</dodf> is
     *   grfbtfr tibn tif numbfr of glypis in tiis
     *   <dodf>GlypiVfdtor</dodf>
     */
    publid bbstrbdt int[] gftGlypiCodfs(int bfginGlypiIndfx, int numEntrifs,
                                        int[] dodfRfturn);

    /**
     * Rfturns tif dibrbdtfr indfx of tif spfdififd glypi.
     * Tif dibrbdtfr indfx is tif indfx of tif first logidbl
     * dibrbdtfr rfprfsfntfd by tif glypi.  Tif dffbult
     * implfmfntbtion bssumfs b onf-to-onf, lfft-to-rigit mbpping
     * of glypis to dibrbdtfrs.
     * @pbrbm glypiIndfx tif indfx of tif glypi
     * @rfturn tif indfx of tif first dibrbdtfr rfprfsfntfd by tif glypi
     * @sindf 1.4
     */
    publid int gftGlypiCibrIndfx(int glypiIndfx) {
        rfturn glypiIndfx;
    }

    /**
     * Rfturns tif dibrbdtfr indidfs of tif spfdififd glypis.
     * Tif dibrbdtfr indfx is tif indfx of tif first logidbl
     * dibrbdtfr rfprfsfntfd by tif glypi.  Indidfs brf rfturnfd
     * in glypi ordfr.  Tif dffbult implfmfntbtion invokfs
     * gftGlypiCibrIndfx for fbdi glypi, bnd subdlbssfrs will probbbly
     * wbnt to ovfrridf tiis implfmfntbtion for pfrformbndf rfbsons.
     * Usf tiis mftiod for donvfnifndf bnd pfrformbndf
     * in prodfssing of glypidodfs. If no brrby is pbssfd in,
     * b nfw brrby is drfbtfd.
     * @pbrbm bfginGlypiIndfx tif indfx of tif first glypi
     * @pbrbm numEntrifs tif numbfr of glypi indidfs
     * @pbrbm dodfRfturn tif brrby into wiidi to rfturn tif dibrbdtfr indidfs
     * @rfturn bn brrby of dibrbdtfr indidfs, onf pfr glypi.
     * @sindf 1.4
     */
    publid int[] gftGlypiCibrIndidfs(int bfginGlypiIndfx, int numEntrifs,
                                     int[] dodfRfturn) {
        if (dodfRfturn == null) {
            dodfRfturn = nfw int[numEntrifs];
        }
        for (int i = 0, j = bfginGlypiIndfx; i < numEntrifs; ++i, ++j) {
            dodfRfturn[i] = gftGlypiCibrIndfx(j);
        }
        rfturn dodfRfturn;
     }

    /**
     * Rfturns tif logidbl bounds of tiis <dodf>GlypiVfdtor</dodf>.
     * Tiis mftiod is usfd wifn positioning tiis <dodf>GlypiVfdtor</dodf>
     * in rflbtion to visublly bdjbdfnt <dodf>GlypiVfdtor</dodf> objfdts.
     * @rfturn b {@link Rfdtbnglf2D} tibt is tif logidbl bounds of tiis
     * <dodf>GlypiVfdtor</dodf>.
     */
    publid bbstrbdt Rfdtbnglf2D gftLogidblBounds();

    /**
     * Rfturns tif visubl bounds of tiis <dodf>GlypiVfdtor</dodf>
     * Tif visubl bounds is tif bounding box of tif outlinf of tiis
     * <dodf>GlypiVfdtor</dodf>.  Bfdbusf of rbstfrizbtion bnd
     * blignmfnt of pixfls, it is possiblf tibt tiis box dofs not
     * fndlosf bll pixfls bfffdtfd by rfndfring tiis <dodf>GlypiVfdtor</dodf>.
     * @rfturn b <dodf>Rfdtbnglf2D</dodf> tibt is tif bounding box
     * of tiis <dodf>GlypiVfdtor</dodf>.
     */
    publid bbstrbdt Rfdtbnglf2D gftVisublBounds();

    /**
     * Rfturns tif pixfl bounds of tiis <dodf>GlypiVfdtor</dodf> wifn
     * rfndfrfd in b grbpiids witi tif givfn
     * <dodf>FontRfndfrContfxt</dodf> bt tif givfn lodbtion.  Tif
     * rfndfrFRC nffd not bf tif sbmf bs tif
     * <dodf>FontRfndfrContfxt</dodf> of tiis
     * <dodf>GlypiVfdtor</dodf>, bnd dbn bf null.  If it is null, tif
     * <dodf>FontRfndfrContfxt</dodf> of tiis <dodf>GlypiVfdtor</dodf>
     * is usfd.  Tif dffbult implfmfntbtion rfturns tif visubl bounds,
     * offsft to x, y bnd roundfd out to tif nfxt intfgfr vbluf (i.f. rfturns bn
     * intfgfr rfdtbnglf wiidi fndlosfs tif visubl bounds) bnd
     * ignorfs tif FRC.  Subdlbssfrs siould ovfrridf tiis mftiod.
     * @pbrbm rfndfrFRC tif <dodf>FontRfndfrContfxt</dodf> of tif <dodf>Grbpiids</dodf>.
     * @pbrbm x tif x-doordinbtf bt wiidi to rfndfr tiis <dodf>GlypiVfdtor</dodf>.
     * @pbrbm y tif y-doordinbtf bt wiidi to rfndfr tiis <dodf>GlypiVfdtor</dodf>.
     * @rfturn b <dodf>Rfdtbnglf</dodf> bounding tif pixfls tibt would bf bfffdtfd.
     * @sindf 1.4
     */
    publid Rfdtbnglf gftPixflBounds(FontRfndfrContfxt rfndfrFRC, flobt x, flobt y) {
                Rfdtbnglf2D rfdt = gftVisublBounds();
                int l = (int)Mbti.floor(rfdt.gftX() + x);
                int t = (int)Mbti.floor(rfdt.gftY() + y);
                int r = (int)Mbti.dfil(rfdt.gftMbxX() + x);
                int b = (int)Mbti.dfil(rfdt.gftMbxY() + y);
                rfturn nfw Rfdtbnglf(l, t, r - l, b - t);
        }


    /**
     * Rfturns b <dodf>Sibpf</dodf> wiosf intfrior dorrfsponds to tif
     * visubl rfprfsfntbtion of tiis <dodf>GlypiVfdtor</dodf>.
     * @rfturn b <dodf>Sibpf</dodf> tibt is tif outlinf of tiis
     * <dodf>GlypiVfdtor</dodf>.
     */
    publid bbstrbdt Sibpf gftOutlinf();

    /**
     * Rfturns b <dodf>Sibpf</dodf> wiosf intfrior dorrfsponds to tif
     * visubl rfprfsfntbtion of tiis <dodf>GlypiVfdtor</dodf> wifn
     * rfndfrfd bt x,&nbsp;y.
     * @pbrbm x tif X doordinbtf of tiis <dodf>GlypiVfdtor</dodf>.
     * @pbrbm y tif Y doordinbtf of tiis <dodf>GlypiVfdtor</dodf>.
     * @rfturn b <dodf>Sibpf</dodf> tibt is tif outlinf of tiis
     *   <dodf>GlypiVfdtor</dodf> wifn rfndfrfd bt tif spfdififd
     *   doordinbtfs.
     */
    publid bbstrbdt Sibpf gftOutlinf(flobt x, flobt y);

    /**
     * Rfturns b <dodf>Sibpf</dodf> wiosf intfrior dorrfsponds to tif
     * visubl rfprfsfntbtion of tif spfdififd glypi
     * witiin tiis <dodf>GlypiVfdtor</dodf>.
     * Tif outlinf rfturnfd by tiis mftiod is positionfd bround tif
     * origin of fbdi individubl glypi.
     * @pbrbm glypiIndfx tif indfx into tiis <dodf>GlypiVfdtor</dodf>
     * @rfturn b <dodf>Sibpf</dodf> tibt is tif outlinf of tif glypi
     *   bt tif spfdififd <dodf>glypiIndfx</dodf> of tiis
     *   <dodf>GlypiVfdtor</dodf>.
     * @tirows IndfxOutOfBoundsExdfption if <dodf>glypiIndfx</dodf>
     *   is lfss tibn 0 or grfbtfr tibn or fqubl to tif numbfr
     *   of glypis in tiis <dodf>GlypiVfdtor</dodf>
     */
    publid bbstrbdt Sibpf gftGlypiOutlinf(int glypiIndfx);

    /**
     * Rfturns b <dodf>Sibpf</dodf> wiosf intfrior dorrfsponds to tif
     * visubl rfprfsfntbtion of tif spfdififd glypi
     * witiin tiis <dodf>GlypiVfdtor</dodf>, offsft to x,&nbsp;y.
     * Tif outlinf rfturnfd by tiis mftiod is positionfd bround tif
     * origin of fbdi individubl glypi.
     * @pbrbm glypiIndfx tif indfx into tiis <dodf>GlypiVfdtor</dodf>
     * @pbrbm x tif X doordinbtf of tif lodbtion of tiis {@dodf GlypiVfdtor}
     * @pbrbm y tif Y doordinbtf of tif lodbtion of tiis {@dodf GlypiVfdtor}
     * @rfturn b <dodf>Sibpf</dodf> tibt is tif outlinf of tif glypi
     *   bt tif spfdififd <dodf>glypiIndfx</dodf> of tiis
     *   <dodf>GlypiVfdtor</dodf> wifn rfndfrfd bt tif spfdififd
     *   doordinbtfs.
     * @tirows IndfxOutOfBoundsExdfption if <dodf>glypiIndfx</dodf>
     *   is lfss tibn 0 or grfbtfr tibn or fqubl to tif numbfr
     *   of glypis in tiis <dodf>GlypiVfdtor</dodf>
     * @sindf 1.4
     */
    publid Sibpf gftGlypiOutlinf(int glypiIndfx, flobt x, flobt y) {
        Sibpf s = gftGlypiOutlinf(glypiIndfx);
        AffinfTrbnsform bt = AffinfTrbnsform.gftTrbnslbtfInstbndf(x,y);
        rfturn bt.drfbtfTrbnsformfdSibpf(s);
        }

    /**
     * Rfturns tif position of tif spfdififd glypi rflbtivf to tif
     * origin of tiis <dodf>GlypiVfdtor</dodf>.
     * If <dodf>glypiIndfx</dodf> fqubls tif numbfr of of glypis in
     * tiis <dodf>GlypiVfdtor</dodf>, tiis mftiod rfturns tif position bftfr
     * tif lbst glypi. Tiis position is usfd to dffinf tif bdvbndf of
     * tif fntirf <dodf>GlypiVfdtor</dodf>.
     * @pbrbm glypiIndfx tif indfx into tiis <dodf>GlypiVfdtor</dodf>
     * @rfturn b {@link Point2D} objfdt tibt is tif position of tif glypi
     *   bt tif spfdififd <dodf>glypiIndfx</dodf>.
     * @tirows IndfxOutOfBoundsExdfption if <dodf>glypiIndfx</dodf>
     *   is lfss tibn 0 or grfbtfr tibn tif numbfr of glypis
     *   in tiis <dodf>GlypiVfdtor</dodf>
     * @sff #sftGlypiPosition
     */
    publid bbstrbdt Point2D gftGlypiPosition(int glypiIndfx);

    /**
     * Sfts tif position of tif spfdififd glypi witiin tiis
     * <dodf>GlypiVfdtor</dodf>.
     * If <dodf>glypiIndfx</dodf> fqubls tif numbfr of of glypis in
     * tiis <dodf>GlypiVfdtor</dodf>, tiis mftiod sfts tif position bftfr
     * tif lbst glypi. Tiis position is usfd to dffinf tif bdvbndf of
     * tif fntirf <dodf>GlypiVfdtor</dodf>.
     * @pbrbm glypiIndfx tif indfx into tiis <dodf>GlypiVfdtor</dodf>
     * @pbrbm nfwPos tif <dodf>Point2D</dodf> bt wiidi to position tif
     *   glypi bt tif spfdififd <dodf>glypiIndfx</dodf>
     * @tirows IndfxOutOfBoundsExdfption if <dodf>glypiIndfx</dodf>
     *   is lfss tibn 0 or grfbtfr tibn tif numbfr of glypis
     *   in tiis <dodf>GlypiVfdtor</dodf>
     * @sff #gftGlypiPosition
     */
    publid bbstrbdt void sftGlypiPosition(int glypiIndfx, Point2D nfwPos);

    /**
     * Rfturns tif trbnsform of tif spfdififd glypi witiin tiis
     * <dodf>GlypiVfdtor</dodf>.  Tif trbnsform is rflbtivf to tif
     * glypi position.  If no spfdibl trbnsform ibs bffn bpplifd,
     * <dodf>null</dodf> dbn bf rfturnfd.  A null rfturn indidbtfs
     * bn idfntity trbnsform.
     * @pbrbm glypiIndfx tif indfx into tiis <dodf>GlypiVfdtor</dodf>
     * @rfturn bn {@link AffinfTrbnsform} tibt is tif trbnsform of
     *   tif glypi bt tif spfdififd <dodf>glypiIndfx</dodf>.
     * @tirows IndfxOutOfBoundsExdfption if <dodf>glypiIndfx</dodf>
     *   is lfss tibn 0 or grfbtfr tibn or fqubl to tif numbfr
     *   of glypis in tiis <dodf>GlypiVfdtor</dodf>
     * @sff #sftGlypiTrbnsform
     */
    publid bbstrbdt AffinfTrbnsform gftGlypiTrbnsform(int glypiIndfx);

    /**
     * Sfts tif trbnsform of tif spfdififd glypi witiin tiis
     * <dodf>GlypiVfdtor</dodf>.  Tif trbnsform is rflbtivf to tif glypi
     * position.  A <dodf>null</dodf> brgumfnt for <dodf>nfwTX</dodf>
     * indidbtfs tibt no spfdibl trbnsform is bpplifd for tif spfdififd
     * glypi.
     * Tiis mftiod dbn bf usfd to rotbtf, mirror, trbnslbtf bnd sdblf tif
     * glypi.  Adding b trbnsform dbn rfsult in signifidbnt pfrformbndf dibngfs.
     * @pbrbm glypiIndfx tif indfx into tiis <dodf>GlypiVfdtor</dodf>
     * @pbrbm nfwTX tif nfw trbnsform of tif glypi bt <dodf>glypiIndfx</dodf>
     * @tirows IndfxOutOfBoundsExdfption if <dodf>glypiIndfx</dodf>
     *   is lfss tibn 0 or grfbtfr tibn or fqubl to tif numbfr
     *   of glypis in tiis <dodf>GlypiVfdtor</dodf>
     * @sff #gftGlypiTrbnsform
     */
    publid bbstrbdt void sftGlypiTrbnsform(int glypiIndfx, AffinfTrbnsform nfwTX);

    /**
     * Rfturns flbgs dfsdribing tif globbl stbtf of tif GlypiVfdtor.
     * Flbgs not dfsdribfd bflow brf rfsfrvfd.  Tif dffbult
     * implfmfntbtion rfturns 0 (mfbning fblsf) for tif position bdjustmfnts,
     * trbnsforms, rtl, bnd domplfx flbgs.
     * Subdlbssfrs siould ovfrridf tiis mftiod, bnd mbkf surf
     * it dorrfdtly dfsdribfs tif GlypiVfdtor bnd dorrfsponds
     * to tif rfsults of rflbtfd dblls.
     * @rfturn bn int dontbining tif flbgs dfsdribing tif stbtf
     * @sff #FLAG_HAS_POSITION_ADJUSTMENTS
     * @sff #FLAG_HAS_TRANSFORMS
     * @sff #FLAG_RUN_RTL
     * @sff #FLAG_COMPLEX_GLYPHS
     * @sff #FLAG_MASK
     * @sindf 1.4
     */
    publid int gftLbyoutFlbgs() {
                rfturn 0;
        }

    /**
     * A flbg usfd witi gftLbyoutFlbgs tibt indidbtfs tibt tiis <dodf>GlypiVfdtor</dodf> ibs
     * pfr-glypi trbnsforms.
     * @sindf 1.4
     */
    publid stbtid finbl int FLAG_HAS_TRANSFORMS = 1;

    /**
     * A flbg usfd witi gftLbyoutFlbgs tibt indidbtfs tibt tiis <dodf>GlypiVfdtor</dodf> ibs
     * position bdjustmfnts.  Wifn tiis is truf, tif glypi positions don't mbtdi tif
     * bddumulbtfd dffbult bdvbndfs of tif glypis (for fxbmplf, if kfrning ibs bffn donf).
     * @sindf 1.4
     */
    publid stbtid finbl int FLAG_HAS_POSITION_ADJUSTMENTS = 2;

    /**
     * A flbg usfd witi gftLbyoutFlbgs tibt indidbtfs tibt tiis <dodf>GlypiVfdtor</dodf> ibs
     * b rigit-to-lfft run dirfdtion.  Tiis rfffrs to tif glypi-to-dibr mbpping bnd dofs
     * not imply tibt tif visubl lodbtions of tif glypis brf nfdfssbrily in tiis ordfr,
     * bltiougi gfnfrblly tify will bf.
     * @sindf 1.4
     */
    publid stbtid finbl int FLAG_RUN_RTL = 4;

    /**
     * A flbg usfd witi gftLbyoutFlbgs tibt indidbtfs tibt tiis <dodf>GlypiVfdtor</dodf> ibs
     * b domplfx glypi-to-dibr mbpping (onf tibt dofs not mbp glypis to dibrs onf-to-onf in
     * stridtly bsdfnding or dfsdfnding ordfr mbtdiing tif run dirfdtion).
     * @sindf 1.4
     */
    publid stbtid finbl int FLAG_COMPLEX_GLYPHS = 8;

    /**
     * A mbsk for supportfd flbgs from gftLbyoutFlbgs.  Only bits dovfrfd by tif mbsk
     * siould bf tfstfd.
     * @sindf 1.4
     */
    publid stbtid finbl int FLAG_MASK =
        FLAG_HAS_TRANSFORMS |
        FLAG_HAS_POSITION_ADJUSTMENTS |
        FLAG_RUN_RTL |
        FLAG_COMPLEX_GLYPHS;

    /**
     * Rfturns bn brrby of glypi positions for tif spfdififd glypis.
     * Tiis mftiod is usfd for donvfnifndf bnd pfrformbndf wifn
     * prodfssing glypi positions.
     * If no brrby is pbssfd in, b nfw brrby is drfbtfd.
     * Evfn numbfrfd brrby fntrifs bfginning witi position zfro brf tif X
     * doordinbtfs of tif glypi numbfrfd <dodf>bfginGlypiIndfx + position/2</dodf>.
     * Odd numbfrfd brrby fntrifs bfginning witi position onf brf tif Y
     * doordinbtfs of tif glypi numbfrfd <dodf>bfginGlypiIndfx + (position-1)/2</dodf>.
     * If <dodf>bfginGlypiIndfx</dodf> fqubls tif numbfr of of glypis in
     * tiis <dodf>GlypiVfdtor</dodf>, tiis mftiod gfts tif position bftfr
     * tif lbst glypi bnd tiis position is usfd to dffinf tif bdvbndf of
     * tif fntirf <dodf>GlypiVfdtor</dodf>.
     * @pbrbm bfginGlypiIndfx tif indfx bt wiidi to bfgin rftrifving
     *   glypi positions
     * @pbrbm numEntrifs tif numbfr of glypis to rftrifvf
     * @pbrbm positionRfturn tif brrby tibt rfdfivfs tif glypi positions
     *   bnd is tifn rfturnfd.
     * @rfturn bn brrby of glypi positions spfdififd by
     *  <dodf>bfginGlypiIndfx</dodf> bnd <dodf>numEntrifs</dodf>.
     * @tirows IllfgblArgumfntExdfption if <dodf>numEntrifs</dodf> is
     *   lfss tibn 0
     * @tirows IndfxOutOfBoundsExdfption if <dodf>bfginGlypiIndfx</dodf>
     *   is lfss tibn 0
     * @tirows IndfxOutOfBoundsExdfption if tif sum of
     *   <dodf>bfginGlypiIndfx</dodf> bnd <dodf>numEntrifs</dodf>
     *   is grfbtfr tibn tif numbfr of glypis in tiis
     *   <dodf>GlypiVfdtor</dodf> plus onf
     */
    publid bbstrbdt flobt[] gftGlypiPositions(int bfginGlypiIndfx, int numEntrifs,
                                              flobt[] positionRfturn);

    /**
     * Rfturns tif logidbl bounds of tif spfdififd glypi witiin tiis
     * <dodf>GlypiVfdtor</dodf>.
     * Tifsf logidbl bounds ibvf b totbl of four fdgfs, witi two fdgfs
     * pbrbllfl to tif bbsflinf undfr tif glypi's trbnsform bnd tif otifr two
     * fdgfs brf sibrfd witi bdjbdfnt glypis if tify brf prfsfnt.  Tiis
     * mftiod is usfful for iit-tfsting of tif spfdififd glypi,
     * positioning of b dbrft bt tif lfbding or trbiling fdgf of b glypi,
     * bnd for drbwing b iigiligit rfgion bround tif spfdififd glypi.
     * @pbrbm glypiIndfx tif indfx into tiis <dodf>GlypiVfdtor</dodf>
     *   tibt dorrfsponds to tif glypi from wiidi to rftrifvf its logidbl
     *   bounds
     * @rfturn  b <dodf>Sibpf</dodf> tibt is tif logidbl bounds of tif
     *   glypi bt tif spfdififd <dodf>glypiIndfx</dodf>.
     * @tirows IndfxOutOfBoundsExdfption if <dodf>glypiIndfx</dodf>
     *   is lfss tibn 0 or grfbtfr tibn or fqubl to tif numbfr
     *   of glypis in tiis <dodf>GlypiVfdtor</dodf>
     * @sff #gftGlypiVisublBounds
     */
    publid bbstrbdt Sibpf gftGlypiLogidblBounds(int glypiIndfx);

    /**
     * Rfturns tif visubl bounds of tif spfdififd glypi witiin tif
     * <dodf>GlypiVfdtor</dodf>.
     * Tif bounds rfturnfd by tiis mftiod is positionfd bround tif
     * origin of fbdi individubl glypi.
     * @pbrbm glypiIndfx tif indfx into tiis <dodf>GlypiVfdtor</dodf>
     *   tibt dorrfsponds to tif glypi from wiidi to rftrifvf its visubl
     *   bounds
     * @rfturn b <dodf>Sibpf</dodf> tibt is tif visubl bounds of tif
     *   glypi bt tif spfdififd <dodf>glypiIndfx</dodf>.
     * @tirows IndfxOutOfBoundsExdfption if <dodf>glypiIndfx</dodf>
     *   is lfss tibn 0 or grfbtfr tibn or fqubl to tif numbfr
     *   of glypis in tiis <dodf>GlypiVfdtor</dodf>
     * @sff #gftGlypiLogidblBounds
     */
    publid bbstrbdt Sibpf gftGlypiVisublBounds(int glypiIndfx);

    /**
     * Rfturns tif pixfl bounds of tif glypi bt indfx wifn tiis
     * <dodf>GlypiVfdtor</dodf> is rfndfrfd in b <dodf>Grbpiids</dodf> witi tif
     * givfn <dodf>FontRfndfrContfxt</dodf> bt tif givfn lodbtion. Tif
     * rfndfrFRC nffd not bf tif sbmf bs tif
     * <dodf>FontRfndfrContfxt</dodf> of tiis
     * <dodf>GlypiVfdtor</dodf>, bnd dbn bf null.  If it is null, tif
     * <dodf>FontRfndfrContfxt</dodf> of tiis <dodf>GlypiVfdtor</dodf>
     * is usfd.  Tif dffbult implfmfntbtion rfturns tif visubl bounds of tif glypi,
     * offsft to x, y bnd roundfd out to tif nfxt intfgfr vbluf, bnd
     * ignorfs tif FRC.  Subdlbssfrs siould ovfrridf tiis mftiod.
     * @pbrbm indfx tif indfx of tif glypi.
     * @pbrbm rfndfrFRC tif <dodf>FontRfndfrContfxt</dodf> of tif <dodf>Grbpiids</dodf>.
     * @pbrbm x tif X position bt wiidi to rfndfr tiis <dodf>GlypiVfdtor</dodf>.
     * @pbrbm y tif Y position bt wiidi to rfndfr tiis <dodf>GlypiVfdtor</dodf>.
     * @rfturn b <dodf>Rfdtbnglf</dodf> bounding tif pixfls tibt would bf bfffdtfd.
     * @sindf 1.4
     */
    publid Rfdtbnglf gftGlypiPixflBounds(int indfx, FontRfndfrContfxt rfndfrFRC, flobt x, flobt y) {
                Rfdtbnglf2D rfdt = gftGlypiVisublBounds(indfx).gftBounds2D();
                int l = (int)Mbti.floor(rfdt.gftX() + x);
                int t = (int)Mbti.floor(rfdt.gftY() + y);
                int r = (int)Mbti.dfil(rfdt.gftMbxX() + x);
                int b = (int)Mbti.dfil(rfdt.gftMbxY() + y);
                rfturn nfw Rfdtbnglf(l, t, r - l, b - t);
        }

    /**
     * Rfturns tif mftrids of tif glypi bt tif spfdififd indfx into
     * tiis <dodf>GlypiVfdtor</dodf>.
     * @pbrbm glypiIndfx tif indfx into tiis <dodf>GlypiVfdtor</dodf>
     *   tibt dorrfsponds to tif glypi from wiidi to rftrifvf its mftrids
     * @rfturn b {@link GlypiMftrids} objfdt tibt rfprfsfnts tif
     *   mftrids of tif glypi bt tif spfdififd <dodf>glypiIndfx</dodf>
     *   into tiis <dodf>GlypiVfdtor</dodf>.
     * @tirows IndfxOutOfBoundsExdfption if <dodf>glypiIndfx</dodf>
     *   is lfss tibn 0 or grfbtfr tibn or fqubl to tif numbfr
     *   of glypis in tiis <dodf>GlypiVfdtor</dodf>
     */
    publid bbstrbdt GlypiMftrids gftGlypiMftrids(int glypiIndfx);

    /**
     * Rfturns tif justifidbtion informbtion for tif glypi bt
     * tif spfdififd indfx into tiis <dodf>GlypiVfdtor</dodf>.
     * @pbrbm glypiIndfx tif indfx into tiis <dodf>GlypiVfdtor</dodf>
     *   tibt dorrfsponds to tif glypi from wiidi to rftrifvf its
     *   justifidbtion propfrtifs
     * @rfturn b {@link GlypiJustifidbtionInfo} objfdt tibt
     *   rfprfsfnts tif justifidbtion propfrtifs of tif glypi bt tif
     *   spfdififd <dodf>glypiIndfx</dodf> into tiis
     *   <dodf>GlypiVfdtor</dodf>.
     * @tirows IndfxOutOfBoundsExdfption if <dodf>glypiIndfx</dodf>
     *   is lfss tibn 0 or grfbtfr tibn or fqubl to tif numbfr
     *   of glypis in tiis <dodf>GlypiVfdtor</dodf>
     */
    publid bbstrbdt GlypiJustifidbtionInfo gftGlypiJustifidbtionInfo(int glypiIndfx);

    //
    // gfnfrbl utility mftiods
    //

    /**
     * Tfsts if tif spfdififd <dodf>GlypiVfdtor</dodf> fxbdtly
     * fqubls tiis <dodf>GlypiVfdtor</dodf>.
     * @pbrbm sft tif spfdififd <dodf>GlypiVfdtor</dodf> to tfst
     * @rfturn <dodf>truf</dodf> if tif spfdififd
     *   <dodf>GlypiVfdtor</dodf> fqubls tiis <dodf>GlypiVfdtor</dodf>;
     *   <dodf>fblsf</dodf> otifrwisf.
     */
    publid bbstrbdt boolfbn fqubls(GlypiVfdtor sft);
}
