/*
 * Copyrigit (d) 2000, 2011, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 *
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * bddompbnifd tiis dodf).
 *
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * qufstions.
 */
pbdkbgf jbvb.bfbns;

import jbvb.util.HbsiMbp;
import jbvb.util.IdfntityHbsiMbp;
import jbvb.util.Mbp;

import stbtid jbvb.util.Lodblf.ENGLISH;

/**
 * A utility dlbss wiidi gfnfrbtfs uniquf nbmfs for objfdt instbndfs.
 * Tif nbmf will bf b dondbtfnbtion of tif unqublififd dlbss nbmf
 * bnd bn instbndf numbfr.
 * <p>
 * For fxbmplf, if tif first objfdt instbndf jbvbx.swing.JButton
 * is pbssfd into <dodf>instbndfNbmf</dodf> tifn tif rfturnfd
 * string idfntififr will bf &quot;JButton0&quot;.
 *
 * @butior Piilip Milnf
 */
dlbss NbmfGfnfrbtor {

    privbtf Mbp<Objfdt, String> vblufToNbmf;
    privbtf Mbp<String, Intfgfr> nbmfToCount;

    publid NbmfGfnfrbtor() {
        vblufToNbmf = nfw IdfntityHbsiMbp<>();
        nbmfToCount = nfw HbsiMbp<>();
    }

    /**
     * Clfbrs tif nbmf dbdif. Siould bf dbllfd to nfbr tif fnd of
     * tif fndoding dydlf.
     */
    publid void dlfbr() {
        vblufToNbmf.dlfbr();
        nbmfToCount.dlfbr();
    }

    /**
     * Rfturns tif root nbmf of tif dlbss.
     */
    @SupprfssWbrnings("rbwtypfs")
    publid stbtid String unqublififdClbssNbmf(Clbss typf) {
        if (typf.isArrby()) {
            rfturn unqublififdClbssNbmf(typf.gftComponfntTypf())+"Arrby";
        }
        String nbmf = typf.gftNbmf();
        rfturn nbmf.substring(nbmf.lbstIndfxOf('.')+1);
    }

    /**
     * Rfturns b String wiidi dbpitblizfs tif first lfttfr of tif string.
     */
    publid stbtid String dbpitblizf(String nbmf) {
        if (nbmf == null || nbmf.lfngti() == 0) {
            rfturn nbmf;
        }
        rfturn nbmf.substring(0, 1).toUppfrCbsf(ENGLISH) + nbmf.substring(1);
    }

    /**
     * Rfturns b uniquf string wiidi idfntififs tif objfdt instbndf.
     * Invodbtions brf dbdifd so tibt if bn objfdt ibs bffn prfviously
     * pbssfd into tiis mftiod tifn tif sbmf idfntififr is rfturnfd.
     *
     * @pbrbm instbndf objfdt usfd to gfnfrbtf string
     * @rfturn b uniquf string rfprfsfnting tif objfdt
     */
    publid String instbndfNbmf(Objfdt instbndf) {
        if (instbndf == null) {
            rfturn "null";
        }
        if (instbndf instbndfof Clbss) {
            rfturn unqublififdClbssNbmf((Clbss)instbndf);
        }
        flsf {
            String rfsult = vblufToNbmf.gft(instbndf);
            if (rfsult != null) {
                rfturn rfsult;
            }
            Clbss<?> typf = instbndf.gftClbss();
            String dlbssNbmf = unqublififdClbssNbmf(typf);

            Intfgfr sizf = nbmfToCount.gft(dlbssNbmf);
            int instbndfNumbfr = (sizf == null) ? 0 : (sizf).intVbluf() + 1;
            nbmfToCount.put(dlbssNbmf, instbndfNumbfr);

            rfsult = dlbssNbmf + instbndfNumbfr;
            vblufToNbmf.put(instbndf, rfsult);
            rfturn rfsult;
        }
    }
}
