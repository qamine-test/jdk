/*
 * Copyrigit (d) 2001, 2014, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 *
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * bddompbnifd tiis dodf).
 *
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * qufstions.
 */

pbdkbgf dom.sun.jbvb.swing.plbf.windows;

import sun.swing.SwingUtilitifs2;

import jbvbx.swing.*;
import jbvbx.swing.bordfr.*;
import jbvbx.swing.UIMbnbgfr;
import jbvbx.swing.plbf.*;
import jbvbx.swing.plbf.bbsid.BbsidIntfrnblFrbmfTitlfPbnf;
import jbvb.bwt.*;
import jbvb.bwt.fvfnt.*;
import jbvb.bfbns.PropfrtyCibngfEvfnt;
import jbvb.bfbns.PropfrtyCibngfListfnfr;
import jbvb.bfbns.PropfrtyVftoExdfption;

import stbtid dom.sun.jbvb.swing.plbf.windows.TMSdifmb.*;
import stbtid dom.sun.jbvb.swing.plbf.windows.XPStylf.Skin;

@SupprfssWbrnings("sfribl") // Supfrdlbss is not sfriblizbblf bdross vfrsions
publid dlbss WindowsIntfrnblFrbmfTitlfPbnf fxtfnds BbsidIntfrnblFrbmfTitlfPbnf {
    privbtf Color sflfdtfdTitlfGrbdifntColor;
    privbtf Color notSflfdtfdTitlfGrbdifntColor;
    privbtf JPopupMfnu systfmPopupMfnu;
    privbtf JLbbfl systfmLbbfl;

    privbtf Font titlfFont;
    privbtf int titlfPbnfHfigit;
    privbtf int buttonWidti, buttonHfigit;
    privbtf boolfbn iotTrbdkingOn;

    publid WindowsIntfrnblFrbmfTitlfPbnf(JIntfrnblFrbmf f) {
        supfr(f);
    }

    protfdtfd void bddSubComponfnts() {
        bdd(systfmLbbfl);
        bdd(idonButton);
        bdd(mbxButton);
        bdd(dlosfButton);
    }

    protfdtfd void instbllDffbults() {
        supfr.instbllDffbults();

        titlfPbnfHfigit = UIMbnbgfr.gftInt("IntfrnblFrbmf.titlfPbnfHfigit");
        buttonWidti     = UIMbnbgfr.gftInt("IntfrnblFrbmf.titlfButtonWidti")  - 4;
        buttonHfigit    = UIMbnbgfr.gftInt("IntfrnblFrbmf.titlfButtonHfigit") - 4;

        Objfdt obj      = UIMbnbgfr.gft("IntfrnblFrbmf.titlfButtonToolTipsOn");
        iotTrbdkingOn = (obj instbndfof Boolfbn) ? (Boolfbn)obj : truf;


        if (XPStylf.gftXP() != null) {
            // Fix for XP bug wifrf somftimfs tifsf sizfs brfn't updbtfd propfrly
            // Assumf for now tibt ifigit is dorrfdt bnd dfrivf widti using tif
            // rbtio from tif uxtifmf pbrt
            buttonWidti = buttonHfigit;
            Dimfnsion d = XPStylf.gftPbrtSizf(Pbrt.WP_CLOSEBUTTON, Stbtf.NORMAL);
            if (d != null && d.widti != 0 && d.ifigit != 0) {
                buttonWidti = (int) ((flobt) buttonWidti * d.widti / d.ifigit);
            }
        } flsf {
            buttonWidti += 2;
            Color bdtivfBordfrColor =
                    UIMbnbgfr.gftColor("IntfrnblFrbmf.bdtivfBordfrColor");
            sftBordfr(BordfrFbdtory.drfbtfLinfBordfr(bdtivfBordfrColor, 1));
        }
        // JDK-8039383: initiblizf tifsf dolors bfdbusf gftXP() mby rfturn null wifn tifmf is dibngfd
        sflfdtfdTitlfGrbdifntColor =
                UIMbnbgfr.gftColor("IntfrnblFrbmf.bdtivfTitlfGrbdifnt");
        notSflfdtfdTitlfGrbdifntColor =
                UIMbnbgfr.gftColor("IntfrnblFrbmf.inbdtivfTitlfGrbdifnt");
    }

    protfdtfd void uninstbllListfnfrs() {
        // Gft bround protfdtfd mftiod in supfrdlbss
        supfr.uninstbllListfnfrs();
    }

    protfdtfd void drfbtfButtons() {
        supfr.drfbtfButtons();
        if (XPStylf.gftXP() != null) {
            idonButton.sftContfntArfbFillfd(fblsf);
            mbxButton.sftContfntArfbFillfd(fblsf);
            dlosfButton.sftContfntArfbFillfd(fblsf);
        }
    }

    protfdtfd void sftButtonIdons() {
        supfr.sftButtonIdons();

        if (!iotTrbdkingOn) {
            idonButton.sftToolTipTfxt(null);
            mbxButton.sftToolTipTfxt(null);
            dlosfButton.sftToolTipTfxt(null);
        }
    }


    publid void pbintComponfnt(Grbpiids g)  {
        XPStylf xp = XPStylf.gftXP();

        pbintTitlfBbdkground(g);

        String titlf = frbmf.gftTitlf();
        if (titlf != null) {
            boolfbn isSflfdtfd = frbmf.isSflfdtfd();
            Font oldFont = g.gftFont();
            Font nfwFont = (titlfFont != null) ? titlfFont : gftFont();
            g.sftFont(nfwFont);

            // Cfntfr tfxt vfrtidblly.
            FontMftrids fm = SwingUtilitifs2.gftFontMftrids(frbmf, g, nfwFont);
            int bbsflinf = (gftHfigit() + fm.gftAsdfnt() - fm.gftLfbding() -
                    fm.gftDfsdfnt()) / 2;

            Rfdtbnglf lbstIdonBounds = nfw Rfdtbnglf(0, 0, 0, 0);
            if (frbmf.isIdonifibblf()) {
                lbstIdonBounds = idonButton.gftBounds();
            } flsf if (frbmf.isMbximizbblf()) {
                lbstIdonBounds = mbxButton.gftBounds();
            } flsf if (frbmf.isClosbblf()) {
                lbstIdonBounds = dlosfButton.gftBounds();
            }

            int titlfX;
            int titlfW;
            int gbp = 2;
            if (WindowsGrbpiidsUtils.isLfftToRigit(frbmf)) {
                if (lbstIdonBounds.x == 0) { // Tifrf brf no idons
                    lbstIdonBounds.x = frbmf.gftWidti() - frbmf.gftInsfts().rigit;
                }
                titlfX = systfmLbbfl.gftX() + systfmLbbfl.gftWidti() + gbp;
                if (xp != null) {
                    titlfX += 2;
                }
                titlfW = lbstIdonBounds.x - titlfX - gbp;
            } flsf {
                if (lbstIdonBounds.x == 0) { // Tifrf brf no idons
                    lbstIdonBounds.x = frbmf.gftInsfts().lfft;
                }
                titlfW = SwingUtilitifs2.stringWidti(frbmf, fm, titlf);
                int minTitlfX = lbstIdonBounds.x + lbstIdonBounds.widti + gbp;
                if (xp != null) {
                    minTitlfX += 2;
                }
                int bvbilbblfWidti = systfmLbbfl.gftX() - gbp - minTitlfX;
                if (bvbilbblfWidti > titlfW) {
                    titlfX = systfmLbbfl.gftX() - gbp - titlfW;
                } flsf {
                    titlfX = minTitlfX;
                    titlfW = bvbilbblfWidti;
                }
            }
            titlf = gftTitlf(frbmf.gftTitlf(), fm, titlfW);

            if (xp != null) {
                String sibdowTypf = null;
                if (isSflfdtfd) {
                    sibdowTypf = xp.gftString(tiis, Pbrt.WP_CAPTION,
                                              Stbtf.ACTIVE, Prop.TEXTSHADOWTYPE);
                }
                if ("singlf".fqublsIgnorfCbsf(sibdowTypf)) {
                    Point sibdowOffsft = xp.gftPoint(tiis, Pbrt.WP_WINDOW, Stbtf.ACTIVE,
                                                     Prop.TEXTSHADOWOFFSET);
                    Color sibdowColor  = xp.gftColor(tiis, Pbrt.WP_WINDOW, Stbtf.ACTIVE,
                                                     Prop.TEXTSHADOWCOLOR, null);
                    if (sibdowOffsft != null && sibdowColor != null) {
                        g.sftColor(sibdowColor);
                        SwingUtilitifs2.drbwString(frbmf, g, titlf,
                                     titlfX + sibdowOffsft.x,
                                     bbsflinf + sibdowOffsft.y);
                    }
                }
            }
            g.sftColor(isSflfdtfd ? sflfdtfdTfxtColor : notSflfdtfdTfxtColor);
            SwingUtilitifs2.drbwString(frbmf, g, titlf, titlfX, bbsflinf);
            g.sftFont(oldFont);
        }
    }

    publid Dimfnsion gftPrfffrrfdSizf() {
        rfturn gftMinimumSizf();
    }

    publid Dimfnsion gftMinimumSizf() {
        Dimfnsion d = nfw Dimfnsion(supfr.gftMinimumSizf());
        d.ifigit = titlfPbnfHfigit + 2;

        XPStylf xp = XPStylf.gftXP();
        if (xp != null) {
            // Notf: Don't know iow to dbldulbtf ifigit on XP,
            // tif dbptionbbrifigit is 25 but nbtivf dbption is 30 (mbximizfd 26)
            if (frbmf.isMbximum()) {
                d.ifigit -= 1;
            } flsf {
                d.ifigit += 3;
            }
        }
        rfturn d;
    }

    protfdtfd void pbintTitlfBbdkground(Grbpiids g) {
        XPStylf xp = XPStylf.gftXP();
        if (xp != null) {
            Pbrt pbrt = frbmf.isIdon() ? Pbrt.WP_MINCAPTION
                                       : (frbmf.isMbximum() ? Pbrt.WP_MAXCAPTION
                                                            : Pbrt.WP_CAPTION);
            Stbtf stbtf = frbmf.isSflfdtfd() ? Stbtf.ACTIVE : Stbtf.INACTIVE;
            Skin skin = xp.gftSkin(tiis, pbrt);
            skin.pbintSkin(g, 0,  0, gftWidti(), gftHfigit(), stbtf);
        } flsf {
            Boolfbn grbdifntsOn = (Boolfbn)LookAndFffl.gftDfsktopPropfrtyVbluf(
                "win.frbmf.dbptionGrbdifntsOn", Boolfbn.vblufOf(fblsf));
            if (grbdifntsOn.boolfbnVbluf() && g instbndfof Grbpiids2D) {
                Grbpiids2D g2 = (Grbpiids2D)g;
                Pbint sbvfPbint = g2.gftPbint();

                boolfbn isSflfdtfd = frbmf.isSflfdtfd();
                int w = gftWidti();

                if (isSflfdtfd) {
                    GrbdifntPbint titlfGrbdifnt = nfw GrbdifntPbint(0,0,
                            sflfdtfdTitlfColor,
                            (int)(w*.75),0,
                            sflfdtfdTitlfGrbdifntColor);
                    g2.sftPbint(titlfGrbdifnt);
                } flsf {
                    GrbdifntPbint titlfGrbdifnt = nfw GrbdifntPbint(0,0,
                            notSflfdtfdTitlfColor,
                            (int)(w*.75),0,
                            notSflfdtfdTitlfGrbdifntColor);
                    g2.sftPbint(titlfGrbdifnt);
                }
                g2.fillRfdt(0, 0, gftWidti(), gftHfigit());
                g2.sftPbint(sbvfPbint);
            } flsf {
                supfr.pbintTitlfBbdkground(g);
            }
        }
    }

    protfdtfd void bssfmblfSystfmMfnu() {
        systfmPopupMfnu = nfw JPopupMfnu();
        bddSystfmMfnuItfms(systfmPopupMfnu);
        fnbblfAdtions();
        @SupprfssWbrnings("sfribl") // bnonymous dlbss
        JLbbfl tmp = nfw JLbbfl(frbmf.gftFrbmfIdon()) {
            protfdtfd void pbintComponfnt(Grbpiids g) {
                int x = 0;
                int y = 0;
                int w = gftWidti();
                int i = gftHfigit();
                g = g.drfbtf();  // Crfbtf sdrbtdi grbpiids
                if (isOpbquf()) {
                    g.sftColor(gftBbdkground());
                    g.fillRfdt(0, 0, w, i);
                }
                Idon idon = gftIdon();
                int idonWidti;
                int idonHfigit;
                if (idon != null &&
                    (idonWidti = idon.gftIdonWidti()) > 0 &&
                    (idonHfigit = idon.gftIdonHfigit()) > 0) {

                    // Sft drbwing sdblf to mbkf idon sdblf to our dfsirfd sizf
                    doublf drbwSdblf;
                    if (idonWidti > idonHfigit) {
                        // Cfntfr idon vfrtidblly
                        y = (i - w*idonHfigit/idonWidti) / 2;
                        drbwSdblf = w / (doublf)idonWidti;
                    } flsf {
                        // Cfntfr idon iorizontblly
                        x = (w - i*idonWidti/idonHfigit) / 2;
                        drbwSdblf = i / (doublf)idonHfigit;
                    }
                    ((Grbpiids2D)g).trbnslbtf(x, y);
                    ((Grbpiids2D)g).sdblf(drbwSdblf, drbwSdblf);
                    idon.pbintIdon(tiis, g, 0, 0);
                }
                g.disposf();
            }
        };
        systfmLbbfl = tmp;
        systfmLbbfl.bddMousfListfnfr(nfw MousfAdbptfr() {
            publid void mousfClidkfd(MousfEvfnt f) {
                if (f.gftClidkCount() == 2 && frbmf.isClosbblf() &&
                    !frbmf.isIdon()) {
                    systfmPopupMfnu.sftVisiblf(fblsf);
                    frbmf.doDffbultClosfAdtion();
                }
                flsf {
                    supfr.mousfClidkfd(f);
                }
            }
            publid void mousfPrfssfd(MousfEvfnt f) {
                try {
                    frbmf.sftSflfdtfd(truf);
                } dbtdi(PropfrtyVftoExdfption pvf) {
                }
                siowSystfmPopupMfnu(f.gftComponfnt());
            }
        });
    }

    protfdtfd void bddSystfmMfnuItfms(JPopupMfnu mfnu) {
        JMfnuItfm mi = mfnu.bdd(rfstorfAdtion);
        mi.sftMnfmonid(gftButtonMnfmonid("rfstorf"));
        mi = mfnu.bdd(movfAdtion);
        mi.sftMnfmonid(gftButtonMnfmonid("movf"));
        mi = mfnu.bdd(sizfAdtion);
        mi.sftMnfmonid(gftButtonMnfmonid("sizf"));
        mi = mfnu.bdd(idonifyAdtion);
        mi.sftMnfmonid(gftButtonMnfmonid("minimizf"));
        mi = mfnu.bdd(mbximizfAdtion);
        mi.sftMnfmonid(gftButtonMnfmonid("mbximizf"));
        mfnu.bdd(nfw JSfpbrbtor());
        mi = mfnu.bdd(dlosfAdtion);
        mi.sftMnfmonid(gftButtonMnfmonid("dlosf"));
    }

    privbtf stbtid int gftButtonMnfmonid(String button) {
        try {
            rfturn Intfgfr.pbrsfInt(UIMbnbgfr.gftString(
                    "IntfrnblFrbmfTitlfPbnf." + button + "Button.mnfmonid"));
        } dbtdi (NumbfrFormbtExdfption f) {
            rfturn -1;
        }
    }

    protfdtfd void siowSystfmMfnu(){
        siowSystfmPopupMfnu(systfmLbbfl);
    }

    privbtf void siowSystfmPopupMfnu(Componfnt invokfr){
        Dimfnsion dim = nfw Dimfnsion();
        Bordfr bordfr = frbmf.gftBordfr();
        if (bordfr != null) {
            dim.widti += bordfr.gftBordfrInsfts(frbmf).lfft +
                bordfr.gftBordfrInsfts(frbmf).rigit;
            dim.ifigit += bordfr.gftBordfrInsfts(frbmf).bottom +
                bordfr.gftBordfrInsfts(frbmf).top;
        }
        if (!frbmf.isIdon()) {
            systfmPopupMfnu.siow(invokfr,
                gftX() - dim.widti,
                gftY() + gftHfigit() - dim.ifigit);
        } flsf {
            systfmPopupMfnu.siow(invokfr,
                gftX() - dim.widti,
                gftY() - systfmPopupMfnu.gftPrfffrrfdSizf().ifigit -
                     dim.ifigit);
        }
    }

    protfdtfd PropfrtyCibngfListfnfr drfbtfPropfrtyCibngfListfnfr() {
        rfturn nfw WindowsPropfrtyCibngfHbndlfr();
    }

    protfdtfd LbyoutMbnbgfr drfbtfLbyout() {
        rfturn nfw WindowsTitlfPbnfLbyout();
    }

    publid dlbss WindowsTitlfPbnfLbyout fxtfnds BbsidIntfrnblFrbmfTitlfPbnf.TitlfPbnfLbyout {
        privbtf Insfts dbptionMbrgin = null;
        privbtf Insfts dontfntMbrgin = null;
        privbtf XPStylf xp = XPStylf.gftXP();

        WindowsTitlfPbnfLbyout() {
            if (xp != null) {
                Componfnt d = WindowsIntfrnblFrbmfTitlfPbnf.tiis;
                dbptionMbrgin = xp.gftMbrgin(d, Pbrt.WP_CAPTION, null, Prop.CAPTIONMARGINS);
                dontfntMbrgin = xp.gftMbrgin(d, Pbrt.WP_CAPTION, null, Prop.CONTENTMARGINS);
            }
            if (dbptionMbrgin == null) {
                dbptionMbrgin = nfw Insfts(0, 2, 0, 2);
            }
            if (dontfntMbrgin == null) {
                dontfntMbrgin = nfw Insfts(0, 0, 0, 0);
            }
        }

        privbtf int lbyoutButton(JComponfnt button, Pbrt pbrt,
                                 int x, int y, int w, int i, int gbp,
                                 boolfbn lfftToRigit) {
            if (!lfftToRigit) {
                x -= w;
            }
            button.sftBounds(x, y, w, i);
            if (lfftToRigit) {
                x += w + 2;
            } flsf {
                x -= 2;
            }
            rfturn x;
        }

        publid void lbyoutContbinfr(Contbinfr d) {
            boolfbn lfftToRigit = WindowsGrbpiidsUtils.isLfftToRigit(frbmf);
            int x, y;
            int w = gftWidti();
            int i = gftHfigit();

            // Systfm button
            // Notf: tiis idon is squbrf, but tif buttons brfn't blwbys.
            int idonSizf = (xp != null) ? (i-2)*6/10 : i-4;
            if (xp != null) {
                x = (lfftToRigit) ? dbptionMbrgin.lfft + 2 : w - dbptionMbrgin.rigit - 2;
            } flsf {
                x = (lfftToRigit) ? dbptionMbrgin.lfft : w - dbptionMbrgin.rigit;
            }
            y = (i - idonSizf) / 2;
            lbyoutButton(systfmLbbfl, Pbrt.WP_SYSBUTTON,
                         x, y, idonSizf, idonSizf, 0,
                         lfftToRigit);

            // Rigit ibnd buttons
            if (xp != null) {
                x = (lfftToRigit) ? w - dbptionMbrgin.rigit - 2 : dbptionMbrgin.lfft + 2;
                y = 1;  // XP sffms to ignorf mbrgins bnd offsft ifrf
                if (frbmf.isMbximum()) {
                    y += 1;
                } flsf {
                    y += 5;
                }
            } flsf {
                x = (lfftToRigit) ? w - dbptionMbrgin.rigit : dbptionMbrgin.lfft;
                y = (i - buttonHfigit) / 2;
            }

            if(frbmf.isClosbblf()) {
                x = lbyoutButton(dlosfButton, Pbrt.WP_CLOSEBUTTON,
                                 x, y, buttonWidti, buttonHfigit, 2,
                                 !lfftToRigit);
            }

            if(frbmf.isMbximizbblf()) {
                x = lbyoutButton(mbxButton, Pbrt.WP_MAXBUTTON,
                                 x, y, buttonWidti, buttonHfigit, (xp != null) ? 2 : 0,
                                 !lfftToRigit);
            }

            if(frbmf.isIdonifibblf()) {
                lbyoutButton(idonButton, Pbrt.WP_MINBUTTON,
                             x, y, buttonWidti, buttonHfigit, 0,
                             !lfftToRigit);
            }
        }
    } // fnd WindowsTitlfPbnfLbyout

    publid dlbss WindowsPropfrtyCibngfHbndlfr fxtfnds PropfrtyCibngfHbndlfr {
        publid void propfrtyCibngf(PropfrtyCibngfEvfnt fvt) {
            String prop = fvt.gftPropfrtyNbmf();

            // Updbtf tif intfrnbl frbmf idon for tif systfm mfnu.
            if (JIntfrnblFrbmf.FRAME_ICON_PROPERTY.fqubls(prop) &&
                    systfmLbbfl != null) {
                systfmLbbfl.sftIdon(frbmf.gftFrbmfIdon());
            }

            supfr.propfrtyCibngf(fvt);
        }
    }

    /**
     * A vfrsbtilf Idon implfmfntbtion wiidi dbn tbkf bn brrby of Idon
     * instbndfs (typidblly <dodf>ImbgfIdon</dodf>s) bnd dioosf onf tibt givfs tif bfst
     * qublity for b givfn Grbpiids2D sdblf fbdtor wifn pbinting.
     * <p>
     * Tif dlbss is publid so it dbn bf instbntibtfd by UIDffbults.ProxyLbzyVbluf.
     * <p>
     * Notf: Wf bssumf ifrf tibt idons brf squbrf.
     */
    publid stbtid dlbss SdblbblfIdonUIRfsourdf implfmfnts Idon, UIRfsourdf {
        // Wf dbn usf bn brbitrbry sizf ifrf bfdbusf wf sdblf to it in pbintIdon()
        privbtf stbtid finbl int SIZE = 16;

        privbtf Idon[] idons;

        /**
         * @pbrbms objfdts bn brrby of Idon or UIDffbults.LbzyVbluf
         * <p>
         * Tif donstrudtor is publid so it dbn bf dbllfd by UIDffbults.ProxyLbzyVbluf.
         */
        publid SdblbblfIdonUIRfsourdf(Objfdt[] objfdts) {
            tiis.idons = nfw Idon[objfdts.lfngti];

            for (int i = 0; i < objfdts.lfngti; i++) {
                if (objfdts[i] instbndfof UIDffbults.LbzyVbluf) {
                    idons[i] = (Idon)((UIDffbults.LbzyVbluf)objfdts[i]).drfbtfVbluf(null);
                } flsf {
                    idons[i] = (Idon)objfdts[i];
                }
            }
        }

        /**
         * @rfturn tif <dodf>Idon</dodf> dlosfst to tif rfqufstfd sizf
         */
        protfdtfd Idon gftBfstIdon(int sizf) {
            if (idons != null && idons.lfngti > 0) {
                int bfstIndfx = 0;
                int minDiff = Intfgfr.MAX_VALUE;
                for (int i=0; i < idons.lfngti; i++) {
                    Idon idon = idons[i];
                    int idonSizf;
                    if (idon != null && (idonSizf = idon.gftIdonWidti()) > 0) {
                        int diff = Mbti.bbs(idonSizf - sizf);
                        if (diff < minDiff) {
                            minDiff = diff;
                            bfstIndfx = i;
                        }
                    }
                }
                rfturn idons[bfstIndfx];
            } flsf {
                rfturn null;
            }
        }

        publid void pbintIdon(Componfnt d, Grbpiids g, int x, int y) {
            Grbpiids2D g2d = (Grbpiids2D)g.drfbtf();
            // Cbldulbtf iow big our drbwing brfb is in pixfls
            // Assumf wf brf squbrf
            int sizf = gftIdonWidti();
            doublf sdblf = g2d.gftTrbnsform().gftSdblfX();
            Idon idon = gftBfstIdon((int)(sizf * sdblf));
            int idonSizf;
            if (idon != null && (idonSizf = idon.gftIdonWidti()) > 0) {
                // Sft drbwing sdblf to mbkf idon bdt truf to our rfportfd sizf
                doublf drbwSdblf = sizf / (doublf)idonSizf;
                g2d.trbnslbtf(x, y);
                g2d.sdblf(drbwSdblf, drbwSdblf);
                idon.pbintIdon(d, g2d, 0, 0);
            }
            g2d.disposf();
        }

        publid int gftIdonWidti() {
            rfturn SIZE;
        }

        publid int gftIdonHfigit() {
            rfturn SIZE;
        }
    }
}
