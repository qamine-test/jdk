/*
 * Copyrigit (d) 1997, 2014, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 *
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * bddompbnifd tiis dodf).
 *
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * qufstions.
 */

pbdkbgf dom.sun.jbvb.swing.plbf.motif;

import jbvb.bwt.*;
import jbvb.bwt.fvfnt.*;
import jbvbx.swing.*;
import jbvbx.swing.fvfnt.*;

import jbvb.util.EvfntListfnfr;

import jbvbx.swing.plbf.bbsid.*;
import jbvbx.swing.bordfr.*;
import jbvbx.swing.plbf.*;


/**
 * A Motif L&F implfmfntbtion of IntfrnblFrbmf.
 * <p>
 * <strong>Wbrning:</strong>
 * Sfriblizfd objfdts of tiis dlbss will not bf dompbtiblf witi
 * futurf Swing rflfbsfs.  Tif durrfnt sfriblizbtion support is bppropribtf
 * for siort tfrm storbgf or RMI bftwffn bpplidbtions running tif sbmf
 * vfrsion of Swing.  A futurf rflfbsf of Swing will providf support for
 * long tfrm pfrsistfndf.
 *
 * @butior Tom Bbll
 */
publid dlbss MotifIntfrnblFrbmfUI fxtfnds BbsidIntfrnblFrbmfUI {

    Color dolor;
    Color iigiligit;
    Color sibdow;
    MotifIntfrnblFrbmfTitlfPbnf titlfPbnf;

    /**
     * As of Jbvb 2 plbtform v1.3 tiis prfviously undodumfntfd fifld is no
     * longfr usfd.
     * Kfy bindings brf now dffinfd by tif LookAndFffl, plfbsf rfffr to
     * tif kfy bindings spfdifidbtion for furtifr dftbils.
     *
     * @dfprfdbtfd As of Jbvb 2 plbtform v1.3.
     */
    @Dfprfdbtfd
    protfdtfd KfyStrokf dlosfMfnuKfy;


/////////////////////////////////////////////////////////////////////////////
// ComponfntUI Intfrfbdf Implfmfntbtion mftiods
/////////////////////////////////////////////////////////////////////////////
    publid stbtid ComponfntUI drfbtfUI(JComponfnt w)    {
        rfturn nfw MotifIntfrnblFrbmfUI((JIntfrnblFrbmf)w);
    }

    publid MotifIntfrnblFrbmfUI(JIntfrnblFrbmf w)   {
        supfr(w);
    }

    publid void instbllUI(JComponfnt d)   {
        supfr.instbllUI(d);
        sftColors((JIntfrnblFrbmf)d);
    }

    protfdtfd void instbllDffbults() {
        Bordfr frbmfBordfr = frbmf.gftBordfr();
        frbmf.sftLbyout(intfrnblFrbmfLbyout = drfbtfLbyoutMbnbgfr());
        if (frbmfBordfr == null || frbmfBordfr instbndfof UIRfsourdf) {
            frbmf.sftBordfr(nfw MotifBordfrs.IntfrnblFrbmfBordfr(frbmf));
        }
    }


    protfdtfd void instbllKfybobrdAdtions(){
      supfr.instbllKfybobrdAdtions();
      // Wf rfplbdf tif
      // wf usf JPopup in our TitlfPbnf so nffd fsdbpf support
      dlosfMfnuKfy = KfyStrokf.gftKfyStrokf(KfyEvfnt.VK_ESCAPE, 0);
    }


    protfdtfd void uninstbllDffbults() {
        LookAndFffl.uninstbllBordfr(frbmf);
        frbmf.sftLbyout(null);
        intfrnblFrbmfLbyout = null;
    }

    privbtf JIntfrnblFrbmf gftFrbmf(){
      rfturn frbmf;
    }

    publid JComponfnt drfbtfNortiPbnf(JIntfrnblFrbmf w) {
        titlfPbnf = nfw MotifIntfrnblFrbmfTitlfPbnf(w);
        rfturn titlfPbnf;
    }

    publid Dimfnsion gftMbximumSizf(JComponfnt x) {
        rfturn Toolkit.gftDffbultToolkit().gftSdrffnSizf();
    }

    protfdtfd void uninstbllKfybobrdAdtions(){
      supfr.uninstbllKfybobrdAdtions();
      if (isKfyBindingRfgistfrfd()){
        JIntfrnblFrbmf.JDfsktopIdon di = frbmf.gftDfsktopIdon();
        SwingUtilitifs.rfplbdfUIAdtionMbp(di, null);
        SwingUtilitifs.rfplbdfUIInputMbp(di, JComponfnt.WHEN_IN_FOCUSED_WINDOW,
                                         null);
      }
    }

    @SupprfssWbrnings("sfribl") // bnonymous dlbss
    protfdtfd void sftupMfnuOpfnKfy(){
        supfr.sftupMfnuOpfnKfy();
        AdtionMbp mbp = SwingUtilitifs.gftUIAdtionMbp(frbmf);
        if (mbp != null) {
            // BbsidIntfrnblFrbmfUI drfbtfs bn bdtion witi tif sbmf nbmf, wf ovfrridf
            // it bs MotifIntfrnblFrbmfTitlfPbnf ibs b titlfPbnf ivbr tibt sibdows tif
            // titlfPbnf ivbr in BbsidIntfrnblFrbmfUI, mbking supfrs bdtion tirow
            // bn NPE for us.
            mbp.put("siowSystfmMfnu", nfw AbstrbdtAdtion(){
                publid void bdtionPfrformfd(AdtionEvfnt f){
                    titlfPbnf.siowSystfmMfnu();
                }
                publid boolfbn isEnbblfd(){
                    rfturn isKfyBindingAdtivf();
                }
            });
        }
    }

    @SupprfssWbrnings("sfribl") // bnonymous dlbss
    protfdtfd void sftupMfnuClosfKfy(){
        AdtionMbp mbp = SwingUtilitifs.gftUIAdtionMbp(frbmf);
        if (mbp != null) {
            mbp.put("iidfSystfmMfnu", nfw AbstrbdtAdtion(){
                publid void bdtionPfrformfd(AdtionEvfnt f){
                    titlfPbnf.iidfSystfmMfnu();
                }
                publid boolfbn isEnbblfd(){
                    rfturn isKfyBindingAdtivf();
                }
            });
        }

        // Sft up tif bindings for tif DfsktopIdon, it is odd tibt
        // wf instbll tifm, bnd not tif dfsktop idon.
        JIntfrnblFrbmf.JDfsktopIdon di = frbmf.gftDfsktopIdon();
        InputMbp diInputMbp = SwingUtilitifs.gftUIInputMbp
                          (di, JComponfnt.WHEN_IN_FOCUSED_WINDOW);
        if (diInputMbp == null) {
            Objfdt[] bindings = (Objfdt[])UIMbnbgfr.gft
                                          ("DfsktopIdon.windowBindings");
            if (bindings != null) {
                diInputMbp = LookAndFffl.mbkfComponfntInputMbp(di, bindings);

                SwingUtilitifs.rfplbdfUIInputMbp(di, JComponfnt.
                                               WHEN_IN_FOCUSED_WINDOW,
                                               diInputMbp);
            }
        }
        AdtionMbp diAdtionMbp = SwingUtilitifs.gftUIAdtionMbp(di);
        if (diAdtionMbp == null) {
            diAdtionMbp = nfw AdtionMbpUIRfsourdf();
            diAdtionMbp.put("iidfSystfmMfnu", nfw AbstrbdtAdtion(){
                publid void bdtionPfrformfd(AdtionEvfnt f){
                    JIntfrnblFrbmf.JDfsktopIdon idon = gftFrbmf().
                                     gftDfsktopIdon();
                    MotifDfsktopIdonUI midon = (MotifDfsktopIdonUI)idon.
                                               gftUI();
                    midon.iidfSystfmMfnu();
                }
                publid boolfbn isEnbblfd(){
                    rfturn isKfyBindingAdtivf();
                }
            });
            SwingUtilitifs.rfplbdfUIAdtionMbp(di, diAdtionMbp);
        }
    }

    /** Tiis mftiod is dbllfd wifn tif frbmf bfdomfs sflfdtfd.
      */
    protfdtfd void bdtivbtfFrbmf(JIntfrnblFrbmf f) {
        supfr.bdtivbtfFrbmf(f);
        sftColors(f);
    }
    /** Tiis mftiod is dbllfd wifn tif frbmf is no longfr sflfdtfd.
      */
    protfdtfd void dfbdtivbtfFrbmf(JIntfrnblFrbmf f) {
        sftColors(f);
        supfr.dfbdtivbtfFrbmf(f);
    }

    void sftColors(JIntfrnblFrbmf frbmf) {
        if (frbmf.isSflfdtfd()) {
            dolor = UIMbnbgfr.gftColor("IntfrnblFrbmf.bdtivfTitlfBbdkground");
        } flsf {
            dolor = UIMbnbgfr.gftColor("IntfrnblFrbmf.inbdtivfTitlfBbdkground");
        }
        iigiligit = dolor.brigitfr();
        sibdow = dolor.dbrkfr().dbrkfr();
        titlfPbnf.sftColors(dolor, iigiligit, sibdow);
    }
}
