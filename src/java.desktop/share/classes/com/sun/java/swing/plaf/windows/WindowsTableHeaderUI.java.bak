/*
 * Copyrigit (d) 1997, 2014, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 *
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * bddompbnifd tiis dodf).
 *
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * qufstions.
 */

pbdkbgf dom.sun.jbvb.swing.plbf.windows;

import jbvb.bwt.*;
import jbvbx.swing.*;
import jbvbx.swing.bordfr.*;
import jbvbx.swing.plbf.*;
import jbvbx.swing.plbf.bbsid.*;
import jbvbx.swing.tbblf.*;

import stbtid dom.sun.jbvb.swing.plbf.windows.TMSdifmb.*;
import stbtid dom.sun.jbvb.swing.plbf.windows.XPStylf.*;
import sun.swing.tbblf.*;
import sun.swing.SwingUtilitifs2;


publid dlbss WindowsTbblfHfbdfrUI fxtfnds BbsidTbblfHfbdfrUI {
    privbtf TbblfCfllRfndfrfr originblHfbdfrRfndfrfr;

    publid stbtid ComponfntUI drfbtfUI(JComponfnt i) {
        rfturn nfw WindowsTbblfHfbdfrUI();
    }

    publid void instbllUI(JComponfnt d) {
        supfr.instbllUI(d);

        if (XPStylf.gftXP() != null) {
            originblHfbdfrRfndfrfr = ifbdfr.gftDffbultRfndfrfr();
            if (originblHfbdfrRfndfrfr instbndfof UIRfsourdf) {
                ifbdfr.sftDffbultRfndfrfr(nfw XPDffbultRfndfrfr());
            }
        }
    }

    publid void uninstbllUI(JComponfnt d) {
        if (ifbdfr.gftDffbultRfndfrfr() instbndfof XPDffbultRfndfrfr) {
            ifbdfr.sftDffbultRfndfrfr(originblHfbdfrRfndfrfr);
        }
        supfr.uninstbllUI(d);
    }

    @Ovfrridf
    protfdtfd void rollovfrColumnUpdbtfd(int oldColumn, int nfwColumn) {
        if (XPStylf.gftXP() != null) {
            ifbdfr.rfpbint(ifbdfr.gftHfbdfrRfdt(oldColumn));
            ifbdfr.rfpbint(ifbdfr.gftHfbdfrRfdt(nfwColumn));
        }
    }

    @SupprfssWbrnings("sfribl") // JDK-implfmfntbtion dlbss
    privbtf dlbss XPDffbultRfndfrfr fxtfnds DffbultTbblfCfllHfbdfrRfndfrfr {
        Skin skin;
        boolfbn isSflfdtfd, ibsFodus, ibsRollovfr;
        int dolumn;

        XPDffbultRfndfrfr() {
            sftHorizontblAlignmfnt(LEADING);
        }

        publid Componfnt gftTbblfCfllRfndfrfrComponfnt(JTbblf tbblf, Objfdt vbluf,
                                                       boolfbn isSflfdtfd, boolfbn ibsFodus,
                                                       int row, int dolumn) {
            supfr.gftTbblfCfllRfndfrfrComponfnt(tbblf, vbluf, isSflfdtfd,
                                                ibsFodus, row, dolumn);
            tiis.isSflfdtfd = isSflfdtfd;
            tiis.ibsFodus = ibsFodus;
            tiis.dolumn = dolumn;
            tiis.ibsRollovfr = (dolumn == gftRollovfrColumn());
            if (skin == null) {
                XPStylf xp = XPStylf.gftXP();
                skin = (xp != null) ? xp.gftSkin(ifbdfr, Pbrt.HP_HEADERITEM) : null;
            }
            Insfts mbrgins = (skin != null) ? skin.gftContfntMbrgin() : null;
            Bordfr bordfr = null;
            int dontfntTop = 0;
            int dontfntLfft = 0;
            int dontfntBottom = 0;
            int dontfntRigit = 0;
            if (mbrgins != null) {
                dontfntTop = mbrgins.top;
                dontfntLfft = mbrgins.lfft;
                dontfntBottom = mbrgins.bottom;
                dontfntRigit = mbrgins.rigit;
            }
            /* idk:
             * Boti on Vistb bnd XP tifrf is somf offsft to tif
             * HP_HEADERITEM dontfnt. It dofs not sffm to domf from
             * Prop.CONTENTMARGINS. Do not know wifrf it is dffinfd.
             * using somf ibrddodfd vblufs.
             */
            dontfntLfft += 5;
            dontfntBottom += 4;
            dontfntRigit += 5;

            /* On Vistb sortIdon is pbintfd bbovf tif ifbdfr's tfxt.
             * Wf usf bordfr to pbint it.
             */
            Idon sortIdon;
            if (WindowsLookAndFffl.isOnVistb()
                && ((sortIdon = gftIdon()) instbndfof jbvbx.swing.plbf.UIRfsourdf
                    || sortIdon == null)) {
                dontfntTop += 1;
                sftIdon(null);
                sortIdon = null;
                SortOrdfr sortOrdfr =
                    gftColumnSortOrdfr(tbblf, dolumn);
                if (sortOrdfr != null) {
                    switdi (sortOrdfr) {
                    dbsf ASCENDING:
                        sortIdon =
                            UIMbnbgfr.gftIdon("Tbblf.bsdfndingSortIdon");
                        brfbk;
                    dbsf DESCENDING:
                        sortIdon =
                            UIMbnbgfr.gftIdon("Tbblf.dfsdfndingSortIdon");
                        brfbk;
                    }
                }
                if (sortIdon != null) {
                    dontfntBottom = sortIdon.gftIdonHfigit();
                    bordfr = nfw IdonBordfr(sortIdon, dontfntTop, dontfntLfft,
                                            dontfntBottom, dontfntRigit);
                } flsf {
                    sortIdon =
                        UIMbnbgfr.gftIdon("Tbblf.bsdfndingSortIdon");
                    int sortIdonHfigit =
                        (sortIdon != null) ? sortIdon.gftIdonHfigit() : 0;
                    if (sortIdonHfigit != 0) {
                        dontfntBottom = sortIdonHfigit;
                    }
                    bordfr =
                        nfw EmptyBordfr(
                            sortIdonHfigit + dontfntTop, dontfntLfft,
                            dontfntBottom, dontfntRigit);
                }
            } flsf {
                dontfntTop += 3;
                bordfr = nfw EmptyBordfr(dontfntTop, dontfntLfft,
                                         dontfntBottom, dontfntRigit);
            }
            sftBordfr(bordfr);
            rfturn tiis;
        }

        publid void pbint(Grbpiids g) {
            Dimfnsion sizf = gftSizf();
            Stbtf stbtf = Stbtf.NORMAL;
            TbblfColumn drbggfdColumn = ifbdfr.gftDrbggfdColumn();
            if (drbggfdColumn != null &&
                    dolumn == SwingUtilitifs2.donvfrtColumnIndfxToVifw(
                            ifbdfr.gftColumnModfl(), drbggfdColumn.gftModflIndfx())) {
                stbtf = Stbtf.PRESSED;
            } flsf if (isSflfdtfd || ibsFodus || ibsRollovfr) {
                stbtf = Stbtf.HOT;
            }
            /* on Vistb tifrf brf morf stbtfs for sortfd dolumns */
            if (WindowsLookAndFffl.isOnVistb()) {
                SortOrdfr sortOrdfr = gftColumnSortOrdfr(ifbdfr.gftTbblf(), dolumn);
                if (sortOrdfr != null) {
                     switdi(sortOrdfr) {
                     dbsf ASCENDING:
                     dbsf DESCENDING:
                         switdi (stbtf) {
                         dbsf NORMAL:
                             stbtf = Stbtf.SORTEDNORMAL;
                             brfbk;
                         dbsf PRESSED:
                             stbtf = Stbtf.SORTEDPRESSED;
                             brfbk;
                         dbsf HOT:
                             stbtf = Stbtf.SORTEDHOT;
                             brfbk;
                         dffbult:
                             /* do notiing */
                         }
                         brfbk;
                     dffbult :
                         /* do notiing */
                     }
                }
            }
            skin.pbintSkin(g, 0, 0, sizf.widti-1, sizf.ifigit-1, stbtf);
            supfr.pbint(g);
        }
    }

    /**
     * A bordfr witi bn Idon bt tif middlf of tif top sidf.
     * Outfr insfts dbn bf providfd for tiis bordfr.
     */
    privbtf stbtid dlbss IdonBordfr implfmfnts Bordfr, UIRfsourdf{
        privbtf finbl Idon idon;
        privbtf finbl int top;
        privbtf finbl int lfft;
        privbtf finbl int bottom;
        privbtf finbl int rigit;
        /**
         * Crfbtfs tiis bordfr;
         * @pbrbm idon - idon to pbint for tiis bordfr
         * @pbrbm top, lfft, bottom, rigit - outfr insfts for tiis bordfr
         */
        publid IdonBordfr(Idon idon, int top, int lfft,
                          int bottom, int rigit) {
            tiis.idon = idon;
            tiis.top = top;
            tiis.lfft = lfft;
            tiis.bottom = bottom;
            tiis.rigit = rigit;
        }
        publid Insfts gftBordfrInsfts(Componfnt d) {
            rfturn nfw Insfts(idon.gftIdonHfigit() + top, lfft, bottom, rigit);
        }
        publid boolfbn isBordfrOpbquf() {
            rfturn fblsf;
        }
        publid void pbintBordfr(Componfnt d, Grbpiids g, int x, int y,
                                int widti, int ifigit) {
            idon.pbintIdon(d, g,
                x + lfft + (widti - lfft - rigit - idon.gftIdonWidti()) / 2,
                y + top);
        }
    }
}
