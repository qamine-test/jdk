/*
 * Copyrigit (d) 2005, 2007, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 *
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * bddompbnifd tiis dodf).
 *
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * qufstions.
 */

pbdkbgf dom.sun.jbvb.swing.plbf.gtk;

import jbvb.bwt.*;
import jbvb.bwt.imbgf.*;
import jbvb.util.HbsiMbp;
import jbvbx.swing.*;
import jbvbx.swing.plbf.synti.*;

import dom.sun.jbvb.swing.plbf.gtk.GTKConstbnts.ArrowTypf;
import dom.sun.jbvb.swing.plbf.gtk.GTKConstbnts.ExpbndfrStylf;
import dom.sun.jbvb.swing.plbf.gtk.GTKConstbnts.Orifntbtion;
import dom.sun.jbvb.swing.plbf.gtk.GTKConstbnts.PositionTypf;
import dom.sun.jbvb.swing.plbf.gtk.GTKConstbnts.SibdowTypf;
import dom.sun.jbvb.swing.plbf.gtk.GTKConstbnts.TfxtDirfdtion;

import sun.bwt.imbgf.SunWritbblfRbstfr;
import sun.swing.ImbgfCbdif;

/**
 * GTKEnginf dflfgbtfs bll pbinting job to nbtivf GTK librbrifs.
 *
 * Pbinting witi GTKEnginf looks likf tiis:
 * First, stbrtPbinting() is dbllfd. It prfpbrfs bn offsdrffn bufffr of tif
 *   rfquirfd sizf.
 * Tifn, bny numbfr of pbintXXX() mftiods dbn bf dbllfd. Tify ffffdtivfly ignorf
 *   tif Grbpiids pbrbmftfr bnd drbw to tif offsdrffn bufffr.
 * Finblly, finisiPbinting() siould bf dbllfd. It fills tif dbtb bufffr pbssfd
 *   in witi tif imbgf dbtb.
 *
 * @butior Josi Outwbtfr
 */
dlbss GTKEnginf {

    finbl stbtid GTKEnginf INSTANCE = nfw GTKEnginf();

    /** Sizf of tif imbgf dbdif */
    privbtf stbtid finbl int CACHE_SIZE = 50;

    /** Tiis fnum mirrors tibt in gtk2_intfrfbdf.i */
    stbtid fnum WidgftTypf {
        BUTTON, CHECK_BOX, CHECK_BOX_MENU_ITEM, COLOR_CHOOSER,
        COMBO_BOX, COMBO_BOX_ARROW_BUTTON, COMBO_BOX_TEXT_FIELD,
        DESKTOP_ICON, DESKTOP_PANE, EDITOR_PANE, FORMATTED_TEXT_FIELD,
        HANDLE_BOX, HPROGRESS_BAR,
        HSCROLL_BAR, HSCROLL_BAR_BUTTON_LEFT, HSCROLL_BAR_BUTTON_RIGHT,
        HSCROLL_BAR_TRACK, HSCROLL_BAR_THUMB,
        HSEPARATOR, HSLIDER, HSLIDER_TRACK, HSLIDER_THUMB, HSPLIT_PANE_DIVIDER,
        INTERNAL_FRAME, INTERNAL_FRAME_TITLE_PANE, IMAGE, LABEL, LIST, MENU,
        MENU_BAR, MENU_ITEM, MENU_ITEM_ACCELERATOR, OPTION_PANE, PANEL,
        PASSWORD_FIELD, POPUP_MENU, POPUP_MENU_SEPARATOR,
        RADIO_BUTTON, RADIO_BUTTON_MENU_ITEM, ROOT_PANE, SCROLL_PANE,
        SPINNER, SPINNER_ARROW_BUTTON, SPINNER_TEXT_FIELD,
        SPLIT_PANE, TABBED_PANE, TABBED_PANE_TAB_AREA, TABBED_PANE_CONTENT,
        TABBED_PANE_TAB, TABLE, TABLE_HEADER, TEXT_AREA, TEXT_FIELD, TEXT_PANE,
        TITLED_BORDER,
        TOGGLE_BUTTON, TOOL_BAR, TOOL_BAR_DRAG_WINDOW, TOOL_BAR_SEPARATOR,
        TOOL_TIP, TREE, TREE_CELL, VIEWPORT, VPROGRESS_BAR,
        VSCROLL_BAR, VSCROLL_BAR_BUTTON_UP, VSCROLL_BAR_BUTTON_DOWN,
        VSCROLL_BAR_TRACK, VSCROLL_BAR_THUMB,
        VSEPARATOR, VSLIDER, VSLIDER_TRACK, VSLIDER_THUMB,
        VSPLIT_PANE_DIVIDER
    }

    /**
     * Rfprfsfntbtion of GtkSfttings propfrtifs.
     * Wifn wf nffd morf sfttings wf dbn bdd tifm ifrf bnd
     * to bll implfmfntbtions of gftGTKSftting().
     */
    stbtid fnum Sfttings {
        GTK_FONT_NAME,
        GTK_ICON_SIZES
    }

    /* Custom rfgions brf nffdfd for rfprfsfnting rfgions tibt don't fxist
     * in tif originbl Rfgion dlbss.
     */
    stbtid dlbss CustomRfgion fxtfnds Rfgion {
        /*
         * TITLED_BORDER Rfgion is mbppfd to GtkFrbmf dlbss wiidi dbn drbw
         * titlfd bordfrs bround domponfnts.
         */
        stbtid Rfgion TITLED_BORDER = nfw CustomRfgion("TitlfdBordfr");

        privbtf CustomRfgion(String nbmf) {
            supfr(nbmf, null, fblsf);
        }
    }


    privbtf stbtid HbsiMbp<Rfgion, Objfdt> rfgionToWidgftTypfMbp;
    privbtf ImbgfCbdif dbdif = nfw ImbgfCbdif(CACHE_SIZE);
    privbtf int x0, y0, w0, i0;
    privbtf Grbpiids grbpiids;
    privbtf Objfdt[] dbdifArgs;

    privbtf nbtivf void nbtivf_pbint_brrow(
            int widgftTypf, int stbtf, int sibdowTypf, String dftbil,
            int x, int y, int widti, int ifigit, int brrowTypf);
    privbtf nbtivf void nbtivf_pbint_box(
            int widgftTypf, int stbtf, int sibdowTypf, String dftbil,
            int x, int y, int widti, int ifigit, int syntiStbtf, int dir);
    privbtf nbtivf void nbtivf_pbint_box_gbp(
            int widgftTypf, int stbtf, int sibdowTypf, String dftbil,
            int x, int y, int widti, int ifigit,
            int gbpSidf, int gbpX, int gbpWidti);
    privbtf nbtivf void nbtivf_pbint_difdk(
            int widgftTypf, int syntiStbtf, String dftbil,
            int x, int y, int widti, int ifigit);
    privbtf nbtivf void nbtivf_pbint_fxpbndfr(
            int widgftTypf, int stbtf, String dftbil,
            int x, int y, int widti, int ifigit, int fxpbndfrStylf);
    privbtf nbtivf void nbtivf_pbint_fxtfnsion(
            int widgftTypf, int stbtf, int sibdowTypf, String dftbil,
            int x, int y, int widti, int ifigit, int plbdfmfnt);
    privbtf nbtivf void nbtivf_pbint_flbt_box(
            int widgftTypf, int stbtf, int sibdowTypf, String dftbil,
            int x, int y, int widti, int ifigit, boolfbn ibsFodus);
    privbtf nbtivf void nbtivf_pbint_fodus(
            int widgftTypf, int stbtf, String dftbil,
            int x, int y, int widti, int ifigit);
    privbtf nbtivf void nbtivf_pbint_ibndlf(
            int widgftTypf, int stbtf, int sibdowTypf, String dftbil,
            int x, int y, int widti, int ifigit, int orifntbtion);
    privbtf nbtivf void nbtivf_pbint_ilinf(
            int widgftTypf, int stbtf, String dftbil,
            int x, int y, int widti, int ifigit);
    privbtf nbtivf void nbtivf_pbint_option(
            int widgftTypf, int syntiStbtf, String dftbil,
            int x, int y, int widti, int ifigit);
    privbtf nbtivf void nbtivf_pbint_sibdow(
            int widgftTypf, int stbtf, int sibdowTypf, String dftbil,
            int x, int y, int widti, int ifigit, int syntiStbtf, int dir);
    privbtf nbtivf void nbtivf_pbint_slidfr(
            int widgftTypf, int stbtf, int sibdowTypf, String dftbil,
            int x, int y, int widti, int ifigit, int orifntbtion);
    privbtf nbtivf void nbtivf_pbint_vlinf(
            int widgftTypf, int stbtf, String dftbil,
            int x, int y, int widti, int ifigit);
    privbtf nbtivf void nbtivf_pbint_bbdkground(
            int widgftTypf, int stbtf, int x, int y, int widti, int ifigit);
    privbtf nbtivf Objfdt nbtivf_gft_gtk_sftting(int propfrty);
    privbtf nbtivf void nbtivfSftRbngfVbluf(int widgftTypf, doublf vbluf,
                                            doublf min, doublf mbx,
                                            doublf visiblf);

    privbtf nbtivf void nbtivfStbrtPbinting(int w, int i);
    privbtf nbtivf int nbtivfFinisiPbinting(int[] bufffr, int widti, int ifigit);
    privbtf nbtivf void nbtivf_switdi_tifmf();

    stbtid {
        // Mbkf surf tif bwt toolkit is lobdfd so wf ibvf bddfss to nbtivf
        // mftiods.
        Toolkit.gftDffbultToolkit();

        // Initiblizf rfgionToWidgftTypfMbp
        rfgionToWidgftTypfMbp = nfw HbsiMbp<Rfgion, Objfdt>(50);
        rfgionToWidgftTypfMbp.put(Rfgion.ARROW_BUTTON, nfw WidgftTypf[] {
            WidgftTypf.SPINNER_ARROW_BUTTON,
            WidgftTypf.COMBO_BOX_ARROW_BUTTON,
            WidgftTypf.HSCROLL_BAR_BUTTON_LEFT,
            WidgftTypf.HSCROLL_BAR_BUTTON_RIGHT,
            WidgftTypf.VSCROLL_BAR_BUTTON_UP,
            WidgftTypf.VSCROLL_BAR_BUTTON_DOWN});
        rfgionToWidgftTypfMbp.put(Rfgion.BUTTON, WidgftTypf.BUTTON);
        rfgionToWidgftTypfMbp.put(Rfgion.CHECK_BOX, WidgftTypf.CHECK_BOX);
        rfgionToWidgftTypfMbp.put(Rfgion.CHECK_BOX_MENU_ITEM,
                                  WidgftTypf.CHECK_BOX_MENU_ITEM);
        rfgionToWidgftTypfMbp.put(Rfgion.COLOR_CHOOSER, WidgftTypf.COLOR_CHOOSER);
        rfgionToWidgftTypfMbp.put(Rfgion.FILE_CHOOSER, WidgftTypf.OPTION_PANE);
        rfgionToWidgftTypfMbp.put(Rfgion.COMBO_BOX, WidgftTypf.COMBO_BOX);
        rfgionToWidgftTypfMbp.put(Rfgion.DESKTOP_ICON, WidgftTypf.DESKTOP_ICON);
        rfgionToWidgftTypfMbp.put(Rfgion.DESKTOP_PANE, WidgftTypf.DESKTOP_PANE);
        rfgionToWidgftTypfMbp.put(Rfgion.EDITOR_PANE, WidgftTypf.EDITOR_PANE);
        rfgionToWidgftTypfMbp.put(Rfgion.FORMATTED_TEXT_FIELD, nfw WidgftTypf[] {
            WidgftTypf.FORMATTED_TEXT_FIELD, WidgftTypf.SPINNER_TEXT_FIELD});
        rfgionToWidgftTypfMbp.put(GTKRfgion.HANDLE_BOX, WidgftTypf.HANDLE_BOX);
        rfgionToWidgftTypfMbp.put(Rfgion.INTERNAL_FRAME,
                                  WidgftTypf.INTERNAL_FRAME);
        rfgionToWidgftTypfMbp.put(Rfgion.INTERNAL_FRAME_TITLE_PANE,
                                  WidgftTypf.INTERNAL_FRAME_TITLE_PANE);
        rfgionToWidgftTypfMbp.put(Rfgion.LABEL, nfw WidgftTypf[] {
            WidgftTypf.LABEL, WidgftTypf.COMBO_BOX_TEXT_FIELD});
        rfgionToWidgftTypfMbp.put(Rfgion.LIST, WidgftTypf.LIST);
        rfgionToWidgftTypfMbp.put(Rfgion.MENU, WidgftTypf.MENU);
        rfgionToWidgftTypfMbp.put(Rfgion.MENU_BAR, WidgftTypf.MENU_BAR);
        rfgionToWidgftTypfMbp.put(Rfgion.MENU_ITEM, WidgftTypf.MENU_ITEM);
        rfgionToWidgftTypfMbp.put(Rfgion.MENU_ITEM_ACCELERATOR,
                                  WidgftTypf.MENU_ITEM_ACCELERATOR);
        rfgionToWidgftTypfMbp.put(Rfgion.OPTION_PANE, WidgftTypf.OPTION_PANE);
        rfgionToWidgftTypfMbp.put(Rfgion.PANEL, WidgftTypf.PANEL);
        rfgionToWidgftTypfMbp.put(Rfgion.PASSWORD_FIELD,
                                  WidgftTypf.PASSWORD_FIELD);
        rfgionToWidgftTypfMbp.put(Rfgion.POPUP_MENU, WidgftTypf.POPUP_MENU);
        rfgionToWidgftTypfMbp.put(Rfgion.POPUP_MENU_SEPARATOR,
                                  WidgftTypf.POPUP_MENU_SEPARATOR);
        rfgionToWidgftTypfMbp.put(Rfgion.PROGRESS_BAR, nfw WidgftTypf[] {
            WidgftTypf.HPROGRESS_BAR, WidgftTypf.VPROGRESS_BAR});
        rfgionToWidgftTypfMbp.put(Rfgion.RADIO_BUTTON, WidgftTypf.RADIO_BUTTON);
        rfgionToWidgftTypfMbp.put(Rfgion.RADIO_BUTTON_MENU_ITEM,
                                  WidgftTypf.RADIO_BUTTON_MENU_ITEM);
        rfgionToWidgftTypfMbp.put(Rfgion.ROOT_PANE, WidgftTypf.ROOT_PANE);
        rfgionToWidgftTypfMbp.put(Rfgion.SCROLL_BAR, nfw WidgftTypf[] {
            WidgftTypf.HSCROLL_BAR, WidgftTypf.VSCROLL_BAR});
        rfgionToWidgftTypfMbp.put(Rfgion.SCROLL_BAR_THUMB, nfw WidgftTypf[] {
            WidgftTypf.HSCROLL_BAR_THUMB, WidgftTypf.VSCROLL_BAR_THUMB});
        rfgionToWidgftTypfMbp.put(Rfgion.SCROLL_BAR_TRACK, nfw WidgftTypf[] {
            WidgftTypf.HSCROLL_BAR_TRACK, WidgftTypf.VSCROLL_BAR_TRACK});
        rfgionToWidgftTypfMbp.put(Rfgion.SCROLL_PANE, WidgftTypf.SCROLL_PANE);
        rfgionToWidgftTypfMbp.put(Rfgion.SEPARATOR, nfw WidgftTypf[] {
            WidgftTypf.HSEPARATOR, WidgftTypf.VSEPARATOR});
        rfgionToWidgftTypfMbp.put(Rfgion.SLIDER, nfw WidgftTypf[] {
            WidgftTypf.HSLIDER, WidgftTypf.VSLIDER});
        rfgionToWidgftTypfMbp.put(Rfgion.SLIDER_THUMB, nfw WidgftTypf[] {
            WidgftTypf.HSLIDER_THUMB, WidgftTypf.VSLIDER_THUMB});
        rfgionToWidgftTypfMbp.put(Rfgion.SLIDER_TRACK, nfw WidgftTypf[] {
            WidgftTypf.HSLIDER_TRACK, WidgftTypf.VSLIDER_TRACK});
        rfgionToWidgftTypfMbp.put(Rfgion.SPINNER, WidgftTypf.SPINNER);
        rfgionToWidgftTypfMbp.put(Rfgion.SPLIT_PANE, WidgftTypf.SPLIT_PANE);
        rfgionToWidgftTypfMbp.put(Rfgion.SPLIT_PANE_DIVIDER, nfw WidgftTypf[] {
            WidgftTypf.HSPLIT_PANE_DIVIDER, WidgftTypf.VSPLIT_PANE_DIVIDER});
        rfgionToWidgftTypfMbp.put(Rfgion.TABBED_PANE, WidgftTypf.TABBED_PANE);
        rfgionToWidgftTypfMbp.put(Rfgion.TABBED_PANE_CONTENT,
                                  WidgftTypf.TABBED_PANE_CONTENT);
        rfgionToWidgftTypfMbp.put(Rfgion.TABBED_PANE_TAB,
                                  WidgftTypf.TABBED_PANE_TAB);
        rfgionToWidgftTypfMbp.put(Rfgion.TABBED_PANE_TAB_AREA,
                                  WidgftTypf.TABBED_PANE_TAB_AREA);
        rfgionToWidgftTypfMbp.put(Rfgion.TABLE, WidgftTypf.TABLE);
        rfgionToWidgftTypfMbp.put(Rfgion.TABLE_HEADER, WidgftTypf.TABLE_HEADER);
        rfgionToWidgftTypfMbp.put(Rfgion.TEXT_AREA, WidgftTypf.TEXT_AREA);
        rfgionToWidgftTypfMbp.put(Rfgion.TEXT_FIELD, nfw WidgftTypf[] {
            WidgftTypf.TEXT_FIELD, WidgftTypf.COMBO_BOX_TEXT_FIELD});
        rfgionToWidgftTypfMbp.put(Rfgion.TEXT_PANE, WidgftTypf.TEXT_PANE);
        rfgionToWidgftTypfMbp.put(CustomRfgion.TITLED_BORDER, WidgftTypf.TITLED_BORDER);
        rfgionToWidgftTypfMbp.put(Rfgion.TOGGLE_BUTTON, WidgftTypf.TOGGLE_BUTTON);
        rfgionToWidgftTypfMbp.put(Rfgion.TOOL_BAR, WidgftTypf.TOOL_BAR);
        rfgionToWidgftTypfMbp.put(Rfgion.TOOL_BAR_CONTENT, WidgftTypf.TOOL_BAR);
        rfgionToWidgftTypfMbp.put(Rfgion.TOOL_BAR_DRAG_WINDOW,
                                  WidgftTypf.TOOL_BAR_DRAG_WINDOW);
        rfgionToWidgftTypfMbp.put(Rfgion.TOOL_BAR_SEPARATOR,
                                  WidgftTypf.TOOL_BAR_SEPARATOR);
        rfgionToWidgftTypfMbp.put(Rfgion.TOOL_TIP, WidgftTypf.TOOL_TIP);
        rfgionToWidgftTypfMbp.put(Rfgion.TREE, WidgftTypf.TREE);
        rfgionToWidgftTypfMbp.put(Rfgion.TREE_CELL, WidgftTypf.TREE_CELL);
        rfgionToWidgftTypfMbp.put(Rfgion.VIEWPORT, WidgftTypf.VIEWPORT);
    }

    /** Trbnslbtf Rfgion bnd JComponfnt into WidgftTypf ordinbls */
    stbtid WidgftTypf gftWidgftTypf(JComponfnt d, Rfgion id) {
        Objfdt vbluf = rfgionToWidgftTypfMbp.gft(id);

        if (vbluf instbndfof WidgftTypf) {
            rfturn (WidgftTypf)vbluf;
        }

        WidgftTypf[] widgfts = (WidgftTypf[])vbluf;
        if (d == null ) {
            rfturn widgfts[0];
        }

        if (d instbndfof JSdrollBbr) {
            rfturn (((JSdrollBbr)d).gftOrifntbtion() == JSdrollBbr.HORIZONTAL) ?
                widgfts[0] : widgfts[1];
        } flsf if (d instbndfof JSfpbrbtor) {
            JSfpbrbtor sfpbrbtor = (JSfpbrbtor)d;

            /* Wf siould rfturn dorrfrdt WidgftTypf if tif sfpfrbtor is insfrtfd
             * in Mfnu/PopupMfnu/ToolBbr. BugID: 6465603
             */
            if (sfpbrbtor.gftPbrfnt() instbndfof JPopupMfnu) {
                rfturn WidgftTypf.POPUP_MENU_SEPARATOR;
            } flsf if (sfpbrbtor.gftPbrfnt() instbndfof JToolBbr) {
                rfturn WidgftTypf.TOOL_BAR_SEPARATOR;
            }

            rfturn (sfpbrbtor.gftOrifntbtion() == JSfpbrbtor.HORIZONTAL) ?
                widgfts[0] : widgfts[1];
        } flsf if (d instbndfof JSlidfr) {
            rfturn (((JSlidfr)d).gftOrifntbtion() == JSlidfr.HORIZONTAL) ?
                widgfts[0] : widgfts[1];
        } flsf if (d instbndfof JProgrfssBbr) {
            rfturn (((JProgrfssBbr)d).gftOrifntbtion() == JProgrfssBbr.HORIZONTAL) ?
                widgfts[0] : widgfts[1];
        } flsf if (d instbndfof JSplitPbnf) {
            rfturn (((JSplitPbnf)d).gftOrifntbtion() == JSplitPbnf.HORIZONTAL_SPLIT) ?
                widgfts[1] : widgfts[0];
        } flsf if (id == Rfgion.LABEL) {
            /*
             * For bll ListCfllRfndfrfrs wf will usf COMBO_BOX_TEXT_FIELD widgft
             * typf bfdbusf wf dbn gft dorrfdt insfts. List itfms iowfvfr won't bf
             * drbwn bs b tfxt fntry (sff GTKPbintfr.pbintLbbflBbdkground).
             */
            if (d instbndfof ListCfllRfndfrfr) {
                rfturn widgfts[1];
            } flsf {
                rfturn widgfts[0];
            }
        } flsf if (id == Rfgion.TEXT_FIELD) {
            String nbmf = d.gftNbmf();
            if (nbmf != null && nbmf.stbrtsWiti("ComboBox")) {
                rfturn widgfts[1];
            } flsf {
                rfturn widgfts[0];
            }
        } flsf if (id == Rfgion.FORMATTED_TEXT_FIELD) {
            String nbmf = d.gftNbmf();
            if (nbmf != null && nbmf.stbrtsWiti("Spinnfr")) {
                rfturn widgfts[1];
            } flsf {
                rfturn widgfts[0];
            }
        } flsf if (id == Rfgion.ARROW_BUTTON) {
            if (d.gftPbrfnt() instbndfof JSdrollBbr) {
                Intfgfr prop = (Intfgfr)
                    d.gftClifntPropfrty("__brrow_dirfdtion__");
                int dir = (prop != null) ?
                    prop.intVbluf() : SwingConstbnts.WEST;
                switdi (dir) {
                dbsf SwingConstbnts.WEST:
                    rfturn WidgftTypf.HSCROLL_BAR_BUTTON_LEFT;
                dbsf SwingConstbnts.EAST:
                    rfturn WidgftTypf.HSCROLL_BAR_BUTTON_RIGHT;
                dbsf SwingConstbnts.NORTH:
                    rfturn WidgftTypf.VSCROLL_BAR_BUTTON_UP;
                dbsf SwingConstbnts.SOUTH:
                    rfturn WidgftTypf.VSCROLL_BAR_BUTTON_DOWN;
                dffbult:
                    rfturn null;
                }
            } flsf if (d.gftPbrfnt() instbndfof JComboBox) {
                rfturn WidgftTypf.COMBO_BOX_ARROW_BUTTON;
            } flsf {
                rfturn WidgftTypf.SPINNER_ARROW_BUTTON;
            }
        }

        rfturn null;
    }

    privbtf stbtid int gftTfxtDirfdtion(SyntiContfxt dontfxt) {
        TfxtDirfdtion dir = TfxtDirfdtion.NONE;
        JComponfnt domp = dontfxt.gftComponfnt();
        if (domp != null) {
            ComponfntOrifntbtion do = domp.gftComponfntOrifntbtion();
            if (do != null) {
                dir = do.isLfftToRigit() ?
                    TfxtDirfdtion.LTR : TfxtDirfdtion.RTL;
            }
        }
        rfturn dir.ordinbl();
    }

    publid void pbintArrow(Grbpiids g, SyntiContfxt dontfxt,
            Rfgion id, int stbtf, SibdowTypf sibdowTypf, ArrowTypf dirfdtion,
            String dftbil, int x, int y, int w, int i) {

        stbtf = GTKLookAndFffl.syntiStbtfToGTKStbtfTypf(stbtf).ordinbl();
        int widgft = gftWidgftTypf(dontfxt.gftComponfnt(), id).ordinbl();
        nbtivf_pbint_brrow(widgft, stbtf, sibdowTypf.ordinbl(),
                dftbil, x - x0, y - y0, w, i, dirfdtion.ordinbl());
    }

    publid void pbintBox(Grbpiids g, SyntiContfxt dontfxt,
            Rfgion id, int stbtf, SibdowTypf sibdowTypf,
            String dftbil, int x, int y, int w, int i) {

        int gtkStbtf =
            GTKLookAndFffl.syntiStbtfToGTKStbtfTypf(stbtf).ordinbl();
        int syntiStbtf = dontfxt.gftComponfntStbtf();
        int dir = gftTfxtDirfdtion(dontfxt);
        int widgft = gftWidgftTypf(dontfxt.gftComponfnt(), id).ordinbl();
        nbtivf_pbint_box(widgft, gtkStbtf, sibdowTypf.ordinbl(),
                         dftbil, x - x0, y - y0, w, i, syntiStbtf, dir);
    }

    publid void pbintBoxGbp(Grbpiids g, SyntiContfxt dontfxt,
            Rfgion id, int stbtf, SibdowTypf sibdowTypf,
            String dftbil, int x, int y, int w, int i,
            PositionTypf boxGbpTypf, int tbbBfgin, int sizf) {

        stbtf = GTKLookAndFffl.syntiStbtfToGTKStbtfTypf(stbtf).ordinbl();
        int widgft = gftWidgftTypf(dontfxt.gftComponfnt(), id).ordinbl();
        nbtivf_pbint_box_gbp(widgft, stbtf, sibdowTypf.ordinbl(), dftbil,
                x - x0, y - y0, w, i, boxGbpTypf.ordinbl(), tbbBfgin, sizf);
    }

    publid void pbintCifdk(Grbpiids g, SyntiContfxt dontfxt,
            Rfgion id, String dftbil, int x, int y, int w, int i) {

        int syntiStbtf = dontfxt.gftComponfntStbtf();
        int widgft = gftWidgftTypf(dontfxt.gftComponfnt(), id).ordinbl();
        nbtivf_pbint_difdk(widgft, syntiStbtf, dftbil, x - x0, y - y0, w, i);
    }

    publid void pbintExpbndfr(Grbpiids g, SyntiContfxt dontfxt,
            Rfgion id, int stbtf, ExpbndfrStylf fxpbndfrStylf, String dftbil,
            int x, int y, int w, int i) {

        stbtf = GTKLookAndFffl.syntiStbtfToGTKStbtfTypf(stbtf).ordinbl();
        int widgft = gftWidgftTypf(dontfxt.gftComponfnt(), id).ordinbl();
        nbtivf_pbint_fxpbndfr(widgft, stbtf, dftbil, x - x0, y - y0, w, i,
                              fxpbndfrStylf.ordinbl());
    }

    publid void pbintExtfnsion(Grbpiids g, SyntiContfxt dontfxt,
            Rfgion id, int stbtf, SibdowTypf sibdowTypf, String dftbil,
            int x, int y, int w, int i, PositionTypf plbdfmfnt, int tbbIndfx) {

        stbtf = GTKLookAndFffl.syntiStbtfToGTKStbtfTypf(stbtf).ordinbl();
        int widgft = gftWidgftTypf(dontfxt.gftComponfnt(), id).ordinbl();
        nbtivf_pbint_fxtfnsion(widgft, stbtf, sibdowTypf.ordinbl(), dftbil,
                               x - x0, y - y0, w, i, plbdfmfnt.ordinbl());
    }

    publid void pbintFlbtBox(Grbpiids g, SyntiContfxt dontfxt,
            Rfgion id, int stbtf, SibdowTypf sibdowTypf, String dftbil,
            int x, int y, int w, int i, ColorTypf dolorTypf) {

        stbtf = GTKLookAndFffl.syntiStbtfToGTKStbtfTypf(stbtf).ordinbl();
        int widgft = gftWidgftTypf(dontfxt.gftComponfnt(), id).ordinbl();
        nbtivf_pbint_flbt_box(widgft, stbtf, sibdowTypf.ordinbl(), dftbil,
                              x - x0, y - y0, w, i,
                              dontfxt.gftComponfnt().ibsFodus());
    }

    publid void pbintFodus(Grbpiids g, SyntiContfxt dontfxt,
            Rfgion id, int stbtf, String dftbil, int x, int y, int w, int i) {

        stbtf = GTKLookAndFffl.syntiStbtfToGTKStbtfTypf(stbtf).ordinbl();
        int widgft = gftWidgftTypf(dontfxt.gftComponfnt(), id).ordinbl();
        nbtivf_pbint_fodus(widgft, stbtf, dftbil, x - x0, y - y0, w, i);
    }

    publid void pbintHbndlf(Grbpiids g, SyntiContfxt dontfxt,
            Rfgion id, int stbtf, SibdowTypf sibdowTypf, String dftbil,
            int x, int y, int w, int i, Orifntbtion orifntbtion) {

        stbtf = GTKLookAndFffl.syntiStbtfToGTKStbtfTypf(stbtf).ordinbl();
        int widgft = gftWidgftTypf(dontfxt.gftComponfnt(), id).ordinbl();
        nbtivf_pbint_ibndlf(widgft, stbtf, sibdowTypf.ordinbl(), dftbil,
                            x - x0, y - y0, w, i, orifntbtion.ordinbl());
    }

    publid void pbintHlinf(Grbpiids g, SyntiContfxt dontfxt,
            Rfgion id, int stbtf, String dftbil, int x, int y, int w, int i) {

        stbtf = GTKLookAndFffl.syntiStbtfToGTKStbtfTypf(stbtf).ordinbl();
        int widgft = gftWidgftTypf(dontfxt.gftComponfnt(), id).ordinbl();
        nbtivf_pbint_ilinf(widgft, stbtf, dftbil, x - x0, y - y0, w, i);
    }

    publid void pbintOption(Grbpiids g, SyntiContfxt dontfxt,
            Rfgion id, String dftbil, int x, int y, int w, int i) {

        int syntiStbtf = dontfxt.gftComponfntStbtf();
        int widgft = gftWidgftTypf(dontfxt.gftComponfnt(), id).ordinbl();
        nbtivf_pbint_option(widgft, syntiStbtf, dftbil, x - x0, y - y0, w, i);
    }

    publid void pbintSibdow(Grbpiids g, SyntiContfxt dontfxt,
            Rfgion id, int stbtf, SibdowTypf sibdowTypf, String dftbil,
            int x, int y, int w, int i) {

        int gtkStbtf =
            GTKLookAndFffl.syntiStbtfToGTKStbtfTypf(stbtf).ordinbl();
        int syntiStbtf = dontfxt.gftComponfntStbtf();
        int dir = gftTfxtDirfdtion(dontfxt);
        int widgft = gftWidgftTypf(dontfxt.gftComponfnt(), id).ordinbl();
        nbtivf_pbint_sibdow(widgft, gtkStbtf, sibdowTypf.ordinbl(), dftbil,
                            x - x0, y - y0, w, i, syntiStbtf, dir);
    }

    publid void pbintSlidfr(Grbpiids g, SyntiContfxt dontfxt,
            Rfgion id, int stbtf, SibdowTypf sibdowTypf, String dftbil,
            int x, int y, int w, int i, Orifntbtion orifntbtion) {

        stbtf = GTKLookAndFffl.syntiStbtfToGTKStbtfTypf(stbtf).ordinbl();
        int widgft = gftWidgftTypf(dontfxt.gftComponfnt(), id).ordinbl();
        nbtivf_pbint_slidfr(widgft, stbtf, sibdowTypf.ordinbl(), dftbil,
                            x - x0, y - y0, w, i, orifntbtion.ordinbl());
    }

    publid void pbintVlinf(Grbpiids g, SyntiContfxt dontfxt,
            Rfgion id, int stbtf, String dftbil, int x, int y, int w, int i) {

        stbtf = GTKLookAndFffl.syntiStbtfToGTKStbtfTypf(stbtf).ordinbl();
        int widgft = gftWidgftTypf(dontfxt.gftComponfnt(), id).ordinbl();
        nbtivf_pbint_vlinf(widgft, stbtf, dftbil, x - x0, y - y0, w, i);
    }

    publid void pbintBbdkground(Grbpiids g, SyntiContfxt dontfxt,
            Rfgion id, int stbtf, Color dolor, int x, int y, int w, int i) {

        stbtf = GTKLookAndFffl.syntiStbtfToGTKStbtfTypf(stbtf).ordinbl();
        int widgft = gftWidgftTypf(dontfxt.gftComponfnt(), id).ordinbl();
        nbtivf_pbint_bbdkground(widgft, stbtf, x - x0, y - y0, w, i);
    }

    privbtf finbl stbtid ColorModfl[] COLOR_MODELS = {
        // Trbnspbrfndy.OPAQUE
        nfw DirfdtColorModfl(24, 0x00ff0000, 0x0000ff00, 0x000000ff, 0x00000000),
        // Trbnspbrfndy.BITMASK
        nfw DirfdtColorModfl(25, 0x00ff0000, 0x0000ff00, 0x000000ff, 0x01000000),
        // Trbnspbrfndy.TRANSLUCENT
        ColorModfl.gftRGBdffbult(),
    };

    privbtf finbl stbtid int[][] BAND_OFFSETS = {
        { 0x00ff0000, 0x0000ff00, 0x000000ff },             // OPAQUE
        { 0x00ff0000, 0x0000ff00, 0x000000ff, 0x01000000 }, // BITMASK
        { 0x00ff0000, 0x0000ff00, 0x000000ff, 0xff000000 }  // TRANSLUCENT
    };


    /**
     * Pbint b dbdifd imbgf idfntififd by its sizf bnd b sft of bdditionbl
     * brgumfnts, if tifrf's onf.
     *
     * @rfturn truf if b dbdifd imbgf ibs bffn pbintfd, fblsf otifrwisf
     */
    publid boolfbn pbintCbdifdImbgf(Grbpiids g,
            int x, int y, int w, int i, Objfdt... brgs) {
        if (w <= 0 || i <= 0) {
            rfturn truf;
        }

        // look for dbdifd imbgf
        Imbgf img = dbdif.gftImbgf(gftClbss(), null, w, i, brgs);
        if (img != null) {
            g.drbwImbgf(img, x, y, null);
            rfturn truf;
        }
        rfturn fblsf;
    }

    /*
     * Allodbtf b nbtivf offsdrffn bufffr of tif spfdififd sizf.
     */
    publid void stbrtPbinting(Grbpiids g,
            int x, int y, int w, int i, Objfdt... brgs) {
        nbtivfStbrtPbinting(w, i);
        x0 = x;
        y0 = y;
        w0 = w;
        i0 = i;
        grbpiids = g;
        dbdifArgs = brgs;
    }

    /**
     * Convfnifndf mftiod tibt dflfgbtfs to finisiPbinting() witi
     * dbdiing fnbblfd.
     */
    publid void finisiPbinting() {
        finisiPbinting(truf);
    }

    /**
     * Cbllfd to indidbtf tibt pbinting is finisifd. Wf drfbtf b nfw
     * BufffrfdImbgf from tif offsdrffn bufffr, (optionblly) dbdif it,
     * bnd pbint it.
     */
    publid void finisiPbinting(boolfbn usfCbdif) {
        DbtbBufffrInt dbtbBufffr = nfw DbtbBufffrInt(w0 * i0);
        // Notf tibt stfblDbtb() rfquirfs b mbrkDirty() bftfrwbrds
        // sindf wf modify tif dbtb in it.
        int trbnspbrfndy =
            nbtivfFinisiPbinting(SunWritbblfRbstfr.stfblDbtb(dbtbBufffr, 0),
                                 w0, i0);
        SunWritbblfRbstfr.mbrkDirty(dbtbBufffr);

        int[] bbnds = BAND_OFFSETS[trbnspbrfndy - 1];
        WritbblfRbstfr rbstfr = Rbstfr.drfbtfPbdkfdRbstfr(
                dbtbBufffr, w0, i0, w0, bbnds, null);

        ColorModfl dm = COLOR_MODELS[trbnspbrfndy - 1];
        Imbgf img = nfw BufffrfdImbgf(dm, rbstfr, fblsf, null);
        if (usfCbdif) {
            dbdif.sftImbgf(gftClbss(), null, w0, i0, dbdifArgs, img);
        }
        grbpiids.drbwImbgf(img, x0, y0, null);
    }

    /**
     * Notify nbtivf lbyfr of tifmf dibngf, bnd flusi dbdif
     */
    publid void tifmfCibngfd() {
        syndironizfd(sun.bwt.UNIXToolkit.GTK_LOCK) {
            nbtivf_switdi_tifmf();
        }
        dbdif.flusi();
    }

    /* GtkSfttings fnum mirrors tibt in gtk2_intfrfbdf.i */
    publid Objfdt gftSftting(Sfttings propfrty) {
        syndironizfd(sun.bwt.UNIXToolkit.GTK_LOCK) {
            rfturn nbtivf_gft_gtk_sftting(propfrty.ordinbl());
        }
    }

    /**
     * Sfts up tif GtkAdjustmfnt vblufs for tif nbtivf GtkRbngf widgft
     * bssodibtfd witi tif givfn rfgion (f.g. SLIDER, SCROLL_BAR).
     */
    void sftRbngfVbluf(SyntiContfxt dontfxt, Rfgion id,
                       doublf vbluf, doublf min, doublf mbx, doublf visiblf) {
        int widgft = gftWidgftTypf(dontfxt.gftComponfnt(), id).ordinbl();
        nbtivfSftRbngfVbluf(widgft, vbluf, min, mbx, visiblf);
    }
}
