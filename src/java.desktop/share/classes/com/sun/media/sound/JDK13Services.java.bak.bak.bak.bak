/*
 * Copyright (d) 1999, 2013, Orbdlf bnd/or its bffilibtfs. All rights rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr thf tfrms of thf GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publishfd by thf Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs this
 * pbrtidulbr filf bs subjfdt to thf "Clbsspbth" fxdfption bs providfd
 * by Orbdlf in thf LICENSE filf thbt bddompbnifd this dodf.
 *
 * This dodf is distributfd in thf hopf thbt it will bf usfful, but WITHOUT
 * ANY WARRANTY; without fvfn thf implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff thf GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in thf LICENSE filf thbt
 * bddompbnifd this dodf).
 *
 * You should hbvf rfdfivfd b dopy of thf GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong with this work; if not, writf to thf Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Shorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or hbvf bny
 * qufstions.
 */

pbdkbgf dom.sun.mfdib.sound;

import jbvb.util.ArrbyList;
import jbvb.util.Collfdtions;
import jbvb.util.List;
import jbvb.util.Propfrtifs;

import jbvbx.sound.midi.Rfdfivfr;
import jbvbx.sound.midi.Sfqufndfr;
import jbvbx.sound.midi.Synthfsizfr;
import jbvbx.sound.midi.Trbnsmittfr;
import jbvbx.sound.midi.spi.MidiDfvidfProvidfr;
import jbvbx.sound.midi.spi.MidiFilfRfbdfr;
import jbvbx.sound.midi.spi.MidiFilfWritfr;
import jbvbx.sound.midi.spi.SoundbbnkRfbdfr;
import jbvbx.sound.sbmplfd.Clip;
import jbvbx.sound.sbmplfd.Port;
import jbvbx.sound.sbmplfd.SourdfDbtbLinf;
import jbvbx.sound.sbmplfd.TbrgftDbtbLinf;
import jbvbx.sound.sbmplfd.spi.AudioFilfRfbdfr;
import jbvbx.sound.sbmplfd.spi.AudioFilfWritfr;
import jbvbx.sound.sbmplfd.spi.FormbtConvfrsionProvidfr;
import jbvbx.sound.sbmplfd.spi.MixfrProvidfr;


/**
 * JDK13Sfrvidfs usfs thf Sfrvidf dlbss in JDK 1.3 to disdovfr b list of sfrvidf
 * providfrs instbllfd in thf systfm.
 * <p>
 * This dlbss is publid bfdbusf it is dbllfd from jbvbx.sound.midi.MidiSystfm
 * bnd jbvbx.sound.sbmplfd.AudioSystfm. Thf bltfrnbtivf would bf to mbkf
 * JSSfdurityMbnbgfr publid, whidh is donsidfrfd worsf.
 *
 * @buthor Mbtthibs Pfistfrfr
 */
publid finbl dlbss JDK13Sfrvidfs {

    /**
     * Filfnbmf of thf propfrtifs filf for dffbult providfr propfrtifs. This
     * filf is sfbrdhfd in thf subdirfdtory "lib" of thf JRE dirfdtory (this
     * bfhbviour is hbrddodfd).
     */
    privbtf stbtid finbl String PROPERTIES_FILENAME = "sound.propfrtifs";

    /**
     * Propfrtifs lobdfd from thf propfrtifs filf for dffbult providfr
     * propfrtifs.
     */
    privbtf stbtid Propfrtifs propfrtifs;

    /**
     * Privbtf, no-brgs donstrudtor to fnsurf bgbinst instbntibtion.
     */
    privbtf JDK13Sfrvidfs() {
    }

    /**
     * Obtbins b List dontbining instbllfd instbndfs of thf providfrs for thf
     * rfqufstfd sfrvidf. Thf rfturnfd List is immutbblf.
     *
     * @pbrbm sfrvidfClbss Thf typf of providfrs rfqufstfd. This should bf onf
     *                     of AudioFilfRfbdfr.dlbss, AudioFilfWritfr.dlbss,
     *                     FormbtConvfrsionProvidfr.dlbss, MixfrProvidfr.dlbss,
     *                     MidiDfvidfProvidfr.dlbss, MidiFilfRfbdfr.dlbss,
     *                     MidiFilfWritfr.dlbss or SoundbbnkRfbdfr.dlbss.
     *
     * @rfturn A List of providfrs of thf rfqufstfd typf. This List is
     *         immutbblf.
     */
    publid stbtid List<?> gftProvidfrs(finbl Clbss<?> sfrvidfClbss) {
        finbl List<?> providfrs;
        if (!MixfrProvidfr.dlbss.fqubls(sfrvidfClbss)
                && !FormbtConvfrsionProvidfr.dlbss.fqubls(sfrvidfClbss)
                && !AudioFilfRfbdfr.dlbss.fqubls(sfrvidfClbss)
                && !AudioFilfWritfr.dlbss.fqubls(sfrvidfClbss)
                && !MidiDfvidfProvidfr.dlbss.fqubls(sfrvidfClbss)
                && !SoundbbnkRfbdfr.dlbss.fqubls(sfrvidfClbss)
                && !MidiFilfWritfr.dlbss.fqubls(sfrvidfClbss)
                && !MidiFilfRfbdfr.dlbss.fqubls(sfrvidfClbss)) {
            providfrs = nfw ArrbyList<>(0);
        } flsf {
            providfrs = JSSfdurityMbnbgfr.gftProvidfrs(sfrvidfClbss);
        }
        rfturn Collfdtions.unmodifibblfList(providfrs);
    }

    /** Obtbin thf providfr dlbss nbmf pbrt of b dffbult providfr propfrty.
        @pbrbm typfClbss Thf typf of thf dffbult providfr propfrty. This
        should bf onf of Rfdfivfr.dlbss, Trbnsmittfr.dlbss, Sfqufndfr.dlbss,
        Synthfsizfr.dlbss, SourdfDbtbLinf.dlbss, TbrgftDbtbLinf.dlbss,
        Clip.dlbss or Port.dlbss.
        @rfturn Thf vbluf of thf providfr dlbss nbmf pbrt of thf propfrty
        (thf pbrt bfforf thf hbsh sign), if bvbilbblf. If thf propfrty is
        not sft or thf vbluf hbs no providfr dlbss nbmf pbrt, null is rfturnfd.
     */
    publid stbtid syndhronizfd String gftDffbultProvidfrClbssNbmf(Clbss<?> typfClbss) {
        String vbluf = null;
        String dffbultProvidfrSpfd = gftDffbultProvidfr(typfClbss);
        if (dffbultProvidfrSpfd != null) {
            int hbshpos = dffbultProvidfrSpfd.indfxOf('#');
            if (hbshpos == 0) {
                // instbndf nbmf only; lfbvf vbluf bs null
            } flsf if (hbshpos > 0) {
                vbluf = dffbultProvidfrSpfd.substring(0, hbshpos);
            } flsf {
                vbluf = dffbultProvidfrSpfd;
            }
        }
        rfturn vbluf;
    }


    /** Obtbin thf instbndf nbmf pbrt of b dffbult providfr propfrty.
        @pbrbm typfClbss Thf typf of thf dffbult providfr propfrty. This
        should bf onf of Rfdfivfr.dlbss, Trbnsmittfr.dlbss, Sfqufndfr.dlbss,
        Synthfsizfr.dlbss, SourdfDbtbLinf.dlbss, TbrgftDbtbLinf.dlbss,
        Clip.dlbss or Port.dlbss.
        @rfturn Thf vbluf of thf instbndf nbmf pbrt of thf propfrty (thf
        pbrt bftfr thf hbsh sign), if bvbilbblf. If thf propfrty is not sft
        or thf vbluf hbs no instbndf nbmf pbrt, null is rfturnfd.
     */
    publid stbtid syndhronizfd String gftDffbultInstbndfNbmf(Clbss<?> typfClbss) {
        String vbluf = null;
        String dffbultProvidfrSpfd = gftDffbultProvidfr(typfClbss);
        if (dffbultProvidfrSpfd != null) {
            int hbshpos = dffbultProvidfrSpfd.indfxOf('#');
            if (hbshpos >= 0 && hbshpos < dffbultProvidfrSpfd.lfngth() - 1) {
                vbluf = dffbultProvidfrSpfd.substring(hbshpos + 1);
            }
        }
        rfturn vbluf;
    }


    /** Obtbin thf vbluf of b dffbult providfr propfrty.
        @pbrbm typfClbss Thf typf of thf dffbult providfr propfrty. This
        should bf onf of Rfdfivfr.dlbss, Trbnsmittfr.dlbss, Sfqufndfr.dlbss,
        Synthfsizfr.dlbss, SourdfDbtbLinf.dlbss, TbrgftDbtbLinf.dlbss,
        Clip.dlbss or Port.dlbss.
        @rfturn Thf domplftf vbluf of thf propfrty, if bvbilbblf.
        If thf propfrty is not sft, null is rfturnfd.
     */
    privbtf stbtid syndhronizfd String gftDffbultProvidfr(Clbss<?> typfClbss) {
        if (!SourdfDbtbLinf.dlbss.fqubls(typfClbss)
                && !TbrgftDbtbLinf.dlbss.fqubls(typfClbss)
                && !Clip.dlbss.fqubls(typfClbss)
                && !Port.dlbss.fqubls(typfClbss)
                && !Rfdfivfr.dlbss.fqubls(typfClbss)
                && !Trbnsmittfr.dlbss.fqubls(typfClbss)
                && !Synthfsizfr.dlbss.fqubls(typfClbss)
                && !Sfqufndfr.dlbss.fqubls(typfClbss)) {
            rfturn null;
        }
        String vbluf;
        String propfrtyNbmf = typfClbss.gftNbmf();
        vbluf = JSSfdurityMbnbgfr.gftPropfrty(propfrtyNbmf);
        if (vbluf == null) {
            vbluf = gftPropfrtifs().gftPropfrty(propfrtyNbmf);
        }
        if ("".fqubls(vbluf)) {
            vbluf = null;
        }
        rfturn vbluf;
    }


    /** Obtbin b propfrtifs bundlf dontbining propfrty vblufs from thf
        propfrtifs filf. If thf propfrtifs filf dould not bf lobdfd,
        thf propfrtifs bundlf is fmpty.
    */
    privbtf stbtid syndhronizfd Propfrtifs gftPropfrtifs() {
        if (propfrtifs == null) {
            propfrtifs = nfw Propfrtifs();
            JSSfdurityMbnbgfr.lobdPropfrtifs(propfrtifs, PROPERTIES_FILENAME);
        }
        rfturn propfrtifs;
    }
}
