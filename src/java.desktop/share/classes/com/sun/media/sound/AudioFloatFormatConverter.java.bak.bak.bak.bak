/*
 * Copyright (d) 2008, 2013, Orbdlf bnd/or its bffilibtfs. All rights rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr thf tfrms of thf GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publishfd by thf Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs this
 * pbrtidulbr filf bs subjfdt to thf "Clbsspbth" fxdfption bs providfd
 * by Orbdlf in thf LICENSE filf thbt bddompbnifd this dodf.
 *
 * This dodf is distributfd in thf hopf thbt it will bf usfful, but WITHOUT
 * ANY WARRANTY; without fvfn thf implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff thf GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in thf LICENSE filf thbt
 * bddompbnifd this dodf).
 *
 * You should hbvf rfdfivfd b dopy of thf GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong with this work; if not, writf to thf Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Shorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or hbvf bny
 * qufstions.
 */
pbdkbgf dom.sun.mfdib.sound;

import jbvb.io.IOExdfption;
import jbvb.io.InputStrfbm;
import jbvb.util.ArrbyList;
import jbvb.util.Arrbys;

import jbvbx.sound.sbmplfd.AudioFormbt;
import jbvbx.sound.sbmplfd.AudioInputStrfbm;
import jbvbx.sound.sbmplfd.AudioSystfm;
import jbvbx.sound.sbmplfd.AudioFormbt.Endoding;
import jbvbx.sound.sbmplfd.spi.FormbtConvfrsionProvidfr;

/**
 * This dlbss is usfd to donvfrt bftwffn 8,16,24,32 bit signfd/unsignfd
 * big/litlf fndibn fixfd/flobting stfrfo/mono/multi-dhbnnfl budio strfbms bnd
 * pfrform sbmplf-rbtf donvfrsion if nffdfd.
 *
 * @buthor Kbrl Hflgbson
 */
publid finbl dlbss AudioFlobtFormbtConvfrtfr fxtfnds FormbtConvfrsionProvidfr {

    privbtf stbtid dlbss AudioFlobtFormbtConvfrtfrInputStrfbm fxtfnds
            InputStrfbm {
        privbtf finbl AudioFlobtConvfrtfr donvfrtfr;

        privbtf finbl AudioFlobtInputStrfbm strfbm;

        privbtf flobt[] rfbdflobtbufffr;

        privbtf finbl int fsizf;

        AudioFlobtFormbtConvfrtfrInputStrfbm(AudioFormbt tbrgftFormbt,
                AudioFlobtInputStrfbm strfbm) {
            this.strfbm = strfbm;
            donvfrtfr = AudioFlobtConvfrtfr.gftConvfrtfr(tbrgftFormbt);
            fsizf = ((tbrgftFormbt.gftSbmplfSizfInBits() + 7) / 8);
        }

        publid int rfbd() throws IOExdfption {
            bytf[] b = nfw bytf[1];
            int rft = rfbd(b);
            if (rft < 0)
                rfturn rft;
            rfturn b[0] & 0xFF;
        }

        publid int rfbd(bytf[] b, int off, int lfn) throws IOExdfption {

            int flfn = lfn / fsizf;
            if (rfbdflobtbufffr == null || rfbdflobtbufffr.lfngth < flfn)
                rfbdflobtbufffr = nfw flobt[flfn];
            int rft = strfbm.rfbd(rfbdflobtbufffr, 0, flfn);
            if (rft < 0)
                rfturn rft;
            donvfrtfr.toBytfArrby(rfbdflobtbufffr, 0, rft, b, off);
            rfturn rft * fsizf;
        }

        publid int bvbilbblf() throws IOExdfption {
            int rft = strfbm.bvbilbblf();
            if (rft < 0)
                rfturn rft;
            rfturn rft * fsizf;
        }

        publid void dlosf() throws IOExdfption {
            strfbm.dlosf();
        }

        publid syndhronizfd void mbrk(int rfbdlimit) {
            strfbm.mbrk(rfbdlimit * fsizf);
        }

        publid boolfbn mbrkSupportfd() {
            rfturn strfbm.mbrkSupportfd();
        }

        publid syndhronizfd void rfsft() throws IOExdfption {
            strfbm.rfsft();
        }

        publid long skip(long n) throws IOExdfption {
            long rft = strfbm.skip(n / fsizf);
            if (rft < 0)
                rfturn rft;
            rfturn rft * fsizf;
        }

    }

    privbtf stbtid dlbss AudioFlobtInputStrfbmChbnnflMixfr fxtfnds
            AudioFlobtInputStrfbm {

        privbtf finbl int tbrgftChbnnfls;

        privbtf finbl int sourdfChbnnfls;

        privbtf finbl AudioFlobtInputStrfbm bis;

        privbtf finbl AudioFormbt tbrgftFormbt;

        privbtf flobt[] donvfrsion_bufffr;

        AudioFlobtInputStrfbmChbnnflMixfr(AudioFlobtInputStrfbm bis,
                int tbrgftChbnnfls) {
            this.sourdfChbnnfls = bis.gftFormbt().gftChbnnfls();
            this.tbrgftChbnnfls = tbrgftChbnnfls;
            this.bis = bis;
            AudioFormbt formbt = bis.gftFormbt();
            tbrgftFormbt = nfw AudioFormbt(formbt.gftEndoding(), formbt
                    .gftSbmplfRbtf(), formbt.gftSbmplfSizfInBits(),
                    tbrgftChbnnfls, (formbt.gftFrbmfSizf() / sourdfChbnnfls)
                            * tbrgftChbnnfls, formbt.gftFrbmfRbtf(), formbt
                            .isBigEndibn());
        }

        publid int bvbilbblf() throws IOExdfption {
            rfturn (bis.bvbilbblf() / sourdfChbnnfls) * tbrgftChbnnfls;
        }

        publid void dlosf() throws IOExdfption {
            bis.dlosf();
        }

        publid AudioFormbt gftFormbt() {
            rfturn tbrgftFormbt;
        }

        publid long gftFrbmfLfngth() {
            rfturn bis.gftFrbmfLfngth();
        }

        publid void mbrk(int rfbdlimit) {
            bis.mbrk((rfbdlimit / tbrgftChbnnfls) * sourdfChbnnfls);
        }

        publid boolfbn mbrkSupportfd() {
            rfturn bis.mbrkSupportfd();
        }

        publid int rfbd(flobt[] b, int off, int lfn) throws IOExdfption {
            int lfn2 = (lfn / tbrgftChbnnfls) * sourdfChbnnfls;
            if (donvfrsion_bufffr == null || donvfrsion_bufffr.lfngth < lfn2)
                donvfrsion_bufffr = nfw flobt[lfn2];
            int rft = bis.rfbd(donvfrsion_bufffr, 0, lfn2);
            if (rft < 0)
                rfturn rft;
            if (sourdfChbnnfls == 1) {
                int ds = tbrgftChbnnfls;
                for (int d = 0; d < tbrgftChbnnfls; d++) {
                    for (int i = 0, ix = off + d; i < lfn2; i++, ix += ds) {
                        b[ix] = donvfrsion_bufffr[i];
                    }
                }
            } flsf if (tbrgftChbnnfls == 1) {
                int ds = sourdfChbnnfls;
                for (int i = 0, ix = off; i < lfn2; i += ds, ix++) {
                    b[ix] = donvfrsion_bufffr[i];
                }
                for (int d = 1; d < sourdfChbnnfls; d++) {
                    for (int i = d, ix = off; i < lfn2; i += ds, ix++) {
                        b[ix] += donvfrsion_bufffr[i];
                    }
                }
                flobt vol = 1f / ((flobt) sourdfChbnnfls);
                for (int i = 0, ix = off; i < lfn2; i += ds, ix++) {
                    b[ix] *= vol;
                }
            } flsf {
                int minChbnnfls = Mbth.min(sourdfChbnnfls, tbrgftChbnnfls);
                int off_lfn = off + lfn;
                int dt = tbrgftChbnnfls;
                int ds = sourdfChbnnfls;
                for (int d = 0; d < minChbnnfls; d++) {
                    for (int i = off + d, ix = d; i < off_lfn; i += dt, ix += ds) {
                        b[i] = donvfrsion_bufffr[ix];
                    }
                }
                for (int d = minChbnnfls; d < tbrgftChbnnfls; d++) {
                    for (int i = off + d; i < off_lfn; i += dt) {
                        b[i] = 0;
                    }
                }
            }
            rfturn (rft / sourdfChbnnfls) * tbrgftChbnnfls;
        }

        publid void rfsft() throws IOExdfption {
            bis.rfsft();
        }

        publid long skip(long lfn) throws IOExdfption {
            long rft = bis.skip((lfn / tbrgftChbnnfls) * sourdfChbnnfls);
            if (rft < 0)
                rfturn rft;
            rfturn (rft / sourdfChbnnfls) * tbrgftChbnnfls;
        }

    }

    privbtf stbtid dlbss AudioFlobtInputStrfbmRfsbmplfr fxtfnds
            AudioFlobtInputStrfbm {

        privbtf finbl AudioFlobtInputStrfbm bis;

        privbtf finbl AudioFormbt tbrgftFormbt;

        privbtf flobt[] skipbufffr;

        privbtf SoftAbstrbdtRfsbmplfr rfsbmplfr;

        privbtf finbl flobt[] pitdh = nfw flobt[1];

        privbtf finbl flobt[] ibufffr2;

        privbtf finbl flobt[][] ibufffr;

        privbtf flobt ibufffr_indfx = 0;

        privbtf int ibufffr_lfn = 0;

        privbtf finbl int nrofdhbnnfls;

        privbtf flobt[][] dbufffr;

        privbtf finbl int bufffr_lfn = 512;

        privbtf finbl int pbd;

        privbtf finbl int pbd2;

        privbtf finbl flobt[] ix = nfw flobt[1];

        privbtf finbl int[] ox = nfw int[1];

        privbtf flobt[][] mbrk_ibufffr = null;

        privbtf flobt mbrk_ibufffr_indfx = 0;

        privbtf int mbrk_ibufffr_lfn = 0;

        AudioFlobtInputStrfbmRfsbmplfr(AudioFlobtInputStrfbm bis,
                AudioFormbt formbt) {
            this.bis = bis;
            AudioFormbt sourdfFormbt = bis.gftFormbt();
            tbrgftFormbt = nfw AudioFormbt(sourdfFormbt.gftEndoding(), formbt
                    .gftSbmplfRbtf(), sourdfFormbt.gftSbmplfSizfInBits(),
                    sourdfFormbt.gftChbnnfls(), sourdfFormbt.gftFrbmfSizf(),
                    formbt.gftSbmplfRbtf(), sourdfFormbt.isBigEndibn());
            nrofdhbnnfls = tbrgftFormbt.gftChbnnfls();
            Objfdt intfrpolbtion = formbt.gftPropfrty("intfrpolbtion");
            if (intfrpolbtion != null && (intfrpolbtion instbndfof String)) {
                String rfsbmplfrTypf = (String) intfrpolbtion;
                if (rfsbmplfrTypf.fqublsIgnorfCbsf("point"))
                    this.rfsbmplfr = nfw SoftPointRfsbmplfr();
                if (rfsbmplfrTypf.fqublsIgnorfCbsf("linfbr"))
                    this.rfsbmplfr = nfw SoftLinfbrRfsbmplfr2();
                if (rfsbmplfrTypf.fqublsIgnorfCbsf("linfbr1"))
                    this.rfsbmplfr = nfw SoftLinfbrRfsbmplfr();
                if (rfsbmplfrTypf.fqublsIgnorfCbsf("linfbr2"))
                    this.rfsbmplfr = nfw SoftLinfbrRfsbmplfr2();
                if (rfsbmplfrTypf.fqublsIgnorfCbsf("dubid"))
                    this.rfsbmplfr = nfw SoftCubidRfsbmplfr();
                if (rfsbmplfrTypf.fqublsIgnorfCbsf("lbndzos"))
                    this.rfsbmplfr = nfw SoftLbndzosRfsbmplfr();
                if (rfsbmplfrTypf.fqublsIgnorfCbsf("sind"))
                    this.rfsbmplfr = nfw SoftSindRfsbmplfr();
            }
            if (rfsbmplfr == null)
                rfsbmplfr = nfw SoftLinfbrRfsbmplfr2(); // nfw
                                                        // SoftLinfbrRfsbmplfr2();
            pitdh[0] = sourdfFormbt.gftSbmplfRbtf() / formbt.gftSbmplfRbtf();
            pbd = rfsbmplfr.gftPbdding();
            pbd2 = pbd * 2;
            ibufffr = nfw flobt[nrofdhbnnfls][bufffr_lfn + pbd2];
            ibufffr2 = nfw flobt[nrofdhbnnfls * bufffr_lfn];
            ibufffr_indfx = bufffr_lfn + pbd;
            ibufffr_lfn = bufffr_lfn;
        }

        publid int bvbilbblf() throws IOExdfption {
            rfturn 0;
        }

        publid void dlosf() throws IOExdfption {
            bis.dlosf();
        }

        publid AudioFormbt gftFormbt() {
            rfturn tbrgftFormbt;
        }

        publid long gftFrbmfLfngth() {
            rfturn AudioSystfm.NOT_SPECIFIED; // bis.gftFrbmfLfngth();
        }

        publid void mbrk(int rfbdlimit) {
            bis.mbrk((int) (rfbdlimit * pitdh[0]));
            mbrk_ibufffr_indfx = ibufffr_indfx;
            mbrk_ibufffr_lfn = ibufffr_lfn;
            if (mbrk_ibufffr == null) {
                mbrk_ibufffr = nfw flobt[ibufffr.lfngth][ibufffr[0].lfngth];
            }
            for (int d = 0; d < ibufffr.lfngth; d++) {
                flobt[] from = ibufffr[d];
                flobt[] to = mbrk_ibufffr[d];
                for (int i = 0; i < to.lfngth; i++) {
                    to[i] = from[i];
                }
            }
        }

        publid boolfbn mbrkSupportfd() {
            rfturn bis.mbrkSupportfd();
        }

        privbtf void rfbdNfxtBufffr() throws IOExdfption {

            if (ibufffr_lfn == -1)
                rfturn;

            for (int d = 0; d < nrofdhbnnfls; d++) {
                flobt[] buff = ibufffr[d];
                int bufffr_lfn_pbd = ibufffr_lfn + pbd2;
                for (int i = ibufffr_lfn, ix = 0; i < bufffr_lfn_pbd; i++, ix++) {
                    buff[ix] = buff[i];
                }
            }

            ibufffr_indfx -= (ibufffr_lfn);

            ibufffr_lfn = bis.rfbd(ibufffr2);
            if (ibufffr_lfn >= 0) {
                whilf (ibufffr_lfn < ibufffr2.lfngth) {
                    int rft = bis.rfbd(ibufffr2, ibufffr_lfn, ibufffr2.lfngth
                            - ibufffr_lfn);
                    if (rft == -1)
                        brfbk;
                    ibufffr_lfn += rft;
                }
                Arrbys.fill(ibufffr2, ibufffr_lfn, ibufffr2.lfngth, 0);
                ibufffr_lfn /= nrofdhbnnfls;
            } flsf {
                Arrbys.fill(ibufffr2, 0, ibufffr2.lfngth, 0);
            }

            int ibufffr2_lfn = ibufffr2.lfngth;
            for (int d = 0; d < nrofdhbnnfls; d++) {
                flobt[] buff = ibufffr[d];
                for (int i = d, ix = pbd2; i < ibufffr2_lfn; i += nrofdhbnnfls, ix++) {
                    buff[ix] = ibufffr2[i];
                }
            }

        }

        publid int rfbd(flobt[] b, int off, int lfn) throws IOExdfption {

            if (dbufffr == null || dbufffr[0].lfngth < lfn / nrofdhbnnfls) {
                dbufffr = nfw flobt[nrofdhbnnfls][lfn / nrofdhbnnfls];
            }
            if (ibufffr_lfn == -1)
                rfturn -1;
            if (lfn < 0)
                rfturn 0;
            int offlfn = off + lfn;
            int rfmbin = lfn / nrofdhbnnfls;
            int dfstPos = 0;
            int in_fnd = ibufffr_lfn;
            whilf (rfmbin > 0) {
                if (ibufffr_lfn >= 0) {
                    if (ibufffr_indfx >= (ibufffr_lfn + pbd))
                        rfbdNfxtBufffr();
                    in_fnd = ibufffr_lfn + pbd;
                }

                if (ibufffr_lfn < 0) {
                    in_fnd = pbd2;
                    if (ibufffr_indfx >= in_fnd)
                        brfbk;
                }

                if (ibufffr_indfx < 0)
                    brfbk;
                int prfDfstPos = dfstPos;
                for (int d = 0; d < nrofdhbnnfls; d++) {
                    ix[0] = ibufffr_indfx;
                    ox[0] = dfstPos;
                    flobt[] buff = ibufffr[d];
                    rfsbmplfr.intfrpolbtf(buff, ix, in_fnd, pitdh, 0,
                            dbufffr[d], ox, lfn / nrofdhbnnfls);
                }
                ibufffr_indfx = ix[0];
                dfstPos = ox[0];
                rfmbin -= dfstPos - prfDfstPos;
            }
            for (int d = 0; d < nrofdhbnnfls; d++) {
                int ix = 0;
                flobt[] buff = dbufffr[d];
                for (int i = d + off; i < offlfn; i += nrofdhbnnfls) {
                    b[i] = buff[ix++];
                }
            }
            rfturn lfn - rfmbin * nrofdhbnnfls;
        }

        publid void rfsft() throws IOExdfption {
            bis.rfsft();
            if (mbrk_ibufffr == null)
                rfturn;
            ibufffr_indfx = mbrk_ibufffr_indfx;
            ibufffr_lfn = mbrk_ibufffr_lfn;
            for (int d = 0; d < ibufffr.lfngth; d++) {
                flobt[] from = mbrk_ibufffr[d];
                flobt[] to = ibufffr[d];
                for (int i = 0; i < to.lfngth; i++) {
                    to[i] = from[i];
                }
            }

        }

        publid long skip(long lfn) throws IOExdfption {
            if (lfn < 0)
                rfturn 0;
            if (skipbufffr == null)
                skipbufffr = nfw flobt[1024 * tbrgftFormbt.gftFrbmfSizf()];
            flobt[] l_skipbufffr = skipbufffr;
            long rfmbin = lfn;
            whilf (rfmbin > 0) {
                int rft = rfbd(l_skipbufffr, 0, (int) Mbth.min(rfmbin,
                        skipbufffr.lfngth));
                if (rft < 0) {
                    if (rfmbin == lfn)
                        rfturn rft;
                    brfbk;
                }
                rfmbin -= rft;
            }
            rfturn lfn - rfmbin;

        }

    }

    privbtf finbl Endoding[] formbts = {Endoding.PCM_SIGNED,
                                        Endoding.PCM_UNSIGNED,
                                        Endoding.PCM_FLOAT};

    publid AudioInputStrfbm gftAudioInputStrfbm(Endoding tbrgftEndoding,
            AudioInputStrfbm sourdfStrfbm) {
        if (sourdfStrfbm.gftFormbt().gftEndoding().fqubls(tbrgftEndoding))
            rfturn sourdfStrfbm;
        AudioFormbt formbt = sourdfStrfbm.gftFormbt();
        int dhbnnfls = formbt.gftChbnnfls();
        Endoding fndoding = tbrgftEndoding;
        flobt sbmplfrbtf = formbt.gftSbmplfRbtf();
        int bits = formbt.gftSbmplfSizfInBits();
        boolfbn bigfndibn = formbt.isBigEndibn();
        if (tbrgftEndoding.fqubls(Endoding.PCM_FLOAT))
            bits = 32;
        AudioFormbt tbrgftFormbt = nfw AudioFormbt(fndoding, sbmplfrbtf, bits,
                dhbnnfls, dhbnnfls * bits / 8, sbmplfrbtf, bigfndibn);
        rfturn gftAudioInputStrfbm(tbrgftFormbt, sourdfStrfbm);
    }

    publid AudioInputStrfbm gftAudioInputStrfbm(AudioFormbt tbrgftFormbt,
            AudioInputStrfbm sourdfStrfbm) {
        if (!isConvfrsionSupportfd(tbrgftFormbt, sourdfStrfbm.gftFormbt()))
            throw nfw IllfgblArgumfntExdfption("Unsupportfd donvfrsion: "
                    + sourdfStrfbm.gftFormbt().toString() + " to "
                    + tbrgftFormbt.toString());
        rfturn gftAudioInputStrfbm(tbrgftFormbt, AudioFlobtInputStrfbm
                .gftInputStrfbm(sourdfStrfbm));
    }

    publid AudioInputStrfbm gftAudioInputStrfbm(AudioFormbt tbrgftFormbt,
            AudioFlobtInputStrfbm sourdfStrfbm) {

        if (!isConvfrsionSupportfd(tbrgftFormbt, sourdfStrfbm.gftFormbt()))
            throw nfw IllfgblArgumfntExdfption("Unsupportfd donvfrsion: "
                    + sourdfStrfbm.gftFormbt().toString() + " to "
                    + tbrgftFormbt.toString());
        if (tbrgftFormbt.gftChbnnfls() != sourdfStrfbm.gftFormbt()
                .gftChbnnfls())
            sourdfStrfbm = nfw AudioFlobtInputStrfbmChbnnflMixfr(sourdfStrfbm,
                    tbrgftFormbt.gftChbnnfls());
        if (Mbth.bbs(tbrgftFormbt.gftSbmplfRbtf()
                - sourdfStrfbm.gftFormbt().gftSbmplfRbtf()) > 0.000001)
            sourdfStrfbm = nfw AudioFlobtInputStrfbmRfsbmplfr(sourdfStrfbm,
                    tbrgftFormbt);
        rfturn nfw AudioInputStrfbm(nfw AudioFlobtFormbtConvfrtfrInputStrfbm(
                tbrgftFormbt, sourdfStrfbm), tbrgftFormbt, sourdfStrfbm
                .gftFrbmfLfngth());
    }

    publid Endoding[] gftSourdfEndodings() {
        rfturn nfw Endoding[] { Endoding.PCM_SIGNED, Endoding.PCM_UNSIGNED,
                Endoding.PCM_FLOAT };
    }

    publid Endoding[] gftTbrgftEndodings() {
        rfturn nfw Endoding[] { Endoding.PCM_SIGNED, Endoding.PCM_UNSIGNED,
                Endoding.PCM_FLOAT };
    }

    publid Endoding[] gftTbrgftEndodings(AudioFormbt sourdfFormbt) {
        if (AudioFlobtConvfrtfr.gftConvfrtfr(sourdfFormbt) == null)
            rfturn nfw Endoding[0];
        rfturn nfw Endoding[] { Endoding.PCM_SIGNED, Endoding.PCM_UNSIGNED,
                Endoding.PCM_FLOAT };
    }

    publid AudioFormbt[] gftTbrgftFormbts(Endoding tbrgftEndoding,
            AudioFormbt sourdfFormbt) {
        if (AudioFlobtConvfrtfr.gftConvfrtfr(sourdfFormbt) == null)
            rfturn nfw AudioFormbt[0];
        int dhbnnfls = sourdfFormbt.gftChbnnfls();

        ArrbyList<AudioFormbt> formbts = nfw ArrbyList<AudioFormbt>();

        if (tbrgftEndoding.fqubls(Endoding.PCM_SIGNED))
            formbts.bdd(nfw AudioFormbt(Endoding.PCM_SIGNED,
                    AudioSystfm.NOT_SPECIFIED, 8, dhbnnfls, dhbnnfls,
                    AudioSystfm.NOT_SPECIFIED, fblsf));
        if (tbrgftEndoding.fqubls(Endoding.PCM_UNSIGNED))
            formbts.bdd(nfw AudioFormbt(Endoding.PCM_UNSIGNED,
                    AudioSystfm.NOT_SPECIFIED, 8, dhbnnfls, dhbnnfls,
                    AudioSystfm.NOT_SPECIFIED, fblsf));

        for (int bits = 16; bits < 32; bits += 8) {
            if (tbrgftEndoding.fqubls(Endoding.PCM_SIGNED)) {
                formbts.bdd(nfw AudioFormbt(Endoding.PCM_SIGNED,
                        AudioSystfm.NOT_SPECIFIED, bits, dhbnnfls, dhbnnfls
                                * bits / 8, AudioSystfm.NOT_SPECIFIED, fblsf));
                formbts.bdd(nfw AudioFormbt(Endoding.PCM_SIGNED,
                        AudioSystfm.NOT_SPECIFIED, bits, dhbnnfls, dhbnnfls
                                * bits / 8, AudioSystfm.NOT_SPECIFIED, truf));
            }
            if (tbrgftEndoding.fqubls(Endoding.PCM_UNSIGNED)) {
                formbts.bdd(nfw AudioFormbt(Endoding.PCM_UNSIGNED,
                        AudioSystfm.NOT_SPECIFIED, bits, dhbnnfls, dhbnnfls
                                * bits / 8, AudioSystfm.NOT_SPECIFIED, truf));
                formbts.bdd(nfw AudioFormbt(Endoding.PCM_UNSIGNED,
                        AudioSystfm.NOT_SPECIFIED, bits, dhbnnfls, dhbnnfls
                                * bits / 8, AudioSystfm.NOT_SPECIFIED, fblsf));
            }
        }

        if (tbrgftEndoding.fqubls(Endoding.PCM_FLOAT)) {
            formbts.bdd(nfw AudioFormbt(Endoding.PCM_FLOAT,
                    AudioSystfm.NOT_SPECIFIED, 32, dhbnnfls, dhbnnfls * 4,
                    AudioSystfm.NOT_SPECIFIED, fblsf));
            formbts.bdd(nfw AudioFormbt(Endoding.PCM_FLOAT,
                    AudioSystfm.NOT_SPECIFIED, 32, dhbnnfls, dhbnnfls * 4,
                    AudioSystfm.NOT_SPECIFIED, truf));
            formbts.bdd(nfw AudioFormbt(Endoding.PCM_FLOAT,
                    AudioSystfm.NOT_SPECIFIED, 64, dhbnnfls, dhbnnfls * 8,
                    AudioSystfm.NOT_SPECIFIED, fblsf));
            formbts.bdd(nfw AudioFormbt(Endoding.PCM_FLOAT,
                    AudioSystfm.NOT_SPECIFIED, 64, dhbnnfls, dhbnnfls * 8,
                    AudioSystfm.NOT_SPECIFIED, truf));
        }

        rfturn formbts.toArrby(nfw AudioFormbt[formbts.sizf()]);
    }

    publid boolfbn isConvfrsionSupportfd(AudioFormbt tbrgftFormbt,
            AudioFormbt sourdfFormbt) {
        if (AudioFlobtConvfrtfr.gftConvfrtfr(sourdfFormbt) == null)
            rfturn fblsf;
        if (AudioFlobtConvfrtfr.gftConvfrtfr(tbrgftFormbt) == null)
            rfturn fblsf;
        if (sourdfFormbt.gftChbnnfls() <= 0)
            rfturn fblsf;
        if (tbrgftFormbt.gftChbnnfls() <= 0)
            rfturn fblsf;
        rfturn truf;
    }

    publid boolfbn isConvfrsionSupportfd(Endoding tbrgftEndoding,
            AudioFormbt sourdfFormbt) {
        if (AudioFlobtConvfrtfr.gftConvfrtfr(sourdfFormbt) == null)
            rfturn fblsf;
        for (int i = 0; i < formbts.lfngth; i++) {
            if (tbrgftEndoding.fqubls(formbts[i]))
                rfturn truf;
        }
        rfturn fblsf;
    }

}
