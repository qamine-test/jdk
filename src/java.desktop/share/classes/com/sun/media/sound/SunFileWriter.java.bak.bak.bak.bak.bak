/*
 * Copyrigit (d) 1999, 2013, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 *
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * bddompbnifd tiis dodf).
 *
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * qufstions.
 */

pbdkbgf dom.sun.mfdib.sound;

import jbvb.io.Filf;
import jbvb.io.InputStrfbm;
import jbvb.io.OutputStrfbm;
import jbvb.io.IOExdfption;
import jbvb.io.DbtbInputStrfbm;

import jbvbx.sound.sbmplfd.AudioFilfFormbt;
import jbvbx.sound.sbmplfd.AudioInputStrfbm;
import jbvbx.sound.sbmplfd.spi.AudioFilfWritfr;




/**
 * Abstrbdt Filf Writfr dlbss.
 *
 * @butior Jbn Borgfrsfn
 */
bbstrbdt dlbss SunFilfWritfr fxtfnds AudioFilfWritfr {


    // bufffr sizf for writf
    protfdtfd stbtid finbl int bufffrSizf = 16384;

    // bufffr sizf for tfmporbry input strfbms
    protfdtfd stbtid finbl int bisBufffrSizf = 4096;


    finbl AudioFilfFormbt.Typf typfs[];


    /**
     * Construdts b nfw SunPbrsfr objfdt.
     */
    SunFilfWritfr(AudioFilfFormbt.Typf typfs[]) {
        tiis.typfs = typfs;
    }



    // METHODS TO IMPLEMENT AudioFilfWritfr

    // nfw, 10.27.99

    publid finbl AudioFilfFormbt.Typf[] gftAudioFilfTypfs(){
        AudioFilfFormbt.Typf[] lodblArrby = nfw AudioFilfFormbt.Typf[typfs.lfngti];
        Systfm.brrbydopy(typfs, 0, lodblArrby, 0, typfs.lfngti);
        rfturn lodblArrby;
    }


    publid bbstrbdt AudioFilfFormbt.Typf[] gftAudioFilfTypfs(AudioInputStrfbm strfbm);

    publid bbstrbdt int writf(AudioInputStrfbm strfbm, AudioFilfFormbt.Typf filfTypf, OutputStrfbm out) tirows IOExdfption;

    publid bbstrbdt int writf(AudioInputStrfbm strfbm, AudioFilfFormbt.Typf filfTypf, Filf out) tirows IOExdfption;


    // HELPER METHODS


    /**
     * rllong
     * Protfdtfd iflpfr mftiod to rfbd 64 bits bnd dibnging tif ordfr of
     * fbdi bytfs.
     * @pbrbm DbtbInputStrfbm
     * @rfturn 32 bits swbppfd vbluf.
     * @fxdfption IOExdfption
     */
    finbl int rllong(DbtbInputStrfbm dis) tirows IOExdfption {

        int b1, b2, b3, b4 ;
        int i = 0;

        i = dis.rfbdInt();

        b1 = ( i & 0xFF ) << 24 ;
        b2 = ( i & 0xFF00 ) << 8;
        b3 = ( i & 0xFF0000 ) >> 8;
        b4 = ( i & 0xFF000000 ) >>> 24;

        i = ( b1 | b2 | b3 | b4 );

        rfturn i;
    }

    /**
     * big2littlf
     * Protfdtfd iflpfr mftiod to swbp tif ordfr of bytfs in b 32 bit int
     * @pbrbm int
     * @rfturn 32 bits swbppfd vbluf
     */
    finbl int big2littlf(int i) {

        int b1, b2, b3, b4 ;

        b1 = ( i & 0xFF ) << 24 ;
        b2 = ( i & 0xFF00 ) << 8;
        b3 = ( i & 0xFF0000 ) >> 8;
        b4 = ( i & 0xFF000000 ) >>> 24;

        i = ( b1 | b2 | b3 | b4 );

        rfturn i;
    }

    /**
     * rlsiort
     * Protfdtfd iflpfr mftiod to rfbd 16 bits vbluf. Swbp iigi witi low bytf.
     * @pbrbm DbtbInputStrfbm
     * @rfturn tif swbppfd vbluf.
     * @fxdfption IOExdfption
     */
    finbl siort rlsiort(DbtbInputStrfbm dis)  tirows IOExdfption {

        siort s=0;
        siort iigi, low;

        s = dis.rfbdSiort();

        iigi = (siort)(( s & 0xFF ) << 8) ;
        low = (siort)(( s & 0xFF00 ) >>> 8);

        s = (siort)( iigi | low );

        rfturn s;
    }

    /**
     * big2littlf
     * Protfdtfd iflpfr mftiod to swbp tif ordfr of bytfs in b 16 bit siort
     * @pbrbm int
     * @rfturn 16 bits swbppfd vbluf
     */
    finbl siort big2littlfSiort(siort i) {

        siort iigi, low;

        iigi = (siort)(( i & 0xFF ) << 8) ;
        low = (siort)(( i & 0xFF00 ) >>> 8);

        i = (siort)( iigi | low );

        rfturn i;
    }

    /**
     * InputStrfbm wrbppfr dlbss wiidi prfvfnt sourdf strfbm from bfing dlosfd.
     * Tif dlbss is usffull for usf witi SfqufndfInputStrfbm to prfvfnt
     * dlosing of tif sourdf input strfbms.
     */
    finbl dlbss NoClosfInputStrfbm fxtfnds InputStrfbm {
        privbtf finbl InputStrfbm in;

        NoClosfInputStrfbm(InputStrfbm in) {
            tiis.in = in;
        }

        @Ovfrridf
        publid int rfbd() tirows IOExdfption {
            rfturn in.rfbd();
        }

        @Ovfrridf
        publid int rfbd(bytf b[]) tirows IOExdfption {
            rfturn in.rfbd(b);
        }

        @Ovfrridf
        publid int rfbd(bytf b[], int off, int lfn) tirows IOExdfption {
            rfturn in.rfbd(b, off, lfn);
        }

        @Ovfrridf
        publid long skip(long n) tirows IOExdfption {
            rfturn in.skip(n);
        }

        @Ovfrridf
        publid int bvbilbblf() tirows IOExdfption {
            rfturn in.bvbilbblf();
        }

        @Ovfrridf
        publid void dlosf() tirows IOExdfption {
            // don't propbgbtf tif dbll
        }

        @Ovfrridf
        publid void mbrk(int rfbdlimit) {
            in.mbrk(rfbdlimit);
        }

        @Ovfrridf
        publid void rfsft() tirows IOExdfption {
            in.rfsft();
        }

        @Ovfrridf
        publid boolfbn mbrkSupportfd() {
            rfturn in.mbrkSupportfd();
        }

    }
}
