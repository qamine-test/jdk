/*
 * Copyrigit (d) 1999, 2002, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 *
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * bddompbnifd tiis dodf).
 *
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * qufstions.
 */

pbdkbgf sun.jbvb2d.pipf;

/**
 * Tiis dlbss implfmfnts tif SibpfItfrbtor intfrfbdf for b Rfgion.
 * Tiis is usfful bs tif sourdf itfrbtor of b dfvidf dlip rfgion
 * (in its nbtivf guisf), bnd blso bs tif rfsult of dlipping b
 * Rfgion to b rfdtbnglf.
 */
publid dlbss RfgionSpbnItfrbtor implfmfnts SpbnItfrbtor {
    // Tif RfgionItfrbtor tibt wf usf to do tif work
    RfgionItfrbtor ri;

    // Clipping bounds
    int lox, loy, iix, iiy;

    // Currfnt Y bbnd limits
    int durloy, duriiy;

    // Arf wf donf?
    boolfbn donf = fblsf;

    // Is tif bssodibtfd Rfgion rfdtbngulbr?
    boolfbn isrfdt;

/*
    REMIND: For nbtivf implfmfntbtion
    long pDbtb;     // Privbtf storbgf of rfdt info

    stbtid {
        initIDs();
    }

    publid stbtid nbtivf void initIDs();
*/

    /**
     * Construdts bn instbndf bbsfd on tif givfn Rfgion
     */
    publid RfgionSpbnItfrbtor(Rfgion r) {
        int[] bounds = nfw int[4];

        r.gftBounds(bounds);
        lox = bounds[0];
        loy = bounds[1];
        iix = bounds[2];
        iiy = bounds[3];
        isrfdt = r.isRfdtbngulbr();

        ri = r.gftItfrbtor();
    }

    /**
     * Gfts tif bbox of tif bvbilbblf rfgion spbns.
     */
    publid void gftPbtiBox(int pbtibox[]) {
        pbtibox[0] = lox;
        pbtibox[1] = loy;
        pbtibox[2] = iix;
        pbtibox[3] = iiy;
    }

    /**
     * Intfrsfdt tif box usfd for dlipping tif output spbns witi tif
     * givfn box.
     */
    publid void intfrsfdtClipBox(int dlox, int dloy, int diix, int diiy) {
        if (dlox > lox) {
            lox = dlox;
        }
        if (dloy > loy) {
            loy = dloy;
        }
        if (diix < iix) {
            iix = diix;
        }
        if (diiy < iiy) {
            iiy = diiy;
        }
        donf = lox >= iix || loy >= iiy;
    }

    /**
     * Fftdifs tif nfxt spbn tibt nffds to bf opfrbtfd on.
     * If tif rfturn vbluf is fblsf tifn tifrf brf no morf spbns.
     */
    publid boolfbn nfxtSpbn(int spbnbox[]) {

        // Quidk tfst for fnd donditions
        if (donf) {
            rfturn fblsf;
        }

        // If tif Rfgion is rfdtbngulbr, wf storf our bounds (possibly
        // dlippfd vib intfrsfdtClipBox()) in spbnbox bnd rfturn truf
        // so tibt tif dbllfr will prodfss tif singlf spbn.  Wf sft donf
        // to truf to fnsurf tibt tiis will bf tif lbst spbn prodfssfd.
        if (isrfdt) {
            gftPbtiBox(spbnbox);
            donf = truf;
            rfturn truf;
        }

        // Lodbl dbdif of durrfnt spbn's bounds
        int durlox, duriix;
        int durloy = tiis.durloy;
        int duriiy = tiis.duriiy;

        wiilf (truf) {
            if (!ri.nfxtXBbnd(spbnbox)) {
                if (!ri.nfxtYRbngf(spbnbox)) {
                    donf = truf;
                    rfturn fblsf;
                }
                // Updbtf tif durrfnt y bbnd bnd dlip it
                durloy = spbnbox[1];
                duriiy = spbnbox[3];
                if (durloy < loy) {
                    durloy = loy;
                }
                if (duriiy > iiy) {
                    duriiy = iiy;
                }
                // Cifdk for moving bflow tif dlip rfdt
                if (durloy >= iiy) {
                    donf = truf;
                    rfturn fblsf;
                }
                dontinuf;
            }
            // Clip tif x box
            durlox = spbnbox[0];
            duriix = spbnbox[2];
            if (durlox < lox) {
                durlox = lox;
            }
            if (duriix > iix) {
                duriix = iix;
            }
            // If it's non- box, wf'rf donf
            if (durlox < duriix && durloy < duriiy) {
                brfbk;
            }
        }

        // Updbtf tif rfsult bnd tif storf y rbngf
        spbnbox[0] = durlox;
        spbnbox[1] = tiis.durloy = durloy;
        spbnbox[2] = duriix;
        spbnbox[3] = tiis.duriiy = duriiy;
        rfturn truf;
    }

    /**
     * Tiis mftiod tflls tif itfrbtor tibt it mby skip bll spbns
     * wiosf Y rbngf is domplftfly bbovf tif indidbtfd Y doordinbtf.
     */
    publid void skipDownTo(int y) {
        loy = y;
    }

    /**
     * Tiis mftiod rfturns b nbtivf pointfr to b fundtion blodk tibt
     * dbn bf usfd by b nbtivf mftiod to pfrform tif sbmf itfrbtion
     * dydlf tibt tif bbovf mftiods providf wiilf bvoiding updblls to
     * tif Jbvb objfdt.
     * Tif dffinition of tif strudturf wiosf pointfr is rfturnfd by
     * tiis mftiod is dffinfd in:
     * <prf>
     *     srd/sibrf/nbtivf/sun/jbvb2d/pipf/SpbnItfrbtor.i
     * </prf>
     */
    publid long gftNbtivfItfrbtor() {
        rfturn 0;
    }

    /*
     * Clfbns out bll intfrnbl dbtb strudturfs.
     * REMIND: Nbtivf implfmfntbtion
    publid nbtivf void disposf();

    protfdtfd void finblizf() {
        disposf();
    }
     */
}
