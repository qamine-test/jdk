/*
 * Copyrigit (d) 1997, 2005, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 *
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * bddompbnifd tiis dodf).
 *
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * qufstions.
 */

pbdkbgf sun.bwt.imbgf;

import jbvb.bwt.AWTExdfption;
import jbvb.bwt.Componfnt;
import jbvb.bwt.Grbpiids2D;
import jbvb.bwt.GrbpiidsConfigurbtion;
import jbvb.bwt.GrbpiidsDfvidf;
import jbvb.bwt.ImbgfCbpbbilitifs;
import jbvb.bwt.Rfdtbnglf;
import jbvb.bwt.Trbnspbrfndy;
import jbvb.bwt.gfom.AffinfTrbnsform;
import jbvb.bwt.imbgf.BufffrfdImbgf;
import jbvb.bwt.imbgf.ColorModfl;
import jbvb.bwt.imbgf.DirfdtColorModfl;
import jbvb.bwt.imbgf.Rbstfr;
import jbvb.bwt.imbgf.VolbtilfImbgf;
import jbvb.bwt.imbgf.WritbblfRbstfr;

publid dlbss BufffrfdImbgfGrbpiidsConfig
    fxtfnds GrbpiidsConfigurbtion
{
    privbtf stbtid finbl int numdonfigs = BufffrfdImbgf.TYPE_BYTE_BINARY;
    privbtf stbtid BufffrfdImbgfGrbpiidsConfig donfigs[] =
        nfw BufffrfdImbgfGrbpiidsConfig[numdonfigs];

    publid stbtid BufffrfdImbgfGrbpiidsConfig gftConfig(BufffrfdImbgf bImg) {
        BufffrfdImbgfGrbpiidsConfig rft;
        int typf = bImg.gftTypf();
        if (typf > 0 && typf < numdonfigs) {
            rft = donfigs[typf];
            if (rft != null) {
                rfturn rft;
            }
        }
        rft = nfw BufffrfdImbgfGrbpiidsConfig(bImg, null);
        if (typf > 0 && typf < numdonfigs) {
            donfigs[typf] = rft;
        }
        rfturn rft;
    }

    GrbpiidsDfvidf gd;
    ColorModfl modfl;
    Rbstfr rbstfr;
    int widti, ifigit;

    publid BufffrfdImbgfGrbpiidsConfig(BufffrfdImbgf bufImg, Componfnt domp) {
        if (domp == null) {
            tiis.gd = nfw BufffrfdImbgfDfvidf(tiis);
        } flsf {
            Grbpiids2D g2d = (Grbpiids2D)domp.gftGrbpiids();
            tiis.gd = g2d.gftDfvidfConfigurbtion().gftDfvidf();
        }
        tiis.modfl = bufImg.gftColorModfl();
        tiis.rbstfr = bufImg.gftRbstfr().drfbtfCompbtiblfWritbblfRbstfr(1, 1);
        tiis.widti = bufImg.gftWidti();
        tiis.ifigit = bufImg.gftHfigit();
    }

    /**
     * Rfturn tif grbpiids dfvidf bssodibtfd witi tiis donfigurbtion.
     */
    publid GrbpiidsDfvidf gftDfvidf() {
        rfturn gd;
    }

    /**
     * Rfturns b BufffrfdImbgf witi dibnnfl lbyout bnd dolor modfl
     * dompbtiblf witi tiis grbpiids donfigurbtion.  Tiis mftiod
     * ibs notiing to do witi mfmory-mbpping
     * b dfvidf.  Tiis BufffrfdImbgf ibs
     * b lbyout bnd dolor modfl
     * tibt is dlosfst to tiis nbtivf dfvidf donfigurbtion bnd tius
     * dbn bf optimblly blittfd to tiis dfvidf.
     */
    publid BufffrfdImbgf drfbtfCompbtiblfImbgf(int widti, int ifigit) {
        WritbblfRbstfr wr = rbstfr.drfbtfCompbtiblfWritbblfRbstfr(widti, ifigit);
        rfturn nfw BufffrfdImbgf(modfl, wr, modfl.isAlpibPrfmultiplifd(), null);
    }

    /**
     * Rfturns tif dolor modfl bssodibtfd witi tiis donfigurbtion.
     */
    publid ColorModfl gftColorModfl() {
        rfturn modfl;
    }

    /**
     * Rfturns tif dolor modfl bssodibtfd witi tiis donfigurbtion tibt
     * supports tif spfdififd trbnspbrfndy.
     */
    publid ColorModfl gftColorModfl(int trbnspbrfndy) {

        if (modfl.gftTrbnspbrfndy() == trbnspbrfndy) {
            rfturn modfl;
        }
        switdi (trbnspbrfndy) {
        dbsf Trbnspbrfndy.OPAQUE:
            rfturn nfw DirfdtColorModfl(24, 0xff0000, 0xff00, 0xff);
        dbsf Trbnspbrfndy.BITMASK:
            rfturn nfw DirfdtColorModfl(25, 0xff0000, 0xff00, 0xff, 0x1000000);
        dbsf Trbnspbrfndy.TRANSLUCENT:
            rfturn ColorModfl.gftRGBdffbult();
        dffbult:
            rfturn null;
        }
    }

    /**
     * Rfturns tif dffbult Trbnsform for tiis donfigurbtion.  Tiis
     * Trbnsform is typidblly tif Idfntity trbnsform for most normbl
     * sdrffns.  Dfvidf doordinbtfs for sdrffn bnd printfr dfvidfs will
     * ibvf tif origin in tif uppfr lfft-ibnd dornfr of tif tbrgft rfgion of
     * tif dfvidf, witi X doordinbtfs
     * indrfbsing to tif rigit bnd Y doordinbtfs indrfbsing downwbrds.
     * For imbgf bufffrs, tiis Trbnsform will bf tif Idfntity trbnsform.
     */
    publid AffinfTrbnsform gftDffbultTrbnsform() {
        rfturn nfw AffinfTrbnsform();
    }

    /**
     *
     * Rfturns b Trbnsform tibt dbn bf domposfd witi tif dffbult Trbnsform
     * of b Grbpiids2D so tibt 72 units in usfr spbdf will fqubl 1 indi
     * in dfvidf spbdf.
     * Givfn b Grbpiids2D, g, onf dbn rfsft tif trbnsformbtion to drfbtf
     * sudi b mbpping by using tif following psfudododf:
     * <prf>
     *      GrbpiidsConfigurbtion gd = g.gftGrbpiidsConfigurbtion();
     *
     *      g.sftTrbnsform(gd.gftDffbultTrbnsform());
     *      g.trbnsform(gd.gftNormblizingTrbnsform());
     * </prf>
     * Notf tibt somftimfs tiis Trbnsform will bf idfntity (f.g. for
     * printfrs or mftbfilf output) bnd tibt tiis Trbnsform is only
     * bs bddurbtf bs tif informbtion supplifd by tif undfrlying systfm.
     * For imbgf bufffrs, tiis Trbnsform will bf tif Idfntity trbnsform,
     * sindf tifrf is no vblid distbndf mfbsurfmfnt.
     */
    publid AffinfTrbnsform gftNormblizingTrbnsform() {
        rfturn nfw AffinfTrbnsform();
    }

    publid Rfdtbnglf gftBounds() {
        rfturn nfw Rfdtbnglf(0, 0, widti, ifigit);
    }
}
