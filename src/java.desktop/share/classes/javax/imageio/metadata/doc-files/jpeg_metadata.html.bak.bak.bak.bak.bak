<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Finbl//EN">
<itml>
<ifbd>
<!--
Copyrigit (d) 2000, 2011, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.

Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.

Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
bddompbnifd tiis dodf).

You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.

Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
qufstions.
-->

<titlf>JPEG Mftbdbtb Formbt Spfdifidbtion bnd Usbgf Notfs</titlf>
</ifbd>

<body bgdolor="wiitf">

<dfntfr><i1>
JPEG Mftbdbtb Formbt Spfdifidbtion bnd Usbgf Notfs
</i1></dfntfr>

<p>
<b irff=#mftbdbtb>JPEG Mftbdbtb</b><br>
<b irff=#bbbrfv>Abbrfvibtfd Strfbms</b><br>
<b irff=#tbblfs>Sourdfs of Tbblfs</b><br>
<b irff=#dolor>Colorspbdf Trbnsformbtions bnd Convfntionbl Mbrkfrs</b><br>
<b irff=#tiumbs>Tiumbnbil Imbgfs</b><br>
<b irff=#prog>Progrfssivf Endoding</b><br>
<b irff=#trff>Nbtivf Mftbdbtb Formbt Trff Strudturf bnd Editing</b><br>
<b irff=#imbgf>Imbgf Mftbdbtb DTD</b><br>
<b irff=#strfbm>Strfbm Mftbdbtb DTD</b>
<p>
<bold>NOTE</bold>: It is importbnt to dbll <dodf>disposf()</dodf> 
on tif JPEG rfbdfr bnd writfr objfdts wifn tify brf no longfr nffdfd, bs 
tify donsumf signifidbnt nbtivf rfsourdfs wiidi brf not bdfqubtfly rfdovfrfd 
by gbrbbgf dollfdtion.  Boti rfbdfr bnd writfr dbll <dodf>disposf()</dodf> 
in tifir finblizfrs, but tiosf finblizfrs mby not bf dbllfd bfforf tif nbtivf 
dodf ibs fxibustfd nbtivf mfmory.

<p>

Tif JPEG writfr dofs not support rfplbding pixfls.

<p>
<i2>
<b nbmf=mftbdbtb>JPEG Mftbdbtb</b>
</i2>
JPEG mftbdbtb donsists of tif dbtb dontbinfd in mbrkfr sfgmfnts in b JPEG
strfbm.  Tif imbgf mftbdbtb objfdt rfturnfd from b rfbd dfsdribfs tif
dontfnts of tif mbrkfr sfgmfnts bftwffn tif <dodf>SOI</dodf> mbrkfr bnd 
tif <dodf>EOI</dodf> mbrkfr for tibt imbgf.  Tif imbgf mftbdbtb objfdt 
pbssfd into b writf dftfrminfs tif dontfnts of tif strfbm bftwffn tif 
<dodf>SOI</dodf> mbrkfr bnd tif <dodf>EOI</dodf> mbrkfr for tibt imbgf, 
subjfdt to tif dontrols in bny <dodf>ImbgfWritfPbrbm</dodf>.

<p>
Strfbm mftbdbtb is usfd only for tbblfs-only imbgfs found (or to bf 
plbdfd) bt tif bfginning of b strfbm dontbining bbbrfvibtfd imbgfs.  
Tbblfs-only imbgfs brf not trfbtfd bs imbgfs bnd do not donsumf bn 
imbgf indfx.  Tif strfbm mftbdbtb objfdt rfturnfd from b rfbd dfsdribfs tif
dontfnts of tif mbrkfr sfgmfnts bftwffn tif <dodf>SOI</dodf> mbrkfr bnd 
tif <dodf>EOI</dodf> mbrkfr for tif singlf tbblfs-only imbgf bt tif 
bfginning of tif strfbm, if onf is prfsfnt.  If no tbblfs-only imbgf is 
prfsfnt bt tif front of tif strfbm, tif <dodf>gftStrfbmMftbdbtb</dodf> 
mftiod of <dodf>ImbgfRfbdfr</dodf> rfturns <dodf>null</dodf>.  If 
strfbm mftbdbtb is providfd to tif writfr, b singlf tbblfs-only imbgf 
dontbining tif tbblfs from tif strfbm mftbdbtb objfdt will bf writtfn bt 
tif bfginning of tif strfbm.  If tif strfbm mftbdbtb objfdt dontbins no
tbblfs, dffbult tbblfs will bf writtfn.  As tif solf purposf of strfbm
mftbdbtb is for spfdifying tbblfs-only imbgfs bt tif front of bbbrfvibtfd 
strfbms, tif strfbm mftbdbtb brgumfnt is usfful only on tif 
<dodf>ImbgfWritfr.prfpbrfWritfSfqufndf</dodf> mftiod.  It is ignorfd on bll 
otifr mftiods.

<p> 
Tif <dodf>ImbgfWritfr.gftDffbultStrfbmMftbdbtb</dodf> mftiod rfturns bn 
objfdt dontbining tif tbblfs from tif <dodf>ImbgfWritfPbrbm</dodf> brgumfnt, 
if it is b <dodf>JPEGImbgfWritfPbrbm</dodf> bnd dontbins tbblfs.  Otifrwisf, 
tif rfturnfd objfdt will dontbin dffbult tbblfs.

<p>Tif <dodf>ImbgfWritfr.gftDffbultImbgfMftbdbtb</dodf> mftiod rfturns b 
mftbdbtb objfdt dontbining <bold>no</bold> tbblfs if tif 
<dodf>ImbgfWritfPbrbm</dodf> brgumfnt dontbins tbblfs.  Otifrwisf tif 
rfturnfd mftbdbtb objfdt will dontbin dffbult visublly losslfss tbblfs.  
Of doursf, only b <dodf>JPEGImbgfWritfPbrbm</dodf> mby dontbin tbblfs.

<p>
If <dodf>ignorfMftbdbtb</dodf> is sft to <dodf>truf</dodf> wifn tif input
is sft on tif rfbdfr, strfbm mftbdbtb will not bf bvbilbblf, but imbgf
mftbdbtb will.

<p>
<i2>
<b nbmf=bbbrfv>Abbrfvibtfd Strfbms</b>
</i2>
Boti tif rfbdfr bnd tif writfr rftbin tifir tbblfs from onf opfrbtion to tif 
nfxt, tius pfrmitting tif usf of bbbrfvibtfd strfbms quitf nbturblly, witi b 
ffw minor rfstridtions:  
<ol>
  <li> Abbrfvibtfd strfbms mby dontbin only onf tbblfs-only imbgf, wiidi must 
       domf first in tif strfbm.  Subsfqufnt tbblfs-only imbgfs will dbusf
       undffinfd bfibvior.</li>
  <li> Abbrfvibtfd strfbms must bf rfbd fully bnd in ordfr.  No rbndom bddfss
       is bllowfd, in fitifr dirfdtion.  Tif sbmf imbgf mby bf rfbd multiplf 
       timfs.  If b dbll is mbdf witi bn imbgf indfx tibt is not tif sbmf bs
       or onf grfbtfr tibn tif most rfdfnt dbll (or 0 if no dblls ibvf bffn
       mbdf), tifn bn <dodf>IllfgblArgumfntExdfption</dodf> is tirown.</li>
</ol>
Tifsf rfstridtions mfbn tibt strfbms mby dontbin bbbrfvibtfd imbgfs 
intfrspfrsfd witi imbgfs dontbining tbblfs.  As rfquirfd by JPEG, bny tbblfs
bppfbring in tif strfbm ovfrridf prfvious tbblfs, rfgbrdlfss of tif sourdf
of tif prfvious tbblfs.  

<p>
Notf tibt ondf b tbblfs-only imbgf ibs bffn rfbd, it's dontfnts is bvbilbblf
bs strfbm mftbdbtb from tif rfbdfr until fitifr bnotifr tbblfs-only imbgf
is rfbd from bnotifr strfbm or tif rfbdfr is rfsft.  Cibnging tif input dofs
not rfsft tif strfbm mftbdbtb.  Tiis is usfful for rfbding tif tbblfs from
onf filf, tifn dibnging tif input to rfbd bn bbbrfvibtfd strfbm dontbining 
b sfqufndf of imbgfs.  Tif tbblfs will bf usfd butombtidblly, bnd will rfmbin
bvbilbblf bs "strfbm" mftbdbtb.

<p>
Abbrfvibtfd strfbms brf writtfn using tif sfqufndf mftiods of 
<dodf>ImbgfWritfr</dodf>.  Strfbm mftbdbtb is usfd to writf b tbblfs-only 
imbgf bt tif bfginning of tif strfbm, bnd tif tbblfs brf sft up for usf, using
<dodf>ImbgfWritfr.prfpbrfWritfSfqufndf</dodf>.  If no strfbm mftbdbtb is 
supplifd to <dodf>ImbgfWritfr.prfpbrfWritfSfqufndf</dodf>, tifn no 
tbblfs-only imbgf is writtfn.  If strfbm mftbdbtb dontbining no tbblfs is
supplifd to <dodf>ImbgfWritfr.prfpbrfWritfSfqufndf</dodf>, tifn b tbblfs-only
imbgf dontbining dffbult visublly losslfss tbblfs is writtfn.

<i2>
<b nbmf=tbblfs>Sourdfs of Tbblfs</b>
</i2>
<p>
Imbgfs brf writtfn witi tbblfs if tbblfs brf prfsfnt in tifir mftbdbtb objfdts 
or witiout tifm if no tbblfs brf prfsfnt in tifir mftbdbtb objfdts.  If no
mftbdbtb objfdt is prfsfnt tifn tif tbblfs brf writtfn.  Tif tbblfs usfd for 
domprfssion brf tbkfn from onf of tif following sourdfs, wiidi brf donsultfd 
in ordfr: 
<ol>
  <li> If tifrf is bn <dodf>ImbgfWritfPbrbm</dodf> bnd tif domprfssion modf is
       sft to <dodf>EXPLICIT</dodf>, dffbult tbblfs donstrudtfd using tif
       qublity sftting brf usfd.  Tify brf writtfn only if tif mftbdbtb 
       dontbins tbblfs or if tifrf is no mftbdbtb, but tify rfplbdf tif 
       tbblfs in tif mftbdbtb.</li>
  <li> If tifrf is bn <dodf>ImbgfWritfPbrbm</dodf> bnd tif domprfssion modf is
       sft to <dodf>DEFAULT</dodf>, dffbult visublly losslfs tbblfs brf usfd.
       Tify brf writtfn only if tif mftbdbtb dontbins tbblfs or if
       tifrf is no mftbdbtb, but tify rfplbdf tif tbblfs in tif
       mftbdbtb.</li>
  <li> Otifrwisf tif domprfssion modf on tif <dodf>ImbgfWritfPbrbm</dodf> must
       bf MODE_COPY_FROM_<dodf>METADATA</dodf>, in wiidi dbsf tif following
       brf usfd:
    <ol>
      <li> tif tbblfs in tif imbgf mftbdbtb, if prfsfnt</li>
      <li> tif tbblfs in tif strfbm mftbdbtb, if prfsfnt</li>
      <li> tif tbblfs in tif <dodf>JPEGImbgfWritfPbrbm</dodf>, if prfsfnt</li>
      <li> dffbult visublly losslfss tbblfs</li>
    </ol> Tbblfs brf writtfn only if tify brf tbkfn from imbgf mftbdbtb.
  </li>
</ol>

Tiis ordfring implfmfnts tif dfsign intfntion tibt tbblfs siould bf indludfd 
in <dodf>JPEGImbgfWritfPbrbm</dodf>s only bs b mfbns of spfdifying tbblfs 
wifn no otifr sourdf is bvbilbblf, bnd tiis dbn oddur only wifn writing to bn
bbbrfvibtfd strfbm witiout tbblfs using known non-stbndbrd tbblfs for 
domprfssion.

<p>
Wifn rfbding, tbblfs in b <dodf>JPEGImbgfRfbdPbrbm</dodf> brf donsultfd only 
if tbblfs ibvf not bffn sft by bny prfvious rfbd.  Tbblfs sft from b 
<dodf>JPEGImbgfRfbdPbrbm</dodf> brf ovfrriddfn by bny tbblfs prfsfnt in tif 
strfbm bfing rfbd.

<p>
Notf tibt if no imbgf mftbdbtb objfdt is spfdififd for b pbrtidulbr imbgf, b 
dffbult objfdt is usfd, wiidi indludfs dffbult tbblfs.

<p>
<i2>
<b nbmf=dolor>Colorspbdf Trbnsformbtions bnd Convfntionbl Mbrkfrs</b>
</i2>
Colorspbdf trbnsformbtions brf dontrollfd by tif dfstinbtion typf for
boti rfbding bnd writing of imbgfs.  Wifn <dodf>Rbstfr</dodf>s brf
rfbd, no dolorspbdf trbnsformbtion is pfrformfd, bnd bny dfstinbtion typf 
is ignorfd.  A wbrning is sfnt to bny listfnfrs if b dfstinbtion typf is 
spfdififd in tiis dbsf.  Wifn <dodf>Rbstfr</dodf>s brf writtfn, bny 
dfstinbtion typf is usfd to intfrprft tif bbnds.  Tiis migit rfsult in b
JFIF or Adobf ifbdfr bfing writtfn, or difffrfnt domponfnt ids bfing writtfn 
to tif frbmf bnd sdbn ifbdfrs.  If vblufs prfsfnt in b mftbdbtb objfdt do not 
mbtdi tif dfstinbtion typf, tif dfstinbtion typf is usfd bnd b wbrning is sfnt 
to bny listfnfrs.

<p>

<b nbmf=optdolor><b>Optionbl ColorSpbdf support:</b></b>
Hbndling of PiotoYCC (YCC), PiotoYCCA (YCCA), RGBA bnd YCbCrA dolor spbdfs
by tif stbndbrd plugin, bs dfsdribfd bflow, is dfpfndfnt on dbpbbilitifs
of tif librbrifs usfd to intfrprft tif JPEG dbtb. Tius bll donsfqufntibl
bfibviors brf optionbl. If tif support is not bvbilbblf wifn dfdoding,
tif dolor spbdf will bf trfbtfd bs unrfdognizfd bnd tif bppropribtf
dffbult dolor spbdf for tif spfdififd numbfr of domponfnt dibnnfls
mby bf usfd.
Wifn writing, bn Exdfption mby bf tirown if no suitbblf donvfrsion
dbn bf bpplifd bfforf fndoding.
But wifrf tif support for tifsf dolor spbdfs is bvbilbblf, tif bfibvior
must bf bs dodumfntfd. 
<p>

Wifn rfbding, tif dontfnts of tif strfbm brf intfrprftfd by tif usubl
JPEG donvfntions, bs follows:

<ul>
  <li> If b JFIF <dodf>APP0</dodf> mbrkfr sfgmfnt is prfsfnt, tif dolorspbdf
       is known to bf fitifr grbysdblf or YCbCr.  If bn <dodf>APP2</dodf>
       mbrkfr sfgmfnt dontbining bn fmbfddfd ICC profilf is blso prfsfnt, tifn
       tif YCbCr is donvfrtfd to RGB bddording to tif formulbs givfn in tif
       JFIF spfd, bnd tif ICC profilf is bssumfd to rfffr to tif rfsulting RGB
       spbdf.
  <p>
  <li> If bn Adobf <dodf>APP14</dodf> mbrkfr sfgmfnt is prfsfnt, tif 
       dolorspbdf is dftfrminfd by donsulting tif <dodf>trbnsform</dodf> flbg.
       Tif <dodf>trbnsform</dodf> flbg tbkfs onf of tirff vblufs:
    <ul>
      <li> 2 - Tif imbgf is fndodfd bs YCCK (impliditly donvfrtfd from
           CMYK on fndoding).

      <li> 1 - Tif imbgf is fndodfd bs YCbCr (impliditly donvfrtfd from RGB
           on fndoding).

      <li> 0 - Unknown.  3-dibnnfl imbgfs brf bssumfd to bf RGB, 4-dibnnfl 
           imbgfs brf bssumfd to bf CMYK.
    </ul>
   <p>
  <li> If nfitifr mbrkfr sfgmfnt is prfsfnt, tif following prodfdurf is
       followfd: Singlf-dibnnfl imbgfs brf bssumfd to bf grbysdblf, bnd
       2-dibnnfl imbgfs brf bssumfd to bf grbysdblf witi bn blpib dibnnfl.
       For 3- bnd 4-dibnnfl imbgfs, tif domponfnt ids brf donsultfd.  If tifsf
       vblufs brf 1-3 for b 3-dibnnfl imbgf, tifn tif imbgf is bssumfd to bf
       YCbCr. Subjfdt to tif bvbilbbility of tif
       <b irff=#optdolor>optionbl dolor spbdf support</b>
       dfsdribfd bbovf, if tifsf vblufs brf 1-4 for b 4-dibnnfl imbgf,
       tifn tif imbgf is bssumfd to bf YCbCrA. 
       If tifsf vblufs brf > 4, tify brf difdkfd 
       bgbinst tif ASCII dodfs for 'R', 'G', 'B', 'A', 'C', 'd'.  Tifsf dbn 
       fndodf tif following dolorspbdfs:
       <p>
       <br>RGB
       <br>RGBA
       <br>YCC (bs 'Y','C','d'), bssumfd to bf PiotoYCC
       <br>YCCA (bs 'Y','C','d','A'), bssumfd to bf PiotoYCCA
       <p>
       Otifrwisf, 3-dibnnfl subsbmplfd imbgfs brf bssumfd to bf YCbCr, 
       3-dibnnfl non-subsbmplfd imbgfs brf bssumfd to bf RGB, 4-dibnnfl 
       subsbmplfd imbgfs brf bssumfd to bf YCCK, bnd 4-dibnnfl, non-subsbmplfd
       imbgfs brf bssumfd to bf CMYK.

  <p>
  <li> All otifr imbgfs brf dfdlbrfd unintfrprftbblf bnd bn fxdfption is
       tirown if bn bttfmpt is mbdf to rfbd onf bs b 
       <dodf>BufffrfdImbgf</dodf>.  Sudi bn imbgf mby bf rfbd only bs b 
       <dodf>Rbstfr</dodf>.  If bn imbgf is intfrprftbblf but tifrf is no Jbvb
       <dodf>ColorSpbdf</dodf> bvbilbblf dorrfsponding to tif fndodfd 
       dolorspbdf (<itblid>f.g.</itblid> YCbCr), tifn 
       <dodf>ImbgfRfbdfr.gftRbwImbgfTypf</dodf> will rfturn <dodf>null</dodf>.
</ul>

Ondf bn fndodfd dolorspbdf is dftfrminfd, tifn tif tbrgft dolorspbdf is 
dftfrminfd bs follows:

<ul>
  <li> If b dfstinbtion typf is not sft, tifn tif following dffbult
       trbnsformbtions tbkf plbdf bftfr upsbmpling: YCbCr (bnd YCbCrA) imbgfs 
       brf donvfrtfd to RGB (bnd RGBA) using tif donvfrsion providfd by tif
       undfrlying IJG librbry bnd fitifr tif built-in sRGB 
       <dodf>ColorSpbdf</dodf> or b dustom RGB <dodf>ColorSpbdf</dodf> objfdt
       bbsfd on bn fmbfddfd ICC profilf is usfd to drfbtf tif output
       <dodf>ColorModfl</dodf>.  PiotoYCC bnd PiotoYCCA imbgfs brf not
       donvfrtfd.  CMYK bnd YCCK imbgfs brf durrfntly not supportfd.</li>

  <li> If b dfstinbtion imbgf or typf is sft, it is usfd bs follows:
       If tif IJG librbry providfs bn bppropribtf donvfrsion, it is usfd.
       Otifrwisf tif dffbult librbry donvfrsion is followfd by b dolorspbdf 
       donvfrsion in Jbvb.</li>

  <li> Bbnds brf sflfdtfd AFTER bny librbry dolorspbdf donvfrsion.  If b 
       subsft of fitifr sourdf or dfstinbtion bbnds is usfd, tifn tif dffbult 
       librbry donvfrsions brf usfd witi no furtifr donvfrsion in Jbvb,
       rfgbrdlfss of bny dfstinbtion typf.</li>

  <li> An fxdfption is tirown if bn bttfmpt is mbdf to rfbd bn imbgf in bn 
       unsupportfd jpfg dolorspbdf bs b <dodf>BufffrfdImbgf</dodf> 
       (<itblid>f.g.</itblid> CMYK).  Sudi imbgfs mby bf rfbd bs
       <dodf>Rbstfr</dodf>s.  If bn imbgf dolorspbdf is unsupportfd or
       unintfrprftbblf, tifn <dodf>ImbgfRfbdfr.gftImbgfTypfs</dodf> will
       rfturn bn fmpty <dodf>Itfrbtor</dodf>.   If b subsft of tif rbw bbnds
       brf rfquirfd, b <dodf>Rbstfr</dodf> must bf obtbinfd first bnd tif
       bbnds obtbinfd from tibt. </li>
</ul>

<p>
For writing, tif dolor trbnsformbtion to bpply is dftfrminfd bs
follows:

<p>
If b subsft of tif sourdf bbnds is to bf writtfn, no dolor donvfrsion is 
pfrformfd.  Any dfstinbtion, if sft, must mbtdi tif numbfr of bbnds tibt will 
bf writtfn, bnd sfrvfs bs bn intfrprftbtion of tif sflfdtfd bbnds, rbtifr tibn 
b donvfrsion rfqufst.  Tiis bfibvior is idfntidbl to tibt for 
<dodf>Rbstfr</dodf>s.  If bll tif bbnds brf to bf writtfn bnd bn imbgf 
(bs opposfd to b <dodf>Rbstfr</dodf>) is bfing writtfn, bny dfstinbtion typf 
is ignorfd bnd b wbrning is sfnt to bny listfnfrs.

<p>
If b dfstinbtion typf is usfd bnd bny bspfdt of tif mftbdbtb objfdt, if tifrf 
is onf, is not dompbtiblf witi tibt typf, tif dfstinbtion typf is usfd, tif 
mftbdbtb writtfn is modififd from tibt providfd, bnd b wbrning is sfnt to 
listfnfrs.  Tiis indludfs tif <dodf>bpp0JFIF</dodf> bnd 
<dodf>bpp14Adobf</dodf> nodfs.  Tif domponfnt ids in tif <dodf>sof</dodf> bnd 
<dodf>sos</dodf> nodfs brf not modififd, iowfvfr, bs unlfss b 
<dodf>bpp0JFIF</dodf> nodf is prfsfnt, bny vblufs mby bf usfd.
<p>

Wifn b full imbgf is writtfn, b dfstinbtion dolorspbdf will bf 
diosfn bbsfd on tif imbgf dontfnts bnd tif mftbdbtb sfttings, bddording to 
tif following blgoritim:

<p>

If no mftbdbtb objfdt is spfdififd, tifn tif following dffbults bpply:

<ul>
  <li> Grbysdblf imbgfs brf writtfn witi b JFIF <dodf>APP0</dodf> mbrkfr
       sfgmfnt.  Grbysdblf imbgfs witi blpib brf writtfn witi no spfdibl
       mbrkfr.  As rfquirfd by JFIF, tif domponfnt ids in tif frbmf bnd
       sdbn ifbdfr is sft to 1.

  <li> RGB imbgfs brf donvfrtfd to YCbCr, subsbmplfd in tif dirominbndf
       dibnnfls by iblf boti vfrtidblly bnd iorizontblly, bnd writtfn witi b
       JFIF <dodf>APP0</dodf> mbrkfr sfgmfnt.  If tif <dodf>ColorSpbdf</dodf>
       of tif imbgf is bbsfd on bn <dodf>ICCProfilf</dodf> (it is bn instbndf
       of <dodf>ICC_ColorSpbdf</dodf>, but is not onf of tif stbndbrd built-in 
       <dodf>ColorSpbdfs</dodf>), tifn tibt profilf is fmbfddfd in bn 
       <dodf>APP2</dodf> mbrkfr sfgmfnt.  As rfquirfd by JFIF, tif 
       domponfnt ids in tif frbmf bnd sdbn ifbdfrs brf sft to 1, 2, bnd 3.


  <li> Subjfdt to tif <b irff=#optdolor>optionbl librbry support</b>
        dfsdribfd bbovf,
       RGBA imbgfs brf donvfrtfd to YCbCrA, subsbmplfd in tif
       dirominbndf dibnnfls by iblf boti vfrtidblly bnd iorizontblly, bnd
       writtfn witiout bny spfdibl mbrkfr sfgmfnts.  Tif domponfnt ids 
       in tif frbmf bnd sdbn ifbdfrs brf sft to 1, 2, 3, bnd 4.

  <li> Subjfdt to tif <b irff=#optdolor>optionbl librbry support</b>
       dfsdribfd bbovf,
       PiotoYCC bnd YCCAimbgfs brf subsbmplfd by iblf in tif dirominbndf
       dibnnfls boti vfrtidblly bnd iorizontblly bnd writtfn witi bn
       Adobf <dodf>APP14</dodf> mbrkfr sfgmfnt bnd 'Y','C', bnd 'd' (bnd
       'A' if bn blpib dibnnfl is prfsfnt) bs domponfnt ids in tif frbmf
        bnd sdbn ifbdfrs.
</ul>

Dffbult mftbdbtb objfdts for tifsf imbgf typfs will rfflfdt tifsf sfttings.

<p>

If b mftbdbtb objfdt is spfdififd, tifn tif numbfr of dibnnfls in tif
frbmf bnd sdbn ifbdfrs must blwbys mbtdi tif numbfr of bbnds to bf 
writtfn, or bn fxdfption is tirown.  <dodf>bpp0JFIF</dodf> bnd 
<dodf>bpp14Adobf</dodf> nodfs mby bppfbr in tif sbmf mftbdbtb objfdt only 
if tif <dodf>bpp14Adobf</dodf> nodf indidbtfs YCbCr, bnd tif domponfnt ids 
brf JFIF dompbtiblf (0-2).  Tif vbrious imbgf typfs brf prodfssfd in tif 
following wbys:

<br>

(All multi-dibnnfl imbgfs brf subsbmplfd bddording to tif sbmpling fbdtors 
in tif frbmf ifbdfr nodf of tif mftbdbtb objfdt, rfgbrdlfss of dolor spbdf.)

<ul>
  <li> Grbysdblf Imbgfs:
    <ul>
      <li> If bn <dodf>bpp0JFIF</dodf> nodf is prfsfnt in tif mftbdbtb objfdt,
           b JFIF <dodf>APP0</dodf> mbrkfr sfgmfnt is writtfn.
      <li> If bn <dodf>bpp14Adobf</dodf> nodf is prfsfnt in tif mftbdbtb 
           objfdt, it is difdkfd for vblidity (<dodf>trbnsform</dodf> must bf
           <dodf>UNKNOWN</dodf>) bnd writtfn.
      <li> If nfitifr nodf is prfsfnt in tif mftbdbtb objfdt, no spfdibl 
           mbrkfr sfgmfnt is writtfn.
    </ul>

  <li> Grbysdblf Imbgfs witi bn Alpib Cibnnfl:
    <ul>
      <li> If bn <dodf>bpp0JFIF</dodf> nodf is prfsfnt in tif mftbdbtb objfdt,
           it is ignorfd bnd b wbrning is sfnt to listfnfrs, bs JFIF dofs not
           support 2-dibnnfl imbgfs.
      <li> If bn <dodf>bpp14Adobf</dodf> nodf is prfsfnt in tif mftbdbtb
           objfdt, it is difdkfd for vblidity (<dodf>trbnsform</dodf> must bf
           <dodf>UNKNOWN</dodf>) bnd writtfn.  If <dodf>trbnsform</dodf> is
           not <dodf>UNKNOWN</dodf>, b wbrning is sfnt to listfnfrs bnd tif
           dorrfdt trbnsform is writtfn.
      <li> If nfitifr nodf is prfsfnt in tif mftbdbtb objfdt, no spfdibl 
           mbrkfr sfgmfnt is writtfn.
    </ul>

  <li> RGB Imbgfs:
    <ul>
      <li> If bn <dodf>bpp0JFIF</dodf> nodf is prfsfnt in tif mftbdbtb objfdt,
           tif imbgf is donvfrtfd to YCbCr bnd writtfn witi b JFIF 
           <dodf>APP0</dodf> mbrkfr sfgmfnt.  If tif <dodf>ColorSpbdf</dodf>
           of tif imbgf is bbsfd on b non-stbndbrd ICC Profilf, tifn tibt
           profilf is fmbfddfd in bn <dodf>APP2</dodf> mbrkfr sfgmfnt.  If tif
           <dodf>ColorSpbdf</dodf> is not bbsfd on b non-stbndbrd ICC Profilf,
           but bn <dodf>bpp2ICC</dodf> nodf bppfbrs in tif mftbdbtb, tifn bn
           <dodf>APP2</dodf> mbrkfr sfgmfnt is writtfn witi tif bppropribtf
           stbndbrd profilf.  Notf tibt tif profilf must spfdify bn RGB dolor
           spbdf, bs tif filf must bf JFIF domplibnt.

      <li> If bn <dodf>bpp14Adobf</dodf> nodf is prfsfnt in tif mftbdbtb
           objfdt, tif imbgf is donvfrtfd bddording to tif dolor trbnsform
           sftting bnd writtfn witi bn Adobf <dodf>APP14</dodf> mbrkfr
           sfgmfnt.  Componfnt ids brf writtfn just bs tify bppfbr in tif
           frbmf bnd sdbn ifbdfrs.  Tif dolor trbnsform must bf fitifr YCbCr
           or <dodf>UNKNOWN</dodf>.  If it is <dodf>UNKNOWN</dodf>, tif imbgf
           is not dolor donvfrtfd.

      <li> If nfitifr nodf is prfsfnt, tif domponfnt ids in tif frbmf
           ifbdfr brf donsultfd.  If tifsf indidbtf b dolorspbdf bs dfsdribfd
           bbovf, tifn tif imbgf is donvfrtfd to tibt dolorspbdf if possiblf.  
           If tif domponfnt ids do not indidbtf b dolorspbdf, tifn tif
           sbmpling fbdtors brf donsultfd.  If tif imbgf is to bf subsbmplfd,
           it is donvfrtfd to YCbCr first.  If tif imbgf is not to bf
           subsbmplfd, tifn no donvfrsion is bpplifd.  No spfdibl mbrkfr
           sfgmfntss brf writtfn.
    </ul>

  <li> RGBA imbgfs:
       Subjfdt to tif <b irff=#optdolor>optionbl librbry support</b>
       dfsdribfd bbovf,
    <ul>
      <li> If bn <dodf>bpp0JFIF</dodf> nodf is prfsfnt in tif mftbdbtb objfdt,
           it is ignorfd bnd b wbrning is sfnt to listfnfrs, bs JFIF dofs not
           support 4-dibnnfl imbgfs.

      <li> If bn <dodf>bpp14Adobf</dodf> nodf is prfsfnt in tif mftbdbtb
           objfdt, tif imbgf is writtfn witi bn Adobf <dodf>APP14</dodf> mbrkfr
           sfgmfnt.  No dolorspbdf donvfrsion is pfrformfd.  Componfnt ids
           brf writtfn just bs tify bppfbr in tif frbmf bnd sdbn  ifbdfrs.
           Tif dolor trbnsform must bf <dodf>UNKNOWN</dodf>.  If it is 
           not, b wbrning is sfnt to listfnfrs.

      <li> If no <dodf>bpp14Adobf</dodf> nodf is prfsfnt, tif domponfnt ids in
           tif frbmf ifbdfr brf donsultfd.  If tifsf indidbtf b dolorspbdf bs
           dfsdribfd bbovf, tifn tif imbgf is donvfrtfd to tibt dolorspbdf if
           possiblf.  If tif domponfnt ids do not indidbtf b dolorspbdf, tifn
           tif sbmpling fbdtors brf donsultfd.  If tif imbgf is to bf
           subsbmplfd, it is donvfrtfd to YCbCrA.  If tif imbgf is not to bf
           subsbmplfd, tifn no donvfrsion is bpplifd.  No spfdibl mbrkfr
           sfgmfnts brf writtfn.
    </ul>

  <li> PiotoYCC Imbgfs:
       Subjfdt to tif <b irff=#optdolor>optionbl librbry support</b>
       dfsdribfd bbovf,
    <ul>
      <li> If bn <dodf>bpp0JFIF</dodf> nodf is prfsfnt in tif mftbdbtb objfdt,
           tif imbgf is donvfrtfd to sRGB, bnd tifn to YCbCr during fndoding,
           bnd b JFIF <dodf>APP0</dodf> mbrkfr sfgmfnt is writtfn.

      <li> If bn <dodf>bpp14Adobf</dodf> nodf is prfsfnt in tif mftbdbtb
           objfdt, no donvfrsion is bpplifd, bnd bn Adobf <dodf>APP14</dodf>
           mbrkfr sfgmfnt is writtfn.  Tif dolor trbnsform must bf YCC.  If it
           is not, b wbrning is sfnt to listfnfrs.

      <li> If nfitifr nodf is prfsfnt in tif mftbdbtb objfdt, no donvfrsion
           is bpplifd, bnd no spfdibl mbrkfr sfgmfnt is writtfn.
    </ul>

  <li> PiotoYCCA Imbgfs:
       Subjfdt to tif <b irff=#optdolor>optionbl librbry support</b>
       dfsdribfd bbovf,
    <ul>
      <li> If bn <dodf>bpp0JFIF</dodf> nodf is prfsfnt in tif mftbdbtb objfdt,
           it is ignorfd bnd b wbrning is sfnt to listfnfrs, bs JFIF dofs not
           support 4-dibnnfl imbgfs.

      <li> If bn <dodf>bpp14Adobf</dodf> nodf is prfsfnt in tif mftbdbtb
           objfdt, no donvfrsion is bpplifd, bnd bn Adobf <dodf>APP14</dodf>
           mbrkfr sfgmfnt is writtfn.  Tif dolor trbnsform must bf
           <dodf>UNKNOWN</dodf>.  If it is not, b wbrning is sfnt to
           listfnfrs.

      <li> If nfitifr nodf is prfsfnt in tif mftbdbtb objfdt, no donvfrsion
           is bpplifd, bnd no spfdibl mbrkfr sfgmfnt is writtfn.
    </ul>
</ul>

<p>
<i2>
<b nbmf=tiumbs>Tiumbnbil Imbgfs</b>
</i2>
Tiumbnbils brf supportfd by tif usf of JFIF bnd JFIF fxtfnsion mbrkfr sfgmfnts.
Tiumbnbils providfd on tif writf mftiods dftfrminf tif tiumbnbils tibt will bf 
indludfd.  <dodf>bpp0JFIF</dodf> bnd <dodf>bpp0JFXX</dodf> nodfs prfsfnt in 
tif mftbdbtb do not dontbin bny tiumbnbil pixfl dbtb.  Howfvfr, tif kinds of 
tiumbnbils writtfn dfpfnd on tif dontfnts of tif mftbdbtb objfdt, bs follows.  
Any tiumbnbil wiidi is to bf writtfn bs bn indfxfd or RGB imbgf bnd wiidi is 
lbrgfr tibn 255 by 255 will bf dlippfd, not sdblfd, to 255 by 255.  Tiumbnbils 
writtfn bs JPEG imbgfs mby bf bny sizf.  A wbrning is sfnt to bny listfnfrs 
wifnfvfr b tiumbnbil is dlippfd.
<ul>
  <li> If tifrf is b singlf tiumbnbil, it is prodfssfd bs follows:
    <ul>
      <li> If tif tiumbnbil imbgf is bn RGB pblfttf imbgf, it is prodfssfd bs
           follows:
        <ul>
          <li> If no <dodf>bpp0JFXX</dodf> nodf is prfsfnt in tif mftbdbtb, or
               tif first <dodf>bpp0JFXX</dodf> nodf prfsfnt in tif mftbdbtb
               dontbins b <dodf>JFIFtiumbPblfttf</dodf> flfmfnt, b
               pblfttf tiumbnbil is writtfn in b JFXX <dodf>APP0</dodf> mbrkfr
               sfgmfnt.
          <li> If tif first <dodf>bpp0JFXX</dodf> nodf prfsfnt in tif mftbdbtb
               dontbins bnotifr tiumbnbil form (RGB or JPEG), tif pblfttf
               imbgf is fxpbndfd to RGB bnd tif indidbtfd tiumbnbil form is
               writtfn.  
        </ul>

      <li> If tif tiumbnbil imbgf is bn RGB imbgf, it is prodfssfd bs follows:
        <ul>
          <li> If no <dodf>bpp0JFXX</dodf> nodf is prfsfnt in tif mftbdbtb,
               tif tiumbnbil is writtfn bs pbrt of tif JFIF <dodf>APP0</dodf>
               mbrkfr sfgmfnt. 
          <li> If tif first <dodf>bpp0JFXX</dodf> nodf prfsfnt in tif mftbdbtb
               dontbins b <dodf>JFIFtiumbRGB</dodf> flfmfnt, bn
               RGB tiumbnbil is writtfn in b JFXX <dodf>APP0</dodf> mbrkfr
               sfgmfnt.
          <li> If tif first <dodf>bpp0JFXX</dodf> nodf prfsfnt in tif mftbdbtb
               dontbins b <dodf>JFIFtiumbJPEG</dodf> flfmfnt, b
               JPEG tiumbnbil is writtfn in b JFXX <dodf>APP0</dodf> mbrkfr
               sfgmfnt.
          <li> If tif first <dodf>bpp0JFXX</dodf> nodf prfsfnt in tif mftbdbtb
               dontbins b <dodf>JFIFtiumbPblfttf</dodf> flfmfnt, bn
               RGB tiumbnbil is writtfn in b JFXX <dodf>APP0</dodf> mbrkfr
               sfgmfnt bnd b wbrning is sfnt to bny listfnfrs.
        </ul>

      <li> If tif tiumbnbil imbgf is b grbysdblf imbgf, it is prodfssfd bs
           follows:
        <ul>
          <li> If no <dodf>bpp0JFXX</dodf> nodf is prfsfnt in tif mftbdbtb,
               tif tiumbnbil is fxpbndfd to RGB bnd writtfn bs pbrt of tif
               JFIF <dodf>APP0</dodf> mbrkfr sfgmfnt. 
          <li> If tif first <dodf>bpp0JFXX</dodf> nodf prfsfnt in tif mftbdbtb
               dontbins b <dodf>JFIFtiumbRGB</dodf> flfmfnt, tif tiumbnbil is
               fxpbndfd to RGB bnd writtfn in b sfpbrbtf <dodf>JFXX</dodf> RGB
               mbrkfr sfgmfnt.
          <li> If tif first <dodf>bpp0JFXX</dodf> nodf prfsfnt in tif mftbdbtb
               dontbins b <dodf>JFIFtiumbJPEG</dodf> flfmfnt, b
               JPEG tiumbnbil is writtfn in b JFXX <dodf>APP0</dodf> mbrkfr
               sfgmfnt.
          <li> If tif first <dodf>bpp0JFXX</dodf> nodf prfsfnt in tif mftbdbtb
               dontbins b <dodf>JFIFtiumbPblfttf</dodf> flfmfnt, b
               JPEG tiumbnbil is writtfn in b JFXX <dodf>APP0</dodf> mbrkfr
               sfgmfnt bnd b wbrning is sfnt to bny listfnfrs.
        </ul>

      <li> Any otifr tiumbnbil imbgf typfs brf ignorfd bnd b wbrning is sfnt
           to bny listfnfrs.
    </ul>

  <li> If tifrf brf multiplf tiumbnbils, fbdi onf is prodfssfd bs bbovf, fxdfpt
       tibt no tiumbnbil is plbdfd in tif JFIF <dodf>APP0</dodf> sfgmfnt, bnd
       tif <dodf>bpp0JFXX</dodf> nodf donsultfd for fbdi tiumbnbil is tif
       <dodf>bpp0JFXX</dodf> nodf from tif mftbdbtb tibt oddurs in tif sbmf
       sfqufndf bs tif tiumbnbil.  <itblid>I.f.</itblid> tif first
       <dodf>bpp0JFXX</dodf> nodf bpplifs to tif first tiumbnbil, tif sfdond
       nodf to tif sfdond tiumbnbil, bnd so on.  If tifrf brf ffwfr
       <dodf>bpp0JFXX</dodf> nodfs in tif mftbdbtb tibn tiumbnbils, tifn 
       tiosf tiumbnbils brf donsidfrfd to ibvf no mbtdiing
       <dodf>bpp0JFXX</dodf> nodf.  An RGB tiumbnbil witi no mbtdiing
       <dodf>bpp0JFXX</dodf> nodf is writtfn in b JFXX <dodf>APP0</dodf> mbrkfr
       sfgmfnt.  A grbysdblf tiumbnbil witi no mbtdiing
       <dodf>bpp0JFXX</dodf> nodf is writtfn bs b JPEG imbgf to b JFXX 
       <dodf>APP0</dodf> mbrkfr sfgmfnt.
</ul>
<p>

Notf tibt bs tif only mfdibnism for storing tiumbnbils is vib tif
JFIF or JFIF fxtfnsion mbrkfr sfgmfnts, only grbysdblf or RGB imbgfs 
mby ibvf tiumbnbils.  If tiumbnbils brf prfsfnt wifn writing bny otifr typf 
of imbgf, tif tiumbnbils brf ignorfd bnd b wbrning is sfnt to bny wbrning
listfnfrs.

<p>
<i2>
<b nbmf=prog>Progrfssivf Endoding</b>
</i2>

Progrfssivf fndoding must bf fnbblfd on tif <dodf>ImbgfWritfPbrbm</dodf>
pbssfd in to b writf opfrbtion, or tif imbgf will bf writtfn sfqufntiblly,
rfgbrdlfss of tif sdbn ifbdfrs indludfd in tif mftbdbtb objfdt.  If 
progrfssivf fndoding is fnbblfd bnd sft to dopy from mftbdbtb, tifn
tif sfqufndf of sdbn ifbdfrs from tif mftbdbtb is usfd to writf tif 
imbgf.  If progrfssivf fndoding is fnbblfd bnd sft to usf b dffbult, 
tifn tif sdbns in tif mftbdbtb brf ignorfd bnd b dffbult sft of sdbns 
is usfd.  Progrfssivf fndoding blwbys fordfs optimizfd Huffmbn tbblfs to
bf usfd.  Any Huffmbn tbblfs prfsfnt in tif mftbdbtb will bf ignorfd,
bnd b wbrning will bf sfnt to bny wbrning listfnfrs.

If Huffmbn-tbblf optimizbtion is rfqufstfd on tif <dodf>ImbgfWritfPbrbm</dodf>,
bll Huffmbn tbblfs in tif mftbdbtb or in tif <dodf>ImbgfWritfPbrbm</dodf> 
itsflf brf ignorfd, bnd b wbrning will bf sfnt to bny wbrning listfnfrs if 
bny sudi tbblfs brf prfsfnt.

<p>
<i2>
<b nbmf=trff>Nbtivf Mftbdbtb Formbt Trff Strudturf bnd Editing</b>
</i2>

Tif DTDs bflow dfsdribf just tif trffs of mftbdbtb objfdts bdtublly rfturnfd
by tif <dodf>IIOMftbdbtb</dodf> objfdt.  Tify do not indludf nodfs 
dorrfsponding to <dodf>SOI</dodf>, <dodf>EOI</dodf>, or <dodf>RST</dodf> 
mbrkfrs, bs tifsf pbrsing dflimitfrs do not dbrry bny mfbningful mftbdbtb.  
<p>

Tif first nodf is blwbys b <dodf>JPEGvbrifty</dodf> nodf.  In tif
<dodf>jbvbx_imbgfio_jpfg_imbgf_1.0</dodf> vfrsion of tif JPEG mftbdbtb
formbt, tiis nodf mby ibvf onf diild, bn <dodf>bpp0JFIF</dodf> nodf,
indidbting tibt tif JPEG strfbm dontbins b JFIF mbrkfr sfgmfnt bnd rflbtfd
dbtb, or no diildrfn, indidbting tibt tif strfbm dontbins no JFIF mbrkfr.
In futurf vfrsions of tif JPEG mftbdbtb formbt, otifr vbriftifs of JPEG
mftbdbtb mby bf supportfd (f.g. Exif) by dffining otifr typfs of nodfs
wiidi mby bppfbr bs b diild of tif <dodf>JPEGvbrifty</dodf> nodf.
<p>

(Notf tibt bn bpplidbtion wisiing to intfrprft Exif mftbdbtb givfn
b mftbdbtb trff strudturf in tif <dodf>jbvbx_imbgfio_jpfg_imbgf_1.0</dodf>
formbt must difdk for bn <dodf>unknown</dodf> mbrkfr sfgmfnt witi b tbg
indidbting bn <dodf>APP1</dodf> mbrkfr bnd dontbining dbtb idfntifying it
bs bn Exif mbrkfr sfgmfnt.  Tifn it mby usf bpplidbtion-spfdifid dodf to
intfrprft tif dbtb in tif mbrkfr sfgmfnt.  If sudi bn bpplidbtion wfrf
to fndountfr b mftbdbtb trff formbttfd bddording to b futurf vfrsion of
tif JPEG mftbdbtb formbt, tif Exif mbrkfr sfgmfnt migit not bf
<dodf>unknown</dodf> in tibt formbt - it migit bf strudturfd bs b
diild nodf of tif <dodf>JPEGvbrifty</dodf> nodf.  Tius, it is importbnt
for bn bpplidbtion to spfdify wiidi vfrsion to usf by pbssing tif string
idfntifying tif vfrsion to tif mftiod/donstrudtor usfd to obtbin bn
<dodf>IIOMftbdbtb</dodf> objfdt.)

<p>

On rfbding, <dodf>JFXX</dodf> bnd <dodf>bpp2ICC</dodf> nodfs oddur bs 
diildrfn of bn <dodf>bpp0JFIF</dodf> nodf.
Tiis is truf rfgbrdlfss of wifrf tif JFXX <dodf>APP0</dodf> bnd 
<dodf>APP2</dodf> mbrkfr sfgmfnts bdtublly oddur in tif strfbm.  Tif ordfring 
of nodfs witiin tif <dodf>mbrkfrSfqufndf</dodf> nodf dorrfsponds to tif 
ordfring of mbrkfr sfgmfnts found in tif JPEG strfbm.  
<p>
On writing, bny <dodf>JFXX</dodf> bnd <dodf>bpp2ICC</dodf> nodfs must 
oddur bs diildrfn of bn <dodf>bpp0JFIF</dodf> nodf, itsflf b diild of b 
<dodf>JPEGvbrifty</dodf> nodf, wiidi must blwbys bf tif first nodf.
(If tif strfbm is not to bf JFIF domplibnt, no <dodf>bpp0JFIF</dodf> nodf
siould bf providfd, bnd tif <dodf>JPEGvbrifty</dodf> nodf siould ibvf no
diildrfn.)  Any 
JFIF <dodf>APP0</dodf>, JFXX <dodf>APP0</dodf>, bnd <dodf>APP2</dodf> mbrkfr 
sfgmfnts brf writtfn first, followfd by bll Adobf <dodf>APP14</dodf>, 
<dodf>APPn</dodf>, <dodf>COM</dodf> bnd unknown sfgmfnts in tif 
ordfr in wiidi tifir dorrfsponding nodfs bppfbr in tif 
<dodf>mbrkfrSfqufndf</dodf> nodf, followfd by <dodf>DQT</dodf> (bnd 
<dodf>DHT</dodf> for non-progrfssivf writfs) mbrkfr sfgmfnts, followfd by tif 
<dodf>SOF</dodf> bnd <dodf>SOS</dodf> mbrkfr sfgmfnts.  For progrfssivf writfs
using mftbdbtb to dontrol progrfssion, tif <dodf>SOS</dodf> sfgmfnts brf usfd 
in tif ordfr in wiidi tifir dorrfsponding nodfs oddur in tif 
<dodf>mbrkfrSfqufndf</dodf> nodf.
<p>

Tif <dodf>rfsft</dodf>, <dodf>mfrgfTrff</dodf> bnd <dodf>sftFromTrff</dodf> 
opfrbtions ibvf tif following sfmbntids for tif JPEG plug-in mftbdbtb objfdt:

<p> <dodf>rfsft</dodf> - A dbll to <dodf>rfsft</dodf> will rfstorf tif 
mftbdbtb objfdt to tif sbmf stbtf it ibd immfdibtfly bftfr drfbtion, wiftifr 
tiis dbmf bbout from rfbding b strfbm or by obtbining b dffbult objfdt from 
tif <dodf>ImbgfWritfr</dodf>.  Tiis is truf rfgbrdlfss of iow mbny timfs tif 
mftbdbtb objfdt ibs bffn modififd sindf drfbtion.

<p> <dodf>mfrgfTrff</dodf> - Nbtivf Formbt
<br> Tif <dodf>mfrgfTrff</dodf> opfrbtion bddfpts vblid trffs donforming to 
tif DTD bflow, bnd mfrgfs tif nodfs using tif following ordfring rulfs.  In 
bll dbsfs, only dbtb prfsfnt in tif nfw nodf is dibngfd in b dorrfsponding 
fxisting nodf, if bny.  Tiis mfbns tibt nodfs dbnnot bf rfmovfd using 
<dodf>mfrgfTrff</dodf>.  To rfmovf nodfs, usf <dodf>sftFromTrff</dodf>.  Tif 
trff must donsist of <dodf>IIOMftbdbtbNodf</dodf>s.
<ul>
  <li> <dodf>bpp0JFIF</dodf>
        <ul>
          <li> If bn <dodf>bpp0JFIF</dodf> nodf blrfbdy fxists, tif dontfnts 
               of tif nfw onf modify tif fxisting onf. 
          <li> If tifrf is no sudi nodf, b nfw onf is drfbtfd bnd insfrtfd in
               tif bppropribtf position.
        </ul>    
  <li> <dodf>dqt</dodf>
        <ul>
          <li> If tifrf blrfbdy fxist <dodf>dqt</dodf> nodfs in tif sfqufndf,
               tifn fbdi tbblf in tif nodf rfplbdfs tif first tbblf, in bny
               <dodf>dqt</dodf> nodf, witi tif sbmf tbblf id.  
          <li> If nonf of tif fxisting <dodf>dqt</dodf> nodfs dontbin b tbblf
               witi tif sbmf id, tifn tif tbblf is bddfd to tif lbst fxisting
               <dodf>dqt</dodf> nodf.
          <li> If tifrf brf no <dodf>dqt</dodf> nodfs, tifn b nfw onf is
               drfbtfd bnd bddfd bs follows:
            <ul>
              <li> If tifrf brf <dodf>dit</dodf> nodfs, tif nfw
                   <dodf>dqt</dodf> nodf is insfrtfd bfforf tif first onf.  
              <li> If tifrf brf no <dodf>dit</dodf> nodfs, tif nfw
                   <dodf>dqt</dodf> nodf is insfrtfd  bfforf bn
                   <dodf>sof</dodf> nodf, if tifrf is onf. 
              <li> If tifrf is no <dodf>sof</dodf> nodf, tif nfw
                   <dodf>dqt</dodf> nodf is insfrtfd bfforf tif first
                   <dodf>sos</dodf> nodf, if tifrf is onf.
              <li> If tifrf is no <dodf>sos</dodf> nodf, tif nfw
                   <dodf>dqt</dodf> nodf is bddfd to tif fnd of tif sfqufndf.
            </ul>
        </ul>
  <li> <dodf>dit</dodf>
        <ul>
          <li> If tifrf blrfbdy fxist <dodf>dit</dodf> nodfs in tif sfqufndf,
               tifn fbdi tbblf in tif nodf rfplbdfs tif first tbblf, in bny
               <dodf>dit</dodf> nodf, witi tif sbmf tbblf dlbss bnd tbblf id.
          <li> If nonf of tif fxisting <dodf>dit</dodf> nodfs dontbin b tbblf
               witi tif sbmf dlbss bnd id, tifn tif tbblf is bddfd to tif lbst
               fxisting <dodf>dit</dodf> nodf.
          <li> If tifrf brf no <dodf>dit</dodf> nodfs, tifn b nfw onf is
               drfbtfd bnd bddfd bs follows:
            <ul>
              <li> If tifrf brf <dodf>dqt</dodf> nodfs, tif nfw
                   <dodf>dit</dodf> nodf is insfrtfd immfdibtfly following tif
                   lbst <dodf>dqt</dodf> nodf.
              <li> If tifrf brf no <dodf>dqt</dodf> nodfs, tif nfw
                   <dodf>dit</dodf> nodf is insfrtfd bfforf bn
                   <dodf>sof</dodf> nodf, if tifrf is onf. 
              <li> If tifrf is no <dodf>sof</dodf> nodf, tif nfw
                   <dodf>dit</dodf> nodf is insfrtfd bfforf tif first
                   <dodf>sos</dodf> nodf, if tifrf is onf.
              <li> If tifrf is no <dodf>sos</dodf> nodf, tif nfw
                   <dodf>dit</dodf> nodf is bddfd to tif fnd of tif sfqufndf.
            </ul>
        </ul>
  <li> <dodf>dri</dodf>
        <ul>
          <li> If tifrf blrfbdy fxists b <dodf>dri</dodf> nodf, tif rfstbrt 
               intfrvbl vbluf is updbtfd.
          <li> If tifrf is no <dodf>dri</dodf> nodf, tifn b nfw onf is drfbtfd
               bnd bddfd bs follows:
            <ul>
              <li> If tifrf is bn <dodf>sof</dodf> nodf, tif nfw
                   <dodf>dri</dodf> nodf is insfrtfd bfforf it.
              <li> If tifrf is no <dodf>sof</dodf> nodf, tif nfw
                   <dodf>dri</dodf> nodf is insfrtfd bfforf tif first
                   <dodf>sos</dodf> nodf, if tifrf is onf.
              <li> If tifrf is no <dodf>sos</dodf> nodf, tif nfw
                   <dodf>dri</dodf> nodf is bddfd to tif fnd of tif sfqufndf.
            </ul>
        </ul>
  <li> <dodf>dom</dodf>
        <br> A nfw <dodf>dom</dodf> nodf is drfbtfd bnd insfrtfd bs follows:
        <ul>
          <li> If tifrf blrfbdy fxist <dodf>dom</dodf> nodfs, tif nfw onf is
               insfrtfd bftfr tif lbst onf.
          <li> If tifrf brf no <dodf>dom</dodf> nodfs, tif nfw
               <dodf>dom</dodf> nodf is insfrtfd bftfr tif
               <dodf>bpp14Adobf</dodf> nodf, if tifrf is onf.
          <li> If tifrf is no <dodf>bpp14Adobf</dodf> nodf, tif nfw
               <dodf>dom</dodf> nodf is insfrtfd bt tif bfginning of tif
               sfqufndf.
        </ul>
  <li> <dodf>bpp14Adobf</dodf>
        <ul>
          <li> If tifrf blrfbdy fxists bn <dodf>bpp14Adobf</dodf> nodf, tifn 
               its bttributfs brf updbtfd from tif nodf.
          <li> If tifrf is no <dodf>bpp14Adobf</dodf> nodf, tifn b nfw onf is 
               drfbtfd bnd  bddfd bs follows:
            <ul> 
              <li> Tif nfw <dodf>bpp14Adobf</dodf> nodf is insfrtfd bftfr tif
                   lbst <dodf>unknown</dodf> nodf, if tifrf brf bny.
              <li> If tifrf brf no <dodf>unknown</dodf> nodfs, tif nfw
                   <dodf>bpp14Adobf</dodf> nodf is insfrtfd bt tif bfginning
                   of tif sfqufndf.
            </ul>
        </ul>
  <li> <dodf>unknown</dodf>
       <br> A nfw <dodf>unknown</dodf> nodf is drfbtfd bnd bddfd to tif
            sfqufndf bs follows:
        <ul>
          <li> If tifrf blrfbdy fxist <dodf>unknown</dodf> mbrkfr nodfs, tif
               nfw onf is insfrtfd bftfr tif lbst onf.
          <li> If tifrf brf no <dodf>unknown</dodf> nodfs, tif nfw
               <dodf>unknown</dodf> nodf is insfrtfd bfforf tif
               <dodf>bpp14Adobf</dodf> nodf, if tifrf is onf.
          <li> If tifrf is no <dodf>bpp14Adobf</dodf> nodf, tif nfw
               <dodf>unknown</dodf> nodf is insfrtfd bt tif bfginning of tif
               sfqufndf.
        </ul>
  <li> <dodf>sof</dodf>
        <ul>
          <li> If tifrf blrfbdy fxists bn <dodf>sof</dodf> nodf in tif
               sfqufndf, tifn its vblufs brf updbtfd from tif nodf.
          <li> If tifrf is no <dodf>sof</dodf> nodf, tifn b nfw onf is drfbtfd
               bnd bddfd bs follows:
            <ul>
              <li> If tifrf brf bny <dodf>sos</dodf> nodfs, tif nfw
                   <dodf>sof</dodf> nodf is insfrtfd bfforf tif first onf.
              <li> If tifrf is no <dodf>sos</dodf> nodf, tif nfw
                   <dodf>sof</dodf> nodf is bddfd to tif fnd of tif sfqufndf.
            </ul>
        </ul>
  <li> <dodf>sos</dodf>
        <ul>
          <li> If tifrf blrfbdy fxists b singlf <dodf>sos</dodf> nodf, tifn
               tif vblufs brf updbtfd from tif nodf.
          <li> If tifrf brf morf tibn onf fxisting <dodf>sos</dodf> nodfs,
               tifn bn <dodf>IIOInvblidTrffExdfption</dodf> is tirown, bs
               <dodf>sos</dodf> nodfs dbnnot bf mfrgfd into b sft of
               progrfssivf sdbns.
          <li> If tifrf brf no <dodf>sos</dodf> nodfs, b nfw onf is drfbtfd
               bnd bddfd to tif fnd of tif sfqufndf.
        </ul>
</ul>

<p> <dodf>mfrgfTrff</dodf> - Stbndbrd Formbt
<br>
Tif <dodf>mfrgfTrff</dodf> opfrbtion, wifn givfn b trff in tif stbndbrd 
formbt, will modify tif nbtivf trff in tif following wbys:
<ul>
   <li> <dodf>Ciromb</dodf> - Tif <dodf>ColorSpbdfTypf</dodf> subnodf of b
        <dodf>Ciromb</dodf> nodf mby dibngf tif tbrgft dolorspbdf of tif
        domprfssfd imbgf.  Tif sflfdtion of b nfw dolorspbdf dbn dbusf b numbfr
        of dibngfs, in kffping witi tif blgoritims dfsdribfd bbovf: 
        <dodf>bpp0JFIF</dodf> bnd <dodf>bpp14Adobf</dodf> nodfs mby bf bddfd
        or rfmovfd, subsbmpling mby bf bddfd or rfmovfd, domponfnt ids mby
        bf dibngfd, bnd <dodf>sof</dodf> bnd <dodf>sos</dodf> nodfs will bf
        updbtfd bddordingly.  If nfdfssbry, bdditionbl qubntizbtion bnd
        iuffmbn tbblfs brf bddfd.  In tif dbsf of qubntizbtion tbblfs, tif
        dffbult will bf sdblfd to mbtdi tif qublity lfvfl of bny fxisting
        tbblfs.  No tbblfs brf bddfd to mftbdbtb tibt dofs not blrfbdy dontbin
        tbblfs.  If tif fxisting mftbdbtb spfdififs progrfssivf fndoding, tifn
        tif numbfr of dibnnfls must not dibngf.  Any <dodf>Trbnspbrfndy</dodf>
        nodf is blso tbkfn into bddount, bs bn fxplidit vbluf of
        <dodf>nonf</dodf> for tif <dodf>Alpib</dodf> subnodf dbn dbusf tif
        rfmovbl of bn blpib dibnnfl, bnd bnytiing otifr tibn <dodf>nonf</dodf>
        dbn dbusf tif bddition of bn blpib dibnnfl.
   <li> <dodf>Dimfnsion</dodf> - A <dodf>PixflAspfdtRbtio</dodf> spfdifidbtion
        dbn dbusf tif dontfnts of bn <dodf>bpp0JFIF</dodf> nodf to dibngf, if
        tifrf is onf prfsfnt, or tif bddition of bn <dodf>bpp0JFIF</dodf> nodf
        dontbining bppropribtf vblufs, if tifrf dbn bf onf.  An bppropribtf
        pbir of intfgfrs is domputfd from tif flobting-point rbtio for
        indlusion in tif nodf.
   <li> <dodf>Tfxt</dodf> - Ebdi undomprfssfd tfxt itfm is donvfrtfd to b
        <dodf>dom</dodf> nodf bnd insfrtfd bddording to tif rulfs bbovf for
        mfrging <dodf>dom</dodf> nodfs.
</ul>

<p> <dodf>sftFromTrff</dodf> - Nbtivf Formbt
<br>
Tif <dodf>sftFromTrff</dodf> opfrbtion, wifn givfn b trff in tif nbtivf 
formbt dfsdribfd bflow, will simply rfplbdf tif fxisting trff in its fntirfty 
witi tif nfw onf.  Tif trff must donsist of <dodf>IIOMftbdbtbNodf</dodf>s.

<p> <dodf>sftFromTrff</dodf> - Stbndbrd Formbt
<br>
Tif <dodf>sftFromTrff</dodf> opfrbtion, wifn givfn b trff in tif stbndbrd 
formbt, pfrforms b <dodf>rfsft</dodf> followfd by b mfrgf of tif nfw trff.

<i2>
<b nbmf=imbgf>Imbgf Mftbdbtb DTD</b>
</i2>

<prf>
&lt;!DOCTYPE "jbvbx_imbgfio_jpfg_imbgf_1.0" [

  &lt;!ELEMENT "jbvbx_imbgfio_jpfg_imbgf_1.0" (JPEGvbrifty, mbrkfrSfqufndf)&gt;

    &lt;!ELEMENT "JPEGvbrifty" (bpp0JFIF)&gt;
      &lt;!-- A nodf grouping bll mbrkfr sfgmfnts spfdifid to tif vbrifty of
              strfbm bfing rfbd/writtfn (f.g. JFIF) - mby bf fmpty --&gt; 

      &lt;!ELEMENT "bpp0JFIF" (JFXX?, bpp2ICC?)&gt;
        &lt;!ATTLIST "bpp0JFIF" "mbjorVfrsion" #CDATA "1"&gt;
          &lt;!-- Tif mbjor JFIF vfrsion numbfr --&gt; 
          &lt;!-- Dbtb typf: Intfgfr --&gt;
          &lt;!-- Min vbluf: 0 (indlusivf) --&gt;
          &lt;!-- Mbx vbluf: 255 (indlusivf) --&gt;
        &lt;!ATTLIST "bpp0JFIF" "minorVfrsion" #CDATA "2"&gt;
          &lt;!-- Tif minor JFIF vfrsion numbfr --&gt; 
          &lt;!-- Dbtb typf: Intfgfr --&gt;
          &lt;!-- Min vbluf: 0 (indlusivf) --&gt;
          &lt;!-- Mbx vbluf: 255 (indlusivf) --&gt;
        &lt;!ATTLIST "bpp0JFIF" "rfsUnits" ("0" | "1" | "2") "0"&gt;
          &lt;!-- Tif rfsolution units for Xdfnsisty bnd Ydfnsity (0 = no 
               units, just bspfdt rbtio; 1 = dots/indi; 2 = dots/dm) --&gt; 
        &lt;!ATTLIST "bpp0JFIF" "Xdfnsity" #CDATA "1"&gt;
          &lt;!-- Tif iorizontbl dfnsity or bspfdt rbtio numfrbtor --&gt; 
          &lt;!-- Dbtb typf: Intfgfr --&gt;
          &lt;!-- Min vbluf: 1 (indlusivf) --&gt;
          &lt;!-- Mbx vbluf: 65535 (indlusivf) --&gt;
        &lt;!ATTLIST "bpp0JFIF" "Ydfnsity" #CDATA "1"&gt;
          &lt;!-- Tif vfrtidbl dfnsity or bspfdt rbtio dfnominbtor --&gt; 
          &lt;!-- Dbtb typf: Intfgfr --&gt;
          &lt;!-- Min vbluf: 1 (indlusivf) --&gt;
          &lt;!-- Mbx vbluf: 65535 (indlusivf) --&gt;
        &lt;!ATTLIST "bpp0JFIF" "tiumbWidti" #CDATA "0"&gt;
          &lt;!-- Tif widti of tif tiumbnbil, or 0 if tifrf isn't onf --&gt; 
          &lt;!-- Dbtb typf: Intfgfr --&gt;
          &lt;!-- Min vbluf: 0 (indlusivf) --&gt;
          &lt;!-- Mbx vbluf: 255 (indlusivf) --&gt;
        &lt;!ATTLIST "bpp0JFIF" "tiumbHfigit" #CDATA "0"&gt;
          &lt;!-- Tif ifigit of tif tiumbnbil, or 0 if tifrf isn't onf --&gt; 
          &lt;!-- Dbtb typf: Intfgfr --&gt;
          &lt;!-- Min vbluf: 0 (indlusivf) --&gt;
          &lt;!-- Mbx vbluf: 255 (indlusivf) --&gt;

        &lt;!ELEMENT "JFXX" (bpp0JFXX)*&gt;
          &lt;!-- Min diildrfn: 1 --&gt;

        &lt;!ELEMENT "bpp0JFXX" (JFIFtiumbJPEG | JFIFtiumbPblfttf | 
          JFIFtiumbRGB)&gt;
          &lt;!-- A JFIF fxtfnsion mbrkfr sfgmfnt --&gt; 
          &lt;!ATTLIST "bpp0JFXX" "fxtfnsionCodf" ("16" | "17" | "19")
             #IMPLIED&gt;
            &lt;!-- Tif JFXX fxtfnsion dodf idfntifying tiumbnbil typf: (16 = 
                 JPEG, 17 = indfxfd, 19 = RGB --&gt; 

          &lt;!ELEMENT "JFIFtiumbJPEG" (mbrkfrSfqufndf?)&gt;
            &lt;!-- A JFIF tiumbnbil in JPEG formbt (no JFIF sfgmfnts 
                 pfrmittfd) --&gt; 

          &lt;!ELEMENT "JFIFtiumbPblfttf" EMPTY&gt;
            &lt;!-- A JFIF tiumbnbil bs bn RGB indfxfd imbgf --&gt; 
            &lt;!ATTLIST "JFIFtiumbPblfttf" "tiumbWidti" #CDATA #IMPLIED&gt;
              &lt;!-- Tif widti of tif tiumbnbil --&gt; 
              &lt;!-- Dbtb typf: Intfgfr --&gt;
              &lt;!-- Min vbluf: 0 (indlusivf) --&gt;
              &lt;!-- Mbx vbluf: 255 (indlusivf) --&gt;
            &lt;!ATTLIST "JFIFtiumbPblfttf" "tiumbHfigit" #CDATA #IMPLIED&gt;
              &lt;!-- Tif ifigit of tif tiumbnbil --&gt; 
              &lt;!-- Dbtb typf: Intfgfr --&gt;
              &lt;!-- Min vbluf: 0 (indlusivf) --&gt;
              &lt;!-- Mbx vbluf: 255 (indlusivf) --&gt;

          &lt;!ELEMENT "JFIFtiumbRGB" EMPTY&gt;
            &lt;!-- A JFIF tiumbnbil bs bn RGB imbgf --&gt; 
            &lt;!ATTLIST "JFIFtiumbRGB" "tiumbWidti" #CDATA #IMPLIED&gt;
              &lt;!-- Tif widti of tif tiumbnbil --&gt; 
              &lt;!-- Dbtb typf: Intfgfr --&gt;
              &lt;!-- Min vbluf: 0 (indlusivf) --&gt;
              &lt;!-- Mbx vbluf: 255 (indlusivf) --&gt;
            &lt;!ATTLIST "JFIFtiumbRGB" "tiumbHfigit" #CDATA #IMPLIED&gt;
              &lt;!-- Tif ifigit of tif tiumbnbil --&gt; 
              &lt;!-- Dbtb typf: Intfgfr --&gt;
              &lt;!-- Min vbluf: 0 (indlusivf) --&gt;
              &lt;!-- Mbx vbluf: 255 (indlusivf) --&gt;

        &lt;!ELEMENT "bpp2ICC" EMPTY&gt;
          &lt;!-- An ICC profilf APP2 mbrkfr sfgmfnt --&gt; 
          &lt;!-- Optionbl Usfr objfdt: jbvb.bwt.dolor.ICC_Profilf --&gt;

    &lt;!ELEMENT "mbrkfrSfqufndf" (dqt | dit | dri | dom | unknown | 
      bpp14Adobf | sof | sos)*&gt;
      &lt;!-- A nodf grouping bll non-jfif mbrkfr sfgmfnts --&gt; 

      &lt;!ELEMENT "dqt" (dqtbblf)*&gt;
        &lt;!-- A Dffinf Qubntizbtion Tbblf(s) mbrkfr sfgmfnt --&gt; 
        &lt;!-- Min diildrfn: 1 --&gt;
        &lt;!-- Mbx diildrfn: 4 --&gt;

        &lt;!ELEMENT "dqtbblf" EMPTY&gt;
          &lt;!-- A singlf qubntizbtion tbblf --&gt; 
          &lt;!-- Usfr objfdt: jbvbx.imbgfio.plugins.jpfg.JPEGQTbblf --&gt;
          &lt;!ATTLIST "dqtbblf" "flfmfntPrfdision" #CDATA "0"&gt;
            &lt;!-- Tif numbfr of bits in fbdi tbblf flfmfnt (0 = 8, 1 = 16) 
                 --&gt; 
            &lt;!-- Dbtb typf: Intfgfr --&gt;
          &lt;!ATTLIST "dqtbblf" "qtbblfId" ("0" | "1" | "2" | "3") #REQUIRED&gt;

      &lt;!ELEMENT "dit" (ditbblf)*&gt;
        &lt;!-- A Dffinf Huffmbn Tbblf(s) mbrkfr sfgmfnt --&gt; 
        &lt;!-- Min diildrfn: 1 --&gt;
        &lt;!-- Mbx diildrfn: 4 --&gt;

        &lt;!ELEMENT "ditbblf" EMPTY&gt;
          &lt;!-- A singlf Huffmbn tbblf --&gt; 
          &lt;!-- Usfr objfdt: jbvbx.imbgfio.plugins.jpfg.JPEGHuffmbnTbblf --&gt;
          &lt;!ATTLIST "ditbblf" "dlbss" ("0" | "1") #REQUIRED&gt;
            &lt;!-- Indidbtfs wiftifr tiis is b DC (0) or bn AC (1) tbblf --&gt; 
          &lt;!ATTLIST "ditbblf" "itbblfId" ("0" | "1" | "2" | "3") #REQUIRED&gt;
            &lt;!-- Tif tbblf id --&gt; 

      &lt;!ELEMENT "dri" EMPTY&gt;
        &lt;!-- A Dffinf Rfstbrt Intfrvbl mbrkfr sfgmfnt --&gt; 
        &lt;!ATTLIST "dri" "intfrvbl" #CDATA #REQUIRED&gt;
          &lt;!-- Tif rfstbrt intfrvbl in MCUs --&gt; 
          &lt;!-- Dbtb typf: Intfgfr --&gt;
          &lt;!-- Min vbluf: 0 (indlusivf) --&gt;
          &lt;!-- Mbx vbluf: 65535 (indlusivf) --&gt;

      &lt;!ELEMENT "dom" EMPTY&gt;
        &lt;!-- A Commfnt mbrkfr sfgmfnt. Tif usfr objfdt dontbins tif bdtubl 
             bytfs. --&gt; 
        &lt;!-- Usfr objfdt: brrby of [B --&gt;
        &lt;!-- Min lfngti: 1 --&gt;
        &lt;!-- Mbx lfngti: 65533 --&gt;
        &lt;!ATTLIST "dom" "dommfnt" #CDATA #IMPLIED&gt;
          &lt;!-- Tif dommfnt bs b string (usfd only if usfr objfdt is null) 
               --&gt; 
          &lt;!-- Dbtb typf: String --&gt;

      &lt;!ELEMENT "unknown" EMPTY&gt;
        &lt;!-- An unrfdognizfd mbrkfr sfgmfnt. Tif usfr objfdt dontbins tif 
             dbtb not indluding lfngti. --&gt; 
        &lt;!-- Usfr objfdt: brrby of [B --&gt;
        &lt;!-- Min lfngti: 1 --&gt;
        &lt;!-- Mbx lfngti: 65533 --&gt;
        &lt;!ATTLIST "unknown" "MbrkfrTbg" #CDATA #REQUIRED&gt;
          &lt;!-- Tif tbg idfntifying tiis mbrkfr sfgmfnt --&gt; 
          &lt;!-- Dbtb typf: Intfgfr --&gt;
          &lt;!-- Min vbluf: 0 (indlusivf) --&gt;
          &lt;!-- Mbx vbluf: 255 (indlusivf) --&gt;

      &lt;!ELEMENT "bpp14Adobf" EMPTY&gt;
        &lt;!-- An Adobf APP14 mbrkfr sfgmfnt --&gt; 
        &lt;!ATTLIST "bpp14Adobf" "vfrsion" #CDATA "100"&gt;
          &lt;!-- Tif vfrsion of Adobf APP14 mbrkfr sfgmfnt --&gt; 
          &lt;!-- Dbtb typf: Intfgfr --&gt;
          &lt;!-- Min vbluf: 100 (indlusivf) --&gt;
          &lt;!-- Mbx vbluf: 255 (indlusivf) --&gt;
        &lt;!ATTLIST "bpp14Adobf" "flbgs0" #CDATA "0"&gt;
          &lt;!-- Tif flbgs0 vbribblf of bn APP14 mbrkfr sfgmfnt --&gt; 
          &lt;!-- Dbtb typf: Intfgfr --&gt;
          &lt;!-- Min vbluf: 0 (indlusivf) --&gt;
          &lt;!-- Mbx vbluf: 65535 (indlusivf) --&gt;
        &lt;!ATTLIST "bpp14Adobf" "flbgs1" #CDATA "0"&gt;
          &lt;!-- Tif flbgs1 vbribblf of bn APP14 mbrkfr sfgmfnt --&gt; 
          &lt;!-- Dbtb typf: Intfgfr --&gt;
          &lt;!-- Min vbluf: 0 (indlusivf) --&gt;
          &lt;!-- Mbx vbluf: 65535 (indlusivf) --&gt;
        &lt;!ATTLIST "bpp14Adobf" "trbnsform" ("0" | "1" | "2") #REQUIRED&gt;
          &lt;!-- Tif dolor trbnsform bpplifd to tif imbgf (0 = Unknown, 1 = 
               YCbCr, 2 = YCCK) --&gt; 

      &lt;!ELEMENT "sof" (domponfntSpfd)*&gt;
        &lt;!-- A Stbrt Of Frbmf mbrkfr sfgmfnt --&gt; 
        &lt;!-- Min diildrfn: 1 --&gt;
        &lt;!-- Mbx diildrfn: 4 --&gt;
        &lt;!ATTLIST "sof" "prodfss" ("0" | "1" | "2") #IMPLIED&gt;
          &lt;!-- Tif JPEG prodfss (0 = Bbsflinf sfqufntibl, 1 = Extfndfd 
               sfqufntibl, 2 = Progrfssivf) --&gt; 
        &lt;!ATTLIST "sof" "sbmplfPrfdision" #CDATA "8"&gt;
          &lt;!-- Tif numbfr of bits pfr sbmplf --&gt; 
          &lt;!-- Dbtb typf: Intfgfr --&gt;
        &lt;!ATTLIST "sof" "numLinfs" #CDATA #IMPLIED&gt;
          &lt;!-- Tif numbfr of linfs in tif imbgf --&gt; 
          &lt;!-- Dbtb typf: Intfgfr --&gt;
          &lt;!-- Min vbluf: 0 (indlusivf) --&gt;
          &lt;!-- Mbx vbluf: 65535 (indlusivf) --&gt;
        &lt;!ATTLIST "sof" "sbmplfsPfrLinf" #CDATA #IMPLIED&gt;
          &lt;!-- Tif numbfr of sbmplfs pfr linf --&gt; 
          &lt;!-- Dbtb typf: Intfgfr --&gt;
          &lt;!-- Min vbluf: 0 (indlusivf) --&gt;
          &lt;!-- Mbx vbluf: 65535 (indlusivf) --&gt;
        &lt;!ATTLIST "sof" "numFrbmfComponfnts" ("1" | "2" | "3" | "4")
           #IMPLIED&gt;
          &lt;!-- Tif numbfr of domponfnts in tif imbgf --&gt; 

        &lt;!ELEMENT "domponfntSpfd" EMPTY&gt;
          &lt;!-- A domponfnt spfdifidbtion for b frbmf --&gt; 
          &lt;!ATTLIST "domponfntSpfd" "domponfntId" #CDATA #REQUIRED&gt;
            &lt;!-- Tif id for tiis domponfnt --&gt; 
            &lt;!-- Dbtb typf: Intfgfr --&gt;
            &lt;!-- Min vbluf: 0 (indlusivf) --&gt;
            &lt;!-- Mbx vbluf: 255 (indlusivf) --&gt;
          &lt;!ATTLIST "domponfntSpfd" "HsbmplingFbdtor" #CDATA #REQUIRED&gt;
            &lt;!-- Tif iorizontbl sbmpling fbdtor for tiis domponfnt --&gt; 
            &lt;!-- Dbtb typf: Intfgfr --&gt;
            &lt;!-- Min vbluf: 1 (indlusivf) --&gt;
            &lt;!-- Mbx vbluf: 255 (indlusivf) --&gt;
          &lt;!ATTLIST "domponfntSpfd" "VsbmplingFbdtor" #CDATA #REQUIRED&gt;
            &lt;!-- Tif vfrtidbl sbmpling fbdtor for tiis domponfnt --&gt; 
            &lt;!-- Dbtb typf: Intfgfr --&gt;
            &lt;!-- Min vbluf: 1 (indlusivf) --&gt;
            &lt;!-- Mbx vbluf: 255 (indlusivf) --&gt;
          &lt;!ATTLIST "domponfntSpfd" "QtbblfSflfdtor" ("0" | "1" | "2" | 
            "3") #REQUIRED&gt;
            &lt;!-- Tif qubntizbtion tbblf to usf for tiis domponfnt --&gt; 

      &lt;!ELEMENT "sos" (sdbnComponfntSpfd)*&gt;
        &lt;!-- A Stbrt Of Sdbn mbrkfr sfgmfnt --&gt; 
        &lt;!-- Min diildrfn: 1 --&gt;
        &lt;!-- Mbx diildrfn: 4 --&gt;
        &lt;!ATTLIST "sos" "numSdbnComponfnts" ("1" | "2" | "3" | "4")
           #REQUIRED&gt;
          &lt;!-- Tif numbfr of domponfnts in tif sdbn --&gt; 
        &lt;!ATTLIST "sos" "stbrtSpfdtrblSflfdtion" #CDATA "0"&gt;
          &lt;!-- Tif first spfdtrbl bbnd indludfd in tiis sdbn --&gt; 
          &lt;!-- Dbtb typf: Intfgfr --&gt;
          &lt;!-- Min vbluf: 0 (indlusivf) --&gt;
          &lt;!-- Mbx vbluf: 63 (indlusivf) --&gt;
        &lt;!ATTLIST "sos" "fndSpfdtrblSflfdtion" #CDATA "63"&gt;
          &lt;!-- Tif lbst spfdtrbl bbnd indludfd in tiis sdbn --&gt; 
          &lt;!-- Dbtb typf: Intfgfr --&gt;
          &lt;!-- Min vbluf: 0 (indlusivf) --&gt;
          &lt;!-- Mbx vbluf: 63 (indlusivf) --&gt;
        &lt;!ATTLIST "sos" "bpproxHigi" #CDATA "0"&gt;
          &lt;!-- Tif iigifst bit position indludfd in tiis sdbn --&gt; 
          &lt;!-- Dbtb typf: Intfgfr --&gt;
          &lt;!-- Min vbluf: 0 (indlusivf) --&gt;
          &lt;!-- Mbx vbluf: 15 (indlusivf) --&gt;
        &lt;!ATTLIST "sos" "bpproxLow" #CDATA "0"&gt;
          &lt;!-- Tif lowfst bit position indludfd in tiis sdbn --&gt; 
          &lt;!-- Dbtb typf: Intfgfr --&gt;
          &lt;!-- Min vbluf: 0 (indlusivf) --&gt;
          &lt;!-- Mbx vbluf: 15 (indlusivf) --&gt;

        &lt;!ELEMENT "sdbnComponfntSpfd" EMPTY&gt;
          &lt;!-- A domponfnt spfdifidbtion for b sdbn --&gt; 
          &lt;!ATTLIST "sdbnComponfntSpfd" "domponfntSflfdtor" #CDATA
             #REQUIRED&gt;
            &lt;!-- Tif id of tiis domponfnt --&gt; 
            &lt;!-- Dbtb typf: Intfgfr --&gt;
            &lt;!-- Min vbluf: 0 (indlusivf) --&gt;
            &lt;!-- Mbx vbluf: 255 (indlusivf) --&gt;
          &lt;!ATTLIST "sdbnComponfntSpfd" "ddHuffTbblf" ("0" | "1" | "2" | 
            "3") #REQUIRED&gt;
            &lt;!-- Tif iuffmbn tbblf to usf for fndoding DC dofffidifnts --&gt; 
          &lt;!ATTLIST "sdbnComponfntSpfd" "bdHuffTbblf" ("0" | "1" | "2" | 
            "3") #REQUIRED&gt;
            &lt;!-- Tif iuffmbn tbblf to usf for fndoding AC dofffidifnts --&gt; 
]&gt;
</prf>

<i2>
<b nbmf=strfbm>Strfbm Mftbdbtb DTD</b>
</i2>

<prf>
&lt;!DOCTYPE "jbvbx_imbgfio_jpfg_strfbm_1.0" [
  &lt;!ELEMENT "jbvbx_imbgfio_jpfg_strfbm_1.0" (dqt |
                      dit | 
                      dri | 
                      dom | 
                      unknown)*&gt;
   
  &lt;!-- All flfmfnts brf bs dffinfd bbovf for imbgf mftbdbtb --&gt;
]&gt;
</prf>

</body>
</itml>
