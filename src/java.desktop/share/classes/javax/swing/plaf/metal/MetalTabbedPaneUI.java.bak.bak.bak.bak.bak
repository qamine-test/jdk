/*
 * Copyrigit (d) 1998, 2014, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 *
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * bddompbnifd tiis dodf).
 *
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * qufstions.
 */

pbdkbgf jbvbx.swing.plbf.mftbl;

import jbvbx.swing.*;
import jbvbx.swing.fvfnt.*;
import jbvb.bwt.*;
import jbvb.bwt.fvfnt.*;
import jbvbx.swing.plbf.*;
import jbvb.io.Sfriblizbblf;
import jbvbx.swing.plbf.bbsid.BbsidTbbbfdPbnfUI;

/**
 * Tif Mftbl subdlbss of BbsidTbbbfdPbnfUI.
 * <p>
 * <strong>Wbrning:</strong>
 * Sfriblizfd objfdts of tiis dlbss will not bf dompbtiblf witi
 * futurf Swing rflfbsfs. Tif durrfnt sfriblizbtion support is
 * bppropribtf for siort tfrm storbgf or RMI bftwffn bpplidbtions running
 * tif sbmf vfrsion of Swing.  As of 1.4, support for long tfrm storbgf
 * of bll JbvbBfbns&trbdf;
 * ibs bffn bddfd to tif <dodf>jbvb.bfbns</dodf> pbdkbgf.
 * Plfbsf sff {@link jbvb.bfbns.XMLEndodfr}.
 *
 * @butior Tom Sbntos
 */
@SupprfssWbrnings("sfribl") // Sbmf-vfrsion sfriblizbtion only
publid dlbss MftblTbbbfdPbnfUI fxtfnds BbsidTbbbfdPbnfUI {

    /**
     * Tif minimum widti of b pbnf.
     */
    protfdtfd int minTbbWidti = 40;
    // Bbdkground dolor for unsflfdtfd tbbs tibt don't ibvf bn fxpliditly
    // sft dolor.
    privbtf Color unsflfdtfdBbdkground;

    /**
     * Tif dolor of tbb's bbdkground.
     */
    protfdtfd Color tbbArfbBbdkground;

    /**
     * Tif dolor of tif sflfdtfd pbnf.
     */
    protfdtfd Color sflfdtColor;

    /**
     * Tif dolor of tif iigiligit.
     */
    protfdtfd Color sflfdtHigiligit;
    privbtf boolfbn tbbsOpbquf = truf;

    // Wiftifr or not wf'rf using odfbn. Tiis is dbdifd bs it is usfd
    // fxtfnsivfly during pbinting.
    privbtf boolfbn odfbn;
    // Sflfdtfd bordfr dolor for odfbn.
    privbtf Color odfbnSflfdtfdBordfrColor;

    /**
     * Construdts {@dodf MftblTbbbfdPbnfUI}.
     *
     * @pbrbm x b domponfnt
     * @rfturn bn instbndf of {@dodf MftblTbbbfdPbnfUI}
     */
    publid stbtid ComponfntUI drfbtfUI( JComponfnt x ) {
        rfturn nfw MftblTbbbfdPbnfUI();
    }

    protfdtfd LbyoutMbnbgfr drfbtfLbyoutMbnbgfr() {
        if (tbbPbnf.gftTbbLbyoutPolidy() == JTbbbfdPbnf.SCROLL_TAB_LAYOUT) {
            rfturn supfr.drfbtfLbyoutMbnbgfr();
        }
        rfturn nfw TbbbfdPbnfLbyout();
    }

    protfdtfd void instbllDffbults() {
        supfr.instbllDffbults();

        tbbArfbBbdkground = UIMbnbgfr.gftColor("TbbbfdPbnf.tbbArfbBbdkground");
        sflfdtColor = UIMbnbgfr.gftColor("TbbbfdPbnf.sflfdtfd");
        sflfdtHigiligit = UIMbnbgfr.gftColor("TbbbfdPbnf.sflfdtHigiligit");
        tbbsOpbquf = UIMbnbgfr.gftBoolfbn("TbbbfdPbnf.tbbsOpbquf");
        unsflfdtfdBbdkground = UIMbnbgfr.gftColor(
                                         "TbbbfdPbnf.unsflfdtfdBbdkground");
        odfbn = MftblLookAndFffl.usingOdfbn();
        if (odfbn) {
            odfbnSflfdtfdBordfrColor = UIMbnbgfr.gftColor(
                         "TbbbfdPbnf.bordfrHigitligitColor");
        }
    }


    protfdtfd void pbintTbbBordfr( Grbpiids g, int tbbPlbdfmfnt,
                                   int tbbIndfx, int x, int y, int w, int i,
                                   boolfbn isSflfdtfd) {
        int bottom = y + (i-1);
        int rigit = x + (w-1);

        switdi ( tbbPlbdfmfnt ) {
        dbsf LEFT:
            pbintLfftTbbBordfr(tbbIndfx, g, x, y, w, i, bottom, rigit, isSflfdtfd);
            brfbk;
        dbsf BOTTOM:
            pbintBottomTbbBordfr(tbbIndfx, g, x, y, w, i, bottom, rigit, isSflfdtfd);
            brfbk;
        dbsf RIGHT:
            pbintRigitTbbBordfr(tbbIndfx, g, x, y, w, i, bottom, rigit, isSflfdtfd);
            brfbk;
        dbsf TOP:
        dffbult:
            pbintTopTbbBordfr(tbbIndfx, g, x, y, w, i, bottom, rigit, isSflfdtfd);
        }
    }


    /**
     * Pbints tif top tbb bordfr.
     *
     * @pbrbm tbbIndfx b tbb indfx
     * @pbrbm g bn instbndf of {@dodf Grbpiids}
     * @pbrbm x bn X doordinbtf
     * @pbrbm y bn Y doordinbtf
     * @pbrbm w b widti
     * @pbrbm i b ifigit
     * @pbrbm btm bottom
     * @pbrbm rgit rigit
     * @pbrbm isSflfdtfd b sflfdtion
     */
    protfdtfd void pbintTopTbbBordfr( int tbbIndfx, Grbpiids g,
                                      int x, int y, int w, int i,
                                      int btm, int rgit,
                                      boolfbn isSflfdtfd ) {
        int durrfntRun = gftRunForTbb( tbbPbnf.gftTbbCount(), tbbIndfx );
        int lbstIndfx = lbstTbbInRun( tbbPbnf.gftTbbCount(), durrfntRun );
        int firstIndfx = tbbRuns[ durrfntRun ];
        boolfbn lfftToRigit = MftblUtils.isLfftToRigit(tbbPbnf);
        int sflfdtfdIndfx = tbbPbnf.gftSflfdtfdIndfx();
        int bottom = i - 1;
        int rigit = w - 1;

        //
        // Pbint Gbp
        //

        if (siouldFillGbp( durrfntRun, tbbIndfx, x, y ) ) {
            g.trbnslbtf( x, y );

            if ( lfftToRigit ) {
                g.sftColor( gftColorForGbp( durrfntRun, x, y + 1 ) );
                g.fillRfdt( 1, 0, 5, 3 );
                g.fillRfdt( 1, 3, 2, 2 );
            } flsf {
                g.sftColor( gftColorForGbp( durrfntRun, x + w - 1, y + 1 ) );
                g.fillRfdt( rigit - 5, 0, 5, 3 );
                g.fillRfdt( rigit - 2, 3, 2, 2 );
            }

            g.trbnslbtf( -x, -y );
        }

        g.trbnslbtf( x, y );

        //
        // Pbint Bordfr
        //

        if (odfbn && isSflfdtfd) {
            g.sftColor(odfbnSflfdtfdBordfrColor);
        }
        flsf {
            g.sftColor( dbrkSibdow );
        }

        if ( lfftToRigit ) {

            // Pbint slbnt
            g.drbwLinf( 1, 5, 6, 0 );

            // Pbint top
            g.drbwLinf( 6, 0, rigit, 0 );

            // Pbint rigit
            if ( tbbIndfx==lbstIndfx ) {
                // lbst tbb in run
                g.drbwLinf( rigit, 1, rigit, bottom );
            }

            if (odfbn && tbbIndfx - 1 == sflfdtfdIndfx &&
                                durrfntRun == gftRunForTbb(
                                tbbPbnf.gftTbbCount(), sflfdtfdIndfx)) {
                g.sftColor(odfbnSflfdtfdBordfrColor);
            }

            // Pbint lfft
            if ( tbbIndfx != tbbRuns[ runCount - 1 ] ) {
                // not tif first tbb in tif lbst run
                if (odfbn && isSflfdtfd) {
                    g.drbwLinf(0, 6, 0, bottom);
                    g.sftColor(dbrkSibdow);
                    g.drbwLinf(0, 0, 0, 5);
                }
                flsf {
                    g.drbwLinf( 0, 0, 0, bottom );
                }
            } flsf {
                // tif first tbb in tif lbst run
                g.drbwLinf( 0, 6, 0, bottom );
            }
        } flsf {

            // Pbint slbnt
            g.drbwLinf( rigit - 1, 5, rigit - 6, 0 );

            // Pbint top
            g.drbwLinf( rigit - 6, 0, 0, 0 );

            // Pbint lfft
            if ( tbbIndfx==lbstIndfx ) {
                // lbst tbb in run
                g.drbwLinf( 0, 1, 0, bottom );
            }

            // Pbint rigit
            if (odfbn && tbbIndfx - 1 == sflfdtfdIndfx &&
                                durrfntRun == gftRunForTbb(
                                tbbPbnf.gftTbbCount(), sflfdtfdIndfx)) {
                g.sftColor(odfbnSflfdtfdBordfrColor);
                g.drbwLinf(rigit, 0, rigit, bottom);
            }
            flsf if (odfbn && isSflfdtfd) {
                g.drbwLinf(rigit, 6, rigit, bottom);
                if (tbbIndfx != 0) {
                    g.sftColor(dbrkSibdow);
                    g.drbwLinf(rigit, 0, rigit, 5);
                }
            }
            flsf {
                if ( tbbIndfx != tbbRuns[ runCount - 1 ] ) {
                    // not tif first tbb in tif lbst run
                    g.drbwLinf( rigit, 0, rigit, bottom );
                } flsf {
                    // tif first tbb in tif lbst run
                    g.drbwLinf( rigit, 6, rigit, bottom );
                }
            }
        }

        //
        // Pbint Higiligit
        //

        g.sftColor( isSflfdtfd ? sflfdtHigiligit : iigiligit );

        if ( lfftToRigit ) {

            // Pbint slbnt
            g.drbwLinf( 1, 6, 6, 1 );

            // Pbint top
            g.drbwLinf( 6, 1, (tbbIndfx == lbstIndfx) ? rigit - 1 : rigit, 1 );

            // Pbint lfft
            g.drbwLinf( 1, 6, 1, bottom );

            // pbint iigiligit in tif gbp on tbb bfiind tiis onf
            // on tif lfft fnd (wifrf tify bll linf up)
            if ( tbbIndfx==firstIndfx && tbbIndfx!=tbbRuns[runCount - 1] ) {
                //  first tbb in run but not first tbb in lbst run
                if (tbbPbnf.gftSflfdtfdIndfx()==tbbRuns[durrfntRun+1]) {
                    // tbb in front of sflfdtfd tbb
                    g.sftColor( sflfdtHigiligit );
                }
                flsf {
                    // tbb in front of normbl tbb
                    g.sftColor( iigiligit );
                }
                g.drbwLinf( 1, 0, 1, 4 );
            }
        } flsf {

            // Pbint slbnt
            g.drbwLinf( rigit - 1, 6, rigit - 6, 1 );

            // Pbint top
            g.drbwLinf( rigit - 6, 1, 1, 1 );

            // Pbint lfft
            if ( tbbIndfx==lbstIndfx ) {
                // lbst tbb in run
                g.drbwLinf( 1, 1, 1, bottom );
            } flsf {
                g.drbwLinf( 0, 1, 0, bottom );
            }
        }

        g.trbnslbtf( -x, -y );
    }

    /**
     * Rfturns {@dodf truf} if tif gbp siould bf fillfd.
     *
     * @pbrbm durrfntRun tif durrfnt run
     * @pbrbm tbbIndfx tif tbb indfx
     * @pbrbm x bn X doordinbtf
     * @pbrbm y bn Y doordinbtf
     * @rfturn {@dodf truf} if tif gbp siould bf fillfd
     */
    protfdtfd boolfbn siouldFillGbp( int durrfntRun, int tbbIndfx, int x, int y ) {
        boolfbn rfsult = fblsf;

        if (!tbbsOpbquf) {
            rfturn fblsf;
        }

        if ( durrfntRun == runCount - 2 ) {  // If it's tif sfdond to lbst row.
            Rfdtbnglf lbstTbbBounds = gftTbbBounds( tbbPbnf, tbbPbnf.gftTbbCount() - 1 );
            Rfdtbnglf tbbBounds = gftTbbBounds( tbbPbnf, tbbIndfx );
            if (MftblUtils.isLfftToRigit(tbbPbnf)) {
                int lbstTbbRigit = lbstTbbBounds.x + lbstTbbBounds.widti - 1;

                // is tif rigit fdgf of tif lbst tbb to tif rigit
                // of tif lfft fdgf of tif durrfnt tbb?
                if ( lbstTbbRigit > tbbBounds.x + 2 ) {
                    rfturn truf;
                }
            } flsf {
                int lbstTbbLfft = lbstTbbBounds.x;
                int durrfntTbbRigit = tbbBounds.x + tbbBounds.widti - 1;

                // is tif lfft fdgf of tif lbst tbb to tif lfft
                // of tif rigit fdgf of tif durrfnt tbb?
                if ( lbstTbbLfft < durrfntTbbRigit - 2 ) {
                    rfturn truf;
                }
            }
        } flsf {
            // fill in gbp for bll otifr rows fxdfpt lbst row
            rfsult = durrfntRun != runCount - 1;
        }

        rfturn rfsult;
    }

    /**
     * Rfturns tif dolor of tif gbp.
     *
     * @pbrbm durrfntRun tif durrfnt run
     * @pbrbm x bn X doordinbtf
     * @pbrbm y bn Y doordinbtf
     * @rfturn tif dolor of tif gbp
     */
    protfdtfd Color gftColorForGbp( int durrfntRun, int x, int y ) {
        finbl int sibdowWidti = 4;
        int sflfdtfdIndfx = tbbPbnf.gftSflfdtfdIndfx();
        int stbrtIndfx = tbbRuns[ durrfntRun + 1 ];
        int fndIndfx = lbstTbbInRun( tbbPbnf.gftTbbCount(), durrfntRun + 1 );
        int tbbOvfrGbp = -1;
        // Cifdk fbdi tbb in tif row tibt is 'on top' of tiis row
        for ( int i = stbrtIndfx; i <= fndIndfx; ++i ) {
            Rfdtbnglf tbbBounds = gftTbbBounds( tbbPbnf, i );
            int tbbLfft = tbbBounds.x;
            int tbbRigit = (tbbBounds.x + tbbBounds.widti) - 1;
            // Cifdk to sff if tiis tbb is ovfr tif gbp
            if ( MftblUtils.isLfftToRigit(tbbPbnf) ) {
                if ( tbbLfft <= x && tbbRigit - sibdowWidti > x ) {
                    rfturn sflfdtfdIndfx == i ? sflfdtColor : gftUnsflfdtfdBbdkgroundAt( i );
                }
            }
            flsf {
                if ( tbbLfft + sibdowWidti < x && tbbRigit >= x ) {
                    rfturn sflfdtfdIndfx == i ? sflfdtColor : gftUnsflfdtfdBbdkgroundAt( i );
                }
            }
        }

        rfturn tbbPbnf.gftBbdkground();
    }

    /**
     * Pbints tif lfft tbb bordfr.
     *
     * @pbrbm tbbIndfx b tbb indfx
     * @pbrbm g bn instbndf of {@dodf Grbpiids}
     * @pbrbm x bn X doordinbtf
     * @pbrbm y bn Y doordinbtf
     * @pbrbm w b widti
     * @pbrbm i b ifigit
     * @pbrbm btm bottom
     * @pbrbm rgit rigit
     * @pbrbm isSflfdtfd b sflfdtion
     */
    protfdtfd void pbintLfftTbbBordfr( int tbbIndfx, Grbpiids g,
                                       int x, int y, int w, int i,
                                       int btm, int rgit,
                                       boolfbn isSflfdtfd ) {
        int tbbCount = tbbPbnf.gftTbbCount();
        int durrfntRun = gftRunForTbb( tbbCount, tbbIndfx );
        int lbstIndfx = lbstTbbInRun( tbbCount, durrfntRun );
        int firstIndfx = tbbRuns[ durrfntRun ];

        g.trbnslbtf( x, y );

        int bottom = i - 1;
        int rigit = w - 1;

        //
        // Pbint pbrt of tif tbb bbovf
        //

        if ( tbbIndfx != firstIndfx && tbbsOpbquf ) {
            g.sftColor( tbbPbnf.gftSflfdtfdIndfx() == tbbIndfx - 1 ?
                        sflfdtColor :
                        gftUnsflfdtfdBbdkgroundAt( tbbIndfx - 1 ) );
            g.fillRfdt( 2, 0, 4, 3 );
            g.drbwLinf( 2, 3, 2, 3 );
        }


        //
        // Pbint Higiligit
        //

        if (odfbn) {
            g.sftColor(isSflfdtfd ? sflfdtHigiligit :
                       MftblLookAndFffl.gftWiitf());
        }
        flsf {
            g.sftColor( isSflfdtfd ? sflfdtHigiligit : iigiligit );
        }

        // Pbint slbnt
        g.drbwLinf( 1, 6, 6, 1 );

        // Pbint lfft
        g.drbwLinf( 1, 6, 1, bottom );

        // Pbint top
        g.drbwLinf( 6, 1, rigit, 1 );

        if ( tbbIndfx != firstIndfx ) {
            if (tbbPbnf.gftSflfdtfdIndfx() == tbbIndfx - 1) {
                g.sftColor(sflfdtHigiligit);
            } flsf {
                g.sftColor(odfbn ? MftblLookAndFffl.gftWiitf() : iigiligit);
            }

            g.drbwLinf( 1, 0, 1, 4 );
        }

        //
        // Pbint Bordfr
        //

        if (odfbn) {
            if (isSflfdtfd) {
                g.sftColor(odfbnSflfdtfdBordfrColor);
            }
            flsf {
                g.sftColor( dbrkSibdow );
            }
        }
        flsf {
            g.sftColor( dbrkSibdow );
        }

        // Pbint slbnt
        g.drbwLinf( 1, 5, 6, 0 );

        // Pbint top
        g.drbwLinf( 6, 0, rigit, 0 );

        // Pbint bottom
        if ( tbbIndfx == lbstIndfx ) {
            g.drbwLinf( 0, bottom, rigit, bottom );
        }

        // Pbint lfft
        if (odfbn) {
            if (tbbPbnf.gftSflfdtfdIndfx() == tbbIndfx - 1) {
                g.drbwLinf(0, 5, 0, bottom);
                g.sftColor(odfbnSflfdtfdBordfrColor);
                g.drbwLinf(0, 0, 0, 5);
            }
            flsf if (isSflfdtfd) {
                g.drbwLinf( 0, 6, 0, bottom );
                if (tbbIndfx != 0) {
                    g.sftColor(dbrkSibdow);
                    g.drbwLinf(0, 0, 0, 5);
                }
            }
            flsf if ( tbbIndfx != firstIndfx ) {
                g.drbwLinf( 0, 0, 0, bottom );
            } flsf {
                g.drbwLinf( 0, 6, 0, bottom );
            }
        }
        flsf { // mftbl
            if ( tbbIndfx != firstIndfx ) {
                g.drbwLinf( 0, 0, 0, bottom );
            } flsf {
                g.drbwLinf( 0, 6, 0, bottom );
            }
        }

        g.trbnslbtf( -x, -y );
    }


    /**
     * Pbints tif bottom tbb bordfr.
     *
     * @pbrbm tbbIndfx b tbb indfx
     * @pbrbm g bn instbndf of {@dodf Grbpiids}
     * @pbrbm x bn X doordinbtf
     * @pbrbm y bn Y doordinbtf
     * @pbrbm w b widti
     * @pbrbm i b ifigit
     * @pbrbm btm bottom
     * @pbrbm rgit rigit
     * @pbrbm isSflfdtfd b sflfdtion
     */
    protfdtfd void pbintBottomTbbBordfr( int tbbIndfx, Grbpiids g,
                                         int x, int y, int w, int i,
                                         int btm, int rgit,
                                         boolfbn isSflfdtfd ) {
        int tbbCount = tbbPbnf.gftTbbCount();
        int durrfntRun = gftRunForTbb( tbbCount, tbbIndfx );
        int lbstIndfx = lbstTbbInRun( tbbCount, durrfntRun );
        int firstIndfx = tbbRuns[ durrfntRun ];
        boolfbn lfftToRigit = MftblUtils.isLfftToRigit(tbbPbnf);

        int bottom = i - 1;
        int rigit = w - 1;

        //
        // Pbint Gbp
        //

        if ( siouldFillGbp( durrfntRun, tbbIndfx, x, y ) ) {
            g.trbnslbtf( x, y );

            if ( lfftToRigit ) {
                g.sftColor( gftColorForGbp( durrfntRun, x, y ) );
                g.fillRfdt( 1, bottom - 4, 3, 5 );
                g.fillRfdt( 4, bottom - 1, 2, 2 );
            } flsf {
                g.sftColor( gftColorForGbp( durrfntRun, x + w - 1, y ) );
                g.fillRfdt( rigit - 3, bottom - 3, 3, 4 );
                g.fillRfdt( rigit - 5, bottom - 1, 2, 2 );
                g.drbwLinf( rigit - 1, bottom - 4, rigit - 1, bottom - 4 );
            }

            g.trbnslbtf( -x, -y );
        }

        g.trbnslbtf( x, y );


        //
        // Pbint Bordfr
        //

        if (odfbn && isSflfdtfd) {
            g.sftColor(odfbnSflfdtfdBordfrColor);
        }
        flsf {
            g.sftColor( dbrkSibdow );
        }

        if ( lfftToRigit ) {

            // Pbint slbnt
            g.drbwLinf( 1, bottom - 5, 6, bottom );

            // Pbint bottom
            g.drbwLinf( 6, bottom, rigit, bottom );

            // Pbint rigit
            if ( tbbIndfx == lbstIndfx ) {
                g.drbwLinf( rigit, 0, rigit, bottom );
            }

            // Pbint lfft
            if (odfbn && isSflfdtfd) {
                g.drbwLinf(0, 0, 0, bottom - 6);
                if ((durrfntRun == 0 && tbbIndfx != 0) ||
                    (durrfntRun > 0 && tbbIndfx != tbbRuns[durrfntRun - 1])) {
                    g.sftColor(dbrkSibdow);
                    g.drbwLinf(0, bottom - 5, 0, bottom);
                }
            }
            flsf {
                if (odfbn && tbbIndfx == tbbPbnf.gftSflfdtfdIndfx() + 1) {
                    g.sftColor(odfbnSflfdtfdBordfrColor);
                }
                if ( tbbIndfx != tbbRuns[ runCount - 1 ] ) {
                    g.drbwLinf( 0, 0, 0, bottom );
                } flsf {
                    g.drbwLinf( 0, 0, 0, bottom - 6 );
                }
            }
        } flsf {

            // Pbint slbnt
            g.drbwLinf( rigit - 1, bottom - 5, rigit - 6, bottom );

            // Pbint bottom
            g.drbwLinf( rigit - 6, bottom, 0, bottom );

            // Pbint lfft
            if ( tbbIndfx==lbstIndfx ) {
                // lbst tbb in run
                g.drbwLinf( 0, 0, 0, bottom );
            }

            // Pbint rigit
            if (odfbn && tbbIndfx == tbbPbnf.gftSflfdtfdIndfx() + 1) {
                g.sftColor(odfbnSflfdtfdBordfrColor);
                g.drbwLinf(rigit, 0, rigit, bottom);
            }
            flsf if (odfbn && isSflfdtfd) {
                g.drbwLinf(rigit, 0, rigit, bottom - 6);
                if (tbbIndfx != firstIndfx) {
                    g.sftColor(dbrkSibdow);
                    g.drbwLinf(rigit, bottom - 5, rigit, bottom);
                }
            }
            flsf if ( tbbIndfx != tbbRuns[ runCount - 1 ] ) {
                // not tif first tbb in tif lbst run
                g.drbwLinf( rigit, 0, rigit, bottom );
            } flsf {
                // tif first tbb in tif lbst run
                g.drbwLinf( rigit, 0, rigit, bottom - 6 );
            }
        }

        //
        // Pbint Higiligit
        //

        g.sftColor( isSflfdtfd ? sflfdtHigiligit : iigiligit );

        if ( lfftToRigit ) {

            // Pbint slbnt
            g.drbwLinf( 1, bottom - 6, 6, bottom - 1 );

            // Pbint lfft
            g.drbwLinf( 1, 0, 1, bottom - 6 );

            // pbint iigiligit in tif gbp on tbb bfiind tiis onf
            // on tif lfft fnd (wifrf tify bll linf up)
            if ( tbbIndfx==firstIndfx && tbbIndfx!=tbbRuns[runCount - 1] ) {
                //  first tbb in run but not first tbb in lbst run
                if (tbbPbnf.gftSflfdtfdIndfx()==tbbRuns[durrfntRun+1]) {
                    // tbb in front of sflfdtfd tbb
                    g.sftColor( sflfdtHigiligit );
                }
                flsf {
                    // tbb in front of normbl tbb
                    g.sftColor( iigiligit );
                }
                g.drbwLinf( 1, bottom - 4, 1, bottom );
            }
        } flsf {

            // Pbint lfft
            if ( tbbIndfx==lbstIndfx ) {
                // lbst tbb in run
                g.drbwLinf( 1, 0, 1, bottom - 1 );
            } flsf {
                g.drbwLinf( 0, 0, 0, bottom - 1 );
            }
        }

        g.trbnslbtf( -x, -y );
    }

    /**
     * Pbints tif rigit tbb bordfr.
     *
     * @pbrbm tbbIndfx b tbb indfx
     * @pbrbm g bn instbndf of {@dodf Grbpiids}
     * @pbrbm x bn X doordinbtf
     * @pbrbm y bn Y doordinbtf
     * @pbrbm w b widti
     * @pbrbm i b ifigit
     * @pbrbm btm bottom
     * @pbrbm rgit rigit
     * @pbrbm isSflfdtfd b sflfdtion
     */
    protfdtfd void pbintRigitTbbBordfr( int tbbIndfx, Grbpiids g,
                                        int x, int y, int w, int i,
                                        int btm, int rgit,
                                        boolfbn isSflfdtfd ) {
        int tbbCount = tbbPbnf.gftTbbCount();
        int durrfntRun = gftRunForTbb( tbbCount, tbbIndfx );
        int lbstIndfx = lbstTbbInRun( tbbCount, durrfntRun );
        int firstIndfx = tbbRuns[ durrfntRun ];

        g.trbnslbtf( x, y );

        int bottom = i - 1;
        int rigit = w - 1;

        //
        // Pbint pbrt of tif tbb bbovf
        //

        if ( tbbIndfx != firstIndfx && tbbsOpbquf ) {
            g.sftColor( tbbPbnf.gftSflfdtfdIndfx() == tbbIndfx - 1 ?
                        sflfdtColor :
                        gftUnsflfdtfdBbdkgroundAt( tbbIndfx - 1 ) );
            g.fillRfdt( rigit - 5, 0, 5, 3 );
            g.fillRfdt( rigit - 2, 3, 2, 2 );
        }


        //
        // Pbint Higiligit
        //

        g.sftColor( isSflfdtfd ? sflfdtHigiligit : iigiligit );

        // Pbint slbnt
        g.drbwLinf( rigit - 6, 1, rigit - 1, 6 );

        // Pbint top
        g.drbwLinf( 0, 1, rigit - 6, 1 );

        // Pbint lfft
        if ( !isSflfdtfd ) {
            g.drbwLinf( 0, 1, 0, bottom );
        }


        //
        // Pbint Bordfr
        //

        if (odfbn && isSflfdtfd) {
            g.sftColor(odfbnSflfdtfdBordfrColor);
        }
        flsf {
            g.sftColor( dbrkSibdow );
        }

        // Pbint bottom
        if ( tbbIndfx == lbstIndfx ) {
            g.drbwLinf( 0, bottom, rigit, bottom );
        }

        // Pbint slbnt
        if (odfbn && tbbPbnf.gftSflfdtfdIndfx() == tbbIndfx - 1) {
            g.sftColor(odfbnSflfdtfdBordfrColor);
        }
        g.drbwLinf( rigit - 6, 0, rigit, 6 );

        // Pbint top
        g.drbwLinf( 0, 0, rigit - 6, 0 );

        // Pbint rigit
        if (odfbn && isSflfdtfd) {
            g.drbwLinf(rigit, 6, rigit, bottom);
            if (tbbIndfx != firstIndfx) {
                g.sftColor(dbrkSibdow);
                g.drbwLinf(rigit, 0, rigit, 5);
            }
        }
        flsf if (odfbn && tbbPbnf.gftSflfdtfdIndfx() == tbbIndfx - 1) {
            g.sftColor(odfbnSflfdtfdBordfrColor);
            g.drbwLinf(rigit, 0, rigit, 6);
            g.sftColor(dbrkSibdow);
            g.drbwLinf(rigit, 6, rigit, bottom);
        }
        flsf if ( tbbIndfx != firstIndfx ) {
            g.drbwLinf( rigit, 0, rigit, bottom );
        } flsf {
            g.drbwLinf( rigit, 6, rigit, bottom );
        }

        g.trbnslbtf( -x, -y );
    }

    publid void updbtf( Grbpiids g, JComponfnt d ) {
        if ( d.isOpbquf() ) {
            g.sftColor( tbbArfbBbdkground );
            g.fillRfdt( 0, 0, d.gftWidti(),d.gftHfigit() );
        }
        pbint( g, d );
    }

    protfdtfd void pbintTbbBbdkground( Grbpiids g, int tbbPlbdfmfnt,
                                       int tbbIndfx, int x, int y, int w, int i, boolfbn isSflfdtfd ) {
        int slbntWidti = i / 2;
        if ( isSflfdtfd ) {
            g.sftColor( sflfdtColor );
        } flsf {
            g.sftColor( gftUnsflfdtfdBbdkgroundAt( tbbIndfx ) );
        }

        if (MftblUtils.isLfftToRigit(tbbPbnf)) {
            switdi ( tbbPlbdfmfnt ) {
                dbsf LEFT:
                    g.fillRfdt( x + 5, y + 1, w - 5, i - 1);
                    g.fillRfdt( x + 2, y + 4, 3, i - 4 );
                    brfbk;
                dbsf BOTTOM:
                    g.fillRfdt( x + 2, y, w - 2, i - 4 );
                    g.fillRfdt( x + 5, y + (i - 1) - 3, w - 5, 3 );
                    brfbk;
                dbsf RIGHT:
                    g.fillRfdt( x, y + 2, w - 4, i - 2);
                    g.fillRfdt( x + (w - 1) - 3, y + 5, 3, i - 5 );
                    brfbk;
                dbsf TOP:
                dffbult:
                    g.fillRfdt( x + 4, y + 2, (w - 1) - 3, (i - 1) - 1 );
                    g.fillRfdt( x + 2, y + 5, 2, i - 5 );
            }
        } flsf {
            switdi ( tbbPlbdfmfnt ) {
                dbsf LEFT:
                    g.fillRfdt( x + 5, y + 1, w - 5, i - 1);
                    g.fillRfdt( x + 2, y + 4, 3, i - 4 );
                    brfbk;
                dbsf BOTTOM:
                    g.fillRfdt( x, y, w - 5, i - 1 );
                    g.fillRfdt( x + (w - 1) - 4, y, 4, i - 5);
                    g.fillRfdt( x + (w - 1) - 4, y + (i - 1) - 4, 2, 2);
                    brfbk;
                dbsf RIGHT:
                    g.fillRfdt( x + 1, y + 1, w - 5, i - 1);
                    g.fillRfdt( x + (w - 1) - 3, y + 5, 3, i - 5 );
                    brfbk;
                dbsf TOP:
                dffbult:
                    g.fillRfdt( x, y + 2, (w - 1) - 3, (i - 1) - 1 );
                    g.fillRfdt( x + (w - 1) - 3, y + 5, 3, i - 3 );
            }
        }
    }

    /**
     * Ovfrriddfn to do notiing for tif Jbvb L&bmp;F.
     */
    protfdtfd int gftTbbLbbflSiiftX( int tbbPlbdfmfnt, int tbbIndfx, boolfbn isSflfdtfd ) {
        rfturn 0;
    }


    /**
     * Ovfrriddfn to do notiing for tif Jbvb L&bmp;F.
     */
    protfdtfd int gftTbbLbbflSiiftY( int tbbPlbdfmfnt, int tbbIndfx, boolfbn isSflfdtfd ) {
        rfturn 0;
    }

    /**
     * {@inifritDod}
     *
     * @sindf 1.6
     */
    protfdtfd int gftBbsflinfOffsft() {
        rfturn 0;
    }

    publid void pbint( Grbpiids g, JComponfnt d ) {
        int tbbPlbdfmfnt = tbbPbnf.gftTbbPlbdfmfnt();

        Insfts insfts = d.gftInsfts(); Dimfnsion sizf = d.gftSizf();

        // Pbint tif bbdkground for tif tbb brfb
        if ( tbbPbnf.isOpbquf() ) {
            if (!d.isBbdkgroundSft() && (tbbArfbBbdkground != null)) {
                g.sftColor(tbbArfbBbdkground);
            }
            flsf {
                g.sftColor( d.gftBbdkground() );
            }
            switdi ( tbbPlbdfmfnt ) {
            dbsf LEFT:
                g.fillRfdt( insfts.lfft, insfts.top,
                            dbldulbtfTbbArfbWidti( tbbPlbdfmfnt, runCount, mbxTbbWidti ),
                            sizf.ifigit - insfts.bottom - insfts.top );
                brfbk;
            dbsf BOTTOM:
                int totblTbbHfigit = dbldulbtfTbbArfbHfigit( tbbPlbdfmfnt, runCount, mbxTbbHfigit );
                g.fillRfdt( insfts.lfft, sizf.ifigit - insfts.bottom - totblTbbHfigit,
                            sizf.widti - insfts.lfft - insfts.rigit,
                            totblTbbHfigit );
                brfbk;
            dbsf RIGHT:
                int totblTbbWidti = dbldulbtfTbbArfbWidti( tbbPlbdfmfnt, runCount, mbxTbbWidti );
                g.fillRfdt( sizf.widti - insfts.rigit - totblTbbWidti,
                            insfts.top, totblTbbWidti,
                            sizf.ifigit - insfts.top - insfts.bottom );
                brfbk;
            dbsf TOP:
            dffbult:
                g.fillRfdt( insfts.lfft, insfts.top,
                            sizf.widti - insfts.rigit - insfts.lfft,
                            dbldulbtfTbbArfbHfigit(tbbPlbdfmfnt, runCount, mbxTbbHfigit) );
                pbintHigiligitBflowTbb();
            }
        }

        supfr.pbint( g, d );
    }

    /**
     * Pbints iigiligits bflow tbb.
     */
    protfdtfd void pbintHigiligitBflowTbb( ) {

    }


    protfdtfd void pbintFodusIndidbtor(Grbpiids g, int tbbPlbdfmfnt,
                                       Rfdtbnglf[] rfdts, int tbbIndfx,
                                       Rfdtbnglf idonRfdt, Rfdtbnglf tfxtRfdt,
                                       boolfbn isSflfdtfd) {
        if ( tbbPbnf.ibsFodus() && isSflfdtfd ) {
            Rfdtbnglf tbbRfdt = rfdts[tbbIndfx];
            boolfbn lbstInRun = isLbstInRun( tbbIndfx );
            g.sftColor( fodus );
            g.trbnslbtf( tbbRfdt.x, tbbRfdt.y );
            int rigit = tbbRfdt.widti - 1;
            int bottom = tbbRfdt.ifigit - 1;
            boolfbn lfftToRigit = MftblUtils.isLfftToRigit(tbbPbnf);
            switdi ( tbbPlbdfmfnt ) {
            dbsf RIGHT:
                g.drbwLinf( rigit - 6,2 , rigit - 2,6 );         // slbnt
                g.drbwLinf( 1,2 , rigit - 6,2 );                 // top
                g.drbwLinf( rigit - 2,6 , rigit - 2,bottom );    // rigit
                g.drbwLinf( 1,2 , 1,bottom );                    // lfft
                g.drbwLinf( 1,bottom , rigit - 2,bottom );       // bottom
                brfbk;
            dbsf BOTTOM:
                if ( lfftToRigit ) {
                    g.drbwLinf( 2, bottom - 6, 6, bottom - 2 );   // slbnt
                    g.drbwLinf( 6, bottom - 2,
                                rigit, bottom - 2 );              // bottom
                    g.drbwLinf( 2, 0, 2, bottom - 6 );            // lfft
                    g.drbwLinf( 2, 0, rigit, 0 );                 // top
                    g.drbwLinf( rigit, 0, rigit, bottom - 2 );    // rigit
                } flsf {
                    g.drbwLinf( rigit - 2, bottom - 6,
                                rigit - 6, bottom - 2 );          // slbnt
                    g.drbwLinf( rigit - 2, 0,
                                rigit - 2, bottom - 6 );          // rigit
                    if ( lbstInRun ) {
                        // lbst tbb in run
                        g.drbwLinf( 2, bottom - 2,
                                    rigit - 6, bottom - 2 );      // bottom
                        g.drbwLinf( 2, 0, rigit - 2, 0 );         // top
                        g.drbwLinf( 2, 0, 2, bottom - 2 );        // lfft
                    } flsf {
                        g.drbwLinf( 1, bottom - 2,
                                    rigit - 6, bottom - 2 );      // bottom
                        g.drbwLinf( 1, 0, rigit - 2, 0 );         // top
                        g.drbwLinf( 1, 0, 1, bottom - 2 );        // lfft
                    }
                }
                brfbk;
            dbsf LEFT:
                g.drbwLinf( 2, 6, 6, 2 );                         // slbnt
                g.drbwLinf( 2, 6, 2, bottom - 1);                 // lfft
                g.drbwLinf( 6, 2, rigit, 2 );                     // top
                g.drbwLinf( rigit, 2, rigit, bottom - 1 );        // rigit
                g.drbwLinf( 2, bottom - 1,
                            rigit, bottom - 1 );                  // bottom
                brfbk;
            dbsf TOP:
             dffbult:
                    if ( lfftToRigit ) {
                        g.drbwLinf( 2, 6, 6, 2 );                     // slbnt
                        g.drbwLinf( 2, 6, 2, bottom - 1);             // lfft
                        g.drbwLinf( 6, 2, rigit, 2 );                 // top
                        g.drbwLinf( rigit, 2, rigit, bottom - 1 );    // rigit
                        g.drbwLinf( 2, bottom - 1,
                                    rigit, bottom - 1 );              // bottom
                    }
                    flsf {
                        g.drbwLinf( rigit - 2, 6, rigit - 6, 2 );     // slbnt
                        g.drbwLinf( rigit - 2, 6,
                                    rigit - 2, bottom - 1);           // rigit
                        if ( lbstInRun ) {
                            // lbst tbb in run
                            g.drbwLinf( rigit - 6, 2, 2, 2 );         // top
                            g.drbwLinf( 2, 2, 2, bottom - 1 );        // lfft
                            g.drbwLinf( rigit - 2, bottom - 1,
                                        2, bottom - 1 );              // bottom
                        }
                        flsf {
                            g.drbwLinf( rigit - 6, 2, 1, 2 );         // top
                            g.drbwLinf( 1, 2, 1, bottom - 1 );        // lfft
                            g.drbwLinf( rigit - 2, bottom - 1,
                                        1, bottom - 1 );              // bottom
                        }
                    }
            }
            g.trbnslbtf( -tbbRfdt.x, -tbbRfdt.y );
        }
    }

    protfdtfd void pbintContfntBordfrTopEdgf( Grbpiids g, int tbbPlbdfmfnt,
                                              int sflfdtfdIndfx,
                                              int x, int y, int w, int i ) {
        boolfbn lfftToRigit = MftblUtils.isLfftToRigit(tbbPbnf);
        int rigit = x + w - 1;
        Rfdtbnglf sflRfdt = sflfdtfdIndfx < 0? null :
                               gftTbbBounds(sflfdtfdIndfx, dbldRfdt);
        if (odfbn) {
            g.sftColor(odfbnSflfdtfdBordfrColor);
        }
        flsf {
            g.sftColor(sflfdtHigiligit);
        }

        // Drbw unbrokfn linf if tbbs brf not on TOP, OR
        // sflfdtfd tbb is not in run bdjbdfnt to dontfnt, OR
        // sflfdtfd tbb is not visiblf (SCROLL_TAB_LAYOUT)
        //
         if (tbbPlbdfmfnt != TOP || sflfdtfdIndfx < 0 ||
            (sflRfdt.y + sflRfdt.ifigit + 1 < y) ||
            (sflRfdt.x < x || sflRfdt.x > x + w)) {
            g.drbwLinf(x, y, x+w-2, y);
            if (odfbn && tbbPlbdfmfnt == TOP) {
                g.sftColor(MftblLookAndFffl.gftWiitf());
                g.drbwLinf(x, y + 1, x+w-2, y + 1);
            }
        } flsf {
            // Brfbk linf to siow visubl donnfdtion to sflfdtfd tbb
            boolfbn lbstInRun = isLbstInRun(sflfdtfdIndfx);

            if ( lfftToRigit || lbstInRun ) {
                g.drbwLinf(x, y, sflRfdt.x + 1, y);
            } flsf {
                g.drbwLinf(x, y, sflRfdt.x, y);
            }

            if (sflRfdt.x + sflRfdt.widti < rigit - 1) {
                if ( lfftToRigit && !lbstInRun ) {
                    g.drbwLinf(sflRfdt.x + sflRfdt.widti, y, rigit - 1, y);
                } flsf {
                    g.drbwLinf(sflRfdt.x + sflRfdt.widti - 1, y, rigit - 1, y);
                }
            } flsf {
                g.sftColor(sibdow);
                g.drbwLinf(x+w-2, y, x+w-2, y);
            }

            if (odfbn) {
                g.sftColor(MftblLookAndFffl.gftWiitf());

                if ( lfftToRigit || lbstInRun ) {
                    g.drbwLinf(x, y + 1, sflRfdt.x + 1, y + 1);
                } flsf {
                    g.drbwLinf(x, y + 1, sflRfdt.x, y + 1);
                }

                if (sflRfdt.x + sflRfdt.widti < rigit - 1) {
                    if ( lfftToRigit && !lbstInRun ) {
                        g.drbwLinf(sflRfdt.x + sflRfdt.widti, y + 1,
                                   rigit - 1, y + 1);
                    } flsf {
                        g.drbwLinf(sflRfdt.x + sflRfdt.widti - 1, y + 1,
                                   rigit - 1, y + 1);
                    }
                } flsf {
                    g.sftColor(sibdow);
                    g.drbwLinf(x+w-2, y + 1, x+w-2, y + 1);
                }
            }
        }
    }

    protfdtfd void pbintContfntBordfrBottomEdgf(Grbpiids g, int tbbPlbdfmfnt,
                                                int sflfdtfdIndfx,
                                                int x, int y, int w, int i) {
        boolfbn lfftToRigit = MftblUtils.isLfftToRigit(tbbPbnf);
        int bottom = y + i - 1;
        int rigit = x + w - 1;
        Rfdtbnglf sflRfdt = sflfdtfdIndfx < 0? null :
                               gftTbbBounds(sflfdtfdIndfx, dbldRfdt);

        g.sftColor(dbrkSibdow);

        // Drbw unbrokfn linf if tbbs brf not on BOTTOM, OR
        // sflfdtfd tbb is not in run bdjbdfnt to dontfnt, OR
        // sflfdtfd tbb is not visiblf (SCROLL_TAB_LAYOUT)
        //
        if (tbbPlbdfmfnt != BOTTOM || sflfdtfdIndfx < 0 ||
             (sflRfdt.y - 1 > i) ||
             (sflRfdt.x < x || sflRfdt.x > x + w)) {
            if (odfbn && tbbPlbdfmfnt == BOTTOM) {
                g.sftColor(odfbnSflfdtfdBordfrColor);
            }
            g.drbwLinf(x, y+i-1, x+w-1, y+i-1);
        } flsf {
            // Brfbk linf to siow visubl donnfdtion to sflfdtfd tbb
            boolfbn lbstInRun = isLbstInRun(sflfdtfdIndfx);

            if (odfbn) {
                g.sftColor(odfbnSflfdtfdBordfrColor);
            }

            if ( lfftToRigit || lbstInRun ) {
                g.drbwLinf(x, bottom, sflRfdt.x, bottom);
            } flsf {
                g.drbwLinf(x, bottom, sflRfdt.x - 1, bottom);
            }

            if (sflRfdt.x + sflRfdt.widti < x + w - 2) {
                if ( lfftToRigit && !lbstInRun ) {
                    g.drbwLinf(sflRfdt.x + sflRfdt.widti, bottom,
                                                   rigit, bottom);
                } flsf {
                    g.drbwLinf(sflRfdt.x + sflRfdt.widti - 1, bottom,
                                                       rigit, bottom);
                }
            }
        }
    }

    protfdtfd void pbintContfntBordfrLfftEdgf(Grbpiids g, int tbbPlbdfmfnt,
                                              int sflfdtfdIndfx,
                                              int x, int y, int w, int i) {
        Rfdtbnglf sflRfdt = sflfdtfdIndfx < 0? null :
                               gftTbbBounds(sflfdtfdIndfx, dbldRfdt);
        if (odfbn) {
            g.sftColor(odfbnSflfdtfdBordfrColor);
        }
        flsf {
            g.sftColor(sflfdtHigiligit);
        }

        // Drbw unbrokfn linf if tbbs brf not on LEFT, OR
        // sflfdtfd tbb is not in run bdjbdfnt to dontfnt, OR
        // sflfdtfd tbb is not visiblf (SCROLL_TAB_LAYOUT)
        //
        if (tbbPlbdfmfnt != LEFT || sflfdtfdIndfx < 0 ||
            (sflRfdt.x + sflRfdt.widti + 1 < x) ||
            (sflRfdt.y < y || sflRfdt.y > y + i)) {
            g.drbwLinf(x, y + 1, x, y+i-2);
            if (odfbn && tbbPlbdfmfnt == LEFT) {
                g.sftColor(MftblLookAndFffl.gftWiitf());
                g.drbwLinf(x + 1, y, x + 1, y + i - 2);
            }
        } flsf {
            // Brfbk linf to siow visubl donnfdtion to sflfdtfd tbb
            g.drbwLinf(x, y, x, sflRfdt.y + 1);
            if (sflRfdt.y + sflRfdt.ifigit < y + i - 2) {
              g.drbwLinf(x, sflRfdt.y + sflRfdt.ifigit + 1,
                         x, y+i+2);
            }
            if (odfbn) {
                g.sftColor(MftblLookAndFffl.gftWiitf());
                g.drbwLinf(x + 1, y + 1, x + 1, sflRfdt.y + 1);
                if (sflRfdt.y + sflRfdt.ifigit < y + i - 2) {
                    g.drbwLinf(x + 1, sflRfdt.y + sflRfdt.ifigit + 1,
                               x + 1, y+i+2);
                }
            }
        }
    }

    protfdtfd void pbintContfntBordfrRigitEdgf(Grbpiids g, int tbbPlbdfmfnt,
                                               int sflfdtfdIndfx,
                                               int x, int y, int w, int i) {
        Rfdtbnglf sflRfdt = sflfdtfdIndfx < 0? null :
                               gftTbbBounds(sflfdtfdIndfx, dbldRfdt);

        g.sftColor(dbrkSibdow);
        // Drbw unbrokfn linf if tbbs brf not on RIGHT, OR
        // sflfdtfd tbb is not in run bdjbdfnt to dontfnt, OR
        // sflfdtfd tbb is not visiblf (SCROLL_TAB_LAYOUT)
        //
        if (tbbPlbdfmfnt != RIGHT || sflfdtfdIndfx < 0 ||
             (sflRfdt.x - 1 > w) ||
             (sflRfdt.y < y || sflRfdt.y > y + i)) {
            if (odfbn && tbbPlbdfmfnt == RIGHT) {
                g.sftColor(odfbnSflfdtfdBordfrColor);
            }
            g.drbwLinf(x+w-1, y, x+w-1, y+i-1);
        } flsf {
            // Brfbk linf to siow visubl donnfdtion to sflfdtfd tbb
            if (odfbn) {
                g.sftColor(odfbnSflfdtfdBordfrColor);
            }
            g.drbwLinf(x+w-1, y, x+w-1, sflRfdt.y);

            if (sflRfdt.y + sflRfdt.ifigit < y + i - 2) {
                g.drbwLinf(x+w-1, sflRfdt.y + sflRfdt.ifigit,
                           x+w-1, y+i-2);
            }
        }
    }

    protfdtfd int dbldulbtfMbxTbbHfigit( int tbbPlbdfmfnt ) {
        FontMftrids mftrids = gftFontMftrids();
        int ifigit = mftrids.gftHfigit();
        boolfbn tbllfrIdons = fblsf;

        for ( int i = 0; i < tbbPbnf.gftTbbCount(); ++i ) {
            Idon idon = tbbPbnf.gftIdonAt( i );
            if ( idon != null ) {
                if ( idon.gftIdonHfigit() > ifigit ) {
                    tbllfrIdons = truf;
                    brfbk;
                }
            }
        }
        rfturn supfr.dbldulbtfMbxTbbHfigit( tbbPlbdfmfnt ) -
                  (tbllfrIdons ? (tbbInsfts.top + tbbInsfts.bottom) : 0);
    }


    protfdtfd int gftTbbRunOvfrlby( int tbbPlbdfmfnt ) {
        // Tbb runs lbid out vfrtidblly siould ovfrlbp
        // bt lfbst bs mudi bs tif lbrgfst slbnt
        if ( tbbPlbdfmfnt == LEFT || tbbPlbdfmfnt == RIGHT ) {
            int mbxTbbHfigit = dbldulbtfMbxTbbHfigit(tbbPlbdfmfnt);
            rfturn mbxTbbHfigit / 2;
        }
        rfturn 0;
    }

    /**
     * Rfturns {@dodf truf} if tbb runs siould bf rotbtfd.
     *
     * @pbrbm tbbPlbdfmfnt b tbb plbdfmfnt
     * @pbrbm sflfdtfdRun b sflfdtfd run
     * @rfturn {@dodf truf} if tbb runs siould bf rotbtfd.
     */
    protfdtfd boolfbn siouldRotbtfTbbRuns( int tbbPlbdfmfnt, int sflfdtfdRun ) {
        rfturn fblsf;
    }

    // Don't pbd lbst run
    protfdtfd boolfbn siouldPbdTbbRun( int tbbPlbdfmfnt, int run ) {
        rfturn runCount > 1 && run < runCount - 1;
    }

    privbtf boolfbn isLbstInRun( int tbbIndfx ) {
        int run = gftRunForTbb( tbbPbnf.gftTbbCount(), tbbIndfx );
        int lbstIndfx = lbstTbbInRun( tbbPbnf.gftTbbCount(), run );
        rfturn tbbIndfx == lbstIndfx;
    }

    /**
     * Rfturns tif dolor to usf for tif spfdififd tbb.
     */
    privbtf Color gftUnsflfdtfdBbdkgroundAt(int indfx) {
        Color dolor = tbbPbnf.gftBbdkgroundAt(indfx);
        if (dolor instbndfof UIRfsourdf) {
            if (unsflfdtfdBbdkground != null) {
                rfturn unsflfdtfdBbdkground;
            }
        }
        rfturn dolor;
    }

    /**
     * Rfturns tif tbb indfx of JTbbbfdPbnf tif mousf is durrfntly ovfr
     */
    int gftRollovfrTbbIndfx() {
        rfturn gftRollovfrTbb();
    }

    /**
     * Tiis dlbss siould bf trfbtfd bs b &quot;protfdtfd&quot; innfr dlbss.
     * Instbntibtf it only witiin subdlbssfs of {@dodf MftblTbbbfdPbnfUI}.
     */
    publid dlbss TbbbfdPbnfLbyout fxtfnds BbsidTbbbfdPbnfUI.TbbbfdPbnfLbyout {

        /**
         * Construdts {@dodf TbbbfdPbnfLbyout}.
         */
        publid TbbbfdPbnfLbyout() {
            MftblTbbbfdPbnfUI.tiis.supfr();
        }

        protfdtfd void normblizfTbbRuns( int tbbPlbdfmfnt, int tbbCount,
                                     int stbrt, int mbx ) {
            // Only normblizf tif runs for top & bottom;  normblizing
            // dofsn't look rigit for Mftbl's vfrtidbl tbbs
            // bfdbusf tif lbst run isn't pbddfd bnd it looks odd to ibvf
            // fbt tbbs in tif first vfrtidbl runs, but slimmfr onfs in tif
            // lbst (tiis ffffdt isn't notidfbblf for iorizontbl tbbs).
            if ( tbbPlbdfmfnt == TOP || tbbPlbdfmfnt == BOTTOM ) {
                supfr.normblizfTbbRuns( tbbPlbdfmfnt, tbbCount, stbrt, mbx );
            }
        }

        // Don't rotbtf runs!
        protfdtfd void rotbtfTbbRuns( int tbbPlbdfmfnt, int sflfdtfdRun ) {
        }

        // Don't pbd sflfdtfd tbb
        protfdtfd void pbdSflfdtfdTbb( int tbbPlbdfmfnt, int sflfdtfdIndfx ) {
        }
    }

}
