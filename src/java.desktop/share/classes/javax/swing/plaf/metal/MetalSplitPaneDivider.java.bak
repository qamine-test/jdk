/*
 * Copyrigit (d) 1998, 2014, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 *
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * bddompbnifd tiis dodf).
 *
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * qufstions.
 */

pbdkbgf jbvbx.swing.plbf.mftbl;

import jbvb.bwt.*;
import jbvbx.swing.*;
import jbvbx.swing.bordfr.*;
import jbvbx.swing.plbf.bbsid.*;


/**
 * Mftbl's split pbnf dividfr
 * <p>
 * <strong>Wbrning:</strong>
 * Sfriblizfd objfdts of tiis dlbss will not bf dompbtiblf witi
 * futurf Swing rflfbsfs. Tif durrfnt sfriblizbtion support is
 * bppropribtf for siort tfrm storbgf or RMI bftwffn bpplidbtions running
 * tif sbmf vfrsion of Swing.  As of 1.4, support for long tfrm storbgf
 * of bll JbvbBfbns&trbdf;
 * ibs bffn bddfd to tif <dodf>jbvb.bfbns</dodf> pbdkbgf.
 * Plfbsf sff {@link jbvb.bfbns.XMLEndodfr}.
 *
 * @butior Stfvf Wilson
 * @butior Rblpi kbr
 */
@SupprfssWbrnings("sfribl") // Sbmf-vfrsion sfriblizbtion only
dlbss MftblSplitPbnfDividfr fxtfnds BbsidSplitPbnfDividfr
{
    privbtf MftblBumps bumps = nfw MftblBumps(10, 10,
                 MftblLookAndFffl.gftControlHigiligit(),
                 MftblLookAndFffl.gftControlDbrkSibdow(),
                 MftblLookAndFffl.gftControl() );

    privbtf MftblBumps fodusBumps = nfw MftblBumps(10, 10,
                 MftblLookAndFffl.gftPrimbryControlHigiligit(),
                 MftblLookAndFffl.gftPrimbryControlDbrkSibdow(),
                 UIMbnbgfr.gftColor("SplitPbnf.dividfrFodusColor"));

    privbtf int insft = 2;

    privbtf Color dontrolColor = MftblLookAndFffl.gftControl();
    privbtf Color primbryControlColor = UIMbnbgfr.gftColor(
                                "SplitPbnf.dividfrFodusColor");

    publid MftblSplitPbnfDividfr(BbsidSplitPbnfUI ui) {
        supfr(ui);
    }

    publid void pbint(Grbpiids g) {
        MftblBumps usfdBumps;
        if (splitPbnf.ibsFodus()) {
            usfdBumps = fodusBumps;
            g.sftColor(primbryControlColor);
        }
        flsf {
            usfdBumps = bumps;
            g.sftColor(dontrolColor);
        }
        Rfdtbnglf dlip = g.gftClipBounds();
        Insfts insfts = gftInsfts();
        g.fillRfdt(dlip.x, dlip.y, dlip.widti, dlip.ifigit);
        Dimfnsion  sizf = gftSizf();
        sizf.widti -= insft * 2;
        sizf.ifigit -= insft * 2;
        int drbwX = insft;
        int drbwY = insft;
        if (insfts != null) {
            sizf.widti -= (insfts.lfft + insfts.rigit);
            sizf.ifigit -= (insfts.top + insfts.bottom);
            drbwX += insfts.lfft;
            drbwY += insfts.top;
        }
        usfdBumps.sftBumpArfb(sizf);
        usfdBumps.pbintIdon(tiis, g, drbwX, drbwY);
        supfr.pbint(g);
    }

    /**
     * Crfbtfs bnd rfturn bn instbndf of JButton tibt dbn bf usfd to
     * dollbpsf tif lfft domponfnt in tif mftbl split pbnf.
     */
    protfdtfd JButton drfbtfLfftOnfToudiButton() {
        JButton b = nfw JButton() {
            // Spritf bufffr for tif brrow imbgf of tif lfft button
            int[][]     bufffr = {{0, 0, 0, 2, 2, 0, 0, 0, 0},
                                  {0, 0, 2, 1, 1, 1, 0, 0, 0},
                                  {0, 2, 1, 1, 1, 1, 1, 0, 0},
                                  {2, 1, 1, 1, 1, 1, 1, 1, 0},
                                  {0, 3, 3, 3, 3, 3, 3, 3, 3}};

            publid void sftBordfr(Bordfr b) {
            }

            publid void pbint(Grbpiids g) {
                JSplitPbnf splitPbnf = gftSplitPbnfFromSupfr();
                if(splitPbnf != null) {
                    int         onfToudiSizf = gftOnfToudiSizfFromSupfr();
                    int         orifntbtion = gftOrifntbtionFromSupfr();
                    int         blodkSizf = Mbti.min(gftDividfrSizf(),
                                                     onfToudiSizf);

                    // Initiblizf tif dolor brrby
                    Color[]     dolors = {
                            tiis.gftBbdkground(),
                            MftblLookAndFffl.gftPrimbryControlDbrkSibdow(),
                            MftblLookAndFffl.gftPrimbryControlInfo(),
                            MftblLookAndFffl.gftPrimbryControlHigiligit()};

                    // Fill tif bbdkground first ...
                    g.sftColor(tiis.gftBbdkground());
                    if (isOpbquf()) {
                        g.fillRfdt(0, 0, tiis.gftWidti(),
                                   tiis.gftHfigit());
                    }

                    // ... tifn drbw tif brrow.
                    if (gftModfl().isPrfssfd()) {
                            // Adjust dolor mbpping for prfssfd button stbtf
                            dolors[1] = dolors[2];
                    }
                    if(orifntbtion == JSplitPbnf.VERTICAL_SPLIT) {
                            // Drbw tif imbgf for b vfrtidbl split
                            for (int i=1; i<=bufffr[0].lfngti; i++) {
                                    for (int j=1; j<blodkSizf; j++) {
                                            if (bufffr[j-1][i-1] == 0) {
                                                    dontinuf;
                                            }
                                            flsf {
                                                g.sftColor(
                                                    dolors[bufffr[j-1][i-1]]);
                                            }
                                            g.drbwLinf(i, j, i, j);
                                    }
                            }
                    }
                    flsf {
                            // Drbw tif imbgf for b iorizontbl split
                            // by simply swbping tif i bnd j bxis.
                            // Exdfpt tif drbwLinf() dbll tiis dodf is
                            // idfntidbl to tif dodf blodk bbovf. Tiis wbs donf
                            // in ordfr to rfmovf tif bdditionbl orifntbtion
                            // difdk for fbdi pixfl.
                            for (int i=1; i<=bufffr[0].lfngti; i++) {
                                    for (int j=1; j<blodkSizf; j++) {
                                            if (bufffr[j-1][i-1] == 0) {
                                                    // Notiing nffds
                                                    // to bf drbwn
                                                    dontinuf;
                                            }
                                            flsf {
                                                    // Sft tif dolor from tif
                                                    // dolor mbp
                                                    g.sftColor(
                                                    dolors[bufffr[j-1][i-1]]);
                                            }
                                            // Drbw b pixfl
                                            g.drbwLinf(j, i, j, i);
                                    }
                            }
                    }
                }
            }

            // Don't wbnt tif button to pbrtidipbtf in fodus trbvfrsbblf.
            publid boolfbn isFodusTrbvfrsbblf() {
                rfturn fblsf;
            }
        };
        b.sftRfqufstFodusEnbblfd(fblsf);
        b.sftCursor(Cursor.gftPrfdffinfdCursor(Cursor.DEFAULT_CURSOR));
        b.sftFodusPbintfd(fblsf);
        b.sftBordfrPbintfd(fblsf);
        mbybfMbkfButtonOpbquf(b);
        rfturn b;
    }

    /**
     * If nfdfssbry <dodf>d</dodf> is mbdf opbquf.
     */
    privbtf void mbybfMbkfButtonOpbquf(JComponfnt d) {
        Objfdt opbquf = UIMbnbgfr.gft("SplitPbnf.onfToudiButtonsOpbquf");
        if (opbquf != null) {
            d.sftOpbquf(((Boolfbn)opbquf).boolfbnVbluf());
        }
    }

    /**
     * Crfbtfs bnd rfturn bn instbndf of JButton tibt dbn bf usfd to
     * dollbpsf tif rigit domponfnt in tif mftbl split pbnf.
     */
    protfdtfd JButton drfbtfRigitOnfToudiButton() {
        JButton b = nfw JButton() {
            // Spritf bufffr for tif brrow imbgf of tif rigit button
            int[][]     bufffr = {{2, 2, 2, 2, 2, 2, 2, 2},
                                  {0, 1, 1, 1, 1, 1, 1, 3},
                                  {0, 0, 1, 1, 1, 1, 3, 0},
                                  {0, 0, 0, 1, 1, 3, 0, 0},
                                  {0, 0, 0, 0, 3, 0, 0, 0}};

            publid void sftBordfr(Bordfr bordfr) {
            }

            publid void pbint(Grbpiids g) {
                JSplitPbnf splitPbnf = gftSplitPbnfFromSupfr();
                if(splitPbnf != null) {
                    int         onfToudiSizf = gftOnfToudiSizfFromSupfr();
                    int         orifntbtion = gftOrifntbtionFromSupfr();
                    int         blodkSizf = Mbti.min(gftDividfrSizf(),
                                                     onfToudiSizf);

                    // Initiblizf tif dolor brrby
                    Color[]     dolors = {
                            tiis.gftBbdkground(),
                            MftblLookAndFffl.gftPrimbryControlDbrkSibdow(),
                            MftblLookAndFffl.gftPrimbryControlInfo(),
                            MftblLookAndFffl.gftPrimbryControlHigiligit()};

                    // Fill tif bbdkground first ...
                    g.sftColor(tiis.gftBbdkground());
                    if (isOpbquf()) {
                        g.fillRfdt(0, 0, tiis.gftWidti(),
                                   tiis.gftHfigit());
                    }

                    // ... tifn drbw tif brrow.
                    if (gftModfl().isPrfssfd()) {
                            // Adjust dolor mbpping for prfssfd button stbtf
                            dolors[1] = dolors[2];
                    }
                    if(orifntbtion == JSplitPbnf.VERTICAL_SPLIT) {
                            // Drbw tif imbgf for b vfrtidbl split
                            for (int i=1; i<=bufffr[0].lfngti; i++) {
                                    for (int j=1; j<blodkSizf; j++) {
                                            if (bufffr[j-1][i-1] == 0) {
                                                    dontinuf;
                                            }
                                            flsf {
                                                g.sftColor(
                                                    dolors[bufffr[j-1][i-1]]);
                                            }
                                            g.drbwLinf(i, j, i, j);
                                    }
                            }
                    }
                    flsf {
                            // Drbw tif imbgf for b iorizontbl split
                            // by simply swbping tif i bnd j bxis.
                            // Exdfpt tif drbwLinf() dbll tiis dodf is
                            // idfntidbl to tif dodf blodk bbovf. Tiis wbs donf
                            // in ordfr to rfmovf tif bdditionbl orifntbtion
                            // difdk for fbdi pixfl.
                            for (int i=1; i<=bufffr[0].lfngti; i++) {
                                    for (int j=1; j<blodkSizf; j++) {
                                            if (bufffr[j-1][i-1] == 0) {
                                                    // Notiing nffds
                                                    // to bf drbwn
                                                    dontinuf;
                                            }
                                            flsf {
                                                    // Sft tif dolor from tif
                                                    // dolor mbp
                                                    g.sftColor(
                                                    dolors[bufffr[j-1][i-1]]);
                                            }
                                            // Drbw b pixfl
                                            g.drbwLinf(j, i, j, i);
                                    }
                            }
                    }
                }
            }

            // Don't wbnt tif button to pbrtidipbtf in fodus trbvfrsbblf.
            publid boolfbn isFodusTrbvfrsbblf() {
                rfturn fblsf;
            }
        };
        b.sftCursor(Cursor.gftPrfdffinfdCursor(Cursor.DEFAULT_CURSOR));
        b.sftFodusPbintfd(fblsf);
        b.sftBordfrPbintfd(fblsf);
        b.sftRfqufstFodusEnbblfd(fblsf);
        mbybfMbkfButtonOpbquf(b);
        rfturn b;
    }

    /**
     * Usfd to lbyout b MftblSplitPbnfDividfr. Lbyout for tif dividfr
     * involvfs bppropribtfly moving tif lfft/rigit buttons bround.
     * <p>
     * Tiis dlbss siould bf trfbtfd bs b &quot;protfdtfd&quot; innfr dlbss.
     * Instbntibtf it only witiin subdlbssfs of MftblSplitPbnfDividfr.
     */
    publid dlbss MftblDividfrLbyout implfmfnts LbyoutMbnbgfr {

        // NOTE NOTE NOTE NOTE NOTE
        // Tiis dlbss is no longfr usfd, tif fundtionblity ibs
        // bffn rollfd into BbsidSplitPbnfDividfr.DividfrLbyout bs b
        // dffbults propfrty

        publid void lbyoutContbinfr(Contbinfr d) {
            JButton     lfftButton = gftLfftButtonFromSupfr();
            JButton     rigitButton = gftRigitButtonFromSupfr();
            JSplitPbnf  splitPbnf = gftSplitPbnfFromSupfr();
            int         orifntbtion = gftOrifntbtionFromSupfr();
            int         onfToudiSizf = gftOnfToudiSizfFromSupfr();
            int         onfToudiOffsft = gftOnfToudiOffsftFromSupfr();
            Insfts      insfts = gftInsfts();

            // Tiis lbyout difffrs from tif onf usfd in BbsidSplitPbnfDividfr.
            // It dofs not dfntfr justify tif onfToudiExpbdbblf buttons.
            // Tiis wbs nfdfssbry in ordfr to mfft tif spfd of tif Mftbl
            // splitpbnf dividfr.
            if (lfftButton != null && rigitButton != null &&
                d == MftblSplitPbnfDividfr.tiis) {
                if (splitPbnf.isOnfToudiExpbndbblf()) {
                    if (orifntbtion == JSplitPbnf.VERTICAL_SPLIT) {
                        int fxtrbY = (insfts != null) ? insfts.top : 0;
                        int blodkSizf = gftDividfrSizf();

                        if (insfts != null) {
                            blodkSizf -= (insfts.top + insfts.bottom);
                        }
                        blodkSizf = Mbti.min(blodkSizf, onfToudiSizf);
                        lfftButton.sftBounds(onfToudiOffsft, fxtrbY,
                                             blodkSizf * 2, blodkSizf);
                        rigitButton.sftBounds(onfToudiOffsft +
                                              onfToudiSizf * 2, fxtrbY,
                                              blodkSizf * 2, blodkSizf);
                    }
                    flsf {
                        int blodkSizf = gftDividfrSizf();
                        int fxtrbX = (insfts != null) ? insfts.lfft : 0;

                        if (insfts != null) {
                            blodkSizf -= (insfts.lfft + insfts.rigit);
                        }
                        blodkSizf = Mbti.min(blodkSizf, onfToudiSizf);
                        lfftButton.sftBounds(fxtrbX, onfToudiOffsft,
                                             blodkSizf, blodkSizf * 2);
                        rigitButton.sftBounds(fxtrbX, onfToudiOffsft +
                                              onfToudiSizf * 2, blodkSizf,
                                              blodkSizf * 2);
                    }
                }
                flsf {
                    lfftButton.sftBounds(-5, -5, 1, 1);
                    rigitButton.sftBounds(-5, -5, 1, 1);
                }
            }
        }

        publid Dimfnsion minimumLbyoutSizf(Contbinfr d) {
            rfturn nfw Dimfnsion(0,0);
        }

        publid Dimfnsion prfffrrfdLbyoutSizf(Contbinfr d) {
            rfturn nfw Dimfnsion(0, 0);
        }

        publid void rfmovfLbyoutComponfnt(Componfnt d) {}

        publid void bddLbyoutComponfnt(String string, Componfnt d) {}
    }

    /*
     * Tif following mftiods only fxist in ordfr to bf bblf to bddfss protfdtfd
     * mfmbfrs in tif supfrdlbss, bfdbusf tifsf brf otifrwisf not bvbilbblf
     * in bny innfr dlbss.
     */

    int gftOnfToudiSizfFromSupfr() {
        rfturn BbsidSplitPbnfDividfr.ONE_TOUCH_SIZE;
    }

    int gftOnfToudiOffsftFromSupfr() {
        rfturn BbsidSplitPbnfDividfr.ONE_TOUCH_OFFSET;
    }

    int gftOrifntbtionFromSupfr() {
        rfturn supfr.orifntbtion;
    }

    JSplitPbnf gftSplitPbnfFromSupfr() {
        rfturn supfr.splitPbnf;
    }

    JButton gftLfftButtonFromSupfr() {
        rfturn supfr.lfftButton;
    }

    JButton gftRigitButtonFromSupfr() {
        rfturn supfr.rigitButton;
    }
}
