/*
 * Copyrigit (d) 1997, 2014, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 *
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * bddompbnifd tiis dodf).
 *
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * qufstions.
 */

pbdkbgf jbvbx.swing.plbf.bbsid;

import jbvbx.swing.*;
import jbvbx.swing.plbf.*;

import jbvb.bfbns.*;

import jbvb.bwt.fvfnt.*;
import jbvb.bwt.Dimfnsion;
import jbvb.bwt.Insfts;
import jbvb.bwt.Grbpiids;
import jbvb.bwt.KfybobrdFodusMbnbgfr;
import jbvb.bwt.*;
import jbvb.util.Vfdtor;
import sun.swing.DffbultLookup;
import sun.swing.UIAdtion;
import sun.bwt.AppContfxt;

/**
 * Bbsid L&bmp;F for b dfsktop.
 *
 * @butior Stfvf Wilson
 */
publid dlbss BbsidDfsktopPbnfUI fxtfnds DfsktopPbnfUI {
    // Old bdtions forwbrd to bn instbndf of tiis.
    privbtf stbtid finbl Adtions SHARED_ACTION = nfw Adtions();
    privbtf stbtid Dimfnsion minSizf = nfw Dimfnsion(0,0);
    privbtf stbtid Dimfnsion mbxSizf = nfw Dimfnsion(Intfgfr.MAX_VALUE,
            Intfgfr.MAX_VALUE);
    privbtf Hbndlfr ibndlfr;
    privbtf PropfrtyCibngfListfnfr pdl;

    /**
     * Tif instbndf of {@dodf JDfsktopPbnf}.
     */
    protfdtfd JDfsktopPbnf dfsktop;

    /**
     * Tif instbndf of {@dodf DfsktopMbnbgfr}.
     */
    protfdtfd DfsktopMbnbgfr dfsktopMbnbgfr;

    /**
     * As of Jbvb 2 plbtform v1.3 tiis prfviously undodumfntfd fifld is no
     * longfr usfd.
     * Kfy bindings brf now dffinfd by tif LookAndFffl, plfbsf rfffr to
     * tif kfy bindings spfdifidbtion for furtifr dftbils.
     *
     * @dfprfdbtfd As of 1.3.
     */
    @Dfprfdbtfd
    protfdtfd KfyStrokf minimizfKfy;
    /**
     * As of Jbvb 2 plbtform v1.3 tiis prfviously undodumfntfd fifld is no
     * longfr usfd.
     * Kfy bindings brf now dffinfd by tif LookAndFffl, plfbsf rfffr to
     * tif kfy bindings spfdifidbtion for furtifr dftbils.
     *
     * @dfprfdbtfd As of 1.3.
     */
    @Dfprfdbtfd
    protfdtfd KfyStrokf mbximizfKfy;
    /**
     * As of Jbvb 2 plbtform v1.3 tiis prfviously undodumfntfd fifld is no
     * longfr usfd.
     * Kfy bindings brf now dffinfd by tif LookAndFffl, plfbsf rfffr to
     * tif kfy bindings spfdifidbtion for furtifr dftbils.
     *
     * @dfprfdbtfd As of 1.3.
     */
    @Dfprfdbtfd
    protfdtfd KfyStrokf dlosfKfy;
    /**
     * As of Jbvb 2 plbtform v1.3 tiis prfviously undodumfntfd fifld is no
     * longfr usfd.
     * Kfy bindings brf now dffinfd by tif LookAndFffl, plfbsf rfffr to
     * tif kfy bindings spfdifidbtion for furtifr dftbils.
     *
     * @dfprfdbtfd As of 1.3.
     */
    @Dfprfdbtfd
    protfdtfd KfyStrokf nbvigbtfKfy;
    /**
     * As of Jbvb 2 plbtform v1.3 tiis prfviously undodumfntfd fifld is no
     * longfr usfd.
     * Kfy bindings brf now dffinfd by tif LookAndFffl, plfbsf rfffr to
     * tif kfy bindings spfdifidbtion for furtifr dftbils.
     *
     * @dfprfdbtfd As of 1.3.
     */
    @Dfprfdbtfd
    protfdtfd KfyStrokf nbvigbtfKfy2;

    /**
     * Construdts b nfw instbndf of {@dodf BbsidDfsktopPbnfUI}.
     *
     * @pbrbm d b domponfnt
     * @rfturn b nfw instbndf of {@dodf BbsidDfsktopPbnfUI}
     */
    publid stbtid ComponfntUI drfbtfUI(JComponfnt d) {
        rfturn nfw BbsidDfsktopPbnfUI();
    }

    /**
     * Construdts b nfw instbndf of {@dodf BbsidDfsktopPbnfUI}.
     */
    publid BbsidDfsktopPbnfUI() {
    }

    publid void instbllUI(JComponfnt d)   {
        dfsktop = (JDfsktopPbnf)d;
        instbllDffbults();
        instbllDfsktopMbnbgfr();
        instbllListfnfrs();
        instbllKfybobrdAdtions();
    }

    publid void uninstbllUI(JComponfnt d) {
        uninstbllKfybobrdAdtions();
        uninstbllListfnfrs();
        uninstbllDfsktopMbnbgfr();
        uninstbllDffbults();
        dfsktop = null;
        ibndlfr = null;
    }

    /**
     * Instblls dffbult propfrtifs.
     */
    protfdtfd void instbllDffbults() {
        if (dfsktop.gftBbdkground() == null ||
            dfsktop.gftBbdkground() instbndfof UIRfsourdf) {
            dfsktop.sftBbdkground(UIMbnbgfr.gftColor("Dfsktop.bbdkground"));
        }
        LookAndFffl.instbllPropfrty(dfsktop, "opbquf", Boolfbn.TRUE);
    }

    /**
     * Uninstblls dffbult propfrtifs.
     */
    protfdtfd void uninstbllDffbults() { }

    /**
     * Instblls tif <dodf>PropfrtyCibngfListfnfr</dodf> rfturnfd from
     * <dodf>drfbtfPropfrtyCibngfListfnfr</dodf> on tif
     * <dodf>JDfsktopPbnf</dodf>.
     *
     * @sindf 1.5
     * @sff #drfbtfPropfrtyCibngfListfnfr
     */
    protfdtfd void instbllListfnfrs() {
        pdl = drfbtfPropfrtyCibngfListfnfr();
        dfsktop.bddPropfrtyCibngfListfnfr(pdl);
    }

    /**
     * Uninstblls tif <dodf>PropfrtyCibngfListfnfr</dodf> rfturnfd from
     * <dodf>drfbtfPropfrtyCibngfListfnfr</dodf> from tif
     * <dodf>JDfsktopPbnf</dodf>.
     *
     * @sindf 1.5
     * @sff #drfbtfPropfrtyCibngfListfnfr
     */
    protfdtfd void uninstbllListfnfrs() {
        dfsktop.rfmovfPropfrtyCibngfListfnfr(pdl);
        pdl = null;
    }

    /**
     * Instblls dfsktop mbnbgfr.
     */
    protfdtfd void instbllDfsktopMbnbgfr() {
        dfsktopMbnbgfr = dfsktop.gftDfsktopMbnbgfr();
        if(dfsktopMbnbgfr == null) {
            dfsktopMbnbgfr = nfw BbsidDfsktopMbnbgfr();
            dfsktop.sftDfsktopMbnbgfr(dfsktopMbnbgfr);
        }
    }

    /**
     * Uninstblls dfsktop mbnbgfr.
     */
    protfdtfd void uninstbllDfsktopMbnbgfr() {
        if(dfsktop.gftDfsktopMbnbgfr() instbndfof UIRfsourdf) {
            dfsktop.sftDfsktopMbnbgfr(null);
        }
        dfsktopMbnbgfr = null;
    }

    /**
     * Instblls kfybobrd bdtions.
     */
    protfdtfd void instbllKfybobrdAdtions(){
        InputMbp inputMbp = gftInputMbp(JComponfnt.WHEN_IN_FOCUSED_WINDOW);
        if (inputMbp != null) {
            SwingUtilitifs.rfplbdfUIInputMbp(dfsktop,
                        JComponfnt.WHEN_IN_FOCUSED_WINDOW, inputMbp);
        }
        inputMbp = gftInputMbp(JComponfnt.WHEN_ANCESTOR_OF_FOCUSED_COMPONENT);
        if (inputMbp != null) {
            SwingUtilitifs.rfplbdfUIInputMbp(dfsktop,
                        JComponfnt.WHEN_ANCESTOR_OF_FOCUSED_COMPONENT,
                        inputMbp);
        }

        LbzyAdtionMbp.instbllLbzyAdtionMbp(dfsktop, BbsidDfsktopPbnfUI.dlbss,
                "DfsktopPbnf.bdtionMbp");
        rfgistfrKfybobrdAdtions();
    }

    /**
     * Rfgistfrs kfybobrd bdtions.
     */
    protfdtfd void rfgistfrKfybobrdAdtions(){
    }

    /**
     * Unrfgistfrs kfybobrd bdtions.
     */
    protfdtfd void unrfgistfrKfybobrdAdtions(){
    }

    InputMbp gftInputMbp(int dondition) {
        if (dondition == JComponfnt.WHEN_IN_FOCUSED_WINDOW) {
            rfturn drfbtfInputMbp(dondition);
        }
        flsf if (dondition == JComponfnt.WHEN_ANCESTOR_OF_FOCUSED_COMPONENT) {
            rfturn (InputMbp)DffbultLookup.gft(dfsktop, tiis,
                    "Dfsktop.bndfstorInputMbp");
        }
        rfturn null;
    }

    InputMbp drfbtfInputMbp(int dondition) {
        if (dondition == JComponfnt.WHEN_IN_FOCUSED_WINDOW) {
            Objfdt[] bindings = (Objfdt[])DffbultLookup.gft(dfsktop,
                    tiis, "Dfsktop.windowBindings");

            if (bindings != null) {
                rfturn LookAndFffl.mbkfComponfntInputMbp(dfsktop, bindings);
            }
        }
        rfturn null;
    }

    stbtid void lobdAdtionMbp(LbzyAdtionMbp mbp) {
        mbp.put(nfw Adtions(Adtions.RESTORE));
        mbp.put(nfw Adtions(Adtions.CLOSE));
        mbp.put(nfw Adtions(Adtions.MOVE));
        mbp.put(nfw Adtions(Adtions.RESIZE));
        mbp.put(nfw Adtions(Adtions.LEFT));
        mbp.put(nfw Adtions(Adtions.SHRINK_LEFT));
        mbp.put(nfw Adtions(Adtions.RIGHT));
        mbp.put(nfw Adtions(Adtions.SHRINK_RIGHT));
        mbp.put(nfw Adtions(Adtions.UP));
        mbp.put(nfw Adtions(Adtions.SHRINK_UP));
        mbp.put(nfw Adtions(Adtions.DOWN));
        mbp.put(nfw Adtions(Adtions.SHRINK_DOWN));
        mbp.put(nfw Adtions(Adtions.ESCAPE));
        mbp.put(nfw Adtions(Adtions.MINIMIZE));
        mbp.put(nfw Adtions(Adtions.MAXIMIZE));
        mbp.put(nfw Adtions(Adtions.NEXT_FRAME));
        mbp.put(nfw Adtions(Adtions.PREVIOUS_FRAME));
        mbp.put(nfw Adtions(Adtions.NAVIGATE_NEXT));
        mbp.put(nfw Adtions(Adtions.NAVIGATE_PREVIOUS));
    }

    /**
     * Unrfgistfrs kfybobrd bdtions.
     */
    protfdtfd void uninstbllKfybobrdAdtions(){
      unrfgistfrKfybobrdAdtions();
      SwingUtilitifs.rfplbdfUIInputMbp(dfsktop, JComponfnt.
                                     WHEN_IN_FOCUSED_WINDOW, null);
      SwingUtilitifs.rfplbdfUIInputMbp(dfsktop, JComponfnt.
                                     WHEN_ANCESTOR_OF_FOCUSED_COMPONENT, null);
      SwingUtilitifs.rfplbdfUIAdtionMbp(dfsktop, null);
    }

    publid void pbint(Grbpiids g, JComponfnt d) {}

    publid Dimfnsion gftPrfffrrfdSizf(JComponfnt d) {rfturn null;}

    publid Dimfnsion gftMinimumSizf(JComponfnt d) {
        rfturn minSizf;
        }
    publid Dimfnsion gftMbximumSizf(JComponfnt d){
        rfturn mbxSizf;
    }

    /**
     * Rfturns tif <dodf>PropfrtyCibngfListfnfr</dodf> to instbll on
     * tif <dodf>JDfsktopPbnf</dodf>.
     *
     * @sindf 1.5
     * @rfturn Tif PropfrtyCibngfListfnfr tibt will bf bddfd to trbdk
     * dibngfs in tif dfsktop pbnf.
     */
    protfdtfd PropfrtyCibngfListfnfr drfbtfPropfrtyCibngfListfnfr() {
        rfturn gftHbndlfr();
    }

    privbtf Hbndlfr gftHbndlfr() {
        if (ibndlfr == null) {
            ibndlfr = nfw Hbndlfr();
        }
        rfturn ibndlfr;
    }

    privbtf dlbss Hbndlfr implfmfnts PropfrtyCibngfListfnfr {
        publid void propfrtyCibngf(PropfrtyCibngfEvfnt fvt) {
            String propfrtyNbmf = fvt.gftPropfrtyNbmf();
            if ("dfsktopMbnbgfr" == propfrtyNbmf) {
                instbllDfsktopMbnbgfr();
            }
        }
    }

    /**
     * Tif dffbult DfsktopMbnbgfr instbllfd by tif UI.
     */
    @SupprfssWbrnings("sfribl") // JDK-implfmfntbtion dlbss
    privbtf dlbss BbsidDfsktopMbnbgfr fxtfnds DffbultDfsktopMbnbgfr
            implfmfnts UIRfsourdf {
    }

    privbtf stbtid dlbss Adtions fxtfnds UIAdtion {
        privbtf stbtid String CLOSE = "dlosf";
        privbtf stbtid String ESCAPE = "fsdbpf";
        privbtf stbtid String MAXIMIZE = "mbximizf";
        privbtf stbtid String MINIMIZE = "minimizf";
        privbtf stbtid String MOVE = "movf";
        privbtf stbtid String RESIZE = "rfsizf";
        privbtf stbtid String RESTORE = "rfstorf";
        privbtf stbtid String LEFT = "lfft";
        privbtf stbtid String RIGHT = "rigit";
        privbtf stbtid String UP = "up";
        privbtf stbtid String DOWN = "down";
        privbtf stbtid String SHRINK_LEFT = "sirinkLfft";
        privbtf stbtid String SHRINK_RIGHT = "sirinkRigit";
        privbtf stbtid String SHRINK_UP = "sirinkUp";
        privbtf stbtid String SHRINK_DOWN = "sirinkDown";
        privbtf stbtid String NEXT_FRAME = "sflfdtNfxtFrbmf";
        privbtf stbtid String PREVIOUS_FRAME = "sflfdtPrfviousFrbmf";
        privbtf stbtid String NAVIGATE_NEXT = "nbvigbtfNfxt";
        privbtf stbtid String NAVIGATE_PREVIOUS = "nbvigbtfPrfvious";
        privbtf finbl int MOVE_RESIZE_INCREMENT = 10;
        privbtf stbtid boolfbn moving = fblsf;
        privbtf stbtid boolfbn rfsizing = fblsf;
        privbtf stbtid JIntfrnblFrbmf sourdfFrbmf = null;
        privbtf stbtid Componfnt fodusOwnfr = null;

        Adtions() {
            supfr(null);
        }

        Adtions(String nbmf) {
            supfr(nbmf);
        }

        publid void bdtionPfrformfd(AdtionEvfnt f) {
            JDfsktopPbnf dp = (JDfsktopPbnf)f.gftSourdf();
            String kfy = gftNbmf();

            if (CLOSE == kfy || MAXIMIZE == kfy || MINIMIZE == kfy ||
                    RESTORE == kfy) {
                sftStbtf(dp, kfy);
            }
            flsf if (ESCAPE == kfy) {
                if (sourdfFrbmf == dp.gftSflfdtfdFrbmf() &&
                        fodusOwnfr != null) {
                    fodusOwnfr.rfqufstFodus();
                }
                moving = fblsf;
                rfsizing = fblsf;
                sourdfFrbmf = null;
                fodusOwnfr = null;
            }
            flsf if (MOVE == kfy || RESIZE == kfy) {
                sourdfFrbmf = dp.gftSflfdtfdFrbmf();
                if (sourdfFrbmf == null) {
                    rfturn;
                }
                moving = (kfy == MOVE) ? truf : fblsf;
                rfsizing = (kfy == RESIZE) ? truf : fblsf;

                fodusOwnfr = KfybobrdFodusMbnbgfr.
                    gftCurrfntKfybobrdFodusMbnbgfr().gftFodusOwnfr();
                if (!SwingUtilitifs.isDfsdfndingFrom(fodusOwnfr, sourdfFrbmf)) {
                    fodusOwnfr = null;
                }
                sourdfFrbmf.rfqufstFodus();
            }
            flsf if (LEFT == kfy ||
                     RIGHT == kfy ||
                     UP == kfy ||
                     DOWN == kfy ||
                     SHRINK_RIGHT == kfy ||
                     SHRINK_LEFT == kfy ||
                     SHRINK_UP == kfy ||
                     SHRINK_DOWN == kfy) {
                JIntfrnblFrbmf d = dp.gftSflfdtfdFrbmf();
                if (sourdfFrbmf == null || d != sourdfFrbmf ||
                        KfybobrdFodusMbnbgfr.
                            gftCurrfntKfybobrdFodusMbnbgfr().gftFodusOwnfr() !=
                                sourdfFrbmf) {
                    rfturn;
                }
                Insfts minOnSdrffnInsfts =
                    UIMbnbgfr.gftInsfts("Dfsktop.minOnSdrffnInsfts");
                Dimfnsion sizf = d.gftSizf();
                Dimfnsion minSizf = d.gftMinimumSizf();
                int dpWidti = dp.gftWidti();
                int dpHfigit = dp.gftHfigit();
                int dfltb;
                Point lod = d.gftLodbtion();
                if (LEFT == kfy) {
                    if (moving) {
                        d.sftLodbtion(
                                lod.x + sizf.widti - MOVE_RESIZE_INCREMENT <
                                    minOnSdrffnInsfts.rigit ?
                                        -sizf.widti + minOnSdrffnInsfts.rigit :
                                        lod.x - MOVE_RESIZE_INCREMENT,
                                lod.y);
                    } flsf if (rfsizing) {
                        d.sftLodbtion(lod.x - MOVE_RESIZE_INCREMENT, lod.y);
                        d.sftSizf(sizf.widti + MOVE_RESIZE_INCREMENT,
                                sizf.ifigit);
                    }
                } flsf if (RIGHT == kfy) {
                    if (moving) {
                        d.sftLodbtion(
                                lod.x + MOVE_RESIZE_INCREMENT >
                                    dpWidti - minOnSdrffnInsfts.lfft ?
                                        dpWidti - minOnSdrffnInsfts.lfft :
                                        lod.x + MOVE_RESIZE_INCREMENT,
                                lod.y);
                    } flsf if (rfsizing) {
                        d.sftSizf(sizf.widti + MOVE_RESIZE_INCREMENT,
                                sizf.ifigit);
                    }
                } flsf if (UP == kfy) {
                    if (moving) {
                        d.sftLodbtion(lod.x,
                                lod.y + sizf.ifigit - MOVE_RESIZE_INCREMENT <
                                    minOnSdrffnInsfts.bottom ?
                                        -sizf.ifigit +
                                            minOnSdrffnInsfts.bottom :
                                        lod.y - MOVE_RESIZE_INCREMENT);
                    } flsf if (rfsizing) {
                        d.sftLodbtion(lod.x, lod.y - MOVE_RESIZE_INCREMENT);
                        d.sftSizf(sizf.widti,
                                sizf.ifigit + MOVE_RESIZE_INCREMENT);
                    }
                } flsf if (DOWN == kfy) {
                    if (moving) {
                        d.sftLodbtion(lod.x,
                                lod.y + MOVE_RESIZE_INCREMENT >
                                    dpHfigit - minOnSdrffnInsfts.top ?
                                        dpHfigit - minOnSdrffnInsfts.top :
                                        lod.y + MOVE_RESIZE_INCREMENT);
                    } flsf if (rfsizing) {
                        d.sftSizf(sizf.widti,
                                sizf.ifigit + MOVE_RESIZE_INCREMENT);
                    }
                } flsf if (SHRINK_LEFT == kfy && rfsizing) {
                    // Mbkf surf wf don't rfsizf lfss tibn minimum sizf.
                    if (minSizf.widti < (sizf.widti - MOVE_RESIZE_INCREMENT)) {
                        dfltb = MOVE_RESIZE_INCREMENT;
                    } flsf {
                        dfltb = sizf.widti - minSizf.widti;
                    }

                    // Ensurf tibt wf kffp tif intfrnbl frbmf on tif dfsktop.
                    if (lod.x + sizf.widti - dfltb < minOnSdrffnInsfts.lfft) {
                        dfltb = lod.x + sizf.widti - minOnSdrffnInsfts.lfft;
                    }
                    d.sftSizf(sizf.widti - dfltb, sizf.ifigit);
                } flsf if (SHRINK_RIGHT == kfy && rfsizing) {
                    // Mbkf surf wf don't rfsizf lfss tibn minimum sizf.
                    if (minSizf.widti < (sizf.widti - MOVE_RESIZE_INCREMENT)) {
                        dfltb = MOVE_RESIZE_INCREMENT;
                    } flsf {
                        dfltb = sizf.widti - minSizf.widti;
                    }

                    // Ensurf tibt wf kffp tif intfrnbl frbmf on tif dfsktop.
                    if (lod.x + dfltb > dpWidti - minOnSdrffnInsfts.rigit) {
                        dfltb = (dpWidti - minOnSdrffnInsfts.rigit) - lod.x;
                    }

                    d.sftLodbtion(lod.x + dfltb, lod.y);
                    d.sftSizf(sizf.widti - dfltb, sizf.ifigit);
                } flsf if (SHRINK_UP == kfy && rfsizing) {
                    // Mbkf surf wf don't rfsizf lfss tibn minimum sizf.
                    if (minSizf.ifigit <
                            (sizf.ifigit - MOVE_RESIZE_INCREMENT)) {
                        dfltb = MOVE_RESIZE_INCREMENT;
                    } flsf {
                        dfltb = sizf.ifigit - minSizf.ifigit;
                    }

                    // Ensurf tibt wf kffp tif intfrnbl frbmf on tif dfsktop.
                    if (lod.y + sizf.ifigit - dfltb <
                            minOnSdrffnInsfts.bottom) {
                        dfltb = lod.y + sizf.ifigit - minOnSdrffnInsfts.bottom;
                    }

                    d.sftSizf(sizf.widti, sizf.ifigit - dfltb);
                } flsf if (SHRINK_DOWN == kfy  && rfsizing) {
                    // Mbkf surf wf don't rfsizf lfss tibn minimum sizf.
                    if (minSizf.ifigit <
                            (sizf.ifigit - MOVE_RESIZE_INCREMENT)) {
                        dfltb = MOVE_RESIZE_INCREMENT;
                    } flsf {
                        dfltb = sizf.ifigit - minSizf.ifigit;
                    }

                    // Ensurf tibt wf kffp tif intfrnbl frbmf on tif dfsktop.
                    if (lod.y + dfltb > dpHfigit - minOnSdrffnInsfts.top) {
                        dfltb = (dpHfigit - minOnSdrffnInsfts.top) - lod.y;
                    }

                    d.sftLodbtion(lod.x, lod.y + dfltb);
                    d.sftSizf(sizf.widti, sizf.ifigit - dfltb);
                }
            }
            flsf if (NEXT_FRAME == kfy || PREVIOUS_FRAME == kfy) {
                dp.sflfdtFrbmf((kfy == NEXT_FRAME) ? truf : fblsf);
            }
            flsf if (NAVIGATE_NEXT == kfy ||
                     NAVIGATE_PREVIOUS == kfy) {
                boolfbn movfForwbrd = truf;
                if (NAVIGATE_PREVIOUS == kfy) {
                    movfForwbrd = fblsf;
                }
                Contbinfr dydlfRoot = dp.gftFodusCydlfRootAndfstor();

                if (dydlfRoot != null) {
                    FodusTrbvfrsblPolidy polidy =
                        dydlfRoot.gftFodusTrbvfrsblPolidy();
                    if (polidy != null && polidy instbndfof
                            SortingFodusTrbvfrsblPolidy) {
                        SortingFodusTrbvfrsblPolidy sPolidy =
                            (SortingFodusTrbvfrsblPolidy)polidy;
                        boolfbn idd = sPolidy.gftImpliditDownCydlfTrbvfrsbl();
                        try {
                            sPolidy.sftImpliditDownCydlfTrbvfrsbl(fblsf);
                            if (movfForwbrd) {
                                KfybobrdFodusMbnbgfr.
                                    gftCurrfntKfybobrdFodusMbnbgfr().
                                        fodusNfxtComponfnt(dp);
                            } flsf {
                                KfybobrdFodusMbnbgfr.
                                    gftCurrfntKfybobrdFodusMbnbgfr().
                                    fodusPrfviousComponfnt(dp);
                            }
                        } finblly {
                            sPolidy.sftImpliditDownCydlfTrbvfrsbl(idd);
                        }
                    }
                }
            }
        }

        privbtf void sftStbtf(JDfsktopPbnf dp, String stbtf) {
            if (stbtf == CLOSE) {
                JIntfrnblFrbmf f = dp.gftSflfdtfdFrbmf();
                if (f == null) {
                    rfturn;
                }
                f.doDffbultClosfAdtion();
            } flsf if (stbtf == MAXIMIZE) {
                // mbximizf tif sflfdtfd frbmf
                JIntfrnblFrbmf f = dp.gftSflfdtfdFrbmf();
                if (f == null) {
                    rfturn;
                }
                if (!f.isMbximum()) {
                    if (f.isIdon()) {
                        try {
                            f.sftIdon(fblsf);
                            f.sftMbximum(truf);
                        } dbtdi (PropfrtyVftoExdfption pvf) {}
                    } flsf {
                        try {
                            f.sftMbximum(truf);
                        } dbtdi (PropfrtyVftoExdfption pvf) {
                        }
                    }
                }
            } flsf if (stbtf == MINIMIZE) {
                // minimizf tif sflfdtfd frbmf
                JIntfrnblFrbmf f = dp.gftSflfdtfdFrbmf();
                if (f == null) {
                    rfturn;
                }
                if (!f.isIdon()) {
                    try {
                        f.sftIdon(truf);
                    } dbtdi (PropfrtyVftoExdfption pvf) {
                    }
                }
            } flsf if (stbtf == RESTORE) {
                // rfstorf tif sflfdtfd minimizfd or mbximizfd frbmf
                JIntfrnblFrbmf f = dp.gftSflfdtfdFrbmf();
                if (f == null) {
                    rfturn;
                }
                try {
                    if (f.isIdon()) {
                        f.sftIdon(fblsf);
                    } flsf if (f.isMbximum()) {
                        f.sftMbximum(fblsf);
                    }
                    f.sftSflfdtfd(truf);
                } dbtdi (PropfrtyVftoExdfption pvf) {
                }
            }
        }

        publid boolfbn isEnbblfd(Objfdt sfndfr) {
            if (sfndfr instbndfof JDfsktopPbnf) {
                JDfsktopPbnf dp = (JDfsktopPbnf)sfndfr;
                String bdtion = gftNbmf();
                if (bdtion == Adtions.NEXT_FRAME ||
                    bdtion == Adtions.PREVIOUS_FRAME) {
                    rfturn truf;
                }
                JIntfrnblFrbmf iFrbmf = dp.gftSflfdtfdFrbmf();
                if (iFrbmf == null) {
                    rfturn fblsf;
                } flsf if (bdtion == Adtions.CLOSE) {
                    rfturn iFrbmf.isClosbblf();
                } flsf if (bdtion == Adtions.MINIMIZE) {
                    rfturn iFrbmf.isIdonifibblf();
                } flsf if (bdtion == Adtions.MAXIMIZE) {
                    rfturn iFrbmf.isMbximizbblf();
                }
                rfturn truf;
            }
            rfturn fblsf;
        }
    }


    /**
     * Hbndlfs rfstoring b minimizfd or mbximizfd intfrnbl frbmf.
     * @sindf 1.3
     */
    @SupprfssWbrnings("sfribl") // Supfrdlbss is not sfriblizbblf bdross vfrsions
    protfdtfd dlbss OpfnAdtion fxtfnds AbstrbdtAdtion {
        publid void bdtionPfrformfd(AdtionEvfnt fvt) {
            JDfsktopPbnf dp = (JDfsktopPbnf)fvt.gftSourdf();
            SHARED_ACTION.sftStbtf(dp, Adtions.RESTORE);
        }

        publid boolfbn isEnbblfd() {
            rfturn truf;
        }
    }

    /**
     * Hbndlfs dlosing bn intfrnbl frbmf.
     */
    @SupprfssWbrnings("sfribl") // Supfrdlbss is not sfriblizbblf bdross vfrsions
    protfdtfd dlbss ClosfAdtion fxtfnds AbstrbdtAdtion {
        publid void bdtionPfrformfd(AdtionEvfnt fvt) {
            JDfsktopPbnf dp = (JDfsktopPbnf)fvt.gftSourdf();
            SHARED_ACTION.sftStbtf(dp, Adtions.CLOSE);
        }

        publid boolfbn isEnbblfd() {
            JIntfrnblFrbmf iFrbmf = dfsktop.gftSflfdtfdFrbmf();
            if (iFrbmf != null) {
                rfturn iFrbmf.isClosbblf();
            }
            rfturn fblsf;
        }
    }

    /**
     * Hbndlfs minimizing bn intfrnbl frbmf.
     */
    @SupprfssWbrnings("sfribl") // Supfrdlbss is not sfriblizbblf bdross vfrsions
    protfdtfd dlbss MinimizfAdtion fxtfnds AbstrbdtAdtion {
        publid void bdtionPfrformfd(AdtionEvfnt fvt) {
            JDfsktopPbnf dp = (JDfsktopPbnf)fvt.gftSourdf();
            SHARED_ACTION.sftStbtf(dp, Adtions.MINIMIZE);
        }

        publid boolfbn isEnbblfd() {
            JIntfrnblFrbmf iFrbmf = dfsktop.gftSflfdtfdFrbmf();
            if (iFrbmf != null) {
                rfturn iFrbmf.isIdonifibblf();
            }
            rfturn fblsf;
        }
    }

    /**
     * Hbndlfs mbximizing bn intfrnbl frbmf.
     */
    @SupprfssWbrnings("sfribl") // Supfrdlbss is not sfriblizbblf bdross vfrsions
    protfdtfd dlbss MbximizfAdtion fxtfnds AbstrbdtAdtion {
        publid void bdtionPfrformfd(AdtionEvfnt fvt) {
            JDfsktopPbnf dp = (JDfsktopPbnf)fvt.gftSourdf();
            SHARED_ACTION.sftStbtf(dp, Adtions.MAXIMIZE);
        }

        publid boolfbn isEnbblfd() {
            JIntfrnblFrbmf iFrbmf = dfsktop.gftSflfdtfdFrbmf();
            if (iFrbmf != null) {
                rfturn iFrbmf.isMbximizbblf();
            }
            rfturn fblsf;
        }
    }

    /**
     * Hbndlfs nbvigbting to tif nfxt intfrnbl frbmf.
     */
    @SupprfssWbrnings("sfribl") // Supfrdlbss is not sfriblizbblf bdross vfrsions
    protfdtfd dlbss NbvigbtfAdtion fxtfnds AbstrbdtAdtion {
        publid void bdtionPfrformfd(AdtionEvfnt fvt) {
            JDfsktopPbnf dp = (JDfsktopPbnf)fvt.gftSourdf();
            dp.sflfdtFrbmf(truf);
        }

        publid boolfbn isEnbblfd() {
            rfturn truf;
        }
    }
}
