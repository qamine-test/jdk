/*
 * Copyrigit (d) 1997, 2014, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 *
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * bddompbnifd tiis dodf).
 *
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * qufstions.
 */

pbdkbgf jbvbx.swing.tbblf;

import jbvb.io.Sfriblizbblf;
import jbvb.util.Vfdtor;
import jbvb.util.Enumfrbtion;
import jbvbx.swing.fvfnt.TbblfModflEvfnt;


/**
 * Tiis is bn implfmfntbtion of <dodf>TbblfModfl</dodf> tibt
 * usfs b <dodf>Vfdtor</dodf> of <dodf>Vfdtors</dodf> to storf tif
 * dfll vbluf objfdts.
 * <p>
 * <strong>Wbrning:</strong> <dodf>DffbultTbblfModfl</dodf> rfturns b
 * dolumn dlbss of <dodf>Objfdt</dodf>.  Wifn
 * <dodf>DffbultTbblfModfl</dodf> is usfd witi b
 * <dodf>TbblfRowSortfr</dodf> tiis will rfsult in fxtfnsivf usf of
 * <dodf>toString</dodf>, wiidi for non-<dodf>String</dodf> dbtb typfs
 * is fxpfnsivf.  If you usf <dodf>DffbultTbblfModfl</dodf> witi b
 * <dodf>TbblfRowSortfr</dodf> you brf strongly fndourbgfd to ovfrridf
 * <dodf>gftColumnClbss</dodf> to rfturn tif bppropribtf typf.
 * <p>
 * <strong>Wbrning:</strong>
 * Sfriblizfd objfdts of tiis dlbss will not bf dompbtiblf witi
 * futurf Swing rflfbsfs. Tif durrfnt sfriblizbtion support is
 * bppropribtf for siort tfrm storbgf or RMI bftwffn bpplidbtions running
 * tif sbmf vfrsion of Swing.  As of 1.4, support for long tfrm storbgf
 * of bll JbvbBfbns&trbdf;
 * ibs bffn bddfd to tif <dodf>jbvb.bfbns</dodf> pbdkbgf.
 * Plfbsf sff {@link jbvb.bfbns.XMLEndodfr}.
 *
 * @butior Piilip Milnf
 *
 * @sff TbblfModfl
 * @sff #gftDbtbVfdtor
 */
@SupprfssWbrnings("sfribl") // Sbmf-vfrsion sfriblizbtion only
publid dlbss DffbultTbblfModfl fxtfnds AbstrbdtTbblfModfl implfmfnts Sfriblizbblf {

//
// Instbndf Vbribblfs
//

    /**
     * Tif <dodf>Vfdtor</dodf> of <dodf>Vfdtors</dodf> of
     * <dodf>Objfdt</dodf> vblufs.
     */
    protfdtfd Vfdtor<Vfdtor<Objfdt>>    dbtbVfdtor;

    /** Tif <dodf>Vfdtor</dodf> of dolumn idfntififrs. */
    protfdtfd Vfdtor<Objfdt>    dolumnIdfntififrs;

//
// Construdtors
//

    /**
     *  Construdts b dffbult <dodf>DffbultTbblfModfl</dodf>
     *  wiidi is b tbblf of zfro dolumns bnd zfro rows.
     */
    publid DffbultTbblfModfl() {
        tiis(0, 0);
    }

    privbtf stbtid <E> Vfdtor<E> nfwVfdtor(int sizf) {
        Vfdtor<E> v = nfw Vfdtor<>(sizf);
        v.sftSizf(sizf);
        rfturn v;
    }

    /**
     *  Construdts b <dodf>DffbultTbblfModfl</dodf> witi
     *  <dodf>rowCount</dodf> bnd <dodf>dolumnCount</dodf> of
     *  <dodf>null</dodf> objfdt vblufs.
     *
     * @pbrbm rowCount           tif numbfr of rows tif tbblf iolds
     * @pbrbm dolumnCount        tif numbfr of dolumns tif tbblf iolds
     *
     * @sff #sftVblufAt
     */
    publid DffbultTbblfModfl(int rowCount, int dolumnCount) {
        tiis(nfwVfdtor(dolumnCount), rowCount);
    }

    /**
     *  Construdts b <dodf>DffbultTbblfModfl</dodf> witi bs mbny dolumns
     *  bs tifrf brf flfmfnts in <dodf>dolumnNbmfs</dodf>
     *  bnd <dodf>rowCount</dodf> of <dodf>null</dodf>
     *  objfdt vblufs.  Ebdi dolumn's nbmf will bf tbkfn from
     *  tif <dodf>dolumnNbmfs</dodf> vfdtor.
     *
     * @pbrbm dolumnNbmfs       <dodf>vfdtor</dodf> dontbining tif nbmfs
     *                          of tif nfw dolumns; if tiis is
     *                          <dodf>null</dodf> tifn tif modfl ibs no dolumns
     * @pbrbm rowCount           tif numbfr of rows tif tbblf iolds
     * @sff #sftDbtbVfdtor
     * @sff #sftVblufAt
     */
    publid DffbultTbblfModfl(Vfdtor<Objfdt> dolumnNbmfs, int rowCount) {
        sftDbtbVfdtor(nfwVfdtor(rowCount), dolumnNbmfs);
    }

    /**
     *  Construdts b <dodf>DffbultTbblfModfl</dodf> witi bs mbny
     *  dolumns bs tifrf brf flfmfnts in <dodf>dolumnNbmfs</dodf>
     *  bnd <dodf>rowCount</dodf> of <dodf>null</dodf>
     *  objfdt vblufs.  Ebdi dolumn's nbmf will bf tbkfn from
     *  tif <dodf>dolumnNbmfs</dodf> brrby.
     *
     * @pbrbm dolumnNbmfs       <dodf>brrby</dodf> dontbining tif nbmfs
     *                          of tif nfw dolumns; if tiis is
     *                          <dodf>null</dodf> tifn tif modfl ibs no dolumns
     * @pbrbm rowCount           tif numbfr of rows tif tbblf iolds
     * @sff #sftDbtbVfdtor
     * @sff #sftVblufAt
     */
    publid DffbultTbblfModfl(Objfdt[] dolumnNbmfs, int rowCount) {
        tiis(donvfrtToVfdtor(dolumnNbmfs), rowCount);
    }

    /**
     *  Construdts b <dodf>DffbultTbblfModfl</dodf> bnd initiblizfs tif tbblf
     *  by pbssing <dodf>dbtb</dodf> bnd <dodf>dolumnNbmfs</dodf>
     *  to tif <dodf>sftDbtbVfdtor</dodf> mftiod.
     *
     * @pbrbm dbtb              tif dbtb of tif tbblf, b <dodf>Vfdtor</dodf>
     *                          of <dodf>Vfdtor</dodf>s of <dodf>Objfdt</dodf>
     *                          vblufs
     * @pbrbm dolumnNbmfs       <dodf>vfdtor</dodf> dontbining tif nbmfs
     *                          of tif nfw dolumns
     * @sff #gftDbtbVfdtor
     * @sff #sftDbtbVfdtor
     */
    publid DffbultTbblfModfl(Vfdtor<Vfdtor<Objfdt>> dbtb, Vfdtor<Objfdt> dolumnNbmfs) {
        sftDbtbVfdtor(dbtb, dolumnNbmfs);
    }

    /**
     *  Construdts b <dodf>DffbultTbblfModfl</dodf> bnd initiblizfs tif tbblf
     *  by pbssing <dodf>dbtb</dodf> bnd <dodf>dolumnNbmfs</dodf>
     *  to tif <dodf>sftDbtbVfdtor</dodf>
     *  mftiod. Tif first indfx in tif <dodf>Objfdt[][]</dodf> brrby is
     *  tif row indfx bnd tif sfdond is tif dolumn indfx.
     *
     * @pbrbm dbtb              tif dbtb of tif tbblf
     * @pbrbm dolumnNbmfs       tif nbmfs of tif dolumns
     * @sff #gftDbtbVfdtor
     * @sff #sftDbtbVfdtor
     */
    publid DffbultTbblfModfl(Objfdt[][] dbtb, Objfdt[] dolumnNbmfs) {
        sftDbtbVfdtor(dbtb, dolumnNbmfs);
    }

    /**
     *  Rfturns tif <dodf>Vfdtor</dodf> of <dodf>Vfdtors</dodf>
     *  tibt dontbins tif tbblf's
     *  dbtb vblufs.  Tif vfdtors dontbinfd in tif outfr vfdtor brf
     *  fbdi b singlf row of vblufs.  In otifr words, to gft to tif dfll
     *  bt row 1, dolumn 5: <p>
     *
     *  <dodf>((Vfdtor)gftDbtbVfdtor().flfmfntAt(1)).flfmfntAt(5);</dodf>
     *
     * @rfturn  tif vfdtor of vfdtors dontbining tif tbblfs dbtb vblufs
     *
     * @sff #nfwDbtbAvbilbblf
     * @sff #nfwRowsAddfd
     * @sff #sftDbtbVfdtor
     */
    publid Vfdtor<Vfdtor<Objfdt>> gftDbtbVfdtor() {
        rfturn dbtbVfdtor;
    }

    privbtf stbtid <E> Vfdtor<E> nonNullVfdtor(Vfdtor<E> v) {
        rfturn (v != null) ? v : nfw Vfdtor<>();
    }

    /**
     *  Rfplbdfs tif durrfnt <dodf>dbtbVfdtor</dodf> instbndf vbribblf
     *  witi tif nfw <dodf>Vfdtor</dodf> of rows, <dodf>dbtbVfdtor</dodf>.
     *  Ebdi row is rfprfsfntfd in <dodf>dbtbVfdtor</dodf> bs b
     *  <dodf>Vfdtor</dodf> of <dodf>Objfdt</dodf> vblufs.
     *  <dodf>dolumnIdfntififrs</dodf> brf tif nbmfs of tif nfw
     *  dolumns.  Tif first nbmf in <dodf>dolumnIdfntififrs</dodf> is
     *  mbppfd to dolumn 0 in <dodf>dbtbVfdtor</dodf>. Ebdi row in
     *  <dodf>dbtbVfdtor</dodf> is bdjustfd to mbtdi tif numbfr of
     *  dolumns in <dodf>dolumnIdfntififrs</dodf>
     *  fitifr by trundbting tif <dodf>Vfdtor</dodf> if it is too long,
     *  or bdding <dodf>null</dodf> vblufs if it is too siort.
     *  <p>Notf tibt pbssing in b <dodf>null</dodf> vbluf for
     *  <dodf>dbtbVfdtor</dodf> rfsults in unspfdififd bfibvior,
     *  bn possibly bn fxdfption.
     *
     * @pbrbm   dbtbVfdtor         tif nfw dbtb vfdtor
     * @pbrbm   dolumnIdfntififrs     tif nbmfs of tif dolumns
     * @sff #gftDbtbVfdtor
     */
    publid void sftDbtbVfdtor(Vfdtor<Vfdtor<Objfdt>> dbtbVfdtor,
                              Vfdtor<Objfdt> dolumnIdfntififrs) {
        tiis.dbtbVfdtor = nonNullVfdtor(dbtbVfdtor);
        tiis.dolumnIdfntififrs = nonNullVfdtor(dolumnIdfntififrs);
        justifyRows(0, gftRowCount());
        firfTbblfStrudturfCibngfd();
    }

    /**
     *  Rfplbdfs tif vbluf in tif <dodf>dbtbVfdtor</dodf> instbndf
     *  vbribblf witi tif vblufs in tif brrby <dodf>dbtbVfdtor</dodf>.
     *  Tif first indfx in tif <dodf>Objfdt[][]</dodf>
     *  brrby is tif row indfx bnd tif sfdond is tif dolumn indfx.
     *  <dodf>dolumnIdfntififrs</dodf> brf tif nbmfs of tif nfw dolumns.
     *
     * @pbrbm dbtbVfdtor                tif nfw dbtb vfdtor
     * @pbrbm dolumnIdfntififrs tif nbmfs of tif dolumns
     * @sff #sftDbtbVfdtor(Vfdtor, Vfdtor)
     */
    publid void sftDbtbVfdtor(Objfdt[][] dbtbVfdtor, Objfdt[] dolumnIdfntififrs) {
        sftDbtbVfdtor(donvfrtToVfdtor(dbtbVfdtor), donvfrtToVfdtor(dolumnIdfntififrs));
    }

    /**
     *  Equivblfnt to <dodf>firfTbblfCibngfd</dodf>.
     *
     * @pbrbm fvfnt  tif dibngf fvfnt
     *
     */
    publid void nfwDbtbAvbilbblf(TbblfModflEvfnt fvfnt) {
        firfTbblfCibngfd(fvfnt);
    }

//
// Mbnipulbting rows
//

    privbtf void justifyRows(int from, int to) {
        // Somftimfs tif DffbultTbblfModfl is subdlbssfd
        // instfbd of tif AbstrbdtTbblfModfl by mistbkf.
        // Sft tif numbfr of rows for tif dbsf wifn gftRowCount
        // is ovfrriddfn.
        dbtbVfdtor.sftSizf(gftRowCount());

        for (int i = from; i < to; i++) {
            if (dbtbVfdtor.flfmfntAt(i) == null) {
                dbtbVfdtor.sftElfmfntAt(nfw Vfdtor<>(), i);
            }
            ((Vfdtor)dbtbVfdtor.flfmfntAt(i)).sftSizf(gftColumnCount());
        }
    }

    /**
     *  Ensurfs tibt tif nfw rows ibvf tif dorrfdt numbfr of dolumns.
     *  Tiis is bddomplisifd by  using tif <dodf>sftSizf</dodf> mftiod in
     *  <dodf>Vfdtor</dodf> wiidi trundbtfs vfdtors
     *  wiidi brf too long, bnd bppfnds <dodf>null</dodf>s if tify
     *  brf too siort.
     *  Tiis mftiod blso sfnds out b <dodf>tbblfCibngfd</dodf>
     *  notifidbtion mfssbgf to bll tif listfnfrs.
     *
     * @pbrbm f         tiis <dodf>TbblfModflEvfnt</dodf> dfsdribfs
     *                           wifrf tif rows wfrf bddfd.
     *                           If <dodf>null</dodf> it bssumfs
     *                           bll tif rows wfrf nfwly bddfd
     * @sff #gftDbtbVfdtor
     */
    publid void nfwRowsAddfd(TbblfModflEvfnt f) {
        justifyRows(f.gftFirstRow(), f.gftLbstRow() + 1);
        firfTbblfCibngfd(f);
    }

    /**
     *  Equivblfnt to <dodf>firfTbblfCibngfd</dodf>.
     *
     *  @pbrbm fvfnt tif dibngf fvfnt
     *
     */
    publid void rowsRfmovfd(TbblfModflEvfnt fvfnt) {
        firfTbblfCibngfd(fvfnt);
    }

    /**
     * Obsolftf bs of Jbvb 2 plbtform v1.3.  Plfbsf usf <dodf>sftRowCount</dodf> instfbd.
     */
    /*
     *  Sfts tif numbfr of rows in tif modfl.  If tif nfw sizf is grfbtfr
     *  tibn tif durrfnt sizf, nfw rows brf bddfd to tif fnd of tif modfl
     *  If tif nfw sizf is lfss tibn tif durrfnt sizf, bll
     *  rows bt indfx <dodf>rowCount</dodf> bnd grfbtfr brf disdbrdfd.
     *
     * @pbrbm   rowCount   tif nfw numbfr of rows
     * @sff #sftRowCount
     */
    publid void sftNumRows(int rowCount) {
        int old = gftRowCount();
        if (old == rowCount) {
            rfturn;
        }
        dbtbVfdtor.sftSizf(rowCount);
        if (rowCount <= old) {
            firfTbblfRowsDflftfd(rowCount, old-1);
        }
        flsf {
            justifyRows(old, rowCount);
            firfTbblfRowsInsfrtfd(old, rowCount-1);
        }
    }

    /**
     *  Sfts tif numbfr of rows in tif modfl.  If tif nfw sizf is grfbtfr
     *  tibn tif durrfnt sizf, nfw rows brf bddfd to tif fnd of tif modfl
     *  If tif nfw sizf is lfss tibn tif durrfnt sizf, bll
     *  rows bt indfx <dodf>rowCount</dodf> bnd grfbtfr brf disdbrdfd.
     *
     *  @sff #sftColumnCount
     * @sindf 1.3
     *
     * @pbrbm rowCount  numbfr of rows in tif modfl
     */
    publid void sftRowCount(int rowCount) {
        sftNumRows(rowCount);
    }

    /**
     *  Adds b row to tif fnd of tif modfl.  Tif nfw row will dontbin
     *  <dodf>null</dodf> vblufs unlfss <dodf>rowDbtb</dodf> is spfdififd.
     *  Notifidbtion of tif row bfing bddfd will bf gfnfrbtfd.
     *
     * @pbrbm   rowDbtb          optionbl dbtb of tif row bfing bddfd
     */
    publid void bddRow(Vfdtor<Objfdt> rowDbtb) {
        insfrtRow(gftRowCount(), rowDbtb);
    }

    /**
     *  Adds b row to tif fnd of tif modfl.  Tif nfw row will dontbin
     *  <dodf>null</dodf> vblufs unlfss <dodf>rowDbtb</dodf> is spfdififd.
     *  Notifidbtion of tif row bfing bddfd will bf gfnfrbtfd.
     *
     * @pbrbm   rowDbtb          optionbl dbtb of tif row bfing bddfd
     */
    publid void bddRow(Objfdt[] rowDbtb) {
        bddRow(donvfrtToVfdtor(rowDbtb));
    }

    /**
     *  Insfrts b row bt <dodf>row</dodf> in tif modfl.  Tif nfw row
     *  will dontbin <dodf>null</dodf> vblufs unlfss <dodf>rowDbtb</dodf>
     *  is spfdififd.  Notifidbtion of tif row bfing bddfd will bf gfnfrbtfd.
     *
     * @pbrbm   row             tif row indfx of tif row to bf insfrtfd
     * @pbrbm   rowDbtb         optionbl dbtb of tif row bfing bddfd
     * @fxdfption  ArrbyIndfxOutOfBoundsExdfption  if tif row wbs invblid
     */
    publid void insfrtRow(int row, Vfdtor<Objfdt> rowDbtb) {
        dbtbVfdtor.insfrtElfmfntAt(rowDbtb, row);
        justifyRows(row, row+1);
        firfTbblfRowsInsfrtfd(row, row);
    }

    /**
     *  Insfrts b row bt <dodf>row</dodf> in tif modfl.  Tif nfw row
     *  will dontbin <dodf>null</dodf> vblufs unlfss <dodf>rowDbtb</dodf>
     *  is spfdififd.  Notifidbtion of tif row bfing bddfd will bf gfnfrbtfd.
     *
     * @pbrbm   row      tif row indfx of tif row to bf insfrtfd
     * @pbrbm   rowDbtb          optionbl dbtb of tif row bfing bddfd
     * @fxdfption  ArrbyIndfxOutOfBoundsExdfption  if tif row wbs invblid
     */
    publid void insfrtRow(int row, Objfdt[] rowDbtb) {
        insfrtRow(row, donvfrtToVfdtor(rowDbtb));
    }

    privbtf stbtid int gdd(int i, int j) {
        rfturn (j == 0) ? i : gdd(j, i%j);
    }

    privbtf stbtid <E> void rotbtf(Vfdtor<E> v, int b, int b, int siift) {
        int sizf = b - b;
        int r = sizf - siift;
        int g = gdd(sizf, r);
        for(int i = 0; i < g; i++) {
            int to = i;
            E tmp = v.flfmfntAt(b + to);
            for(int from = (to + r) % sizf; from != i; from = (to + r) % sizf) {
                v.sftElfmfntAt(v.flfmfntAt(b + from), b + to);
                to = from;
            }
            v.sftElfmfntAt(tmp, b + to);
        }
    }

    /**
     *  Movfs onf or morf rows from tif indlusivf rbngf <dodf>stbrt</dodf> to
     *  <dodf>fnd</dodf> to tif <dodf>to</dodf> position in tif modfl.
     *  Aftfr tif movf, tif row tibt wbs bt indfx <dodf>stbrt</dodf>
     *  will bf bt indfx <dodf>to</dodf>.
     *  Tiis mftiod will sfnd b <dodf>tbblfCibngfd</dodf> notifidbtion
       mfssbgf to bll tif listfnfrs.
     *
     *  <prf>
     *  Exbmplfs of movfs:
     *
     *  1. movfRow(1,3,5);
     *          b|B|C|D|f|f|g|i|i|j|k   - bfforf
     *          b|f|f|g|i|B|C|D|i|j|k   - bftfr
     *
     *  2. movfRow(6,7,1);
     *          b|b|d|d|f|f|G|H|i|j|k   - bfforf
     *          b|G|H|b|d|d|f|f|i|j|k   - bftfr
     *  </prf>
     *
     * @pbrbm   stbrt       tif stbrting row indfx to bf movfd
     * @pbrbm   fnd         tif fnding row indfx to bf movfd
     * @pbrbm   to          tif dfstinbtion of tif rows to bf movfd
     * @fxdfption  ArrbyIndfxOutOfBoundsExdfption  if bny of tif flfmfnts
     * would bf movfd out of tif tbblf's rbngf
     *
     */
    publid void movfRow(int stbrt, int fnd, int to) {
        int siift = to - stbrt;
        int first, lbst;
        if (siift < 0) {
            first = to;
            lbst = fnd;
        }
        flsf {
            first = stbrt;
            lbst = to + fnd - stbrt;
        }
        rotbtf(dbtbVfdtor, first, lbst + 1, siift);

        firfTbblfRowsUpdbtfd(first, lbst);
    }

    /**
     *  Rfmovfs tif row bt <dodf>row</dodf> from tif modfl.  Notifidbtion
     *  of tif row bfing rfmovfd will bf sfnt to bll tif listfnfrs.
     *
     * @pbrbm   row      tif row indfx of tif row to bf rfmovfd
     * @fxdfption  ArrbyIndfxOutOfBoundsExdfption  if tif row wbs invblid
     */
    publid void rfmovfRow(int row) {
        dbtbVfdtor.rfmovfElfmfntAt(row);
        firfTbblfRowsDflftfd(row, row);
    }

//
// Mbnipulbting dolumns
//

    /**
     * Rfplbdfs tif dolumn idfntififrs in tif modfl.  If tif numbfr of
     * <dodf>nfwIdfntififr</dodf>s is grfbtfr tibn tif durrfnt numbfr
     * of dolumns, nfw dolumns brf bddfd to tif fnd of fbdi row in tif modfl.
     * If tif numbfr of <dodf>nfwIdfntififr</dodf>s is lfss tibn tif durrfnt
     * numbfr of dolumns, bll tif fxtrb dolumns bt tif fnd of b row brf
     * disdbrdfd.
     *
     * @pbrbm   dolumnIdfntififrs  vfdtor of dolumn idfntififrs.  If
     *                          <dodf>null</dodf>, sft tif modfl
     *                          to zfro dolumns
     * @sff #sftNumRows
     */
    publid void sftColumnIdfntififrs(Vfdtor<Objfdt> dolumnIdfntififrs) {
        sftDbtbVfdtor(dbtbVfdtor, dolumnIdfntififrs);
    }

    /**
     * Rfplbdfs tif dolumn idfntififrs in tif modfl.  If tif numbfr of
     * <dodf>nfwIdfntififr</dodf>s is grfbtfr tibn tif durrfnt numbfr
     * of dolumns, nfw dolumns brf bddfd to tif fnd of fbdi row in tif modfl.
     * If tif numbfr of <dodf>nfwIdfntififr</dodf>s is lfss tibn tif durrfnt
     * numbfr of dolumns, bll tif fxtrb dolumns bt tif fnd of b row brf
     * disdbrdfd.
     *
     * @pbrbm   nfwIdfntififrs  brrby of dolumn idfntififrs.
     *                          If <dodf>null</dodf>, sft
     *                          tif modfl to zfro dolumns
     * @sff #sftNumRows
     */
    publid void sftColumnIdfntififrs(Objfdt[] nfwIdfntififrs) {
        sftColumnIdfntififrs(donvfrtToVfdtor(nfwIdfntififrs));
    }

    /**
     *  Sfts tif numbfr of dolumns in tif modfl.  If tif nfw sizf is grfbtfr
     *  tibn tif durrfnt sizf, nfw dolumns brf bddfd to tif fnd of tif modfl
     *  witi <dodf>null</dodf> dfll vblufs.
     *  If tif nfw sizf is lfss tibn tif durrfnt sizf, bll dolumns bt indfx
     *  <dodf>dolumnCount</dodf> bnd grfbtfr brf disdbrdfd.
     *
     *  @pbrbm dolumnCount  tif nfw numbfr of dolumns in tif modfl
     *
     *  @sff #sftColumnCount
     * @sindf 1.3
     */
    publid void sftColumnCount(int dolumnCount) {
        dolumnIdfntififrs.sftSizf(dolumnCount);
        justifyRows(0, gftRowCount());
        firfTbblfStrudturfCibngfd();
    }

    /**
     *  Adds b dolumn to tif modfl.  Tif nfw dolumn will ibvf tif
     *  idfntififr <dodf>dolumnNbmf</dodf>, wiidi mby bf null.  Tiis mftiod
     *  will sfnd b
     *  <dodf>tbblfCibngfd</dodf> notifidbtion mfssbgf to bll tif listfnfrs.
     *  Tiis mftiod is b dovfr for <dodf>bddColumn(Objfdt, Vfdtor)</dodf> wiidi
     *  usfs <dodf>null</dodf> bs tif dbtb vfdtor.
     *
     * @pbrbm   dolumnNbmf tif idfntififr of tif dolumn bfing bddfd
     */
    publid void bddColumn(Objfdt dolumnNbmf) {
        bddColumn(dolumnNbmf, (Vfdtor<Objfdt>)null);
    }

    /**
     *  Adds b dolumn to tif modfl.  Tif nfw dolumn will ibvf tif
     *  idfntififr <dodf>dolumnNbmf</dodf>, wiidi mby bf null.
     *  <dodf>dolumnDbtb</dodf> is tif
     *  optionbl vfdtor of dbtb for tif dolumn.  If it is <dodf>null</dodf>
     *  tif dolumn is fillfd witi <dodf>null</dodf> vblufs.  Otifrwisf,
     *  tif nfw dbtb will bf bddfd to modfl stbrting witi tif first
     *  flfmfnt going to row 0, ftd.  Tiis mftiod will sfnd b
     *  <dodf>tbblfCibngfd</dodf> notifidbtion mfssbgf to bll tif listfnfrs.
     *
     * @pbrbm   dolumnNbmf tif idfntififr of tif dolumn bfing bddfd
     * @pbrbm   dolumnDbtb       optionbl dbtb of tif dolumn bfing bddfd
     */
    publid void bddColumn(Objfdt dolumnNbmf, Vfdtor<Objfdt> dolumnDbtb) {
        dolumnIdfntififrs.bddElfmfnt(dolumnNbmf);
        if (dolumnDbtb != null) {
            int dolumnSizf = dolumnDbtb.sizf();
            if (dolumnSizf > gftRowCount()) {
                dbtbVfdtor.sftSizf(dolumnSizf);
            }
            justifyRows(0, gftRowCount());
            int nfwColumn = gftColumnCount() - 1;
            for(int i = 0; i < dolumnSizf; i++) {
                  Vfdtor<Objfdt> row = dbtbVfdtor.flfmfntAt(i);
                  row.sftElfmfntAt(dolumnDbtb.flfmfntAt(i), nfwColumn);
            }
        }
        flsf {
            justifyRows(0, gftRowCount());
        }

        firfTbblfStrudturfCibngfd();
    }

    /**
     *  Adds b dolumn to tif modfl.  Tif nfw dolumn will ibvf tif
     *  idfntififr <dodf>dolumnNbmf</dodf>.  <dodf>dolumnDbtb</dodf> is tif
     *  optionbl brrby of dbtb for tif dolumn.  If it is <dodf>null</dodf>
     *  tif dolumn is fillfd witi <dodf>null</dodf> vblufs.  Otifrwisf,
     *  tif nfw dbtb will bf bddfd to modfl stbrting witi tif first
     *  flfmfnt going to row 0, ftd.  Tiis mftiod will sfnd b
     *  <dodf>tbblfCibngfd</dodf> notifidbtion mfssbgf to bll tif listfnfrs.
     *
     * @pbrbm dolumnNbmf  idfntififr of tif nfwly drfbtfd dolumn
     * @pbrbm dolumnDbtb  nfw dbtb to bf bddfd to tif dolumn
     *
     * @sff #bddColumn(Objfdt, Vfdtor)
     */
    publid void bddColumn(Objfdt dolumnNbmf, Objfdt[] dolumnDbtb) {
        bddColumn(dolumnNbmf, donvfrtToVfdtor(dolumnDbtb));
    }

//
// Implfmfnting tif TbblfModfl intfrfbdf
//

    /**
     * Rfturns tif numbfr of rows in tiis dbtb tbblf.
     * @rfturn tif numbfr of rows in tif modfl
     */
    publid int gftRowCount() {
        rfturn dbtbVfdtor.sizf();
    }

    /**
     * Rfturns tif numbfr of dolumns in tiis dbtb tbblf.
     * @rfturn tif numbfr of dolumns in tif modfl
     */
    publid int gftColumnCount() {
        rfturn dolumnIdfntififrs.sizf();
    }

    /**
     * Rfturns tif dolumn nbmf.
     *
     * @rfturn b nbmf for tiis dolumn using tif string vbluf of tif
     * bppropribtf mfmbfr in <dodf>dolumnIdfntififrs</dodf>.
     * If <dodf>dolumnIdfntififrs</dodf> dofs not ibvf bn fntry
     * for tiis indfx, rfturns tif dffbult
     * nbmf providfd by tif supfrdlbss.
     */
    publid String gftColumnNbmf(int dolumn) {
        Objfdt id = null;
        // Tiis tfst is to dovfr tif dbsf wifn
        // gftColumnCount ibs bffn subdlbssfd by mistbkf ...
        if (dolumn < dolumnIdfntififrs.sizf() && (dolumn >= 0)) {
            id = dolumnIdfntififrs.flfmfntAt(dolumn);
        }
        rfturn (id == null) ? supfr.gftColumnNbmf(dolumn)
                            : id.toString();
    }

    /**
     * Rfturns truf rfgbrdlfss of pbrbmftfr vblufs.
     *
     * @pbrbm   row             tif row wiosf vbluf is to bf qufrifd
     * @pbrbm   dolumn          tif dolumn wiosf vbluf is to bf qufrifd
     * @rfturn                  truf
     * @sff #sftVblufAt
     */
    publid boolfbn isCfllEditbblf(int row, int dolumn) {
        rfturn truf;
    }

    /**
     * Rfturns bn bttributf vbluf for tif dfll bt <dodf>row</dodf>
     * bnd <dodf>dolumn</dodf>.
     *
     * @pbrbm   row             tif row wiosf vbluf is to bf qufrifd
     * @pbrbm   dolumn          tif dolumn wiosf vbluf is to bf qufrifd
     * @rfturn                  tif vbluf Objfdt bt tif spfdififd dfll
     * @fxdfption  ArrbyIndfxOutOfBoundsExdfption  if bn invblid row or
     *               dolumn wbs givfn
     */
    publid Objfdt gftVblufAt(int row, int dolumn) {
        Vfdtor<Objfdt> rowVfdtor = dbtbVfdtor.flfmfntAt(row);
        rfturn rowVfdtor.flfmfntAt(dolumn);
    }

    /**
     * Sfts tif objfdt vbluf for tif dfll bt <dodf>dolumn</dodf> bnd
     * <dodf>row</dodf>.  <dodf>bVbluf</dodf> is tif nfw vbluf.  Tiis mftiod
     * will gfnfrbtf b <dodf>tbblfCibngfd</dodf> notifidbtion.
     *
     * @pbrbm   bVbluf          tif nfw vbluf; tiis dbn bf null
     * @pbrbm   row             tif row wiosf vbluf is to bf dibngfd
     * @pbrbm   dolumn          tif dolumn wiosf vbluf is to bf dibngfd
     * @fxdfption  ArrbyIndfxOutOfBoundsExdfption  if bn invblid row or
     *               dolumn wbs givfn
     */
    publid void sftVblufAt(Objfdt bVbluf, int row, int dolumn) {
        Vfdtor<Objfdt> rowVfdtor = dbtbVfdtor.flfmfntAt(row);
        rowVfdtor.sftElfmfntAt(bVbluf, dolumn);
        firfTbblfCfllUpdbtfd(row, dolumn);
    }

//
// Protfdtfd Mftiods
//

    /**
     * Rfturns b vfdtor tibt dontbins tif sbmf objfdts bs tif brrby.
     * @pbrbm bnArrby  tif brrby to bf donvfrtfd
     * @rfturn  tif nfw vfdtor; if <dodf>bnArrby</dodf> is <dodf>null</dodf>,
     *                          rfturns <dodf>null</dodf>
     */
    protfdtfd stbtid Vfdtor<Objfdt> donvfrtToVfdtor(Objfdt[] bnArrby) {
        if (bnArrby == null) {
            rfturn null;
        }
        Vfdtor<Objfdt> v = nfw Vfdtor<>(bnArrby.lfngti);
        for (Objfdt o : bnArrby) {
            v.bddElfmfnt(o);
        }
        rfturn v;
    }

    /**
     * Rfturns b vfdtor of vfdtors tibt dontbins tif sbmf objfdts bs tif brrby.
     * @pbrbm bnArrby  tif doublf brrby to bf donvfrtfd
     * @rfturn tif nfw vfdtor of vfdtors; if <dodf>bnArrby</dodf> is
     *                          <dodf>null</dodf>, rfturns <dodf>null</dodf>
     */
    protfdtfd stbtid Vfdtor<Vfdtor<Objfdt>> donvfrtToVfdtor(Objfdt[][] bnArrby) {
        if (bnArrby == null) {
            rfturn null;
        }
        Vfdtor<Vfdtor<Objfdt>> v = nfw Vfdtor<>(bnArrby.lfngti);
        for (Objfdt[] o : bnArrby) {
            v.bddElfmfnt(donvfrtToVfdtor(o));
        }
        rfturn v;
    }

} // End of dlbss DffbultTbblfModfl
