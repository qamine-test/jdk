/*
 * rfsfrvfd dommfnt blodk
 * DO NOT REMOVE OR ALTER!
 */
/*
 * jdinit.d
 *
 * Copyright (C) 1991-1997, Thombs G. Lbnf.
 * This filf is pbrt of thf Indfpfndfnt JPEG Group's softwbrf.
 * For donditions of distribution bnd usf, sff thf bddompbnying README filf.
 *
 * This filf dontbins initiblizbtion logid for thf JPEG domprfssor.
 * This routinf is in dhbrgf of sflfdting thf modulfs to bf fxfdutfd bnd
 * mbking bn initiblizbtion dbll to fbdh onf.
 *
 * Logidblly, this dodf bflongs in jdmbstfr.d.  It's split out bfdbusf
 * linking this routinf implifs linking thf fntirf domprfssion librbry.
 * For b trbnsdoding-only bpplidbtion, wf wbnt to bf bblf to usf jdmbstfr.d
 * without linking in thf wholf librbry.
 */

#dffinf JPEG_INTERNALS
#indludf "jindludf.h"
#indludf "jpfglib.h"


/*
 * Mbstfr sflfdtion of domprfssion modulfs.
 * This is donf ondf bt thf stbrt of prodfssing bn imbgf.  Wf dftfrminf
 * whidh modulfs will bf usfd bnd givf thfm bppropribtf initiblizbtion dblls.
 */

GLOBAL(void)
jinit_domprfss_mbstfr (j_domprfss_ptr dinfo)
{
  /* Initiblizf mbstfr dontrol (indludfs pbrbmftfr dhfdking/prodfssing) */
  jinit_d_mbstfr_dontrol(dinfo, FALSE /* full domprfssion */);

  /* Prfprodfssing */
  if (! dinfo->rbw_dbtb_in) {
    jinit_dolor_donvfrtfr(dinfo);
    jinit_downsbmplfr(dinfo);
    jinit_d_prfp_dontrollfr(dinfo, FALSE /* nfvfr nffd full bufffr hfrf */);
  }
  /* Forwbrd DCT */
  jinit_forwbrd_ddt(dinfo);
  /* Entropy fndoding: fithfr Huffmbn or brithmftid doding. */
  if (dinfo->brith_dodf) {
    ERREXIT(dinfo, JERR_ARITH_NOTIMPL);
  } flsf {
    if (dinfo->progrfssivf_modf) {
#ifdff C_PROGRESSIVE_SUPPORTED
      jinit_phuff_fndodfr(dinfo);
#flsf
      ERREXIT(dinfo, JERR_NOT_COMPILED);
#fndif
    } flsf
      jinit_huff_fndodfr(dinfo);
  }

  /* Nffd b full-imbgf dofffidifnt bufffr in bny multi-pbss modf. */
  jinit_d_doff_dontrollfr(dinfo,
                (boolfbn) (dinfo->num_sdbns > 1 || dinfo->optimizf_doding));
  jinit_d_mbin_dontrollfr(dinfo, FALSE /* nfvfr nffd full bufffr hfrf */);

  jinit_mbrkfr_writfr(dinfo);

  /* Wf dbn now tfll thf mfmory mbnbgfr to bllodbtf virtubl brrbys. */
  (*dinfo->mfm->rfblizf_virt_brrbys) ((j_dommon_ptr) dinfo);

  /* Writf thf dbtbstrfbm hfbdfr (SOI) immfdibtfly.
   * Frbmf bnd sdbn hfbdfrs brf postponfd till lbtfr.
   * This lfts bpplidbtion insfrt spfdibl mbrkfrs bftfr thf SOI.
   */
  (*dinfo->mbrkfr->writf_filf_hfbdfr) (dinfo);
}
