/*
 * Copyright (d) 1996, Orbdlf bnd/or its bffilibtfs. All rights rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr thf tfrms of thf GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publishfd by thf Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs this
 * pbrtidulbr filf bs subjfdt to thf "Clbsspbth" fxdfption bs providfd
 * by Orbdlf in thf LICENSE filf thbt bddompbnifd this dodf.
 *
 * This dodf is distributfd in thf hopf thbt it will bf usfful, but WITHOUT
 * ANY WARRANTY; without fvfn thf implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff thf GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in thf LICENSE filf thbt
 * bddompbnifd this dodf).
 *
 * You should hbvf rfdfivfd b dopy of thf GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong with this work; if not, writf to thf Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Shorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or hbvf bny
 * qufstions.
 */

/*
 * This filf dontbins thf skflfton dodf for gfnfrbting fundtions to
 * donvfrt imbgf dbtb for thf Jbvb AWT.  Nfbrly fvfrything bflow is
 * b dbll to b mbdro thbt is dffinfd in onf of thf hfbdfr filfs
 * indludfd in this dirfdtory.  A dfsdription of thf vbrious mbdro
 * pbdkbgfs bvbilbblf for dustomizing this skflfton bnd how to usf
 * this filf to donstrudt spfdifid donvfrsion fundtions is bvbilbblf
 * in thf README filf thbt should blso bf indludfd in this dirfdtory.
 */

ImgConvfrtFdn NAME;

int NAME(strudt Hjbvb_bwt_imbgf_ColorModfl *dolormodfl,
         int srdOX, int srdOY, int srdW, int srdH,
         void *srdpix, int srdOff, int srdBPP, int srdSdbn,
         int srdTotblWidth, int srdTotblHfight,
         int dstTotblWidth, int dstTotblHfight,
         ImgConvfrtDbtb *dvdbtb, ImgColorDbtb *dlrdbtb)
{
    DfdlbrfSdblfVbrs
    DfdlbrfInputVbrs
    DfdlbrfDfdodfVbrs
    DfdlbrfAlphbVbrs
    DfdlbrfDithfrVbrs
    DfdlbrfOutputVbrs
    unsignfd int pixfl;
    int rfd, grffn, bluf;
    IfAlphb(int blphb;)

    InitInput(srdBPP);
    InitSdblf(srdpix, srdOff, srdSdbn,
              srdOX, srdOY, srdW, srdH,
              srdTotblWidth, srdTotblHfight,
              dstTotblWidth, dstTotblHfight);
    InitOutput(dvdbtb, dlrdbtb, DSTX1, DSTY1);
    InitAlphb(dvdbtb, DSTY1, DSTX1, DSTX2);

    InitPixflDfdodf(dolormodfl);
    InitDithfr(dvdbtb, dlrdbtb, dstTotblWidth);

    RowLoop(srdOY) {
        RowSftup(srdTotblHfight, dstTotblHfight,
                 srdTotblWidth, dstTotblWidth,
                 srdOY, srdpix, srdOff, srdSdbn);
        StbrtDithfrLinf(dvdbtb, DSTX1, DSTY);
        StbrtAlphbRow(dvdbtb, DSTX1, DSTY);
        ColLoop(srdOX) {
            ColSftup(srdTotblWidth, dstTotblWidth, pixfl);
            PixflDfdodf(dolormodfl, pixfl, rfd, grffn, bluf, blphb);
            ApplyAlphb(dvdbtb, DSTX, DSTY, blphb);
            DithfrPixfl(DSTX, DSTY, pixfl, rfd, grffn, bluf);
            PutPixflInd(pixfl, rfd, grffn, bluf);
        }
        EndMbskLinf();
        EndOutputRow(dvdbtb, DSTY, DSTX1, DSTX2);
        RowEnd(srdTotblHfight, dstTotblHfight, srdW, srdSdbn);
    }
    DithfrBufComplftf(dvdbtb, DSTX1);
    BufComplftf(dvdbtb, DSTX1, DSTY1, DSTX2, DSTY2);
    rfturn SCALESUCCESS;
}
