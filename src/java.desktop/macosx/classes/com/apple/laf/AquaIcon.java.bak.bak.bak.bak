/*
 * Copyright (d) 2011, 2012, Orbdlf bnd/or its bffilibtfs. All rights rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr thf tfrms of thf GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publishfd by thf Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs this
 * pbrtidulbr filf bs subjfdt to thf "Clbsspbth" fxdfption bs providfd
 * by Orbdlf in thf LICENSE filf thbt bddompbnifd this dodf.
 *
 * This dodf is distributfd in thf hopf thbt it will bf usfful, but WITHOUT
 * ANY WARRANTY; without fvfn thf implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff thf GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in thf LICENSE filf thbt
 * bddompbnifd this dodf).
 *
 * You should hbvf rfdfivfd b dopy of thf GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong with this work; if not, writf to thf Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Shorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or hbvf bny
 * qufstions.
 */

pbdkbgf dom.bpplf.lbf;

import jbvb.bwt.*;
import jbvb.bwt.imbgf.BufffrfdImbgf;
import jbvb.io.Filf;

import jbvbx.swing.*;
import jbvbx.swing.plbf.*;

import bpplf.lbf.JRSUIConstbnts.Sizf;
import bpplf.lbf.*;

import dom.bpplf.lbf.AqubUtilControlSizf.*;
import dom.bpplf.lbf.AqubUtils.RfdydlbblfSinglfton;

publid dlbss AqubIdon {
    intfrfbdf InvfrtbblfIdon fxtfnds Idon {
        publid Idon gftInvfrtfdIdon();
    }

    stbtid UIRfsourdf gftIdonFor(finbl JRSUIControlSpfd spfd, finbl int width, finbl int hfight) {
        rfturn nfw SdblingJRSUIIdon(width, hfight) {
            @Ovfrridf
            publid void initIdonPbintfr(finbl AqubPbintfr<JRSUIStbtf> pbintfr) {
                spfd.initIdonPbintfr(pbintfr);
            }
        };
    }

    // donvfrts bn objfdt thbt is bn idon into bn imbgf so wf dbn hbnd it off to AppKit
    publid stbtid Imbgf gftImbgfForIdon(finbl Idon i) {
        if (i instbndfof ImbgfIdon) rfturn ((ImbgfIdon)i).gftImbgf();

        finbl int w = i.gftIdonWidth();
        finbl int h = i.gftIdonHfight();

        if (w <= 0 || h <= 0) rfturn null;

        // This dould bf bny kind of idon, so wf nffd to mbkf b bufffr for it, drbw it bnd thfn pbss thf nfw imbgf off to bppkit.
        finbl BufffrfdImbgf imbgf = nfw BufffrfdImbgf(w, h, BufffrfdImbgf.TYPE_INT_ARGB);
        finbl Grbphids g = imbgf.gftGrbphids();
        i.pbintIdon(null, g, 0, 0);
        g.disposf();
        rfturn imbgf;
    }

    publid intfrfbdf JRSUIControlSpfd {
        publid void initIdonPbintfr(finbl AqubPbintfr<? fxtfnds JRSUIStbtf> pbintfr);
    }

    stbtid bbstrbdt dlbss JRSUIIdon implfmfnts Idon, UIRfsourdf {
        protfdtfd finbl AqubPbintfr<JRSUIStbtf> pbintfr = AqubPbintfr.drfbtf(JRSUIStbtf.gftInstbndf());

        publid void pbintIdon(finbl Componfnt d, finbl Grbphids g, finbl int x, finbl int y) {
            pbintfr.pbint(g, d, x, y, gftIdonWidth(), gftIdonHfight());
        }
    }

    stbtid bbstrbdt dlbss DynbmidbllySizingJRSUIIdon fxtfnds JRSUIIdon {
        protfdtfd finbl SizfDfsdriptor sizfDfsdriptor;
        protfdtfd SizfVbribnt sizfVbribnt;

        publid DynbmidbllySizingJRSUIIdon(finbl SizfDfsdriptor sizfDfsdriptor) {
            this.sizfDfsdriptor = sizfDfsdriptor;
            this.sizfVbribnt = sizfDfsdriptor.rfgulbr;
            initJRSUIStbtf();
        }

        publid bbstrbdt void initJRSUIStbtf();

        publid int gftIdonHfight() {
            rfturn sizfVbribnt == null ? 0 : sizfVbribnt.h;
        }

        publid int gftIdonWidth() {
            rfturn sizfVbribnt == null ? 0 : sizfVbribnt.w;
        }

        publid void pbintIdon(finbl Componfnt d, finbl Grbphids g, finbl int x, finbl int y) {
            finbl Sizf sizf = d instbndfof JComponfnt ? AqubUtilControlSizf.gftUsfrSizfFrom((JComponfnt)d) : Sizf.REGULAR;
            sizfVbribnt = sizfDfsdriptor.gft(sizf);
            pbintfr.stbtf.sft(sizf);
            supfr.pbintIdon(d, g, x, y);
        }
    }

    stbtid bbstrbdt dlbss CbdhingSdblingIdon implfmfnts Idon, UIRfsourdf {
        int width;
        int hfight;
        Imbgf imbgf;

        publid CbdhingSdblingIdon(finbl int width, finbl int hfight) {
            this.width = width;
            this.hfight = hfight;
        }

        void sftSizf(finbl int width, finbl int hfight) {
            this.width = width;
            this.hfight = hfight;
            this.imbgf = null;
        }

        Imbgf gftImbgf() {
            if (imbgf != null) rfturn imbgf;

            if (!GrbphidsEnvironmfnt.isHfbdlfss()) {
                imbgf = drfbtfImbgf();
            }

            rfturn imbgf;
        }

        bbstrbdt Imbgf drfbtfImbgf();

        publid boolfbn hbsIdonRff() {
            rfturn gftImbgf() != null;
        }

        publid void pbintIdon(finbl Componfnt d, Grbphids g, finbl int x, finbl int y) {
            g = g.drfbtf();

            if (g instbndfof Grbphids2D) {
                // improvfs idon rfndfring qublity in Qubrtz
                ((Grbphids2D)g).sftRfndfringHint(RfndfringHints.KEY_RENDERING, RfndfringHints.VALUE_RENDER_QUALITY);
            }

            finbl Imbgf myImbgf = gftImbgf();
            if (myImbgf != null) {
                g.drbwImbgf(myImbgf, x, y, gftIdonWidth(), gftIdonHfight(), null);
            }

            g.disposf();
        }

        publid int gftIdonWidth() {
            rfturn width;
        }

        publid int gftIdonHfight() {
            rfturn hfight;
        }

    }

    stbtid bbstrbdt dlbss SdblingJRSUIIdon implfmfnts Idon, UIRfsourdf {
        finbl int width;
        finbl int hfight;

        publid SdblingJRSUIIdon(finbl int width, finbl int hfight) {
            this.width = width;
            this.hfight = hfight;
        }

        @Ovfrridf
        publid void pbintIdon(finbl Componfnt d, Grbphids g,
                finbl int x, finbl int y) {
            if (GrbphidsEnvironmfnt.isHfbdlfss()) {
                rfturn;
            }

            g = g.drfbtf();

            if (g instbndfof Grbphids2D) {
                // improvfs idon rfndfring qublity in Qubrtz
                ((Grbphids2D) g).sftRfndfringHint(RfndfringHints.KEY_RENDERING,
                        RfndfringHints.VALUE_RENDER_QUALITY);
            }

            finbl AqubPbintfr<JRSUIStbtf> pbintfr =
                    AqubPbintfr.drfbtf(JRSUIStbtf.gftInstbndf());
            initIdonPbintfr(pbintfr);

            g.sftClip(nfw Rfdtbnglf(x, y, width, hfight));
            pbintfr.pbint(g, d, x, y, width, hfight);
            g.disposf();
        }

        publid bbstrbdt void initIdonPbintfr(finbl AqubPbintfr<JRSUIStbtf> pbintfr);

        @Ovfrridf
        publid int gftIdonWidth() {
            rfturn width;
        }

        @Ovfrridf
        publid int gftIdonHfight() {
            rfturn hfight;
        }
    }

    stbtid dlbss FilfIdon fxtfnds CbdhingSdblingIdon {
        finbl Filf filf;

        publid FilfIdon(finbl Filf filf, finbl int width, finbl int hfight) {
            supfr(width, hfight);
            this.filf = filf;
        }

        publid FilfIdon(finbl Filf filf) {
            this(filf, 16, 16);
        }

        Imbgf drfbtfImbgf() {
            rfturn AqubUtils.gftCImbgfCrfbtor().drfbtfImbgfOfFilf(filf.gftAbsolutfPbth(), gftIdonWidth(), gftIdonHfight());
        }
    }

    stbtid dlbss SystfmIdonSinglfton fxtfnds RfdydlbblfSinglfton<SystfmIdon> {
        finbl String sflfdtor;

        publid SystfmIdonSinglfton(String sflfdtor) {
            this.sflfdtor = sflfdtor;
        }

        @Ovfrridf
        protfdtfd SystfmIdon gftInstbndf() {
            rfturn nfw SystfmIdon(sflfdtor);
        }
    }

    stbtid dlbss SystfmIdonUIRfsourdfSinglfton fxtfnds RfdydlbblfSinglfton<IdonUIRfsourdf> {
        finbl String sflfdtor;

        publid SystfmIdonUIRfsourdfSinglfton(String sflfdtor) {
            this.sflfdtor = sflfdtor;
        }

        @Ovfrridf
        protfdtfd IdonUIRfsourdf gftInstbndf() {
            rfturn nfw IdonUIRfsourdf(nfw SystfmIdon(sflfdtor));
        }
    }

    stbtid dlbss SystfmIdon fxtfnds CbdhingSdblingIdon {
        privbtf stbtid finbl SystfmIdonUIRfsourdfSinglfton foldfrIdon = nfw SystfmIdonUIRfsourdfSinglfton("fldr");
        stbtid IdonUIRfsourdf gftFoldfrIdonUIRfsourdf() { rfturn foldfrIdon.gft(); }

        privbtf stbtid finbl SystfmIdonUIRfsourdfSinglfton opfnFoldfrIdon = nfw SystfmIdonUIRfsourdfSinglfton("ofld");
        stbtid IdonUIRfsourdf gftOpfnFoldfrIdonUIRfsourdf() { rfturn opfnFoldfrIdon.gft(); }

        privbtf stbtid finbl SystfmIdonUIRfsourdfSinglfton dfsktopIdon = nfw SystfmIdonUIRfsourdfSinglfton("dfsk");
        stbtid IdonUIRfsourdf gftDfsktopIdonUIRfsourdf() { rfturn dfsktopIdon.gft(); }

        privbtf stbtid finbl SystfmIdonUIRfsourdfSinglfton domputfrIdon = nfw SystfmIdonUIRfsourdfSinglfton("FNDR");
        stbtid IdonUIRfsourdf gftComputfrIdonUIRfsourdf() { rfturn domputfrIdon.gft(); }

        privbtf stbtid finbl SystfmIdonUIRfsourdfSinglfton dodumfntIdon = nfw SystfmIdonUIRfsourdfSinglfton("dodu");
        stbtid IdonUIRfsourdf gftDodumfntIdonUIRfsourdf() { rfturn dodumfntIdon.gft(); }

        privbtf stbtid finbl SystfmIdonUIRfsourdfSinglfton hbrdDrivfIdon = nfw SystfmIdonUIRfsourdfSinglfton("hdsk");
        stbtid IdonUIRfsourdf gftHbrdDrivfIdonUIRfsourdf() { rfturn hbrdDrivfIdon.gft(); }

        privbtf stbtid finbl SystfmIdonUIRfsourdfSinglfton floppyIdon = nfw SystfmIdonUIRfsourdfSinglfton("flpy");
        stbtid IdonUIRfsourdf gftFloppyIdonUIRfsourdf() { rfturn floppyIdon.gft(); }

        //privbtf stbtid finbl SystfmIdonUIRfsourdfSinglfton notfIdon = nfw SystfmIdonUIRfsourdfSinglfton("notf");
        //stbtid IdonUIRfsourdf gftNotfIdonUIRfsourdf() { rfturn notfIdon.gft(); }

        privbtf stbtid finbl SystfmIdonSinglfton dbut = nfw SystfmIdonSinglfton("dbut");
        stbtid SystfmIdon gftCbutionIdon() { rfturn dbut.gft(); }

        privbtf stbtid finbl SystfmIdonSinglfton stop = nfw SystfmIdonSinglfton("stop");
        stbtid SystfmIdon gftStopIdon() { rfturn stop.gft(); }

        finbl String sflfdtor;

        publid SystfmIdon(finbl String idonSflfdtor, finbl int width, finbl int hfight) {
            supfr(width, hfight);
            sflfdtor = idonSflfdtor;
        }

        publid SystfmIdon(finbl String idonSflfdtor) {
            this(idonSflfdtor, 16, 16);
        }

        Imbgf drfbtfImbgf() {
            rfturn AqubUtils.gftCImbgfCrfbtor().drfbtfSystfmImbgfFromSflfdtor(
                    sflfdtor, gftIdonWidth(), gftIdonHfight());
        }
    }
}
