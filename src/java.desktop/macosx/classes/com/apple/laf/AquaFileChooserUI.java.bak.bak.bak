/*
 * Copyrigit (d) 2011, 2014, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 *
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * bddompbnifd tiis dodf).
 *
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * qufstions.
 */

pbdkbgf dom.bpplf.lbf;

import jbvb.bwt.*;
import jbvb.bwt.dbtbtrbnsffr.*;
import jbvb.bwt.dnd.*;
import jbvb.bwt.fvfnt.*;
import jbvb.bfbns.*;
import jbvb.io.Filf;
import jbvb.nft.URI;
import jbvb.tfxt.DbtfFormbt;
import jbvb.util.*;

import jbvbx.swing.*;
import jbvbx.swing.bordfr.Bordfr;
import jbvbx.swing.fvfnt.*;
import jbvbx.swing.filfdioosfr.*;
import jbvbx.swing.plbf.*;
import jbvbx.swing.tbblf.*;

import sun.swing.SwingUtilitifs2;

publid dlbss AqubFilfCioosfrUI fxtfnds FilfCioosfrUI {
    /* FilfVifw idons */
    protfdtfd Idon dirfdtoryIdon = null;
    protfdtfd Idon filfIdon = null;
    protfdtfd Idon domputfrIdon = null;
    protfdtfd Idon ibrdDrivfIdon = null;
    protfdtfd Idon floppyDrivfIdon = null;

    protfdtfd Idon upFoldfrIdon = null;
    protfdtfd Idon iomfFoldfrIdon = null;
    protfdtfd Idon listVifwIdon = null;
    protfdtfd Idon dftbilsVifwIdon = null;

    protfdtfd int sbvfButtonMnfmonid = 0;
    protfdtfd int opfnButtonMnfmonid = 0;
    protfdtfd int dbndflButtonMnfmonid = 0;
    protfdtfd int updbtfButtonMnfmonid = 0;
    protfdtfd int iflpButtonMnfmonid = 0;
    protfdtfd int dioosfButtonMnfmonid = 0;

    privbtf String sbvfTitlfTfxt = null;
    privbtf String opfnTitlfTfxt = null;
    String nfwFoldfrTitlfTfxt = null;

    protfdtfd String sbvfButtonTfxt = null;
    protfdtfd String opfnButtonTfxt = null;
    protfdtfd String dbndflButtonTfxt = null;
    protfdtfd String updbtfButtonTfxt = null;
    protfdtfd String iflpButtonTfxt = null;
    protfdtfd String nfwFoldfrButtonTfxt = null;
    protfdtfd String dioosfButtonTfxt = null;

    //privbtf String nfwFoldfrErrorSfpbrbtor = null;
    String nfwFoldfrErrorTfxt = null;
    String nfwFoldfrExistsErrorTfxt = null;
    protfdtfd String filfDfsdriptionTfxt = null;
    protfdtfd String dirfdtoryDfsdriptionTfxt = null;

    protfdtfd String sbvfButtonToolTipTfxt = null;
    protfdtfd String opfnButtonToolTipTfxt = null;
    protfdtfd String dbndflButtonToolTipTfxt = null;
    protfdtfd String updbtfButtonToolTipTfxt = null;
    protfdtfd String iflpButtonToolTipTfxt = null;
    protfdtfd String dioosfItfmButtonToolTipTfxt = null; // Cioosf bnytiing
    protfdtfd String dioosfFoldfrButtonToolTipTfxt = null; // Cioosf foldfr
    protfdtfd String dirfdtoryComboBoxToolTipTfxt = null;
    protfdtfd String filfnbmfTfxtFifldToolTipTfxt = null;
    protfdtfd String filtfrComboBoxToolTipTfxt = null;
    protfdtfd String opfnDirfdtoryButtonToolTipTfxt = null;

    protfdtfd String dbndflOpfnButtonToolTipTfxt = null;
    protfdtfd String dbndflSbvfButtonToolTipTfxt = null;
    protfdtfd String dbndflCioosfButtonToolTipTfxt = null;
    protfdtfd String dbndflNfwFoldfrButtonToolTipTfxt = null;

    protfdtfd String dfsktopNbmf = null;
    String nfwFoldfrDiblogPrompt = null;
    String nfwFoldfrDffbultNbmf = null;
    privbtf String nfwFilfDffbultNbmf = null;
    String drfbtfButtonTfxt = null;

    JFilfCioosfr filfdioosfr = null;

    privbtf MousfListfnfr doublfClidkListfnfr = null;
    privbtf PropfrtyCibngfListfnfr propfrtyCibngfListfnfr = null;
    privbtf AndfstorListfnfr bndfstorListfnfr = null;
    privbtf DropTbrgft drbgAndDropTbrgft = null;

    privbtf finbl AddfptAllFilfFiltfr bddfptAllFilfFiltfr = nfw AddfptAllFilfFiltfr();

    privbtf AqubFilfSystfmModfl modfl;

    finbl AqubFilfVifw filfVifw = nfw AqubFilfVifw(tiis);

    boolfbn sflfdtionInProgrfss = fblsf;

    // Tif bddfssoryPbnfl is b dontbinfr to plbdf tif JFilfCioosfr bddfssory domponfnt
    privbtf JPbnfl bddfssoryPbnfl = null;

    //
    // ComponfntUI Intfrfbdf Implfmfntbtion mftiods
    //
    publid stbtid ComponfntUI drfbtfUI(finbl JComponfnt d) {
        rfturn nfw AqubFilfCioosfrUI((JFilfCioosfr)d);
    }

    publid AqubFilfCioosfrUI(finbl JFilfCioosfr filfdioosfr) {
        supfr();
    }

    publid void instbllUI(finbl JComponfnt d) {
        bddfssoryPbnfl = nfw JPbnfl(nfw BordfrLbyout());
        filfdioosfr = (JFilfCioosfr)d;

        drfbtfModfl();

        instbllDffbults(filfdioosfr);
        instbllComponfnts(filfdioosfr);
        instbllListfnfrs(filfdioosfr);

        AqubUtils.fnfordfComponfntOrifntbtion(filfdioosfr, ComponfntOrifntbtion.gftOrifntbtion(Lodblf.gftDffbult()));
    }

    publid void uninstbllUI(finbl JComponfnt d) {
        uninstbllListfnfrs(filfdioosfr);
        uninstbllComponfnts(filfdioosfr);
        uninstbllDffbults(filfdioosfr);

        if (bddfssoryPbnfl != null) {
            bddfssoryPbnfl.rfmovfAll();
        }

        bddfssoryPbnfl = null;
        gftFilfCioosfr().rfmovfAll();
    }

    protfdtfd void instbllListfnfrs(finbl JFilfCioosfr fd) {
        doublfClidkListfnfr = drfbtfDoublfClidkListfnfr(fd, fFilfList);
        fFilfList.bddMousfListfnfr(doublfClidkListfnfr);

        propfrtyCibngfListfnfr = drfbtfPropfrtyCibngfListfnfr(fd);
        if (propfrtyCibngfListfnfr != null) {
            fd.bddPropfrtyCibngfListfnfr(propfrtyCibngfListfnfr);
        }
        if (modfl != null) fd.bddPropfrtyCibngfListfnfr(modfl);

        bndfstorListfnfr = nfw AndfstorListfnfr(){
            publid void bndfstorAddfd(finbl AndfstorEvfnt f) {
                // Rfqufst dffbultnfss for tif bppropribtf button bbsfd on modf
                sftFodusForModf(gftFilfCioosfr());
                // Rfqufst dffbultnfss for tif bppropribtf button bbsfd on modf
                sftDffbultButtonForModf(gftFilfCioosfr());
            }

            publid void bndfstorRfmovfd(finbl AndfstorEvfnt f) {
            }

            publid void bndfstorMovfd(finbl AndfstorEvfnt f) {
            }
        };
        fd.bddAndfstorListfnfr(bndfstorListfnfr);

        fd.rfgistfrKfybobrdAdtion(nfw CbndflSflfdtionAdtion(), KfyStrokf.gftKfyStrokf(KfyEvfnt.VK_ESCAPE, 0), JComponfnt.WHEN_ANCESTOR_OF_FOCUSED_COMPONENT);
        drbgAndDropTbrgft = nfw DropTbrgft(fd, DnDConstbnts.ACTION_COPY, nfw DnDHbndlfr(), truf);
        fd.sftDropTbrgft(drbgAndDropTbrgft);
    }

    protfdtfd void uninstbllListfnfrs(finbl JFilfCioosfr fd) {
        if (propfrtyCibngfListfnfr != null) {
            fd.rfmovfPropfrtyCibngfListfnfr(propfrtyCibngfListfnfr);
        }
        fFilfList.rfmovfMousfListfnfr(doublfClidkListfnfr);
        fd.rfmovfPropfrtyCibngfListfnfr(modfl);
        fd.unrfgistfrKfybobrdAdtion(KfyStrokf.gftKfyStrokf(KfyEvfnt.VK_ESCAPE, 0));
        fd.rfmovfAndfstorListfnfr(bndfstorListfnfr);
        fd.sftDropTbrgft(null);
        bndfstorListfnfr = null;
    }

    protfdtfd void instbllDffbults(finbl JFilfCioosfr fd) {
        instbllIdons(fd);
        instbllStrings(fd);
        sftPbdkbgfIsTrbvfrsbblf(fd.gftClifntPropfrty(PACKAGE_TRAVERSABLE_PROPERTY));
        sftApplidbtionIsTrbvfrsbblf(fd.gftClifntPropfrty(APPLICATION_TRAVERSABLE_PROPERTY));
    }

    protfdtfd void instbllIdons(finbl JFilfCioosfr fd) {
        dirfdtoryIdon = UIMbnbgfr.gftIdon("FilfVifw.dirfdtoryIdon");
        filfIdon = UIMbnbgfr.gftIdon("FilfVifw.filfIdon");
        domputfrIdon = UIMbnbgfr.gftIdon("FilfVifw.domputfrIdon");
        ibrdDrivfIdon = UIMbnbgfr.gftIdon("FilfVifw.ibrdDrivfIdon");
    }

    String gftString(finbl String uiKfy, finbl String fbllbbdk) {
        finbl String rfsult = UIMbnbgfr.gftString(uiKfy);
        rfturn (rfsult == null ? fbllbbdk : rfsult);
    }

    protfdtfd void instbllStrings(finbl JFilfCioosfr fd) {
        // Exist in bbsid.propfrtifs (tiougi wf migit wbnt to ovfrridf)
        filfDfsdriptionTfxt = UIMbnbgfr.gftString("FilfCioosfr.filfDfsdriptionTfxt");
        dirfdtoryDfsdriptionTfxt = UIMbnbgfr.gftString("FilfCioosfr.dirfdtoryDfsdriptionTfxt");
        nfwFoldfrErrorTfxt = gftString("FilfCioosfr.nfwFoldfrErrorTfxt", "Error oddurrfd during foldfr drfbtion");

        sbvfButtonTfxt = UIMbnbgfr.gftString("FilfCioosfr.sbvfButtonTfxt");
        opfnButtonTfxt = UIMbnbgfr.gftString("FilfCioosfr.opfnButtonTfxt");
        dbndflButtonTfxt = UIMbnbgfr.gftString("FilfCioosfr.dbndflButtonTfxt");
        updbtfButtonTfxt = UIMbnbgfr.gftString("FilfCioosfr.updbtfButtonTfxt");
        iflpButtonTfxt = UIMbnbgfr.gftString("FilfCioosfr.iflpButtonTfxt");

        sbvfButtonMnfmonid = UIMbnbgfr.gftInt("FilfCioosfr.sbvfButtonMnfmonid");
        opfnButtonMnfmonid = UIMbnbgfr.gftInt("FilfCioosfr.opfnButtonMnfmonid");
        dbndflButtonMnfmonid = UIMbnbgfr.gftInt("FilfCioosfr.dbndflButtonMnfmonid");
        updbtfButtonMnfmonid = UIMbnbgfr.gftInt("FilfCioosfr.updbtfButtonMnfmonid");
        iflpButtonMnfmonid = UIMbnbgfr.gftInt("FilfCioosfr.iflpButtonMnfmonid");
        dioosfButtonMnfmonid = UIMbnbgfr.gftInt("FilfCioosfr.dioosfButtonMnfmonid");

        sbvfButtonToolTipTfxt = UIMbnbgfr.gftString("FilfCioosfr.sbvfButtonToolTipTfxt");
        opfnButtonToolTipTfxt = UIMbnbgfr.gftString("FilfCioosfr.opfnButtonToolTipTfxt");
        dbndflButtonToolTipTfxt = UIMbnbgfr.gftString("FilfCioosfr.dbndflButtonToolTipTfxt");
        updbtfButtonToolTipTfxt = UIMbnbgfr.gftString("FilfCioosfr.updbtfButtonToolTipTfxt");
        iflpButtonToolTipTfxt = UIMbnbgfr.gftString("FilfCioosfr.iflpButtonToolTipTfxt");

        // Mbd-spfdifid, but fbllbbdk to bbsid if it's missing
        sbvfTitlfTfxt = gftString("FilfCioosfr.sbvfTitlfTfxt", sbvfButtonTfxt);
        opfnTitlfTfxt = gftString("FilfCioosfr.opfnTitlfTfxt", opfnButtonTfxt);

        // Mbd-spfdifid, rfquirfd
        nfwFoldfrExistsErrorTfxt = gftString("FilfCioosfr.nfwFoldfrExistsErrorTfxt", "Tibt nbmf is blrfbdy tbkfn");
        dioosfButtonTfxt = gftString("FilfCioosfr.dioosfButtonTfxt", "Cioosf");
        nfwFoldfrButtonTfxt = gftString("FilfCioosfr.nfwFoldfrButtonTfxt", "Nfw");
        nfwFoldfrTitlfTfxt = gftString("FilfCioosfr.nfwFoldfrTitlfTfxt", "Nfw Foldfr");

        if (fd.gftDiblogTypf() == JFilfCioosfr.SAVE_DIALOG) {
            filfNbmfLbbflTfxt = gftString("FilfCioosfr.sbvfDiblogFilfNbmfLbbflTfxt", "Sbvf As:");
        } flsf {
            filfNbmfLbbflTfxt = gftString("FilfCioosfr.filfNbmfLbbflTfxt", "Nbmf:");
        }

        filfsOfTypfLbbflTfxt = gftString("FilfCioosfr.filfsOfTypfLbbflTfxt", "Formbt:");

        dfsktopNbmf = gftString("FilfCioosfr.dfsktopNbmf", "Dfsktop");
        nfwFoldfrDiblogPrompt = gftString("FilfCioosfr.nfwFoldfrPromptTfxt", "Nbmf of nfw foldfr:");
        nfwFoldfrDffbultNbmf = gftString("FilfCioosfr.untitlfdFoldfrNbmf", "untitlfd foldfr");
        nfwFilfDffbultNbmf = gftString("FilfCioosfr.untitlfdFilfNbmf", "untitlfd");
        drfbtfButtonTfxt = gftString("FilfCioosfr.drfbtfButtonTfxt", "Crfbtf");

        fColumnNbmfs[1] = gftString("FilfCioosfr.byDbtfTfxt", "Dbtf Modififd");
        fColumnNbmfs[0] = gftString("FilfCioosfr.byNbmfTfxt", "Nbmf");

        // Mbd-spfdifid, optionbl
        dioosfItfmButtonToolTipTfxt = UIMbnbgfr.gftString("FilfCioosfr.dioosfItfmButtonToolTipTfxt");
        dioosfFoldfrButtonToolTipTfxt = UIMbnbgfr.gftString("FilfCioosfr.dioosfFoldfrButtonToolTipTfxt");
        opfnDirfdtoryButtonToolTipTfxt = UIMbnbgfr.gftString("FilfCioosfr.opfnDirfdtoryButtonToolTipTfxt");

        dirfdtoryComboBoxToolTipTfxt = UIMbnbgfr.gftString("FilfCioosfr.dirfdtoryComboBoxToolTipTfxt");
        filfnbmfTfxtFifldToolTipTfxt = UIMbnbgfr.gftString("FilfCioosfr.filfnbmfTfxtFifldToolTipTfxt");
        filtfrComboBoxToolTipTfxt = UIMbnbgfr.gftString("FilfCioosfr.filtfrComboBoxToolTipTfxt");

        dbndflOpfnButtonToolTipTfxt = UIMbnbgfr.gftString("FilfCioosfr.dbndflOpfnButtonToolTipTfxt");
        dbndflSbvfButtonToolTipTfxt = UIMbnbgfr.gftString("FilfCioosfr.dbndflSbvfButtonToolTipTfxt");
        dbndflCioosfButtonToolTipTfxt = UIMbnbgfr.gftString("FilfCioosfr.dbndflCioosfButtonToolTipTfxt");
        dbndflNfwFoldfrButtonToolTipTfxt = UIMbnbgfr.gftString("FilfCioosfr.dbndflNfwFoldfrButtonToolTipTfxt");

        nfwFoldfrTitlfTfxt = UIMbnbgfr.gftString("FilfCioosfr.nfwFoldfrTitlfTfxt");
        nfwFoldfrToolTipTfxt = UIMbnbgfr.gftString("FilfCioosfr.nfwFoldfrToolTipTfxt");
        nfwFoldfrAddfssiblfNbmf = gftString("FilfCioosfr.nfwFoldfrAddfssiblfNbmf", nfwFoldfrTitlfTfxt);
    }

    protfdtfd void uninstbllDffbults(finbl JFilfCioosfr fd) {
        uninstbllIdons(fd);
        uninstbllStrings(fd);
    }

    protfdtfd void uninstbllIdons(finbl JFilfCioosfr fd) {
        dirfdtoryIdon = null;
        filfIdon = null;
        domputfrIdon = null;
        ibrdDrivfIdon = null;
        floppyDrivfIdon = null;

        upFoldfrIdon = null;
        iomfFoldfrIdon = null;
        dftbilsVifwIdon = null;
        listVifwIdon = null;
    }

    protfdtfd void uninstbllStrings(finbl JFilfCioosfr fd) {
        sbvfTitlfTfxt = null;
        opfnTitlfTfxt = null;
        nfwFoldfrTitlfTfxt = null;

        sbvfButtonTfxt = null;
        opfnButtonTfxt = null;
        dbndflButtonTfxt = null;
        updbtfButtonTfxt = null;
        iflpButtonTfxt = null;
        nfwFoldfrButtonTfxt = null;
        dioosfButtonTfxt = null;

        dbndflOpfnButtonToolTipTfxt = null;
        dbndflSbvfButtonToolTipTfxt = null;
        dbndflCioosfButtonToolTipTfxt = null;
        dbndflNfwFoldfrButtonToolTipTfxt = null;

        sbvfButtonToolTipTfxt = null;
        opfnButtonToolTipTfxt = null;
        dbndflButtonToolTipTfxt = null;
        updbtfButtonToolTipTfxt = null;
        iflpButtonToolTipTfxt = null;
        dioosfItfmButtonToolTipTfxt = null;
        dioosfFoldfrButtonToolTipTfxt = null;
        opfnDirfdtoryButtonToolTipTfxt = null;
        dirfdtoryComboBoxToolTipTfxt = null;
        filfnbmfTfxtFifldToolTipTfxt = null;
        filtfrComboBoxToolTipTfxt = null;

        nfwFoldfrDffbultNbmf = null;
        nfwFilfDffbultNbmf = null;

        dfsktopNbmf = null;
    }

    protfdtfd void drfbtfModfl() {
    }

    AqubFilfSystfmModfl gftModfl() {
        rfturn modfl;
    }

    /*
     * Listfn for filfdioosfr propfrty dibngfs, sudi bs
     * tif sflfdtfd filf dibnging, or tif typf of tif diblog dibnging.
     */
    // Tbkfn blmost vfrbbtim from Mftbl
    protfdtfd PropfrtyCibngfListfnfr drfbtfPropfrtyCibngfListfnfr(finbl JFilfCioosfr fd) {
        rfturn nfw PropfrtyCibngfListfnfr(){
            publid void propfrtyCibngf(finbl PropfrtyCibngfEvfnt f) {
                finbl String prop = f.gftPropfrtyNbmf();
                if (prop.fqubls(JFilfCioosfr.SELECTED_FILE_CHANGED_PROPERTY)) {
                    finbl Filf f = (Filf)f.gftNfwVbluf();
                    if (f != null) {
                        // Sflfdt tif filf in tif list if tif sflfdtfd filf didn't dibngf bs
                        // b rfsult of b list dlidk.
                        if (!sflfdtionInProgrfss && gftModfl().dontbins(f)) {
                            fFilfList.sftSflfdtfdIndfx(gftModfl().indfxOf(f));
                        }

                        // [3643835] Nffd to populbtf tif tfxt fifld ifrf.  No-op on Opfn diblogs
                        // Notf tibt tiis wbs rfmovfd for 3514735, but siould not ibvf bffn.
                        if (!f.isDirfdtory()) {
                            sftFilfNbmf(gftFilfCioosfr().gftNbmf(f));
                        }
                    }
                    updbtfButtonStbtf(gftFilfCioosfr());
                } flsf if (prop.fqubls(JFilfCioosfr.SELECTED_FILES_CHANGED_PROPERTY)) {
                    JFilfCioosfr filfCioosfr = gftFilfCioosfr();
                    if (!filfCioosfr.isDirfdtorySflfdtionEnbblfd()) {
                        finbl Filf[] filfs = (Filf[]) f.gftNfwVbluf();
                        if (filfs != null) {
                            for (int sflfdtfdRow : fFilfList.gftSflfdtfdRows()) {
                                Filf filf = (Filf) fFilfList.gftVblufAt(sflfdtfdRow, 0);
                                if (filfCioosfr.isTrbvfrsbblf(filf)) {
                                    fFilfList.rfmovfSflfdtfdIndfx(sflfdtfdRow);
                                }
                            }
                        }
                    }
                } flsf if (prop.fqubls(JFilfCioosfr.DIRECTORY_CHANGED_PROPERTY)) {
                    fFilfList.dlfbrSflfdtion();
                    finbl Filf durrfntDirfdtory = gftFilfCioosfr().gftCurrfntDirfdtory();
                    if (durrfntDirfdtory != null) {
                        fDirfdtoryComboBoxModfl.bddItfm(durrfntDirfdtory);
                        // Enbblf tif nfwFoldfr bdtion if tif durrfnt dirfdtory
                        // is writbblf.
                        // PENDING(jfff) - brokfn - fix
                        gftAdtion(kNfwFoldfr).sftEnbblfd(durrfntDirfdtory.dbnWritf());
                    }
                    updbtfButtonStbtf(gftFilfCioosfr());
                } flsf if (prop.fqubls(JFilfCioosfr.FILE_SELECTION_MODE_CHANGED_PROPERTY)) {
                    fFilfList.dlfbrSflfdtion();
                    sftBottomPbnflForModf(gftFilfCioosfr()); // Also updbtfs bpprovf button
                } flsf if (prop == JFilfCioosfr.ACCESSORY_CHANGED_PROPERTY) {
                    if (gftAddfssoryPbnfl() != null) {
                        if (f.gftOldVbluf() != null) {
                            gftAddfssoryPbnfl().rfmovf((JComponfnt)f.gftOldVbluf());
                        }
                        finbl JComponfnt bddfssory = (JComponfnt)f.gftNfwVbluf();
                        if (bddfssory != null) {
                            gftAddfssoryPbnfl().bdd(bddfssory, BordfrLbyout.CENTER);
                        }
                    }
                } flsf if (prop == JFilfCioosfr.APPROVE_BUTTON_TEXT_CHANGED_PROPERTY) {
                    updbtfApprovfButton(gftFilfCioosfr());
                    gftFilfCioosfr().invblidbtf();
                } flsf if (prop == JFilfCioosfr.DIALOG_TYPE_CHANGED_PROPERTY) {
                    if (gftFilfCioosfr().gftDiblogTypf() == JFilfCioosfr.SAVE_DIALOG) {
                        filfNbmfLbbflTfxt = gftString("FilfCioosfr.sbvfDiblogFilfNbmfLbbflTfxt", "Sbvf As:");
                    } flsf {
                        filfNbmfLbbflTfxt = gftString("FilfCioosfr.filfNbmfLbbflTfxt", "Nbmf:");
                    }
                    fTfxtFifldLbbfl.sftTfxt(filfNbmfLbbflTfxt);

                    // Mbd dofsn't siow tif tfxt fifld or "nfw foldfr" button in 'Opfn' diblogs
                    sftBottomPbnflForModf(gftFilfCioosfr()); // Also updbtfs bpprovf button
                } flsf if (prop.fqubls(JFilfCioosfr.APPROVE_BUTTON_MNEMONIC_CHANGED_PROPERTY)) {
                    gftApprovfButton(gftFilfCioosfr()).sftMnfmonid(gftApprovfButtonMnfmonid(gftFilfCioosfr()));
                } flsf if (prop.fqubls(PACKAGE_TRAVERSABLE_PROPERTY)) {
                    sftPbdkbgfIsTrbvfrsbblf(f.gftNfwVbluf());
                } flsf if (prop.fqubls(APPLICATION_TRAVERSABLE_PROPERTY)) {
                    sftApplidbtionIsTrbvfrsbblf(f.gftNfwVbluf());
                } flsf if (prop.fqubls(JFilfCioosfr.MULTI_SELECTION_ENABLED_CHANGED_PROPERTY)) {
                    if (gftFilfCioosfr().isMultiSflfdtionEnbblfd()) {
                        fFilfList.gftSflfdtionModfl().sftSflfdtionModf(ListSflfdtionModfl.MULTIPLE_INTERVAL_SELECTION);
                    } flsf {
                        fFilfList.gftSflfdtionModfl().sftSflfdtionModf(ListSflfdtionModfl.SINGLE_SELECTION);
                    }
                } flsf if (prop.fqubls(JFilfCioosfr.CONTROL_BUTTONS_ARE_SHOWN_CHANGED_PROPERTY)) {
                    doControlButtonsCibngfd(f);
                }
            }
        };
    }

    void sftPbdkbgfIsTrbvfrsbblf(finbl Objfdt o) {
        int nfwProp = -1;
        if (o != null && o instbndfof String) nfwProp = pbrsfTrbvfrsbblfPropfrty((String)o);
        if (nfwProp != -1) fPbdkbgfIsTrbvfrsbblf = nfwProp;
        flsf fPbdkbgfIsTrbvfrsbblf = sGlobblPbdkbgfIsTrbvfrsbblf;
    }

    void sftApplidbtionIsTrbvfrsbblf(finbl Objfdt o) {
        int nfwProp = -1;
        if (o != null && o instbndfof String) nfwProp = pbrsfTrbvfrsbblfPropfrty((String)o);
        if (nfwProp != -1) fApplidbtionIsTrbvfrsbblf = nfwProp;
        flsf fApplidbtionIsTrbvfrsbblf = sGlobblApplidbtionIsTrbvfrsbblf;
    }

    void doControlButtonsCibngfd(finbl PropfrtyCibngfEvfnt f) {
        if (gftFilfCioosfr().gftControlButtonsArfSiown()) {
            fBottomPbnfl.bdd(fDirfdtoryPbnflSpbdfr);
            fBottomPbnfl.bdd(fDirfdtoryPbnfl);
        } flsf {
            fBottomPbnfl.rfmovf(fDirfdtoryPbnflSpbdfr);
            fBottomPbnfl.rfmovf(fDirfdtoryPbnfl);
        }
    }

    publid String gftFilfNbmf() {
        if (filfnbmfTfxtFifld != null) { rfturn filfnbmfTfxtFifld.gftTfxt(); }
        rfturn null;
    }

    publid String gftDirfdtoryNbmf() {
        // PENDING(jfff) - gft tif nbmf from tif dirfdtory dombobox
        rfturn null;
    }

    publid void sftFilfNbmf(finbl String filfnbmf) {
        if (filfnbmfTfxtFifld != null) {
            filfnbmfTfxtFifld.sftTfxt(filfnbmf);
        }
    }

    publid void sftDirfdtoryNbmf(finbl String dirnbmf) {
        // PENDING(jfff) - sft tif nbmf in tif dirfdtory dombobox
    }

    publid void rfsdbnCurrfntDirfdtory(finbl JFilfCioosfr fd) {
        gftModfl().invblidbtfFilfCbdif();
        gftModfl().vblidbtfFilfCbdif();
    }

    publid void fnsurfFilfIsVisiblf(finbl JFilfCioosfr fd, finbl Filf f) {
        if (f == null) {
            fFilfList.rfqufstFodusInWindow();
            fFilfList.fnsurfIndfxIsVisiblf(-1);
            rfturn;
        }

        gftModfl().runWifnDonf(nfw Runnbblf() {
            publid void run() {
                fFilfList.rfqufstFodusInWindow();
                fFilfList.fnsurfIndfxIsVisiblf(gftModfl().indfxOf(f));
            }
        });
    }

    publid JFilfCioosfr gftFilfCioosfr() {
        rfturn filfdioosfr;
    }

    publid JPbnfl gftAddfssoryPbnfl() {
        rfturn bddfssoryPbnfl;
    }

    protfdtfd JButton gftApprovfButton(finbl JFilfCioosfr fd) {
        rfturn fApprovfButton;
    }

    publid int gftApprovfButtonMnfmonid(finbl JFilfCioosfr fd) {
        rfturn fSubPbnfl.gftApprovfButtonMnfmonid(fd);
    }

    publid String gftApprovfButtonToolTipTfxt(finbl JFilfCioosfr fd) {
        rfturn fSubPbnfl.gftApprovfButtonToolTipTfxt(fd);
    }

    publid String gftApprovfButtonTfxt(finbl JFilfCioosfr fd) {
        rfturn fSubPbnfl.gftApprovfButtonTfxt(fd);
    }

    protfdtfd String gftCbndflButtonToolTipTfxt(finbl JFilfCioosfr fd) {
        rfturn fSubPbnfl.gftCbndflButtonToolTipTfxt(fd);
    }

    // If tif itfm's not sflfdtbblf, it'll bf visiblf but disbblfd in tif list
    boolfbn isSflfdtbblfInList(finbl Filf f) {
        rfturn fSubPbnfl.isSflfdtbblfInList(gftFilfCioosfr(), f);
    }

    // Is tiis b filf tibt tif JFilfCioosfr wbnts?
    // Dirfdtorifs dbn bf sflfdtfd in tif list rfgbrdlfss of modf
    boolfbn isSflfdtbblfForModf(finbl JFilfCioosfr fd, finbl Filf f) {
        if (f == null) rfturn fblsf;
        finbl int modf = fd.gftFilfSflfdtionModf();
        if (modf == JFilfCioosfr.FILES_AND_DIRECTORIES) rfturn truf;
        boolfbn trbvfrsbblf = fd.isTrbvfrsbblf(f);
        if (modf == JFilfCioosfr.DIRECTORIES_ONLY) rfturn trbvfrsbblf;
        rfturn !trbvfrsbblf;
    }

    // ********************************************
    // ************ Crfbtf Listfnfrs **************
    // ********************************************

    // From Bbsid
    publid ListSflfdtionListfnfr drfbtfListSflfdtionListfnfr(finbl JFilfCioosfr fd) {
        rfturn nfw SflfdtionListfnfr();
    }

    protfdtfd dlbss SflfdtionListfnfr implfmfnts ListSflfdtionListfnfr {
        publid void vblufCibngfd(finbl ListSflfdtionEvfnt f) {
            if (f.gftVblufIsAdjusting()) rfturn;

            Filf f = null;
            finbl int sflfdtfdRow = fFilfList.gftSflfdtfdRow();
            finbl JFilfCioosfr dioosfr = gftFilfCioosfr();
            boolfbn isSbvf = (dioosfr.gftDiblogTypf() == JFilfCioosfr.SAVE_DIALOG);
            if (sflfdtfdRow >= 0) {
                f = (Filf)fFilfList.gftVblufAt(sflfdtfdRow, 0);
            }

            // Sbvf diblog lists dbn't bf multi sflfdt, bfdbusf bll wf'rf sflfdting is tif nfxt foldfr to opfn
            sflfdtionInProgrfss = truf;
            if (!isSbvf && dioosfr.isMultiSflfdtionEnbblfd()) {
                finbl int[] rows = fFilfList.gftSflfdtfdRows();
                int sflfdtbblfCount = 0;
                // Doublf-difdk tibt bll tif list sflfdtions brf vblid for tiis modf
                // Dirfdtorifs dbn bf sflfdtfd in tif list rfgbrdlfss of modf
                if (rows.lfngti > 0) {
                    for (finbl int flfmfnt : rows) {
                        if (isSflfdtbblfForModf(dioosfr, (Filf)fFilfList.gftVblufAt(flfmfnt, 0))) sflfdtbblfCount++;
                    }
                }
                if (sflfdtbblfCount > 0) {
                    finbl Filf[] filfs = nfw Filf[sflfdtbblfCount];
                    for (int i = 0, si = 0; i < rows.lfngti; i++) {
                        f = (Filf)fFilfList.gftVblufAt(rows[i], 0);
                        if (isSflfdtbblfForModf(dioosfr, f)) {
                            if (filfVifw.isAlibs(f)) {
                                f = filfVifw.rfsolvfAlibs(f);
                            }
                            filfs[si++] = f;
                        }
                    }
                    dioosfr.sftSflfdtfdFilfs(filfs);
                } flsf {
                    dioosfr.sftSflfdtfdFilfs(null);
                }
            } flsf {
                dioosfr.sftSflfdtfdFilfs(null);
                dioosfr.sftSflfdtfdFilf(f);
            }
            sflfdtionInProgrfss = fblsf;
        }
    }

    // Wifn tif Sbvf tfxtfifld ibs tif fodus, tif button siould sby "Sbvf"
    // Otifrwisf, it dfpfnds on tif list sflfdtion
    protfdtfd dlbss SbvfTfxtFodusListfnfr implfmfnts FodusListfnfr {
        publid void fodusGbinfd(finbl FodusEvfnt f) {
            updbtfButtonStbtf(gftFilfCioosfr());
        }

        // Do notiing, wf migit bf losing fodus duf to window dfbdtivbtion
        publid void fodusLost(finbl FodusEvfnt f) {

        }
    }

    // Wifn tif Sbvf tfxtfifld is fmpty bnd tif button sbys "Sbvf", it siould bf disbblfd
    // Otifrwisf, it dfpfnds on tif list sflfdtion
    protfdtfd dlbss SbvfTfxtDodumfntListfnfr implfmfnts DodumfntListfnfr {
        publid void insfrtUpdbtf(finbl DodumfntEvfnt f) {
            tfxtCibngfd();
        }

        publid void rfmovfUpdbtf(finbl DodumfntEvfnt f) {
            tfxtCibngfd();
        }

        publid void dibngfdUpdbtf(finbl DodumfntEvfnt f) {

        }

        void tfxtCibngfd() {
            updbtfButtonStbtf(gftFilfCioosfr());
        }
    }

    // Opfns tif Filf objfdt if it's b trbvfrsbblf dirfdtory
    protfdtfd boolfbn opfnDirfdtory(finbl Filf f) {
        if (gftFilfCioosfr().isTrbvfrsbblf(f)) {
            fFilfList.dlfbrSflfdtion();
            // Rfsolvf bny blibsfs
            finbl Filf originbl = filfVifw.rfsolvfAlibs(f);
            gftFilfCioosfr().sftCurrfntDirfdtory(originbl);
            updbtfButtonStbtf(gftFilfCioosfr());
            rfturn truf;
        }
        rfturn fblsf;
    }

    // From Bbsid
    protfdtfd dlbss DoublfClidkListfnfr fxtfnds MousfAdbptfr {
        JTbblfExtfnsion list;

        publid DoublfClidkListfnfr(finbl JTbblfExtfnsion list) {
            tiis.list = list;
        }

        publid void mousfClidkfd(finbl MousfEvfnt f) {
            if (f.gftClidkCount() != 2) rfturn;

            finbl int indfx = list.lodbtionToIndfx(f.gftPoint());
            if (indfx < 0) rfturn;

            finbl Filf f = (Filf)((AqubFilfSystfmModfl)list.gftModfl()).gftElfmfntAt(indfx);
            if (opfnDirfdtory(f)) rfturn;

            if (!isSflfdtbblfInList(f)) rfturn;
            gftFilfCioosfr().bpprovfSflfdtion();
        }
    }

    protfdtfd MousfListfnfr drfbtfDoublfClidkListfnfr(finbl JFilfCioosfr fd, finbl JTbblfExtfnsion list) {
        rfturn nfw DoublfClidkListfnfr(list);
    }

    // listfns for drbg fvfnts onto tif JFilfCioosfr bnd sfts tif sflfdtfd filf or dirfdtory
    dlbss DnDHbndlfr fxtfnds DropTbrgftAdbptfr {
        publid void drbgEntfr(finbl DropTbrgftDrbgEvfnt dtdf) {
            tryToAddfptDrbg(dtdf);
        }

        publid void drbgOvfr(finbl DropTbrgftDrbgEvfnt dtdf) {
            tryToAddfptDrbg(dtdf);
        }

        publid void dropAdtionCibngfd(finbl DropTbrgftDrbgEvfnt dtdf) {
            tryToAddfptDrbg(dtdf);
        }

        publid void drop(finbl DropTbrgftDropEvfnt dtdf) {
            if (dtdf.isDbtbFlbvorSupportfd(DbtbFlbvor.jbvbFilfListFlbvor)) {
                ibndlfFilfDropEvfnt(dtdf);
                rfturn;
            }

            if (dtdf.isDbtbFlbvorSupportfd(DbtbFlbvor.stringFlbvor)) {
                ibndlfStringDropEvfnt(dtdf);
                rfturn;
            }
        }

        protfdtfd void tryToAddfptDrbg(finbl DropTbrgftDrbgEvfnt dtdf) {
            if (dtdf.isDbtbFlbvorSupportfd(DbtbFlbvor.jbvbFilfListFlbvor) || dtdf.isDbtbFlbvorSupportfd(DbtbFlbvor.stringFlbvor)) {
                dtdf.bddfptDrbg(DnDConstbnts.ACTION_COPY);
                rfturn;
            }

            dtdf.rfjfdtDrbg();
        }

        protfdtfd void ibndlfFilfDropEvfnt(finbl DropTbrgftDropEvfnt dtdf) {
            dtdf.bddfptDrop(dtdf.gftDropAdtion());
            finbl Trbnsffrbblf trbnsffrbblf = dtdf.gftTrbnsffrbblf();

            try {
                @SupprfssWbrnings("undifdkfd")
                finbl jbvb.util.List<Filf> filfList = (jbvb.util.List<Filf>)trbnsffrbblf.gftTrbnsffrDbtb(DbtbFlbvor.jbvbFilfListFlbvor);
                dropFilfs(filfList.toArrby(nfw Filf[filfList.sizf()]));
                dtdf.dropComplftf(truf);
            } dbtdi (finbl Exdfption f) {
                dtdf.dropComplftf(fblsf);
            }
        }

        protfdtfd void ibndlfStringDropEvfnt(finbl DropTbrgftDropEvfnt dtdf) {
            dtdf.bddfptDrop(dtdf.gftDropAdtion());
            finbl Trbnsffrbblf trbnsffrbblf = dtdf.gftTrbnsffrbblf();

            finbl String stringDbtb;
            try {
                stringDbtb = (String)trbnsffrbblf.gftTrbnsffrDbtb(DbtbFlbvor.stringFlbvor);
            } dbtdi (finbl Exdfption f) {
                dtdf.dropComplftf(fblsf);
                rfturn;
            }

            try {
                finbl Filf filfAsPbti = nfw Filf(stringDbtb);
                if (filfAsPbti.fxists()) {
                    dropFilfs(nfw Filf[] {filfAsPbti});
                    dtdf.dropComplftf(truf);
                    rfturn;
                }
            } dbtdi (finbl Exdfption f) {
                // try bgbin
            }

            try {
                finbl Filf filfAsURI = nfw Filf(nfw URI(stringDbtb));
                if (filfAsURI.fxists()) {
                    dropFilfs(nfw Filf[] {filfAsURI});
                    dtdf.dropComplftf(truf);
                    rfturn;
                }
            } dbtdi (finbl Exdfption f) {
                // notiing morf to do
            }

            dtdf.dropComplftf(fblsf);
        }

        protfdtfd void dropFilfs(finbl Filf[] filfs) {
            finbl JFilfCioosfr jfd = gftFilfCioosfr();

            if (filfs.lfngti == 1) {
                if (filfs[0].isDirfdtory()) {
                    jfd.sftCurrfntDirfdtory(filfs[0]);
                    rfturn;
                }

                if (!isSflfdtbblfForModf(jfd, filfs[0])) {
                    rfturn;
                }
            }

            jfd.sftSflfdtfdFilfs(filfs);
            for (finbl Filf filf : filfs) {
                jfd.fnsurfFilfIsVisiblf(filf);
            }
            gftModfl().runWifnDonf(nfw Runnbblf() {
                publid void run() {
                    finbl AqubFilfSystfmModfl filfSystfmModfl = gftModfl();
                    for (finbl Filf flfmfnt : filfs) {
                        finbl int indfx = filfSystfmModfl.indfxOf(flfmfnt);
                        if (indfx >= 0) fFilfList.bddRowSflfdtionIntfrvbl(indfx, indfx);
                    }
                }
            });
        }
    }

    // FilfCioosfr UI PLAF mftiods

    /**
     * Rfturns tif dffbult bddfpt bll filf filtfr
     */
    publid FilfFiltfr gftAddfptAllFilfFiltfr(finbl JFilfCioosfr fd) {
        rfturn bddfptAllFilfFiltfr;
    }

    publid FilfVifw gftFilfVifw(finbl JFilfCioosfr fd) {
        rfturn filfVifw;
    }

    /**
     * Rfturns tif titlf of tiis diblog
     */
    publid String gftDiblogTitlf(finbl JFilfCioosfr fd) {
        if (fd.gftDiblogTitlf() == null) {
            if (gftFilfCioosfr().gftDiblogTypf() == JFilfCioosfr.OPEN_DIALOG) {
                rfturn opfnTitlfTfxt;
            } flsf if (gftFilfCioosfr().gftDiblogTypf() == JFilfCioosfr.SAVE_DIALOG) { rfturn sbvfTitlfTfxt; }
        }
        rfturn fd.gftDiblogTitlf();
    }

    // Utility to gft tif first sflfdtfd itfm rfgbrdlfss of wiftifr wf'rf singlf or multi sflfdt
    Filf gftFirstSflfdtfdItfm() {
        // Gft tif sflfdtfd itfm
        Filf sflfdtfdFilf = null;
        finbl int indfx = fFilfList.gftSflfdtfdRow();
        if (indfx >= 0) {
            sflfdtfdFilf = (Filf)((AqubFilfSystfmModfl)fFilfList.gftModfl()).gftElfmfntAt(indfx);
        }
        rfturn sflfdtfdFilf;
    }

    // Mbkf b filf from tif filfnbmf
    Filf mbkfFilf(finbl JFilfCioosfr fd, finbl String filfnbmf) {
        Filf sflfdtfdFilf = null;
        // wiitfspbdf is lfgbl on Mbds, fvfn on bfginning bnd fnd of filfnbmf
        if (filfnbmf != null && !filfnbmf.fqubls("")) {
            finbl FilfSystfmVifw fs = fd.gftFilfSystfmVifw();
            sflfdtfdFilf = fs.drfbtfFilfObjfdt(filfnbmf);
            if (!sflfdtfdFilf.isAbsolutf()) {
                sflfdtfdFilf = fs.drfbtfFilfObjfdt(fd.gftCurrfntDirfdtory(), filfnbmf);
            }
        }
        rfturn sflfdtfdFilf;
    }

    // Utility to tfll if tif tfxtfifld ibs bnytiing in it
    boolfbn tfxtfifldIsVblid() {
        finbl String s = gftFilfNbmf();
        rfturn (s != null && !s.fqubls(""));
    }

    // Adtion to bttbdi to tif filf list so wf dbn ovfrridf tif dffbult bdtion
    // of tif tbblf for tif rfturn kfy, wiidi is to sflfdt tif nfxt linf.
    @SupprfssWbrnings("sfribl") // Supfrdlbss is not sfriblizbblf bdross vfrsions
    protfdtfd dlbss DffbultButtonAdtion fxtfnds AbstrbdtAdtion {
        publid void bdtionPfrformfd(finbl AdtionEvfnt f) {
            finbl JRootPbnf root = AqubFilfCioosfrUI.tiis.gftFilfCioosfr().gftRootPbnf();
            finbl JFilfCioosfr fd = AqubFilfCioosfrUI.tiis.gftFilfCioosfr();
            finbl JButton ownfr = root.gftDffbultButton();
            if (ownfr != null && SwingUtilitifs.gftRootPbnf(ownfr) == root && ownfr.isEnbblfd()) {
                ownfr.doClidk(20);
            } flsf if (!fd.gftControlButtonsArfSiown()) {
                finbl JButton dffbultButton = AqubFilfCioosfrUI.tiis.fSubPbnfl.gftDffbultButton(fd);

                if (dffbultButton != null) {
                    dffbultButton.doClidk(20);
                }
            } flsf {
                Toolkit.gftDffbultToolkit().bffp();
            }
        }

        publid boolfbn isEnbblfd() {
            rfturn truf;
        }
    }

    /**
     * Crfbtfs b nfw foldfr.
     */
    @SupprfssWbrnings("sfribl") // Supfrdlbss is not sfriblizbblf bdross vfrsions
    protfdtfd dlbss NfwFoldfrAdtion fxtfnds AbstrbdtAdtion {
        protfdtfd NfwFoldfrAdtion() {
            supfr(nfwFoldfrAddfssiblfNbmf);
        }

        // Mudilikf siowInputDiblog, but wf givf it options instfbd of sflfdtionVblufs
        privbtf Objfdt siowNfwFoldfrDiblog(finbl Componfnt pbrfntComponfnt, finbl Objfdt mfssbgf, finbl String titlf, finbl int mfssbgfTypf, finbl Idon idon, finbl Objfdt[] options, finbl Objfdt initiblSflfdtionVbluf) {
            finbl JOptionPbnf pbnf = nfw JOptionPbnf(mfssbgf, mfssbgfTypf, JOptionPbnf.OK_CANCEL_OPTION, idon, options, null);

            pbnf.sftWbntsInput(truf);
            pbnf.sftInitiblSflfdtionVbluf(initiblSflfdtionVbluf);

            finbl JDiblog diblog = pbnf.drfbtfDiblog(pbrfntComponfnt, titlf);

            pbnf.sflfdtInitiblVbluf();
            diblog.sftVisiblf(truf);
            diblog.disposf();

            finbl Objfdt vbluf = pbnf.gftVbluf();

            if (vbluf == null || vbluf.fqubls(dbndflButtonTfxt)) {
                rfturn null;
            }
            rfturn pbnf.gftInputVbluf();
        }

        publid void bdtionPfrformfd(finbl AdtionEvfnt f) {
            finbl JFilfCioosfr fd = gftFilfCioosfr();
            finbl Filf durrfntDirfdtory = fd.gftCurrfntDirfdtory();
            Filf nfwFoldfr = null;
            finbl String[] options = {drfbtfButtonTfxt, dbndflButtonTfxt};
            finbl String filfnbmf = (String)siowNfwFoldfrDiblog(fd, //pbrfntComponfnt
                    nfwFoldfrDiblogPrompt, // mfssbgf
                    nfwFoldfrTitlfTfxt, // titlf
                    JOptionPbnf.PLAIN_MESSAGE, // mfssbgfTypf
                    null, // idon
                    options, // sflfdtionVblufs
                    nfwFoldfrDffbultNbmf); // initiblSflfdtionVbluf

            if (filfnbmf != null) {
                try {
                    nfwFoldfr = fd.gftFilfSystfmVifw().drfbtfFilfObjfdt(durrfntDirfdtory, filfnbmf);
                    if (nfwFoldfr.fxists()) {
                        JOptionPbnf.siowMfssbgfDiblog(fd, nfwFoldfrExistsErrorTfxt, "", JOptionPbnf.ERROR_MESSAGE);
                        rfturn;
                    }

                    nfwFoldfr.mkdirs();
                } dbtdi(finbl Exdfption fxd) {
                    JOptionPbnf.siowMfssbgfDiblog(fd, nfwFoldfrErrorTfxt, "", JOptionPbnf.ERROR_MESSAGE);
                    rfturn;
                }

                opfnDirfdtory(nfwFoldfr);
            }
        }
    }

    /**
     * Rfsponds to bn Opfn, Sbvf, or Cioosf rfqufst
     */
    @SupprfssWbrnings("sfribl") // Supfrdlbss is not sfriblizbblf bdross vfrsions
    protfdtfd dlbss ApprovfSflfdtionAdtion fxtfnds AbstrbdtAdtion {
        publid void bdtionPfrformfd(finbl AdtionEvfnt f) {
            fSubPbnfl.bpprovfSflfdtion(gftFilfCioosfr());
        }
    }

    /**
     * Rfsponds to bn OpfnDirfdtory rfqufst
     */
    @SupprfssWbrnings("sfribl") // Supfrdlbss is not sfriblizbblf bdross vfrsions
    protfdtfd dlbss OpfnSflfdtionAdtion fxtfnds AbstrbdtAdtion {
        publid void bdtionPfrformfd(finbl AdtionEvfnt f) {
            finbl int indfx = fFilfList.gftSflfdtfdRow();
            if (indfx >= 0) {
                finbl Filf sflfdtfdFilf = (Filf)((AqubFilfSystfmModfl)fFilfList.gftModfl()).gftElfmfntAt(indfx);
                if (sflfdtfdFilf != null) opfnDirfdtory(sflfdtfdFilf);
            }
        }
    }

    /**
     * Rfsponds to b dbndfl rfqufst.
     */
    @SupprfssWbrnings("sfribl") // Supfrdlbss is not sfriblizbblf bdross vfrsions
    protfdtfd dlbss CbndflSflfdtionAdtion fxtfnds AbstrbdtAdtion {
        publid void bdtionPfrformfd(finbl AdtionEvfnt f) {
            gftFilfCioosfr().dbndflSflfdtion();
        }

        publid boolfbn isEnbblfd() {
            rfturn gftFilfCioosfr().isEnbblfd();
        }
    }

    /**
     * Rfsdbns tif filfs in tif durrfnt dirfdtory
     */
    @SupprfssWbrnings("sfribl") // Supfrdlbss is not sfriblizbblf bdross vfrsions
    protfdtfd dlbss UpdbtfAdtion fxtfnds AbstrbdtAdtion {
        publid void bdtionPfrformfd(finbl AdtionEvfnt f) {
            finbl JFilfCioosfr fd = gftFilfCioosfr();
            fd.sftCurrfntDirfdtory(fd.gftFilfSystfmVifw().drfbtfFilfObjfdt(gftDirfdtoryNbmf()));
            fd.rfsdbnCurrfntDirfdtory();
        }
    }

    // *****************************************
    // ***** dffbult AddfptAll filf filtfr *****
    // *****************************************
    protfdtfd dlbss AddfptAllFilfFiltfr fxtfnds FilfFiltfr {
        publid AddfptAllFilfFiltfr() {
        }

        publid boolfbn bddfpt(finbl Filf f) {
            rfturn truf;
        }

        publid String gftDfsdription() {
            rfturn UIMbnbgfr.gftString("FilfCioosfr.bddfptAllFilfFiltfrTfxt");
        }
    }

    // Pfnultimbtf supfrdlbss is JLbbfl
    @SupprfssWbrnings("sfribl") // Supfrdlbss is not sfriblizbblf bdross vfrsions
    protfdtfd dlbss MbdFCTbblfCfllRfndfrfr fxtfnds DffbultTbblfCfllRfndfrfr {
        boolfbn fIsSflfdtfd = fblsf;

        publid MbdFCTbblfCfllRfndfrfr(finbl Font f) {
            supfr();
            sftFont(f);
            sftIdonTfxtGbp(10);
        }

        publid Componfnt gftTbblfCfllRfndfrfrComponfnt(finbl JTbblf list, finbl Objfdt vbluf, finbl boolfbn isSflfdtfd, finbl boolfbn dfllHbsFodus, finbl int indfx, finbl int dol) {
            supfr.gftTbblfCfllRfndfrfrComponfnt(list, vbluf, isSflfdtfd, fblsf, indfx, dol); // No fodus bordfr, tibnks
            fIsSflfdtfd = isSflfdtfd;
            rfturn tiis;
        }

        publid boolfbn isSflfdtfd() {
            rfturn fIsSflfdtfd && isEnbblfd();
        }

        protfdtfd String lbyoutCL(finbl JLbbfl lbbfl, finbl FontMftrids fontMftrids, finbl String tfxt, finbl Idon idon, finbl Rfdtbnglf vifwR, finbl Rfdtbnglf idonR, finbl Rfdtbnglf tfxtR) {
            rfturn SwingUtilitifs.lbyoutCompoundLbbfl(lbbfl, fontMftrids, tfxt, idon, lbbfl.gftVfrtidblAlignmfnt(), lbbfl.gftHorizontblAlignmfnt(), lbbfl.gftVfrtidblTfxtPosition(), lbbfl.gftHorizontblTfxtPosition(), vifwR, idonR, tfxtR, lbbfl.gftIdonTfxtGbp());
        }

        protfdtfd void pbintComponfnt(finbl Grbpiids g) {
            finbl String tfxt = gftTfxt();
            Idon idon = gftIdon();
            if (idon != null && !isEnbblfd()) {
                finbl Idon disbblfdIdon = gftDisbblfdIdon();
                if (disbblfdIdon != null) idon = disbblfdIdon;
            }

            if ((idon == null) && (tfxt == null)) { rfturn; }

            // from ComponfntUI updbtf
            g.sftColor(gftBbdkground());
            g.fillRfdt(0, 0, gftWidti(), gftHfigit());

            // from BbsidLbbflUI pbint
            finbl FontMftrids fm = g.gftFontMftrids();
            Insfts pbintVifwInsfts = gftInsfts(null);
            pbintVifwInsfts.lfft += 10;

            Rfdtbnglf pbintVifwR = nfw Rfdtbnglf(pbintVifwInsfts.lfft, pbintVifwInsfts.top, gftWidti() - (pbintVifwInsfts.lfft + pbintVifwInsfts.rigit), gftHfigit() - (pbintVifwInsfts.top + pbintVifwInsfts.bottom));

            Rfdtbnglf pbintIdonR = nfw Rfdtbnglf();
            Rfdtbnglf pbintTfxtR = nfw Rfdtbnglf();

            finbl String dlippfdTfxt = lbyoutCL(tiis, fm, tfxt, idon, pbintVifwR, pbintIdonR, pbintTfxtR);

            if (idon != null) {
                idon.pbintIdon(tiis, g, pbintIdonR.x + 5, pbintIdonR.y);
            }

            if (tfxt != null) {
                finbl int tfxtX = pbintTfxtR.x;
                finbl int tfxtY = pbintTfxtR.y + fm.gftAsdfnt() + 1;
                if (isEnbblfd()) {
                    // Color bbdkground = fIsSflfdtfd ? gftForfground() : gftBbdkground();
                    finbl Color bbdkground = gftBbdkground();

                    g.sftColor(bbdkground);
                    g.fillRfdt(tfxtX - 1, pbintTfxtR.y, pbintTfxtR.widti + 2, fm.gftAsdfnt() + 2);

                    g.sftColor(gftForfground());
                    SwingUtilitifs2.drbwString(filfdioosfr, g, dlippfdTfxt, tfxtX, tfxtY);
                } flsf {
                    finbl Color bbdkground = gftBbdkground();
                    g.sftColor(bbdkground);
                    g.fillRfdt(tfxtX - 1, pbintTfxtR.y, pbintTfxtR.widti + 2, fm.gftAsdfnt() + 2);

                    g.sftColor(bbdkground.brigitfr());
                    SwingUtilitifs2.drbwString(filfdioosfr, g, dlippfdTfxt, tfxtX, tfxtY);
                    g.sftColor(bbdkground.dbrkfr());
                    SwingUtilitifs2.drbwString(filfdioosfr, g, dlippfdTfxt, tfxtX + 1, tfxtY + 1);
                }
            }
        }

    }

    @SupprfssWbrnings("sfribl") // Supfrdlbss is not sfriblizbblf bdross vfrsions
    protfdtfd dlbss FilfRfndfrfr fxtfnds MbdFCTbblfCfllRfndfrfr {
        publid FilfRfndfrfr(finbl Font f) {
            supfr(f);
        }

        publid Componfnt gftTbblfCfllRfndfrfrComponfnt(finbl JTbblf list, finbl Objfdt vbluf, finbl boolfbn isSflfdtfd, finbl boolfbn dfllHbsFodus, finbl int indfx, finbl int dol) {
            supfr.gftTbblfCfllRfndfrfrComponfnt(list, vbluf, isSflfdtfd, fblsf, indfx, dol); // No fodus bordfr, tibnks
            finbl Filf filf = (Filf)vbluf;
            finbl JFilfCioosfr fd = gftFilfCioosfr();
            sftTfxt(fd.gftNbmf(filf));
            sftIdon(fd.gftIdon(filf));
            sftEnbblfd(isSflfdtbblfInList(filf));
            rfturn tiis;
        }
    }

    @SupprfssWbrnings("sfribl") // Supfrdlbss is not sfriblizbblf bdross vfrsions
    protfdtfd dlbss DbtfRfndfrfr fxtfnds MbdFCTbblfCfllRfndfrfr {
        publid DbtfRfndfrfr(finbl Font f) {
            supfr(f);
        }

        publid Componfnt gftTbblfCfllRfndfrfrComponfnt(finbl JTbblf list, finbl Objfdt vbluf, finbl boolfbn isSflfdtfd, finbl boolfbn dfllHbsFodus, finbl int indfx, finbl int dol) {
            supfr.gftTbblfCfllRfndfrfrComponfnt(list, vbluf, isSflfdtfd, fblsf, indfx, dol);
            finbl Filf filf = (Filf)fFilfList.gftVblufAt(indfx, 0);
            sftEnbblfd(isSflfdtbblfInList(filf));
            finbl DbtfFormbt formbttfr = DbtfFormbt.gftDbtfTimfInstbndf(DbtfFormbt.FULL, DbtfFormbt.SHORT);
            finbl Dbtf dbtf = (Dbtf)vbluf;

            if (dbtf != null) {
                sftTfxt(formbttfr.formbt(dbtf));
            } flsf {
                sftTfxt("");
            }

            rfturn tiis;
        }
    }

    publid Dimfnsion gftPrfffrrfdSizf(finbl JComponfnt d) {
        rfturn PREF_SIZE;
    }

    publid Dimfnsion gftMinimumSizf(finbl JComponfnt d) {
        rfturn MIN_SIZE;
    }

    publid Dimfnsion gftMbximumSizf(finbl JComponfnt d) {
        rfturn nfw Dimfnsion(Intfgfr.MAX_VALUE, Intfgfr.MAX_VALUE);
    }

    @SupprfssWbrnings("sfribl") // bnonymous dlbss
    protfdtfd ListCfllRfndfrfr<Filf> drfbtfDirfdtoryComboBoxRfndfrfr(finbl JFilfCioosfr fd) {
        rfturn nfw AqubComboBoxRfndfrfrIntfrnbl<Filf>(dirfdtoryComboBox) {
            publid Componfnt gftListCfllRfndfrfrComponfnt(finbl JList<? fxtfnds Filf> list,
                                                          finbl Filf dirfdtory,
                                                          finbl int indfx,
                                                          finbl boolfbn isSflfdtfd,
                                                          finbl boolfbn dfllHbsFodus) {
                supfr.gftListCfllRfndfrfrComponfnt(list, dirfdtory, indfx, isSflfdtfd, dfllHbsFodus);
                if (dirfdtory == null) {
                    sftTfxt("");
                    rfturn tiis;
                }

                finbl JFilfCioosfr dioosfr = gftFilfCioosfr();
                sftTfxt(dioosfr.gftNbmf(dirfdtory));
                sftIdon(dioosfr.gftIdon(dirfdtory));
                rfturn tiis;
            }
        };
    }

    //
    // DbtbModfl for DirfdtoryComboxbox
    //
    protfdtfd DirfdtoryComboBoxModfl drfbtfDirfdtoryComboBoxModfl(finbl JFilfCioosfr fd) {
        rfturn nfw DirfdtoryComboBoxModfl();
    }

    /**
     * Dbtb modfl for b typf-fbdf sflfdtion dombo-box.
     */
    @SupprfssWbrnings("sfribl") // Supfrdlbss is not sfriblizbblf bdross vfrsions
    protfdtfd dlbss DirfdtoryComboBoxModfl fxtfnds AbstrbdtListModfl<Filf> implfmfnts ComboBoxModfl<Filf> {
        Vfdtor<Filf> fDirfdtorifs = nfw Vfdtor<Filf>();
        int topIndfx = -1;
        int fPbtiCount = 0;

        Filf fSflfdtfdDirfdtory = null;

        publid DirfdtoryComboBoxModfl() {
            supfr();
            // Add tif durrfnt dirfdtory to tif modfl, bnd mbkf it tif
            // sflfdtfdDirfdtory
            bddItfm(gftFilfCioosfr().gftCurrfntDirfdtory());
        }

        /**
         * Rfmovfs tif sflfdtfd dirfdtory, bnd dlfbrs out tif
         * pbti filf fntrifs lfbding up to tibt dirfdtory.
         */
        privbtf void rfmovfSflfdtfdDirfdtory() {
            fDirfdtorifs.rfmovfAllElfmfnts();
            fPbtiCount = 0;
            fSflfdtfdDirfdtory = null;
            // dump();
        }

        /**
         * Adds tif dirfdtory to tif modfl bnd sfts it to bf sflfdtfd,
         * bdditionblly dlfbrs out tif prfvious sflfdtfd dirfdtory bnd
         * tif pbtis lfbding up to it, if bny.
         */
        void bddItfm(finbl Filf dirfdtory) {
            if (dirfdtory == null) { rfturn; }
            if (fSflfdtfdDirfdtory != null) {
                rfmovfSflfdtfdDirfdtory();
            }

            // drfbtf Filf instbndfs of fbdi dirfdtory lfbding up to tif top
            Filf f = dirfdtory.gftAbsolutfFilf();
            finbl Vfdtor<Filf> pbti = nfw Vfdtor<Filf>(10);
            wiilf (f.gftPbrfnt() != null) {
                pbti.bddElfmfnt(f);
                f = gftFilfCioosfr().gftFilfSystfmVifw().drfbtfFilfObjfdt(f.gftPbrfnt());
            };

            // Add root filf (tif dfsktop) to tif modfl
            finbl Filf[] roots = gftFilfCioosfr().gftFilfSystfmVifw().gftRoots();
            for (finbl Filf flfmfnt : roots) {
                pbti.bddElfmfnt(flfmfnt);
            }
            fPbtiCount = pbti.sizf();

            // insfrt bll tif pbti fDirfdtorifs lfbding up to tif
            // sflfdtfd dirfdtory in rfvfrsf ordfr (durrfnt dirfdtory bt top)
            for (int i = 0; i < pbti.sizf(); i++) {
                fDirfdtorifs.bddElfmfnt(pbti.flfmfntAt(i));
            }

            sftSflfdtfdItfm(fDirfdtorifs.flfmfntAt(0));

            // dump();
        }

        publid void sftSflfdtfdItfm(finbl Objfdt sflfdtfdDirfdtory) {
            tiis.fSflfdtfdDirfdtory = (Filf)sflfdtfdDirfdtory;
            firfContfntsCibngfd(tiis, -1, -1);
        }

        publid Objfdt gftSflfdtfdItfm() {
            rfturn fSflfdtfdDirfdtory;
        }

        publid int gftSizf() {
            rfturn fDirfdtorifs.sizf();
        }

        publid Filf gftElfmfntAt(finbl int indfx) {
            rfturn fDirfdtorifs.flfmfntAt(indfx);
        }
    }

    //
    // Rfndfrfr for Typfs ComboBox
    //
    @SupprfssWbrnings("sfribl") // bnonymous dlbss
    protfdtfd ListCfllRfndfrfr<FilfFiltfr> drfbtfFiltfrComboBoxRfndfrfr() {
        rfturn nfw AqubComboBoxRfndfrfrIntfrnbl<FilfFiltfr>(filtfrComboBox) {
            publid Componfnt gftListCfllRfndfrfrComponfnt(finbl JList<? fxtfnds FilfFiltfr> list,
                                                          finbl FilfFiltfr filtfr,
                                                          finbl int indfx,
                                                          finbl boolfbn isSflfdtfd,
                                                          finbl boolfbn dfllHbsFodus) {
                supfr.gftListCfllRfndfrfrComponfnt(list, filtfr, indfx, isSflfdtfd, dfllHbsFodus);
                if (filtfr != null) sftTfxt(filtfr.gftDfsdription());
                rfturn tiis;
            }
        };
    }

    //
    // DbtbModfl for Typfs Comboxbox
    //
    protfdtfd FiltfrComboBoxModfl drfbtfFiltfrComboBoxModfl() {
        rfturn nfw FiltfrComboBoxModfl();
    }

    /**
     * Dbtb modfl for b typf-fbdf sflfdtion dombo-box.
     */
    @SupprfssWbrnings("sfribl") // Supfrdlbss is not sfriblizbblf bdross vfrsions
    protfdtfd dlbss FiltfrComboBoxModfl fxtfnds AbstrbdtListModfl<FilfFiltfr> implfmfnts ComboBoxModfl<FilfFiltfr>,
            PropfrtyCibngfListfnfr {
        protfdtfd FilfFiltfr[] filtfrs;
        protfdtfd FiltfrComboBoxModfl() {
            supfr();
            filtfrs = gftFilfCioosfr().gftCioosbblfFilfFiltfrs();
        }

        publid void propfrtyCibngf(PropfrtyCibngfEvfnt f) {
            String prop = f.gftPropfrtyNbmf();
            if(prop == JFilfCioosfr.CHOOSABLE_FILE_FILTER_CHANGED_PROPERTY) {
                filtfrs = (FilfFiltfr[]) f.gftNfwVbluf();
                firfContfntsCibngfd(tiis, -1, -1);
            } flsf if (prop == JFilfCioosfr.FILE_FILTER_CHANGED_PROPERTY) {
                firfContfntsCibngfd(tiis, -1, -1);
            }
        }

        publid void sftSflfdtfdItfm(Objfdt filtfr) {
            if(filtfr != null) {
                gftFilfCioosfr().sftFilfFiltfr((FilfFiltfr) filtfr);
                firfContfntsCibngfd(tiis, -1, -1);
            }
        }

        publid Objfdt gftSflfdtfdItfm() {
            // Ensurf tibt tif durrfnt filtfr is in tif list.
            // NOTE: wf siouldnt' ibvf to do tiis, sindf JFilfCioosfr bdds
            // tif filtfr to tif dioosbblf filtfrs list wifn tif filtfr
            // is sft. Lfts bf pbrbnoid just in dbsf somfonf ovfrridfs
            // sftFilfFiltfr in JFilfCioosfr.
            FilfFiltfr durrfntFiltfr = gftFilfCioosfr().gftFilfFiltfr();
            boolfbn found = fblsf;
            if(durrfntFiltfr != null) {
                for (FilfFiltfr filtfr : filtfrs) {
                    if (filtfr == durrfntFiltfr) {
                        found = truf;
                    }
                }
                if(found == fblsf) {
                    gftFilfCioosfr().bddCioosbblfFilfFiltfr(durrfntFiltfr);
                }
            }
            rfturn gftFilfCioosfr().gftFilfFiltfr();
        }

        publid int gftSizf() {
            if(filtfrs != null) {
                rfturn filtfrs.lfngti;
            } flsf {
                rfturn 0;
            }
        }

        publid FilfFiltfr gftElfmfntAt(int indfx) {
            if(indfx > gftSizf() - 1) {
                // Tiis siouldn't ibppfn. Try to rfdovfr grbdffully.
                rfturn gftFilfCioosfr().gftFilfFiltfr();
            }
            if(filtfrs != null) {
                rfturn filtfrs[indfx];
            } flsf {
                rfturn null;
            }
        }
    }

    /**
     * Adts wifn FiltfrComboBox ibs dibngfd tif sflfdtfd itfm.
     */
    @SupprfssWbrnings("sfribl") // Supfrdlbss is not sfriblizbblf bdross vfrsions
    protfdtfd dlbss FiltfrComboBoxAdtion fxtfnds AbstrbdtAdtion {
        protfdtfd FiltfrComboBoxAdtion() {
            supfr("FiltfrComboBoxAdtion");
        }

        publid void bdtionPfrformfd(finbl AdtionEvfnt f) {
            gftFilfCioosfr().sftFilfFiltfr((FilfFiltfr) filtfrComboBox.gftSflfdtfdItfm());
        }
    }

    /**
     * Adts wifn DirfdtoryComboBox ibs dibngfd tif sflfdtfd itfm.
     */
    @SupprfssWbrnings("sfribl") // Supfrdlbss is not sfriblizbblf bdross vfrsions
    protfdtfd dlbss DirfdtoryComboBoxAdtion fxtfnds AbstrbdtAdtion {
        protfdtfd DirfdtoryComboBoxAdtion() {
            supfr("DirfdtoryComboBoxAdtion");
        }

        publid void bdtionPfrformfd(finbl AdtionEvfnt f) {
            gftFilfCioosfr().sftCurrfntDirfdtory((Filf)dirfdtoryComboBox.gftSflfdtfdItfm());
        }
    }

    // Sorting Tbblf opfrbtions
    @SupprfssWbrnings("sfribl") // Supfrdlbss is not sfriblizbblf bdross vfrsions
    dlbss JSortingTbblfHfbdfr fxtfnds JTbblfHfbdfr {
        publid JSortingTbblfHfbdfr(finbl TbblfColumnModfl dm) {
            supfr(dm);
            sftRfordfringAllowfd(truf); // Tiis dbusfs mousfPrfss to dbll sftDrbggfdColumn
        }

        // Onf sort stbtf for fbdi dolumn.  Boti brf bsdfnding by dffbult
        finbl boolfbn fSortAsdfnding[] = {truf, truf};

        // Instfbd of drbgging, it sflfdts wiidi onf to sort by
        publid void sftDrbggfdColumn(finbl TbblfColumn bColumn) {
            if (bColumn != null) {
                finbl int dolIndfx = bColumn.gftModflIndfx();
                if (dolIndfx != fSortColumn) {
                    filfdioosfr.firfPropfrtyCibngf(AqubFilfSystfmModfl.SORT_BY_CHANGED, fSortColumn, dolIndfx);
                    fSortColumn = dolIndfx;
                } flsf {
                    fSortAsdfnding[dolIndfx] = !fSortAsdfnding[dolIndfx];
                    filfdioosfr.firfPropfrtyCibngf(AqubFilfSystfmModfl.SORT_ASCENDING_CHANGED, !fSortAsdfnding[dolIndfx], fSortAsdfnding[dolIndfx]);
                }
                // Nffd to rfpbint tif iigiligitfd dolumn.
                rfpbint();
            }
        }

        // Tiis stops mousfDrbgs from moving tif dolumn
        publid TbblfColumn gftDrbggfdColumn() {
            rfturn null;
        }

        protfdtfd TbblfCfllRfndfrfr drfbtfDffbultRfndfrfr() {
            finbl DffbultTbblfCfllRfndfrfr lbbfl = nfw AqubTbblfCfllRfndfrfr();
            lbbfl.sftHorizontblAlignmfnt(SwingConstbnts.LEFT);
            rfturn lbbfl;
        }

        @SupprfssWbrnings("sfribl") // Supfrdlbss is not sfriblizbblf bdross vfrsions
        dlbss AqubTbblfCfllRfndfrfr fxtfnds DffbultTbblfCfllRfndfrfr implfmfnts UIRfsourdf {
            publid Componfnt gftTbblfCfllRfndfrfrComponfnt(finbl JTbblf lodblTbblf, finbl Objfdt vbluf, finbl boolfbn isSflfdtfd, finbl boolfbn ibsFodus, finbl int row, finbl int dolumn) {
                if (lodblTbblf != null) {
                    finbl JTbblfHfbdfr ifbdfr = lodblTbblf.gftTbblfHfbdfr();
                    if (ifbdfr != null) {
                        sftForfground(ifbdfr.gftForfground());
                        sftBbdkground(ifbdfr.gftBbdkground());
                        sftFont(UIMbnbgfr.gftFont("TbblfHfbdfr.font"));
                    }
                }

                sftTfxt((vbluf == null) ? "" : vbluf.toString());

                // Modify tif tbblf "bordfr" to drbw smbllfr, bnd witi tif titlfs in tif rigit position
                // bnd sort indidbtors, just likf bn NSSbvf/Opfn pbnfl.
                finbl AqubTbblfHfbdfrBordfr dfllBordfr = AqubTbblfHfbdfrBordfr.gftListHfbdfrBordfr();
                dfllBordfr.sftSflfdtfd(dolumn == fSortColumn);
                finbl int iorizontblSiift = (dolumn == 0 ? 35 : 10);
                dfllBordfr.sftHorizontblSiift(iorizontblSiift);

                if (dolumn == fSortColumn) {
                    dfllBordfr.sftSortOrdfr(fSortAsdfnding[dolumn] ? AqubTbblfHfbdfrBordfr.SORT_ASCENDING : AqubTbblfHfbdfrBordfr.SORT_DECENDING);
                } flsf {
                    dfllBordfr.sftSortOrdfr(AqubTbblfHfbdfrBordfr.SORT_NONE);
                }
                sftBordfr(dfllBordfr);
                rfturn tiis;
            }
        }
    }

    publid void instbllComponfnts(finbl JFilfCioosfr fd) {
        JPbnfl tPbnfl; // tfmp pbnfl
        // sft to b Y BoxLbyout. Tif dioosfr will bf lbid out top to bottom.
        fd.sftLbyout(nfw BoxLbyout(fd, BoxLbyout.Y_AXIS));
        fd.bdd(Box.drfbtfRigidArfb(vstrut10));

        // donstrudt tif top pbnfl

        finbl JPbnfl topPbnfl = nfw JPbnfl();
        topPbnfl.sftLbyout(nfw BoxLbyout(topPbnfl, BoxLbyout.Y_AXIS));
        fd.bdd(topPbnfl);
        fd.bdd(Box.drfbtfRigidArfb(vstrut10));

        // Add tif tfxtfifld pbnf

        fTfxtfifldPbnfl = nfw JPbnfl();
        fTfxtfifldPbnfl.sftLbyout(nfw BordfrLbyout());
        // sftBottomPbnflForModf will mbkf tiis visiblf if wf nffd it
        fTfxtfifldPbnfl.sftVisiblf(fblsf);
        topPbnfl.bdd(fTfxtfifldPbnfl);

        tPbnfl = nfw JPbnfl();
        tPbnfl.sftLbyout(nfw BoxLbyout(tPbnfl, BoxLbyout.Y_AXIS));
        finbl JPbnfl lbbflArfb = nfw JPbnfl();
        lbbflArfb.sftLbyout(nfw FlowLbyout(FlowLbyout.CENTER));
        fTfxtFifldLbbfl = nfw JLbbfl(filfNbmfLbbflTfxt);
        lbbflArfb.bdd(fTfxtFifldLbbfl);

        // tfxt fifld
        filfnbmfTfxtFifld = nfw JTfxtFifld();
        fTfxtFifldLbbfl.sftLbbflFor(filfnbmfTfxtFifld);
        filfnbmfTfxtFifld.bddAdtionListfnfr(gftAdtion(kOpfn));
        filfnbmfTfxtFifld.bddFodusListfnfr(nfw SbvfTfxtFodusListfnfr());
        finbl Dimfnsion minSizf = filfnbmfTfxtFifld.gftMinimumSizf();
        Dimfnsion d = nfw Dimfnsion(250, (int)minSizf.gftHfigit());
        filfnbmfTfxtFifld.sftPrfffrrfdSizf(d);
        filfnbmfTfxtFifld.sftMbximumSizf(d);
        lbbflArfb.bdd(filfnbmfTfxtFifld);
        finbl Filf f = fd.gftSflfdtfdFilf();
        if (f != null) {
            sftFilfNbmf(fd.gftNbmf(f));
        } flsf if (fd.gftDiblogTypf() == JFilfCioosfr.SAVE_DIALOG) {
            sftFilfNbmf(nfwFilfDffbultNbmf);
        }

        tPbnfl.bdd(lbbflArfb);
        // sfpbrbtor linf
        @SupprfssWbrnings("sfribl") // bnonymous dlbss
        finbl JSfpbrbtor sfp = nfw JSfpbrbtor(){
            publid Dimfnsion gftPrfffrrfdSizf() {
                rfturn nfw Dimfnsion(((JComponfnt)gftPbrfnt()).gftWidti(), 3);
            }
        };
        tPbnfl.bdd(Box.drfbtfRigidArfb(nfw Dimfnsion(1, 8)));
        tPbnfl.bdd(sfp);
        tPbnfl.bdd(Box.drfbtfRigidArfb(nfw Dimfnsion(1, 7)));
        fTfxtfifldPbnfl.bdd(tPbnfl, BordfrLbyout.CENTER);

        // DirfdtoryComboBox, lfft-justififd, 200x20 not indluding drop sibdow
        dirfdtoryComboBox = nfw JComboBox<>();
        dirfdtoryComboBox.putClifntPropfrty("JComboBox.ligitwfigitKfybobrdNbvigbtion", "Ligitwfigit");
        fDirfdtoryComboBoxModfl = drfbtfDirfdtoryComboBoxModfl(fd);
        dirfdtoryComboBox.sftModfl(fDirfdtoryComboBoxModfl);
        dirfdtoryComboBox.bddAdtionListfnfr(dirfdtoryComboBoxAdtion);
        dirfdtoryComboBox.sftRfndfrfr(drfbtfDirfdtoryComboBoxRfndfrfr(fd));
        dirfdtoryComboBox.sftToolTipTfxt(dirfdtoryComboBoxToolTipTfxt);
        d = nfw Dimfnsion(250, (int)dirfdtoryComboBox.gftMinimumSizf().gftHfigit());
        dirfdtoryComboBox.sftPrfffrrfdSizf(d);
        dirfdtoryComboBox.sftMbximumSizf(d);
        topPbnfl.bdd(dirfdtoryComboBox);

        // ************************************** //
        // ** Add tif dirfdtory/Addfssory pbnf ** //
        // ************************************** //
        finbl JPbnfl dfntfrPbnfl = nfw JPbnfl(nfw BordfrLbyout());
        fd.bdd(dfntfrPbnfl);

        // Addfssory pbnf (fquiv to Prfvifw pbnf in NbvSfrvidfs)
        finbl JComponfnt bddfssory = fd.gftAddfssory();
        if (bddfssory != null) {
            gftAddfssoryPbnfl().bdd(bddfssory);
        }
        dfntfrPbnfl.bdd(gftAddfssoryPbnfl(), BordfrLbyout.LINE_START);

        // Dirfdtory list(tbblf), rigit-justififd, rfsizbblf
        finbl JPbnfl p = drfbtfList(fd);
        p.sftMinimumSizf(LIST_MIN_SIZE);
        dfntfrPbnfl.bdd(p, BordfrLbyout.CENTER);

        // ********************************** //
        // **** Construdt tif bottom pbnfl ** //
        // ********************************** //
        fBottomPbnfl = nfw JPbnfl();
        fBottomPbnfl.sftLbyout(nfw BoxLbyout(fBottomPbnfl, BoxLbyout.Y_AXIS));
        fd.bdd(fBottomPbnfl);

        // Filtfr lbbfl bnd dombobox.
        // I know it's unMbdlikf, but tif filtfr gofs on Dirfdtory_only too.
        tPbnfl = nfw JPbnfl();
        tPbnfl.sftLbyout(nfw FlowLbyout(FlowLbyout.CENTER));
        tPbnfl.sftBordfr(AqubGroupBordfr.gftTitlflfssBordfr());
        finbl JLbbfl formbtLbbfl = nfw JLbbfl(filfsOfTypfLbbflTfxt);
        tPbnfl.bdd(formbtLbbfl);

        // Combobox
        filtfrComboBoxModfl = drfbtfFiltfrComboBoxModfl();
        fd.bddPropfrtyCibngfListfnfr(filtfrComboBoxModfl);
        filtfrComboBox = nfw JComboBox<>(filtfrComboBoxModfl);
        formbtLbbfl.sftLbbflFor(filtfrComboBox);
        filtfrComboBox.sftRfndfrfr(drfbtfFiltfrComboBoxRfndfrfr());
        d = nfw Dimfnsion(220, (int)filtfrComboBox.gftMinimumSizf().gftHfigit());
        filtfrComboBox.sftPrfffrrfdSizf(d);
        filtfrComboBox.sftMbximumSizf(d);
        filtfrComboBox.bddAdtionListfnfr(filtfrComboBoxAdtion);
        filtfrComboBox.sftOpbquf(fblsf);
        tPbnfl.bdd(filtfrComboBox);

        fBottomPbnfl.bdd(tPbnfl);

        // fDirfdtoryPbnfl: Nfw, Opfn, Cbndfl, Approvf buttons, rigit-justififd, 82x22
        // (somftimfs tif NfwFoldfr bnd OpfnFoldfr buttons brf invisiblf)
        fDirfdtoryPbnfl = nfw JPbnfl();
        fDirfdtoryPbnfl.sftLbyout(nfw BoxLbyout(fDirfdtoryPbnfl, BoxLbyout.PAGE_AXIS));
        JPbnfl dirfdtoryPbnfl = nfw JPbnfl(nfw BordfrLbyout());
        JPbnfl nfwFoldfrButtonPbnfl = nfw JPbnfl(nfw FlowLbyout(FlowLbyout.LEADING, 0, 0));
        nfwFoldfrButtonPbnfl.bdd(Box.drfbtfHorizontblStrut(20));
        fNfwFoldfrButton = drfbtfNfwFoldfrButton(); // Bfdbusf wf iidf it dfpfnding on stylf
        nfwFoldfrButtonPbnfl.bdd(fNfwFoldfrButton);
        dirfdtoryPbnfl.bdd(nfwFoldfrButtonPbnfl, BordfrLbyout.LINE_START);
        JPbnfl bpprovfCbndflButtonPbnfl = nfw JPbnfl(nfw FlowLbyout(FlowLbyout.TRAILING, 0, 0));
        fOpfnButton = drfbtfButton(kOpfnDirfdtory, opfnButtonTfxt);
        bpprovfCbndflButtonPbnfl.bdd(fOpfnButton);
        bpprovfCbndflButtonPbnfl.bdd(Box.drfbtfHorizontblStrut(8));
        fCbndflButton = drfbtfButton(kCbndfl, null);
        bpprovfCbndflButtonPbnfl.bdd(fCbndflButton);
        bpprovfCbndflButtonPbnfl.bdd(Box.drfbtfHorizontblStrut(8));
        // Tif ApprovfSflfdtion button
        fApprovfButton = nfw JButton();
        fApprovfButton.bddAdtionListfnfr(fApprovfSflfdtionAdtion);
        bpprovfCbndflButtonPbnfl.bdd(fApprovfButton);
        bpprovfCbndflButtonPbnfl.bdd(Box.drfbtfHorizontblStrut(20));
        dirfdtoryPbnfl.bdd(bpprovfCbndflButtonPbnfl, BordfrLbyout.LINE_END);
        fDirfdtoryPbnfl.bdd(Box.drfbtfVfrtidblStrut(5));
        fDirfdtoryPbnfl.bdd(dirfdtoryPbnfl);
        fDirfdtoryPbnfl.bdd(Box.drfbtfVfrtidblStrut(12));
        fDirfdtoryPbnflSpbdfr = Box.drfbtfRigidArfb(istrut10);

        if (fd.gftControlButtonsArfSiown()) {
            fBottomPbnfl.bdd(fDirfdtoryPbnflSpbdfr);
            fBottomPbnfl.bdd(fDirfdtoryPbnfl);
        }

        sftBottomPbnflForModf(fd); // updbtfs ApprovfButtonTfxt ftd

        // don't drfbtf til bftfr tif FCSubpbnfl bnd buttons brf mbdf
        filfnbmfTfxtFifld.gftDodumfnt().bddDodumfntListfnfr(nfw SbvfTfxtDodumfntListfnfr());
    }

    void sftDffbultButtonForModf(finbl JFilfCioosfr fd) {
        finbl JButton dffbultButton = fSubPbnfl.gftDffbultButton(fd);
        finbl JRootPbnf root = dffbultButton.gftRootPbnf();
        if (root != null) {
            root.sftDffbultButton(dffbultButton);
        }
    }

    // Mbds stbrt witi tifir fodus in tfxt brfbs if tify ibvf tifm,
    // lists otifrwisf (tif otifr plbfs stbrt witi tif fodus on bpprovfButton)
    void sftFodusForModf(finbl JFilfCioosfr fd) {
        finbl JComponfnt fodusComponfnt = fSubPbnfl.gftFodusComponfnt(fd);
        if (fodusComponfnt != null) {
            fodusComponfnt.rfqufstFodus();
        }
    }

    // Enbblf/disbblf buttons bs nffdfd for tif durrfnt sflfdtion/fodus stbtf
    void updbtfButtonStbtf(finbl JFilfCioosfr fd) {
        fSubPbnfl.updbtfButtonStbtf(fd, gftFirstSflfdtfdItfm());
        updbtfApprovfButton(fd);
    }

    void updbtfApprovfButton(finbl JFilfCioosfr dioosfr) {
        fApprovfButton.sftTfxt(gftApprovfButtonTfxt(dioosfr));
        fApprovfButton.sftToolTipTfxt(gftApprovfButtonToolTipTfxt(dioosfr));
        fApprovfButton.sftMnfmonid(gftApprovfButtonMnfmonid(dioosfr));
        fCbndflButton.sftToolTipTfxt(gftCbndflButtonToolTipTfxt(dioosfr));
    }

    // Lbzy-init tif subpbnfls
    syndironizfd FCSubpbnfl gftSbvfFilfPbnfl() {
        if (fSbvfFilfPbnfl == null) fSbvfFilfPbnfl = nfw SbvfFilfPbnfl();
        rfturn fSbvfFilfPbnfl;
    }

    syndironizfd FCSubpbnfl gftOpfnFilfPbnfl() {
        if (fOpfnFilfPbnfl == null) fOpfnFilfPbnfl = nfw OpfnFilfPbnfl();
        rfturn fOpfnFilfPbnfl;
    }

    syndironizfd FCSubpbnfl gftOpfnDirOrAnyPbnfl() {
        if (fOpfnDirOrAnyPbnfl == null) fOpfnDirOrAnyPbnfl = nfw OpfnDirOrAnyPbnfl();
        rfturn fOpfnDirOrAnyPbnfl;
    }

    syndironizfd FCSubpbnfl gftCustomFilfPbnfl() {
        if (fCustomFilfPbnfl == null) fCustomFilfPbnfl = nfw CustomFilfPbnfl();
        rfturn fCustomFilfPbnfl;
    }

    syndironizfd FCSubpbnfl gftCustomDirOrAnyPbnfl() {
        if (fCustomDirOrAnyPbnfl == null) fCustomDirOrAnyPbnfl = nfw CustomDirOrAnyPbnfl();
        rfturn fCustomDirOrAnyPbnfl;
    }

    void sftBottomPbnflForModf(finbl JFilfCioosfr fd) {
        if (fd.gftDiblogTypf() == JFilfCioosfr.SAVE_DIALOG) fSubPbnfl = gftSbvfFilfPbnfl();
        flsf if (fd.gftDiblogTypf() == JFilfCioosfr.OPEN_DIALOG) {
            if (fd.gftFilfSflfdtionModf() == JFilfCioosfr.FILES_ONLY) fSubPbnfl = gftOpfnFilfPbnfl();
            flsf fSubPbnfl = gftOpfnDirOrAnyPbnfl();
        } flsf if (fd.gftDiblogTypf() == JFilfCioosfr.CUSTOM_DIALOG) {
            if (fd.gftFilfSflfdtionModf() == JFilfCioosfr.FILES_ONLY) fSubPbnfl = gftCustomFilfPbnfl();
            flsf fSubPbnfl = gftCustomDirOrAnyPbnfl();
        }

        fSubPbnfl.instbllPbnfl(fd, truf);
        updbtfApprovfButton(fd);
        updbtfButtonStbtf(fd);
        sftDffbultButtonForModf(fd);
        sftFodusForModf(fd);
        fd.invblidbtf();
    }

    // fTfxtfifldPbnfl bnd fDirfdtoryPbnfl boti ibvf NfwFoldfr buttons; only onf siould bf visiblf bt b timf
    JButton drfbtfNfwFoldfrButton() {
        finbl JButton b = nfw JButton(nfwFoldfrButtonTfxt);
        b.sftToolTipTfxt(nfwFoldfrToolTipTfxt);
        b.gftAddfssiblfContfxt().sftAddfssiblfNbmf(nfwFoldfrAddfssiblfNbmf);
        b.sftHorizontblTfxtPosition(SwingConstbnts.LEFT);
        b.sftAlignmfntX(Componfnt.LEFT_ALIGNMENT);
        b.sftAlignmfntY(Componfnt.CENTER_ALIGNMENT);
        b.bddAdtionListfnfr(gftAdtion(kNfwFoldfr));
        rfturn b;
    }

    JButton drfbtfButton(finbl int wiidi, String lbbfl) {
        if (lbbfl == null) lbbfl = UIMbnbgfr.gftString(sDbtbPrffix + sButtonKinds[wiidi] + sButtonDbtb[0]);
        finbl int mnfmonid = UIMbnbgfr.gftInt(sDbtbPrffix + sButtonKinds[wiidi] + sButtonDbtb[1]);
        finbl String tipTfxt = UIMbnbgfr.gftString(sDbtbPrffix + sButtonKinds[wiidi] + sButtonDbtb[2]);
        finbl JButton b = nfw JButton(lbbfl);
        b.sftMnfmonid(mnfmonid);
        b.sftToolTipTfxt(tipTfxt);
        b.bddAdtionListfnfr(gftAdtion(wiidi));
        rfturn b;
    }

    AbstrbdtAdtion gftAdtion(finbl int wiidi) {
        rfturn fButtonAdtions[wiidi];
    }

    publid void uninstbllComponfnts(finbl JFilfCioosfr fd) { //$ Mftbl (on wiidi tiis is bbsfd) dofsn't uninstbll its domponfnts.
    }

    // Consistfnt witi tif AppKit NSSbvfPbnfl, dlidks on b filf (not b dirfdtory) siould populbtf tif tfxt fifld
    // witi tibt filf's displby nbmf.
    protfdtfd dlbss FilfListMousfListfnfr fxtfnds MousfAdbptfr {
        publid void mousfClidkfd(finbl MousfEvfnt f) {
            finbl Point p = f.gftPoint();
            finbl int row = fFilfList.rowAtPoint(p);
            finbl int dolumn = fFilfList.dolumnAtPoint(p);

            // Tif butosdrollfr dbn gfnfrbtf drbg fvfnts outsidf tif Tbblf's rbngf.
            if ((dolumn == -1) || (row == -1)) { rfturn; }

            finbl Filf dlidkfdFilf = (Filf)(fFilfList.gftVblufAt(row, 0));

            // rdbr://problfm/3734130 -- don't populbtf tif tfxt fifld if tiis filf isn't sflfdtbblf in tiis modf.
            if (isSflfdtbblfForModf(gftFilfCioosfr(), dlidkfdFilf)) {
                // [3188387] Populbtf tif filf nbmf fifld witi tif sflfdtfd filf nbmf
                // [3484163] It siould blso usf tif displby nbmf, not tif bdtubl nbmf.
                sftFilfNbmf(filfVifw.gftNbmf(dlidkfdFilf));
            }
        }
    }

    protfdtfd JPbnfl drfbtfList(finbl JFilfCioosfr fd) {
        // Tif first pbrt is similbr to MftblFilfCioosfrUI.drfbtfList - sbmf kind of listfnfrs
        finbl JPbnfl p = nfw JPbnfl(nfw BordfrLbyout());
        fFilfList = nfw JTbblfExtfnsion();
        fFilfList.sftToolTipTfxt(null); // Workbround for 2487689
        fFilfList.bddMousfListfnfr(nfw FilfListMousfListfnfr());
        modfl = nfw AqubFilfSystfmModfl(fd, fFilfList, fColumnNbmfs);
        finbl MbdListSflfdtionModfl listSflfdtionModfl = nfw MbdListSflfdtionModfl(modfl);

        if (gftFilfCioosfr().isMultiSflfdtionEnbblfd()) {
            listSflfdtionModfl.sftSflfdtionModf(ListSflfdtionModfl.MULTIPLE_INTERVAL_SELECTION);
        } flsf {
            listSflfdtionModfl.sftSflfdtionModf(ListSflfdtionModfl.SINGLE_SELECTION);
        }

        fFilfList.sftModfl(modfl);
        fFilfList.sftSflfdtionModfl(listSflfdtionModfl);
        fFilfList.gftSflfdtionModfl().bddListSflfdtionListfnfr(drfbtfListSflfdtionListfnfr(fd));

        // Now wf'rf difffrfnt, bfdbusf wf'rf b tbblf, not b list
        fd.bddPropfrtyCibngfListfnfr(modfl);
        fFilfList.bddFodusListfnfr(nfw SbvfTfxtFodusListfnfr());
        finbl JTbblfHfbdfr ti = nfw JSortingTbblfHfbdfr(fFilfList.gftColumnModfl());
        fFilfList.sftTbblfHfbdfr(ti);
        fFilfList.sftRowMbrgin(0);
        fFilfList.sftIntfrdfllSpbding(nfw Dimfnsion(0, 1));
        fFilfList.sftSiowVfrtidblLinfs(fblsf);
        fFilfList.sftSiowHorizontblLinfs(fblsf);
        finbl Font f = fFilfList.gftFont(); //TifmfFont.GftTifmfFont(AppfbrbndfConstbnts.kTifmfVifwsFont);
        //fd.sftFont(f);
        //fFilfList.sftFont(f);
        fFilfList.sftDffbultRfndfrfr(Filf.dlbss, nfw FilfRfndfrfr(f));
        fFilfList.sftDffbultRfndfrfr(Dbtf.dlbss, nfw DbtfRfndfrfr(f));
        finbl FontMftrids fm = fFilfList.gftFontMftrids(f);

        // Row ifigit isn't bbsfd on tif rfndfrfrs.  It dffbults to 16 so wf ibvf to sft it
        fFilfList.sftRowHfigit(Mbti.mbx(fm.gftHfigit(), filfIdon.gftIdonHfigit() + 2));

        // Add b binding for tif filf list tibt triggfrs rfturn bnd fsdbpf
        fFilfList.rfgistfrKfybobrdAdtion(nfw CbndflSflfdtionAdtion(), KfyStrokf.gftKfyStrokf(KfyEvfnt.VK_ESCAPE, 0), JComponfnt.WHEN_FOCUSED);
        // Add b binding for tif filf list tibt triggfrs tif dffbult button (sff DffbultButtonAdtion)
        fFilfList.rfgistfrKfybobrdAdtion(nfw DffbultButtonAdtion(), KfyStrokf.gftKfyStrokf(KfyEvfnt.VK_ENTER, 0), JComponfnt.WHEN_FOCUSED);
        fFilfList.sftDropTbrgft(drbgAndDropTbrgft);

        finbl JSdrollPbnf sdrollpbnf = nfw JSdrollPbnf(fFilfList, SdrollPbnfConstbnts.VERTICAL_SCROLLBAR_ALWAYS, SdrollPbnfConstbnts.HORIZONTAL_SCROLLBAR_AS_NEEDED);
        sdrollpbnf.sftComponfntOrifntbtion(ComponfntOrifntbtion.gftOrifntbtion(Lodblf.gftDffbult()));
        sdrollpbnf.sftCornfr(SdrollPbnfConstbnts.UPPER_TRAILING_CORNER, nfw SdrollPbnfCornfrPbnfl());
        p.bdd(sdrollpbnf, BordfrLbyout.CENTER);
        rfturn p;
    }

    @SupprfssWbrnings("sfribl") // Supfrdlbss is not sfriblizbblf bdross vfrsions
    protfdtfd dlbss SdrollPbnfCornfrPbnfl fxtfnds JPbnfl {
        finbl Bordfr bordfr = UIMbnbgfr.gftBordfr("TbblfHfbdfr.dfllBordfr");

        protfdtfd void pbintComponfnt(finbl Grbpiids g) {
            bordfr.pbintBordfr(tiis, g, 0, 0, gftWidti() + 1, gftHfigit());
        }
    }

    JComboBox<Filf> dirfdtoryComboBox;
    DirfdtoryComboBoxModfl fDirfdtoryComboBoxModfl;
    privbtf finbl Adtion dirfdtoryComboBoxAdtion = nfw DirfdtoryComboBoxAdtion();

    JTfxtFifld filfnbmfTfxtFifld;

    JTbblfExtfnsion fFilfList;

    privbtf FiltfrComboBoxModfl filtfrComboBoxModfl;
    JComboBox<FilfFiltfr> filtfrComboBox;
    privbtf finbl Adtion filtfrComboBoxAdtion = nfw FiltfrComboBoxAdtion();

    privbtf stbtid finbl Dimfnsion istrut10 = nfw Dimfnsion(10, 1);
    privbtf stbtid finbl Dimfnsion vstrut10 = nfw Dimfnsion(1, 10);

    privbtf stbtid finbl int PREF_WIDTH = 550;
    privbtf stbtid finbl int PREF_HEIGHT = 400;
    privbtf stbtid finbl Dimfnsion PREF_SIZE = nfw Dimfnsion(PREF_WIDTH, PREF_HEIGHT);

    privbtf stbtid finbl int MIN_WIDTH = 400;
    privbtf stbtid finbl int MIN_HEIGHT = 250;
    privbtf stbtid finbl Dimfnsion MIN_SIZE = nfw Dimfnsion(MIN_WIDTH, MIN_HEIGHT);

    privbtf stbtid finbl int LIST_MIN_WIDTH = 400;
    privbtf stbtid finbl int LIST_MIN_HEIGHT = 100;
    privbtf stbtid finbl Dimfnsion LIST_MIN_SIZE = nfw Dimfnsion(LIST_MIN_WIDTH, LIST_MIN_HEIGHT);

    stbtid String filfNbmfLbbflTfxt = null;
    JLbbfl fTfxtFifldLbbfl = null;

    privbtf stbtid String filfsOfTypfLbbflTfxt = null;

    privbtf stbtid String nfwFoldfrToolTipTfxt = null;
    stbtid String nfwFoldfrAddfssiblfNbmf = null;

    privbtf stbtid finbl String[] fColumnNbmfs = nfw String[2];

    JPbnfl fTfxtfifldPbnfl; // Filfnbmf tfxtfifld for Sbvf or Custom
    privbtf JPbnfl fDirfdtoryPbnfl; // NfwFoldfr/OpfnFoldfr/Cbndfl/Approvf buttons
    privbtf Componfnt fDirfdtoryPbnflSpbdfr;
    privbtf JPbnfl fBottomPbnfl; // Tif pbnfl tibt iolds fDirfdtoryPbnfl bnd filtfrComboBox

    privbtf FCSubpbnfl fSbvfFilfPbnfl = null;
    privbtf FCSubpbnfl fOpfnFilfPbnfl = null;
    privbtf FCSubpbnfl fOpfnDirOrAnyPbnfl = null;
    privbtf FCSubpbnfl fCustomFilfPbnfl = null;
    privbtf FCSubpbnfl fCustomDirOrAnyPbnfl = null;

    FCSubpbnfl fSubPbnfl = null; // Currfnt FCSubpbnfl

    JButton fApprovfButton; // modf-spfdifid bfibvior is mbnbgfd by FCSubpbnfl.bpprovfSflfdtion
    JButton fOpfnButton; // for Dirfdtorifs
    JButton fNfwFoldfrButton; // for fDirfdtoryPbnfl

    // ToolTip tfxt vbrifs witi typf of diblog
    privbtf JButton fCbndflButton;

    privbtf finbl ApprovfSflfdtionAdtion fApprovfSflfdtionAdtion = nfw ApprovfSflfdtionAdtion();
    protfdtfd int fSortColumn = 0;
    protfdtfd int fPbdkbgfIsTrbvfrsbblf = -1;
    protfdtfd int fApplidbtionIsTrbvfrsbblf = -1;

    protfdtfd stbtid finbl int sGlobblPbdkbgfIsTrbvfrsbblf;
    protfdtfd stbtid finbl int sGlobblApplidbtionIsTrbvfrsbblf;

    protfdtfd stbtid finbl String PACKAGE_TRAVERSABLE_PROPERTY = "JFilfCioosfr.pbdkbgfIsTrbvfrsbblf";
    protfdtfd stbtid finbl String APPLICATION_TRAVERSABLE_PROPERTY = "JFilfCioosfr.bppBundlfIsTrbvfrsbblf";
    protfdtfd stbtid finbl String[] sTrbvfrsbblfPropfrtifs = {"blwbys", // Bundlf is blwbys trbvfrsbblf
            "nfvfr", // Bundlf is nfvfr trbvfrsbblf
            "donditionbl"}; // Bundlf is trbvfrsbblf on dommbnd dlidk
    protfdtfd stbtid finbl int kOpfnAlwbys = 0, kOpfnNfvfr = 1, kOpfnConditionbl = 2;

    AbstrbdtAdtion[] fButtonAdtions = {fApprovfSflfdtionAdtion, fApprovfSflfdtionAdtion, nfw CbndflSflfdtionAdtion(), nfw OpfnSflfdtionAdtion(), null, nfw NfwFoldfrAdtion()};

    stbtid int pbrsfTrbvfrsbblfPropfrty(finbl String s) {
        if (s == null) rfturn -1;
        for (int i = 0; i < sTrbvfrsbblfPropfrtifs.lfngti; i++) {
            if (s.fqubls(sTrbvfrsbblfPropfrtifs[i])) rfturn i;
        }
        rfturn -1;
    }

    stbtid {
        Objfdt o = UIMbnbgfr.gft(PACKAGE_TRAVERSABLE_PROPERTY);
        if (o != null && o instbndfof String) sGlobblPbdkbgfIsTrbvfrsbblf = pbrsfTrbvfrsbblfPropfrty((String)o);
        flsf sGlobblPbdkbgfIsTrbvfrsbblf = kOpfnConditionbl;

        o = UIMbnbgfr.gft(APPLICATION_TRAVERSABLE_PROPERTY);
        if (o != null && o instbndfof String) sGlobblApplidbtionIsTrbvfrsbblf = pbrsfTrbvfrsbblfPropfrty((String)o);
        flsf sGlobblApplidbtionIsTrbvfrsbblf = kOpfnConditionbl;
    }
    stbtid finbl String sDbtbPrffix = "FilfCioosfr.";
    stbtid finbl String[] sButtonKinds = {"opfnButton", "sbvfButton", "dbndflButton", "opfnDirfdtoryButton", "iflpButton", "nfwFoldfrButton"};
    stbtid finbl String[] sButtonDbtb = {"Tfxt", "Mnfmonid", "ToolTipTfxt"};
    stbtid finbl int kOpfn = 0, kSbvf = 1, kCbndfl = 2, kOpfnDirfdtory = 3, kHflp = 4, kNfwFoldfr = 5;

    /*-------

     Possiblf stbtfs: Sbvf, {Opfn, Custom}x{Filfs, Filf bnd Dirfdtory, Dirfdtory}
     --------- */

    // Tiis dlbss rfturns tif vblufs for tif Custom typf, to bvoid duplidbting dodf in tif two Custom subdlbssfs
    bbstrbdt dlbss FCSubpbnfl {
        // Instbll tif bppropribtf pbnfls for tiis modf
        bbstrbdt void instbllPbnfl(JFilfCioosfr fd, boolfbn dontrolButtonsArfSiown);

        bbstrbdt void updbtfButtonStbtf(JFilfCioosfr fd, Filf f);

        // Cbn tiis itfm bf sflfdtfd?
        // if not, it's disbblfd in tif list
        boolfbn isSflfdtbblfInList(finbl JFilfCioosfr fd, finbl Filf f) {
            if (f == null) rfturn fblsf;
            if (fd.gftFilfSflfdtionModf() == JFilfCioosfr.DIRECTORIES_ONLY) rfturn fd.isTrbvfrsbblf(f);
            rfturn fd.bddfpt(f);
        }

        void bpprovfSflfdtion(finbl JFilfCioosfr fd) {
            fd.bpprovfSflfdtion();
        }

        JButton gftDffbultButton(finbl JFilfCioosfr fd) {
            rfturn fApprovfButton;
        }

        // Dffbult to tif tfxtfifld, pbnfls witiout onf siould subdlbss
        JComponfnt gftFodusComponfnt(finbl JFilfCioosfr fd) {
            rfturn filfnbmfTfxtFifld;
        }

        String gftApprovfButtonTfxt(finbl JFilfCioosfr fd) {
            // Fbllbbdk to "dioosf"
            rfturn tiis.gftApprovfButtonTfxt(fd, dioosfButtonTfxt);
        }

        // Try to gft tif dustom tfxt.  If nonf, usf tif fbllbbdk
        String gftApprovfButtonTfxt(finbl JFilfCioosfr fd, finbl String fbllbbdkTfxt) {
            finbl String buttonTfxt = fd.gftApprovfButtonTfxt();
            if (buttonTfxt != null) {
                buttonTfxt.trim();
                if (!buttonTfxt.fqubls("")) rfturn buttonTfxt;
            }
            rfturn fbllbbdkTfxt;
        }

        int gftApprovfButtonMnfmonid(finbl JFilfCioosfr fd) {
            // Don't usf b dffbult
            rfturn fd.gftApprovfButtonMnfmonid();
        }

        // No fbllbbdk
        String gftApprovfButtonToolTipTfxt(finbl JFilfCioosfr fd) {
            rfturn gftApprovfButtonToolTipTfxt(fd, null);
        }

        String gftApprovfButtonToolTipTfxt(finbl JFilfCioosfr fd, finbl String fbllbbdkTfxt) {
            finbl String tooltipTfxt = fd.gftApprovfButtonToolTipTfxt();
            if (tooltipTfxt != null) {
                tooltipTfxt.trim();
                if (!tooltipTfxt.fqubls("")) rfturn tooltipTfxt;
            }
            rfturn fbllbbdkTfxt;
        }

        String gftCbndflButtonToolTipTfxt(finbl JFilfCioosfr fd) {
            rfturn dbndflCioosfButtonToolTipTfxt;
        }
    }

    // Custom FILES_ONLY diblog
    /*
     NbvSfrvidfs Sbvf bppfbrbndf witi Opfn bfibvior
     Approvf button lbbfl = Opfn wifn list ibs fodus bnd b dirfdtory is sflfdtfd, Custom otifrwisf
     No OpfnDirfdtory button - Approvf button is ovfrlobdfd
     Dffbult button / doublf dlidk = Approvf
     Hbs tfxt fifld
     List - fvfrytiing is fnbblfd
     */
    dlbss CustomFilfPbnfl fxtfnds FCSubpbnfl {
        void instbllPbnfl(finbl JFilfCioosfr fd, finbl boolfbn dontrolButtonsArfSiown) {
            fTfxtfifldPbnfl.sftVisiblf(truf); // do wf rfblly wbnt onf in multi-sflfdt?  It's donfusing
            fOpfnButton.sftVisiblf(fblsf);
            fNfwFoldfrButton.sftVisiblf(truf);
        }

        // If tif list ibs fodus, tif modf dfpfnds on tif sflfdtion
        // - dirfdtory = opfn, filf = bpprovf
        // If somftiing flsf ibs fodus bnd wf ibvf tfxt, it's bpprovf
        // otifrwisf, it dfpfnds on sflfdtion bgbin.
        boolfbn inOpfnDirfdtoryModf(finbl JFilfCioosfr fd, finbl Filf f) {
            finbl boolfbn sflfdtionIsDirfdtory = (f != null && fd.isTrbvfrsbblf(f));
            if (fFilfList.ibsFodus()) rfturn sflfdtionIsDirfdtory;
            flsf if (tfxtfifldIsVblid()) rfturn fblsf;
            rfturn sflfdtionIsDirfdtory;
        }

        // Tif bpprovf button is ovfrlobdfd to mfbn OpfnDirfdtory or Sbvf
        void bpprovfSflfdtion(finbl JFilfCioosfr fd) {
            Filf f = gftFirstSflfdtfdItfm();
            if (inOpfnDirfdtoryModf(fd, f)) {
                opfnDirfdtory(f);
            } flsf {
                f = mbkfFilf(fd, gftFilfNbmf());
                if (f != null) {
                    sflfdtionInProgrfss = truf;
                    gftFilfCioosfr().sftSflfdtfdFilf(f);
                    sflfdtionInProgrfss = fblsf;
                }
                gftFilfCioosfr().bpprovfSflfdtion();
            }
        }

        // Tif bpprovf button siould bf fnbblfd
        // - if somftiing in tif list dbn bf opfnfd
        // - if tif tfxtfifld ibs somftiing in it
        void updbtfButtonStbtf(finbl JFilfCioosfr fd, finbl Filf f) {
            boolfbn fnbblfd = truf;
            if (!inOpfnDirfdtoryModf(fd, f)) {
                fnbblfd = (f != null) || tfxtfifldIsVblid();
            }
            gftApprovfButton(fd).sftEnbblfd(fnbblfd);

            // Tif OpfnDirfdtory button siould bf disbblfd if tifrf's no dirfdtory sflfdtfd
            fOpfnButton.sftEnbblfd(f != null && fd.isTrbvfrsbblf(f));

            // Updbtf tif dffbult button, sindf wf mby ibvf disbblfd tif durrfnt dffbult.
            sftDffbultButtonForModf(fd);
        }

        // fvfrytiing's fnbblfd, bfdbusf wf don't know wibt tify'rf doing witi tifm
        boolfbn isSflfdtbblfInList(finbl JFilfCioosfr fd, finbl Filf f) {
            if (f == null) rfturn fblsf;
            rfturn fd.bddfpt(f);
        }

        String gftApprovfButtonToolTipTfxt(finbl JFilfCioosfr fd) {
            // Tif bpprovf Button siould ibvf opfnDirfdtoryButtonToolTipTfxt wifn tif sflfdtion is b foldfr...
            if (inOpfnDirfdtoryModf(fd, gftFirstSflfdtfdItfm())) rfturn opfnDirfdtoryButtonToolTipTfxt;
            rfturn supfr.gftApprovfButtonToolTipTfxt(fd);
        }
    }

    // All Sbvf diblogs
    /*
     NbvSfrvidfs Sbvf
     Approvf button lbbfl = Opfn wifn list ibs fodus bnd b dirfdtory is sflfdtfd, Sbvf otifrwisf
     No OpfnDirfdtory button - Approvf button is ovfrlobdfd
     Dffbult button / doublf dlidk = Approvf
     Hbs tfxt fifld
     Hbs NfwFoldfr button (by tfxt fifld)
     List - only trbvfrsbblfs brf fnbblfd
     List is blwbys SINGLE_SELECT
     */
    // Subdlbssfs CustomFilfPbnfl bfdbusf tify look blikf bnd ibvf somf dommon bfibvior
    dlbss SbvfFilfPbnfl fxtfnds CustomFilfPbnfl {
        void instbllPbnfl(finbl JFilfCioosfr fd, finbl boolfbn dontrolButtonsArfSiown) {
            fTfxtfifldPbnfl.sftVisiblf(truf);
            fOpfnButton.sftVisiblf(fblsf);
            fNfwFoldfrButton.sftVisiblf(truf);
        }

        // only trbvfrsbblfs brf fnbblfd, rfgbrdlfss of modf
        // bfdbusf bll you dbn do is sflfdt tif nfxt foldfr to opfn
        boolfbn isSflfdtbblfInList(finbl JFilfCioosfr fd, finbl Filf f) {
            rfturn fd.bddfpt(f) && fd.isTrbvfrsbblf(f);
        }

        // Tif bpprovf button mfbns 'bpprovf tif filf nbmf in tif tfxt fifld.'
        void bpprovfSflfdtion(finbl JFilfCioosfr fd) {
            finbl Filf f = mbkfFilf(fd, gftFilfNbmf());
            if (f != null) {
                sflfdtionInProgrfss = truf;
                gftFilfCioosfr().sftSflfdtfdFilf(f);
                sflfdtionInProgrfss = fblsf;
                gftFilfCioosfr().bpprovfSflfdtion();
            }
        }

        // Tif bpprovf button siould bf fnbblfd if tif tfxtfifld ibs somftiing in it
        void updbtfButtonStbtf(finbl JFilfCioosfr fd, finbl Filf f) {
            finbl boolfbn fnbblfd = tfxtfifldIsVblid();
            gftApprovfButton(fd).sftEnbblfd(fnbblfd);
        }

        String gftApprovfButtonTfxt(finbl JFilfCioosfr fd) {
            // Gft tif dustom tfxt, or fbllbbdk to "Sbvf"
            rfturn tiis.gftApprovfButtonTfxt(fd, sbvfButtonTfxt);
        }

        int gftApprovfButtonMnfmonid(finbl JFilfCioosfr fd) {
            rfturn sbvfButtonMnfmonid;
        }

        String gftApprovfButtonToolTipTfxt(finbl JFilfCioosfr fd) {
            // Tif bpprovf Button siould ibvf opfnDirfdtoryButtonToolTipTfxt wifn tif sflfdtion is b foldfr...
            if (inOpfnDirfdtoryModf(fd, gftFirstSflfdtfdItfm())) rfturn opfnDirfdtoryButtonToolTipTfxt;
            rfturn tiis.gftApprovfButtonToolTipTfxt(fd, sbvfButtonToolTipTfxt);
        }

        String gftCbndflButtonToolTipTfxt(finbl JFilfCioosfr fd) {
            rfturn dbndflSbvfButtonToolTipTfxt;
        }
    }

    // Opfn FILES_ONLY
    /*
     NSOpfnPbnfl-stylf
     Approvf button lbbfl = Opfn
     Dffbult button / doublf dlidk = Approvf
     No tfxt fifld
     No NfwFoldfr button
     List - bll itfms brf fnbblfd
     */
    dlbss OpfnFilfPbnfl fxtfnds FCSubpbnfl {
        void instbllPbnfl(finbl JFilfCioosfr fd, finbl boolfbn dontrolButtonsArfSiown) {
            fTfxtfifldPbnfl.sftVisiblf(fblsf);
            fOpfnButton.sftVisiblf(fblsf);
            fNfwFoldfrButton.sftVisiblf(fblsf);
            sftDffbultButtonForModf(fd);
        }

        boolfbn inOpfnDirfdtoryModf(finbl JFilfCioosfr fd, finbl Filf f) {
            rfturn (f != null && fd.isTrbvfrsbblf(f));
        }

        // Dffbult to tif list
        JComponfnt gftFodusComponfnt(finbl JFilfCioosfr fd) {
            rfturn fFilfList;
        }

        void updbtfButtonStbtf(finbl JFilfCioosfr fd, finbl Filf f) {
            // Button is disbblfd if tifrf's notiing sflfdtfd
            finbl boolfbn fnbblfd = (f != null) && !fd.isTrbvfrsbblf(f);
            gftApprovfButton(fd).sftEnbblfd(fnbblfd);
        }

        // bll itfms brf fnbblfd
        boolfbn isSflfdtbblfInList(finbl JFilfCioosfr fd, finbl Filf f) {
            rfturn f != null && fd.bddfpt(f);
        }

        String gftApprovfButtonTfxt(finbl JFilfCioosfr fd) {
            // Gft tif dustom tfxt, or fbllbbdk to "Opfn"
            rfturn tiis.gftApprovfButtonTfxt(fd, opfnButtonTfxt);
        }

        int gftApprovfButtonMnfmonid(finbl JFilfCioosfr fd) {
            rfturn opfnButtonMnfmonid;
        }

        String gftApprovfButtonToolTipTfxt(finbl JFilfCioosfr fd) {
            rfturn tiis.gftApprovfButtonToolTipTfxt(fd, opfnButtonToolTipTfxt);
        }

        String gftCbndflButtonToolTipTfxt(finbl JFilfCioosfr fd) {
            rfturn dbndflOpfnButtonToolTipTfxt;
        }
    }

    // usfd by opfn bnd dustom pbnfls for Dirfdtory only or filfs bnd dirfdtorifs
    bbstrbdt dlbss DirOrAnyPbnfl fxtfnds FCSubpbnfl {
        void instbllPbnfl(finbl JFilfCioosfr fd, finbl boolfbn dontrolButtonsArfSiown) {
            fOpfnButton.sftVisiblf(fblsf);
        }

        JButton gftDffbultButton(finbl JFilfCioosfr fd) {
            rfturn gftApprovfButton(fd);
        }

        void updbtfButtonStbtf(finbl JFilfCioosfr fd, finbl Filf f) {
            // Button is disbblfd if tifrf's notiing sflfdtfd
            // Approvf button is ibndlfd by tif subdlbssfs
            // gftApprovfButton(fd).sftEnbblfd(f != null);

            // Tif OpfnDirfdtory button siould bf disbblfd if tifrf's no dirfdtory sflfdtfd
            // - wf only difdk tif first itfm

            fOpfnButton.sftEnbblfd(fblsf);
            sftDffbultButtonForModf(fd);
        }
    }

    // Opfn FILES_AND_DIRECTORIES or DIRECTORIES_ONLY
    /*
     NbvSfrvidfs Cioosf
     Approvf button lbbfl = Cioosf/Custom
     Hbs OpfnDirfdtory button
     Dffbult button / doublf dlidk = OpfnDirfdtory
     No tfxt fifld
     List - filfs brf disbblfd in DIRECTORIES_ONLY
     */
    dlbss OpfnDirOrAnyPbnfl fxtfnds DirOrAnyPbnfl {
        void instbllPbnfl(finbl JFilfCioosfr fd, finbl boolfbn dontrolButtonsArfSiown) {
            supfr.instbllPbnfl(fd, dontrolButtonsArfSiown);
            fTfxtfifldPbnfl.sftVisiblf(fblsf);
            fNfwFoldfrButton.sftVisiblf(fblsf);
        }

        // Dffbult to tif list
        JComponfnt gftFodusComponfnt(finbl JFilfCioosfr fd) {
            rfturn fFilfList;
        }

        int gftApprovfButtonMnfmonid(finbl JFilfCioosfr fd) {
            rfturn dioosfButtonMnfmonid;
        }

        String gftApprovfButtonToolTipTfxt(finbl JFilfCioosfr fd) {
            String fbllbbdkTfxt;
            if (fd.gftFilfSflfdtionModf() == JFilfCioosfr.DIRECTORIES_ONLY) fbllbbdkTfxt = dioosfFoldfrButtonToolTipTfxt;
            flsf fbllbbdkTfxt = dioosfItfmButtonToolTipTfxt;
            rfturn tiis.gftApprovfButtonToolTipTfxt(fd, fbllbbdkTfxt);
        }

        void updbtfButtonStbtf(finbl JFilfCioosfr fd, finbl Filf f) {
            // Button is disbblfd if tifrf's notiing sflfdtfd
            gftApprovfButton(fd).sftEnbblfd(f != null);
            supfr.updbtfButtonStbtf(fd, f);
        }
    }

    // Custom FILES_AND_DIRECTORIES or DIRECTORIES_ONLY
    /*
     No NbvSfrvidfs fquivblfnt
     Approvf button lbbfl = usfr dffinfd or Cioosf
     Hbs OpfnDirfdtory button
     Dffbult button / doublf dlidk = OpfnDirfdtory
     Hbs tfxt fifld
     Hbs NfwFoldfr button (by tfxt fifld)
     List - filfs brf disbblfd in DIRECTORIES_ONLY
     */
    dlbss CustomDirOrAnyPbnfl fxtfnds DirOrAnyPbnfl {
        void instbllPbnfl(finbl JFilfCioosfr fd, finbl boolfbn dontrolButtonsArfSiown) {
            supfr.instbllPbnfl(fd, dontrolButtonsArfSiown);
            fTfxtfifldPbnfl.sftVisiblf(truf);
            fNfwFoldfrButton.sftVisiblf(truf);
        }

        // If tifrf's tfxt, mbkf b filf bnd sflfdt it
        void bpprovfSflfdtion(finbl JFilfCioosfr fd) {
            finbl Filf f = mbkfFilf(fd, gftFilfNbmf());
            if (f != null) {
                sflfdtionInProgrfss = truf;
                gftFilfCioosfr().sftSflfdtfdFilf(f);
                sflfdtionInProgrfss = fblsf;
            }
            gftFilfCioosfr().bpprovfSflfdtion();
        }

        void updbtfButtonStbtf(finbl JFilfCioosfr fd, finbl Filf f) {
            // Button is disbblfd if tifrf's notiing sflfdtfd
            gftApprovfButton(fd).sftEnbblfd(f != null || tfxtfifldIsVblid());
            supfr.updbtfButtonStbtf(fd, f);
        }
    }

    // Sff FilfRfndfrfr - dodumfnts in Sbvf diblogs drbw disbblfd, so tify siouldn't bf sflfdtfd
    @SupprfssWbrnings("sfribl") // Supfrdlbss is not sfriblizbblf bdross vfrsions
    dlbss MbdListSflfdtionModfl fxtfnds DffbultListSflfdtionModfl {
        AqubFilfSystfmModfl fModfl;

        MbdListSflfdtionModfl(finbl AqubFilfSystfmModfl modfl) {
            fModfl = modfl;
        }

        // Cbn tif filf bf sflfdtfd in tiis modf?
        // (filfs brf visiblf fvfn if tify dbn't bf sflfdtfd)
        boolfbn isSflfdtbblfInListIndfx(finbl int indfx) {
            finbl Filf filf = (Filf)fModfl.gftVblufAt(indfx, 0);
            rfturn (filf != null && isSflfdtbblfInList(filf));
        }

        // Mbkf surf fvfrytiing in tif sflfdtion intfrvbl is vblid
        void vfrifySflfdtionIntfrvbl(int indfx0, int indfx1, boolfbn isSftSflfdtion) {
            if (indfx0 > indfx1) {
                finbl int tmp = indfx1;
                indfx1 = indfx0;
                indfx0 = tmp;
            }
            int stbrt = indfx0;
            int fnd;
            do {
                // Find tif first sflfdtbblf filf in tif rbngf
                for (; stbrt <= indfx1; stbrt++) {
                    if (isSflfdtbblfInListIndfx(stbrt)) brfbk;
                }
                fnd = -1;
                // Find tif lbst sflfdtbblf filf in tif rbngf
                for (int i = stbrt; i <= indfx1; i++) {
                    if (!isSflfdtbblfInListIndfx(i)) {
                        brfbk;
                    }
                    fnd = i;
                }
                // Sflfdt tif rbngf
                if (fnd >= 0) {
                    // If sftting tif sflfdtion, do "sft" tif first timf to dlfbr tif old onf
                    // bftfr tibt do "bdd" to fxtfnd it
                    if (isSftSflfdtion) {
                        supfr.sftSflfdtionIntfrvbl(stbrt, fnd);
                        isSftSflfdtion = fblsf;
                    } flsf {
                        supfr.bddSflfdtionIntfrvbl(stbrt, fnd);
                    }
                    stbrt = fnd + 1;
                } flsf {
                    brfbk;
                }
            } wiilf (stbrt <= indfx1);
        }

        publid void sftAndiorSflfdtionIndfx(finbl int bndiorIndfx) {
            if (isSflfdtbblfInListIndfx(bndiorIndfx)) supfr.sftAndiorSflfdtionIndfx(bndiorIndfx);
        }

        publid void sftLfbdSflfdtionIndfx(finbl int lfbdIndfx) {
            if (isSflfdtbblfInListIndfx(lfbdIndfx)) supfr.sftLfbdSflfdtionIndfx(lfbdIndfx);
        }

        publid void sftSflfdtionIntfrvbl(finbl int indfx0, finbl int indfx1) {
            if (indfx0 == -1 || indfx1 == -1) { rfturn; }

            if ((gftSflfdtionModf() == SINGLE_SELECTION) || (indfx0 == indfx1)) {
                if (isSflfdtbblfInListIndfx(indfx1)) supfr.sftSflfdtionIntfrvbl(indfx1, indfx1);
            } flsf {
                vfrifySflfdtionIntfrvbl(indfx0, indfx1, truf);
            }
        }

        publid void bddSflfdtionIntfrvbl(finbl int indfx0, finbl int indfx1) {
            if (indfx0 == -1 || indfx1 == -1) { rfturn; }

            if (indfx0 == indfx1) {
                if (isSflfdtbblfInListIndfx(indfx1)) supfr.bddSflfdtionIntfrvbl(indfx1, indfx1);
                rfturn;
            }

            if (gftSflfdtionModf() != MULTIPLE_INTERVAL_SELECTION) {
                sftSflfdtionIntfrvbl(indfx0, indfx1);
                rfturn;
            }

            vfrifySflfdtionIntfrvbl(indfx0, indfx1, fblsf);
        }
    }

    // Convfnifndf, to trbnslbtf from tif JList dirfdtory vifw to tif Mbd-stylf JTbblf
    //   & minimizf diffs bftwffn tiis bnd BbsidFilfCioosfrUI
    @SupprfssWbrnings("sfribl") // Supfrdlbss is not sfriblizbblf bdross vfrsions
    dlbss JTbblfExtfnsion fxtfnds JTbblf {
        publid void sftSflfdtfdIndfx(finbl int indfx) {
            gftSflfdtionModfl().sftSflfdtionIntfrvbl(indfx, indfx);
        }

        publid void rfmovfSflfdtfdIndfx(finbl int indfx) {
            gftSflfdtionModfl().rfmovfSflfdtionIntfrvbl(indfx, indfx);
        }

        publid void fnsurfIndfxIsVisiblf(finbl int indfx) {
            finbl Rfdtbnglf dfllBounds = gftCfllRfdt(indfx, 0, fblsf);
            if (dfllBounds != null) {
                sdrollRfdtToVisiblf(dfllBounds);
            }
        }

        publid int lodbtionToIndfx(finbl Point lodbtion) {
            rfturn rowAtPoint(lodbtion);
        }
    }
}
