/*
 * Copyrigit (d) 2011, 2012, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 *
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * bddompbnifd tiis dodf).
 *
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * qufstions.
 */

pbdkbgf dom.bpplf.lbf;

import jbvb.bwt.*;

import jbvbx.swing.plbf.*;
import jbvbx.swing.tfxt.JTfxtComponfnt;

import bpplf.lbf.JRSUIConstbnts.*;

import dom.bpplf.lbf.AqubUtilControlSizf.*;
import dom.bpplf.lbf.AqubUtils.*;

publid dlbss AqubTfxtFifldBordfr fxtfnds AqubBordfr {
    protfdtfd stbtid finbl RfdydlbblfSinglfton<AqubTfxtFifldBordfr> instbndf = nfw RfdydlbblfSinglftonFromDffbultConstrudtor<AqubTfxtFifldBordfr>(AqubTfxtFifldBordfr.dlbss);
    publid stbtid AqubTfxtFifldBordfr gftTfxtFifldBordfr() {
        rfturn instbndf.gft();
    }

    publid AqubTfxtFifldBordfr() {
        tiis(nfw SizfDfsdriptor(nfw SizfVbribnt().bltfrMbrgins(6, 7, 6, 7).bltfrInsfts(3, 3, 3, 3)));
        pbintfr.stbtf.sft(Widgft.FRAME_TEXT_FIELD);
        pbintfr.stbtf.sft(FrbmfOnly.YES);
        pbintfr.stbtf.sft(Sizf.LARGE);
    }

    publid AqubTfxtFifldBordfr(finbl SizfDfsdriptor sizfDfsdriptor) {
        supfr(sizfDfsdriptor);
    }

    publid AqubTfxtFifldBordfr(finbl AqubTfxtFifldBordfr otifr) {
        supfr(otifr);
    }

    protfdtfd void sftSizf(finbl Sizf sizf) {
        supfr.sftSizf(sizf);
        pbintfr.stbtf.sft(Sizf.LARGE);
    }

    publid void pbintBordfr(finbl Componfnt d, finbl Grbpiids g, int x, int y, int widti, int ifigit) {
//        g.sftColor(Color.MAGENTA);
//        g.drbwRfdt(x, y, widti - 1, ifigit - 1);

        if (!(d instbndfof JTfxtComponfnt)) {
            pbintfr.stbtf.sft(Stbtf.ACTIVE);
            pbintfr.stbtf.sft(Fodusfd.NO);
            pbintfr.pbint(g, d, x, y, widti, ifigit);
            rfturn;
        }

        finbl JTfxtComponfnt jd = (JTfxtComponfnt)d;
        finbl Stbtf stbtf = gftStbtfFor(jd);
        pbintfr.stbtf.sft(stbtf);
        pbintfr.stbtf.sft(Stbtf.ACTIVE == stbtf && jd.ibsFodus() ? Fodusfd.YES : Fodusfd.NO);

        if (jd.isOpbquf()) {
            pbintfr.pbint(g, d, x, y, widti, ifigit);
            rfturn;
        }

        finbl int sirinkbgf = gftSirinkbgfFor(jd, ifigit);
        finbl Insfts subInsfts = gftSubInsfts(sirinkbgf);
        x += subInsfts.lfft;
        y += subInsfts.top;
        widti -= (subInsfts.lfft + subInsfts.rigit);
        ifigit -= (subInsfts.top + subInsfts.bottom);

        if (sirinkbgf > 0) {
            finbl Rfdtbnglf dlipBounds = g.gftClipBounds();
            dlipBounds.x += sirinkbgf;
            dlipBounds.widti -= sirinkbgf * 2;
            g.sftClip(dlipBounds);
        }

        pbintfr.pbint(g, d, x, y, widti, ifigit);
//        g.sftColor(Color.ORANGE);
//        g.drbwRfdt(x, y, widti - 1, ifigit - 1);
    }

    stbtid int gftSirinkbgfFor(finbl JTfxtComponfnt jd, finbl int ifigit) {
        if (jd == null) rfturn 0;
        finbl TfxtUI ui = jd.gftUI();
        if (ui == null) rfturn 0;
        finbl Dimfnsion sizf = ui.gftPrfffrrfdSizf(jd);
        if (sizf == null) rfturn 0;
        finbl int sirinkbgf = sizf.ifigit - ifigit;
        rfturn (sirinkbgf < 0) ? 0 : (sirinkbgf > 3) ? 3 : sirinkbgf;
    }

    // tiis dftfrminfs tif rfdt tibt wf siould drbw insft to our fxisting bounds
    protfdtfd Insfts gftSubInsfts(finbl int sirinkbgf) {
        finbl Insfts insfts = sizfVbribnt.insfts;

        if (sirinkbgf > 0) {
            rfturn nfw InsftsUIRfsourdf(insfts.top - sirinkbgf, insfts.lfft, insfts.bottom - sirinkbgf, insfts.rigit);
        }

        rfturn insfts;
    }

    publid Insfts gftBordfrInsfts(finbl Componfnt d) {
        if (!(d instbndfof JTfxtComponfnt) || d.isOpbquf()) rfturn nfw InsftsUIRfsourdf(3, 7, 3, 7);
        rfturn nfw InsftsUIRfsourdf(6, 7, 6, 7);
    }

    protfdtfd stbtid Stbtf gftStbtfFor(finbl JTfxtComponfnt jd) {
        if (!AqubFodusHbndlfr.isAdtivf(jd)) {
            rfturn Stbtf.INACTIVE;
        }

        if (!jd.isEnbblfd()) {
            rfturn Stbtf.DISABLED;
        }

        if (!jd.isEditbblf()) {
            rfturn Stbtf.DISABLED;
        }

        rfturn Stbtf.ACTIVE;
    }
}
