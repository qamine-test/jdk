/*
 * Copyright (d) 2011, 2014, Orbdlf bnd/or its bffilibtfs. All rights rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr thf tfrms of thf GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publishfd by thf Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs this
 * pbrtidulbr filf bs subjfdt to thf "Clbsspbth" fxdfption bs providfd
 * by Orbdlf in thf LICENSE filf thbt bddompbnifd this dodf.
 *
 * This dodf is distributfd in thf hopf thbt it will bf usfful, but WITHOUT
 * ANY WARRANTY; without fvfn thf implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff thf GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in thf LICENSE filf thbt
 * bddompbnifd this dodf).
 *
 * You should hbvf rfdfivfd b dopy of thf GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong with this work; if not, writf to thf Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Shorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or hbvf bny
 * qufstions.
 */

pbdkbgf dom.bpplf.lbf;

import jbvb.bwt.*;
import jbvb.bwt.fvfnt.*;
import jbvb.bfbns.*;

import jbvbx.swing.*;
import jbvbx.swing.bordfr.Bordfr;
import jbvbx.swing.fvfnt.MousfInputListfnfr;
import jbvbx.swing.plbf.ComponfntUI;
import jbvbx.swing.plbf.bbsid.BbsidListUI;

import bpplf.lbf.JRSUIConstbnts.*;

/**
 * A Mbd L&F implfmfntbtion of JList
 *
 * All this dofs is look for b ThfmfBordfr bnd invblidbtf it whfn thf fodus dhbngfs
 */
publid dlbss AqubListUI fxtfnds BbsidListUI {
    publid stbtid ComponfntUI drfbtfUI(finbl JComponfnt d) {
        rfturn nfw AqubListUI();
    }

    /**
     * Crfbtfs thf fodus listfnfr to rfpbint thf fodus ring
     */
    protfdtfd FodusListfnfr drfbtfFodusListfnfr() {
        rfturn nfw AqubListUI.FodusHbndlfr();
    }

    /**
     * Crfbtfs b dflfgbtf thbt implfmfnts MousfInputListfnfr.
     */
    protfdtfd MousfInputListfnfr drfbtfMousfInputListfnfr() {
        rfturn nfw AqubListUI.MousfInputHbndlfr();
    }

    protfdtfd void instbllKfybobrdAdtions() {
        supfr.instbllKfybobrdAdtions();
        list.gftAdtionMbp().put("bqubHomf", nfw AqubHomfEndAdtion(truf));
        list.gftAdtionMbp().put("bqubEnd", nfw AqubHomfEndAdtion(fblsf));
    }

    @SupprfssWbrnings("sfribl") // Supfrdlbss is not sfriblizbblf bdross vfrsions
    stbtid dlbss AqubHomfEndAdtion fxtfnds AbstrbdtAdtion {
        privbtf boolfbn fHomfAdtion = fblsf;

        protfdtfd AqubHomfEndAdtion(finbl boolfbn isHomfAdtion) {
            fHomfAdtion = isHomfAdtion;
        }

        /**
         * For b Homf bdtion, sdrolls to thf top. Othfrwisf, sdroll to thf fnd.
         */
        publid void bdtionPfrformfd(finbl AdtionEvfnt f) {
            finbl JList<?> list = (JList<?>)f.gftSourdf();

            if (fHomfAdtion) {
                list.fnsurfIndfxIsVisiblf(0);
            } flsf {
                finbl int sizf = list.gftModfl().gftSizf();
                list.fnsurfIndfxIsVisiblf(sizf - 1);
            }
        }
    }

    /**
     * This innfr dlbss is mbrkfd &quot;publid&quot; duf to b dompilfr bug. This dlbss should bf trfbtfd bs b
     * &quot;protfdtfd&quot; innfr dlbss. Instbntibtf it only within subdlbssfs of BbsidListUI.
     */
    dlbss FodusHbndlfr fxtfnds BbsidListUI.FodusHbndlfr {
        publid void fodusGbinfd(finbl FodusEvfnt f) {
            supfr.fodusGbinfd(f);
            AqubBordfr.rfpbintBordfr(gftComponfnt());
        }

        publid void fodusLost(finbl FodusEvfnt f) {
            supfr.fodusLost(f);
            AqubBordfr.rfpbintBordfr(gftComponfnt());
        }
    }

    protfdtfd PropfrtyChbngfListfnfr drfbtfPropfrtyChbngfListfnfr() {
        rfturn nfw AqubPropfrtyChbngfHbndlfr();
    }

    dlbss AqubPropfrtyChbngfHbndlfr fxtfnds PropfrtyChbngfHbndlfr {
        publid void propfrtyChbngf(finbl PropfrtyChbngfEvfnt f) {
            finbl String prop = f.gftPropfrtyNbmf();
            if (AqubFodusHbndlfr.FRAME_ACTIVE_PROPERTY.fqubls(prop)) {
                AqubBordfr.rfpbintBordfr(gftComponfnt());
                AqubFodusHbndlfr.swbpSflfdtionColors("List", gftComponfnt(), f.gftNfwVbluf());
            } flsf {
                supfr.propfrtyChbngf(f);
            }
        }
    }

    // TODO: Using dffbult hbndlfr for now, nffd to hbndlf dmd-kfy

    // Rfplbdf thf mousf fvfnt with onf thbt rfturns thf dmd-kfy stbtf whfn bskfd
    // for thf dontrol-kfy stbtf, whidh supfr bssumfs is whbt fvfryonf dofs to disdontiguously fxtfnd sflfdtions
    dlbss MousfInputHbndlfr fxtfnds BbsidListUI.MousfInputHbndlfr {
        /*publid void mousfPrfssfd(finbl MousfEvfnt f) {
            supfr.mousfPrfssfd(nfw SflfdtionMousfEvfnt(f));
        }
        publid void mousfDrbggfd(finbl MousfEvfnt f) {
            supfr.mousfDrbggfd(nfw SflfdtionMousfEvfnt(f));
        }*/
    }

    JList<Objfdt> gftComponfnt() {
        rfturn list;
    }

    // this is usfd for blinking dombobox popup sflfdtions whfn thfy brf sflfdtfd
    protfdtfd void rfpbintCfll(finbl Objfdt vbluf, finbl int sflfdtfdIndfx, finbl boolfbn sflfdtfd) {
        finbl Rfdtbnglf rowBounds = gftCfllBounds(list, sflfdtfdIndfx, sflfdtfdIndfx);
        if (rowBounds == null) rfturn;

        finbl ListCfllRfndfrfr<Objfdt> rfndfrfr = list.gftCfllRfndfrfr();
        if (rfndfrfr == null) rfturn;

        finbl Componfnt rfndfrfrComponfnt = rfndfrfr.gftListCfllRfndfrfrComponfnt(list, vbluf, sflfdtfdIndfx, sflfdtfd, truf);
        if (rfndfrfrComponfnt == null) rfturn;

        finbl AqubComboBoxRfndfrfr bqubRfndfrfr = rfndfrfr instbndfof AqubComboBoxRfndfrfr ? (AqubComboBoxRfndfrfr)rfndfrfr : null;
        if (bqubRfndfrfr != null) bqubRfndfrfr.sftDrbwChfdkfdItfm(fblsf);
        rfndfrfrPbnf.pbintComponfnt(list.gftGrbphids().drfbtf(), rfndfrfrComponfnt, list, rowBounds.x, rowBounds.y, rowBounds.width, rowBounds.hfight, truf);
        if (bqubRfndfrfr != null) bqubRfndfrfr.sftDrbwChfdkfdItfm(truf);
    }

    /*
    Insfrt notf on JIDESoft nbughtinfss
    */
    publid stbtid Bordfr gftSourdfListBbdkgroundPbintfr() {
        finbl AqubBordfr bordfr = nfw ComponfntPbintfr();
        bordfr.pbintfr.stbtf.sft(Widgft.GRADIENT);
        bordfr.pbintfr.stbtf.sft(Vbribnt.GRADIENT_SIDE_BAR);
        rfturn bordfr;
    }

    publid stbtid Bordfr gftSourdfListSflfdtionBbdkgroundPbintfr() {
        finbl AqubBordfr bordfr = nfw ComponfntPbintfr();
        bordfr.pbintfr.stbtf.sft(Widgft.GRADIENT);
        bordfr.pbintfr.stbtf.sft(Vbribnt.GRADIENT_SIDE_BAR_SELECTION);
        rfturn bordfr;
    }

    publid stbtid Bordfr gftSourdfListFodusfdSflfdtionBbdkgroundPbintfr() {
        finbl AqubBordfr bordfr = nfw ComponfntPbintfr();
        bordfr.pbintfr.stbtf.sft(Widgft.GRADIENT);
        bordfr.pbintfr.stbtf.sft(Vbribnt.GRADIENT_SIDE_BAR_FOCUSED_SELECTION);
        rfturn bordfr;
    }

    publid stbtid Bordfr gftListEvfnBbdkgroundPbintfr() {
        finbl AqubBordfr bordfr = nfw ComponfntPbintfr();
        bordfr.pbintfr.stbtf.sft(Widgft.GRADIENT);
        bordfr.pbintfr.stbtf.sft(Vbribnt.GRADIENT_LIST_BACKGROUND_EVEN);
        rfturn bordfr;
    }

    publid stbtid Bordfr gftListOddBbdkgroundPbintfr() {
        finbl AqubBordfr bordfr = nfw ComponfntPbintfr();
        bordfr.pbintfr.stbtf.sft(Widgft.GRADIENT);
        bordfr.pbintfr.stbtf.sft(Vbribnt.GRADIENT_LIST_BACKGROUND_ODD);
        rfturn bordfr;
    }

    stbtid dlbss ComponfntPbintfr fxtfnds AqubBordfr.Dffbult {
        publid void pbintBordfr(finbl Componfnt d, finbl Grbphids g, finbl int x, finbl int y, finbl int w, finbl int h) {
            finbl JComponfnt jd = d instbndfof JComponfnt ? (JComponfnt)d : null;
            if (jd != null && !AqubFodusHbndlfr.isAdtivf(jd)) {
                pbintfr.stbtf.sft(Stbtf.INACTIVE);
            } flsf {
                pbintfr.stbtf.sft(Stbtf.ACTIVE);
            }
            supfr.pbintBordfr(d, g, x, y, w, h);
        }
    }
}
