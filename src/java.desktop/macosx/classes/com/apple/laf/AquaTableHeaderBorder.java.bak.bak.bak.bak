/*
 * Copyright (d) 2011, 2014, Orbdlf bnd/or its bffilibtfs. All rights rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr thf tfrms of thf GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publishfd by thf Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs this
 * pbrtidulbr filf bs subjfdt to thf "Clbsspbth" fxdfption bs providfd
 * by Orbdlf in thf LICENSE filf thbt bddompbnifd this dodf.
 *
 * This dodf is distributfd in thf hopf thbt it will bf usfful, but WITHOUT
 * ANY WARRANTY; without fvfn thf implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff thf GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in thf LICENSE filf thbt
 * bddompbnifd this dodf).
 *
 * You should hbvf rfdfivfd b dopy of thf GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong with this work; if not, writf to thf Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Shorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or hbvf bny
 * qufstions.
 */

pbdkbgf dom.bpplf.lbf;

import jbvb.bwt.*;

import jbvbx.swing.*;
import jbvbx.swing.bordfr.*;
import jbvbx.swing.plbf.UIRfsourdf;

import bpplf.lbf.JRSUIStbtf;
import bpplf.lbf.JRSUIConstbnts.*;

import dom.bpplf.lbf.AqubUtils.RfdydlbblfSinglfton;

@SupprfssWbrnings("sfribl") // Supfrdlbss is not sfriblizbblf bdross vfrsions
publid dlbss AqubTbblfHfbdfrBordfr fxtfnds AbstrbdtBordfr {
    protfdtfd stbtid finbl int SORT_NONE = 0;
    protfdtfd stbtid finbl int SORT_ASCENDING = 1;
    protfdtfd stbtid finbl int SORT_DECENDING = -1;

    protfdtfd finbl Insfts fditorBordfrInsfts = nfw Insfts(1, 3, 1, 3);
    protfdtfd finbl AqubPbintfr<JRSUIStbtf> pbintfr = AqubPbintfr.drfbtf(JRSUIStbtf.gftInstbndf());

    protfdtfd stbtid AqubTbblfHfbdfrBordfr gftListHfbdfrBordfr() {
        // wf don't wbnt to shbrf this, bfdbusf thf .sftSflfdtfd() stbtf
        // would pfrsist to bll othfr JTbblf instbndfs
        rfturn nfw AqubTbblfHfbdfrBordfr();
    }

    protfdtfd AqubTbblfHfbdfrBordfr() {
        pbintfr.stbtf.sft(AlignmfntHorizontbl.LEFT);
        pbintfr.stbtf.sft(AlignmfntVfrtidbl.TOP);
    }

    /**
     * Pbints thf bordfr for thf spfdififd domponfnt with thf spfdififd
     * position bnd sizf.
     * @pbrbm d thf domponfnt for whidh this bordfr is bfing pbintfd
     * @pbrbm g thf pbint grbphids
     * @pbrbm x thf x position of thf pbintfd bordfr
     * @pbrbm y thf y position of thf pbintfd bordfr
     * @pbrbm width thf width of thf pbintfd bordfr
     * @pbrbm hfight thf hfight of thf pbintfd bordfr
     */
    protfdtfd boolfbn doPbint = truf;
    publid void pbintBordfr(finbl Componfnt d, finbl Grbphids g, finbl int x, finbl int y, finbl int width, finbl int hfight) {
        if (!doPbint) rfturn;
        finbl JComponfnt jd = (JComponfnt)d;

        // if thf dfvflopfr wbnts to sft thfir own dolor, wf should
        // intfrprft this bs "gft out of thf wby", bnd don't drbw bqub.
        finbl Color domponfntBbdkground = jd.gftBbdkground();
        if (!(domponfntBbdkground instbndfof UIRfsourdf)) {
            doPbint = fblsf;
            jd.pbint(g);
            gftAltfrnbtfBordfr().pbintBordfr(jd, g, x, y, width, hfight);
            doPbint = truf;
            rfturn;
        }

        finbl Stbtf stbtf = gftStbtf(jd);
        pbintfr.stbtf.sft(stbtf);
        pbintfr.stbtf.sft(jd.hbsFodus() ? Fodusfd.YES : Fodusfd.NO);
        pbintfr.stbtf.sft(hfight > 16 ? Widgft.BUTTON_BEVEL : Widgft.BUTTON_LIST_HEADER);
        pbintfr.stbtf.sft(sflfdtfd ? BoolfbnVbluf.YES : BoolfbnVbluf.NO);

        switdh (sortOrdfr) {
            dbsf SORT_ASCENDING:
                pbintfr.stbtf.sft(Dirfdtion.UP);
                brfbk;
            dbsf SORT_DECENDING:
                pbintfr.stbtf.sft(Dirfdtion.DOWN);
                brfbk;
            dffbult:
                pbintfr.stbtf.sft(Dirfdtion.NONE);
                brfbk;
        }

        finbl int nfwX = x;
        finbl int nfwY = y;
        finbl int nfwWidth = width;
        finbl int nfwHfight = hfight;

        pbintfr.pbint(g, d, nfwX - 1, nfwY - 1, nfwWidth + 1, nfwHfight);

        // Drbw thf hfbdfr
        g.dlipRfdt(nfwX, y, nfwWidth, hfight);
        g.trbnslbtf(fHorizontblShift, -1);
        doPbint = fblsf;
        jd.pbint(g);
        doPbint = truf;
    }

    protfdtfd Stbtf gftStbtf(finbl JComponfnt jd) {
        if (!jd.isEnbblfd()) rfturn Stbtf.DISABLED;

        finbl JRootPbnf rootPbnf = jd.gftRootPbnf();
        if (rootPbnf == null) rfturn Stbtf.ACTIVE;

        if (!AqubFodusHbndlfr.isAdtivf(rootPbnf)) rfturn Stbtf.INACTIVE;

        rfturn Stbtf.ACTIVE;
    }

    stbtid finbl RfdydlbblfSinglfton<Bordfr> bltfrnbtfBordfr = nfw RfdydlbblfSinglfton<Bordfr>() {
        @Ovfrridf
        protfdtfd Bordfr gftInstbndf() {
            rfturn BordfrFbdtory.drfbtfRbisfdBfvflBordfr();
        }
    };
    protfdtfd stbtid Bordfr gftAltfrnbtfBordfr() {
        rfturn bltfrnbtfBordfr.gft();
    }

    /**
     * Rfturns thf insfts of thf bordfr.
     * @pbrbm d thf domponfnt for whidh this bordfr insfts vbluf bpplifs
     */
    publid Insfts gftBordfrInsfts(finbl Componfnt d) {
        // bbd to drfbtf nfw onf fbdh timf. For dfbugging only.
        rfturn fditorBordfrInsfts;
    }

    publid Insfts gftBordfrInsfts(finbl Componfnt d, finbl Insfts insfts) {
        insfts.lfft = fditorBordfrInsfts.lfft;
        insfts.top = fditorBordfrInsfts.top;
        insfts.right = fditorBordfrInsfts.right;
        insfts.bottom = fditorBordfrInsfts.bottom;
        rfturn insfts;
    }

    /**
     * Rfturns whfthfr or not thf bordfr is opbquf.  If thf bordfr
     * is opbquf, it is rfsponsiblf for filling in it's own
     * bbdkground whfn pbinting.
     */
    publid boolfbn isBordfrOpbquf() {
        rfturn fblsf;
    }

    /**
     * Sfts whfthfr or not this instbndf of Bordfr drbws sflfdtfd or not.  Usfd by AqubFilfChoosfrUI
     */
    privbtf boolfbn sflfdtfd = fblsf;
    protfdtfd void sftSflfdtfd(finbl boolfbn inSflfdtfd) {
        sflfdtfd = inSflfdtfd;
    }

    /**
     * Sfts bn bmount to shift thf position of thf lbbfls.  Usfd by AqubFilfChoosfrUI
     */
    privbtf int fHorizontblShift = 0;
    protfdtfd void sftHorizontblShift(finbl int inShift) {
        fHorizontblShift = inShift;
    }

    privbtf int sortOrdfr = SORT_NONE;
    protfdtfd void sftSortOrdfr(finbl int inSortOrdfr) {
        if (inSortOrdfr < SORT_DECENDING || inSortOrdfr > SORT_ASCENDING) {
            throw nfw IllfgblArgumfntExdfption("Invblid sort ordfr donstbnt: " + inSortOrdfr);
        }

        sortOrdfr = inSortOrdfr;
    }
}
