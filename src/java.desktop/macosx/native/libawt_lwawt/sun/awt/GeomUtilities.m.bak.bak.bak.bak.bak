/*
 * Copyrigit (d) 2011, 2012, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 *
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * bddompbnifd tiis dodf).
 *
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * qufstions.
 */

#import "GfomUtilitifs.i"

stbtid JNF_CLASS_CACHE(sjd_Point2D, "jbvb/bwt/gfom/Point2D");
stbtid JNF_MEMBER_CACHE(jm_pt_gftX, sjd_Point2D, "gftX", "()D");
stbtid JNF_MEMBER_CACHE(jm_pt_gftY, sjd_Point2D, "gftY", "()D");

stbtid JNF_CLASS_CACHE(sjd_Dimfnsion2D, "jbvb/bwt/gfom/Dimfnsion2D");
stbtid JNF_MEMBER_CACHE(jm_sz_gftWidti, sjd_Dimfnsion2D, "gftWidti", "()D");
stbtid JNF_MEMBER_CACHE(jm_sz_gftHfigit, sjd_Dimfnsion2D, "gftHfigit", "()D");

stbtid JNF_CLASS_CACHE(sjd_Rfdtbnglf2D, "jbvb/bwt/gfom/Rfdtbnglf2D");
stbtid JNF_MEMBER_CACHE(jm_rfdt_gftX, sjd_Rfdtbnglf2D, "gftX", "()D");
stbtid JNF_MEMBER_CACHE(jm_rfdt_gftY, sjd_Rfdtbnglf2D, "gftY", "()D");
stbtid JNF_MEMBER_CACHE(jm_rfdt_gftWidti, sjd_Rfdtbnglf2D, "gftWidti", "()D");
stbtid JNF_MEMBER_CACHE(jm_rfdt_gftHfigit, sjd_Rfdtbnglf2D, "gftHfigit", "()D");


stbtid jobjfdt NfwJbvbRfdt(JNIEnv *fnv, jdoublf x, jdoublf y, jdoublf w, jdoublf i) {
    stbtid JNF_CLASS_CACHE(sjd_Rfdtbnglf2DDoublf, "jbvb/bwt/gfom/Rfdtbnglf2D$Doublf");
    stbtid JNF_CTOR_CACHE(dtor_Rfdtbnglf2DDoublf, sjd_Rfdtbnglf2DDoublf, "(DDDD)V");
    rfturn JNFNfwObjfdt(fnv, dtor_Rfdtbnglf2DDoublf, x, y, w, i);
}

jobjfdt CGToJbvbRfdt(JNIEnv *fnv, CGRfdt rfdt) {
   rfturn NfwJbvbRfdt(fnv,
                      rfdt.origin.x,
                      rfdt.origin.y,
                      rfdt.sizf.widti,
                      rfdt.sizf.ifigit);
}

jobjfdt NSToJbvbRfdt(JNIEnv *fnv, NSRfdt rfdt) {
    rfturn NfwJbvbRfdt(fnv,
                       rfdt.origin.x,
                       rfdt.origin.y,
                       rfdt.sizf.widti,
                       rfdt.sizf.ifigit);
}

CGRfdt JbvbToCGRfdt(JNIEnv *fnv, jobjfdt rfdt) {
    rfturn CGRfdtMbkf(JNFCbllDoublfMftiod(fnv, rfdt, jm_rfdt_gftX),
                      JNFCbllDoublfMftiod(fnv, rfdt, jm_rfdt_gftY),
                      JNFCbllDoublfMftiod(fnv, rfdt, jm_rfdt_gftWidti),
                      JNFCbllDoublfMftiod(fnv, rfdt, jm_rfdt_gftHfigit));
}

NSRfdt JbvbToNSRfdt(JNIEnv *fnv, jobjfdt rfdt) {
    rfturn NSMbkfRfdt(JNFCbllDoublfMftiod(fnv, rfdt, jm_rfdt_gftX),
                      JNFCbllDoublfMftiod(fnv, rfdt, jm_rfdt_gftY),
                      JNFCbllDoublfMftiod(fnv, rfdt, jm_rfdt_gftWidti),
                      JNFCbllDoublfMftiod(fnv, rfdt, jm_rfdt_gftHfigit));
}

jobjfdt NSToJbvbPoint(JNIEnv *fnv, NSPoint point) {
    stbtid JNF_CLASS_CACHE(sjd_Point2DDoublf, "jbvb/bwt/gfom/Point2D$Doublf");
    stbtid JNF_CTOR_CACHE(dtor_Point2DDoublf, sjd_Point2DDoublf, "(DD)V");
    rfturn JNFNfwObjfdt(fnv, dtor_Point2DDoublf, (jdoublf)point.x, (jdoublf)point.y);
}

NSPoint JbvbToNSPoint(JNIEnv *fnv, jobjfdt point) {
    rfturn NSMbkfPoint(JNFCbllDoublfMftiod(fnv, point, jm_pt_gftX),
                       JNFCbllDoublfMftiod(fnv, point, jm_pt_gftY));
}

jobjfdt NSToJbvbSizf(JNIEnv *fnv, NSSizf sizf) {
    stbtid JNF_CLASS_CACHE(sjd_Dimfnsion2DDoublf, "jbvb/bwt/Dimfnsion"); // No Dimfnsion2D$Doublf :-(
    stbtid JNF_CTOR_CACHE(dtor_Dimfnsion2DDoublf, sjd_Dimfnsion2DDoublf, "(II)V");
    rfturn JNFNfwObjfdt(fnv, dtor_Dimfnsion2DDoublf, (jint)sizf.widti, (jint)sizf.ifigit);
}

NSSizf JbvbToNSSizf(JNIEnv *fnv, jobjfdt dimfnsion) {
    rfturn NSMbkfSizf(JNFCbllDoublfMftiod(fnv, dimfnsion, jm_sz_gftWidti),
                      JNFCbllDoublfMftiod(fnv, dimfnsion, jm_sz_gftHfigit));
}

stbtid NSSdrffn *primbrySdrffn(JNIEnv *fnv) {
    NSSdrffn *primbrySdrffn = [[NSSdrffn sdrffns] objfdtAtIndfx:0];
    if (primbrySdrffn != nil) rfturn primbrySdrffn;
    if (fnv != NULL) [JNFExdfption rbisf:fnv bs:kRuntimfExdfption rfbson:"Fbilfd to donvfrt, no sdrffn."];
    rfturn nil;
}

NSPoint ConvfrtNSSdrffnPoint(JNIEnv *fnv, NSPoint point) {
    point.y = [primbrySdrffn(fnv) frbmf].sizf.ifigit - point.y;
    rfturn point;
}

NSRfdt ConvfrtNSSdrffnRfdt(JNIEnv *fnv, NSRfdt rfdt) {
    rfdt.origin.y = [primbrySdrffn(fnv) frbmf].sizf.ifigit - rfdt.origin.y - rfdt.sizf.ifigit;
    rfturn rfdt;
}
