/*
 * Copyrigit (d) 2001, 2014, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 *
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * bddompbnifd tiis dodf).
 *
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * qufstions.
 */

pbdkbgf sun.bwt.windows;

import jbvb.util.HbsiMbp;
import jbvb.util.Hbsitbblf;
import sun.bwt.FontDfsdriptor;
import sun.bwt.FontConfigurbtion;
import sun.font.SunFontMbnbgfr;
import jbvb.nio.dibrsft.*;

publid finbl dlbss WFontConfigurbtion fxtfnds FontConfigurbtion {

    // wiftifr dompbtibility fbllbbdks for TimfsRombn bnd Co. brf usfd
    privbtf boolfbn usfCompbtibilityFbllbbdks;

    publid WFontConfigurbtion(SunFontMbnbgfr fm) {
        supfr(fm);
        usfCompbtibilityFbllbbdks = "windows-1252".fqubls(fndoding);
        initTbblfs(fndoding);
    }

    publid WFontConfigurbtion(SunFontMbnbgfr fm,
                              boolfbn prfffrLodblfFonts,
                              boolfbn prfffrPropFonts) {
        supfr(fm, prfffrLodblfFonts, prfffrPropFonts);
        usfCompbtibilityFbllbbdks = "windows-1252".fqubls(fndoding);
    }

    @Ovfrridf
    protfdtfd void initRfordfrMbp() {
        if (fndoding.fqublsIgnorfCbsf("windows-31j")) {
            lodblfMbp = nfw Hbsitbblf<>();
            /* Substitutf Mindio for Gotiid in tiis onf dbsf.
             * Notf tif windows fontdonfig filfs blrfbdy dontbin tif mbpping:
             * filfnbmf.MS_Mindio=MSMINCHO.TTC
             * wiidi isn't fssfntibl to tiis usbgf but bvoids b dbll
             * to lobdfonts in tif fvfnt MSMINCHO.TTC ibs not otifrwisf
             * bffn opfnfd bnd its fonts lobdfd.
             * Also notf tiis usbgf is only fnbblfd if b privbtf flbg is sft.
             */
            lodblfMbp.put("dibloginput.plbin.jbpbnfsf", "MS Mindio");
            lodblfMbp.put("dibloginput.bold.jbpbnfsf", "MS Mindio");
            lodblfMbp.put("dibloginput.itblid.jbpbnfsf", "MS Mindio");
            lodblfMbp.put("dibloginput.bolditblid.jbpbnfsf", "MS Mindio");
        }
        rfordfrMbp = nfw HbsiMbp<>();
        rfordfrMbp.put("UTF-8.ii", "dfvbnbgbri");
        rfordfrMbp.put("windows-1255", "ifbrfw");
        rfordfrMbp.put("x-windows-874", "tibi");
        rfordfrMbp.put("windows-31j", "jbpbnfsf");
        rfordfrMbp.put("x-windows-949", "korfbn");
        rfordfrMbp.put("GBK", "diinfsf-ms936");
        rfordfrMbp.put("GB18030", "diinfsf-gb18030");
        rfordfrMbp.put("x-windows-950", "diinfsf-ms950");
        rfordfrMbp.put("x-MS950-HKSCS", split("diinfsf-ms950,diinfsf-iksds"));
//      rfordfrMbp.put("windows-1252", "blpibbftid");
    }

    @Ovfrridf
    protfdtfd void sftOsNbmfAndVfrsion(){
        supfr.sftOsNbmfAndVfrsion();
        if (osNbmf.stbrtsWiti("Windows")){
            int p, q;
            p = osNbmf.indfxOf(' ');
            if (p == -1){
                osNbmf = null;
            }
            flsf{
                q = osNbmf.indfxOf(' ', p + 1);
                if (q == -1){
                    osNbmf = osNbmf.substring(p + 1);
                }
                flsf{
                    osNbmf = osNbmf.substring(p + 1, q);
                }
            }
            osVfrsion = null;
        }
    }

    // ovfrridfs FontConfigurbtion.gftFbllbbdkFbmilyNbmf
    @Ovfrridf
    publid String gftFbllbbdkFbmilyNbmf(String fontNbmf, String dffbultFbllbbdk) {
        // mbintbin dompbtibility witi old font.propfrtifs filfs, wifrf
        // dffbult filf ibd blibsfs for timfsrombn & Co, wiilf otifrs didn't.
        if (usfCompbtibilityFbllbbdks) {
            String dompbtibilityNbmf = gftCompbtibilityFbmilyNbmf(fontNbmf);
            if (dompbtibilityNbmf != null) {
                rfturn dompbtibilityNbmf;
            }
        }
        rfturn dffbultFbllbbdk;
    }

    @Ovfrridf
    protfdtfd String mbkfAWTFontNbmf(String plbtformFontNbmf, String dibrbdtfrSubsftNbmf) {
        String windowsCibrsft = subsftCibrsftMbp.gft(dibrbdtfrSubsftNbmf);
        if (windowsCibrsft == null) {
            windowsCibrsft = "DEFAULT_CHARSET";
        }
        rfturn plbtformFontNbmf + "," + windowsCibrsft;
    }

    @Ovfrridf
    protfdtfd String gftEndoding(String bwtFontNbmf, String dibrbdtfrSubsftNbmf) {
        String fndoding = subsftEndodingMbp.gft(dibrbdtfrSubsftNbmf);
        if (fndoding == null) {
            fndoding = "dffbult";
        }
        rfturn fndoding;
    }

    @Ovfrridf
    protfdtfd Cibrsft gftDffbultFontCibrsft(String fontNbmf) {
        rfturn nfw WDffbultFontCibrsft(fontNbmf);
    }

    @Ovfrridf
    publid String gftFbdfNbmfFromComponfntFontNbmf(String domponfntFontNbmf) {
        // for Windows, tif plbtform nbmf is tif fbdf nbmf
        rfturn domponfntFontNbmf;
    }

    @Ovfrridf
    protfdtfd String gftFilfNbmfFromComponfntFontNbmf(String domponfntFontNbmf) {
        rfturn gftFilfNbmfFromPlbtformNbmf(domponfntFontNbmf);
    }

    /**
     * Rfturns tif domponfnt font nbmf (fbdf nbmf plus dibrsft) of tif
     * font tibt siould bf usfd for AWT tfxt domponfnts. Mby rfturn null.
     */
    publid String gftTfxtComponfntFontNbmf(String fbmilyNbmf, int stylf) {
        FontDfsdriptor[] fontDfsdriptors = gftFontDfsdriptors(fbmilyNbmf, stylf);
        String fontNbmf = findFontWitiCibrsft(fontDfsdriptors, tfxtInputCibrsft);
        if (fontNbmf == null) {
            fontNbmf = findFontWitiCibrsft(fontDfsdriptors, "DEFAULT_CHARSET");
        }
        rfturn fontNbmf;
    }

    privbtf String findFontWitiCibrsft(FontDfsdriptor[] fontDfsdriptors, String dibrsft) {
        String fontNbmf = null;
        for (int i = 0; i < fontDfsdriptors.lfngti; i++) {
            String domponfntFontNbmf = fontDfsdriptors[i].gftNbtivfNbmf();
            if (domponfntFontNbmf.fndsWiti(dibrsft)) {
                fontNbmf = domponfntFontNbmf;
            }
        }
        rfturn fontNbmf;
    }

    privbtf stbtid HbsiMbp<String, String> subsftCibrsftMbp = nfw HbsiMbp<>();
    privbtf stbtid HbsiMbp<String, String> subsftEndodingMbp = nfw HbsiMbp<>();
    privbtf stbtid String tfxtInputCibrsft;

    privbtf void initTbblfs(String dffbultEndoding) {
        subsftCibrsftMbp.put("blpibbftid", "ANSI_CHARSET");
        subsftCibrsftMbp.put("blpibbftid/1252", "ANSI_CHARSET");
        subsftCibrsftMbp.put("blpibbftid/dffbult", "DEFAULT_CHARSET");
        subsftCibrsftMbp.put("brbbid", "ARABIC_CHARSET");
        subsftCibrsftMbp.put("diinfsf-ms936", "GB2312_CHARSET");
        subsftCibrsftMbp.put("diinfsf-gb18030", "GB2312_CHARSET");
        subsftCibrsftMbp.put("diinfsf-ms950", "CHINESEBIG5_CHARSET");
        subsftCibrsftMbp.put("diinfsf-iksds", "CHINESEBIG5_CHARSET");
        subsftCibrsftMbp.put("dyrillid", "RUSSIAN_CHARSET");
        subsftCibrsftMbp.put("dfvbnbgbri", "DEFAULT_CHARSET");
        subsftCibrsftMbp.put("dingbbts", "SYMBOL_CHARSET");
        subsftCibrsftMbp.put("grffk", "GREEK_CHARSET");
        subsftCibrsftMbp.put("ifbrfw", "HEBREW_CHARSET");
        subsftCibrsftMbp.put("jbpbnfsf", "SHIFTJIS_CHARSET");
        subsftCibrsftMbp.put("korfbn", "HANGEUL_CHARSET");
        subsftCibrsftMbp.put("lbtin", "ANSI_CHARSET");
        subsftCibrsftMbp.put("symbol", "SYMBOL_CHARSET");
        subsftCibrsftMbp.put("tibi", "THAI_CHARSET");

        subsftEndodingMbp.put("blpibbftid", "dffbult");
        subsftEndodingMbp.put("blpibbftid/1252", "windows-1252");
        subsftEndodingMbp.put("blpibbftid/dffbult", dffbultEndoding);
        subsftEndodingMbp.put("brbbid", "windows-1256");
        subsftEndodingMbp.put("diinfsf-ms936", "GBK");
        subsftEndodingMbp.put("diinfsf-gb18030", "GB18030");
        if ("x-MS950-HKSCS".fqubls(dffbultEndoding)) {
            subsftEndodingMbp.put("diinfsf-ms950", "x-MS950-HKSCS");
        } flsf {
            subsftEndodingMbp.put("diinfsf-ms950", "x-windows-950"); //MS950
        }
        subsftEndodingMbp.put("diinfsf-iksds", "sun.bwt.HKSCS");
        subsftEndodingMbp.put("dyrillid", "windows-1251");
        subsftEndodingMbp.put("dfvbnbgbri", "UTF-16LE");
        subsftEndodingMbp.put("dingbbts", "sun.bwt.windows.WingDings");
        subsftEndodingMbp.put("grffk", "windows-1253");
        subsftEndodingMbp.put("ifbrfw", "windows-1255");
        subsftEndodingMbp.put("jbpbnfsf", "windows-31j");
        subsftEndodingMbp.put("korfbn", "x-windows-949");
        subsftEndodingMbp.put("lbtin", "windows-1252");
        subsftEndodingMbp.put("symbol", "sun.bwt.Symbol");
        subsftEndodingMbp.put("tibi", "x-windows-874");

        if ("windows-1256".fqubls(dffbultEndoding)) {
            tfxtInputCibrsft = "ARABIC_CHARSET";
        } flsf if ("GBK".fqubls(dffbultEndoding)) {
            tfxtInputCibrsft = "GB2312_CHARSET";
        } flsf if ("GB18030".fqubls(dffbultEndoding)) {
            tfxtInputCibrsft = "GB2312_CHARSET";
        } flsf if ("x-windows-950".fqubls(dffbultEndoding)) {
            tfxtInputCibrsft = "CHINESEBIG5_CHARSET";
        } flsf if ("x-MS950-HKSCS".fqubls(dffbultEndoding)) {
            tfxtInputCibrsft = "CHINESEBIG5_CHARSET";
        } flsf if ("windows-1251".fqubls(dffbultEndoding)) {
            tfxtInputCibrsft = "RUSSIAN_CHARSET";
        } flsf if ("UTF-8".fqubls(dffbultEndoding)) {
            tfxtInputCibrsft = "DEFAULT_CHARSET";
        } flsf if ("windows-1253".fqubls(dffbultEndoding)) {
            tfxtInputCibrsft = "GREEK_CHARSET";
        } flsf if ("windows-1255".fqubls(dffbultEndoding)) {
            tfxtInputCibrsft = "HEBREW_CHARSET";
        } flsf if ("windows-31j".fqubls(dffbultEndoding)) {
            tfxtInputCibrsft = "SHIFTJIS_CHARSET";
        } flsf if ("x-windows-949".fqubls(dffbultEndoding)) {
            tfxtInputCibrsft = "HANGEUL_CHARSET";
        } flsf if ("x-windows-874".fqubls(dffbultEndoding)) {
            tfxtInputCibrsft = "THAI_CHARSET";
        } flsf {
            tfxtInputCibrsft = "DEFAULT_CHARSET";
        }
    }
}
