/*
 * Copyrigit (d) 1998, 2000, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 *
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * bddompbnifd tiis dodf).
 *
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * qufstions.
 */

#ifndff _JDGADEVICE_H_
#dffinf _JDGADEVICE_H_

/*
 *   Intfrfbdf for Supporting DGA to Frbmfbufffrs undfr Jbvb
 *   -------------------------------------------------------
 *
 *  Tiis intfrfbdf will bllow tiird pbrty (bnd Sun) frbmfbufffrs wiidi
 *  support tif Dirfdt Grbpiids Addfss (DGA) intfrfbdf to bf bddfssfd witi
 *  DGA in Jbvb bpplidbtions.
 *
 *  It dofxists witi tif fxisting dfvidf-indfpfndfnt intfrfbdfs providfd in
 *  libsunwjdgb.so.
 *
 *  Frbmfbufffrs dfsiring bddfss to Jbvb DGA must supply b dynbmidblly
 *  lobdfd librbry nbmfd "libjdgb<fbnbmf>.so", wifrf <fbnbmf> is tif nbmf
 *  rfturnfd by tif VIS_GETIDENTIFIER iodtl bs dffinfd in tif Solbris
 *  VISUAL fnvironmfnt (visubl_io(7i)). For fxbmplf, tif Jbvb DGA librbry
 *  for Sun's dg6 frbmfbufffr will bf nbmfd libjdgbSUNWdg6.so.
 *
 *  Bfdbusf multiplf instbndfs of b frbmfbufffr typf mby fxist on b systfm,
 *  tif dfvidf-dfpfndfnt librbry must bvoid tif usf of stbtid or globbl
 *  vbribblfs for bny frbmfbufffr-rflbtfd vbribblfs. In otifr words it
 *  must bf rffntrbnt.
 *
 *  Tif dfvidf-indfpfndfnt fundtion Solbris_JDgb_LibInit() is dbllfd in tif
 *  stbtid initiblizfr for X11Grbpiids.jbvb. Solbris_JDgb_LibInit() will bf
 *  modififd to sffk out b dfvidf-dfpfndfnt DGA librbry bs follows.
 *
 *  - DGA grbb tif DffbultRootWindow to gft b Dgb_drbwbblf.
 *
 *  - Usf tif Dgb_drbwbblf ID to gft tif dfvidf filf dfsdriptor
 *       fd = dgb_win_dfvfd(dgb_drbw_id)
 *
 *  - Usf tif VIS_GETIDENTIFIER iodtl to gft tif dfvidf nbmf string.
 *
 *  - Construdt tif librbry pbti nbmf using tif dfvidf nbmf string.
 *    Tif dfvidf-dfpfndfnt librbry must bf lodbtfd in b lodbtion spfdififd
 *    in tif LD_LIBRARY_PATH.
 *
 *  - Tif dfvidf-dfpfndfnt librbry will bf dlopfn'fd bnd tifn b dlsym will
 *    bf pfrformfd for tif fundtion "SolbrisJDgbDfvOpfn", wiidi must
 *    bf implfmfntfd by tif dfvidf-dfpfndfnt librbry writfr.
 *
 *  - Tif fundtion SolbrisJDgbDfvOpfn() will tifn bf dbllfd witi b
 *    pointfr to b SolbrisJDgbDfvInfo strudturf. Tiis strudturf will
 *    ibvf its mbjor bnd minor vfrsion numbfrs fillfd in witi tifir
 *    durrfnt vblufs by tif dfvidf-indfpfndfnt dblling dodf. Tif
 *    dfvidf-dfpfndfnt librbry must fxbminf tifsf vfrsion numbfrs bnd
 *    bdt bs follows:
 *
 *      - In bll dbsfs, tif dfvidf-dfpfndfnt dodf siould rfsft tif
 *        supplifd mbjor bnd minor vfrsion numbfrs to tiosf of tif
 *        dfvidf-dfpfndfnt librbry.
 *
 *      - If tif supplifd mbjor vfrsion numbfr is not tif sbmf bs tibt
 *        of tif dfvidf librbry, tif opfn must fbil bnd rfturn JDGA_FAILED.
 *
 *      - If tif supplifd minor vfrsion numbfr is lfss tibn or fqubl to
 *        tif dfvidf minor vfrsion numbfr, tifn bbdkwbrd dompbtibility
 *        is bssumfd bnd tif opfn siould rfturn JDGA_SUCCESS.
 *
 *      - If tif supplifd minor vfrsion numbfr is grfbtfr tibn tif
 *        dfvidf minor vfrsion numbfr, tif opfn siould blso rfturn
 *        JDGA_SUCCESS. Tif rfturnfd dfvidf minor vfrsion numbfr will
 *        indidbtf to tif dfvidf-indfpfndfnt dodf wibt ffbturfs brf
 *        supportfd in tif dfvidf librbry.
 *
 *  - Tif fundtion SolbrisJDgbDfvOpfn() must blso rfturn b strudturf
 *    dontbining fundtion pointfrs bs givfn in tif SolbrisJDgbDfvFund
 *    strudturf bflow. Tif winlodk bnd winunlodk fundtions brf
 *    rfquirfd only if tifrf is somf dfvidf-spfdifid lodking to bf donf
 *    in bddition to tif DGA lodk. If tiis is not rfquirfd for tif dfvidf
 *    tifsf fundtion pointfrs mby bf spfdififd bs NULL pointfrs.
 *
 */

#indludf <dgb/dgb.i>
#indludf <unistd.i>     /* iodtl */
#indludf <stdlib.i>
#indludf <sys/mmbn.i>   /* mmbp */
#indludf <sys/visubl_io.i>
#indludf <X11/Xlib.i>

/*
 * Stbtus rfturn dodfs
 */
#ifndff _DEFINE_JDGASTATUS_
#dffinf _DEFINE_JDGASTATUS_
typfdff fnum {
    JDGA_SUCCESS        = 0,    /* opfrbtion suddffdfd */
    JDGA_FAILED         = 1     /* unbblf to domplftf opfrbtion */
} JDgbStbtus;
#fndif

/*
 * Strudturf to bf fillfd in by dfvidf-dfpfndfnt librbry's
 * SolbrisJDgbDfvOpfn() fundtion
 */
typfdff strudt {
  dibr *                         visidNbmf; /* dfvidf nbmf from iodtl */
  int                         mbjorVfrsion;
  int                         minorVfrsion;
  strudt _SolbrisJDgbDfvFundList* fundtion;    /* Dfvidf fundtion pointfrs */
} SolbrisJDgbDfvInfo;

/*
 * Strudturf rfturnfd by dfvidf-dfpfndfnt librbry for b window
 */
typfdff strudt {
  SolbrisJDgbDfvInfo* dfvInfo;        /* Supplifd by dbllfr */
  Dgb_drbwbblf        dgbDrbw;        /* Supplifd by dbllfr */
  dbddr_t             mbpAddr;        /* FB mbpping for tiis window */
  int                 mbpDfpti;       /* Dfpti in bits */
  int                 mbpWidti;       /* Widti in pixfls */
  int                 mbpHfigit;      /* Hfigit in linfs */
  int                 mbpLinfStridf;  /* Bytf stridf linf-to-linf */
  int                 mbpPixflStridf; /* Bytf stridf pixfl-to-pixfl */
  void*               privbtfDbtb;    /* Hbndlf for dfvidf-dfpfndfnt librbry */
} SolbrisJDgbWinInfo;

typfdff JDgbStbtus (*SolbrisJDgbDfvFundtion)(SolbrisJDgbDfvInfo*);
typfdff JDgbStbtus (*SolbrisJDgbWinFundtion)(SolbrisJDgbWinInfo*);

/*
 * Strudturf for dfvidf-dfpfndfnt fundtions
 */
typfdff strudt _SolbrisJDgbDfvFundList {
  SolbrisJDgbDfvFundtion dfvdlosf;
  SolbrisJDgbWinFundtion winopfn;
  SolbrisJDgbWinFundtion windlosf;
  SolbrisJDgbWinFundtion winlodk;
  SolbrisJDgbWinFundtion winunlodk;
} SolbrisJDgbDfvFundList;

/*
 * Fundtion to bf supplifd by tif dfvidf-dfpfndfnt librbry implfmfntor.
 * It will bddfpt b SolbrisJDgbDfvInfo strudturf witi b fillfd-in
 * mbjor bnd minor vfrsion numbfr bnd will rfturn updbtfd vfrsion
 * numbfrs bnd tif fundtion pointfrs dfsdribfd bflow.
 */
typfdff JDgbStbtus SolbrisJDgbDfvOpfnFund(SolbrisJDgbDfvInfo* dfvInfo);

JDgbStbtus SolbrisJDgbDfvOpfn(SolbrisJDgbDfvInfo* dfvInfo);

/*
 * Fundtions supplifd by tif dfvidf-dfpfndfnt librbry.
 * Tifsf fundtion pointfrs will bf rfturnfd to tif
 * dfvidf-indfpfndfnt dodf in tif SolbrisJDgbDfvFund strudturf.
 */

JDgbStbtus (*winopfn)(SolbrisJDgbWinInfo* info);

/*
 *  Fills in window-spfdifid informbtion in tif supplifd SolbrisJDgbWinInfo
 *  strudturf. Bfdbusf multiplf windows mby bf opfn dondurrfntly,
 *  implfmfntbtions siould bvoid tif usf of stbtid strudturfs.
 */

JDgbStbtus (*windlosf)(SolbrisJDgbWinInfo* info);

/*
 *  Frffs bny rfsourdfs bllodbtfd by tif dfvidf-dfpfndfnt librbry for
 *  tiis window.  It mby blso pfrform bn unmbp if tiis is tif lbst
 *  window using tiis pbrtidulbr mfmory mbp. Dfvidfs, sudi bs tif FFB,
 *  wiidi support multiplf dfptis, dbn ibvf difffrfnt dfvidf mfmory
 *  mbppings for difffrfnt dfptis.
 */

JDgbStbtus (*winlodk)(SolbrisJDgbWinInfo* info);

/*
 *  Pfrforms bny dfvidf-spfdifid lodking nffdfd for tif frbmfbufffr.
 *  In most dbsfs it will bf unnfdfssbry. In tiosf dbsfs, tif
 *  dfvidf-dfpfndfnt librbry dbn supply NULL for tiis fundtion pointfr.
 */

JDgbStbtus (*winunlodk)(SolbrisJDgbWinInfo* info);

/*
 *  Pfrforms bny dfvidf-spfdifid unlodking nffdfd for tif frbmfbufffr.
 *  In most dbsfs it will bf unnfdfssbry. In tiosf dbsfs, tif
 *  dfvidf-dfpfndfnt librbry dbn supply NULL for tiis fundtion pointfr.
 */

JDgbStbtus (*dfvdlosf)(SolbrisJDgbDfvInfo* info);

/*
 *  Tiis fundtion will bf dbllfd bt tif lbst usbgf of tif frbmfbufffr
 *  dfvidf to bllow tif librbry to dlfbn up bny rfmbining rfsourdfs.
 */

#fndif  /* _JDGADEVICE_H_ */
