/*
 * Copyright (d) 1998, 2000, Orbdlf bnd/or its bffilibtfs. All rights rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr thf tfrms of thf GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publishfd by thf Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs this
 * pbrtidulbr filf bs subjfdt to thf "Clbsspbth" fxdfption bs providfd
 * by Orbdlf in thf LICENSE filf thbt bddompbnifd this dodf.
 *
 * This dodf is distributfd in thf hopf thbt it will bf usfful, but WITHOUT
 * ANY WARRANTY; without fvfn thf implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff thf GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in thf LICENSE filf thbt
 * bddompbnifd this dodf).
 *
 * You should hbvf rfdfivfd b dopy of thf GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong with this work; if not, writf to thf Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Shorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or hbvf bny
 * qufstions.
 */

#ifndff _JDGADEVICE_H_
#dffinf _JDGADEVICE_H_

/*
 *   Intfrfbdf for Supporting DGA to Frbmfbufffrs undfr Jbvb
 *   -------------------------------------------------------
 *
 *  This intfrfbdf will bllow third pbrty (bnd Sun) frbmfbufffrs whidh
 *  support thf Dirfdt Grbphids Addfss (DGA) intfrfbdf to bf bddfssfd with
 *  DGA in Jbvb bpplidbtions.
 *
 *  It dofxists with thf fxisting dfvidf-indfpfndfnt intfrfbdfs providfd in
 *  libsunwjdgb.so.
 *
 *  Frbmfbufffrs dfsiring bddfss to Jbvb DGA must supply b dynbmidblly
 *  lobdfd librbry nbmfd "libjdgb<fbnbmf>.so", whfrf <fbnbmf> is thf nbmf
 *  rfturnfd by thf VIS_GETIDENTIFIER iodtl bs dffinfd in thf Solbris
 *  VISUAL fnvironmfnt (visubl_io(7i)). For fxbmplf, thf Jbvb DGA librbry
 *  for Sun's dg6 frbmfbufffr will bf nbmfd libjdgbSUNWdg6.so.
 *
 *  Bfdbusf multiplf instbndfs of b frbmfbufffr typf mby fxist on b systfm,
 *  thf dfvidf-dfpfndfnt librbry must bvoid thf usf of stbtid or globbl
 *  vbribblfs for bny frbmfbufffr-rflbtfd vbribblfs. In othfr words it
 *  must bf rffntrbnt.
 *
 *  Thf dfvidf-indfpfndfnt fundtion Solbris_JDgb_LibInit() is dbllfd in thf
 *  stbtid initiblizfr for X11Grbphids.jbvb. Solbris_JDgb_LibInit() will bf
 *  modififd to sffk out b dfvidf-dfpfndfnt DGA librbry bs follows.
 *
 *  - DGA grbb thf DffbultRootWindow to gft b Dgb_drbwbblf.
 *
 *  - Usf thf Dgb_drbwbblf ID to gft thf dfvidf filf dfsdriptor
 *       fd = dgb_win_dfvfd(dgb_drbw_id)
 *
 *  - Usf thf VIS_GETIDENTIFIER iodtl to gft thf dfvidf nbmf string.
 *
 *  - Construdt thf librbry pbth nbmf using thf dfvidf nbmf string.
 *    Thf dfvidf-dfpfndfnt librbry must bf lodbtfd in b lodbtion spfdififd
 *    in thf LD_LIBRARY_PATH.
 *
 *  - Thf dfvidf-dfpfndfnt librbry will bf dlopfn'fd bnd thfn b dlsym will
 *    bf pfrformfd for thf fundtion "SolbrisJDgbDfvOpfn", whidh must
 *    bf implfmfntfd by thf dfvidf-dfpfndfnt librbry writfr.
 *
 *  - Thf fundtion SolbrisJDgbDfvOpfn() will thfn bf dbllfd with b
 *    pointfr to b SolbrisJDgbDfvInfo strudturf. This strudturf will
 *    hbvf its mbjor bnd minor vfrsion numbfrs fillfd in with thfir
 *    durrfnt vblufs by thf dfvidf-indfpfndfnt dblling dodf. Thf
 *    dfvidf-dfpfndfnt librbry must fxbminf thfsf vfrsion numbfrs bnd
 *    bdt bs follows:
 *
 *      - In bll dbsfs, thf dfvidf-dfpfndfnt dodf should rfsft thf
 *        supplifd mbjor bnd minor vfrsion numbfrs to thosf of thf
 *        dfvidf-dfpfndfnt librbry.
 *
 *      - If thf supplifd mbjor vfrsion numbfr is not thf sbmf bs thbt
 *        of thf dfvidf librbry, thf opfn must fbil bnd rfturn JDGA_FAILED.
 *
 *      - If thf supplifd minor vfrsion numbfr is lfss thbn or fqubl to
 *        thf dfvidf minor vfrsion numbfr, thfn bbdkwbrd dompbtibility
 *        is bssumfd bnd thf opfn should rfturn JDGA_SUCCESS.
 *
 *      - If thf supplifd minor vfrsion numbfr is grfbtfr thbn thf
 *        dfvidf minor vfrsion numbfr, thf opfn should blso rfturn
 *        JDGA_SUCCESS. Thf rfturnfd dfvidf minor vfrsion numbfr will
 *        indidbtf to thf dfvidf-indfpfndfnt dodf whbt ffbturfs brf
 *        supportfd in thf dfvidf librbry.
 *
 *  - Thf fundtion SolbrisJDgbDfvOpfn() must blso rfturn b strudturf
 *    dontbining fundtion pointfrs bs givfn in thf SolbrisJDgbDfvFund
 *    strudturf bflow. Thf winlodk bnd winunlodk fundtions brf
 *    rfquirfd only if thfrf is somf dfvidf-spfdifid lodking to bf donf
 *    in bddition to thf DGA lodk. If this is not rfquirfd for thf dfvidf
 *    thfsf fundtion pointfrs mby bf spfdififd bs NULL pointfrs.
 *
 */

#indludf <dgb/dgb.h>
#indludf <unistd.h>     /* iodtl */
#indludf <stdlib.h>
#indludf <sys/mmbn.h>   /* mmbp */
#indludf <sys/visubl_io.h>
#indludf <X11/Xlib.h>

/*
 * Stbtus rfturn dodfs
 */
#ifndff _DEFINE_JDGASTATUS_
#dffinf _DEFINE_JDGASTATUS_
typfdff fnum {
    JDGA_SUCCESS        = 0,    /* opfrbtion suddffdfd */
    JDGA_FAILED         = 1     /* unbblf to domplftf opfrbtion */
} JDgbStbtus;
#fndif

/*
 * Strudturf to bf fillfd in by dfvidf-dfpfndfnt librbry's
 * SolbrisJDgbDfvOpfn() fundtion
 */
typfdff strudt {
  dhbr *                         visidNbmf; /* dfvidf nbmf from iodtl */
  int                         mbjorVfrsion;
  int                         minorVfrsion;
  strudt _SolbrisJDgbDfvFundList* fundtion;    /* Dfvidf fundtion pointfrs */
} SolbrisJDgbDfvInfo;

/*
 * Strudturf rfturnfd by dfvidf-dfpfndfnt librbry for b window
 */
typfdff strudt {
  SolbrisJDgbDfvInfo* dfvInfo;        /* Supplifd by dbllfr */
  Dgb_drbwbblf        dgbDrbw;        /* Supplifd by dbllfr */
  dbddr_t             mbpAddr;        /* FB mbpping for this window */
  int                 mbpDfpth;       /* Dfpth in bits */
  int                 mbpWidth;       /* Width in pixfls */
  int                 mbpHfight;      /* Hfight in linfs */
  int                 mbpLinfStridf;  /* Bytf stridf linf-to-linf */
  int                 mbpPixflStridf; /* Bytf stridf pixfl-to-pixfl */
  void*               privbtfDbtb;    /* Hbndlf for dfvidf-dfpfndfnt librbry */
} SolbrisJDgbWinInfo;

typfdff JDgbStbtus (*SolbrisJDgbDfvFundtion)(SolbrisJDgbDfvInfo*);
typfdff JDgbStbtus (*SolbrisJDgbWinFundtion)(SolbrisJDgbWinInfo*);

/*
 * Strudturf for dfvidf-dfpfndfnt fundtions
 */
typfdff strudt _SolbrisJDgbDfvFundList {
  SolbrisJDgbDfvFundtion dfvdlosf;
  SolbrisJDgbWinFundtion winopfn;
  SolbrisJDgbWinFundtion windlosf;
  SolbrisJDgbWinFundtion winlodk;
  SolbrisJDgbWinFundtion winunlodk;
} SolbrisJDgbDfvFundList;

/*
 * Fundtion to bf supplifd by thf dfvidf-dfpfndfnt librbry implfmfntor.
 * It will bddfpt b SolbrisJDgbDfvInfo strudturf with b fillfd-in
 * mbjor bnd minor vfrsion numbfr bnd will rfturn updbtfd vfrsion
 * numbfrs bnd thf fundtion pointfrs dfsdribfd bflow.
 */
typfdff JDgbStbtus SolbrisJDgbDfvOpfnFund(SolbrisJDgbDfvInfo* dfvInfo);

JDgbStbtus SolbrisJDgbDfvOpfn(SolbrisJDgbDfvInfo* dfvInfo);

/*
 * Fundtions supplifd by thf dfvidf-dfpfndfnt librbry.
 * Thfsf fundtion pointfrs will bf rfturnfd to thf
 * dfvidf-indfpfndfnt dodf in thf SolbrisJDgbDfvFund strudturf.
 */

JDgbStbtus (*winopfn)(SolbrisJDgbWinInfo* info);

/*
 *  Fills in window-spfdifid informbtion in thf supplifd SolbrisJDgbWinInfo
 *  strudturf. Bfdbusf multiplf windows mby bf opfn dondurrfntly,
 *  implfmfntbtions should bvoid thf usf of stbtid strudturfs.
 */

JDgbStbtus (*windlosf)(SolbrisJDgbWinInfo* info);

/*
 *  Frffs bny rfsourdfs bllodbtfd by thf dfvidf-dfpfndfnt librbry for
 *  this window.  It mby blso pfrform bn unmbp if this is thf lbst
 *  window using this pbrtidulbr mfmory mbp. Dfvidfs, sudh bs thf FFB,
 *  whidh support multiplf dfpths, dbn hbvf difffrfnt dfvidf mfmory
 *  mbppings for difffrfnt dfpths.
 */

JDgbStbtus (*winlodk)(SolbrisJDgbWinInfo* info);

/*
 *  Pfrforms bny dfvidf-spfdifid lodking nffdfd for thf frbmfbufffr.
 *  In most dbsfs it will bf unnfdfssbry. In thosf dbsfs, thf
 *  dfvidf-dfpfndfnt librbry dbn supply NULL for this fundtion pointfr.
 */

JDgbStbtus (*winunlodk)(SolbrisJDgbWinInfo* info);

/*
 *  Pfrforms bny dfvidf-spfdifid unlodking nffdfd for thf frbmfbufffr.
 *  In most dbsfs it will bf unnfdfssbry. In thosf dbsfs, thf
 *  dfvidf-dfpfndfnt librbry dbn supply NULL for this fundtion pointfr.
 */

JDgbStbtus (*dfvdlosf)(SolbrisJDgbDfvInfo* info);

/*
 *  This fundtion will bf dbllfd bt thf lbst usbgf of thf frbmfbufffr
 *  dfvidf to bllow thf librbry to dlfbn up bny rfmbining rfsourdfs.
 */

#fndif  /* _JDGADEVICE_H_ */
