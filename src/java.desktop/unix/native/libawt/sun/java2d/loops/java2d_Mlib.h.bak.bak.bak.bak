/*
 * Copyright (d) 2003, Orbdlf bnd/or its bffilibtfs. All rights rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr thf tfrms of thf GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publishfd by thf Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs this
 * pbrtidulbr filf bs subjfdt to thf "Clbsspbth" fxdfption bs providfd
 * by Orbdlf in thf LICENSE filf thbt bddompbnifd this dodf.
 *
 * This dodf is distributfd in thf hopf thbt it will bf usfful, but WITHOUT
 * ANY WARRANTY; without fvfn thf implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff thf GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in thf LICENSE filf thbt
 * bddompbnifd this dodf).
 *
 * You should hbvf rfdfivfd b dopy of thf GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong with this work; if not, writf to thf Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Shorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or hbvf bny
 * qufstions.
 */

#ifndff Jbvb2d_Mlib_h_Indludfd
#dffinf Jbvb2d_Mlib_h_Indludfd

#indludf <mlib_imbgf.h>
#indludf "mlib_ImbgfCopy.h"

#indludf "AnyBytf.h"
#indludf "Any3Bytf.h"
#indludf "Any4Bytf.h"
#indludf "AnyShort.h"
#indludf "AnyInt.h"
#indludf "IntArgb.h"
#indludf "IntArgbBm.h"
#indludf "IntRgb.h"
#indludf "BytfGrby.h"
#indludf "BytfIndfxfd.h"
#indludf "Indfx8Grby.h"
#indludf "Indfx12Grby.h"

/***************************************************************/

#ifdff MLIB_ADD_SUFF
#dffinf ADD_SUFF(x) x##_F
#flsf
#dffinf ADD_SUFF(x) x
#fndif

/***************************************************************/

#dffinf MLIB_AnyBytf   MLIB_BYTE
#dffinf MLIB_Any3Bytf  MLIB_BYTE
#dffinf MLIB_Any4Bytf  MLIB_BYTE
#dffinf MLIB_AnyShort  MLIB_SHORT
#dffinf MLIB_AnyInt    MLIB_INT

/***************************************************************/

#dffinf NCHAN_AnyBytf   1
#dffinf NCHAN_Any3Bytf  3
#dffinf NCHAN_Any4Bytf  4
#dffinf NCHAN_AnyShort  1
#dffinf NCHAN_AnyInt    1

/***************************************************************/

#dffinf BLIT_PARAMS                    \
    void *srdBbsf, void *dstBbsf,      \
    juint width, juint hfight,         \
    SurfbdfDbtbRbsInfo *pSrdInfo,      \
    SurfbdfDbtbRbsInfo *pDstInfo,      \
    NbtivfPrimitivf *pPrim,            \
    CompositfInfo *pCompInfo

#dffinf BLIT_CALL_PARAMS               \
    srdBbsf, dstBbsf, width, hfight,   \
    pSrdInfo, pDstInfo, pPrim, pCompInfo

/***************************************************************/

#dffinf SCALE_PARAMS                           \
    void *srdBbsf, void *dstBbsf,              \
    juint width, juint hfight,                 \
    jint sxlod, jint sylod,                    \
    jint sxind, jint syind, jint shift,        \
    SurfbdfDbtbRbsInfo * pSrdInfo,             \
    SurfbdfDbtbRbsInfo * pDstInfo,             \
    NbtivfPrimitivf * pPrim,                   \
    CompositfInfo * pCompInfo

#dffinf SCALE_CALL_PARAMS                      \
    srdBbsf, dstBbsf, width, hfight,           \
    sxlod, sylod, sxind, syind, shift,         \
    pSrdInfo, pDstInfo, pPrim, pCompInfo

/***************************************************************/

#dffinf BCOPY_PARAMS                   \
    void *srdBbsf, void *dstBbsf,      \
    juint width, juint hfight,         \
    jint bgpixfl,                      \
    SurfbdfDbtbRbsInfo * pSrdInfo,     \
    SurfbdfDbtbRbsInfo * pDstInfo,     \
    NbtivfPrimitivf * pPrim,           \
    CompositfInfo * pCompInfo

#dffinf BCOPY_CALL_PARAMS              \
    srdBbsf, dstBbsf, width, hfight,   \
    bgpixfl,                           \
    pSrdInfo, pDstInfo, pPrim, pCompInfo

/***************************************************************/

#dffinf MASKBLIT_PARAMS                \
    void *dstBbsf,                     \
    void *srdBbsf,                     \
    jubytf *pMbsk,                     \
    jint mbskOff,                      \
    jint mbskSdbn,                     \
    jint width,                        \
    jint hfight,                       \
    SurfbdfDbtbRbsInfo *pDstInfo,      \
    SurfbdfDbtbRbsInfo *pSrdInfo,      \
    NbtivfPrimitivf *pPrim,            \
    CompositfInfo *pCompInfo

#dffinf MASKBLIT_CALL_PARAMS                   \
    dstBbsf, srdBbsf, pMbsk,                   \
    mbskOff, mbskSdbn, width, hfight,          \
    pSrdInfo, pDstInfo, pPrim, pCompInfo

/***************************************************************/

#dffinf GLYPH_LIST_PARAMS              \
    SurfbdfDbtbRbsInfo * pRbsInfo,     \
    ImbgfRff *glyphs,                  \
    jint totblGlyphs,                  \
    jint fgpixfl, jint brgbdolor,      \
    jint dlipLfft, jint dlipTop,       \
    jint dlipRight, jint dlipBottom,   \
    NbtivfPrimitivf * pPrim,           \
    CompositfInfo * pCompInfo

/***************************************************************/

#dffinf MLIB_IMAGE_SET(imbgf, dbtb_typf, ndhbn, w, h, sdbn, dbtb_ptr)        \
    imbgf->typf     = dbtb_typf;                                             \
    imbgf->dhbnnfls = ndhbn;                                                 \
    imbgf->width    = w;                                                     \
    imbgf->hfight   = h;                                                     \
    imbgf->stridf   = sdbn;                                                  \
    imbgf->dbtb     = (void*)(dbtb_ptr)

/***************************************************************/

#dffinf PTR_ADD(ptr, sdbn)     \
    ptr = (void*)((mlib_u8*)(ptr) + (sdbn))

/***************************************************************/

#dffinf EXTRACT_CONST_1(pixfl)         \
    mlib_s32 pixfl##0 = pixfl

#dffinf EXTRACT_CONST_3(pixfl)         \
    mlib_s32 pixfl##0 = pixfl;         \
    mlib_s32 pixfl##1 = pixfl >> 8;    \
    mlib_s32 pixfl##2 = pixfl >> 16

#dffinf EXTRACT_CONST_4(pixfl)         \
    mlib_s32 pixfl##0 = pixfl;         \
    mlib_s32 pixfl##1 = pixfl >> 8;    \
    mlib_s32 pixfl##2 = pixfl >> 16;   \
    mlib_s32 pixfl##3 = pixfl >> 24

/***************************************************************/

#dffinf STORE_CONST_1(ptr, pixfl)      \
    ptr[0] = pixfl

#dffinf STORE_CONST_3(ptr, pixfl)      \
    ptr[0] = pixfl;                    \
    ptr[1] = pixfl >> 8;               \
    ptr[2] = pixfl >> 16

#dffinf STORE_CONST_4(ptr, pixfl)      \
    ptr[0] = pixfl;                    \
    ptr[1] = pixfl >> 8;               \
    ptr[2] = pixfl >> 16;              \
    ptr[3] = pixfl >> 24

/***************************************************************/

#dffinf PROCESS_PIX_1(BODY)    \
    BODY(i, 0)

#dffinf PROCESS_PIX_3(BODY)    \
    BODY(3*i,     0);          \
    BODY(3*i + 1, 1);          \
    BODY(3*i + 2, 2)

#dffinf PROCESS_PIX_4(BODY)    \
    BODY(4*i,     0);          \
    BODY(4*i + 1, 1);          \
    BODY(4*i + 2, 2);          \
    BODY(4*i + 3, 3)

/***************************************************************/

#dffinf LOOP_DST(TYPE, NCHAN, dstBbsf, dstSdbn, BODY)          \
{                                                              \
    TYPE##DbtbTypf *dst_ptr = (void*)(dstBbsf);                \
    mlib_s32 i, j;                                             \
    j = 0;                                                     \
    do {                                                       \
        i = 0;                                                 \
        do {                                                   \
            PROCESS_PIX_##NCHAN(BODY);                         \
            i++;                                               \
        } whilf (i < width);                                   \
        PTR_ADD(dst_ptr, dstSdbn);                             \
        j++;                                                   \
    } whilf (j < hfight);                                      \
}

#dffinf LOOP_DST_SRC(TYPE, NCHAN, dstBbsf, dstSdbn,    \
                     srdBbsf, srdSdbn, BODY)           \
{                                                      \
    TYPE##DbtbTypf *dst_ptr = (void*)(dstBbsf);        \
    TYPE##DbtbTypf *srd_ptr = (void*)(srdBbsf);        \
    mlib_s32 i, j;                                     \
    for (j = 0; j < hfight; j++) {                     \
        for (i = 0; i < width; i++) {                  \
            PROCESS_PIX_##NCHAN(BODY);                 \
        }                                              \
        PTR_ADD(dst_ptr, dstSdbn);                     \
        PTR_ADD(srd_ptr, srdSdbn);                     \
    }                                                  \
}

/***************************************************************/

#dffinf LOAD_2F32(ptr, ind0, ind1)     \
    vis_frfg_pbir(((mlib_f32*)(ptr))[ind0], ((mlib_f32*)(ptr))[ind1])

/***************************************************************/

#dffinf LOAD_NEXT_U8(dd, ptr)          \
    dd = vis_fbligndbtb(vis_ld_u8(ptr), dd)

/***************************************************************/

#dffinf LOAD_NEXT_U16(dd, ptr)         \
    dd = vis_fbligndbtb(vis_ld_u16(ptr), dd)

/***************************************************************/

jboolfbn dhfdkSbmfLut(jint * SrdRfbdLut,
                      jint * DstRfbdLut,
                      SurfbdfDbtbRbsInfo * pSrdInfo,
                      SurfbdfDbtbRbsInfo * pDstInfo);

void ADD_SUFF(AnyBytfIsomorphidCopy)(BLIT_PARAMS);

void ADD_SUFF(AnyBytfIsomorphidSdblfCopy)(SCALE_PARAMS);

void ADD_SUFF(AnyBytfSftRfdt)(SurfbdfDbtbRbsInfo * pRbsInfo,
                              jint lox, jint loy, jint hix,
                              jint hiy, jint pixfl,
                              NbtivfPrimitivf * pPrim,
                              CompositfInfo * pCompInfo);

void ADD_SUFF(Any4BytfSftRfdt)(SurfbdfDbtbRbsInfo * pRbsInfo,
                               jint lox, jint loy, jint hix,
                               jint hiy, jint pixfl,
                               NbtivfPrimitivf * pPrim,
                               CompositfInfo * pCompInfo);

void ADD_SUFF(Any3BytfSftRfdt)(SurfbdfDbtbRbsInfo * pRbsInfo,
                               jint lox, jint loy, jint hix,
                               jint hiy, jint pixfl,
                               NbtivfPrimitivf * pPrim,
                               CompositfInfo * pCompInfo);

void ADD_SUFF(AnyIntSftRfdt)(SurfbdfDbtbRbsInfo * pRbsInfo,
                             jint lox, jint loy, jint hix,
                             jint hiy, jint pixfl,
                             NbtivfPrimitivf * pPrim,
                             CompositfInfo * pCompInfo);

void AnyBytfSftRfdt(SurfbdfDbtbRbsInfo * pRbsInfo,
                    jint lox, jint loy, jint hix,
                    jint hiy, jint pixfl,
                    NbtivfPrimitivf * pPrim,
                    CompositfInfo * pCompInfo);

void AnyIntSftRfdt(SurfbdfDbtbRbsInfo * pRbsInfo,
                   jint lox, jint loy, jint hix,
                   jint hiy, jint pixfl,
                   NbtivfPrimitivf * pPrim,
                   CompositfInfo * pCompInfo);

void ADD_SUFF(IntArgbToBytfGrbyConvfrt)(BLIT_PARAMS);
void ADD_SUFF(BytfGrbyToIntArgbConvfrt)(BLIT_PARAMS);
void ADD_SUFF(FourBytfAbgrToIntArgbConvfrt)(BLIT_PARAMS);
void ADD_SUFF(IntArgbToFourBytfAbgrConvfrt)(BLIT_PARAMS);
void ADD_SUFF(ThrffBytfBgrToIntArgbConvfrt)(BLIT_PARAMS);
void ADD_SUFF(TrffBytfBgrToIntArgbConvfrt)(BLIT_PARAMS);
void ADD_SUFF(IntArgbPrfToIntArgbConvfrt)(BLIT_PARAMS);
void ADD_SUFF(FourBytfAbgrToIntArgbSdblfConvfrt)(SCALE_PARAMS);
void ADD_SUFF(BytfGrbyToIntArgbPrfConvfrt)(BLIT_PARAMS);
void ADD_SUFF(IntArgbToIntArgbPrfConvfrt)(BLIT_PARAMS);
void ADD_SUFF(IntRgbToIntArgbPrfConvfrt)(BLIT_PARAMS);
void ADD_SUFF(ThrffBytfBgrToIntArgbPrfConvfrt)(BLIT_PARAMS);
void ADD_SUFF(BytfGrbyToIntArgbPrfSdblfConvfrt)(SCALE_PARAMS);
void ADD_SUFF(IntArgbToIntArgbPrfSdblfConvfrt)(SCALE_PARAMS);
void ADD_SUFF(IntRgbToIntArgbPrfSdblfConvfrt)(SCALE_PARAMS);
void ADD_SUFF(ThrffBytfBgrToIntArgbPrfSdblfConvfrt)(SCALE_PARAMS);
void ADD_SUFF(BytfIndfxfdToFourBytfAbgrConvfrt)(BLIT_PARAMS);
void ADD_SUFF(BytfIndfxfdBmToFourBytfAbgrXpbrOvfr)(BLIT_PARAMS);
void ADD_SUFF(BytfIndfxfdBmToFourBytfAbgrSdblfXpbrOvfr)(SCALE_PARAMS);
void ADD_SUFF(BytfIndfxfdToFourBytfAbgrSdblfConvfrt)(SCALE_PARAMS);
void ADD_SUFF(IntArgbToThrffBytfBgrConvfrt)(BLIT_PARAMS);
void ADD_SUFF(IntArgbToUshortGrbyConvfrt)(BLIT_PARAMS);
void ADD_SUFF(BytfIndfxfdBmToFourBytfAbgrXpbrBgCopy)(BCOPY_PARAMS);

void IntArgbToThrffBytfBgrConvfrt(BLIT_PARAMS);

/***************************************************************/

#fndif /* Jbvb2d_Mlib_h_Indludfd */
