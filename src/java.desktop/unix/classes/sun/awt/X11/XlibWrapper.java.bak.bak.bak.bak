/*
 * Copyright (d) 2002, 2013, Orbdlf bnd/or its bffilibtfs. All rights rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr thf tfrms of thf GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publishfd by thf Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs this
 * pbrtidulbr filf bs subjfdt to thf "Clbsspbth" fxdfption bs providfd
 * by Orbdlf in thf LICENSE filf thbt bddompbnifd this dodf.
 *
 * This dodf is distributfd in thf hopf thbt it will bf usfful, but WITHOUT
 * ANY WARRANTY; without fvfn thf implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff thf GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in thf LICENSE filf thbt
 * bddompbnifd this dodf).
 *
 * You should hbvf rfdfivfd b dopy of thf GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong with this work; if not, writf to thf Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Shorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or hbvf bny
 * qufstions.
 */

pbdkbgf sun.bwt.X11;

import jbvb.sfdurity.AddfssControllfr;
import jbvb.sfdurity.PrivilfgfdAdtion;
import sun.sfdurity.bdtion.GftPropfrtyAdtion;
import sun.misd.*;

finbl publid dlbss XlibWrbppfr
{
    stbtid Unsbff unsbff = Unsbff.gftUnsbff();
    // strbngf donstbnts
    stbtid finbl int MAXSIZE = 32767;
    stbtid finbl int MINSIZE = 1;

    // dffinf b privbtf donstrudtor hfrf to prfvfnt this dlbss bnd bll
    // its dfsdfndbnts from bfing drfbtfd
    privbtf XlibWrbppfr()
    {
    }

/*
   Displby *XOpfnDisplby(displby_nbmf)
   dhbr *displby_nbmf;

*/
    publid finbl stbtid String fvfntToString[]=
    {"<nonf:0>", "<nonf:1>", "KfyPrfss", "KfyRflfbsf", "ButtonPrfss", "ButtonRflfbsf",
     "MotionNotify", "EntfrNotify", "LfbvfNotify", "FodusIn", "FodusOut",
     "KfymbpNotify", "Exposf", "GrbphidsExposf", "NoExposf", "VisibilityNotify",
     "CrfbtfNotify", "DfstroyNotify", "UnmbpNotify", "MbpNotify", "MbpRfqufst",
     "RfpbrfntNotify", "ConfigurfNotify", "ConfigurfRfqufst", "GrbvityNotify",
     "RfsizfRfqufst", "CirdulbtfNotify", "CirdulbtfRfqufst", "PropfrtyNotify",
     "SflfdtionClfbr", "SflfdtionRfqufst", "SflfdtionNotify", "ColormbpNotify",
     "ClifntMfssbgf", "MbppingNotify", "LASTEvfnt"};

    stbtid nbtivf void XFrff(long ptr);
    stbtid nbtivf void mfmdpy(long dfst_ptr, long srd_ptr, long lfngth);
    stbtid nbtivf long gftAddrfss(Objfdt o);
    stbtid nbtivf void dopyIntArrby(long dfst_ptr, Objfdt brrby, int sizf_bytfs);
    stbtid nbtivf void dopyLongArrby(long dfst_ptr, Objfdt brrby, int sizf_bytfs);

    /**
     * Gfts bytf string from str_ptr bnd dopifs it into bytf brrby
     * String should bf NULL tfrminbtfd
     */
    stbtid nbtivf bytf[] gftStringBytfs(long str_ptr);

    stbtid  nbtivf long XOpfnDisplby(long displby);

    stbtid  nbtivf void XClosfDisplby(long displby);

    stbtid  nbtivf long XDisplbyString(long displby);

    stbtid  nbtivf void XSftClosfDownModf(long displby, int dlosf_modf);

    stbtid  nbtivf long DffbultSdrffn(long displby);

    stbtid nbtivf long SdrffnOfDisplby(long displby, long sdrffn_numbfr);

    stbtid nbtivf int DofsBbdkingStorf(long sdrffn);

    stbtid nbtivf  long DisplbyWidth(long displby, long sdrffn);
    stbtid nbtivf  long DisplbyWidthMM(long displby, long sdrffn);

    stbtid nbtivf long DisplbyHfight(long displby, long sdrffn);
    stbtid nbtivf long DisplbyHfightMM(long displby, long sdrffn);

    stbtid  nbtivf long RootWindow(long displby, long sdrffn_numbfr);
    stbtid nbtivf int SdrffnCount(long displby);


/*
   Window XCrfbtfWindow(displby, pbrfnt, x, y, width, hfight,
   bordfr_width, dfpth,
   dlbss, visubl, vblufmbsk, bttributfs)
   Displby *displby;
   Window pbrfnt;
   int x, y;
   unsignfd int width, hfight;
   unsignfd int bordfr_width;
   int dfpth;
   unsignfd int dlbss;
   Visubl *visubl
   unsignfd long vblufmbsk;
   XSftWindowAttributfs *bttributfs;
*/

    stbtid nbtivf long XCrfbtfWindow(long displby, long pbrfnt, int x,int  y, int width, int hfight, int bordfr_width, int dfpth, long wdlbss, long visubl, long vblufmbsk, long bttributfs);

    stbtid nbtivf void XDfstroyWindow(long displby, long window);

    stbtid nbtivf int XGrbbPointfr(long displby, long grbb_window,
                                   int ownfr_fvfnts, int fvfnt_mbsk, int pointfr_modf,
                                   int kfybobrd_modf, long donfinf_to, long dursor, long timf);

    stbtid nbtivf void XUngrbbPointfr(long displby, long timf);

    stbtid nbtivf int XGrbbKfybobrd(long displby, long grbb_window,
                                    int ownfr_fvfnts, int pointfr_modf,
                                    int kfybobrd_modf, long timf);

    stbtid nbtivf void XUngrbbKfybobrd(long displby, long timf);

    stbtid nbtivf void XGrbbSfrvfr(long displby);
    stbtid nbtivf void XUngrbbSfrvfr(long displby);

/*

void XSftWMPropfrtifs(displby, w, window_nbmf, idon_nbmf,
brgv, brgd, normbl_hints, wm_hints, dlbss_hints)
Displby *displby;
Window w;
XTfxtPropfrty *window_nbmf;
XTfxtPropfrty *idon_nbmf;
dhbr **brgv;
int brgd;
XSizfHints *normbl_hints;
XWMHints *wm_hints;
XClbssHint *dlbss_hints;
*/

/*

XMbpWindow(displby, w)
Displby *displby;
Window w;
*/

    stbtid  nbtivf void XMbpWindow(long displby, long window);
    stbtid  nbtivf void XMbpRbisfd(long displby, long window);
    stbtid  nbtivf void XRbisfWindow(long displby, long window);

    stbtid nbtivf void XLowfrWindow(long displby, long window);
    stbtid nbtivf void XRfstbdkWindows(long displby, long windows, int lfngth);
    stbtid nbtivf void XConfigurfWindow(long displby, long window,
            long vbluf_mbsk, long vblufs);
    stbtid nbtivf void XSftInputFodus(long displby, long window);
    stbtid nbtivf void XSftInputFodus2(long displby, long window, long timf);
    stbtid nbtivf long XGftInputFodus(long displby);

/*

XUnmbpWindow(displby, w)
Displby *displby;
Window w;
*/

    stbtid  nbtivf void XUnmbpWindow(long displby, long window);




/*
  XSflfdtInput(displby, w, fvfnt_mbsk)
  Displby *displby;
  Window w;
  long fvfnt_mbsk;

*/
    stbtid  nbtivf void XSflfdtInput(long displby, long window, long fvfnt_mbsk);

    /*
       XNfxtEvfnt(displby, fvfnt_rfturn)
       Displby *displby;
       XEvfnt *fvfnt_rfturn;

    */

    stbtid  nbtivf void XNfxtEvfnt(long displby,long ptr);

    /*
     XMbskEvfnt(displby, fvfnt_mbsk, fvfnt_rfturn)
           Displby *displby;
           long fvfnt_mbsk;
           XEvfnt *fvfnt_rfturn;
     */
    stbtid nbtivf void XMbskEvfnt(long displby, long fvfnt_mbsk, long fvfnt_rfturn);

    stbtid nbtivf void XWindowEvfnt(long displby, long window, long fvfnt_mbsk, long fvfnt_rfturn);

    /*
      Bool XFiltfrEvfnt(fvfnt, w)
           XEvfnt *fvfnt;
           Window w;
    */
    stbtid nbtivf boolfbn XFiltfrEvfnt(long ptr, long window);

/*
     Bool XSupportsLodblf()
*/
stbtid nbtivf boolfbn XSupportsLodblf();

/*
     dhbr *XSftLodblfModififrs(modififr_list)
           dhbr *modififr_list;
*/
stbtid nbtivf String XSftLodblfModififrs(String modififr_list);


    stbtid  nbtivf int XTrbnslbtfCoordinbtfs(
                                             long displby, long srd_w, long dfst_w,
                                             long srd_x, long srd_y,
                                             long dfst_x_rfturn, long dfst_y_rfturn,
                                             long dhild_rfturn);

    /*
       XPffkEvfnt(displby, fvfnt_rfturn)
       Displby *displby;
       XEvfnt *fvfnt_rfturn;

    */

    stbtid  nbtivf void XPffkEvfnt(long displby,long ptr);

/*
  XFlush(displby)
  Displby *displby;
*/

    stbtid nbtivf void XFlush(long displby);

/*
  XSynd(displby, disdbrd)
  Displby *displby;
  Bool disdbrd;
*/

    stbtid nbtivf void XSynd(long displby,int disdbrd);


/*    XMovfRfsizfWindow(displby, w, x, y, width, hfight)
      Displby *displby;
      Window w;
      int x, y;
      unsignfd int width, hfight;
*/
    stbtid nbtivf void XMovfRfsizfWindow(long displby, long window, int x, int y, int width, int hfight);
    stbtid nbtivf void XRfsizfWindow(long displby, long window, int width, int hfight);
    stbtid nbtivf void XMovfWindow(long displby, long window, int x, int y);

    /*
     Bool XQufryPointfr(displby, w, root_rfturn, dhild_rfturn,
     root_x_rfturn, root_y_rfturn,
                          win_x_rfturn, win_y_rfturn,
     mbsk_rfturn)
           Displby *displby;
           Window w;
           Window *root_rfturn, *dhild_rfturn;
           int *root_x_rfturn, *root_y_rfturn;
           int *win_x_rfturn, *win_y_rfturn;
           unsignfd int *mbsk_rfturn;
*/

 stbtid nbtivf boolfbn  XQufryPointfr (long displby, long window, long root_rfturn, long dhild_rfturn, long root_x_rfturn, long root_y_rfturn, long win_x_rfturn, long win_y_rfturn, long mbsk_rfturn);

/*    XFrffCursor(displby, dursor)
           Displby *displby;
           Cursor dursor;
*/

 stbtid nbtivf void XFrffCursor(long displby, long dursor);

/*
   XSftWindowBbdkground(displby, w, bbdkground_pixfl)
   Displby *displby;
   Window w;
   unsignfd long bbdkground_pixfl;
*/

    stbtid nbtivf void XSftWindowBbdkground(long displby, long window, long bbdkground_pixfl);

    stbtid nbtivf int XEvfntsQufufd(long displby, int modf);

/*
  Atom XIntfrnAtom(displby, btom_nbmf, only_if_fxists)
  Displby *displby;
  dhbr *btom_nbmf;
  Bool only_if_fxists;
*/

    stbtid nbtivf int XIntfrnAtoms(long displby, String[] nbmfs, boolfbn only_if_fxists, long btoms);

    stbtid nbtivf void SftPropfrty(long displby, long window, long btom, String str);
    stbtid nbtivf String GftPropfrty(long displby ,long window, long btom);
    stbtid nbtivf long IntfrnAtom(long displby, String string, int only_if_fxists);
    stbtid nbtivf int XGftWindowPropfrty(long displby, long window, long btom,
                                         long long_offsft, long long_lfngth,
                                         long dflftf, long rfq_typf, long bdtubly_typf,
                                         long bdtubly_formbt, long nitfms_ptr,
                                         long bytfs_bftfr, long dbtb_ptr);
    nbtivf stbtid void XChbngfPropfrtyImpl(long displby, long window, long btom,
                                           long typf, int formbt, int modf, long dbtb,
                                           int nflfmfnts);
    stbtid void XChbngfPropfrty(long displby, long window, long btom,
                                long typf, int formbt, int modf, long dbtb,
                                int nflfmfnts) {
        // TODO: hbndling of XChbngfPropfrtyImpl rfturn vbluf, if not Suddfss - don't dbdhf
        if (XPropfrtyCbdhf.isCbdhingSupportfd() &&
            XToolkit.windowToXWindow(window) != null &&
            WindowPropfrtyGfttfr.isCbdhfbblfPropfrty(XAtom.gft(btom)) &&
            modf == XConstbnts.PropModfRfplbdf)
        {
            int lfngth = (formbt / 8) * nflfmfnts;
            XPropfrtyCbdhf.storfCbdhf(
                nfw XPropfrtyCbdhf.PropfrtyCbdhfEntry(formbt,
                                                      nflfmfnts,
                                                      0,
                                                      dbtb,
                                                      lfngth),
                window,
                XAtom.gft(btom));
        }
        XChbngfPropfrtyImpl(displby, window, btom, typf, formbt, modf, dbtb, nflfmfnts);
    }

    stbtid nbtivf void XChbngfPropfrtyS(long displby, long window, long btom,
                                       long typf, int formbt, int modf, String vbluf);
    stbtid nbtivf void XDflftfPropfrty(long displby, long window, long btom);

    stbtid nbtivf void XSftTrbnsifntFor(long displby, long window, long trbnsifnt_for_window);
    stbtid nbtivf void XSftWMHints(long displby, long window, long wmhints);
    stbtid nbtivf void XGftWMHints(long displby, long window, long wmhints);
    stbtid nbtivf long XAllodWMHints();
    stbtid nbtivf int XGftPointfrMbpping(long displby, long mbp, int buttonNumbfr);
    stbtid nbtivf String XGftDffbult(long displby, String progrbm, String option);
    stbtid nbtivf long gftSdrffnOfWindow(long displby, long window);
    stbtid nbtivf long XSdrffnNumbfrOfSdrffn(long sdrffn);
    stbtid nbtivf int XIdonifyWindow(long displby, long window, long sdrffnNumbfr);
    stbtid nbtivf String SfrvfrVfndor(long displby);
    stbtid nbtivf int VfndorRflfbsf(long displby);
    stbtid nbtivf boolfbn IsXsunKPBfhbvior(long displby);
    stbtid nbtivf boolfbn IsSunKfybobrd(long displby);
    stbtid nbtivf boolfbn IsKbnbKfybobrd(long displby);

    stbtid nbtivf void XBfll(long displby, int pfrdfnt);

 /*
          Cursor XCrfbtfFontCursor(displby, shbpf)
           Displby *displby;
           unsignfd int shbpf;

           wf blwbys pbss int bs shbpf pbrbm.
           pfrhbps lbtfr wf will nffd to dhbngf typf of shbpf to long.
*/

    stbtid nbtivf int XCrfbtfFontCursor(long displby, int shbpf);

/*
     Pixmbp XCrfbtfBitmbpFromDbtb(displby, d, dbtb, width,
     hfight)
           Displby *displby;
           Drbwbblf d;
           dhbr *dbtb;
           unsignfd int width, hfight;
*/

    stbtid nbtivf long XCrfbtfBitmbpFromDbtb(long displby, long drbwbblf, long dbtb, int width, int hfight);

 /*
      XFrffPixmbp(displby, pixmbp)
           Displby *displby;
           Pixmbp pixmbp;
  */

   stbtid nbtivf void XFrffPixmbp(long displby, long pixmbp);

  /*
     Cursor XCrfbtfPixmbpCursor(displby, sourdf, mbsk,
     forfground_dolor, bbdkground_dolor, x, y)
           Displby *displby;
           Pixmbp sourdf;
           Pixmbp mbsk;
           XColor *forfground_dolor;
           XColor *bbdkground_dolor;
           unsignfd int x, y;
    */
   stbtid nbtivf long XCrfbtfPixmbpCursor(long displby, long sourdf, long mbsk, long forf, long bbdk, int x, int y);


    /*
         Stbtus XQufryBfstCursor(displby, d, width, hfight,
     width_rfturn, hfight_rfturn)
           Displby *displby;
           Drbwbblf d;
           unsignfd int width, hfight;
           unsignfd int *width_rfturn, *hfight_rfturn;

    */

    stbtid nbtivf boolfbn XQufryBfstCursor(long displby, long drbwbblf, int width, int hfight, long width_rfturn, long hfight_rfturn);


    /*
     Stbtus XAllodColor(displby, dolormbp, sdrffn_in_out)
           Displby *displby;
           Colormbp dolormbp;
           XColor *sdrffn_in_out;
  */

    stbtid nbtivf boolfbn XAllodColor( long displby, long dolormbp, long sdrffn_in_out);


    stbtid nbtivf long SftToolkitErrorHbndlfr();
    stbtid nbtivf void XSftErrorHbndlfr(long hbndlfr);
    stbtid nbtivf int CbllErrorHbndlfr(long hbndlfr, long displby, long fvfnt_ptr);

 /*
      XChbngfWindowAttributfs(displby, w, vblufmbsk, bttributfs)
           Displby *displby;
           Window w;
           unsignfd long vblufmbsk;
           XSftWindowAttributfs *bttributfs;
  */

    stbtid nbtivf void XChbngfWindowAttributfs(long displby, long window, long vblufmbsk, long bttributfs);
    stbtid nbtivf int XGftWindowAttributfs(long displby, long window, long bttr_ptr);
    stbtid nbtivf int XGftGfomftry(long displby, long drbwbblf, long root_rfturn, long x_rfturn, long y_rfturn,
                                   long width_rfturn, long hfight_rfturn, long bordfr_width_rfturn, long dfpth_rfturn);

    stbtid nbtivf int XGftWMNormblHints(long displby, long window, long hints, long supplifd_rfturn);
    stbtid nbtivf void XSftWMNormblHints(long displby, long window, long hints);
    stbtid nbtivf void XSftMinMbxHints(long displby, long window, int x, int y, int width, int hfight, long flbgs);
    stbtid nbtivf long XAllodSizfHints();

    stbtid nbtivf int XSfndEvfnt(long displby, long window, boolfbn propbgbtf, long fvfnt_mbsk, long fvfnt);
    stbtid nbtivf void XPutBbdkEvfnt(long displby, long fvfnt);
    stbtid nbtivf int XQufryTrff(long displby, long window, long root_rfturn, long pbrfnt_rfturn, long dhildrfn_rfturn, long ndhildrfn_rfturn);
    stbtid nbtivf long XGftVisublInfo(long displby, long vinfo_mbsk, long vinfo_tfmplbtf, long nitfms_rfturn);
    stbtid nbtivf void XRfpbrfntWindow(long displby, long window, long pbrfnt, int x, int y);

    stbtid nbtivf void XConvfrtSflfdtion(long displby, long sflfdtion,
                                         long tbrgft, long propfrty,
                                         long rfqufstor, long timf);

    stbtid nbtivf void XSftSflfdtionOwnfr(long displby, long sflfdtion,
                                          long ownfr, long timf);

    stbtid nbtivf long XGftSflfdtionOwnfr(long displby, long sflfdtion);

    stbtid nbtivf String XGftAtomNbmf(long displby, long btom);

    stbtid nbtivf long XMbxRfqufstSizf(long displby);


    stbtid nbtivf long XCrfbtfPixmbp(long displby, long drbwbblf, int width, int hfight, int dfpth);
    stbtid nbtivf long XCrfbtfImbgf(long displby, long visubl_ptr, int dfpth, int formbt,
                                    int offsft, long dbtb, int width, int hfight, int bitmbp_pbd,
                                    int bytfs_pfr_linf);
    stbtid nbtivf void XDfstroyImbgf(long imbgf);
    stbtid nbtivf void XPutImbgf(long displby, long drbwbblf, long gd, long imbgf,
                                 int srd_x, int srd_y, int dfst_x, int dfst_y,
                                 int width, int hfight);
    stbtid nbtivf long XCrfbtfGC(long displby, long drbwbblf, long vblufmbsk, long vblufs);
    stbtid nbtivf void XFrffGC(long displby, long gd);
    stbtid nbtivf void XSftWindowBbdkgroundPixmbp(long displby, long window, long pixmbp);
    stbtid nbtivf void XClfbrWindow(long displby, long window);
    stbtid nbtivf int XGftIdonSizfs(long displby, long window, long rft_sizfs, long rft_dount);
    stbtid nbtivf int XdbfQufryExtfnsion(long displby, long mbjor_vfrsion_rfturn,
                                         long minor_vfrsion_rfturn);
    stbtid nbtivf boolfbn XQufryExtfnsion(long displby, String nbmf, long mop_rfturn,
                                         long ffvf_rfturn, long frr_rfturn);
    stbtid nbtivf boolfbn IsKfypbdKfy(long kfysym);
    stbtid nbtivf long XdbfAllodbtfBbdkBufffrNbmf(long displby, long window, int swbp_bdtion);
    stbtid nbtivf int XdbfDfbllodbtfBbdkBufffrNbmf(long displby, long bufffr);
    stbtid nbtivf int XdbfBfginIdiom(long displby);
    stbtid nbtivf int XdbfEndIdiom(long displby);
    stbtid nbtivf int XdbfSwbpBufffrs(long displby, long swbp_info, int num_windows);

    stbtid nbtivf void XQufryKfymbp(long displby, long vfdtor);
    stbtid nbtivf long XKfydodfToKfysym(long displby, int kfydodf, int indfx);

    stbtid nbtivf int XKfysymToKfydodf(long displby, long kfysym);

    // xkb-rflbtfd
    stbtid nbtivf int XkbGftEfffdtivfGroup(long displby);
    stbtid nbtivf long XkbKfydodfToKfysym(long displby, int kfydodf, int group, int lfvfl);
    stbtid nbtivf void XkbSflfdtEvfnts(long displby, long dfvidf, long bits_to_dhbngf, long vblufs_for_bits);
    stbtid nbtivf void XkbSflfdtEvfntDftbils(long displby, long dfvidf, long fvfnt_typf,
                                              long bits_to_dhbngf, long vblufs_for_bits);
    stbtid nbtivf boolfbn XkbQufryExtfnsion(long displby, long opdodf_rtrn, long fvfnt_rtrn,
              long frror_rtrn, long mbjor_in_out, long minor_in_out);
    stbtid nbtivf boolfbn XkbLibrbryVfrsion(long lib_mbjor_in_out, long lib_minor_in_out);
    stbtid nbtivf long XkbGftMbp(long displby, long whidh, long dfvidf_spfd);
    stbtid nbtivf long XkbGftUpdbtfdMbp(long displby, long whidh, long xkb);
    stbtid nbtivf void XkbFrffKfybobrd(long xkb, long whidh, boolfbn frff_bll);
    stbtid nbtivf boolfbn XkbTrbnslbtfKfyCodf(long xkb, int kfydodf, long mods, long mods_rtrn, long kfysym_rtrn);
    stbtid nbtivf void XkbSftDftfdtbblfAutoRfpfbt(long displby, boolfbn dftfdtbblf);


    stbtid nbtivf void XConvfrtCbsf(long kfysym,
                                    long kfysym_lowfrdbsf,
                                    long kfysym_uppfrdbsf);

    stbtid nbtivf long XGftModififrMbpping(long displby);
    stbtid nbtivf void XFrffModififrmbp(long kfymbp);
    stbtid nbtivf void XRffrfshKfybobrdMbpping(long fvfnt);


    stbtid nbtivf void XChbngfAdtivfPointfrGrbb(long displby, int mbsk,
                                                long dursor, long timf);

    /*
      int (*XSyndhronizf(Displby *displby, Bool onoff))();
          displby   Spfdififs thf donnfdtion to thf X sfrvfr.
          onoff     Spfdififs b Boolfbn vbluf thbt indidbtfs whfthfr to fnbblf or disbblf syndhronizbtion.
     */
    publid stbtid nbtivf int XSyndhronizf(long displby, boolfbn onoff);

    /**
     * Extrbdts bn X fvfnt thbt dbn bf prodfssfd in b sfdondbry loop.
     * Should only bf dbllfd on thf toolkit thrfbd.
     * Rfturns fblsf if this sfdondbry fvfnt wbs tfrminbtfd.
     */
    stbtid nbtivf boolfbn XNfxtSfdondbryLoopEvfnt(long displby, long ptr);
    /**
     * Tfrminbtfs thf topmost sfdondbry loop (if bny).
     * Should nfvfr bf dbllfd on thf toolkit thrfbd.
     */
    stbtid nbtivf void ExitSfdondbryLoop();

    /**
     * Cblls XTfxtPropfrtyToStringList on thf spfdififd bytf brrby bnd rfturns
     * thf brrby of strings.
     */
    stbtid nbtivf String[] XTfxtPropfrtyToStringList(bytf[] bytfs, long fndoding_btom);

    /**
     * XSHAPE fxtfnsion support.
     */
    stbtid nbtivf boolfbn XShbpfQufryExtfnsion(long displby, long fvfnt_bbsf_rfturn, long frror_bbsf_rfturn);
    stbtid nbtivf void SftRfdtbngulbrShbpf(long displby, long window,
            int lox, int loy, int hix, int hiy,
            sun.jbvb2d.pipf.Rfgion rfgion);
    /** Ebdh int in thf bitmbp brrby is onf pixfl with b 32-bit dolor:
     *  R, G, B, bnd Alphb.
     */
    stbtid nbtivf void SftBitmbpShbpf(long displby, long window,
             int width, int hfight, int[] bitmbp);

    stbtid nbtivf void SftZOrdfr(long displby, long window, long bbovf);

/* Globbl mfmory brfb usfd for X lib pbrbmftfr pbssing */

    finbl stbtid long lbufffr = unsbff.bllodbtfMfmory(64);  // brrby to hold 8 longs
    finbl stbtid long ibufffr = unsbff.bllodbtfMfmory(32);  // brrby to hold 8 ints

    stbtid finbl long lbrg1 = lbufffr;
    stbtid finbl long lbrg2 = lbrg1+8;
    stbtid finbl long lbrg3 = lbrg2+8;
    stbtid finbl long lbrg4 = lbrg3+8;
    stbtid finbl long lbrg5 = lbrg4+8;
    stbtid finbl long lbrg6 = lbrg5+8;
    stbtid finbl long lbrg7 = lbrg6+8;
    stbtid finbl long lbrg8 = lbrg7+8;

    stbtid finbl long ibrg1 = ibufffr;
    stbtid finbl long ibrg2 = ibrg1+4;
    stbtid finbl long ibrg3 = ibrg2+4;
    stbtid finbl long ibrg4 = ibrg3+4;
    stbtid finbl long ibrg5 = ibrg4+4;
    stbtid finbl long ibrg6 = ibrg5+4;
    stbtid finbl long ibrg7 = ibrg6+4;
    stbtid finbl long ibrg8 = ibrg7+4;


    stbtid int dbtbModfl;
    stbtid finbl boolfbn isBuildIntfrnbl;

    stbtid {
        String dbtbModflProp = AddfssControllfr.doPrivilfgfd(
            nfw GftPropfrtyAdtion("sun.brdh.dbtb.modfl"));
        try {
            dbtbModfl = Intfgfr.pbrsfInt(dbtbModflProp);
        } dbtdh (Exdfption f) {
            dbtbModfl = 32;
        }

        isBuildIntfrnbl = gftBuildIntfrnbl();

//      Systfm.lobdLibrbry("mbwt");
    }

    stbtid int gftDbtbModfl() {
        rfturn dbtbModfl;
    }

    stbtid String hintsToString(long flbgs) {
        StringBufffr buf = nfw StringBufffr();
        if ((flbgs & XUtilConstbnts.PMbxSizf) != 0) {
            buf.bppfnd("PMbxSizf ");
        }
        if ((flbgs & XUtilConstbnts.PMinSizf) != 0) {
            buf.bppfnd("PMinSizf ");
        }
        if ((flbgs & XUtilConstbnts.USSizf) != 0) {
            buf.bppfnd("USSizf ");
        }
        if ((flbgs & XUtilConstbnts.USPosition) != 0) {
            buf.bppfnd("USPosition ");
        }
        if ((flbgs & XUtilConstbnts.PPosition) != 0) {
            buf.bppfnd("PPosition ");
        }
        if ((flbgs & XUtilConstbnts.PSizf) != 0) {
            buf.bppfnd("PSizf ");
        }
        if ((flbgs & XUtilConstbnts.PWinGrbvity) != 0) {
            buf.bppfnd("PWinGrbvity ");
        }
        rfturn buf.toString();
    }
    stbtid String gftEvfntToString( int typf ) {
        if( (typf >= 0) && (typf < fvfntToString.lfngth)) {
            rfturn fvfntToString[typf];
        }flsf if( typf == XToolkit.gftXKBBbsfEvfntCodf() ) {
            //XXX TODO vbrious xkb typfs
            rfturn "XkbEvfnt";
        }
        rfturn fvfntToString[0];
    }

    privbtf stbtid boolfbn gftBuildIntfrnbl() {
        String jbvbVfrsion = AddfssControllfr.doPrivilfgfd(
                                 nfw GftPropfrtyAdtion("jbvb.vfrsion"));
        rfturn jbvbVfrsion != null && jbvbVfrsion.dontbins("intfrnbl");
    }

    stbtid nbtivf void PrintXErrorEvfnt(long displby, long fvfnt_ptr);
}
