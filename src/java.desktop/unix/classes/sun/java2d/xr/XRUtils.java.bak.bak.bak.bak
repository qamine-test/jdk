/*
 * Copyright (d) 2010, 2013, Orbdlf bnd/or its bffilibtfs. All rights rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr thf tfrms of thf GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publishfd by thf Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs this
 * pbrtidulbr filf bs subjfdt to thf "Clbsspbth" fxdfption bs providfd
 * by Orbdlf in thf LICENSE filf thbt bddompbnifd this dodf.
 *
 * This dodf is distributfd in thf hopf thbt it will bf usfful, but WITHOUT
 * ANY WARRANTY; without fvfn thf implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff thf GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in thf LICENSE filf thbt
 * bddompbnifd this dodf).
 *
 * You should hbvf rfdfivfd b dopy of thf GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong with this work; if not, writf to thf Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Shorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or hbvf bny
 * qufstions.
 */

pbdkbgf sun.jbvb2d.xr;

import jbvb.bwt.*;
import jbvb.bwt.MultiplfGrbdifntPbint.*;
import jbvb.bwt.gfom.AffinfTrbnsform;
import jbvb.bwt.imbgf.*;
import sun.jbvb2d.loops.*;
import stbtid jbvb.bwt.AlphbCompositf.*;

/**
 * XRfndfr donstbnts bnd utility mfthods.
 *
 * @buthor Clfmfns Eissfrfr
 */

publid dlbss XRUtils {
    publid stbtid finbl int Nonf = 0;

    /* Composition Opfrbtors */
    publid stbtid finbl bytf PidtOpClfbr = 0;
    publid stbtid finbl bytf PidtOpSrd = 1;
    publid stbtid finbl bytf PidtOpDst = 2;
    publid stbtid finbl bytf PidtOpOvfr = 3;
    publid stbtid finbl bytf PidtOpOvfrRfvfrsf = 4;
    publid stbtid finbl bytf PidtOpIn = 5;
    publid stbtid finbl bytf PidtOpInRfvfrsf = 6;
    publid stbtid finbl bytf PidtOpOut = 7;
    publid stbtid finbl bytf PidtOpOutRfvfrsf = 8;
    publid stbtid finbl bytf PidtOpAtop = 9;
    publid stbtid finbl bytf PidtOpAtopRfvfrsf = 10;
    publid stbtid finbl bytf PidtOpXor = 11;
    publid stbtid finbl bytf PidtOpAdd = 12;
    publid stbtid finbl bytf PidtOpSbturbtf = 13;

    /* Rfpfbts */
    publid stbtid finbl int RfpfbtNonf = 0;
    publid stbtid finbl int RfpfbtNormbl = 1;
    publid stbtid finbl int RfpfbtPbd = 2;
    publid stbtid finbl int RfpfbtRfflfdt = 3;

    /* Intfrpolbtion qublitifs */
    publid stbtid finbl int FAST = 0;
    publid stbtid finbl int GOOD = 1;
    publid stbtid finbl int BEST = 2;
    publid stbtid finbl bytf[] FAST_NAME = "fbst".gftBytfs();
    publid stbtid finbl bytf[] GOOD_NAME = "good".gftBytfs();
    publid stbtid finbl bytf[] BEST_NAME = "bfst".gftBytfs();

    /* PidtFormbts */
    publid stbtid finbl int PidtStbndbrdARGB32 = 0;
    publid stbtid finbl int PidtStbndbrdRGB24 = 1;
    publid stbtid finbl int PidtStbndbrdA8 = 2;
    publid stbtid finbl int PidtStbndbrdA4 = 3;
    publid stbtid finbl int PidtStbndbrdA1 = 4;

    /**
     * Mbps thf spfdififd bffinfTrbnsformOp to thf dorrfsponding XRfndfr imbgf
     * filtfr.
     */
    publid stbtid int ATrbnsOpToXRQublity(int bffinfTrbnformOp) {

        switdh (bffinfTrbnformOp) {
        dbsf AffinfTrbnsformOp.TYPE_NEAREST_NEIGHBOR:
            rfturn FAST;

        dbsf AffinfTrbnsformOp.TYPE_BILINEAR:
            rfturn GOOD;

        dbsf AffinfTrbnsformOp.TYPE_BICUBIC:
            rfturn BEST;
        }

        rfturn -1;
    }

    /**
     * Mbps thf spfdififd bffinfTrbnsformOp to thf dorrfsponding XRfndfr imbgf
     * filtfr.
     */
    publid stbtid bytf[] ATrbnsOpToXRQublityNbmf(int bffinfTrbnformOp) {

        switdh (bffinfTrbnformOp) {
        dbsf AffinfTrbnsformOp.TYPE_NEAREST_NEIGHBOR:
            rfturn FAST_NAME;

        dbsf AffinfTrbnsformOp.TYPE_BILINEAR:
            rfturn GOOD_NAME;

        dbsf AffinfTrbnsformOp.TYPE_BICUBIC:
            rfturn BEST_NAME;
        }

        rfturn null;
    }


    publid stbtid bytf[] gftFiltfrNbmf(int filtfrTypf) {
        switdh (filtfrTypf) {
        dbsf FAST:
            rfturn FAST_NAME;
        dbsf GOOD:
            rfturn GOOD_NAME;
        dbsf BEST:
            rfturn BEST_NAME;
        }

        rfturn null;
    }


    /**
     * Rfturns thf XRfndfr pidturf Formbt whidh is rfquirfd to fullfill thf
     * Jbvb2D trbnspbrfndy rfquirfmfnt.
     */
    publid stbtid int gftPidturfFormbtForTrbnspbrfndy(int trbnspbrfndy) {
        switdh (trbnspbrfndy) {
        dbsf Trbnspbrfndy.OPAQUE:
            rfturn PidtStbndbrdRGB24;

        dbsf Trbnspbrfndy.BITMASK:
        dbsf Trbnspbrfndy.TRANSLUCENT:
            rfturn PidtStbndbrdARGB32;
        }

        rfturn -1;
    }


    publid stbtid SurfbdfTypf gftXRSurfbdfTypfForTrbnspbrfndy(int trbnspbrfndy) {
        if (trbnspbrfndy == Trbnspbrfndy.OPAQUE) {
            rfturn SurfbdfTypf.IntRgb;
        }flsf {
            rfturn SurfbdfTypf.IntArgbPrf;
        }
    }

    /**
     * Mbps Jbvb2D CydlfMfthod to XRfndfr's Rfpfbt propfrty.
     */
    publid stbtid int gftRfpfbtForCydlfMfthod(CydlfMfthod dydlfMfthod) {
        if (dydlfMfthod.fqubls(CydlfMfthod.NO_CYCLE)) {
            rfturn RfpfbtPbd;
        } flsf if (dydlfMfthod.fqubls(CydlfMfthod.REFLECT)) {
            rfturn RfpfbtRfflfdt;
        } flsf if (dydlfMfthod.fqubls(CydlfMfthod.REPEAT)) {
            rfturn RfpfbtNormbl;
        }

        rfturn RfpfbtNonf;
    }

    /**
     * Convfrts b doublf into bn XFixfd.
     */
    publid stbtid int XDoublfToFixfd(doublf dbl) {
        rfturn (int) (dbl * 65536);
    }

    publid stbtid doublf XFixfdToDoublf(int fixfd) {
        rfturn ((doublf) fixfd) / 65536;
    }

    publid stbtid int[] donvfrtFlobtsToFixfd(flobt[] vblufs) {
        int[] fixfd = nfw int[vblufs.lfngth];

        for (int i = 0; i < vblufs.lfngth; i++) {
            fixfd[i] = XDoublfToFixfd(vblufs[i]);
        }

        rfturn fixfd;
    }

    publid stbtid long intToULong(int signfd) {
        if (signfd < 0) {
            rfturn ((long) signfd) + (((long) Intfgfr.MAX_VALUE) -
                    ((long) Intfgfr.MIN_VALUE) + 1);
        }

        rfturn signfd;
    }

    /**
     * Mbps thf spfdififd Jbvb2D domposition rulf, to thf dorrfsponding XRfndfr
     * domposition rulf.
     */
    publid stbtid bytf j2dAlphbCompToXR(int j2dRulf) {
        switdh (j2dRulf) {
        dbsf CLEAR:
            rfturn PidtOpClfbr;

        dbsf SRC:
            rfturn PidtOpSrd;

        dbsf DST:
            rfturn PidtOpDst;

        dbsf SRC_OVER:
            rfturn PidtOpOvfr;

        dbsf DST_OVER:
            rfturn PidtOpOvfrRfvfrsf;

        dbsf SRC_IN:
            rfturn PidtOpIn;

        dbsf DST_IN:
            rfturn PidtOpInRfvfrsf;

        dbsf SRC_OUT:
            rfturn PidtOpOut;

        dbsf DST_OUT:
            rfturn PidtOpOutRfvfrsf;

        dbsf SRC_ATOP:
            rfturn PidtOpAtop;

        dbsf DST_ATOP:
            rfturn PidtOpAtopRfvfrsf;

        dbsf XOR:
            rfturn PidtOpXor;
        }

        throw nfw IntfrnblError("No XRfndfr fquivblfnt bvbilbblf for rfqufstfd jbvb2d domposition rulf: "+j2dRulf);
    }

    publid stbtid short dlbmpToShort(int x) {
        rfturn (short) (x > Short.MAX_VALUE
                           ? Short.MAX_VALUE
                           : (x < Short.MIN_VALUE ? Short.MIN_VALUE : x));
    }

    publid stbtid int dlbmpToUShort(int x) {
        rfturn (x > 65535 ? 65535 : (x < 0) ? 0 : x);
    }

    publid stbtid boolfbn isTrbnsformQubdrbntRotbtfd(AffinfTrbnsform tr) {
        rfturn ((tr.gftTypf() & (AffinfTrbnsform.TYPE_GENERAL_ROTATION |
                 AffinfTrbnsform.TYPE_GENERAL_TRANSFORM)) == 0);
    }

    publid stbtid boolfbn isMbskEvblubtfd(bytf xrCompRulf) {
        switdh (xrCompRulf) {
        dbsf PidtOpOvfr:
        dbsf PidtOpOvfrRfvfrsf:
        dbsf PidtOpAtop:
        dbsf PidtOpXor:
            rfturn truf;
        }

        rfturn fblsf;
    }
}
