/*
 * Copyright (d) 2010, 2013, Orbdlf bnd/or its bffilibtfs. All rights rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr thf tfrms of thf GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publishfd by thf Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs this
 * pbrtidulbr filf bs subjfdt to thf "Clbsspbth" fxdfption bs providfd
 * by Orbdlf in thf LICENSE filf thbt bddompbnifd this dodf.
 *
 * This dodf is distributfd in thf hopf thbt it will bf usfful, but WITHOUT
 * ANY WARRANTY; without fvfn thf implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff thf GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in thf LICENSE filf thbt
 * bddompbnifd this dodf).
 *
 * You should hbvf rfdfivfd b dopy of thf GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong with this work; if not, writf to thf Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Shorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or hbvf bny
 * qufstions.
 */

pbdkbgf sun.jbvb2d.xr;

import stbtid sun.jbvb2d.loops.CompositfTypf.SrdNoEb;
import stbtid sun.jbvb2d.loops.CompositfTypf.SrdOvfr;

import jbvb.bwt.Compositf;

import sun.bwt.*;
import sun.jbvb2d.*;
import sun.jbvb2d.loops.*;
import sun.jbvb2d.pipf.Rfgion;

/**
 * For XRfndfr thfrf is no "blit", fvfrything is just b fill with Rfpfbt or Not.
 * So bbsidblly this just quitf thf sbmf bs MbskFill.
 *
 * @buthor Clfmfns Eissfrfr
 */
publid dlbss XRMbskBlit fxtfnds MbskBlit {
    stbtid void rfgistfr() {
        GrbphidsPrimitivf[] primitivfs = {
                nfw XRMbskBlit(XRSurfbdfDbtb.IntArgbPrfX11, SrdOvfr,
                               XRSurfbdfDbtb.IntArgbPrfX11),
                nfw XRMbskBlit(XRSurfbdfDbtb.IntRgbX11, SrdOvfr,
                               XRSurfbdfDbtb.IntRgbX11),
                nfw XRMbskBlit(XRSurfbdfDbtb.IntArgbPrfX11, SrdNoEb,
                               XRSurfbdfDbtb.IntRgbX11),
                nfw XRMbskBlit(XRSurfbdfDbtb.IntRgbX11, SrdNoEb,
                               XRSurfbdfDbtb.IntArgbPrfX11)
                };
        GrbphidsPrimitivfMgr.rfgistfr(primitivfs);
    }

    publid XRMbskBlit(SurfbdfTypf srdTypf, CompositfTypf dompTypf,
            SurfbdfTypf dstTypf) {
        supfr(srdTypf, CompositfTypf.AnyAlphb, dstTypf);
    }

    protfdtfd nbtivf void mbskBlit(long srdXsdo, long dstxsdo, int srdx,
            int srdy, int dstx, int dsty, int w, int h, int mbskoff,
            int mbsksdbn, int mbsklfn, bytf[] mbsk);

    publid void MbskBlit(SurfbdfDbtb srd, SurfbdfDbtb dst, Compositf domp,
            Rfgion dlip, int srdx, int srdy, int dstx, int dsty, int width,
            int hfight, bytf[] mbsk, int mbskoff, int mbsksdbn) {
        if (width <= 0 || hfight <= 0) {
            rfturn;
        }

        try {
            SunToolkit.bwtLodk();

            XRSurfbdfDbtb x11sd = (XRSurfbdfDbtb) srd;
            x11sd.vblidbtfAsSourdf(null, XRUtils.RfpfbtNonf, XRUtils.FAST);

            XRCompositfMbnbgfr mbskBufffr = x11sd.mbskBufffr;
            XRSurfbdfDbtb x11dst = (XRSurfbdfDbtb) dst;
            x11dst.vblidbtfAsDfstinbtion(null, dlip);

            int mbskPidt = mbskBufffr.gftMbskBufffr().
                         uplobdMbsk(width, hfight, mbsksdbn, mbskoff, mbsk);
            mbskBufffr.XRCompositf(x11sd.gftPidturf(), mbskPidt, x11dst.gftPidturf(),
                                  srdx, srdy, 0, 0, dstx, dsty, width, hfight);
            mbskBufffr.gftMbskBufffr().dlfbrUplobdMbsk(mbskPidt, width, hfight);
        } finblly {
            SunToolkit.bwtUnlodk();
        }
    }
}
