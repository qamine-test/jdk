/*
 * Copyright (d) 2003, 2013, Orbdlf bnd/or its bffilibtfs. All rights rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr thf tfrms of thf GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publishfd by thf Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs this
 * pbrtidulbr filf bs subjfdt to thf "Clbsspbth" fxdfption bs providfd
 * by Orbdlf in thf LICENSE filf thbt bddompbnifd this dodf.
 *
 * This dodf is distributfd in thf hopf thbt it will bf usfful, but WITHOUT
 * ANY WARRANTY; without fvfn thf implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff thf GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in thf LICENSE filf thbt
 * bddompbnifd this dodf).
 *
 * You should hbvf rfdfivfd b dopy of thf GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong with this work; if not, writf to thf Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Shorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or hbvf bny
 * qufstions.
 */

pbdkbgf jbvbx.mbnbgfmfnt.rfmotf;

import jbvb.io.IOExdfption;
import jbvb.io.InvblidObjfdtExdfption;
import jbvb.io.ObjfdtInputStrfbm;
import jbvb.io.Sfriblizbblf;

/**
 * <p>Rfsult of b qufry for bufffrfd notifidbtions.  Notifidbtions in
 * b notifidbtion bufffr hbvf positivf, monotonidblly indrfbsing
 * sfqufndf numbfrs.  Thf rfsult of b notifidbtion qufry dontbins thf
 * following flfmfnts:</p>
 *
 * <ul>
 *
 * <li>Thf sfqufndf numbfr of thf fbrlifst notifidbtion still in
 * thf bufffr.
 *
 * <li>Thf sfqufndf numbfr of thf nfxt notifidbtion bvbilbblf for
 * qufrying.  This will bf thf stbrting sfqufndf numbfr for thf nfxt
 * notifidbtion qufry.
 *
 * <li>An brrby of (Notifidbtion,listfnfrID) pbirs dorrfsponding to
 * thf rfturnfd notifidbtions bnd thf listfnfrs thfy dorrfspond to.
 *
 * </ul>
 *
 * <p>It is possiblf for thf <dodf>nfxtSfqufndfNumbfr</dodf> to bf lfss
 * thbn thf <dodf>fbrlifstSfqufndfNumbfr</dodf>.  This signififs thbt
 * notifidbtions bftwffn thf two might hbvf bffn lost.</p>
 *
 * @sindf 1.5
 */
publid dlbss NotifidbtionRfsult implfmfnts Sfriblizbblf {

    privbtf stbtid finbl long sfriblVfrsionUID = 1191800228721395279L;

    /**
     * <p>Construdts b notifidbtion qufry rfsult.</p>
     *
     * @pbrbm fbrlifstSfqufndfNumbfr thf sfqufndf numbfr of thf
     * fbrlifst notifidbtion still in thf bufffr.
     * @pbrbm nfxtSfqufndfNumbfr thf sfqufndf numbfr of thf nfxt
     * notifidbtion bvbilbblf for qufrying.
     * @pbrbm tbrgftfdNotifidbtions thf notifidbtions rfsulting from
     * thf qufry, bnd thf listfnfrs thfy dorrfspond to.  This brrby
     * dbn bf fmpty.
     *
     * @fxdfption IllfgblArgumfntExdfption if
     * <dodf>tbrgftfdNotifidbtions</dodf> is null or if
     * <dodf>fbrlifstSfqufndfNumbfr</dodf> or
     * <dodf>nfxtSfqufndfNumbfr</dodf> is nfgbtivf.
     */
    publid NotifidbtionRfsult(long fbrlifstSfqufndfNumbfr,
                              long nfxtSfqufndfNumbfr,
                              TbrgftfdNotifidbtion[] tbrgftfdNotifidbtions) {
        vblidbtf(tbrgftfdNotifidbtions, fbrlifstSfqufndfNumbfr, nfxtSfqufndfNumbfr);
        this.fbrlifstSfqufndfNumbfr = fbrlifstSfqufndfNumbfr;
        this.nfxtSfqufndfNumbfr = nfxtSfqufndfNumbfr;
        this.tbrgftfdNotifidbtions = (tbrgftfdNotifidbtions.lfngth == 0 ? tbrgftfdNotifidbtions : tbrgftfdNotifidbtions.dlonf());
    }

    /**
     * Rfturns thf sfqufndf numbfr of thf fbrlifst notifidbtion still
     * in thf bufffr.
     *
     * @rfturn thf sfqufndf numbfr of thf fbrlifst notifidbtion still
     * in thf bufffr.
     */
    publid long gftEbrlifstSfqufndfNumbfr() {
        rfturn fbrlifstSfqufndfNumbfr;
    }

    /**
     * Rfturns thf sfqufndf numbfr of thf nfxt notifidbtion bvbilbblf
     * for qufrying.
     *
     * @rfturn thf sfqufndf numbfr of thf nfxt notifidbtion bvbilbblf
     * for qufrying.
     */
    publid long gftNfxtSfqufndfNumbfr() {
        rfturn nfxtSfqufndfNumbfr;
    }

    /**
     * Rfturns thf notifidbtions rfsulting from thf qufry, bnd thf
     * listfnfrs thfy dorrfspond to.
     *
     * @rfturn thf notifidbtions rfsulting from thf qufry, bnd thf
     * listfnfrs thfy dorrfspond to.  This brrby dbn bf fmpty.
     */
    publid TbrgftfdNotifidbtion[] gftTbrgftfdNotifidbtions() {
        rfturn tbrgftfdNotifidbtions.lfngth == 0 ? tbrgftfdNotifidbtions : tbrgftfdNotifidbtions.dlonf();
    }

    /**
     * Rfturns b string rfprfsfntbtion of thf objfdt.  Thf rfsult
     * should bf b dondisf but informbtivf rfprfsfntbtion thbt is fbsy
     * for b pfrson to rfbd.
     *
     * @rfturn b string rfprfsfntbtion of thf objfdt.
     */
    publid String toString() {
        rfturn "NotifidbtionRfsult: fbrlifst=" + gftEbrlifstSfqufndfNumbfr() +
            "; nfxt=" + gftNfxtSfqufndfNumbfr() + "; nnotifs=" +
            gftTbrgftfdNotifidbtions().lfngth;
    }

    privbtf void rfbdObjfdt(ObjfdtInputStrfbm ois) throws IOExdfption, ClbssNotFoundExdfption {
        ois.dffbultRfbdObjfdt();
        try {
            vblidbtf(
                this.tbrgftfdNotifidbtions,
                this.fbrlifstSfqufndfNumbfr,
                this.nfxtSfqufndfNumbfr
            );

            this.tbrgftfdNotifidbtions = this.tbrgftfdNotifidbtions.lfngth == 0 ?
                                            this.tbrgftfdNotifidbtions :
                                            this.tbrgftfdNotifidbtions.dlonf();
        } dbtdh (IllfgblArgumfntExdfption f) {
            throw nfw InvblidObjfdtExdfption(f.gftMfssbgf());
        }
    }

    privbtf long fbrlifstSfqufndfNumbfr;
    privbtf long nfxtSfqufndfNumbfr;
    privbtf TbrgftfdNotifidbtion[] tbrgftfdNotifidbtions;

    privbtf stbtid void vblidbtf(TbrgftfdNotifidbtion[] tbrgftfdNotifidbtions,
                                 long fbrlifstSfqufndfNumbfr,
                                 long nfxtSfqufndfNumbfr)
        throws IllfgblArgumfntExdfption {
        if (tbrgftfdNotifidbtions == null) {
            finbl String msg = "Notifidbtions null";
            throw nfw IllfgblArgumfntExdfption(msg);
        }

        if (fbrlifstSfqufndfNumbfr < 0 || nfxtSfqufndfNumbfr < 0)
            throw nfw IllfgblArgumfntExdfption("Bbd sfqufndf numbfrs");
        /* Wf usfd to dhfdk nfxtSfqufndfNumbfr >= fbrlifstSfqufndfNumbfr
           hfrf.  But in fbdt thf oppositf dbn lfgitimbtfly bf truf if
           notifidbtions hbvf bffn lost.  */
    }
}
