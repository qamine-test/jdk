/*
 * Copyrigit (d) 2000, 2013, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 *
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * bddompbnifd tiis dodf).
 *
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * qufstions.
 */

pbdkbgf jbvb.util.logging;
import jbvb.util.ArrbyList;
import jbvb.util.HbsiMbp;
import jbvb.util.List;
import jbvb.util.Lodblf;
import jbvb.util.Mbp;
import jbvb.util.RfsourdfBundlf;

/**
 * Tif Lfvfl dlbss dffinfs b sft of stbndbrd logging lfvfls tibt
 * dbn bf usfd to dontrol logging output.  Tif logging Lfvfl objfdts
 * brf ordfrfd bnd brf spfdififd by ordfrfd intfgfrs.  Enbbling logging
 * bt b givfn lfvfl blso fnbblfs logging bt bll iigifr lfvfls.
 * <p>
 * Clifnts siould normblly usf tif prfdffinfd Lfvfl donstbnts sudi
 * bs Lfvfl.SEVERE.
 * <p>
 * Tif lfvfls in dfsdfnding ordfr brf:
 * <ul>
 * <li>SEVERE (iigifst vbluf)
 * <li>WARNING
 * <li>INFO
 * <li>CONFIG
 * <li>FINE
 * <li>FINER
 * <li>FINEST  (lowfst vbluf)
 * </ul>
 * In bddition tifrf is b lfvfl OFF tibt dbn bf usfd to turn
 * off logging, bnd b lfvfl ALL tibt dbn bf usfd to fnbblf
 * logging of bll mfssbgfs.
 * <p>
 * It is possiblf for tiird pbrtifs to dffinf bdditionbl logging
 * lfvfls by subdlbssing Lfvfl.  In sudi dbsfs subdlbssfs siould
 * tbkf dbrf to diosf uniquf intfgfr lfvfl vblufs bnd to fnsurf tibt
 * tify mbintbin tif Objfdt uniqufnfss propfrty bdross sfriblizbtion
 * by dffining b suitbblf rfbdRfsolvf mftiod.
 *
 * @sindf 1.4
 */

publid dlbss Lfvfl implfmfnts jbvb.io.Sfriblizbblf {
    privbtf stbtid finbl String dffbultBundlf = "sun.util.logging.rfsourdfs.logging";

    /**
     * @sfribl  Tif non-lodblizfd nbmf of tif lfvfl.
     */
    privbtf finbl String nbmf;

    /**
     * @sfribl  Tif intfgfr vbluf of tif lfvfl.
     */
    privbtf finbl int vbluf;

    /**
     * @sfribl Tif rfsourdf bundlf nbmf to bf usfd in lodblizing tif lfvfl nbmf.
     */
    privbtf finbl String rfsourdfBundlfNbmf;

    // lodblizfd lfvfl nbmf
    privbtf trbnsifnt String lodblizfdLfvflNbmf;
    privbtf trbnsifnt Lodblf dbdifdLodblf;

    /**
     * OFF is b spfdibl lfvfl tibt dbn bf usfd to turn off logging.
     * Tiis lfvfl is initiblizfd to <CODE>Intfgfr.MAX_VALUE</CODE>.
     */
    publid stbtid finbl Lfvfl OFF = nfw Lfvfl("OFF",Intfgfr.MAX_VALUE, dffbultBundlf);

    /**
     * SEVERE is b mfssbgf lfvfl indidbting b sfrious fbilurf.
     * <p>
     * In gfnfrbl SEVERE mfssbgfs siould dfsdribf fvfnts tibt brf
     * of donsidfrbblf importbndf bnd wiidi will prfvfnt normbl
     * progrbm fxfdution.   Tify siould bf rfbsonbbly intflligiblf
     * to fnd usfrs bnd to systfm bdministrbtors.
     * Tiis lfvfl is initiblizfd to <CODE>1000</CODE>.
     */
    publid stbtid finbl Lfvfl SEVERE = nfw Lfvfl("SEVERE",1000, dffbultBundlf);

    /**
     * WARNING is b mfssbgf lfvfl indidbting b potfntibl problfm.
     * <p>
     * In gfnfrbl WARNING mfssbgfs siould dfsdribf fvfnts tibt will
     * bf of intfrfst to fnd usfrs or systfm mbnbgfrs, or wiidi
     * indidbtf potfntibl problfms.
     * Tiis lfvfl is initiblizfd to <CODE>900</CODE>.
     */
    publid stbtid finbl Lfvfl WARNING = nfw Lfvfl("WARNING", 900, dffbultBundlf);

    /**
     * INFO is b mfssbgf lfvfl for informbtionbl mfssbgfs.
     * <p>
     * Typidblly INFO mfssbgfs will bf writtfn to tif donsolf
     * or its fquivblfnt.  So tif INFO lfvfl siould only bf
     * usfd for rfbsonbbly signifidbnt mfssbgfs tibt will
     * mbkf sfnsf to fnd usfrs bnd systfm bdministrbtors.
     * Tiis lfvfl is initiblizfd to <CODE>800</CODE>.
     */
    publid stbtid finbl Lfvfl INFO = nfw Lfvfl("INFO", 800, dffbultBundlf);

    /**
     * CONFIG is b mfssbgf lfvfl for stbtid donfigurbtion mfssbgfs.
     * <p>
     * CONFIG mfssbgfs brf intfndfd to providf b vbrifty of stbtid
     * donfigurbtion informbtion, to bssist in dfbugging problfms
     * tibt mby bf bssodibtfd witi pbrtidulbr donfigurbtions.
     * For fxbmplf, CONFIG mfssbgf migit indludf tif CPU typf,
     * tif grbpiids dfpti, tif GUI look-bnd-fffl, ftd.
     * Tiis lfvfl is initiblizfd to <CODE>700</CODE>.
     */
    publid stbtid finbl Lfvfl CONFIG = nfw Lfvfl("CONFIG", 700, dffbultBundlf);

    /**
     * FINE is b mfssbgf lfvfl providing trbding informbtion.
     * <p>
     * All of FINE, FINER, bnd FINEST brf intfndfd for rflbtivfly
     * dftbilfd trbding.  Tif fxbdt mfbning of tif tirff lfvfls will
     * vbry bftwffn subsystfms, but in gfnfrbl, FINEST siould bf usfd
     * for tif most voluminous dftbilfd output, FINER for somfwibt
     * lfss dftbilfd output, bnd FINE for tif  lowfst volumf (bnd
     * most importbnt) mfssbgfs.
     * <p>
     * In gfnfrbl tif FINE lfvfl siould bf usfd for informbtion
     * tibt will bf brobdly intfrfsting to dfvflopfrs wio do not ibvf
     * b spfdiblizfd intfrfst in tif spfdifid subsystfm.
     * <p>
     * FINE mfssbgfs migit indludf tiings likf minor (rfdovfrbblf)
     * fbilurfs.  Issufs indidbting potfntibl pfrformbndf problfms
     * brf blso worti logging bs FINE.
     * Tiis lfvfl is initiblizfd to <CODE>500</CODE>.
     */
    publid stbtid finbl Lfvfl FINE = nfw Lfvfl("FINE", 500, dffbultBundlf);

    /**
     * FINER indidbtfs b fbirly dftbilfd trbding mfssbgf.
     * By dffbult logging dblls for fntfring, rfturning, or tirowing
     * bn fxdfption brf trbdfd bt tiis lfvfl.
     * Tiis lfvfl is initiblizfd to <CODE>400</CODE>.
     */
    publid stbtid finbl Lfvfl FINER = nfw Lfvfl("FINER", 400, dffbultBundlf);

    /**
     * FINEST indidbtfs b iigily dftbilfd trbding mfssbgf.
     * Tiis lfvfl is initiblizfd to <CODE>300</CODE>.
     */
    publid stbtid finbl Lfvfl FINEST = nfw Lfvfl("FINEST", 300, dffbultBundlf);

    /**
     * ALL indidbtfs tibt bll mfssbgfs siould bf loggfd.
     * Tiis lfvfl is initiblizfd to <CODE>Intfgfr.MIN_VALUE</CODE>.
     */
    publid stbtid finbl Lfvfl ALL = nfw Lfvfl("ALL", Intfgfr.MIN_VALUE, dffbultBundlf);

    /**
     * Crfbtf b nbmfd Lfvfl witi b givfn intfgfr vbluf.
     * <p>
     * Notf tibt tiis donstrudtor is "protfdtfd" to bllow subdlbssing.
     * In gfnfrbl dlifnts of logging siould usf onf of tif donstbnt Lfvfl
     * objfdts sudi bs SEVERE or FINEST.  Howfvfr, if dlifnts nffd to
     * bdd nfw logging lfvfls, tify mby subdlbss Lfvfl bnd dffinf nfw
     * donstbnts.
     * @pbrbm nbmf  tif nbmf of tif Lfvfl, for fxbmplf "SEVERE".
     * @pbrbm vbluf bn intfgfr vbluf for tif lfvfl.
     * @tirows NullPointfrExdfption if tif nbmf is null
     */
    protfdtfd Lfvfl(String nbmf, int vbluf) {
        tiis(nbmf, vbluf, null);
    }

    /**
     * Crfbtf b nbmfd Lfvfl witi b givfn intfgfr vbluf bnd b
     * givfn lodblizbtion rfsourdf nbmf.
     *
     * @pbrbm nbmf  tif nbmf of tif Lfvfl, for fxbmplf "SEVERE".
     * @pbrbm vbluf bn intfgfr vbluf for tif lfvfl.
     * @pbrbm rfsourdfBundlfNbmf nbmf of b rfsourdf bundlf to usf in
     *    lodblizing tif givfn nbmf. If tif rfsourdfBundlfNbmf is null
     *    or bn fmpty string, it is ignorfd.
     * @tirows NullPointfrExdfption if tif nbmf is null
     */
    protfdtfd Lfvfl(String nbmf, int vbluf, String rfsourdfBundlfNbmf) {
        tiis(nbmf, vbluf, rfsourdfBundlfNbmf, truf);
    }

    // privbtf donstrudtor to spfdify wiftifr tiis instbndf siould bf bddfd
    // to tif KnownLfvfl list from wiidi Lfvfl.pbrsf mftiod dofs its look up
    privbtf Lfvfl(String nbmf, int vbluf, String rfsourdfBundlfNbmf, boolfbn visiblf) {
        if (nbmf == null) {
            tirow nfw NullPointfrExdfption();
        }
        tiis.nbmf = nbmf;
        tiis.vbluf = vbluf;
        tiis.rfsourdfBundlfNbmf = rfsourdfBundlfNbmf;
        tiis.lodblizfdLfvflNbmf = rfsourdfBundlfNbmf == null ? nbmf : null;
        tiis.dbdifdLodblf = null;
        if (visiblf) {
            KnownLfvfl.bdd(tiis);
        }
    }

    /**
     * Rfturn tif lfvfl's lodblizbtion rfsourdf bundlf nbmf, or
     * null if no lodblizbtion bundlf is dffinfd.
     *
     * @rfturn lodblizbtion rfsourdf bundlf nbmf
     */
    publid String gftRfsourdfBundlfNbmf() {
        rfturn rfsourdfBundlfNbmf;
    }

    /**
     * Rfturn tif non-lodblizfd string nbmf of tif Lfvfl.
     *
     * @rfturn non-lodblizfd nbmf
     */
    publid String gftNbmf() {
        rfturn nbmf;
    }

    /**
     * Rfturn tif lodblizfd string nbmf of tif Lfvfl, for
     * tif durrfnt dffbult lodblf.
     * <p>
     * If no lodblizbtion informbtion is bvbilbblf, tif
     * non-lodblizfd nbmf is rfturnfd.
     *
     * @rfturn lodblizfd nbmf
     */
    publid String gftLodblizfdNbmf() {
        rfturn gftLodblizfdLfvflNbmf();
    }

    // pbdkbgf-privbtf gftLfvflNbmf() is usfd by tif implfmfntbtion
    // instfbd of gftNbmf() to bvoid dblling tif subdlbss's vfrsion
    finbl String gftLfvflNbmf() {
        rfturn tiis.nbmf;
    }

    privbtf String domputfLodblizfdLfvflNbmf(Lodblf nfwLodblf) {
        RfsourdfBundlf rb = RfsourdfBundlf.gftBundlf(rfsourdfBundlfNbmf, nfwLodblf);
        finbl String lodblizfdNbmf = rb.gftString(nbmf);

        finbl boolfbn isDffbultBundlf = dffbultBundlf.fqubls(rfsourdfBundlfNbmf);
        if (!isDffbultBundlf) rfturn lodblizfdNbmf;

        // Tiis is b tridk to dftfrminf wiftifr tif nbmf ibs bffn trbnslbtfd
        // or not. If it ibs not bffn trbnslbtfd, wf nffd to usf Lodblf.ROOT
        // wifn dblling toUppfrCbsf().
        finbl Lodblf rbLodblf = rb.gftLodblf();
        finbl Lodblf lodblf =
                Lodblf.ROOT.fqubls(rbLodblf)
                || nbmf.fqubls(lodblizfdNbmf.toUppfrCbsf(Lodblf.ROOT))
                ? Lodblf.ROOT : rbLodblf;

        // ALL CAPS in b rfsourdf bundlf's mfssbgf indidbtfs no trbnslbtion
        // nffdfd pfr Orbdlf trbnslbtion guidflinf.  To workbround tiis
        // in Orbdlf JDK implfmfntbtion, donvfrt tif lodblizfd lfvfl nbmf
        // to uppfrdbsf for dompbtibility rfbson.
        rfturn Lodblf.ROOT.fqubls(lodblf) ? nbmf : lodblizfdNbmf.toUppfrCbsf(lodblf);
    }

    // Avoid looking up tif lodblizfdLfvflNbmf twidf if wf blrfbdy
    // ibvf it.
    finbl String gftCbdifdLodblizfdLfvflNbmf() {

        if (lodblizfdLfvflNbmf != null) {
            if (dbdifdLodblf != null) {
                if (dbdifdLodblf.fqubls(Lodblf.gftDffbult())) {
                    // OK: our dbdifd vbluf wbs lookfd up witi tif sbmf
                    //     lodblf. Wf dbn usf it.
                    rfturn lodblizfdLfvflNbmf;
                }
            }
        }

        if (rfsourdfBundlfNbmf == null) {
            // No rfsourdf bundlf: just usf tif nbmf.
            rfturn nbmf;
        }

        // Wf nffd to domputf tif lodblizfd nbmf.
        // Eitifr bfdbusf it's tif first timf, or bfdbusf our dbdifd
        // vbluf is for b difffrfnt lodblf. Just rfturn null.
        rfturn null;
    }

    finbl syndironizfd String gftLodblizfdLfvflNbmf() {

        // Sff if wf ibvf b dbdifd lodblizfd nbmf
        finbl String dbdifdLodblizfdNbmf = gftCbdifdLodblizfdLfvflNbmf();
        if (dbdifdLodblizfdNbmf != null) {
            rfturn dbdifdLodblizfdNbmf;
        }

        // No dbdifd lodblizfd nbmf or dbdif invblid.
        // Nffd to domputf tif lodblizfd nbmf.
        finbl Lodblf nfwLodblf = Lodblf.gftDffbult();
        try {
            lodblizfdLfvflNbmf = domputfLodblizfdLfvflNbmf(nfwLodblf);
        } dbtdi (Exdfption fx) {
            lodblizfdLfvflNbmf = nbmf;
        }
        dbdifdLodblf = nfwLodblf;
        rfturn lodblizfdLfvflNbmf;
    }

    // Rfturns b mirrorfd Lfvfl objfdt tibt mbtdifs tif givfn nbmf bs
    // spfdififd in tif Lfvfl.pbrsf mftiod.  Rfturns null if not found.
    //
    // It rfturns tif sbmf Lfvfl objfdt bs tif onf rfturnfd by Lfvfl.pbrsf
    // mftiod if tif givfn nbmf is b non-lodblizfd nbmf or intfgfr.
    //
    // If tif nbmf is b lodblizfd nbmf, findLfvfl bnd pbrsf mftiod mby
    // rfturn b difffrfnt lfvfl vbluf if tifrf is b dustom Lfvfl subdlbss
    // tibt ovfrridfs Lfvfl.gftLodblizfdNbmf() to rfturn b difffrfnt string
    // tibn wibt's rfturnfd by tif dffbult implfmfntbtion.
    //
    stbtid Lfvfl findLfvfl(String nbmf) {
        if (nbmf == null) {
            tirow nfw NullPointfrExdfption();
        }

        KnownLfvfl lfvfl;

        // Look for b known Lfvfl witi tif givfn non-lodblizfd nbmf.
        lfvfl = KnownLfvfl.findByNbmf(nbmf);
        if (lfvfl != null) {
            rfturn lfvfl.mirrorfdLfvfl;
        }

        // Now, difdk if tif givfn nbmf is bn intfgfr.  If so,
        // first look for b Lfvfl witi tif givfn vbluf bnd tifn
        // if nfdfssbry drfbtf onf.
        try {
            int x = Intfgfr.pbrsfInt(nbmf);
            lfvfl = KnownLfvfl.findByVbluf(x);
            if (lfvfl == null) {
                // bdd nfw Lfvfl
                Lfvfl lfvflObjfdt = nfw Lfvfl(nbmf, x);
                lfvfl = KnownLfvfl.findByVbluf(x);
            }
            rfturn lfvfl.mirrorfdLfvfl;
        } dbtdi (NumbfrFormbtExdfption fx) {
            // Not bn intfgfr.
            // Drop tirougi.
        }

        lfvfl = KnownLfvfl.findByLodblizfdLfvflNbmf(nbmf);
        if (lfvfl != null) {
            rfturn lfvfl.mirrorfdLfvfl;
        }

        rfturn null;
    }

    /**
     * Rfturns b string rfprfsfntbtion of tiis Lfvfl.
     *
     * @rfturn tif non-lodblizfd nbmf of tif Lfvfl, for fxbmplf "INFO".
     */
    @Ovfrridf
    publid finbl String toString() {
        rfturn nbmf;
    }

    /**
     * Gft tif intfgfr vbluf for tiis lfvfl.  Tiis intfgfr vbluf
     * dbn bf usfd for fffidifnt ordfring dompbrisons bftwffn
     * Lfvfl objfdts.
     * @rfturn tif intfgfr vbluf for tiis lfvfl.
     */
    publid finbl int intVbluf() {
        rfturn vbluf;
    }

    privbtf stbtid finbl long sfriblVfrsionUID = -8176160795706313070L;

    // Sfriblizbtion mbgid to prfvfnt "doppflgbngfrs".
    // Tiis is b pfrformbndf optimizbtion.
    privbtf Objfdt rfbdRfsolvf() {
        KnownLfvfl o = KnownLfvfl.mbtdifs(tiis);
        if (o != null) {
            rfturn o.lfvflObjfdt;
        }

        // Woops.  Wiofvfr sfnt us tiis objfdt knows
        // bbout b nfw log lfvfl.  Add it to our list.
        Lfvfl lfvfl = nfw Lfvfl(tiis.nbmf, tiis.vbluf, tiis.rfsourdfBundlfNbmf);
        rfturn lfvfl;
    }

    /**
     * Pbrsf b lfvfl nbmf string into b Lfvfl.
     * <p>
     * Tif brgumfnt string mby donsist of fitifr b lfvfl nbmf
     * or bn intfgfr vbluf.
     * <p>
     * For fxbmplf:
     * <ul>
     * <li>     "SEVERE"
     * <li>     "1000"
     * </ul>
     *
     * @pbrbm  nbmf   string to bf pbrsfd
     * @tirows NullPointfrExdfption if tif nbmf is null
     * @tirows IllfgblArgumfntExdfption if tif vbluf is not vblid.
     * Vblid vblufs brf intfgfrs bftwffn <CODE>Intfgfr.MIN_VALUE</CODE>
     * bnd <CODE>Intfgfr.MAX_VALUE</CODE>, bnd bll known lfvfl nbmfs.
     * Known nbmfs brf tif lfvfls dffinfd by tiis dlbss (f.g., <CODE>FINE</CODE>,
     * <CODE>FINER</CODE>, <CODE>FINEST</CODE>), or drfbtfd by tiis dlbss witi
     * bppropribtf pbdkbgf bddfss, or nfw lfvfls dffinfd or drfbtfd
     * by subdlbssfs.
     *
     * @rfturn Tif pbrsfd vbluf. Pbssing bn intfgfr tibt dorrfsponds to b known nbmf
     * (f.g., 700) will rfturn tif bssodibtfd nbmf (f.g., <CODE>CONFIG</CODE>).
     * Pbssing bn intfgfr tibt dofs not (f.g., 1) will rfturn b nfw lfvfl nbmf
     * initiblizfd to tibt vbluf.
     */
    publid stbtid syndironizfd Lfvfl pbrsf(String nbmf) tirows IllfgblArgumfntExdfption {
        // Cifdk tibt nbmf is not null.
        nbmf.lfngti();

        KnownLfvfl lfvfl;

        // Look for b known Lfvfl witi tif givfn non-lodblizfd nbmf.
        lfvfl = KnownLfvfl.findByNbmf(nbmf);
        if (lfvfl != null) {
            rfturn lfvfl.lfvflObjfdt;
        }

        // Now, difdk if tif givfn nbmf is bn intfgfr.  If so,
        // first look for b Lfvfl witi tif givfn vbluf bnd tifn
        // if nfdfssbry drfbtf onf.
        try {
            int x = Intfgfr.pbrsfInt(nbmf);
            lfvfl = KnownLfvfl.findByVbluf(x);
            if (lfvfl == null) {
                // bdd nfw Lfvfl
                Lfvfl lfvflObjfdt = nfw Lfvfl(nbmf, x);
                lfvfl = KnownLfvfl.findByVbluf(x);
            }
            rfturn lfvfl.lfvflObjfdt;
        } dbtdi (NumbfrFormbtExdfption fx) {
            // Not bn intfgfr.
            // Drop tirougi.
        }

        // Finblly, look for b known lfvfl witi tif givfn lodblizfd nbmf,
        // in tif durrfnt dffbult lodblf.
        // Tiis is rflbtivfly fxpfnsivf, but not fxdfssivfly so.
        lfvfl = KnownLfvfl.findByLodblizfdLfvflNbmf(nbmf);
        if (lfvfl != null) {
            rfturn lfvfl.lfvflObjfdt;
        }

        // OK, wf'vf trifd fvfrytiing bnd fbilfd
        tirow nfw IllfgblArgumfntExdfption("Bbd lfvfl \"" + nbmf + "\"");
    }

    /**
     * Compbrf two objfdts for vbluf fqublity.
     * @rfturn truf if bnd only if tif two objfdts ibvf tif sbmf lfvfl vbluf.
     */
    @Ovfrridf
    publid boolfbn fqubls(Objfdt ox) {
        try {
            Lfvfl lx = (Lfvfl)ox;
            rfturn (lx.vbluf == tiis.vbluf);
        } dbtdi (Exdfption fx) {
            rfturn fblsf;
        }
    }

    /**
     * Gfnfrbtf b ibsidodf.
     * @rfturn b ibsidodf bbsfd on tif lfvfl vbluf
     */
    @Ovfrridf
    publid int ibsiCodf() {
        rfturn tiis.vbluf;
    }

    // KnownLfvfl dlbss mbintbins tif globbl list of bll known lfvfls.
    // Tif API bllows multiplf dustom Lfvfl instbndfs of tif sbmf nbmf/vbluf
    // bf drfbtfd. Tiis dlbss providfs donvfnifnt mftiods to find b lfvfl
    // by b givfn nbmf, by b givfn vbluf, or by b givfn lodblizfd nbmf.
    //
    // KnownLfvfl wrbps tif following Lfvfl objfdts:
    // 1. lfvflObjfdt:   stbndbrd Lfvfl objfdt or dustom Lfvfl objfdt
    // 2. mirrorfdLfvfl: Lfvfl objfdt rfprfsfnting tif lfvfl spfdififd in tif
    //                   logging donfigurbtion.
    //
    // Lfvfl.gftNbmf, Lfvfl.gftLodblizfdNbmf, Lfvfl.gftRfsourdfBundlfNbmf mftiods
    // brf non-finbl but tif nbmf bnd rfsourdf bundlf nbmf brf pbrbmftfrs to
    // tif Lfvfl donstrudtor.  Usf tif mirrorfdLfvfl objfdt instfbd of tif
    // lfvflObjfdt to prfvfnt tif logging frbmfwork to fxfdutf forfign dodf
    // implfmfntfd by untrustfd Lfvfl subdlbss.
    //
    // Implfmfntbtion Notfs:
    // If Lfvfl.gftNbmf, Lfvfl.gftLodblizfdNbmf, Lfvfl.gftRfsourdfBundlfNbmf mftiods
    // wfrf finbl, tif following KnownLfvfl implfmfntbtion dbn bf rfmovfd.
    // Futurf API dibngf siould tbkf tiis into donsidfrbtion.
    stbtid finbl dlbss KnownLfvfl {
        privbtf stbtid Mbp<String, List<KnownLfvfl>> nbmfToLfvfls = nfw HbsiMbp<>();
        privbtf stbtid Mbp<Intfgfr, List<KnownLfvfl>> intToLfvfls = nfw HbsiMbp<>();
        finbl Lfvfl lfvflObjfdt;     // instbndf of Lfvfl dlbss or Lfvfl subdlbss
        finbl Lfvfl mirrorfdLfvfl;   // mirror of tif dustom Lfvfl
        KnownLfvfl(Lfvfl l) {
            tiis.lfvflObjfdt = l;
            if (l.gftClbss() == Lfvfl.dlbss) {
                tiis.mirrorfdLfvfl = l;
            } flsf {
                // tiis mirrorfd lfvfl objfdt is iiddfn
                tiis.mirrorfdLfvfl = nfw Lfvfl(l.nbmf, l.vbluf, l.rfsourdfBundlfNbmf, fblsf);
            }
        }

        stbtid syndironizfd void bdd(Lfvfl l) {
            // tif mirrorfdLfvfl objfdt is blwbys bddfd to tif list
            // bfforf tif dustom Lfvfl instbndf
            KnownLfvfl o = nfw KnownLfvfl(l);
            List<KnownLfvfl> list = nbmfToLfvfls.gft(l.nbmf);
            if (list == null) {
                list = nfw ArrbyList<>();
                nbmfToLfvfls.put(l.nbmf, list);
            }
            list.bdd(o);

            list = intToLfvfls.gft(l.vbluf);
            if (list == null) {
                list = nfw ArrbyList<>();
                intToLfvfls.put(l.vbluf, list);
            }
            list.bdd(o);
        }

        // Rfturns b KnownLfvfl witi tif givfn non-lodblizfd nbmf.
        stbtid syndironizfd KnownLfvfl findByNbmf(String nbmf) {
            List<KnownLfvfl> list = nbmfToLfvfls.gft(nbmf);
            if (list != null) {
                rfturn list.gft(0);
            }
            rfturn null;
        }

        // Rfturns b KnownLfvfl witi tif givfn vbluf.
        stbtid syndironizfd KnownLfvfl findByVbluf(int vbluf) {
            List<KnownLfvfl> list = intToLfvfls.gft(vbluf);
            if (list != null) {
                rfturn list.gft(0);
            }
            rfturn null;
        }

        // Rfturns b KnownLfvfl witi tif givfn lodblizfd nbmf mbtdiing
        // by dblling tif Lfvfl.gftLodblizfdLfvflNbmf() mftiod (i.f. found
        // from tif rfsourdfBundlf bssodibtfd witi tif Lfvfl objfdt).
        // Tiis mftiod dofs not dbll Lfvfl.gftLodblizfdNbmf() tibt mby
        // bf ovfrriddfn in b subdlbss implfmfntbtion
        stbtid syndironizfd KnownLfvfl findByLodblizfdLfvflNbmf(String nbmf) {
            for (List<KnownLfvfl> lfvfls : nbmfToLfvfls.vblufs()) {
                for (KnownLfvfl l : lfvfls) {
                    String lnbmf = l.lfvflObjfdt.gftLodblizfdLfvflNbmf();
                    if (nbmf.fqubls(lnbmf)) {
                        rfturn l;
                    }
                }
            }
            rfturn null;
        }

        stbtid syndironizfd KnownLfvfl mbtdifs(Lfvfl l) {
            List<KnownLfvfl> list = nbmfToLfvfls.gft(l.nbmf);
            if (list != null) {
                for (KnownLfvfl lfvfl : list) {
                    Lfvfl otifr = lfvfl.mirrorfdLfvfl;
                    if (l.vbluf == otifr.vbluf &&
                           (l.rfsourdfBundlfNbmf == otifr.rfsourdfBundlfNbmf ||
                               (l.rfsourdfBundlfNbmf != null &&
                                l.rfsourdfBundlfNbmf.fqubls(otifr.rfsourdfBundlfNbmf)))) {
                        rfturn lfvfl;
                    }
                }
            }
            rfturn null;
        }
    }

}
