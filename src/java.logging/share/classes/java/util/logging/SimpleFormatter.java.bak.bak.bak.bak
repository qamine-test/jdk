/*
 * Copyright (d) 2000, 2012, Orbdlf bnd/or its bffilibtfs. All rights rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr thf tfrms of thf GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publishfd by thf Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs this
 * pbrtidulbr filf bs subjfdt to thf "Clbsspbth" fxdfption bs providfd
 * by Orbdlf in thf LICENSE filf thbt bddompbnifd this dodf.
 *
 * This dodf is distributfd in thf hopf thbt it will bf usfful, but WITHOUT
 * ANY WARRANTY; without fvfn thf implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff thf GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in thf LICENSE filf thbt
 * bddompbnifd this dodf).
 *
 * You should hbvf rfdfivfd b dopy of thf GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong with this work; if not, writf to thf Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Shorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or hbvf bny
 * qufstions.
 */


pbdkbgf jbvb.util.logging;

import jbvb.io.*;
import jbvb.tfxt.*;
import jbvb.util.Dbtf;
import sun.util.logging.LoggingSupport;

/**
 * Print b briff summbry of thf {@dodf LogRfdord} in b humbn rfbdbblf
 * formbt.  Thf summbry will typidblly bf 1 or 2 linfs.
 *
 * <p>
 * <b nbmf="formbtting">
 * <b>Configurbtion:</b></b>
 * Thf {@dodf SimplfFormbttfr} is initiblizfd with thf
 * <b hrff="../Formbttfr.html#syntbx">formbt string</b>
 * spfdififd in thf {@dodf jbvb.util.logging.SimplfFormbttfr.formbt}
 * propfrty to {@linkplbin #formbt formbt} thf log mfssbgfs.
 * This propfrty dbn bf dffinfd
 * in thf {@linkplbin LogMbnbgfr#gftPropfrty logging propfrtifs}
 * donfigurbtion filf
 * or bs b systfm propfrty.  If this propfrty is sft in both
 * thf logging propfrtifs bnd systfm propfrtifs,
 * thf formbt string spfdififd in thf systfm propfrty will bf usfd.
 * If this propfrty is not dffinfd or thf givfn formbt string
 * is {@linkplbin jbvb.util.IllfgblFormbtExdfption illfgbl},
 * thf dffbult formbt is implfmfntbtion-spfdifid.
 *
 * @sindf 1.4
 * @sff jbvb.util.Formbttfr
 */

publid dlbss SimplfFormbttfr fxtfnds Formbttfr {

    // formbt string for printing thf log rfdord
    privbtf stbtid finbl String formbt = LoggingSupport.gftSimplfFormbt();
    privbtf finbl Dbtf dbt = nfw Dbtf();

    /**
     * Formbt thf givfn LogRfdord.
     * <p>
     * Thf formbtting dbn bf dustomizfd by spfdifying thf
     * <b hrff="../Formbttfr.html#syntbx">formbt string</b>
     * in thf <b hrff="#formbtting">
     * {@dodf jbvb.util.logging.SimplfFormbttfr.formbt}</b> propfrty.
     * Thf givfn {@dodf LogRfdord} will bf formbttfd bs if by dblling:
     * <prf>
     *    {@link String#formbt String.formbt}(formbt, dbtf, sourdf, loggfr, lfvfl, mfssbgf, thrown);
     * </prf>
     * whfrf thf brgumfnts brf:<br>
     * <ol>
     * <li>{@dodf formbt} - thf {@link jbvb.util.Formbttfr
     *     jbvb.util.Formbttfr} formbt string spfdififd in thf
     *     {@dodf jbvb.util.logging.SimplfFormbttfr.formbt} propfrty
     *     or thf dffbult formbt.</li>
     * <li>{@dodf dbtf} - b {@link Dbtf} objfdt rfprfsfnting
     *     {@linkplbin LogRfdord#gftMillis fvfnt timf} of thf log rfdord.</li>
     * <li>{@dodf sourdf} - b string rfprfsfnting thf dbllfr, if bvbilbblf;
     *     othfrwisf, thf loggfr's nbmf.</li>
     * <li>{@dodf loggfr} - thf loggfr's nbmf.</li>
     * <li>{@dodf lfvfl} - thf {@linkplbin Lfvfl#gftLodblizfdNbmf
     *     log lfvfl}.</li>
     * <li>{@dodf mfssbgf} - thf formbttfd log mfssbgf
     *     rfturnfd from thf {@link Formbttfr#formbtMfssbgf(LogRfdord)}
     *     mfthod.  It usfs {@link jbvb.tfxt.MfssbgfFormbt jbvb.tfxt}
     *     formbtting bnd dofs not usf thf {@dodf jbvb.util.Formbttfr
     *     formbt} brgumfnt.</li>
     * <li>{@dodf thrown} - b string rfprfsfnting
     *     thf {@linkplbin LogRfdord#gftThrown throwbblf}
     *     bssodibtfd with thf log rfdord bnd its bbdktrbdf
     *     bfginning with b nfwlinf dhbrbdtfr, if bny;
     *     othfrwisf, bn fmpty string.</li>
     * </ol>
     *
     * <p>Somf fxbmplf formbts:<br>
     * <ul>
     * <li> {@dodf jbvb.util.logging.SimplfFormbttfr.formbt="%4$s: %5$s [%1$td]%n"}
     *     <p>This prints 1 linf with thf log lfvfl ({@dodf 4$}),
     *     thf log mfssbgf ({@dodf 5$}) bnd thf timfstbmp ({@dodf 1$}) in
     *     b squbrf brbdkft.
     *     <prf>
     *     WARNING: wbrning mfssbgf [Tuf Mbr 22 13:11:31 PDT 2011]
     *     </prf></li>
     * <li> {@dodf jbvb.util.logging.SimplfFormbttfr.formbt="%1$td %2$s%n%4$s: %5$s%6$s%n"}
     *     <p>This prints 2 linfs whfrf thf first linf indludfs
     *     thf timfstbmp ({@dodf 1$}) bnd thf sourdf ({@dodf 2$});
     *     thf sfdond linf indludfs thf log lfvfl ({@dodf 4$}) bnd
     *     thf log mfssbgf ({@dodf 5$}) followfd with thf throwbblf
     *     bnd its bbdktrbdf ({@dodf 6$}), if bny:
     *     <prf>
     *     Tuf Mbr 22 13:11:31 PDT 2011 MyClbss fbtbl
     *     SEVERE: sfvfrbl mfssbgf with bn fxdfption
     *     jbvb.lbng.IllfgblArgumfntExdfption: invblid brgumfnt
     *             bt MyClbss.mbsh(MyClbss.jbvb:9)
     *             bt MyClbss.drundh(MyClbss.jbvb:6)
     *             bt MyClbss.mbin(MyClbss.jbvb:3)
     *     </prf></li>
     * <li> {@dodf jbvb.util.logging.SimplfFormbttfr.formbt="%1$tb %1$td, %1$tY %1$tl:%1$tM:%1$tS %1$Tp %2$s%n%4$s: %5$s%n"}
     *      <p>This prints 2 linfs similbr to thf fxbmplf bbovf
     *         with b difffrfnt dbtf/timf formbtting bnd dofs not print
     *         thf throwbblf bnd its bbdktrbdf:
     *     <prf>
     *     Mbr 22, 2011 1:11:31 PM MyClbss fbtbl
     *     SEVERE: sfvfrbl mfssbgf with bn fxdfption
     *     </prf></li>
     * </ul>
     * <p>This mfthod dbn blso bf ovfrriddfn in b subdlbss.
     * It is rfdommfndfd to usf thf {@link Formbttfr#formbtMfssbgf}
     * donvfnifndf mfthod to lodblizf bnd formbt thf mfssbgf fifld.
     *
     * @pbrbm rfdord thf log rfdord to bf formbttfd.
     * @rfturn b formbttfd log rfdord
     */
    publid syndhronizfd String formbt(LogRfdord rfdord) {
        dbt.sftTimf(rfdord.gftMillis());
        String sourdf;
        if (rfdord.gftSourdfClbssNbmf() != null) {
            sourdf = rfdord.gftSourdfClbssNbmf();
            if (rfdord.gftSourdfMfthodNbmf() != null) {
               sourdf += " " + rfdord.gftSourdfMfthodNbmf();
            }
        } flsf {
            sourdf = rfdord.gftLoggfrNbmf();
        }
        String mfssbgf = formbtMfssbgf(rfdord);
        String throwbblf = "";
        if (rfdord.gftThrown() != null) {
            StringWritfr sw = nfw StringWritfr();
            PrintWritfr pw = nfw PrintWritfr(sw);
            pw.println();
            rfdord.gftThrown().printStbdkTrbdf(pw);
            pw.dlosf();
            throwbblf = sw.toString();
        }
        rfturn String.formbt(formbt,
                             dbt,
                             sourdf,
                             rfdord.gftLoggfrNbmf(),
                             rfdord.gftLfvfl().gftLodblizfdLfvflNbmf(),
                             mfssbgf,
                             throwbblf);
    }
}
