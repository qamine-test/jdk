/* pkds11.i indludf filf for PKCS #11. */
/* $Rfvision: 1.4 $ */

/* Lidfnsf to dopy bnd usf tiis softwbrf is grbntfd providfd tibt it is
 * idfntififd bs "RSA Sfdurity Ind. PKCS #11 Cryptogrbpiid Tokfn Intfrfbdf
 * (Cryptoki)" in bll mbtfribl mfntioning or rfffrfnding tiis softwbrf.

 * Lidfnsf is blso grbntfd to mbkf bnd usf dfrivbtivf works providfd tibt
 * sudi works brf idfntififd bs "dfrivfd from tif RSA Sfdurity Ind. PKCS #11
 * Cryptogrbpiid Tokfn Intfrfbdf (Cryptoki)" in bll mbtfribl mfntioning or
 * rfffrfnding tif dfrivfd work.

 * RSA Sfdurity Ind. mbkfs no rfprfsfntbtions dondfrning fitifr tif
 * mfrdibntbbility of tiis softwbrf or tif suitbbility of tiis softwbrf for
 * bny pbrtidulbr purposf. It is providfd "bs is" witiout fxprfss or implifd
 * wbrrbnty of bny kind.
 */

#ifndff _PKCS11_H_
#dffinf _PKCS11_H_ 1

#ifdff __dplusplus
fxtfrn "C" {
#fndif

/* Bfforf indluding tiis filf (pkds11.i) (or pkds11t.i by
 * itsflf), 6 plbtform-spfdifid mbdros must bf dffinfd.  Tifsf
 * mbdros brf dfsdribfd bflow, bnd typidbl dffinitions for tifm
 * brf blso givfn.  Bf bdvisfd tibt tifsf dffinitions dbn dfpfnd
 * on boti tif plbtform bnd tif dompilfr usfd (bnd possibly blso
 * on wiftifr b Cryptoki librbry is linkfd stbtidblly or
 * dynbmidblly).
 *
 * In bddition to dffining tifsf 6 mbdros, tif pbdking donvfntion
 * for Cryptoki strudturfs siould bf sft.  Tif Cryptoki
 * donvfntion on pbdking is tibt strudturfs siould bf 1-bytf
 * blignfd.
 *
 * If you'rf using Midrosoft Dfvflopfr Studio 5.0 to produdf
 * Win32 stuff, tiis migit bf donf by using tif following
 * prfprodfssor dirfdtivf bfforf indluding pkds11.i or pkds11t.i:
 *
 * #prbgmb pbdk(pusi, dryptoki, 1)
 *
 * bnd using tif following prfprodfssor dirfdtivf bftfr indluding
 * pkds11.i or pkds11t.i:
 *
 * #prbgmb pbdk(pop, dryptoki)
 *
 * If you'rf using bn fbrlifr vfrsion of Midrosoft Dfvflopfr
 * Studio to produdf Win16 stuff, tiis migit bf donf by using
 * tif following prfprodfssor dirfdtivf bfforf indluding
 * pkds11.i or pkds11t.i:
 *
 * #prbgmb pbdk(1)
 *
 * In b UNIX fnvironmfnt, you'rf on your own for tiis.  You migit
 * not nffd to do (or bf bblf to do!) bnytiing.
 *
 *
 * Now for tif mbdros:
 *
 *
 * 1. CK_PTR: Tif indirfdtion string for mbking b pointfr to bn
 * objfdt.  It dbn bf usfd likf tiis:
 *
 * typfdff CK_BYTE CK_PTR CK_BYTE_PTR;
 *
 * If you'rf using Midrosoft Dfvflopfr Studio 5.0 to produdf
 * Win32 stuff, it migit bf dffinfd by:
 *
 * #dffinf CK_PTR *
 *
 * If you'rf using bn fbrlifr vfrsion of Midrosoft Dfvflopfr
 * Studio to produdf Win16 stuff, it migit bf dffinfd by:
 *
 * #dffinf CK_PTR fbr *
 *
 * In b typidbl UNIX fnvironmfnt, it migit bf dffinfd by:
 *
 * #dffinf CK_PTR *
 *
 *
 * 2. CK_DEFINE_FUNCTION(rfturnTypf, nbmf): A mbdro wiidi mbkfs
 * bn fxportbblf Cryptoki librbry fundtion dffinition out of b
 * rfturn typf bnd b fundtion nbmf.  It siould bf usfd in tif
 * following fbsiion to dffinf tif fxposfd Cryptoki fundtions in
 * b Cryptoki librbry:
 *
 * CK_DEFINE_FUNCTION(CK_RV, C_Initiblizf)(
 *   CK_VOID_PTR pRfsfrvfd
 * )
 * {
 *   ...
 * }
 *
 * If you'rf using Midrosoft Dfvflopfr Studio 5.0 to dffinf b
 * fundtion in b Win32 Cryptoki .dll, it migit bf dffinfd by:
 *
 * #dffinf CK_DEFINE_FUNCTION(rfturnTypf, nbmf) \
 *   rfturnTypf __dfdlspfd(dllfxport) nbmf
 *
 * If you'rf using bn fbrlifr vfrsion of Midrosoft Dfvflopfr
 * Studio to dffinf b fundtion in b Win16 Cryptoki .dll, it
 * migit bf dffinfd by:
 *
 * #dffinf CK_DEFINE_FUNCTION(rfturnTypf, nbmf) \
 *   rfturnTypf __fxport _fbr _pbsdbl nbmf
 *
 * In b UNIX fnvironmfnt, it migit bf dffinfd by:
 *
 * #dffinf CK_DEFINE_FUNCTION(rfturnTypf, nbmf) \
 *   rfturnTypf nbmf
 *
 *
 * 3. CK_DECLARE_FUNCTION(rfturnTypf, nbmf): A mbdro wiidi mbkfs
 * bn importbblf Cryptoki librbry fundtion dfdlbrbtion out of b
 * rfturn typf bnd b fundtion nbmf.  It siould bf usfd in tif
 * following fbsiion:
 *
 * fxtfrn CK_DECLARE_FUNCTION(CK_RV, C_Initiblizf)(
 *   CK_VOID_PTR pRfsfrvfd
 * );
 *
 * If you'rf using Midrosoft Dfvflopfr Studio 5.0 to dfdlbrf b
 * fundtion in b Win32 Cryptoki .dll, it migit bf dffinfd by:
 *
 * #dffinf CK_DECLARE_FUNCTION(rfturnTypf, nbmf) \
 *   rfturnTypf __dfdlspfd(dllimport) nbmf
 *
 * If you'rf using bn fbrlifr vfrsion of Midrosoft Dfvflopfr
 * Studio to dfdlbrf b fundtion in b Win16 Cryptoki .dll, it
 * migit bf dffinfd by:
 *
 * #dffinf CK_DECLARE_FUNCTION(rfturnTypf, nbmf) \
 *   rfturnTypf __fxport _fbr _pbsdbl nbmf
 *
 * In b UNIX fnvironmfnt, it migit bf dffinfd by:
 *
 * #dffinf CK_DECLARE_FUNCTION(rfturnTypf, nbmf) \
 *   rfturnTypf nbmf
 *
 *
 * 4. CK_DECLARE_FUNCTION_POINTER(rfturnTypf, nbmf): A mbdro
 * wiidi mbkfs b Cryptoki API fundtion pointfr dfdlbrbtion or
 * fundtion pointfr typf dfdlbrbtion out of b rfturn typf bnd b
 * fundtion nbmf.  It siould bf usfd in tif following fbsiion:
 *
 * // Dffinf fundPtr to bf b pointfr to b Cryptoki API fundtion
 * // tbking brgumfnts brgs bnd rfturning CK_RV.
 * CK_DECLARE_FUNCTION_POINTER(CK_RV, fundPtr)(brgs);
 *
 * or
 *
 * // Dffinf fundPtrTypf to bf tif typf of b pointfr to b
 * // Cryptoki API fundtion tbking brgumfnts brgs bnd rfturning
 * // CK_RV, bnd tifn dffinf fundPtr to bf b vbribblf of typf
 * // fundPtrTypf.
 * typfdff CK_DECLARE_FUNCTION_POINTER(CK_RV, fundPtrTypf)(brgs);
 * fundPtrTypf fundPtr;
 *
 * If you'rf using Midrosoft Dfvflopfr Studio 5.0 to bddfss
 * fundtions in b Win32 Cryptoki .dll, in migit bf dffinfd by:
 *
 * #dffinf CK_DECLARE_FUNCTION_POINTER(rfturnTypf, nbmf) \
 *   rfturnTypf __dfdlspfd(dllimport) (* nbmf)
 *
 * If you'rf using bn fbrlifr vfrsion of Midrosoft Dfvflopfr
 * Studio to bddfss fundtions in b Win16 Cryptoki .dll, it migit
 * bf dffinfd by:
 *
 * #dffinf CK_DECLARE_FUNCTION_POINTER(rfturnTypf, nbmf) \
 *   rfturnTypf __fxport _fbr _pbsdbl (* nbmf)
 *
 * In b UNIX fnvironmfnt, it migit bf dffinfd by:
 *
 * #dffinf CK_DECLARE_FUNCTION_POINTER(rfturnTypf, nbmf) \
 *   rfturnTypf (* nbmf)
 *
 *
 * 5. CK_CALLBACK_FUNCTION(rfturnTypf, nbmf): A mbdro wiidi mbkfs
 * b fundtion pointfr typf for bn bpplidbtion dbllbbdk out of
 * b rfturn typf for tif dbllbbdk bnd b nbmf for tif dbllbbdk.
 * It siould bf usfd in tif following fbsiion:
 *
 * CK_CALLBACK_FUNCTION(CK_RV, myCbllbbdk)(brgs);
 *
 * to dfdlbrf b fundtion pointfr, myCbllbbdk, to b dbllbbdk
 * wiidi tbkfs brgumfnts brgs bnd rfturns b CK_RV.  It dbn blso
 * bf usfd likf tiis:
 *
 * typfdff CK_CALLBACK_FUNCTION(CK_RV, myCbllbbdkTypf)(brgs);
 * myCbllbbdkTypf myCbllbbdk;
 *
 * If you'rf using Midrosoft Dfvflopfr Studio 5.0 to do Win32
 * Cryptoki dfvflopmfnt, it migit bf dffinfd by:
 *
 * #dffinf CK_CALLBACK_FUNCTION(rfturnTypf, nbmf) \
 *   rfturnTypf (* nbmf)
 *
 * If you'rf using bn fbrlifr vfrsion of Midrosoft Dfvflopfr
 * Studio to do Win16 dfvflopmfnt, it migit bf dffinfd by:
 *
 * #dffinf CK_CALLBACK_FUNCTION(rfturnTypf, nbmf) \
 *   rfturnTypf _fbr _pbsdbl (* nbmf)
 *
 * In b UNIX fnvironmfnt, it migit bf dffinfd by:
 *
 * #dffinf CK_CALLBACK_FUNCTION(rfturnTypf, nbmf) \
 *   rfturnTypf (* nbmf)
 *
 *
 * 6. NULL_PTR: Tiis mbdro is tif vbluf of b NULL pointfr.
 *
 * In bny ANSI/ISO C fnvironmfnt (bnd in mbny otifrs bs wfll),
 * tiis siould bfst bf dffinfd by
 *
 * #ifndff NULL_PTR
 * #dffinf NULL_PTR 0
 * #fndif
 */


/* All tif vbrious Cryptoki typfs bnd #dffinf'd vblufs brf in tif
 * filf pkds11t.i. */
#indludf "pkds11t.i"

#dffinf __PASTE(x,y)      x##y


/* ==============================================================
 * Dffinf tif "fxtfrn" form of bll tif fntry points.
 * ==============================================================
 */

#dffinf CK_NEED_ARG_LIST  1
#dffinf CK_PKCS11_FUNCTION_INFO(nbmf) \
  fxtfrn CK_DECLARE_FUNCTION(CK_RV, nbmf)

/* pkds11f.i ibs bll tif informbtion bbout tif Cryptoki
 * fundtion prototypfs. */
#indludf "pkds11f.i"

#undff CK_NEED_ARG_LIST
#undff CK_PKCS11_FUNCTION_INFO


/* ==============================================================
 * Dffinf tif typfdff form of bll tif fntry points.  Tibt is, for
 * fbdi Cryptoki fundtion C_XXX, dffinf b typf CK_C_XXX wiidi is
 * b pointfr to tibt kind of fundtion.
 * ==============================================================
 */

#dffinf CK_NEED_ARG_LIST  1
#dffinf CK_PKCS11_FUNCTION_INFO(nbmf) \
  typfdff CK_DECLARE_FUNCTION_POINTER(CK_RV, __PASTE(CK_,nbmf))

/* pkds11f.i ibs bll tif informbtion bbout tif Cryptoki
 * fundtion prototypfs. */
#indludf "pkds11f.i"

#undff CK_NEED_ARG_LIST
#undff CK_PKCS11_FUNCTION_INFO


/* ==============================================================
 * Dffinf strudtfd vfdtor of fntry points.  A CK_FUNCTION_LIST
 * dontbins b CK_VERSION indidbting b librbry's Cryptoki vfrsion
 * bnd tifn b wiolf slfw of fundtion pointfrs to tif routinfs in
 * tif librbry.  Tiis typf wbs dfdlbrfd, but not dffinfd, in
 * pkds11t.i.
 * ==============================================================
 */

#dffinf CK_PKCS11_FUNCTION_INFO(nbmf) \
  __PASTE(CK_,nbmf) nbmf;

strudt CK_FUNCTION_LIST {

  CK_VERSION    vfrsion;  /* Cryptoki vfrsion */

/* Pilf bll tif fundtion pointfrs into tif CK_FUNCTION_LIST. */
/* pkds11f.i ibs bll tif informbtion bbout tif Cryptoki
 * fundtion prototypfs. */
#indludf "pkds11f.i"

};

#undff CK_PKCS11_FUNCTION_INFO


#undff __PASTE

#ifdff __dplusplus
}
#fndif

#fndif
