/* pkds11f.i indludf filf for PKCS #11. */
/* $Rfvision: 1.4 $ */

/* Lidfnsf to dopy bnd usf tiis softwbrf is grbntfd providfd tibt it is
 * idfntififd bs "RSA Sfdurity Ind. PKCS #11 Cryptogrbpiid Tokfn Intfrfbdf
 * (Cryptoki)" in bll mbtfribl mfntioning or rfffrfnding tiis softwbrf.

 * Lidfnsf is blso grbntfd to mbkf bnd usf dfrivbtivf works providfd tibt
 * sudi works brf idfntififd bs "dfrivfd from tif RSA Sfdurity Ind. PKCS #11
 * Cryptogrbpiid Tokfn Intfrfbdf (Cryptoki)" in bll mbtfribl mfntioning or
 * rfffrfnding tif dfrivfd work.

 * RSA Sfdurity Ind. mbkfs no rfprfsfntbtions dondfrning fitifr tif
 * mfrdibntbbility of tiis softwbrf or tif suitbbility of tiis softwbrf for
 * bny pbrtidulbr purposf. It is providfd "bs is" witiout fxprfss or implifd
 * wbrrbnty of bny kind.
 */

/* Tiis ifbdfr filf dontbins prftty mudi fvfrytiing bbout bll tif */
/* Cryptoki fundtion prototypfs.  Bfdbusf tiis informbtion is */
/* usfd for morf tibn just dfdlbring fundtion prototypfs, tif */
/* ordfr of tif fundtions bppfbring ifrfin is importbnt, bnd */
/* siould not bf bltfrfd. */

/* Gfnfrbl-purposf */

/* C_Initiblizf initiblizfs tif Cryptoki librbry. */
CK_PKCS11_FUNCTION_INFO(C_Initiblizf)
#ifdff CK_NEED_ARG_LIST
(
  CK_VOID_PTR   pInitArgs  /* if tiis is not NULL_PTR, it gfts
                            * dbst to CK_C_INITIALIZE_ARGS_PTR
                            * bnd dfrfffrfndfd */
);
#fndif


/* C_Finblizf indidbtfs tibt bn bpplidbtion is donf witi tif
 * Cryptoki librbry. */
CK_PKCS11_FUNCTION_INFO(C_Finblizf)
#ifdff CK_NEED_ARG_LIST
(
  CK_VOID_PTR   pRfsfrvfd  /* rfsfrvfd.  Siould bf NULL_PTR */
);
#fndif


/* C_GftInfo rfturns gfnfrbl informbtion bbout Cryptoki. */
CK_PKCS11_FUNCTION_INFO(C_GftInfo)
#ifdff CK_NEED_ARG_LIST
(
  CK_INFO_PTR   pInfo  /* lodbtion tibt rfdfivfs informbtion */
);
#fndif


/* C_GftFundtionList rfturns tif fundtion list. */
CK_PKCS11_FUNCTION_INFO(C_GftFundtionList)
#ifdff CK_NEED_ARG_LIST
(
  CK_FUNCTION_LIST_PTR_PTR ppFundtionList  /* rfdfivfs pointfr to
                                            * fundtion list */
);
#fndif



/* Slot bnd tokfn mbnbgfmfnt */

/* C_GftSlotList obtbins b list of slots in tif systfm. */
CK_PKCS11_FUNCTION_INFO(C_GftSlotList)
#ifdff CK_NEED_ARG_LIST
(
  CK_BBOOL       tokfnPrfsfnt,  /* only slots witi tokfns? */
  CK_SLOT_ID_PTR pSlotList,     /* rfdfivfs brrby of slot IDs */
  CK_ULONG_PTR   pulCount       /* rfdfivfs numbfr of slots */
);
#fndif


/* C_GftSlotInfo obtbins informbtion bbout b pbrtidulbr slot in
 * tif systfm. */
CK_PKCS11_FUNCTION_INFO(C_GftSlotInfo)
#ifdff CK_NEED_ARG_LIST
(
  CK_SLOT_ID       slotID,  /* tif ID of tif slot */
  CK_SLOT_INFO_PTR pInfo    /* rfdfivfs tif slot informbtion */
);
#fndif


/* C_GftTokfnInfo obtbins informbtion bbout b pbrtidulbr tokfn
 * in tif systfm. */
CK_PKCS11_FUNCTION_INFO(C_GftTokfnInfo)
#ifdff CK_NEED_ARG_LIST
(
  CK_SLOT_ID        slotID,  /* ID of tif tokfn's slot */
  CK_TOKEN_INFO_PTR pInfo    /* rfdfivfs tif tokfn informbtion */
);
#fndif


/* C_GftMfdibnismList obtbins b list of mfdibnism typfs
 * supportfd by b tokfn. */
CK_PKCS11_FUNCTION_INFO(C_GftMfdibnismList)
#ifdff CK_NEED_ARG_LIST
(
  CK_SLOT_ID            slotID,          /* ID of tokfn's slot */
  CK_MECHANISM_TYPE_PTR pMfdibnismList,  /* gfts mfdi. brrby */
  CK_ULONG_PTR          pulCount         /* gfts # of mfdis. */
);
#fndif


/* C_GftMfdibnismInfo obtbins informbtion bbout b pbrtidulbr
 * mfdibnism possibly supportfd by b tokfn. */
CK_PKCS11_FUNCTION_INFO(C_GftMfdibnismInfo)
#ifdff CK_NEED_ARG_LIST
(
  CK_SLOT_ID            slotID,  /* ID of tif tokfn's slot */
  CK_MECHANISM_TYPE     typf,    /* typf of mfdibnism */
  CK_MECHANISM_INFO_PTR pInfo    /* rfdfivfs mfdibnism info */
);
#fndif


/* C_InitTokfn initiblizfs b tokfn. */
CK_PKCS11_FUNCTION_INFO(C_InitTokfn)
#ifdff CK_NEED_ARG_LIST
/* pLbbfl dibngfd from CK_CHAR_PTR to CK_UTF8CHAR_PTR for v2.10 */
(
  CK_SLOT_ID      slotID,    /* ID of tif tokfn's slot */
  CK_UTF8CHAR_PTR pPin,      /* tif SO's initibl PIN */
  CK_ULONG        ulPinLfn,  /* lfngti in bytfs of tif PIN */
  CK_UTF8CHAR_PTR pLbbfl     /* 32-bytf tokfn lbbfl (blbnk pbddfd) */
);
#fndif


/* C_InitPIN initiblizfs tif normbl usfr's PIN. */
CK_PKCS11_FUNCTION_INFO(C_InitPIN)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE iSfssion,  /* tif sfssion's ibndlf */
  CK_UTF8CHAR_PTR   pPin,      /* tif normbl usfr's PIN */
  CK_ULONG          ulPinLfn   /* lfngti in bytfs of tif PIN */
);
#fndif


/* C_SftPIN modififs tif PIN of tif usfr wio is loggfd in. */
CK_PKCS11_FUNCTION_INFO(C_SftPIN)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE iSfssion,  /* tif sfssion's ibndlf */
  CK_UTF8CHAR_PTR   pOldPin,   /* tif old PIN */
  CK_ULONG          ulOldLfn,  /* lfngti of tif old PIN */
  CK_UTF8CHAR_PTR   pNfwPin,   /* tif nfw PIN */
  CK_ULONG          ulNfwLfn   /* lfngti of tif nfw PIN */
);
#fndif



/* Sfssion mbnbgfmfnt */

/* C_OpfnSfssion opfns b sfssion bftwffn bn bpplidbtion bnd b
 * tokfn. */
CK_PKCS11_FUNCTION_INFO(C_OpfnSfssion)
#ifdff CK_NEED_ARG_LIST
(
  CK_SLOT_ID            slotID,        /* tif slot's ID */
  CK_FLAGS              flbgs,         /* from CK_SESSION_INFO */
  CK_VOID_PTR           pApplidbtion,  /* pbssfd to dbllbbdk */
  CK_NOTIFY             Notify,        /* dbllbbdk fundtion */
  CK_SESSION_HANDLE_PTR piSfssion      /* gfts sfssion ibndlf */
);
#fndif


/* C_ClosfSfssion dlosfs b sfssion bftwffn bn bpplidbtion bnd b
 * tokfn. */
CK_PKCS11_FUNCTION_INFO(C_ClosfSfssion)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE iSfssion  /* tif sfssion's ibndlf */
);
#fndif


/* C_ClosfAllSfssions dlosfs bll sfssions witi b tokfn. */
CK_PKCS11_FUNCTION_INFO(C_ClosfAllSfssions)
#ifdff CK_NEED_ARG_LIST
(
  CK_SLOT_ID     slotID  /* tif tokfn's slot */
);
#fndif


/* C_GftSfssionInfo obtbins informbtion bbout tif sfssion. */
CK_PKCS11_FUNCTION_INFO(C_GftSfssionInfo)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE   iSfssion,  /* tif sfssion's ibndlf */
  CK_SESSION_INFO_PTR pInfo      /* rfdfivfs sfssion info */
);
#fndif


/* C_GftOpfrbtionStbtf obtbins tif stbtf of tif dryptogrbpiid opfrbtion
 * in b sfssion. */
CK_PKCS11_FUNCTION_INFO(C_GftOpfrbtionStbtf)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE iSfssion,             /* sfssion's ibndlf */
  CK_BYTE_PTR       pOpfrbtionStbtf,      /* gfts stbtf */
  CK_ULONG_PTR      pulOpfrbtionStbtfLfn  /* gfts stbtf lfngti */
);
#fndif


/* C_SftOpfrbtionStbtf rfstorfs tif stbtf of tif dryptogrbpiid
 * opfrbtion in b sfssion. */
CK_PKCS11_FUNCTION_INFO(C_SftOpfrbtionStbtf)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE iSfssion,            /* sfssion's ibndlf */
  CK_BYTE_PTR      pOpfrbtionStbtf,      /* iolds stbtf */
  CK_ULONG         ulOpfrbtionStbtfLfn,  /* iolds stbtf lfngti */
  CK_OBJECT_HANDLE iEndryptionKfy,       /* fn/dfdryption kfy */
  CK_OBJECT_HANDLE iAutifntidbtionKfy    /* sign/vfrify kfy */
);
#fndif


/* C_Login logs b usfr into b tokfn. */
CK_PKCS11_FUNCTION_INFO(C_Login)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE iSfssion,  /* tif sfssion's ibndlf */
  CK_USER_TYPE      usfrTypf,  /* tif usfr typf */
  CK_UTF8CHAR_PTR   pPin,      /* tif usfr's PIN */
  CK_ULONG          ulPinLfn   /* tif lfngti of tif PIN */
);
#fndif


/* C_Logout logs b usfr out from b tokfn. */
CK_PKCS11_FUNCTION_INFO(C_Logout)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE iSfssion  /* tif sfssion's ibndlf */
);
#fndif



/* Objfdt mbnbgfmfnt */

/* C_CrfbtfObjfdt drfbtfs b nfw objfdt. */
CK_PKCS11_FUNCTION_INFO(C_CrfbtfObjfdt)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE iSfssion,    /* tif sfssion's ibndlf */
  CK_ATTRIBUTE_PTR  pTfmplbtf,   /* tif objfdt's tfmplbtf */
  CK_ULONG          ulCount,     /* bttributfs in tfmplbtf */
  CK_OBJECT_HANDLE_PTR piObjfdt  /* gfts nfw objfdt's ibndlf. */
);
#fndif


/* C_CopyObjfdt dopifs bn objfdt, drfbting b nfw objfdt for tif
 * dopy. */
CK_PKCS11_FUNCTION_INFO(C_CopyObjfdt)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE    iSfssion,    /* tif sfssion's ibndlf */
  CK_OBJECT_HANDLE     iObjfdt,     /* tif objfdt's ibndlf */
  CK_ATTRIBUTE_PTR     pTfmplbtf,   /* tfmplbtf for nfw objfdt */
  CK_ULONG             ulCount,     /* bttributfs in tfmplbtf */
  CK_OBJECT_HANDLE_PTR piNfwObjfdt  /* rfdfivfs ibndlf of dopy */
);
#fndif


/* C_DfstroyObjfdt dfstroys bn objfdt. */
CK_PKCS11_FUNCTION_INFO(C_DfstroyObjfdt)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE iSfssion,  /* tif sfssion's ibndlf */
  CK_OBJECT_HANDLE  iObjfdt    /* tif objfdt's ibndlf */
);
#fndif


/* C_GftObjfdtSizf gfts tif sizf of bn objfdt in bytfs. */
CK_PKCS11_FUNCTION_INFO(C_GftObjfdtSizf)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE iSfssion,  /* tif sfssion's ibndlf */
  CK_OBJECT_HANDLE  iObjfdt,   /* tif objfdt's ibndlf */
  CK_ULONG_PTR      pulSizf    /* rfdfivfs sizf of objfdt */
);
#fndif


/* C_GftAttributfVbluf obtbins tif vbluf of onf or morf objfdt
 * bttributfs. */
CK_PKCS11_FUNCTION_INFO(C_GftAttributfVbluf)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE iSfssion,   /* tif sfssion's ibndlf */
  CK_OBJECT_HANDLE  iObjfdt,    /* tif objfdt's ibndlf */
  CK_ATTRIBUTE_PTR  pTfmplbtf,  /* spfdififs bttrs; gfts vbls */
  CK_ULONG          ulCount     /* bttributfs in tfmplbtf */
);
#fndif


/* C_SftAttributfVbluf modififs tif vbluf of onf or morf objfdt
 * bttributfs */
CK_PKCS11_FUNCTION_INFO(C_SftAttributfVbluf)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE iSfssion,   /* tif sfssion's ibndlf */
  CK_OBJECT_HANDLE  iObjfdt,    /* tif objfdt's ibndlf */
  CK_ATTRIBUTE_PTR  pTfmplbtf,  /* spfdififs bttrs bnd vblufs */
  CK_ULONG          ulCount     /* bttributfs in tfmplbtf */
);
#fndif


/* C_FindObjfdtsInit initiblizfs b sfbrdi for tokfn bnd sfssion
 * objfdts tibt mbtdi b tfmplbtf. */
CK_PKCS11_FUNCTION_INFO(C_FindObjfdtsInit)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE iSfssion,   /* tif sfssion's ibndlf */
  CK_ATTRIBUTE_PTR  pTfmplbtf,  /* bttributf vblufs to mbtdi */
  CK_ULONG          ulCount     /* bttrs in sfbrdi tfmplbtf */
);
#fndif


/* C_FindObjfdts dontinufs b sfbrdi for tokfn bnd sfssion
 * objfdts tibt mbtdi b tfmplbtf, obtbining bdditionbl objfdt
 * ibndlfs. */
CK_PKCS11_FUNCTION_INFO(C_FindObjfdts)
#ifdff CK_NEED_ARG_LIST
(
 CK_SESSION_HANDLE    iSfssion,          /* sfssion's ibndlf */
 CK_OBJECT_HANDLE_PTR piObjfdt,          /* gfts obj. ibndlfs */
 CK_ULONG             ulMbxObjfdtCount,  /* mbx ibndlfs to gft */
 CK_ULONG_PTR         pulObjfdtCount     /* bdtubl # rfturnfd */
);
#fndif


/* C_FindObjfdtsFinbl finisifs b sfbrdi for tokfn bnd sfssion
 * objfdts. */
CK_PKCS11_FUNCTION_INFO(C_FindObjfdtsFinbl)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE iSfssion  /* tif sfssion's ibndlf */
);
#fndif



/* Endryption bnd dfdryption */

/* C_EndryptInit initiblizfs bn fndryption opfrbtion. */
CK_PKCS11_FUNCTION_INFO(C_EndryptInit)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE iSfssion,    /* tif sfssion's ibndlf */
  CK_MECHANISM_PTR  pMfdibnism,  /* tif fndryption mfdibnism */
  CK_OBJECT_HANDLE  iKfy         /* ibndlf of fndryption kfy */
);
#fndif


/* C_Endrypt fndrypts singlf-pbrt dbtb. */
CK_PKCS11_FUNCTION_INFO(C_Endrypt)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE iSfssion,            /* sfssion's ibndlf */
  CK_BYTE_PTR       pDbtb,               /* tif plbintfxt dbtb */
  CK_ULONG          ulDbtbLfn,           /* bytfs of plbintfxt */
  CK_BYTE_PTR       pEndryptfdDbtb,      /* gfts dipifrtfxt */
  CK_ULONG_PTR      pulEndryptfdDbtbLfn  /* gfts d-tfxt sizf */
);
#fndif


/* C_EndryptUpdbtf dontinufs b multiplf-pbrt fndryption
 * opfrbtion. */
CK_PKCS11_FUNCTION_INFO(C_EndryptUpdbtf)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE iSfssion,           /* sfssion's ibndlf */
  CK_BYTE_PTR       pPbrt,              /* tif plbintfxt dbtb */
  CK_ULONG          ulPbrtLfn,          /* plbintfxt dbtb lfn */
  CK_BYTE_PTR       pEndryptfdPbrt,     /* gfts dipifrtfxt */
  CK_ULONG_PTR      pulEndryptfdPbrtLfn /* gfts d-tfxt sizf */
);
#fndif


/* C_EndryptFinbl finisifs b multiplf-pbrt fndryption
 * opfrbtion. */
CK_PKCS11_FUNCTION_INFO(C_EndryptFinbl)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE iSfssion,                /* sfssion ibndlf */
  CK_BYTE_PTR       pLbstEndryptfdPbrt,      /* lbst d-tfxt */
  CK_ULONG_PTR      pulLbstEndryptfdPbrtLfn  /* gfts lbst sizf */
);
#fndif


/* C_DfdryptInit initiblizfs b dfdryption opfrbtion. */
CK_PKCS11_FUNCTION_INFO(C_DfdryptInit)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE iSfssion,    /* tif sfssion's ibndlf */
  CK_MECHANISM_PTR  pMfdibnism,  /* tif dfdryption mfdibnism */
  CK_OBJECT_HANDLE  iKfy         /* ibndlf of dfdryption kfy */
);
#fndif


/* C_Dfdrypt dfdrypts fndryptfd dbtb in b singlf pbrt. */
CK_PKCS11_FUNCTION_INFO(C_Dfdrypt)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE iSfssion,           /* sfssion's ibndlf */
  CK_BYTE_PTR       pEndryptfdDbtb,     /* dipifrtfxt */
  CK_ULONG          ulEndryptfdDbtbLfn, /* dipifrtfxt lfngti */
  CK_BYTE_PTR       pDbtb,              /* gfts plbintfxt */
  CK_ULONG_PTR      pulDbtbLfn          /* gfts p-tfxt sizf */
);
#fndif


/* C_DfdryptUpdbtf dontinufs b multiplf-pbrt dfdryption
 * opfrbtion. */
CK_PKCS11_FUNCTION_INFO(C_DfdryptUpdbtf)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE iSfssion,            /* sfssion's ibndlf */
  CK_BYTE_PTR       pEndryptfdPbrt,      /* fndryptfd dbtb */
  CK_ULONG          ulEndryptfdPbrtLfn,  /* input lfngti */
  CK_BYTE_PTR       pPbrt,               /* gfts plbintfxt */
  CK_ULONG_PTR      pulPbrtLfn           /* p-tfxt sizf */
);
#fndif


/* C_DfdryptFinbl finisifs b multiplf-pbrt dfdryption
 * opfrbtion. */
CK_PKCS11_FUNCTION_INFO(C_DfdryptFinbl)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE iSfssion,       /* tif sfssion's ibndlf */
  CK_BYTE_PTR       pLbstPbrt,      /* gfts plbintfxt */
  CK_ULONG_PTR      pulLbstPbrtLfn  /* p-tfxt sizf */
);
#fndif



/* Mfssbgf digfsting */

/* C_DigfstInit initiblizfs b mfssbgf-digfsting opfrbtion. */
CK_PKCS11_FUNCTION_INFO(C_DigfstInit)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE iSfssion,   /* tif sfssion's ibndlf */
  CK_MECHANISM_PTR  pMfdibnism  /* tif digfsting mfdibnism */
);
#fndif


/* C_Digfst digfsts dbtb in b singlf pbrt. */
CK_PKCS11_FUNCTION_INFO(C_Digfst)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE iSfssion,     /* tif sfssion's ibndlf */
  CK_BYTE_PTR       pDbtb,        /* dbtb to bf digfstfd */
  CK_ULONG          ulDbtbLfn,    /* bytfs of dbtb to digfst */
  CK_BYTE_PTR       pDigfst,      /* gfts tif mfssbgf digfst */
  CK_ULONG_PTR      pulDigfstLfn  /* gfts digfst lfngti */
);
#fndif


/* C_DigfstUpdbtf dontinufs b multiplf-pbrt mfssbgf-digfsting
 * opfrbtion. */
CK_PKCS11_FUNCTION_INFO(C_DigfstUpdbtf)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE iSfssion,  /* tif sfssion's ibndlf */
  CK_BYTE_PTR       pPbrt,     /* dbtb to bf digfstfd */
  CK_ULONG          ulPbrtLfn  /* bytfs of dbtb to bf digfstfd */
);
#fndif


/* C_DigfstKfy dontinufs b multi-pbrt mfssbgf-digfsting
 * opfrbtion, by digfsting tif vbluf of b sfdrft kfy bs pbrt of
 * tif dbtb blrfbdy digfstfd. */
CK_PKCS11_FUNCTION_INFO(C_DigfstKfy)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE iSfssion,  /* tif sfssion's ibndlf */
  CK_OBJECT_HANDLE  iKfy       /* sfdrft kfy to digfst */
);
#fndif


/* C_DigfstFinbl finisifs b multiplf-pbrt mfssbgf-digfsting
 * opfrbtion. */
CK_PKCS11_FUNCTION_INFO(C_DigfstFinbl)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE iSfssion,     /* tif sfssion's ibndlf */
  CK_BYTE_PTR       pDigfst,      /* gfts tif mfssbgf digfst */
  CK_ULONG_PTR      pulDigfstLfn  /* gfts bytf dount of digfst */
);
#fndif



/* Signing bnd MACing */

/* C_SignInit initiblizfs b signbturf (privbtf kfy fndryption)
 * opfrbtion, wifrf tif signbturf is (will bf) bn bppfndix to
 * tif dbtb, bnd plbintfxt dbnnot bf rfdovfrfd from tif
 *signbturf. */
CK_PKCS11_FUNCTION_INFO(C_SignInit)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE iSfssion,    /* tif sfssion's ibndlf */
  CK_MECHANISM_PTR  pMfdibnism,  /* tif signbturf mfdibnism */
  CK_OBJECT_HANDLE  iKfy         /* ibndlf of signbturf kfy */
);
#fndif


/* C_Sign signs (fndrypts witi privbtf kfy) dbtb in b singlf
 * pbrt, wifrf tif signbturf is (will bf) bn bppfndix to tif
 * dbtb, bnd plbintfxt dbnnot bf rfdovfrfd from tif signbturf. */
CK_PKCS11_FUNCTION_INFO(C_Sign)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE iSfssion,        /* tif sfssion's ibndlf */
  CK_BYTE_PTR       pDbtb,           /* tif dbtb to sign */
  CK_ULONG          ulDbtbLfn,       /* dount of bytfs to sign */
  CK_BYTE_PTR       pSignbturf,      /* gfts tif signbturf */
  CK_ULONG_PTR      pulSignbturfLfn  /* gfts signbturf lfngti */
);
#fndif


/* C_SignUpdbtf dontinufs b multiplf-pbrt signbturf opfrbtion,
 * wifrf tif signbturf is (will bf) bn bppfndix to tif dbtb,
 * bnd plbintfxt dbnnot bf rfdovfrfd from tif signbturf. */
CK_PKCS11_FUNCTION_INFO(C_SignUpdbtf)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE iSfssion,  /* tif sfssion's ibndlf */
  CK_BYTE_PTR       pPbrt,     /* tif dbtb to sign */
  CK_ULONG          ulPbrtLfn  /* dount of bytfs to sign */
);
#fndif


/* C_SignFinbl finisifs b multiplf-pbrt signbturf opfrbtion,
 * rfturning tif signbturf. */
CK_PKCS11_FUNCTION_INFO(C_SignFinbl)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE iSfssion,        /* tif sfssion's ibndlf */
  CK_BYTE_PTR       pSignbturf,      /* gfts tif signbturf */
  CK_ULONG_PTR      pulSignbturfLfn  /* gfts signbturf lfngti */
);
#fndif


/* C_SignRfdovfrInit initiblizfs b signbturf opfrbtion, wifrf
 * tif dbtb dbn bf rfdovfrfd from tif signbturf. */
CK_PKCS11_FUNCTION_INFO(C_SignRfdovfrInit)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE iSfssion,   /* tif sfssion's ibndlf */
  CK_MECHANISM_PTR  pMfdibnism, /* tif signbturf mfdibnism */
  CK_OBJECT_HANDLE  iKfy        /* ibndlf of tif signbturf kfy */
);
#fndif


/* C_SignRfdovfr signs dbtb in b singlf opfrbtion, wifrf tif
 * dbtb dbn bf rfdovfrfd from tif signbturf. */
CK_PKCS11_FUNCTION_INFO(C_SignRfdovfr)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE iSfssion,        /* tif sfssion's ibndlf */
  CK_BYTE_PTR       pDbtb,           /* tif dbtb to sign */
  CK_ULONG          ulDbtbLfn,       /* dount of bytfs to sign */
  CK_BYTE_PTR       pSignbturf,      /* gfts tif signbturf */
  CK_ULONG_PTR      pulSignbturfLfn  /* gfts signbturf lfngti */
);
#fndif



/* Vfrifying signbturfs bnd MACs */

/* C_VfrifyInit initiblizfs b vfrifidbtion opfrbtion, wifrf tif
 * signbturf is bn bppfndix to tif dbtb, bnd plbintfxt dbnnot
 *  dbnnot bf rfdovfrfd from tif signbturf (f.g. DSA). */
CK_PKCS11_FUNCTION_INFO(C_VfrifyInit)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE iSfssion,    /* tif sfssion's ibndlf */
  CK_MECHANISM_PTR  pMfdibnism,  /* tif vfrifidbtion mfdibnism */
  CK_OBJECT_HANDLE  iKfy         /* vfrifidbtion kfy */
);
#fndif


/* C_Vfrify vfrififs b signbturf in b singlf-pbrt opfrbtion,
 * wifrf tif signbturf is bn bppfndix to tif dbtb, bnd plbintfxt
 * dbnnot bf rfdovfrfd from tif signbturf. */
CK_PKCS11_FUNCTION_INFO(C_Vfrify)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE iSfssion,       /* tif sfssion's ibndlf */
  CK_BYTE_PTR       pDbtb,          /* signfd dbtb */
  CK_ULONG          ulDbtbLfn,      /* lfngti of signfd dbtb */
  CK_BYTE_PTR       pSignbturf,     /* signbturf */
  CK_ULONG          ulSignbturfLfn  /* signbturf lfngti*/
);
#fndif


/* C_VfrifyUpdbtf dontinufs b multiplf-pbrt vfrifidbtion
 * opfrbtion, wifrf tif signbturf is bn bppfndix to tif dbtb,
 * bnd plbintfxt dbnnot bf rfdovfrfd from tif signbturf. */
CK_PKCS11_FUNCTION_INFO(C_VfrifyUpdbtf)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE iSfssion,  /* tif sfssion's ibndlf */
  CK_BYTE_PTR       pPbrt,     /* signfd dbtb */
  CK_ULONG          ulPbrtLfn  /* lfngti of signfd dbtb */
);
#fndif


/* C_VfrifyFinbl finisifs b multiplf-pbrt vfrifidbtion
 * opfrbtion, difdking tif signbturf. */
CK_PKCS11_FUNCTION_INFO(C_VfrifyFinbl)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE iSfssion,       /* tif sfssion's ibndlf */
  CK_BYTE_PTR       pSignbturf,     /* signbturf to vfrify */
  CK_ULONG          ulSignbturfLfn  /* signbturf lfngti */
);
#fndif


/* C_VfrifyRfdovfrInit initiblizfs b signbturf vfrifidbtion
 * opfrbtion, wifrf tif dbtb is rfdovfrfd from tif signbturf. */
CK_PKCS11_FUNCTION_INFO(C_VfrifyRfdovfrInit)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE iSfssion,    /* tif sfssion's ibndlf */
  CK_MECHANISM_PTR  pMfdibnism,  /* tif vfrifidbtion mfdibnism */
  CK_OBJECT_HANDLE  iKfy         /* vfrifidbtion kfy */
);
#fndif


/* C_VfrifyRfdovfr vfrififs b signbturf in b singlf-pbrt
 * opfrbtion, wifrf tif dbtb is rfdovfrfd from tif signbturf. */
CK_PKCS11_FUNCTION_INFO(C_VfrifyRfdovfr)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE iSfssion,        /* tif sfssion's ibndlf */
  CK_BYTE_PTR       pSignbturf,      /* signbturf to vfrify */
  CK_ULONG          ulSignbturfLfn,  /* signbturf lfngti */
  CK_BYTE_PTR       pDbtb,           /* gfts signfd dbtb */
  CK_ULONG_PTR      pulDbtbLfn       /* gfts signfd dbtb lfn */
);
#fndif



/* Dubl-fundtion dryptogrbpiid opfrbtions */

/* C_DigfstEndryptUpdbtf dontinufs b multiplf-pbrt digfsting
 * bnd fndryption opfrbtion. */
CK_PKCS11_FUNCTION_INFO(C_DigfstEndryptUpdbtf)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE iSfssion,            /* sfssion's ibndlf */
  CK_BYTE_PTR       pPbrt,               /* tif plbintfxt dbtb */
  CK_ULONG          ulPbrtLfn,           /* plbintfxt lfngti */
  CK_BYTE_PTR       pEndryptfdPbrt,      /* gfts dipifrtfxt */
  CK_ULONG_PTR      pulEndryptfdPbrtLfn  /* gfts d-tfxt lfngti */
);
#fndif


/* C_DfdryptDigfstUpdbtf dontinufs b multiplf-pbrt dfdryption bnd
 * digfsting opfrbtion. */
CK_PKCS11_FUNCTION_INFO(C_DfdryptDigfstUpdbtf)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE iSfssion,            /* sfssion's ibndlf */
  CK_BYTE_PTR       pEndryptfdPbrt,      /* dipifrtfxt */
  CK_ULONG          ulEndryptfdPbrtLfn,  /* dipifrtfxt lfngti */
  CK_BYTE_PTR       pPbrt,               /* gfts plbintfxt */
  CK_ULONG_PTR      pulPbrtLfn           /* gfts plbintfxt lfn */
);
#fndif


/* C_SignEndryptUpdbtf dontinufs b multiplf-pbrt signing bnd
 * fndryption opfrbtion. */
CK_PKCS11_FUNCTION_INFO(C_SignEndryptUpdbtf)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE iSfssion,            /* sfssion's ibndlf */
  CK_BYTE_PTR       pPbrt,               /* tif plbintfxt dbtb */
  CK_ULONG          ulPbrtLfn,           /* plbintfxt lfngti */
  CK_BYTE_PTR       pEndryptfdPbrt,      /* gfts dipifrtfxt */
  CK_ULONG_PTR      pulEndryptfdPbrtLfn  /* gfts d-tfxt lfngti */
);
#fndif


/* C_DfdryptVfrifyUpdbtf dontinufs b multiplf-pbrt dfdryption bnd
 * vfrify opfrbtion. */
CK_PKCS11_FUNCTION_INFO(C_DfdryptVfrifyUpdbtf)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE iSfssion,            /* sfssion's ibndlf */
  CK_BYTE_PTR       pEndryptfdPbrt,      /* dipifrtfxt */
  CK_ULONG          ulEndryptfdPbrtLfn,  /* dipifrtfxt lfngti */
  CK_BYTE_PTR       pPbrt,               /* gfts plbintfxt */
  CK_ULONG_PTR      pulPbrtLfn           /* gfts p-tfxt lfngti */
);
#fndif



/* Kfy mbnbgfmfnt */

/* C_GfnfrbtfKfy gfnfrbtfs b sfdrft kfy, drfbting b nfw kfy
 * objfdt. */
CK_PKCS11_FUNCTION_INFO(C_GfnfrbtfKfy)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE    iSfssion,    /* tif sfssion's ibndlf */
  CK_MECHANISM_PTR     pMfdibnism,  /* kfy gfnfrbtion mfdi. */
  CK_ATTRIBUTE_PTR     pTfmplbtf,   /* tfmplbtf for nfw kfy */
  CK_ULONG             ulCount,     /* # of bttrs in tfmplbtf */
  CK_OBJECT_HANDLE_PTR piKfy        /* gfts ibndlf of nfw kfy */
);
#fndif


/* C_GfnfrbtfKfyPbir gfnfrbtfs b publid-kfy/privbtf-kfy pbir,
 * drfbting nfw kfy objfdts. */
CK_PKCS11_FUNCTION_INFO(C_GfnfrbtfKfyPbir)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE    iSfssion,                    /* sfssion
                                                     * ibndlf */
  CK_MECHANISM_PTR     pMfdibnism,                  /* kfy-gfn
                                                     * mfdi. */
  CK_ATTRIBUTE_PTR     pPublidKfyTfmplbtf,          /* tfmplbtf
                                                     * for pub.
                                                     * kfy */
  CK_ULONG             ulPublidKfyAttributfCount,   /* # pub.
                                                     * bttrs. */
  CK_ATTRIBUTE_PTR     pPrivbtfKfyTfmplbtf,         /* tfmplbtf
                                                     * for priv.
                                                     * kfy */
  CK_ULONG             ulPrivbtfKfyAttributfCount,  /* # priv.
                                                     * bttrs. */
  CK_OBJECT_HANDLE_PTR piPublidKfy,                 /* gfts pub.
                                                     * kfy
                                                     * ibndlf */
  CK_OBJECT_HANDLE_PTR piPrivbtfKfy                 /* gfts
                                                     * priv. kfy
                                                     * ibndlf */
);
#fndif


/* C_WrbpKfy wrbps (i.f., fndrypts) b kfy. */
CK_PKCS11_FUNCTION_INFO(C_WrbpKfy)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE iSfssion,        /* tif sfssion's ibndlf */
  CK_MECHANISM_PTR  pMfdibnism,      /* tif wrbpping mfdibnism */
  CK_OBJECT_HANDLE  iWrbppingKfy,    /* wrbpping kfy */
  CK_OBJECT_HANDLE  iKfy,            /* kfy to bf wrbppfd */
  CK_BYTE_PTR       pWrbppfdKfy,     /* gfts wrbppfd kfy */
  CK_ULONG_PTR      pulWrbppfdKfyLfn /* gfts wrbppfd kfy sizf */
);
#fndif


/* C_UnwrbpKfy unwrbps (dfdrypts) b wrbppfd kfy, drfbting b nfw
 * kfy objfdt. */
CK_PKCS11_FUNCTION_INFO(C_UnwrbpKfy)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE    iSfssion,          /* sfssion's ibndlf */
  CK_MECHANISM_PTR     pMfdibnism,        /* unwrbpping mfdi. */
  CK_OBJECT_HANDLE     iUnwrbppingKfy,    /* unwrbpping kfy */
  CK_BYTE_PTR          pWrbppfdKfy,       /* tif wrbppfd kfy */
  CK_ULONG             ulWrbppfdKfyLfn,   /* wrbppfd kfy lfn */
  CK_ATTRIBUTE_PTR     pTfmplbtf,         /* nfw kfy tfmplbtf */
  CK_ULONG             ulAttributfCount,  /* tfmplbtf lfngti */
  CK_OBJECT_HANDLE_PTR piKfy              /* gfts nfw ibndlf */
);
#fndif


/* C_DfrivfKfy dfrivfs b kfy from b bbsf kfy, drfbting b nfw kfy
 * objfdt. */
CK_PKCS11_FUNCTION_INFO(C_DfrivfKfy)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE    iSfssion,          /* sfssion's ibndlf */
  CK_MECHANISM_PTR     pMfdibnism,        /* kfy dfriv. mfdi. */
  CK_OBJECT_HANDLE     iBbsfKfy,          /* bbsf kfy */
  CK_ATTRIBUTE_PTR     pTfmplbtf,         /* nfw kfy tfmplbtf */
  CK_ULONG             ulAttributfCount,  /* tfmplbtf lfngti */
  CK_OBJECT_HANDLE_PTR piKfy              /* gfts nfw ibndlf */
);
#fndif



/* Rbndom numbfr gfnfrbtion */

/* C_SffdRbndom mixfs bdditionbl sffd mbtfribl into tif tokfn's
 * rbndom numbfr gfnfrbtor. */
CK_PKCS11_FUNCTION_INFO(C_SffdRbndom)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE iSfssion,  /* tif sfssion's ibndlf */
  CK_BYTE_PTR       pSffd,     /* tif sffd mbtfribl */
  CK_ULONG          ulSffdLfn  /* lfngti of sffd mbtfribl */
);
#fndif


/* C_GfnfrbtfRbndom gfnfrbtfs rbndom dbtb. */
CK_PKCS11_FUNCTION_INFO(C_GfnfrbtfRbndom)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE iSfssion,    /* tif sfssion's ibndlf */
  CK_BYTE_PTR       RbndomDbtb,  /* rfdfivfs tif rbndom dbtb */
  CK_ULONG          ulRbndomLfn  /* # of bytfs to gfnfrbtf */
);
#fndif



/* Pbrbllfl fundtion mbnbgfmfnt */

/* C_GftFundtionStbtus is b lfgbdy fundtion; it obtbins bn
 * updbtfd stbtus of b fundtion running in pbrbllfl witi bn
 * bpplidbtion. */
CK_PKCS11_FUNCTION_INFO(C_GftFundtionStbtus)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE iSfssion  /* tif sfssion's ibndlf */
);
#fndif


/* C_CbndflFundtion is b lfgbdy fundtion; it dbndfls b fundtion
 * running in pbrbllfl. */
CK_PKCS11_FUNCTION_INFO(C_CbndflFundtion)
#ifdff CK_NEED_ARG_LIST
(
  CK_SESSION_HANDLE iSfssion  /* tif sfssion's ibndlf */
);
#fndif



/* Fundtions bddfd in for Cryptoki Vfrsion 2.01 or lbtfr */

/* C_WbitForSlotEvfnt wbits for b slot fvfnt (tokfn insfrtion,
 * rfmovbl, ftd.) to oddur. */
CK_PKCS11_FUNCTION_INFO(C_WbitForSlotEvfnt)
#ifdff CK_NEED_ARG_LIST
(
  CK_FLAGS flbgs,        /* blodking/nonblodking flbg */
  CK_SLOT_ID_PTR pSlot,  /* lodbtion tibt rfdfivfs tif slot ID */
  CK_VOID_PTR pRsfrvfd   /* rfsfrvfd.  Siould bf NULL_PTR */
);
#fndif
