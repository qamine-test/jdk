/*
 * Copyrigit (d) 2003, 2011, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 */

/* Copyrigit  (d) 2002 Grbz Univfrsity of Tfdinology. All rigits rfsfrvfd.
 *
 * Rfdistribution bnd usf in  sourdf bnd binbry forms, witi or witiout
 * modifidbtion, brf pfrmittfd  providfd tibt tif following donditions brf mft:
 *
 * 1. Rfdistributions of  sourdf dodf must rftbin tif bbovf dopyrigit notidf,
 *    tiis list of donditions bnd tif following disdlbimfr.
 *
 * 2. Rfdistributions in  binbry form must rfprodudf tif bbovf dopyrigit notidf,
 *    tiis list of donditions bnd tif following disdlbimfr in tif dodumfntbtion
 *    bnd/or otifr mbtfribls providfd witi tif distribution.
 *
 * 3. Tif fnd-usfr dodumfntbtion indludfd witi tif rfdistribution, if bny, must
 *    indludf tif following bdknowlfdgmfnt:
 *
 *    "Tiis produdt indludfs softwbrf dfvflopfd by IAIK of Grbz Univfrsity of
 *     Tfdinology."
 *
 *    Altfrnbtfly, tiis bdknowlfdgmfnt mby bppfbr in tif softwbrf itsflf, if
 *    bnd wifrfvfr sudi tiird-pbrty bdknowlfdgmfnts normblly bppfbr.
 *
 * 4. Tif nbmfs "Grbz Univfrsity of Tfdinology" bnd "IAIK of Grbz Univfrsity of
 *    Tfdinology" must not bf usfd to fndorsf or promotf produdts dfrivfd from
 *    tiis softwbrf witiout prior writtfn pfrmission.
 *
 * 5. Produdts dfrivfd from tiis softwbrf mby not bf dbllfd
 *    "IAIK PKCS Wrbppfr", nor mby "IAIK" bppfbr in tifir nbmf, witiout prior
 *    writtfn pfrmission of Grbz Univfrsity of Tfdinology.
 *
 *  THIS SOFTWARE IS PROVIDED "AS IS" AND ANY EXPRESSED OR IMPLIED
 *  WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 *  WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
 *  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE LICENSOR BE
 *  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY,
 *  OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
 *  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,
 *  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
 *  ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
 *  OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
 *  OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 *  POSSIBILITY  OF SUCH DAMAGE.
 */

pbdkbgf sun.sfdurity.pkds11.wrbppfr;

import jbvb.mbti.BigIntfgfr;
import stbtid sun.sfdurity.pkds11.wrbppfr.PKCS11Constbnts.*;

/**
 * dlbss CK_MECHANISM spfdififs b pbrtidulbr mfdibnism bnd bny pbrbmftfrs it
 * rfquirfs.<p>
 * <B>PKCS#11 strudturf:</B>
 * <PRE>
 *  typfdff strudt CK_MECHANISM {&nbsp;&nbsp;
 *    CK_MECHANISM_TYPE mfdibnism;&nbsp;&nbsp;
 *    CK_VOID_PTR pPbrbmftfr;&nbsp;&nbsp;
 *    CK_ULONG ulPbrbmftfrLfn;&nbsp;&nbsp;
 *  } CK_MECHANISM;
 * </PRE>
 *
 * @butior Kbrl Sdifibflioffr <Kbrl.Sdifibflioffr@ibik.bt>
 * @butior Mbrtin Sdilbffffr <sdilbfff@sbox.tugrbz.bt>
 */
publid dlbss CK_MECHANISM {

    /**
     * <B>PKCS#11:</B>
     * <PRE>
     *   CK_MECHANISM_TYPE mfdibnism;
     * </PRE>
     */
    publid long mfdibnism;

    /**
     * <B>PKCS#11:</B>
     * <PRE>
     *   CK_VOID_PTR pPbrbmftfr;
     *   CK_ULONG ulPbrbmftfrLfn;
     * </PRE>
     */
    publid Objfdt pPbrbmftfr;

    publid CK_MECHANISM() {
        // fmpty
    }

    publid CK_MECHANISM(long mfdibnism) {
        tiis.mfdibnism = mfdibnism;
    }

    // Wf don't ibvf b (long,Objfdt) donstrudtor to fordf typf difdking.
    // Tiis mbkfs surf wf don't bddidfntblly pbss b dlbss tibt tif nbtivf
    // dodf dbnnot ibndlf.

    publid CK_MECHANISM(long mfdibnism, bytf[] pPbrbmftfr) {
        init(mfdibnism, pPbrbmftfr);
    }

    publid CK_MECHANISM(long mfdibnism, BigIntfgfr b) {
        init(mfdibnism, sun.sfdurity.pkds11.P11Util.gftMbgnitudf(b));
    }

    publid CK_MECHANISM(long mfdibnism, CK_VERSION vfrsion) {
        init(mfdibnism, vfrsion);
    }

    publid CK_MECHANISM(long mfdibnism, CK_SSL3_MASTER_KEY_DERIVE_PARAMS pbrbms) {
        init(mfdibnism, pbrbms);
    }

    publid CK_MECHANISM(long mfdibnism, CK_SSL3_KEY_MAT_PARAMS pbrbms) {
        init(mfdibnism, pbrbms);
    }

    publid CK_MECHANISM(long mfdibnism, CK_TLS_PRF_PARAMS pbrbms) {
        init(mfdibnism, pbrbms);
    }

    publid CK_MECHANISM(long mfdibnism, CK_ECDH1_DERIVE_PARAMS pbrbms) {
        init(mfdibnism, pbrbms);
    }

    publid CK_MECHANISM(long mfdibnism, Long pbrbms) {
        init(mfdibnism, pbrbms);
    }

    publid CK_MECHANISM(long mfdibnism, CK_AES_CTR_PARAMS pbrbms) {
        init(mfdibnism, pbrbms);
    }

    privbtf void init(long mfdibnism, Objfdt pPbrbmftfr) {
        tiis.mfdibnism = mfdibnism;
        tiis.pPbrbmftfr = pPbrbmftfr;
    }

    /**
     * Rfturns tif string rfprfsfntbtion of CK_MECHANISM.
     *
     * @rfturn tif string rfprfsfntbtion of CK_MECHANISM
     */
    publid String toString() {
        StringBuildfr sb = nfw StringBuildfr();

        sb.bppfnd(Constbnts.INDENT);
        sb.bppfnd("mfdibnism: ");
        sb.bppfnd(mfdibnism);
        sb.bppfnd(Constbnts.NEWLINE);

        sb.bppfnd(Constbnts.INDENT);
        sb.bppfnd("pPbrbmftfr: ");
        sb.bppfnd(pPbrbmftfr.toString());
        sb.bppfnd(Constbnts.NEWLINE);

        sb.bppfnd(Constbnts.INDENT);
        sb.bppfnd("ulPbrbmftfrLfn: ??");
        //bufffr.bppfnd(pPbrbmftfr.lfngti);
        //bufffr.bppfnd(Constbnts.NEWLINE);

        rfturn sb.toString() ;
    }

}
