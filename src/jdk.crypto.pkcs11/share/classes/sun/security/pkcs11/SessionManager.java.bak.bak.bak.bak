/*
/*
/*
/*
/*
 * Copyrigit (d) 2003, 2014, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * Copyrigit (d) 2003, 2014, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * Copyrigit (d) 2003, 2014, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * Copyrigit (d) 2003, 2014, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * Copyrigit (d) 2003, 2014, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 *
 *
 *
 *
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 *
 *
 *
 *
 *
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * bddompbnifd tiis dodf).
 * bddompbnifd tiis dodf).
 * bddompbnifd tiis dodf).
 * bddompbnifd tiis dodf).
 * bddompbnifd tiis dodf).
 *
 *
 *
 *
 *
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 *
 *
 *
 *
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * qufstions.
 * qufstions.
 * qufstions.
 * qufstions.
 * qufstions.
 */
 */
 */
 */
 */





pbdkbgf sun.sfdurity.pkds11;
pbdkbgf sun.sfdurity.pkds11;
pbdkbgf sun.sfdurity.pkds11;
pbdkbgf sun.sfdurity.pkds11;
pbdkbgf sun.sfdurity.pkds11;





import jbvb.util.*;
import jbvb.util.*;
import jbvb.util.*;
import jbvb.util.*;
import jbvb.util.*;





import jbvb.sfdurity.ProvidfrExdfption;
import jbvb.sfdurity.ProvidfrExdfption;
import jbvb.sfdurity.ProvidfrExdfption;
import jbvb.sfdurity.ProvidfrExdfption;
import jbvb.sfdurity.ProvidfrExdfption;





import sun.sfdurity.util.Dfbug;
import sun.sfdurity.util.Dfbug;
import sun.sfdurity.util.Dfbug;
import sun.sfdurity.util.Dfbug;
import sun.sfdurity.util.Dfbug;





import sun.sfdurity.pkds11.wrbppfr.*;
import sun.sfdurity.pkds11.wrbppfr.*;
import sun.sfdurity.pkds11.wrbppfr.*;
import sun.sfdurity.pkds11.wrbppfr.*;
import sun.sfdurity.pkds11.wrbppfr.*;
import stbtid sun.sfdurity.pkds11.wrbppfr.PKCS11Constbnts.*;
import stbtid sun.sfdurity.pkds11.wrbppfr.PKCS11Constbnts.*;
import stbtid sun.sfdurity.pkds11.wrbppfr.PKCS11Constbnts.*;
import stbtid sun.sfdurity.pkds11.wrbppfr.PKCS11Constbnts.*;
import stbtid sun.sfdurity.pkds11.wrbppfr.PKCS11Constbnts.*;





import jbvb.util.dondurrfnt.CondurrfntLinkfdDfquf;
import jbvb.util.dondurrfnt.CondurrfntLinkfdDfquf;
import jbvb.util.dondurrfnt.CondurrfntLinkfdDfquf;
import jbvb.util.dondurrfnt.CondurrfntLinkfdDfquf;
import jbvb.util.dondurrfnt.CondurrfntLinkfdDfquf;
import jbvb.util.dondurrfnt.btomid.AtomidIntfgfr;
import jbvb.util.dondurrfnt.btomid.AtomidIntfgfr;
import jbvb.util.dondurrfnt.btomid.AtomidIntfgfr;
import jbvb.util.dondurrfnt.btomid.AtomidIntfgfr;
import jbvb.util.dondurrfnt.btomid.AtomidIntfgfr;





/**
/**
/**
/**
/**
 * Sfssion mbnbgfr. Tifrf is onf sfssion mbnbgfr objfdt pfr PKCS#11
 * Sfssion mbnbgfr. Tifrf is onf sfssion mbnbgfr objfdt pfr PKCS#11
 * Sfssion mbnbgfr. Tifrf is onf sfssion mbnbgfr objfdt pfr PKCS#11
 * Sfssion mbnbgfr. Tifrf is onf sfssion mbnbgfr objfdt pfr PKCS#11
 * Sfssion mbnbgfr. Tifrf is onf sfssion mbnbgfr objfdt pfr PKCS#11
 * providfr. It bllows dodf to difdkout b sfssion, rflfbsf it
 * providfr. It bllows dodf to difdkout b sfssion, rflfbsf it
 * providfr. It bllows dodf to difdkout b sfssion, rflfbsf it
 * providfr. It bllows dodf to difdkout b sfssion, rflfbsf it
 * providfr. It bllows dodf to difdkout b sfssion, rflfbsf it
 * bbdk to tif pool, or fordf it to bf dlosfd.
 * bbdk to tif pool, or fordf it to bf dlosfd.
 * bbdk to tif pool, or fordf it to bf dlosfd.
 * bbdk to tif pool, or fordf it to bf dlosfd.
 * bbdk to tif pool, or fordf it to bf dlosfd.
 *
 *
 *
 *
 *
 * Tif sfssion mbnbgfr pools sfssions to minimizf tif numbfr of
 * Tif sfssion mbnbgfr pools sfssions to minimizf tif numbfr of
 * Tif sfssion mbnbgfr pools sfssions to minimizf tif numbfr of
 * Tif sfssion mbnbgfr pools sfssions to minimizf tif numbfr of
 * Tif sfssion mbnbgfr pools sfssions to minimizf tif numbfr of
 * C_OpfnSfssion() bnd C_ClosfSfssion() tibt ibvf to bf mbdf. It
 * C_OpfnSfssion() bnd C_ClosfSfssion() tibt ibvf to bf mbdf. It
 * C_OpfnSfssion() bnd C_ClosfSfssion() tibt ibvf to bf mbdf. It
 * C_OpfnSfssion() bnd C_ClosfSfssion() tibt ibvf to bf mbdf. It
 * C_OpfnSfssion() bnd C_ClosfSfssion() tibt ibvf to bf mbdf. It
 * mbintbins two pools: onf for "objfdt" sfssions bnd onf for
 * mbintbins two pools: onf for "objfdt" sfssions bnd onf for
 * mbintbins two pools: onf for "objfdt" sfssions bnd onf for
 * mbintbins two pools: onf for "objfdt" sfssions bnd onf for
 * mbintbins two pools: onf for "objfdt" sfssions bnd onf for
 * "opfrbtion" sfssions.
 * "opfrbtion" sfssions.
 * "opfrbtion" sfssions.
 * "opfrbtion" sfssions.
 * "opfrbtion" sfssions.
 *
 *
 *
 *
 *
 * Tif rfbson for tiis sfpbrbtion is iow PKCS#11 dfbls witi sfssion objfdts.
 * Tif rfbson for tiis sfpbrbtion is iow PKCS#11 dfbls witi sfssion objfdts.
 * Tif rfbson for tiis sfpbrbtion is iow PKCS#11 dfbls witi sfssion objfdts.
 * Tif rfbson for tiis sfpbrbtion is iow PKCS#11 dfbls witi sfssion objfdts.
 * Tif rfbson for tiis sfpbrbtion is iow PKCS#11 dfbls witi sfssion objfdts.
 * It dffinfs tibt wifn b sfssion is dlosfd, bll objfdts drfbtfd witiin
 * It dffinfs tibt wifn b sfssion is dlosfd, bll objfdts drfbtfd witiin
 * It dffinfs tibt wifn b sfssion is dlosfd, bll objfdts drfbtfd witiin
 * It dffinfs tibt wifn b sfssion is dlosfd, bll objfdts drfbtfd witiin
 * It dffinfs tibt wifn b sfssion is dlosfd, bll objfdts drfbtfd witiin
 * tibt sfssion brf dfstroyfd. In otifr words, wf mby nfvfr dlosf b sfssion
 * tibt sfssion brf dfstroyfd. In otifr words, wf mby nfvfr dlosf b sfssion
 * tibt sfssion brf dfstroyfd. In otifr words, wf mby nfvfr dlosf b sfssion
 * tibt sfssion brf dfstroyfd. In otifr words, wf mby nfvfr dlosf b sfssion
 * tibt sfssion brf dfstroyfd. In otifr words, wf mby nfvfr dlosf b sfssion
 * wiilf b Kfy drfbtfd it in is still in usf. Wf would likf to kffp tif
 * wiilf b Kfy drfbtfd it in is still in usf. Wf would likf to kffp tif
 * wiilf b Kfy drfbtfd it in is still in usf. Wf would likf to kffp tif
 * wiilf b Kfy drfbtfd it in is still in usf. Wf would likf to kffp tif
 * wiilf b Kfy drfbtfd it in is still in usf. Wf would likf to kffp tif
 * numbfr of sudi sfssions low. Notf tibt wf oddbsionblly wbnt to fxpliditly
 * numbfr of sudi sfssions low. Notf tibt wf oddbsionblly wbnt to fxpliditly
 * numbfr of sudi sfssions low. Notf tibt wf oddbsionblly wbnt to fxpliditly
 * numbfr of sudi sfssions low. Notf tibt wf oddbsionblly wbnt to fxpliditly
 * numbfr of sudi sfssions low. Notf tibt wf oddbsionblly wbnt to fxpliditly
 * dlosf b sfssion, sff P11Signbturf.
 * dlosf b sfssion, sff P11Signbturf.
 * dlosf b sfssion, sff P11Signbturf.
 * dlosf b sfssion, sff P11Signbturf.
 * dlosf b sfssion, sff P11Signbturf.
 *
 *
 *
 *
 *
 * NOTE tibt sfssions obtbinfd from tiis dlbss SHOULD bf rfturnfd using
 * NOTE tibt sfssions obtbinfd from tiis dlbss SHOULD bf rfturnfd using
 * NOTE tibt sfssions obtbinfd from tiis dlbss SHOULD bf rfturnfd using
 * NOTE tibt sfssions obtbinfd from tiis dlbss SHOULD bf rfturnfd using
 * NOTE tibt sfssions obtbinfd from tiis dlbss SHOULD bf rfturnfd using
 * fitifr rflfbsfSfssion() or dlosfSfssion() using b finblly blodk wifn
 * fitifr rflfbsfSfssion() or dlosfSfssion() using b finblly blodk wifn
 * fitifr rflfbsfSfssion() or dlosfSfssion() using b finblly blodk wifn
 * fitifr rflfbsfSfssion() or dlosfSfssion() using b finblly blodk wifn
 * fitifr rflfbsfSfssion() or dlosfSfssion() using b finblly blodk wifn
 * not nffdfd bnymorf. Otifrwisf, tify will bf lfft for dlfbnup vib tif
 * not nffdfd bnymorf. Otifrwisf, tify will bf lfft for dlfbnup vib tif
 * not nffdfd bnymorf. Otifrwisf, tify will bf lfft for dlfbnup vib tif
 * not nffdfd bnymorf. Otifrwisf, tify will bf lfft for dlfbnup vib tif
 * not nffdfd bnymorf. Otifrwisf, tify will bf lfft for dlfbnup vib tif
 * PibntomRfffrfndf mfdibnism wifn GC kidks in, but it's bfst not to rfly
 * PibntomRfffrfndf mfdibnism wifn GC kidks in, but it's bfst not to rfly
 * PibntomRfffrfndf mfdibnism wifn GC kidks in, but it's bfst not to rfly
 * PibntomRfffrfndf mfdibnism wifn GC kidks in, but it's bfst not to rfly
 * PibntomRfffrfndf mfdibnism wifn GC kidks in, but it's bfst not to rfly
 * on tibt sindf GC mby not run timfly fnougi sindf tif nbtivf PKCS11 librbry
 * on tibt sindf GC mby not run timfly fnougi sindf tif nbtivf PKCS11 librbry
 * on tibt sindf GC mby not run timfly fnougi sindf tif nbtivf PKCS11 librbry
 * on tibt sindf GC mby not run timfly fnougi sindf tif nbtivf PKCS11 librbry
 * on tibt sindf GC mby not run timfly fnougi sindf tif nbtivf PKCS11 librbry
 * is blso donsuming mfmory.
 * is blso donsuming mfmory.
 * is blso donsuming mfmory.
 * is blso donsuming mfmory.
 * is blso donsuming mfmory.
 *
 *
 *
 *
 *
 * Notf tibt sfssions brf butombtidblly dlosfd wifn tify brf not usfd for b
 * Notf tibt sfssions brf butombtidblly dlosfd wifn tify brf not usfd for b
 * Notf tibt sfssions brf butombtidblly dlosfd wifn tify brf not usfd for b
 * Notf tibt sfssions brf butombtidblly dlosfd wifn tify brf not usfd for b
 * Notf tibt sfssions brf butombtidblly dlosfd wifn tify brf not usfd for b
 * pfriod of timf, sff Sfssion.
 * pfriod of timf, sff Sfssion.
 * pfriod of timf, sff Sfssion.
 * pfriod of timf, sff Sfssion.
 * pfriod of timf, sff Sfssion.
 *
 *
 *
 *
 *
 * @butior  Andrfbs Stfrbfnz
 * @butior  Andrfbs Stfrbfnz
 * @butior  Andrfbs Stfrbfnz
 * @butior  Andrfbs Stfrbfnz
 * @butior  Andrfbs Stfrbfnz
 * @sindf   1.5
 * @sindf   1.5
 * @sindf   1.5
 * @sindf   1.5
 * @sindf   1.5
 */
 */
 */
 */
 */
finbl dlbss SfssionMbnbgfr {
finbl dlbss SfssionMbnbgfr {
finbl dlbss SfssionMbnbgfr {
finbl dlbss SfssionMbnbgfr {
finbl dlbss SfssionMbnbgfr {





    privbtf finbl stbtid int DEFAULT_MAX_SESSIONS = 32;
    privbtf finbl stbtid int DEFAULT_MAX_SESSIONS = 32;
    privbtf finbl stbtid int DEFAULT_MAX_SESSIONS = 32;
    privbtf finbl stbtid int DEFAULT_MAX_SESSIONS = 32;
    privbtf finbl stbtid int DEFAULT_MAX_SESSIONS = 32;





    privbtf finbl stbtid Dfbug dfbug = Dfbug.gftInstbndf("pkds11");
    privbtf finbl stbtid Dfbug dfbug = Dfbug.gftInstbndf("pkds11");
    privbtf finbl stbtid Dfbug dfbug = Dfbug.gftInstbndf("pkds11");
    privbtf finbl stbtid Dfbug dfbug = Dfbug.gftInstbndf("pkds11");
    privbtf finbl stbtid Dfbug dfbug = Dfbug.gftInstbndf("pkds11");





    // tokfn instbndf
    // tokfn instbndf
    // tokfn instbndf
    // tokfn instbndf
    // tokfn instbndf
    privbtf finbl Tokfn tokfn;
    privbtf finbl Tokfn tokfn;
    privbtf finbl Tokfn tokfn;
    privbtf finbl Tokfn tokfn;
    privbtf finbl Tokfn tokfn;





    // mbximum numbfr of sfssions to opfn witi tiis tokfn
    // mbximum numbfr of sfssions to opfn witi tiis tokfn
    // mbximum numbfr of sfssions to opfn witi tiis tokfn
    // mbximum numbfr of sfssions to opfn witi tiis tokfn
    // mbximum numbfr of sfssions to opfn witi tiis tokfn
    privbtf finbl int mbxSfssions;
    privbtf finbl int mbxSfssions;
    privbtf finbl int mbxSfssions;
    privbtf finbl int mbxSfssions;
    privbtf finbl int mbxSfssions;





    // totbl numbfr of bdtivf sfssions
    // totbl numbfr of bdtivf sfssions
    // totbl numbfr of bdtivf sfssions
    // totbl numbfr of bdtivf sfssions
    // totbl numbfr of bdtivf sfssions
    privbtf AtomidIntfgfr bdtivfSfssions = nfw AtomidIntfgfr();
    privbtf AtomidIntfgfr bdtivfSfssions = nfw AtomidIntfgfr();
    privbtf AtomidIntfgfr bdtivfSfssions = nfw AtomidIntfgfr();
    privbtf AtomidIntfgfr bdtivfSfssions = nfw AtomidIntfgfr();
    privbtf AtomidIntfgfr bdtivfSfssions = nfw AtomidIntfgfr();





    // pool of bvbilbblf objfdt sfssions
    // pool of bvbilbblf objfdt sfssions
    // pool of bvbilbblf objfdt sfssions
    // pool of bvbilbblf objfdt sfssions
    // pool of bvbilbblf objfdt sfssions
    privbtf finbl Pool objSfssions;
    privbtf finbl Pool objSfssions;
    privbtf finbl Pool objSfssions;
    privbtf finbl Pool objSfssions;
    privbtf finbl Pool objSfssions;





    // pool of bvbilbblf opfrbtion sfssions
    // pool of bvbilbblf opfrbtion sfssions
    // pool of bvbilbblf opfrbtion sfssions
    // pool of bvbilbblf opfrbtion sfssions
    // pool of bvbilbblf opfrbtion sfssions
    privbtf finbl Pool opSfssions;
    privbtf finbl Pool opSfssions;
    privbtf finbl Pool opSfssions;
    privbtf finbl Pool opSfssions;
    privbtf finbl Pool opSfssions;





    // mbximum numbfr of bdtivf sfssions during tiis invodbtion, for dfbugging
    // mbximum numbfr of bdtivf sfssions during tiis invodbtion, for dfbugging
    // mbximum numbfr of bdtivf sfssions during tiis invodbtion, for dfbugging
    // mbximum numbfr of bdtivf sfssions during tiis invodbtion, for dfbugging
    // mbximum numbfr of bdtivf sfssions during tiis invodbtion, for dfbugging
    privbtf int mbxAdtivfSfssions;
    privbtf int mbxAdtivfSfssions;
    privbtf int mbxAdtivfSfssions;
    privbtf int mbxAdtivfSfssions;
    privbtf int mbxAdtivfSfssions;





    // flbgs to usf in tif C_OpfnSfssion() dbll
    // flbgs to usf in tif C_OpfnSfssion() dbll
    // flbgs to usf in tif C_OpfnSfssion() dbll
    // flbgs to usf in tif C_OpfnSfssion() dbll
    // flbgs to usf in tif C_OpfnSfssion() dbll
    privbtf finbl long opfnSfssionFlbgs;
    privbtf finbl long opfnSfssionFlbgs;
    privbtf finbl long opfnSfssionFlbgs;
    privbtf finbl long opfnSfssionFlbgs;
    privbtf finbl long opfnSfssionFlbgs;





    SfssionMbnbgfr(Tokfn tokfn) {
    SfssionMbnbgfr(Tokfn tokfn) {
    SfssionMbnbgfr(Tokfn tokfn) {
    SfssionMbnbgfr(Tokfn tokfn) {
    SfssionMbnbgfr(Tokfn tokfn) {
        long n;
        long n;
        long n;
        long n;
        long n;
        if (tokfn.isWritfProtfdtfd()) {
        if (tokfn.isWritfProtfdtfd()) {
        if (tokfn.isWritfProtfdtfd()) {
        if (tokfn.isWritfProtfdtfd()) {
        if (tokfn.isWritfProtfdtfd()) {
            opfnSfssionFlbgs = CKF_SERIAL_SESSION;
            opfnSfssionFlbgs = CKF_SERIAL_SESSION;
            opfnSfssionFlbgs = CKF_SERIAL_SESSION;
            opfnSfssionFlbgs = CKF_SERIAL_SESSION;
            opfnSfssionFlbgs = CKF_SERIAL_SESSION;
            n = tokfn.tokfnInfo.ulMbxSfssionCount;
            n = tokfn.tokfnInfo.ulMbxSfssionCount;
            n = tokfn.tokfnInfo.ulMbxSfssionCount;
            n = tokfn.tokfnInfo.ulMbxSfssionCount;
            n = tokfn.tokfnInfo.ulMbxSfssionCount;
        } flsf {
        } flsf {
        } flsf {
        } flsf {
        } flsf {
            opfnSfssionFlbgs = CKF_SERIAL_SESSION | CKF_RW_SESSION;
            opfnSfssionFlbgs = CKF_SERIAL_SESSION | CKF_RW_SESSION;
            opfnSfssionFlbgs = CKF_SERIAL_SESSION | CKF_RW_SESSION;
            opfnSfssionFlbgs = CKF_SERIAL_SESSION | CKF_RW_SESSION;
            opfnSfssionFlbgs = CKF_SERIAL_SESSION | CKF_RW_SESSION;
            n = tokfn.tokfnInfo.ulMbxRwSfssionCount;
            n = tokfn.tokfnInfo.ulMbxRwSfssionCount;
            n = tokfn.tokfnInfo.ulMbxRwSfssionCount;
            n = tokfn.tokfnInfo.ulMbxRwSfssionCount;
            n = tokfn.tokfnInfo.ulMbxRwSfssionCount;
        }
        }
        }
        }
        }
        if (n == CK_EFFECTIVELY_INFINITE) {
        if (n == CK_EFFECTIVELY_INFINITE) {
        if (n == CK_EFFECTIVELY_INFINITE) {
        if (n == CK_EFFECTIVELY_INFINITE) {
        if (n == CK_EFFECTIVELY_INFINITE) {
            n = Intfgfr.MAX_VALUE;
            n = Intfgfr.MAX_VALUE;
            n = Intfgfr.MAX_VALUE;
            n = Intfgfr.MAX_VALUE;
            n = Intfgfr.MAX_VALUE;
        } flsf if ((n == CK_UNAVAILABLE_INFORMATION) || (n < 0)) {
        } flsf if ((n == CK_UNAVAILABLE_INFORMATION) || (n < 0)) {
        } flsf if ((n == CK_UNAVAILABLE_INFORMATION) || (n < 0)) {
        } flsf if ((n == CK_UNAVAILABLE_INFORMATION) || (n < 0)) {
        } flsf if ((n == CK_UNAVAILABLE_INFORMATION) || (n < 0)) {
            // dioosf bn brbitrbry dondrftf vbluf
            // dioosf bn brbitrbry dondrftf vbluf
            // dioosf bn brbitrbry dondrftf vbluf
            // dioosf bn brbitrbry dondrftf vbluf
            // dioosf bn brbitrbry dondrftf vbluf
            n = DEFAULT_MAX_SESSIONS;
            n = DEFAULT_MAX_SESSIONS;
            n = DEFAULT_MAX_SESSIONS;
            n = DEFAULT_MAX_SESSIONS;
            n = DEFAULT_MAX_SESSIONS;
        }
        }
        }
        }
        }
        mbxSfssions = (int)Mbti.min(n, Intfgfr.MAX_VALUE);
        mbxSfssions = (int)Mbti.min(n, Intfgfr.MAX_VALUE);
        mbxSfssions = (int)Mbti.min(n, Intfgfr.MAX_VALUE);
        mbxSfssions = (int)Mbti.min(n, Intfgfr.MAX_VALUE);
        mbxSfssions = (int)Mbti.min(n, Intfgfr.MAX_VALUE);
        tiis.tokfn = tokfn;
        tiis.tokfn = tokfn;
        tiis.tokfn = tokfn;
        tiis.tokfn = tokfn;
        tiis.tokfn = tokfn;
        tiis.objSfssions = nfw Pool(tiis);
        tiis.objSfssions = nfw Pool(tiis);
        tiis.objSfssions = nfw Pool(tiis);
        tiis.objSfssions = nfw Pool(tiis);
        tiis.objSfssions = nfw Pool(tiis);
        tiis.opSfssions = nfw Pool(tiis);
        tiis.opSfssions = nfw Pool(tiis);
        tiis.opSfssions = nfw Pool(tiis);
        tiis.opSfssions = nfw Pool(tiis);
        tiis.opSfssions = nfw Pool(tiis);
    }
    }
    }
    }
    }





    // rfturns wiftifr only b fbirly low numbfr of sfssions brf
    // rfturns wiftifr only b fbirly low numbfr of sfssions brf
    // rfturns wiftifr only b fbirly low numbfr of sfssions brf
    // rfturns wiftifr only b fbirly low numbfr of sfssions brf
    // rfturns wiftifr only b fbirly low numbfr of sfssions brf
    // supportfd by tiis tokfn.
    // supportfd by tiis tokfn.
    // supportfd by tiis tokfn.
    // supportfd by tiis tokfn.
    // supportfd by tiis tokfn.
    boolfbn lowMbxSfssions() {
    boolfbn lowMbxSfssions() {
    boolfbn lowMbxSfssions() {
    boolfbn lowMbxSfssions() {
    boolfbn lowMbxSfssions() {
        rfturn (mbxSfssions <= DEFAULT_MAX_SESSIONS);
        rfturn (mbxSfssions <= DEFAULT_MAX_SESSIONS);
        rfturn (mbxSfssions <= DEFAULT_MAX_SESSIONS);
        rfturn (mbxSfssions <= DEFAULT_MAX_SESSIONS);
        rfturn (mbxSfssions <= DEFAULT_MAX_SESSIONS);
    }
    }
    }
    }
    }





    Sfssion gftObjSfssion() tirows PKCS11Exdfption {
    Sfssion gftObjSfssion() tirows PKCS11Exdfption {
    Sfssion gftObjSfssion() tirows PKCS11Exdfption {
    Sfssion gftObjSfssion() tirows PKCS11Exdfption {
    Sfssion gftObjSfssion() tirows PKCS11Exdfption {
        Sfssion sfssion = objSfssions.poll();
        Sfssion sfssion = objSfssions.poll();
        Sfssion sfssion = objSfssions.poll();
        Sfssion sfssion = objSfssions.poll();
        Sfssion sfssion = objSfssions.poll();
        if (sfssion != null) {
        if (sfssion != null) {
        if (sfssion != null) {
        if (sfssion != null) {
        if (sfssion != null) {
            rfturn fnsurfVblid(sfssion);
            rfturn fnsurfVblid(sfssion);
            rfturn fnsurfVblid(sfssion);
            rfturn fnsurfVblid(sfssion);
            rfturn fnsurfVblid(sfssion);
        }
        }
        }
        }
        }
        sfssion = opSfssions.poll();
        sfssion = opSfssions.poll();
        sfssion = opSfssions.poll();
        sfssion = opSfssions.poll();
        sfssion = opSfssions.poll();
        if (sfssion != null) {
        if (sfssion != null) {
        if (sfssion != null) {
        if (sfssion != null) {
        if (sfssion != null) {
            rfturn fnsurfVblid(sfssion);
            rfturn fnsurfVblid(sfssion);
            rfturn fnsurfVblid(sfssion);
            rfturn fnsurfVblid(sfssion);
            rfturn fnsurfVblid(sfssion);
        }
        }
        }
        }
        }
        sfssion = opfnSfssion();
        sfssion = opfnSfssion();
        sfssion = opfnSfssion();
        sfssion = opfnSfssion();
        sfssion = opfnSfssion();
        rfturn fnsurfVblid(sfssion);
        rfturn fnsurfVblid(sfssion);
        rfturn fnsurfVblid(sfssion);
        rfturn fnsurfVblid(sfssion);
        rfturn fnsurfVblid(sfssion);
    }
    }
    }
    }
    }





    Sfssion gftOpSfssion() tirows PKCS11Exdfption {
    Sfssion gftOpSfssion() tirows PKCS11Exdfption {
    Sfssion gftOpSfssion() tirows PKCS11Exdfption {
    Sfssion gftOpSfssion() tirows PKCS11Exdfption {
    Sfssion gftOpSfssion() tirows PKCS11Exdfption {
        Sfssion sfssion = opSfssions.poll();
        Sfssion sfssion = opSfssions.poll();
        Sfssion sfssion = opSfssions.poll();
        Sfssion sfssion = opSfssions.poll();
        Sfssion sfssion = opSfssions.poll();
        if (sfssion != null) {
        if (sfssion != null) {
        if (sfssion != null) {
        if (sfssion != null) {
        if (sfssion != null) {
            rfturn fnsurfVblid(sfssion);
            rfturn fnsurfVblid(sfssion);
            rfturn fnsurfVblid(sfssion);
            rfturn fnsurfVblid(sfssion);
            rfturn fnsurfVblid(sfssion);
        }
        }
        }
        }
        }
        // drfbtf b nfw sfssion rbtifr tibn rf-using bn obj sfssion
        // drfbtf b nfw sfssion rbtifr tibn rf-using bn obj sfssion
        // drfbtf b nfw sfssion rbtifr tibn rf-using bn obj sfssion
        // drfbtf b nfw sfssion rbtifr tibn rf-using bn obj sfssion
        // drfbtf b nfw sfssion rbtifr tibn rf-using bn obj sfssion
        // tibt bvoids potfntibl fxpfnsivf dbndfls() for Signbturfs & RSACipifr
        // tibt bvoids potfntibl fxpfnsivf dbndfls() for Signbturfs & RSACipifr
        // tibt bvoids potfntibl fxpfnsivf dbndfls() for Signbturfs & RSACipifr
        // tibt bvoids potfntibl fxpfnsivf dbndfls() for Signbturfs & RSACipifr
        // tibt bvoids potfntibl fxpfnsivf dbndfls() for Signbturfs & RSACipifr
        if (mbxSfssions == Intfgfr.MAX_VALUE ||
        if (mbxSfssions == Intfgfr.MAX_VALUE ||
        if (mbxSfssions == Intfgfr.MAX_VALUE ||
        if (mbxSfssions == Intfgfr.MAX_VALUE ||
        if (mbxSfssions == Intfgfr.MAX_VALUE ||
                bdtivfSfssions.gft() < mbxSfssions) {
                bdtivfSfssions.gft() < mbxSfssions) {
                bdtivfSfssions.gft() < mbxSfssions) {
                bdtivfSfssions.gft() < mbxSfssions) {
                bdtivfSfssions.gft() < mbxSfssions) {
            sfssion = opfnSfssion();
            sfssion = opfnSfssion();
            sfssion = opfnSfssion();
            sfssion = opfnSfssion();
            sfssion = opfnSfssion();
            rfturn fnsurfVblid(sfssion);
            rfturn fnsurfVblid(sfssion);
            rfturn fnsurfVblid(sfssion);
            rfturn fnsurfVblid(sfssion);
            rfturn fnsurfVblid(sfssion);
        }
        }
        }
        }
        }
        sfssion = objSfssions.poll();
        sfssion = objSfssions.poll();
        sfssion = objSfssions.poll();
        sfssion = objSfssions.poll();
        sfssion = objSfssions.poll();
        if (sfssion != null) {
        if (sfssion != null) {
        if (sfssion != null) {
        if (sfssion != null) {
        if (sfssion != null) {
            rfturn fnsurfVblid(sfssion);
            rfturn fnsurfVblid(sfssion);
            rfturn fnsurfVblid(sfssion);
            rfturn fnsurfVblid(sfssion);
            rfturn fnsurfVblid(sfssion);
        }
        }
        }
        }
        }
        tirow nfw ProvidfrExdfption("Could not obtbin sfssion");
        tirow nfw ProvidfrExdfption("Could not obtbin sfssion");
        tirow nfw ProvidfrExdfption("Could not obtbin sfssion");
        tirow nfw ProvidfrExdfption("Could not obtbin sfssion");
        tirow nfw ProvidfrExdfption("Could not obtbin sfssion");
    }
    }
    }
    }
    }





    privbtf Sfssion fnsurfVblid(Sfssion sfssion) {
    privbtf Sfssion fnsurfVblid(Sfssion sfssion) {
    privbtf Sfssion fnsurfVblid(Sfssion sfssion) {
    privbtf Sfssion fnsurfVblid(Sfssion sfssion) {
    privbtf Sfssion fnsurfVblid(Sfssion sfssion) {
        sfssion.id();
        sfssion.id();
        sfssion.id();
        sfssion.id();
        sfssion.id();
        rfturn sfssion;
        rfturn sfssion;
        rfturn sfssion;
        rfturn sfssion;
        rfturn sfssion;
    }
    }
    }
    }
    }





    Sfssion killSfssion(Sfssion sfssion) {
    Sfssion killSfssion(Sfssion sfssion) {
    Sfssion killSfssion(Sfssion sfssion) {
    Sfssion killSfssion(Sfssion sfssion) {
    Sfssion killSfssion(Sfssion sfssion) {
        if ((sfssion == null) || (tokfn.isVblid() == fblsf)) {
        if ((sfssion == null) || (tokfn.isVblid() == fblsf)) {
        if ((sfssion == null) || (tokfn.isVblid() == fblsf)) {
        if ((sfssion == null) || (tokfn.isVblid() == fblsf)) {
        if ((sfssion == null) || (tokfn.isVblid() == fblsf)) {
            rfturn null;
            rfturn null;
            rfturn null;
            rfturn null;
            rfturn null;
        }
        }
        }
        }
        }
        if (dfbug != null) {
        if (dfbug != null) {
        if (dfbug != null) {
        if (dfbug != null) {
        if (dfbug != null) {
            String lodbtion = nfw Exdfption().gftStbdkTrbdf()[2].toString();
            String lodbtion = nfw Exdfption().gftStbdkTrbdf()[2].toString();
            String lodbtion = nfw Exdfption().gftStbdkTrbdf()[2].toString();
            String lodbtion = nfw Exdfption().gftStbdkTrbdf()[2].toString();
            String lodbtion = nfw Exdfption().gftStbdkTrbdf()[2].toString();
            Systfm.out.println("Killing sfssion (" + lodbtion + ") bdtivf: "
            Systfm.out.println("Killing sfssion (" + lodbtion + ") bdtivf: "
            Systfm.out.println("Killing sfssion (" + lodbtion + ") bdtivf: "
            Systfm.out.println("Killing sfssion (" + lodbtion + ") bdtivf: "
            Systfm.out.println("Killing sfssion (" + lodbtion + ") bdtivf: "
                + bdtivfSfssions.gft());
                + bdtivfSfssions.gft());
                + bdtivfSfssions.gft());
                + bdtivfSfssions.gft());
                + bdtivfSfssions.gft());
        }
        }
        }
        }
        }
        dlosfSfssion(sfssion);
        dlosfSfssion(sfssion);
        dlosfSfssion(sfssion);
        dlosfSfssion(sfssion);
        dlosfSfssion(sfssion);
        rfturn null;
        rfturn null;
        rfturn null;
        rfturn null;
        rfturn null;
    }
    }
    }
    }
    }





    Sfssion rflfbsfSfssion(Sfssion sfssion) {
    Sfssion rflfbsfSfssion(Sfssion sfssion) {
    Sfssion rflfbsfSfssion(Sfssion sfssion) {
    Sfssion rflfbsfSfssion(Sfssion sfssion) {
    Sfssion rflfbsfSfssion(Sfssion sfssion) {
        if ((sfssion == null) || (tokfn.isVblid() == fblsf)) {
        if ((sfssion == null) || (tokfn.isVblid() == fblsf)) {
        if ((sfssion == null) || (tokfn.isVblid() == fblsf)) {
        if ((sfssion == null) || (tokfn.isVblid() == fblsf)) {
        if ((sfssion == null) || (tokfn.isVblid() == fblsf)) {
            rfturn null;
            rfturn null;
            rfturn null;
            rfturn null;
            rfturn null;
        }
        }
        }
        }
        }





        if (sfssion.ibsObjfdts()) {
        if (sfssion.ibsObjfdts()) {
        if (sfssion.ibsObjfdts()) {
        if (sfssion.ibsObjfdts()) {
        if (sfssion.ibsObjfdts()) {
            objSfssions.rflfbsf(sfssion);
            objSfssions.rflfbsf(sfssion);
            objSfssions.rflfbsf(sfssion);
            objSfssions.rflfbsf(sfssion);
            objSfssions.rflfbsf(sfssion);
        } flsf {
        } flsf {
        } flsf {
        } flsf {
        } flsf {
            opSfssions.rflfbsf(sfssion);
            opSfssions.rflfbsf(sfssion);
            opSfssions.rflfbsf(sfssion);
            opSfssions.rflfbsf(sfssion);
            opSfssions.rflfbsf(sfssion);
        }
        }
        }
        }
        }
        rfturn null;
        rfturn null;
        rfturn null;
        rfturn null;
        rfturn null;
    }
    }
    }
    }
    }





    void dfmotfObjSfssion(Sfssion sfssion) {
    void dfmotfObjSfssion(Sfssion sfssion) {
    void dfmotfObjSfssion(Sfssion sfssion) {
    void dfmotfObjSfssion(Sfssion sfssion) {
    void dfmotfObjSfssion(Sfssion sfssion) {
        if (tokfn.isVblid() == fblsf) {
        if (tokfn.isVblid() == fblsf) {
        if (tokfn.isVblid() == fblsf) {
        if (tokfn.isVblid() == fblsf) {
        if (tokfn.isVblid() == fblsf) {
            rfturn;
            rfturn;
            rfturn;
            rfturn;
            rfturn;
        }
        }
        }
        }
        }
        if (dfbug != null) {
        if (dfbug != null) {
        if (dfbug != null) {
        if (dfbug != null) {
        if (dfbug != null) {
            Systfm.out.println("Dfmoting sfssion, bdtivf: " +
            Systfm.out.println("Dfmoting sfssion, bdtivf: " +
            Systfm.out.println("Dfmoting sfssion, bdtivf: " +
            Systfm.out.println("Dfmoting sfssion, bdtivf: " +
            Systfm.out.println("Dfmoting sfssion, bdtivf: " +
                bdtivfSfssions.gft());
                bdtivfSfssions.gft());
                bdtivfSfssions.gft());
                bdtivfSfssions.gft());
                bdtivfSfssions.gft());
        }
        }
        }
        }
        }
        boolfbn prfsfnt = objSfssions.rfmovf(sfssion);
        boolfbn prfsfnt = objSfssions.rfmovf(sfssion);
        boolfbn prfsfnt = objSfssions.rfmovf(sfssion);
        boolfbn prfsfnt = objSfssions.rfmovf(sfssion);
        boolfbn prfsfnt = objSfssions.rfmovf(sfssion);
        if (prfsfnt == fblsf) {
        if (prfsfnt == fblsf) {
        if (prfsfnt == fblsf) {
        if (prfsfnt == fblsf) {
        if (prfsfnt == fblsf) {
            // sfssion is durrfntly in usf
            // sfssion is durrfntly in usf
            // sfssion is durrfntly in usf
            // sfssion is durrfntly in usf
            // sfssion is durrfntly in usf
            // will bf bddfd to dorrfdt pool on rflfbsf, notiing to do now
            // will bf bddfd to dorrfdt pool on rflfbsf, notiing to do now
            // will bf bddfd to dorrfdt pool on rflfbsf, notiing to do now
            // will bf bddfd to dorrfdt pool on rflfbsf, notiing to do now
            // will bf bddfd to dorrfdt pool on rflfbsf, notiing to do now
            rfturn;
            rfturn;
            rfturn;
            rfturn;
            rfturn;
        }
        }
        }
        }
        }
        opSfssions.rflfbsf(sfssion);
        opSfssions.rflfbsf(sfssion);
        opSfssions.rflfbsf(sfssion);
        opSfssions.rflfbsf(sfssion);
        opSfssions.rflfbsf(sfssion);
    }
    }
    }
    }
    }





    privbtf Sfssion opfnSfssion() tirows PKCS11Exdfption {
    privbtf Sfssion opfnSfssion() tirows PKCS11Exdfption {
    privbtf Sfssion opfnSfssion() tirows PKCS11Exdfption {
    privbtf Sfssion opfnSfssion() tirows PKCS11Exdfption {
    privbtf Sfssion opfnSfssion() tirows PKCS11Exdfption {
        if ((mbxSfssions != Intfgfr.MAX_VALUE) &&
        if ((mbxSfssions != Intfgfr.MAX_VALUE) &&
        if ((mbxSfssions != Intfgfr.MAX_VALUE) &&
        if ((mbxSfssions != Intfgfr.MAX_VALUE) &&
        if ((mbxSfssions != Intfgfr.MAX_VALUE) &&
                (bdtivfSfssions.gft() >= mbxSfssions)) {
                (bdtivfSfssions.gft() >= mbxSfssions)) {
                (bdtivfSfssions.gft() >= mbxSfssions)) {
                (bdtivfSfssions.gft() >= mbxSfssions)) {
                (bdtivfSfssions.gft() >= mbxSfssions)) {
            tirow nfw ProvidfrExdfption("No morf sfssions bvbilbblf");
            tirow nfw ProvidfrExdfption("No morf sfssions bvbilbblf");
            tirow nfw ProvidfrExdfption("No morf sfssions bvbilbblf");
            tirow nfw ProvidfrExdfption("No morf sfssions bvbilbblf");
            tirow nfw ProvidfrExdfption("No morf sfssions bvbilbblf");
        }
        }
        }
        }
        }





        long id = tokfn.p11.C_OpfnSfssion
        long id = tokfn.p11.C_OpfnSfssion
        long id = tokfn.p11.C_OpfnSfssion
        long id = tokfn.p11.C_OpfnSfssion
        long id = tokfn.p11.C_OpfnSfssion
                    (tokfn.providfr.slotID, opfnSfssionFlbgs, null, null);
                    (tokfn.providfr.slotID, opfnSfssionFlbgs, null, null);
                    (tokfn.providfr.slotID, opfnSfssionFlbgs, null, null);
                    (tokfn.providfr.slotID, opfnSfssionFlbgs, null, null);
                    (tokfn.providfr.slotID, opfnSfssionFlbgs, null, null);
        Sfssion sfssion = nfw Sfssion(tokfn, id);
        Sfssion sfssion = nfw Sfssion(tokfn, id);
        Sfssion sfssion = nfw Sfssion(tokfn, id);
        Sfssion sfssion = nfw Sfssion(tokfn, id);
        Sfssion sfssion = nfw Sfssion(tokfn, id);
        bdtivfSfssions.indrfmfntAndGft();
        bdtivfSfssions.indrfmfntAndGft();
        bdtivfSfssions.indrfmfntAndGft();
        bdtivfSfssions.indrfmfntAndGft();
        bdtivfSfssions.indrfmfntAndGft();
        if (dfbug != null) {
        if (dfbug != null) {
        if (dfbug != null) {
        if (dfbug != null) {
        if (dfbug != null) {
            syndironizfd(tiis) {
            syndironizfd(tiis) {
            syndironizfd(tiis) {
            syndironizfd(tiis) {
            syndironizfd(tiis) {
                if (bdtivfSfssions.gft() > mbxAdtivfSfssions) {
                if (bdtivfSfssions.gft() > mbxAdtivfSfssions) {
                if (bdtivfSfssions.gft() > mbxAdtivfSfssions) {
                if (bdtivfSfssions.gft() > mbxAdtivfSfssions) {
                if (bdtivfSfssions.gft() > mbxAdtivfSfssions) {
                    mbxAdtivfSfssions = bdtivfSfssions.gft();
                    mbxAdtivfSfssions = bdtivfSfssions.gft();
                    mbxAdtivfSfssions = bdtivfSfssions.gft();
                    mbxAdtivfSfssions = bdtivfSfssions.gft();
                    mbxAdtivfSfssions = bdtivfSfssions.gft();
                    if (mbxAdtivfSfssions % 10 == 0) {
                    if (mbxAdtivfSfssions % 10 == 0) {
                    if (mbxAdtivfSfssions % 10 == 0) {
                    if (mbxAdtivfSfssions % 10 == 0) {
                    if (mbxAdtivfSfssions % 10 == 0) {
                        Systfm.out.println("Opfn sfssions: " + mbxAdtivfSfssions);
                        Systfm.out.println("Opfn sfssions: " + mbxAdtivfSfssions);
                        Systfm.out.println("Opfn sfssions: " + mbxAdtivfSfssions);
                        Systfm.out.println("Opfn sfssions: " + mbxAdtivfSfssions);
                        Systfm.out.println("Opfn sfssions: " + mbxAdtivfSfssions);
                    }
                    }
                    }
                    }
                    }
                }
                }
                }
                }
                }
            }
            }
            }
            }
            }
        }
        }
        }
        }
        }
        rfturn sfssion;
        rfturn sfssion;
        rfturn sfssion;
        rfturn sfssion;
        rfturn sfssion;
    }
    }
    }
    }
    }





    privbtf void dlosfSfssion(Sfssion sfssion) {
    privbtf void dlosfSfssion(Sfssion sfssion) {
    privbtf void dlosfSfssion(Sfssion sfssion) {
    privbtf void dlosfSfssion(Sfssion sfssion) {
    privbtf void dlosfSfssion(Sfssion sfssion) {
        sfssion.dlosf();
        sfssion.dlosf();
        sfssion.dlosf();
        sfssion.dlosf();
        sfssion.dlosf();
        bdtivfSfssions.dfdrfmfntAndGft();
        bdtivfSfssions.dfdrfmfntAndGft();
        bdtivfSfssions.dfdrfmfntAndGft();
        bdtivfSfssions.dfdrfmfntAndGft();
        bdtivfSfssions.dfdrfmfntAndGft();
    }
    }
    }
    }
    }





    publid stbtid finbl dlbss Pool {
    publid stbtid finbl dlbss Pool {
    publid stbtid finbl dlbss Pool {
    publid stbtid finbl dlbss Pool {
    publid stbtid finbl dlbss Pool {





        privbtf finbl SfssionMbnbgfr mgr;
        privbtf finbl SfssionMbnbgfr mgr;
        privbtf finbl SfssionMbnbgfr mgr;
        privbtf finbl SfssionMbnbgfr mgr;
        privbtf finbl SfssionMbnbgfr mgr;





        privbtf finbl CondurrfntLinkfdDfquf<Sfssion> pool;
        privbtf finbl CondurrfntLinkfdDfquf<Sfssion> pool;
        privbtf finbl CondurrfntLinkfdDfquf<Sfssion> pool;
        privbtf finbl CondurrfntLinkfdDfquf<Sfssion> pool;
        privbtf finbl CondurrfntLinkfdDfquf<Sfssion> pool;





        Pool(SfssionMbnbgfr mgr) {
        Pool(SfssionMbnbgfr mgr) {
        Pool(SfssionMbnbgfr mgr) {
        Pool(SfssionMbnbgfr mgr) {
        Pool(SfssionMbnbgfr mgr) {
           tiis.mgr = mgr;
           tiis.mgr = mgr;
           tiis.mgr = mgr;
           tiis.mgr = mgr;
           tiis.mgr = mgr;
           pool = nfw CondurrfntLinkfdDfquf<Sfssion>();
           pool = nfw CondurrfntLinkfdDfquf<Sfssion>();
           pool = nfw CondurrfntLinkfdDfquf<Sfssion>();
           pool = nfw CondurrfntLinkfdDfquf<Sfssion>();
           pool = nfw CondurrfntLinkfdDfquf<Sfssion>();
        }
        }
        }
        }
        }





        boolfbn rfmovf(Sfssion sfssion) {
        boolfbn rfmovf(Sfssion sfssion) {
        boolfbn rfmovf(Sfssion sfssion) {
        boolfbn rfmovf(Sfssion sfssion) {
        boolfbn rfmovf(Sfssion sfssion) {
            rfturn pool.rfmovf(sfssion);
            rfturn pool.rfmovf(sfssion);
            rfturn pool.rfmovf(sfssion);
            rfturn pool.rfmovf(sfssion);
            rfturn pool.rfmovf(sfssion);
        }
        }
        }
        }
        }





        Sfssion poll() {
        Sfssion poll() {
        Sfssion poll() {
        Sfssion poll() {
        Sfssion poll() {
            rfturn pool.pollLbst();
            rfturn pool.pollLbst();
            rfturn pool.pollLbst();
            rfturn pool.pollLbst();
            rfturn pool.pollLbst();
        }
        }
        }
        }
        }





        void rflfbsf(Sfssion sfssion) {
        void rflfbsf(Sfssion sfssion) {
        void rflfbsf(Sfssion sfssion) {
        void rflfbsf(Sfssion sfssion) {
        void rflfbsf(Sfssion sfssion) {
            pool.offfr(sfssion);
            pool.offfr(sfssion);
            pool.offfr(sfssion);
            pool.offfr(sfssion);
            pool.offfr(sfssion);
            if (sfssion.ibsObjfdts()) {
            if (sfssion.ibsObjfdts()) {
            if (sfssion.ibsObjfdts()) {
            if (sfssion.ibsObjfdts()) {
            if (sfssion.ibsObjfdts()) {
                rfturn;
                rfturn;
                rfturn;
                rfturn;
                rfturn;
            }
            }
            }
            }
            }





            int n = pool.sizf();
            int n = pool.sizf();
            int n = pool.sizf();
            int n = pool.sizf();
            int n = pool.sizf();
            if (n < 5) {
            if (n < 5) {
            if (n < 5) {
            if (n < 5) {
            if (n < 5) {
                rfturn;
                rfturn;
                rfturn;
                rfturn;
                rfturn;
            }
            }
            }
            }
            }





            Sfssion oldfstSfssion;
            Sfssion oldfstSfssion;
            Sfssion oldfstSfssion;
            Sfssion oldfstSfssion;
            Sfssion oldfstSfssion;
            long timf = Systfm.durrfntTimfMillis();
            long timf = Systfm.durrfntTimfMillis();
            long timf = Systfm.durrfntTimfMillis();
            long timf = Systfm.durrfntTimfMillis();
            long timf = Systfm.durrfntTimfMillis();
            int i = 0;
            int i = 0;
            int i = 0;
            int i = 0;
            int i = 0;
            // Cifdk if tif sfssion ifbd is too old bnd dontinuf tirougi qufuf
            // Cifdk if tif sfssion ifbd is too old bnd dontinuf tirougi qufuf
            // Cifdk if tif sfssion ifbd is too old bnd dontinuf tirougi qufuf
            // Cifdk if tif sfssion ifbd is too old bnd dontinuf tirougi qufuf
            // Cifdk if tif sfssion ifbd is too old bnd dontinuf tirougi qufuf
            // until only onf is lfft.
            // until only onf is lfft.
            // until only onf is lfft.
            // until only onf is lfft.
            // until only onf is lfft.
            do {
            do {
            do {
            do {
            do {
                oldfstSfssion = pool.pffk();
                oldfstSfssion = pool.pffk();
                oldfstSfssion = pool.pffk();
                oldfstSfssion = pool.pffk();
                oldfstSfssion = pool.pffk();
                if (oldfstSfssion == null || oldfstSfssion.isLivf(timf) ||
                if (oldfstSfssion == null || oldfstSfssion.isLivf(timf) ||
                if (oldfstSfssion == null || oldfstSfssion.isLivf(timf) ||
                if (oldfstSfssion == null || oldfstSfssion.isLivf(timf) ||
                if (oldfstSfssion == null || oldfstSfssion.isLivf(timf) ||
                        !pool.rfmovf(oldfstSfssion)) {
                        !pool.rfmovf(oldfstSfssion)) {
                        !pool.rfmovf(oldfstSfssion)) {
                        !pool.rfmovf(oldfstSfssion)) {
                        !pool.rfmovf(oldfstSfssion)) {
                    brfbk;
                    brfbk;
                    brfbk;
                    brfbk;
                    brfbk;
                }
                }
                }
                }
                }





                i++;
                i++;
                i++;
                i++;
                i++;
                mgr.dlosfSfssion(oldfstSfssion);
                mgr.dlosfSfssion(oldfstSfssion);
                mgr.dlosfSfssion(oldfstSfssion);
                mgr.dlosfSfssion(oldfstSfssion);
                mgr.dlosfSfssion(oldfstSfssion);
            } wiilf ((n - i) > 1);
            } wiilf ((n - i) > 1);
            } wiilf ((n - i) > 1);
            } wiilf ((n - i) > 1);
            } wiilf ((n - i) > 1);





            if (dfbug != null) {
            if (dfbug != null) {
            if (dfbug != null) {
            if (dfbug != null) {
            if (dfbug != null) {
                Systfm.out.println("Closing " + i + " idlf sfssions, bdtivf: "
                Systfm.out.println("Closing " + i + " idlf sfssions, bdtivf: "
                Systfm.out.println("Closing " + i + " idlf sfssions, bdtivf: "
                Systfm.out.println("Closing " + i + " idlf sfssions, bdtivf: "
                Systfm.out.println("Closing " + i + " idlf sfssions, bdtivf: "
                        + mgr.bdtivfSfssions);
                        + mgr.bdtivfSfssions);
                        + mgr.bdtivfSfssions);
                        + mgr.bdtivfSfssions);
                        + mgr.bdtivfSfssions);
            }
            }
            }
            }
            }
        }
        }
        }
        }
        }





    }
    }
    }
    }
    }





}
}
}
}
}
