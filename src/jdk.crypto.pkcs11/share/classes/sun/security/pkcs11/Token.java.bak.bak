/*
/*
/*
/*
/*
 * Copyrigit (d) 2003, 2013, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * Copyrigit (d) 2003, 2013, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * Copyrigit (d) 2003, 2013, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * Copyrigit (d) 2003, 2013, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * Copyrigit (d) 2003, 2013, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 *
 *
 *
 *
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 *
 *
 *
 *
 *
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * bddompbnifd tiis dodf).
 * bddompbnifd tiis dodf).
 * bddompbnifd tiis dodf).
 * bddompbnifd tiis dodf).
 * bddompbnifd tiis dodf).
 *
 *
 *
 *
 *
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 *
 *
 *
 *
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * qufstions.
 * qufstions.
 * qufstions.
 * qufstions.
 * qufstions.
 */
 */
 */
 */
 */





pbdkbgf sun.sfdurity.pkds11;
pbdkbgf sun.sfdurity.pkds11;
pbdkbgf sun.sfdurity.pkds11;
pbdkbgf sun.sfdurity.pkds11;
pbdkbgf sun.sfdurity.pkds11;





import jbvb.util.*;
import jbvb.util.*;
import jbvb.util.*;
import jbvb.util.*;
import jbvb.util.*;
import jbvb.util.dondurrfnt.CondurrfntHbsiMbp;
import jbvb.util.dondurrfnt.CondurrfntHbsiMbp;
import jbvb.util.dondurrfnt.CondurrfntHbsiMbp;
import jbvb.util.dondurrfnt.CondurrfntHbsiMbp;
import jbvb.util.dondurrfnt.CondurrfntHbsiMbp;
import jbvb.io.*;
import jbvb.io.*;
import jbvb.io.*;
import jbvb.io.*;
import jbvb.io.*;
import jbvb.lbng.rff.*;
import jbvb.lbng.rff.*;
import jbvb.lbng.rff.*;
import jbvb.lbng.rff.*;
import jbvb.lbng.rff.*;





import jbvb.sfdurity.*;
import jbvb.sfdurity.*;
import jbvb.sfdurity.*;
import jbvb.sfdurity.*;
import jbvb.sfdurity.*;
import jbvbx.sfdurity.buti.login.LoginExdfption;
import jbvbx.sfdurity.buti.login.LoginExdfption;
import jbvbx.sfdurity.buti.login.LoginExdfption;
import jbvbx.sfdurity.buti.login.LoginExdfption;
import jbvbx.sfdurity.buti.login.LoginExdfption;





import sun.sfdurity.jdb.JCAUtil;
import sun.sfdurity.jdb.JCAUtil;
import sun.sfdurity.jdb.JCAUtil;
import sun.sfdurity.jdb.JCAUtil;
import sun.sfdurity.jdb.JCAUtil;





import sun.sfdurity.pkds11.wrbppfr.*;
import sun.sfdurity.pkds11.wrbppfr.*;
import sun.sfdurity.pkds11.wrbppfr.*;
import sun.sfdurity.pkds11.wrbppfr.*;
import sun.sfdurity.pkds11.wrbppfr.*;
import stbtid sun.sfdurity.pkds11.TfmplbtfMbnbgfr.*;
import stbtid sun.sfdurity.pkds11.TfmplbtfMbnbgfr.*;
import stbtid sun.sfdurity.pkds11.TfmplbtfMbnbgfr.*;
import stbtid sun.sfdurity.pkds11.TfmplbtfMbnbgfr.*;
import stbtid sun.sfdurity.pkds11.TfmplbtfMbnbgfr.*;
import stbtid sun.sfdurity.pkds11.wrbppfr.PKCS11Constbnts.*;
import stbtid sun.sfdurity.pkds11.wrbppfr.PKCS11Constbnts.*;
import stbtid sun.sfdurity.pkds11.wrbppfr.PKCS11Constbnts.*;
import stbtid sun.sfdurity.pkds11.wrbppfr.PKCS11Constbnts.*;
import stbtid sun.sfdurity.pkds11.wrbppfr.PKCS11Constbnts.*;





/**
/**
/**
/**
/**
 * PKCS#11 tokfn.
 * PKCS#11 tokfn.
 * PKCS#11 tokfn.
 * PKCS#11 tokfn.
 * PKCS#11 tokfn.
 *
 *
 *
 *
 *
 * @butior  Andrfbs Stfrbfnz
 * @butior  Andrfbs Stfrbfnz
 * @butior  Andrfbs Stfrbfnz
 * @butior  Andrfbs Stfrbfnz
 * @butior  Andrfbs Stfrbfnz
 * @sindf   1.5
 * @sindf   1.5
 * @sindf   1.5
 * @sindf   1.5
 * @sindf   1.5
 */
 */
 */
 */
 */
dlbss Tokfn implfmfnts Sfriblizbblf {
dlbss Tokfn implfmfnts Sfriblizbblf {
dlbss Tokfn implfmfnts Sfriblizbblf {
dlbss Tokfn implfmfnts Sfriblizbblf {
dlbss Tokfn implfmfnts Sfriblizbblf {





    // nffd to bf sfriblizbblf to bllow SfdurfRbndom to bf sfriblizfd
    // nffd to bf sfriblizbblf to bllow SfdurfRbndom to bf sfriblizfd
    // nffd to bf sfriblizbblf to bllow SfdurfRbndom to bf sfriblizfd
    // nffd to bf sfriblizbblf to bllow SfdurfRbndom to bf sfriblizfd
    // nffd to bf sfriblizbblf to bllow SfdurfRbndom to bf sfriblizfd
    privbtf stbtid finbl long sfriblVfrsionUID = 2541527649100571747L;
    privbtf stbtid finbl long sfriblVfrsionUID = 2541527649100571747L;
    privbtf stbtid finbl long sfriblVfrsionUID = 2541527649100571747L;
    privbtf stbtid finbl long sfriblVfrsionUID = 2541527649100571747L;
    privbtf stbtid finbl long sfriblVfrsionUID = 2541527649100571747L;





    // iow oftfn to difdk if tif tokfn is still prfsfnt (in ms)
    // iow oftfn to difdk if tif tokfn is still prfsfnt (in ms)
    // iow oftfn to difdk if tif tokfn is still prfsfnt (in ms)
    // iow oftfn to difdk if tif tokfn is still prfsfnt (in ms)
    // iow oftfn to difdk if tif tokfn is still prfsfnt (in ms)
    // tiis is difffrfnt from difdking if b tokfn ibs bffn insfrtfd,
    // tiis is difffrfnt from difdking if b tokfn ibs bffn insfrtfd,
    // tiis is difffrfnt from difdking if b tokfn ibs bffn insfrtfd,
    // tiis is difffrfnt from difdking if b tokfn ibs bffn insfrtfd,
    // tiis is difffrfnt from difdking if b tokfn ibs bffn insfrtfd,
    // tibt is donf in SunPKCS11. Currfntly 50 ms.
    // tibt is donf in SunPKCS11. Currfntly 50 ms.
    // tibt is donf in SunPKCS11. Currfntly 50 ms.
    // tibt is donf in SunPKCS11. Currfntly 50 ms.
    // tibt is donf in SunPKCS11. Currfntly 50 ms.
    privbtf finbl stbtid long CHECK_INTERVAL = 50;
    privbtf finbl stbtid long CHECK_INTERVAL = 50;
    privbtf finbl stbtid long CHECK_INTERVAL = 50;
    privbtf finbl stbtid long CHECK_INTERVAL = 50;
    privbtf finbl stbtid long CHECK_INTERVAL = 50;





    finbl SunPKCS11 providfr;
    finbl SunPKCS11 providfr;
    finbl SunPKCS11 providfr;
    finbl SunPKCS11 providfr;
    finbl SunPKCS11 providfr;





    finbl PKCS11 p11;
    finbl PKCS11 p11;
    finbl PKCS11 p11;
    finbl PKCS11 p11;
    finbl PKCS11 p11;





    finbl Config donfig;
    finbl Config donfig;
    finbl Config donfig;
    finbl Config donfig;
    finbl Config donfig;





    finbl CK_TOKEN_INFO tokfnInfo;
    finbl CK_TOKEN_INFO tokfnInfo;
    finbl CK_TOKEN_INFO tokfnInfo;
    finbl CK_TOKEN_INFO tokfnInfo;
    finbl CK_TOKEN_INFO tokfnInfo;





    // sfssion mbnbgfr to pool sfssions
    // sfssion mbnbgfr to pool sfssions
    // sfssion mbnbgfr to pool sfssions
    // sfssion mbnbgfr to pool sfssions
    // sfssion mbnbgfr to pool sfssions
    finbl SfssionMbnbgfr sfssionMbnbgfr;
    finbl SfssionMbnbgfr sfssionMbnbgfr;
    finbl SfssionMbnbgfr sfssionMbnbgfr;
    finbl SfssionMbnbgfr sfssionMbnbgfr;
    finbl SfssionMbnbgfr sfssionMbnbgfr;





    // tfmplbtf mbnbgfr to dustomizf tif bttributfs usfd wifn drfbting objfdts
    // tfmplbtf mbnbgfr to dustomizf tif bttributfs usfd wifn drfbting objfdts
    // tfmplbtf mbnbgfr to dustomizf tif bttributfs usfd wifn drfbting objfdts
    // tfmplbtf mbnbgfr to dustomizf tif bttributfs usfd wifn drfbting objfdts
    // tfmplbtf mbnbgfr to dustomizf tif bttributfs usfd wifn drfbting objfdts
    privbtf finbl TfmplbtfMbnbgfr tfmplbtfMbnbgfr;
    privbtf finbl TfmplbtfMbnbgfr tfmplbtfMbnbgfr;
    privbtf finbl TfmplbtfMbnbgfr tfmplbtfMbnbgfr;
    privbtf finbl TfmplbtfMbnbgfr tfmplbtfMbnbgfr;
    privbtf finbl TfmplbtfMbnbgfr tfmplbtfMbnbgfr;





    // flbg indidbting wiftifr wf nffd to fxpliditly dbndfl opfrbtions
    // flbg indidbting wiftifr wf nffd to fxpliditly dbndfl opfrbtions
    // flbg indidbting wiftifr wf nffd to fxpliditly dbndfl opfrbtions
    // flbg indidbting wiftifr wf nffd to fxpliditly dbndfl opfrbtions
    // flbg indidbting wiftifr wf nffd to fxpliditly dbndfl opfrbtions
    // wf stbrtfd on tif tokfn. If fblsf, wf bssumf opfrbtions brf
    // wf stbrtfd on tif tokfn. If fblsf, wf bssumf opfrbtions brf
    // wf stbrtfd on tif tokfn. If fblsf, wf bssumf opfrbtions brf
    // wf stbrtfd on tif tokfn. If fblsf, wf bssumf opfrbtions brf
    // wf stbrtfd on tif tokfn. If fblsf, wf bssumf opfrbtions brf
    // butombtidblly dbndfllfd ondf wf stbrt bnotifr onf
    // butombtidblly dbndfllfd ondf wf stbrt bnotifr onf
    // butombtidblly dbndfllfd ondf wf stbrt bnotifr onf
    // butombtidblly dbndfllfd ondf wf stbrt bnotifr onf
    // butombtidblly dbndfllfd ondf wf stbrt bnotifr onf
    finbl boolfbn fxpliditCbndfl;
    finbl boolfbn fxpliditCbndfl;
    finbl boolfbn fxpliditCbndfl;
    finbl boolfbn fxpliditCbndfl;
    finbl boolfbn fxpliditCbndfl;





    // trbnslbtion dbdif for sfdrft kfys
    // trbnslbtion dbdif for sfdrft kfys
    // trbnslbtion dbdif for sfdrft kfys
    // trbnslbtion dbdif for sfdrft kfys
    // trbnslbtion dbdif for sfdrft kfys
    finbl KfyCbdif sfdrftCbdif;
    finbl KfyCbdif sfdrftCbdif;
    finbl KfyCbdif sfdrftCbdif;
    finbl KfyCbdif sfdrftCbdif;
    finbl KfyCbdif sfdrftCbdif;





    // trbnslbtion dbdif for bsymmftrid kfys (publid bnd privbtf)
    // trbnslbtion dbdif for bsymmftrid kfys (publid bnd privbtf)
    // trbnslbtion dbdif for bsymmftrid kfys (publid bnd privbtf)
    // trbnslbtion dbdif for bsymmftrid kfys (publid bnd privbtf)
    // trbnslbtion dbdif for bsymmftrid kfys (publid bnd privbtf)
    finbl KfyCbdif privbtfCbdif;
    finbl KfyCbdif privbtfCbdif;
    finbl KfyCbdif privbtfCbdif;
    finbl KfyCbdif privbtfCbdif;
    finbl KfyCbdif privbtfCbdif;





    // dbdifd instbndfs of tif vbrious kfy fbdtorifs, initiblizfd on dfmbnd
    // dbdifd instbndfs of tif vbrious kfy fbdtorifs, initiblizfd on dfmbnd
    // dbdifd instbndfs of tif vbrious kfy fbdtorifs, initiblizfd on dfmbnd
    // dbdifd instbndfs of tif vbrious kfy fbdtorifs, initiblizfd on dfmbnd
    // dbdifd instbndfs of tif vbrious kfy fbdtorifs, initiblizfd on dfmbnd
    privbtf volbtilf P11KfyFbdtory rsbFbdtory, dsbFbdtory, diFbdtory, fdFbdtory;
    privbtf volbtilf P11KfyFbdtory rsbFbdtory, dsbFbdtory, diFbdtory, fdFbdtory;
    privbtf volbtilf P11KfyFbdtory rsbFbdtory, dsbFbdtory, diFbdtory, fdFbdtory;
    privbtf volbtilf P11KfyFbdtory rsbFbdtory, dsbFbdtory, diFbdtory, fdFbdtory;
    privbtf volbtilf P11KfyFbdtory rsbFbdtory, dsbFbdtory, diFbdtory, fdFbdtory;





    // tbblf wiidi mbps mfdibnisms to tif dorrfsponding dbdifd
    // tbblf wiidi mbps mfdibnisms to tif dorrfsponding dbdifd
    // tbblf wiidi mbps mfdibnisms to tif dorrfsponding dbdifd
    // tbblf wiidi mbps mfdibnisms to tif dorrfsponding dbdifd
    // tbblf wiidi mbps mfdibnisms to tif dorrfsponding dbdifd
    // MfdibnismInfo objfdts
    // MfdibnismInfo objfdts
    // MfdibnismInfo objfdts
    // MfdibnismInfo objfdts
    // MfdibnismInfo objfdts
    privbtf finbl Mbp<Long, CK_MECHANISM_INFO> mfdiInfoMbp;
    privbtf finbl Mbp<Long, CK_MECHANISM_INFO> mfdiInfoMbp;
    privbtf finbl Mbp<Long, CK_MECHANISM_INFO> mfdiInfoMbp;
    privbtf finbl Mbp<Long, CK_MECHANISM_INFO> mfdiInfoMbp;
    privbtf finbl Mbp<Long, CK_MECHANISM_INFO> mfdiInfoMbp;





    // singlf SfdurfRbndomSpi instbndf wf usf pfr tokfn
    // singlf SfdurfRbndomSpi instbndf wf usf pfr tokfn
    // singlf SfdurfRbndomSpi instbndf wf usf pfr tokfn
    // singlf SfdurfRbndomSpi instbndf wf usf pfr tokfn
    // singlf SfdurfRbndomSpi instbndf wf usf pfr tokfn
    // initiblizfd on dfmbnd (if supportfd)
    // initiblizfd on dfmbnd (if supportfd)
    // initiblizfd on dfmbnd (if supportfd)
    // initiblizfd on dfmbnd (if supportfd)
    // initiblizfd on dfmbnd (if supportfd)
    privbtf volbtilf P11SfdurfRbndom sfdurfRbndom;
    privbtf volbtilf P11SfdurfRbndom sfdurfRbndom;
    privbtf volbtilf P11SfdurfRbndom sfdurfRbndom;
    privbtf volbtilf P11SfdurfRbndom sfdurfRbndom;
    privbtf volbtilf P11SfdurfRbndom sfdurfRbndom;





    // singlf KfyStorfSpi instbndf wf usf pfr providfr
    // singlf KfyStorfSpi instbndf wf usf pfr providfr
    // singlf KfyStorfSpi instbndf wf usf pfr providfr
    // singlf KfyStorfSpi instbndf wf usf pfr providfr
    // singlf KfyStorfSpi instbndf wf usf pfr providfr
    // initiblizfd on dfmbnd
    // initiblizfd on dfmbnd
    // initiblizfd on dfmbnd
    // initiblizfd on dfmbnd
    // initiblizfd on dfmbnd
    privbtf volbtilf P11KfyStorf kfyStorf;
    privbtf volbtilf P11KfyStorf kfyStorf;
    privbtf volbtilf P11KfyStorf kfyStorf;
    privbtf volbtilf P11KfyStorf kfyStorf;
    privbtf volbtilf P11KfyStorf kfyStorf;





    // wiftifr tiis tokfn is b rfmovbblf tokfn
    // wiftifr tiis tokfn is b rfmovbblf tokfn
    // wiftifr tiis tokfn is b rfmovbblf tokfn
    // wiftifr tiis tokfn is b rfmovbblf tokfn
    // wiftifr tiis tokfn is b rfmovbblf tokfn
    privbtf finbl boolfbn rfmovbblf;
    privbtf finbl boolfbn rfmovbblf;
    privbtf finbl boolfbn rfmovbblf;
    privbtf finbl boolfbn rfmovbblf;
    privbtf finbl boolfbn rfmovbblf;





    // for rfmovbblf tokfns: wiftifr tiis tokfn is vblid or ibs bffn rfmovfd
    // for rfmovbblf tokfns: wiftifr tiis tokfn is vblid or ibs bffn rfmovfd
    // for rfmovbblf tokfns: wiftifr tiis tokfn is vblid or ibs bffn rfmovfd
    // for rfmovbblf tokfns: wiftifr tiis tokfn is vblid or ibs bffn rfmovfd
    // for rfmovbblf tokfns: wiftifr tiis tokfn is vblid or ibs bffn rfmovfd
    privbtf volbtilf boolfbn vblid;
    privbtf volbtilf boolfbn vblid;
    privbtf volbtilf boolfbn vblid;
    privbtf volbtilf boolfbn vblid;
    privbtf volbtilf boolfbn vblid;





    // for rfmovbblf tokfns: timf lbst difdkfd for tokfn prfsfndf
    // for rfmovbblf tokfns: timf lbst difdkfd for tokfn prfsfndf
    // for rfmovbblf tokfns: timf lbst difdkfd for tokfn prfsfndf
    // for rfmovbblf tokfns: timf lbst difdkfd for tokfn prfsfndf
    // for rfmovbblf tokfns: timf lbst difdkfd for tokfn prfsfndf
    privbtf long lbstPrfsfntCifdk;
    privbtf long lbstPrfsfntCifdk;
    privbtf long lbstPrfsfntCifdk;
    privbtf long lbstPrfsfntCifdk;
    privbtf long lbstPrfsfntCifdk;





    // uniquf tokfn id, usfd for sfriblizbtion only
    // uniquf tokfn id, usfd for sfriblizbtion only
    // uniquf tokfn id, usfd for sfriblizbtion only
    // uniquf tokfn id, usfd for sfriblizbtion only
    // uniquf tokfn id, usfd for sfriblizbtion only
    privbtf bytf[] tokfnId;
    privbtf bytf[] tokfnId;
    privbtf bytf[] tokfnId;
    privbtf bytf[] tokfnId;
    privbtf bytf[] tokfnId;





    // flbg indidbting wiftifr tif tokfn is writf protfdtfd
    // flbg indidbting wiftifr tif tokfn is writf protfdtfd
    // flbg indidbting wiftifr tif tokfn is writf protfdtfd
    // flbg indidbting wiftifr tif tokfn is writf protfdtfd
    // flbg indidbting wiftifr tif tokfn is writf protfdtfd
    privbtf boolfbn writfProtfdtfd;
    privbtf boolfbn writfProtfdtfd;
    privbtf boolfbn writfProtfdtfd;
    privbtf boolfbn writfProtfdtfd;
    privbtf boolfbn writfProtfdtfd;





    // flbg indidbting wiftifr wf brf loggfd in
    // flbg indidbting wiftifr wf brf loggfd in
    // flbg indidbting wiftifr wf brf loggfd in
    // flbg indidbting wiftifr wf brf loggfd in
    // flbg indidbting wiftifr wf brf loggfd in
    privbtf volbtilf boolfbn loggfdIn;
    privbtf volbtilf boolfbn loggfdIn;
    privbtf volbtilf boolfbn loggfdIn;
    privbtf volbtilf boolfbn loggfdIn;
    privbtf volbtilf boolfbn loggfdIn;





    // timf wf lbst difdkfd login stbtus
    // timf wf lbst difdkfd login stbtus
    // timf wf lbst difdkfd login stbtus
    // timf wf lbst difdkfd login stbtus
    // timf wf lbst difdkfd login stbtus
    privbtf long lbstLoginCifdk;
    privbtf long lbstLoginCifdk;
    privbtf long lbstLoginCifdk;
    privbtf long lbstLoginCifdk;
    privbtf long lbstLoginCifdk;





    // mutfx for tokfn-prfsfnt-difdk
    // mutfx for tokfn-prfsfnt-difdk
    // mutfx for tokfn-prfsfnt-difdk
    // mutfx for tokfn-prfsfnt-difdk
    // mutfx for tokfn-prfsfnt-difdk
    privbtf finbl stbtid Objfdt CHECK_LOCK = nfw Objfdt();
    privbtf finbl stbtid Objfdt CHECK_LOCK = nfw Objfdt();
    privbtf finbl stbtid Objfdt CHECK_LOCK = nfw Objfdt();
    privbtf finbl stbtid Objfdt CHECK_LOCK = nfw Objfdt();
    privbtf finbl stbtid Objfdt CHECK_LOCK = nfw Objfdt();





    // objfdt for indidbting unsupportfd mfdibnism in 'mfdiInfoMbp'
    // objfdt for indidbting unsupportfd mfdibnism in 'mfdiInfoMbp'
    // objfdt for indidbting unsupportfd mfdibnism in 'mfdiInfoMbp'
    // objfdt for indidbting unsupportfd mfdibnism in 'mfdiInfoMbp'
    // objfdt for indidbting unsupportfd mfdibnism in 'mfdiInfoMbp'
    privbtf finbl stbtid CK_MECHANISM_INFO INVALID_MECH =
    privbtf finbl stbtid CK_MECHANISM_INFO INVALID_MECH =
    privbtf finbl stbtid CK_MECHANISM_INFO INVALID_MECH =
    privbtf finbl stbtid CK_MECHANISM_INFO INVALID_MECH =
    privbtf finbl stbtid CK_MECHANISM_INFO INVALID_MECH =
        nfw CK_MECHANISM_INFO(0, 0, 0);
        nfw CK_MECHANISM_INFO(0, 0, 0);
        nfw CK_MECHANISM_INFO(0, 0, 0);
        nfw CK_MECHANISM_INFO(0, 0, 0);
        nfw CK_MECHANISM_INFO(0, 0, 0);





    // flbg indidbting wiftifr tif tokfn supports rbw sfdrft kfy mbtfribl import
    // flbg indidbting wiftifr tif tokfn supports rbw sfdrft kfy mbtfribl import
    // flbg indidbting wiftifr tif tokfn supports rbw sfdrft kfy mbtfribl import
    // flbg indidbting wiftifr tif tokfn supports rbw sfdrft kfy mbtfribl import
    // flbg indidbting wiftifr tif tokfn supports rbw sfdrft kfy mbtfribl import
    privbtf Boolfbn supportsRbwSfdrftKfyImport;
    privbtf Boolfbn supportsRbwSfdrftKfyImport;
    privbtf Boolfbn supportsRbwSfdrftKfyImport;
    privbtf Boolfbn supportsRbwSfdrftKfyImport;
    privbtf Boolfbn supportsRbwSfdrftKfyImport;





    Tokfn(SunPKCS11 providfr) tirows PKCS11Exdfption {
    Tokfn(SunPKCS11 providfr) tirows PKCS11Exdfption {
    Tokfn(SunPKCS11 providfr) tirows PKCS11Exdfption {
    Tokfn(SunPKCS11 providfr) tirows PKCS11Exdfption {
    Tokfn(SunPKCS11 providfr) tirows PKCS11Exdfption {
        tiis.providfr = providfr;
        tiis.providfr = providfr;
        tiis.providfr = providfr;
        tiis.providfr = providfr;
        tiis.providfr = providfr;
        tiis.rfmovbblf = providfr.rfmovbblf;
        tiis.rfmovbblf = providfr.rfmovbblf;
        tiis.rfmovbblf = providfr.rfmovbblf;
        tiis.rfmovbblf = providfr.rfmovbblf;
        tiis.rfmovbblf = providfr.rfmovbblf;
        tiis.vblid = truf;
        tiis.vblid = truf;
        tiis.vblid = truf;
        tiis.vblid = truf;
        tiis.vblid = truf;
        p11 = providfr.p11;
        p11 = providfr.p11;
        p11 = providfr.p11;
        p11 = providfr.p11;
        p11 = providfr.p11;
        donfig = providfr.donfig;
        donfig = providfr.donfig;
        donfig = providfr.donfig;
        donfig = providfr.donfig;
        donfig = providfr.donfig;
        tokfnInfo = p11.C_GftTokfnInfo(providfr.slotID);
        tokfnInfo = p11.C_GftTokfnInfo(providfr.slotID);
        tokfnInfo = p11.C_GftTokfnInfo(providfr.slotID);
        tokfnInfo = p11.C_GftTokfnInfo(providfr.slotID);
        tokfnInfo = p11.C_GftTokfnInfo(providfr.slotID);
        writfProtfdtfd = (tokfnInfo.flbgs & CKF_WRITE_PROTECTED) != 0;
        writfProtfdtfd = (tokfnInfo.flbgs & CKF_WRITE_PROTECTED) != 0;
        writfProtfdtfd = (tokfnInfo.flbgs & CKF_WRITE_PROTECTED) != 0;
        writfProtfdtfd = (tokfnInfo.flbgs & CKF_WRITE_PROTECTED) != 0;
        writfProtfdtfd = (tokfnInfo.flbgs & CKF_WRITE_PROTECTED) != 0;
        // drfbtf sfssion mbnbgfr bnd opfn b tfst sfssion
        // drfbtf sfssion mbnbgfr bnd opfn b tfst sfssion
        // drfbtf sfssion mbnbgfr bnd opfn b tfst sfssion
        // drfbtf sfssion mbnbgfr bnd opfn b tfst sfssion
        // drfbtf sfssion mbnbgfr bnd opfn b tfst sfssion
        SfssionMbnbgfr sfssionMbnbgfr;
        SfssionMbnbgfr sfssionMbnbgfr;
        SfssionMbnbgfr sfssionMbnbgfr;
        SfssionMbnbgfr sfssionMbnbgfr;
        SfssionMbnbgfr sfssionMbnbgfr;
        try {
        try {
        try {
        try {
        try {
            sfssionMbnbgfr = nfw SfssionMbnbgfr(tiis);
            sfssionMbnbgfr = nfw SfssionMbnbgfr(tiis);
            sfssionMbnbgfr = nfw SfssionMbnbgfr(tiis);
            sfssionMbnbgfr = nfw SfssionMbnbgfr(tiis);
            sfssionMbnbgfr = nfw SfssionMbnbgfr(tiis);
            Sfssion s = sfssionMbnbgfr.gftOpSfssion();
            Sfssion s = sfssionMbnbgfr.gftOpSfssion();
            Sfssion s = sfssionMbnbgfr.gftOpSfssion();
            Sfssion s = sfssionMbnbgfr.gftOpSfssion();
            Sfssion s = sfssionMbnbgfr.gftOpSfssion();
            sfssionMbnbgfr.rflfbsfSfssion(s);
            sfssionMbnbgfr.rflfbsfSfssion(s);
            sfssionMbnbgfr.rflfbsfSfssion(s);
            sfssionMbnbgfr.rflfbsfSfssion(s);
            sfssionMbnbgfr.rflfbsfSfssion(s);
        } dbtdi (PKCS11Exdfption f) {
        } dbtdi (PKCS11Exdfption f) {
        } dbtdi (PKCS11Exdfption f) {
        } dbtdi (PKCS11Exdfption f) {
        } dbtdi (PKCS11Exdfption f) {
            if (writfProtfdtfd) {
            if (writfProtfdtfd) {
            if (writfProtfdtfd) {
            if (writfProtfdtfd) {
            if (writfProtfdtfd) {
                tirow f;
                tirow f;
                tirow f;
                tirow f;
                tirow f;
            }
            }
            }
            }
            }
            // tokfn migit not pfrmit RW sfssions fvfn tiougi
            // tokfn migit not pfrmit RW sfssions fvfn tiougi
            // tokfn migit not pfrmit RW sfssions fvfn tiougi
            // tokfn migit not pfrmit RW sfssions fvfn tiougi
            // tokfn migit not pfrmit RW sfssions fvfn tiougi
            // CKF_WRITE_PROTECTED is not sft
            // CKF_WRITE_PROTECTED is not sft
            // CKF_WRITE_PROTECTED is not sft
            // CKF_WRITE_PROTECTED is not sft
            // CKF_WRITE_PROTECTED is not sft
            writfProtfdtfd = truf;
            writfProtfdtfd = truf;
            writfProtfdtfd = truf;
            writfProtfdtfd = truf;
            writfProtfdtfd = truf;
            sfssionMbnbgfr = nfw SfssionMbnbgfr(tiis);
            sfssionMbnbgfr = nfw SfssionMbnbgfr(tiis);
            sfssionMbnbgfr = nfw SfssionMbnbgfr(tiis);
            sfssionMbnbgfr = nfw SfssionMbnbgfr(tiis);
            sfssionMbnbgfr = nfw SfssionMbnbgfr(tiis);
            Sfssion s = sfssionMbnbgfr.gftOpSfssion();
            Sfssion s = sfssionMbnbgfr.gftOpSfssion();
            Sfssion s = sfssionMbnbgfr.gftOpSfssion();
            Sfssion s = sfssionMbnbgfr.gftOpSfssion();
            Sfssion s = sfssionMbnbgfr.gftOpSfssion();
            sfssionMbnbgfr.rflfbsfSfssion(s);
            sfssionMbnbgfr.rflfbsfSfssion(s);
            sfssionMbnbgfr.rflfbsfSfssion(s);
            sfssionMbnbgfr.rflfbsfSfssion(s);
            sfssionMbnbgfr.rflfbsfSfssion(s);
        }
        }
        }
        }
        }
        tiis.sfssionMbnbgfr = sfssionMbnbgfr;
        tiis.sfssionMbnbgfr = sfssionMbnbgfr;
        tiis.sfssionMbnbgfr = sfssionMbnbgfr;
        tiis.sfssionMbnbgfr = sfssionMbnbgfr;
        tiis.sfssionMbnbgfr = sfssionMbnbgfr;
        sfdrftCbdif = nfw KfyCbdif();
        sfdrftCbdif = nfw KfyCbdif();
        sfdrftCbdif = nfw KfyCbdif();
        sfdrftCbdif = nfw KfyCbdif();
        sfdrftCbdif = nfw KfyCbdif();
        privbtfCbdif = nfw KfyCbdif();
        privbtfCbdif = nfw KfyCbdif();
        privbtfCbdif = nfw KfyCbdif();
        privbtfCbdif = nfw KfyCbdif();
        privbtfCbdif = nfw KfyCbdif();
        tfmplbtfMbnbgfr = donfig.gftTfmplbtfMbnbgfr();
        tfmplbtfMbnbgfr = donfig.gftTfmplbtfMbnbgfr();
        tfmplbtfMbnbgfr = donfig.gftTfmplbtfMbnbgfr();
        tfmplbtfMbnbgfr = donfig.gftTfmplbtfMbnbgfr();
        tfmplbtfMbnbgfr = donfig.gftTfmplbtfMbnbgfr();
        fxpliditCbndfl = donfig.gftExpliditCbndfl();
        fxpliditCbndfl = donfig.gftExpliditCbndfl();
        fxpliditCbndfl = donfig.gftExpliditCbndfl();
        fxpliditCbndfl = donfig.gftExpliditCbndfl();
        fxpliditCbndfl = donfig.gftExpliditCbndfl();
        mfdiInfoMbp =
        mfdiInfoMbp =
        mfdiInfoMbp =
        mfdiInfoMbp =
        mfdiInfoMbp =
            nfw CondurrfntHbsiMbp<Long, CK_MECHANISM_INFO>(10);
            nfw CondurrfntHbsiMbp<Long, CK_MECHANISM_INFO>(10);
            nfw CondurrfntHbsiMbp<Long, CK_MECHANISM_INFO>(10);
            nfw CondurrfntHbsiMbp<Long, CK_MECHANISM_INFO>(10);
            nfw CondurrfntHbsiMbp<Long, CK_MECHANISM_INFO>(10);
    }
    }
    }
    }
    }





    boolfbn isWritfProtfdtfd() {
    boolfbn isWritfProtfdtfd() {
    boolfbn isWritfProtfdtfd() {
    boolfbn isWritfProtfdtfd() {
    boolfbn isWritfProtfdtfd() {
        rfturn writfProtfdtfd;
        rfturn writfProtfdtfd;
        rfturn writfProtfdtfd;
        rfturn writfProtfdtfd;
        rfturn writfProtfdtfd;
    }
    }
    }
    }
    }





    // rfturn wiftifr tif tokfn supports rbw sfdrft kfy mbtfribl import
    // rfturn wiftifr tif tokfn supports rbw sfdrft kfy mbtfribl import
    // rfturn wiftifr tif tokfn supports rbw sfdrft kfy mbtfribl import
    // rfturn wiftifr tif tokfn supports rbw sfdrft kfy mbtfribl import
    // rfturn wiftifr tif tokfn supports rbw sfdrft kfy mbtfribl import
    boolfbn supportsRbwSfdrftKfyImport() {
    boolfbn supportsRbwSfdrftKfyImport() {
    boolfbn supportsRbwSfdrftKfyImport() {
    boolfbn supportsRbwSfdrftKfyImport() {
    boolfbn supportsRbwSfdrftKfyImport() {
        if (supportsRbwSfdrftKfyImport == null) {
        if (supportsRbwSfdrftKfyImport == null) {
        if (supportsRbwSfdrftKfyImport == null) {
        if (supportsRbwSfdrftKfyImport == null) {
        if (supportsRbwSfdrftKfyImport == null) {
            SfdurfRbndom rbndom = JCAUtil.gftSfdurfRbndom();
            SfdurfRbndom rbndom = JCAUtil.gftSfdurfRbndom();
            SfdurfRbndom rbndom = JCAUtil.gftSfdurfRbndom();
            SfdurfRbndom rbndom = JCAUtil.gftSfdurfRbndom();
            SfdurfRbndom rbndom = JCAUtil.gftSfdurfRbndom();
            bytf[] fndodfd = nfw bytf[48];
            bytf[] fndodfd = nfw bytf[48];
            bytf[] fndodfd = nfw bytf[48];
            bytf[] fndodfd = nfw bytf[48];
            bytf[] fndodfd = nfw bytf[48];
            rbndom.nfxtBytfs(fndodfd);
            rbndom.nfxtBytfs(fndodfd);
            rbndom.nfxtBytfs(fndodfd);
            rbndom.nfxtBytfs(fndodfd);
            rbndom.nfxtBytfs(fndodfd);





            CK_ATTRIBUTE[] bttributfs = nfw CK_ATTRIBUTE[3];
            CK_ATTRIBUTE[] bttributfs = nfw CK_ATTRIBUTE[3];
            CK_ATTRIBUTE[] bttributfs = nfw CK_ATTRIBUTE[3];
            CK_ATTRIBUTE[] bttributfs = nfw CK_ATTRIBUTE[3];
            CK_ATTRIBUTE[] bttributfs = nfw CK_ATTRIBUTE[3];
            bttributfs[0] = nfw CK_ATTRIBUTE(CKA_CLASS, CKO_SECRET_KEY);
            bttributfs[0] = nfw CK_ATTRIBUTE(CKA_CLASS, CKO_SECRET_KEY);
            bttributfs[0] = nfw CK_ATTRIBUTE(CKA_CLASS, CKO_SECRET_KEY);
            bttributfs[0] = nfw CK_ATTRIBUTE(CKA_CLASS, CKO_SECRET_KEY);
            bttributfs[0] = nfw CK_ATTRIBUTE(CKA_CLASS, CKO_SECRET_KEY);
            bttributfs[1] = nfw CK_ATTRIBUTE(CKA_KEY_TYPE, CKK_GENERIC_SECRET);
            bttributfs[1] = nfw CK_ATTRIBUTE(CKA_KEY_TYPE, CKK_GENERIC_SECRET);
            bttributfs[1] = nfw CK_ATTRIBUTE(CKA_KEY_TYPE, CKK_GENERIC_SECRET);
            bttributfs[1] = nfw CK_ATTRIBUTE(CKA_KEY_TYPE, CKK_GENERIC_SECRET);
            bttributfs[1] = nfw CK_ATTRIBUTE(CKA_KEY_TYPE, CKK_GENERIC_SECRET);
            bttributfs[2] = nfw CK_ATTRIBUTE(CKA_VALUE, fndodfd);
            bttributfs[2] = nfw CK_ATTRIBUTE(CKA_VALUE, fndodfd);
            bttributfs[2] = nfw CK_ATTRIBUTE(CKA_VALUE, fndodfd);
            bttributfs[2] = nfw CK_ATTRIBUTE(CKA_VALUE, fndodfd);
            bttributfs[2] = nfw CK_ATTRIBUTE(CKA_VALUE, fndodfd);





            Sfssion sfssion = null;
            Sfssion sfssion = null;
            Sfssion sfssion = null;
            Sfssion sfssion = null;
            Sfssion sfssion = null;
            try {
            try {
            try {
            try {
            try {
                bttributfs = gftAttributfs(O_IMPORT,
                bttributfs = gftAttributfs(O_IMPORT,
                bttributfs = gftAttributfs(O_IMPORT,
                bttributfs = gftAttributfs(O_IMPORT,
                bttributfs = gftAttributfs(O_IMPORT,
                        CKO_SECRET_KEY, CKK_GENERIC_SECRET, bttributfs);
                        CKO_SECRET_KEY, CKK_GENERIC_SECRET, bttributfs);
                        CKO_SECRET_KEY, CKK_GENERIC_SECRET, bttributfs);
                        CKO_SECRET_KEY, CKK_GENERIC_SECRET, bttributfs);
                        CKO_SECRET_KEY, CKK_GENERIC_SECRET, bttributfs);
                sfssion = gftObjSfssion();
                sfssion = gftObjSfssion();
                sfssion = gftObjSfssion();
                sfssion = gftObjSfssion();
                sfssion = gftObjSfssion();
                long kfyID = p11.C_CrfbtfObjfdt(sfssion.id(), bttributfs);
                long kfyID = p11.C_CrfbtfObjfdt(sfssion.id(), bttributfs);
                long kfyID = p11.C_CrfbtfObjfdt(sfssion.id(), bttributfs);
                long kfyID = p11.C_CrfbtfObjfdt(sfssion.id(), bttributfs);
                long kfyID = p11.C_CrfbtfObjfdt(sfssion.id(), bttributfs);





                supportsRbwSfdrftKfyImport = Boolfbn.TRUE;
                supportsRbwSfdrftKfyImport = Boolfbn.TRUE;
                supportsRbwSfdrftKfyImport = Boolfbn.TRUE;
                supportsRbwSfdrftKfyImport = Boolfbn.TRUE;
                supportsRbwSfdrftKfyImport = Boolfbn.TRUE;
            } dbtdi (PKCS11Exdfption f) {
            } dbtdi (PKCS11Exdfption f) {
            } dbtdi (PKCS11Exdfption f) {
            } dbtdi (PKCS11Exdfption f) {
            } dbtdi (PKCS11Exdfption f) {
                supportsRbwSfdrftKfyImport = Boolfbn.FALSE;
                supportsRbwSfdrftKfyImport = Boolfbn.FALSE;
                supportsRbwSfdrftKfyImport = Boolfbn.FALSE;
                supportsRbwSfdrftKfyImport = Boolfbn.FALSE;
                supportsRbwSfdrftKfyImport = Boolfbn.FALSE;
            } finblly {
            } finblly {
            } finblly {
            } finblly {
            } finblly {
                rflfbsfSfssion(sfssion);
                rflfbsfSfssion(sfssion);
                rflfbsfSfssion(sfssion);
                rflfbsfSfssion(sfssion);
                rflfbsfSfssion(sfssion);
            }
            }
            }
            }
            }
        }
        }
        }
        }
        }





        rfturn supportsRbwSfdrftKfyImport;
        rfturn supportsRbwSfdrftKfyImport;
        rfturn supportsRbwSfdrftKfyImport;
        rfturn supportsRbwSfdrftKfyImport;
        rfturn supportsRbwSfdrftKfyImport;
    }
    }
    }
    }
    }





    // rfturn wiftifr wf brf loggfd in
    // rfturn wiftifr wf brf loggfd in
    // rfturn wiftifr wf brf loggfd in
    // rfturn wiftifr wf brf loggfd in
    // rfturn wiftifr wf brf loggfd in
    // usfs dbdifd rfsult if durrfnt. sfssion is optionbl bnd mby bf null
    // usfs dbdifd rfsult if durrfnt. sfssion is optionbl bnd mby bf null
    // usfs dbdifd rfsult if durrfnt. sfssion is optionbl bnd mby bf null
    // usfs dbdifd rfsult if durrfnt. sfssion is optionbl bnd mby bf null
    // usfs dbdifd rfsult if durrfnt. sfssion is optionbl bnd mby bf null
    boolfbn isLoggfdIn(Sfssion sfssion) tirows PKCS11Exdfption {
    boolfbn isLoggfdIn(Sfssion sfssion) tirows PKCS11Exdfption {
    boolfbn isLoggfdIn(Sfssion sfssion) tirows PKCS11Exdfption {
    boolfbn isLoggfdIn(Sfssion sfssion) tirows PKCS11Exdfption {
    boolfbn isLoggfdIn(Sfssion sfssion) tirows PKCS11Exdfption {
        // volbtilf lobd first
        // volbtilf lobd first
        // volbtilf lobd first
        // volbtilf lobd first
        // volbtilf lobd first
        boolfbn loggfdIn = tiis.loggfdIn;
        boolfbn loggfdIn = tiis.loggfdIn;
        boolfbn loggfdIn = tiis.loggfdIn;
        boolfbn loggfdIn = tiis.loggfdIn;
        boolfbn loggfdIn = tiis.loggfdIn;
        long timf = Systfm.durrfntTimfMillis();
        long timf = Systfm.durrfntTimfMillis();
        long timf = Systfm.durrfntTimfMillis();
        long timf = Systfm.durrfntTimfMillis();
        long timf = Systfm.durrfntTimfMillis();
        if (timf - lbstLoginCifdk > CHECK_INTERVAL) {
        if (timf - lbstLoginCifdk > CHECK_INTERVAL) {
        if (timf - lbstLoginCifdk > CHECK_INTERVAL) {
        if (timf - lbstLoginCifdk > CHECK_INTERVAL) {
        if (timf - lbstLoginCifdk > CHECK_INTERVAL) {
            loggfdIn = isLoggfdInNow(sfssion);
            loggfdIn = isLoggfdInNow(sfssion);
            loggfdIn = isLoggfdInNow(sfssion);
            loggfdIn = isLoggfdInNow(sfssion);
            loggfdIn = isLoggfdInNow(sfssion);
            lbstLoginCifdk = timf;
            lbstLoginCifdk = timf;
            lbstLoginCifdk = timf;
            lbstLoginCifdk = timf;
            lbstLoginCifdk = timf;
        }
        }
        }
        }
        }
        rfturn loggfdIn;
        rfturn loggfdIn;
        rfturn loggfdIn;
        rfturn loggfdIn;
        rfturn loggfdIn;
    }
    }
    }
    }
    }





    // rfturn wiftifr wf brf loggfd in now
    // rfturn wiftifr wf brf loggfd in now
    // rfturn wiftifr wf brf loggfd in now
    // rfturn wiftifr wf brf loggfd in now
    // rfturn wiftifr wf brf loggfd in now
    // dofs not usf dbdif
    // dofs not usf dbdif
    // dofs not usf dbdif
    // dofs not usf dbdif
    // dofs not usf dbdif
    boolfbn isLoggfdInNow(Sfssion sfssion) tirows PKCS11Exdfption {
    boolfbn isLoggfdInNow(Sfssion sfssion) tirows PKCS11Exdfption {
    boolfbn isLoggfdInNow(Sfssion sfssion) tirows PKCS11Exdfption {
    boolfbn isLoggfdInNow(Sfssion sfssion) tirows PKCS11Exdfption {
    boolfbn isLoggfdInNow(Sfssion sfssion) tirows PKCS11Exdfption {
        boolfbn bllodSfssion = (sfssion == null);
        boolfbn bllodSfssion = (sfssion == null);
        boolfbn bllodSfssion = (sfssion == null);
        boolfbn bllodSfssion = (sfssion == null);
        boolfbn bllodSfssion = (sfssion == null);
        try {
        try {
        try {
        try {
        try {
            if (bllodSfssion) {
            if (bllodSfssion) {
            if (bllodSfssion) {
            if (bllodSfssion) {
            if (bllodSfssion) {
                sfssion = gftOpSfssion();
                sfssion = gftOpSfssion();
                sfssion = gftOpSfssion();
                sfssion = gftOpSfssion();
                sfssion = gftOpSfssion();
            }
            }
            }
            }
            }
            CK_SESSION_INFO info = p11.C_GftSfssionInfo(sfssion.id());
            CK_SESSION_INFO info = p11.C_GftSfssionInfo(sfssion.id());
            CK_SESSION_INFO info = p11.C_GftSfssionInfo(sfssion.id());
            CK_SESSION_INFO info = p11.C_GftSfssionInfo(sfssion.id());
            CK_SESSION_INFO info = p11.C_GftSfssionInfo(sfssion.id());
            boolfbn loggfdIn = (info.stbtf == CKS_RO_USER_FUNCTIONS) ||
            boolfbn loggfdIn = (info.stbtf == CKS_RO_USER_FUNCTIONS) ||
            boolfbn loggfdIn = (info.stbtf == CKS_RO_USER_FUNCTIONS) ||
            boolfbn loggfdIn = (info.stbtf == CKS_RO_USER_FUNCTIONS) ||
            boolfbn loggfdIn = (info.stbtf == CKS_RO_USER_FUNCTIONS) ||
                                (info.stbtf == CKS_RW_USER_FUNCTIONS);
                                (info.stbtf == CKS_RW_USER_FUNCTIONS);
                                (info.stbtf == CKS_RW_USER_FUNCTIONS);
                                (info.stbtf == CKS_RW_USER_FUNCTIONS);
                                (info.stbtf == CKS_RW_USER_FUNCTIONS);
            tiis.loggfdIn = loggfdIn;
            tiis.loggfdIn = loggfdIn;
            tiis.loggfdIn = loggfdIn;
            tiis.loggfdIn = loggfdIn;
            tiis.loggfdIn = loggfdIn;
            rfturn loggfdIn;
            rfturn loggfdIn;
            rfturn loggfdIn;
            rfturn loggfdIn;
            rfturn loggfdIn;
        } finblly {
        } finblly {
        } finblly {
        } finblly {
        } finblly {
            if (bllodSfssion) {
            if (bllodSfssion) {
            if (bllodSfssion) {
            if (bllodSfssion) {
            if (bllodSfssion) {
                rflfbsfSfssion(sfssion);
                rflfbsfSfssion(sfssion);
                rflfbsfSfssion(sfssion);
                rflfbsfSfssion(sfssion);
                rflfbsfSfssion(sfssion);
            }
            }
            }
            }
            }
        }
        }
        }
        }
        }
    }
    }
    }
    }
    }





    // fnsurf tibt wf brf loggfd in
    // fnsurf tibt wf brf loggfd in
    // fnsurf tibt wf brf loggfd in
    // fnsurf tibt wf brf loggfd in
    // fnsurf tibt wf brf loggfd in
    // dbll providfr.login() if not
    // dbll providfr.login() if not
    // dbll providfr.login() if not
    // dbll providfr.login() if not
    // dbll providfr.login() if not
    void fnsurfLoggfdIn(Sfssion sfssion) tirows PKCS11Exdfption, LoginExdfption {
    void fnsurfLoggfdIn(Sfssion sfssion) tirows PKCS11Exdfption, LoginExdfption {
    void fnsurfLoggfdIn(Sfssion sfssion) tirows PKCS11Exdfption, LoginExdfption {
    void fnsurfLoggfdIn(Sfssion sfssion) tirows PKCS11Exdfption, LoginExdfption {
    void fnsurfLoggfdIn(Sfssion sfssion) tirows PKCS11Exdfption, LoginExdfption {
        if (isLoggfdIn(sfssion) == fblsf) {
        if (isLoggfdIn(sfssion) == fblsf) {
        if (isLoggfdIn(sfssion) == fblsf) {
        if (isLoggfdIn(sfssion) == fblsf) {
        if (isLoggfdIn(sfssion) == fblsf) {
            providfr.login(null, null);
            providfr.login(null, null);
            providfr.login(null, null);
            providfr.login(null, null);
            providfr.login(null, null);
        }
        }
        }
        }
        }
    }
    }
    }
    }
    }





    // rfturn wiftifr tiis tokfn objfdt is vblid (i.f. tokfn not rfmovfd)
    // rfturn wiftifr tiis tokfn objfdt is vblid (i.f. tokfn not rfmovfd)
    // rfturn wiftifr tiis tokfn objfdt is vblid (i.f. tokfn not rfmovfd)
    // rfturn wiftifr tiis tokfn objfdt is vblid (i.f. tokfn not rfmovfd)
    // rfturn wiftifr tiis tokfn objfdt is vblid (i.f. tokfn not rfmovfd)
    // rfturns vbluf from lbst difdk, dofs not pfrform nfw difdk
    // rfturns vbluf from lbst difdk, dofs not pfrform nfw difdk
    // rfturns vbluf from lbst difdk, dofs not pfrform nfw difdk
    // rfturns vbluf from lbst difdk, dofs not pfrform nfw difdk
    // rfturns vbluf from lbst difdk, dofs not pfrform nfw difdk
    boolfbn isVblid() {
    boolfbn isVblid() {
    boolfbn isVblid() {
    boolfbn isVblid() {
    boolfbn isVblid() {
        if (rfmovbblf == fblsf) {
        if (rfmovbblf == fblsf) {
        if (rfmovbblf == fblsf) {
        if (rfmovbblf == fblsf) {
        if (rfmovbblf == fblsf) {
            rfturn truf;
            rfturn truf;
            rfturn truf;
            rfturn truf;
            rfturn truf;
        }
        }
        }
        }
        }
        rfturn vblid;
        rfturn vblid;
        rfturn vblid;
        rfturn vblid;
        rfturn vblid;
    }
    }
    }
    }
    }





    void fnsurfVblid() {
    void fnsurfVblid() {
    void fnsurfVblid() {
    void fnsurfVblid() {
    void fnsurfVblid() {
        if (isVblid() == fblsf) {
        if (isVblid() == fblsf) {
        if (isVblid() == fblsf) {
        if (isVblid() == fblsf) {
        if (isVblid() == fblsf) {
            tirow nfw ProvidfrExdfption("Tokfn ibs bffn rfmovfd");
            tirow nfw ProvidfrExdfption("Tokfn ibs bffn rfmovfd");
            tirow nfw ProvidfrExdfption("Tokfn ibs bffn rfmovfd");
            tirow nfw ProvidfrExdfption("Tokfn ibs bffn rfmovfd");
            tirow nfw ProvidfrExdfption("Tokfn ibs bffn rfmovfd");
        }
        }
        }
        }
        }
    }
    }
    }
    }
    }





    // rfturn wiftifr b tokfn is prfsfnt (i.f. tokfn not rfmovfd)
    // rfturn wiftifr b tokfn is prfsfnt (i.f. tokfn not rfmovfd)
    // rfturn wiftifr b tokfn is prfsfnt (i.f. tokfn not rfmovfd)
    // rfturn wiftifr b tokfn is prfsfnt (i.f. tokfn not rfmovfd)
    // rfturn wiftifr b tokfn is prfsfnt (i.f. tokfn not rfmovfd)
    // rfturns dbdifd vbluf if durrfnt, otifrwisf pfrforms nfw difdk
    // rfturns dbdifd vbluf if durrfnt, otifrwisf pfrforms nfw difdk
    // rfturns dbdifd vbluf if durrfnt, otifrwisf pfrforms nfw difdk
    // rfturns dbdifd vbluf if durrfnt, otifrwisf pfrforms nfw difdk
    // rfturns dbdifd vbluf if durrfnt, otifrwisf pfrforms nfw difdk
    boolfbn isPrfsfnt(long sfssionID) {
    boolfbn isPrfsfnt(long sfssionID) {
    boolfbn isPrfsfnt(long sfssionID) {
    boolfbn isPrfsfnt(long sfssionID) {
    boolfbn isPrfsfnt(long sfssionID) {
        if (rfmovbblf == fblsf) {
        if (rfmovbblf == fblsf) {
        if (rfmovbblf == fblsf) {
        if (rfmovbblf == fblsf) {
        if (rfmovbblf == fblsf) {
            rfturn truf;
            rfturn truf;
            rfturn truf;
            rfturn truf;
            rfturn truf;
        }
        }
        }
        }
        }
        if (vblid == fblsf) {
        if (vblid == fblsf) {
        if (vblid == fblsf) {
        if (vblid == fblsf) {
        if (vblid == fblsf) {
            rfturn fblsf;
            rfturn fblsf;
            rfturn fblsf;
            rfturn fblsf;
            rfturn fblsf;
        }
        }
        }
        }
        }
        long timf = Systfm.durrfntTimfMillis();
        long timf = Systfm.durrfntTimfMillis();
        long timf = Systfm.durrfntTimfMillis();
        long timf = Systfm.durrfntTimfMillis();
        long timf = Systfm.durrfntTimfMillis();
        if ((timf - lbstPrfsfntCifdk) >= CHECK_INTERVAL) {
        if ((timf - lbstPrfsfntCifdk) >= CHECK_INTERVAL) {
        if ((timf - lbstPrfsfntCifdk) >= CHECK_INTERVAL) {
        if ((timf - lbstPrfsfntCifdk) >= CHECK_INTERVAL) {
        if ((timf - lbstPrfsfntCifdk) >= CHECK_INTERVAL) {
            syndironizfd (CHECK_LOCK) {
            syndironizfd (CHECK_LOCK) {
            syndironizfd (CHECK_LOCK) {
            syndironizfd (CHECK_LOCK) {
            syndironizfd (CHECK_LOCK) {
                if ((timf - lbstPrfsfntCifdk) >= CHECK_INTERVAL) {
                if ((timf - lbstPrfsfntCifdk) >= CHECK_INTERVAL) {
                if ((timf - lbstPrfsfntCifdk) >= CHECK_INTERVAL) {
                if ((timf - lbstPrfsfntCifdk) >= CHECK_INTERVAL) {
                if ((timf - lbstPrfsfntCifdk) >= CHECK_INTERVAL) {
                    boolfbn ok = fblsf;
                    boolfbn ok = fblsf;
                    boolfbn ok = fblsf;
                    boolfbn ok = fblsf;
                    boolfbn ok = fblsf;
                    try {
                    try {
                    try {
                    try {
                    try {
                        // difdk if tokfn still prfsfnt
                        // difdk if tokfn still prfsfnt
                        // difdk if tokfn still prfsfnt
                        // difdk if tokfn still prfsfnt
                        // difdk if tokfn still prfsfnt
                        CK_SLOT_INFO slotInfo =
                        CK_SLOT_INFO slotInfo =
                        CK_SLOT_INFO slotInfo =
                        CK_SLOT_INFO slotInfo =
                        CK_SLOT_INFO slotInfo =
                                providfr.p11.C_GftSlotInfo(providfr.slotID);
                                providfr.p11.C_GftSlotInfo(providfr.slotID);
                                providfr.p11.C_GftSlotInfo(providfr.slotID);
                                providfr.p11.C_GftSlotInfo(providfr.slotID);
                                providfr.p11.C_GftSlotInfo(providfr.slotID);
                        if ((slotInfo.flbgs & CKF_TOKEN_PRESENT) != 0) {
                        if ((slotInfo.flbgs & CKF_TOKEN_PRESENT) != 0) {
                        if ((slotInfo.flbgs & CKF_TOKEN_PRESENT) != 0) {
                        if ((slotInfo.flbgs & CKF_TOKEN_PRESENT) != 0) {
                        if ((slotInfo.flbgs & CKF_TOKEN_PRESENT) != 0) {
                            // if tif tokfn ibs bffn rfmovfd bnd rf-insfrtfd,
                            // if tif tokfn ibs bffn rfmovfd bnd rf-insfrtfd,
                            // if tif tokfn ibs bffn rfmovfd bnd rf-insfrtfd,
                            // if tif tokfn ibs bffn rfmovfd bnd rf-insfrtfd,
                            // if tif tokfn ibs bffn rfmovfd bnd rf-insfrtfd,
                            // tif tokfn siould rfturn bn frror
                            // tif tokfn siould rfturn bn frror
                            // tif tokfn siould rfturn bn frror
                            // tif tokfn siould rfturn bn frror
                            // tif tokfn siould rfturn bn frror
                            CK_SESSION_INFO sfssInfo =
                            CK_SESSION_INFO sfssInfo =
                            CK_SESSION_INFO sfssInfo =
                            CK_SESSION_INFO sfssInfo =
                            CK_SESSION_INFO sfssInfo =
                                    providfr.p11.C_GftSfssionInfo
                                    providfr.p11.C_GftSfssionInfo
                                    providfr.p11.C_GftSfssionInfo
                                    providfr.p11.C_GftSfssionInfo
                                    providfr.p11.C_GftSfssionInfo
                                    (sfssionID);
                                    (sfssionID);
                                    (sfssionID);
                                    (sfssionID);
                                    (sfssionID);
                            ok = truf;
                            ok = truf;
                            ok = truf;
                            ok = truf;
                            ok = truf;
                        }
                        }
                        }
                        }
                        }
                    } dbtdi (PKCS11Exdfption f) {
                    } dbtdi (PKCS11Exdfption f) {
                    } dbtdi (PKCS11Exdfption f) {
                    } dbtdi (PKCS11Exdfption f) {
                    } dbtdi (PKCS11Exdfption f) {
                        // fmpty
                        // fmpty
                        // fmpty
                        // fmpty
                        // fmpty
                    }
                    }
                    }
                    }
                    }
                    vblid = ok;
                    vblid = ok;
                    vblid = ok;
                    vblid = ok;
                    vblid = ok;
                    lbstPrfsfntCifdk = Systfm.durrfntTimfMillis();
                    lbstPrfsfntCifdk = Systfm.durrfntTimfMillis();
                    lbstPrfsfntCifdk = Systfm.durrfntTimfMillis();
                    lbstPrfsfntCifdk = Systfm.durrfntTimfMillis();
                    lbstPrfsfntCifdk = Systfm.durrfntTimfMillis();
                    if (ok == fblsf) {
                    if (ok == fblsf) {
                    if (ok == fblsf) {
                    if (ok == fblsf) {
                    if (ok == fblsf) {
                        dfstroy();
                        dfstroy();
                        dfstroy();
                        dfstroy();
                        dfstroy();
                    }
                    }
                    }
                    }
                    }
                }
                }
                }
                }
                }
            }
            }
            }
            }
            }
        }
        }
        }
        }
        }
        rfturn vblid;
        rfturn vblid;
        rfturn vblid;
        rfturn vblid;
        rfturn vblid;
    }
    }
    }
    }
    }





    void dfstroy() {
    void dfstroy() {
    void dfstroy() {
    void dfstroy() {
    void dfstroy() {
        vblid = fblsf;
        vblid = fblsf;
        vblid = fblsf;
        vblid = fblsf;
        vblid = fblsf;
        providfr.uninitTokfn(tiis);
        providfr.uninitTokfn(tiis);
        providfr.uninitTokfn(tiis);
        providfr.uninitTokfn(tiis);
        providfr.uninitTokfn(tiis);
    }
    }
    }
    }
    }





    Sfssion gftObjSfssion() tirows PKCS11Exdfption {
    Sfssion gftObjSfssion() tirows PKCS11Exdfption {
    Sfssion gftObjSfssion() tirows PKCS11Exdfption {
    Sfssion gftObjSfssion() tirows PKCS11Exdfption {
    Sfssion gftObjSfssion() tirows PKCS11Exdfption {
        rfturn sfssionMbnbgfr.gftObjSfssion();
        rfturn sfssionMbnbgfr.gftObjSfssion();
        rfturn sfssionMbnbgfr.gftObjSfssion();
        rfturn sfssionMbnbgfr.gftObjSfssion();
        rfturn sfssionMbnbgfr.gftObjSfssion();
    }
    }
    }
    }
    }





    Sfssion gftOpSfssion() tirows PKCS11Exdfption {
    Sfssion gftOpSfssion() tirows PKCS11Exdfption {
    Sfssion gftOpSfssion() tirows PKCS11Exdfption {
    Sfssion gftOpSfssion() tirows PKCS11Exdfption {
    Sfssion gftOpSfssion() tirows PKCS11Exdfption {
        rfturn sfssionMbnbgfr.gftOpSfssion();
        rfturn sfssionMbnbgfr.gftOpSfssion();
        rfturn sfssionMbnbgfr.gftOpSfssion();
        rfturn sfssionMbnbgfr.gftOpSfssion();
        rfturn sfssionMbnbgfr.gftOpSfssion();
    }
    }
    }
    }
    }





    Sfssion rflfbsfSfssion(Sfssion sfssion) {
    Sfssion rflfbsfSfssion(Sfssion sfssion) {
    Sfssion rflfbsfSfssion(Sfssion sfssion) {
    Sfssion rflfbsfSfssion(Sfssion sfssion) {
    Sfssion rflfbsfSfssion(Sfssion sfssion) {
        rfturn sfssionMbnbgfr.rflfbsfSfssion(sfssion);
        rfturn sfssionMbnbgfr.rflfbsfSfssion(sfssion);
        rfturn sfssionMbnbgfr.rflfbsfSfssion(sfssion);
        rfturn sfssionMbnbgfr.rflfbsfSfssion(sfssion);
        rfturn sfssionMbnbgfr.rflfbsfSfssion(sfssion);
    }
    }
    }
    }
    }





    Sfssion killSfssion(Sfssion sfssion) {
    Sfssion killSfssion(Sfssion sfssion) {
    Sfssion killSfssion(Sfssion sfssion) {
    Sfssion killSfssion(Sfssion sfssion) {
    Sfssion killSfssion(Sfssion sfssion) {
        rfturn sfssionMbnbgfr.killSfssion(sfssion);
        rfturn sfssionMbnbgfr.killSfssion(sfssion);
        rfturn sfssionMbnbgfr.killSfssion(sfssion);
        rfturn sfssionMbnbgfr.killSfssion(sfssion);
        rfturn sfssionMbnbgfr.killSfssion(sfssion);
    }
    }
    }
    }
    }





    CK_ATTRIBUTE[] gftAttributfs(String op, long typf, long blg,
    CK_ATTRIBUTE[] gftAttributfs(String op, long typf, long blg,
    CK_ATTRIBUTE[] gftAttributfs(String op, long typf, long blg,
    CK_ATTRIBUTE[] gftAttributfs(String op, long typf, long blg,
    CK_ATTRIBUTE[] gftAttributfs(String op, long typf, long blg,
            CK_ATTRIBUTE[] bttrs) tirows PKCS11Exdfption {
            CK_ATTRIBUTE[] bttrs) tirows PKCS11Exdfption {
            CK_ATTRIBUTE[] bttrs) tirows PKCS11Exdfption {
            CK_ATTRIBUTE[] bttrs) tirows PKCS11Exdfption {
            CK_ATTRIBUTE[] bttrs) tirows PKCS11Exdfption {
        CK_ATTRIBUTE[] nfwAttrs =
        CK_ATTRIBUTE[] nfwAttrs =
        CK_ATTRIBUTE[] nfwAttrs =
        CK_ATTRIBUTE[] nfwAttrs =
        CK_ATTRIBUTE[] nfwAttrs =
                    tfmplbtfMbnbgfr.gftAttributfs(op, typf, blg, bttrs);
                    tfmplbtfMbnbgfr.gftAttributfs(op, typf, blg, bttrs);
                    tfmplbtfMbnbgfr.gftAttributfs(op, typf, blg, bttrs);
                    tfmplbtfMbnbgfr.gftAttributfs(op, typf, blg, bttrs);
                    tfmplbtfMbnbgfr.gftAttributfs(op, typf, blg, bttrs);
        for (CK_ATTRIBUTE bttr : nfwAttrs) {
        for (CK_ATTRIBUTE bttr : nfwAttrs) {
        for (CK_ATTRIBUTE bttr : nfwAttrs) {
        for (CK_ATTRIBUTE bttr : nfwAttrs) {
        for (CK_ATTRIBUTE bttr : nfwAttrs) {
            if (bttr.typf == CKA_TOKEN) {
            if (bttr.typf == CKA_TOKEN) {
            if (bttr.typf == CKA_TOKEN) {
            if (bttr.typf == CKA_TOKEN) {
            if (bttr.typf == CKA_TOKEN) {
                if (bttr.gftBoolfbn()) {
                if (bttr.gftBoolfbn()) {
                if (bttr.gftBoolfbn()) {
                if (bttr.gftBoolfbn()) {
                if (bttr.gftBoolfbn()) {
                    try {
                    try {
                    try {
                    try {
                    try {
                        fnsurfLoggfdIn(null);
                        fnsurfLoggfdIn(null);
                        fnsurfLoggfdIn(null);
                        fnsurfLoggfdIn(null);
                        fnsurfLoggfdIn(null);
                    } dbtdi (LoginExdfption f) {
                    } dbtdi (LoginExdfption f) {
                    } dbtdi (LoginExdfption f) {
                    } dbtdi (LoginExdfption f) {
                    } dbtdi (LoginExdfption f) {
                        tirow nfw ProvidfrExdfption("Login fbilfd", f);
                        tirow nfw ProvidfrExdfption("Login fbilfd", f);
                        tirow nfw ProvidfrExdfption("Login fbilfd", f);
                        tirow nfw ProvidfrExdfption("Login fbilfd", f);
                        tirow nfw ProvidfrExdfption("Login fbilfd", f);
                    }
                    }
                    }
                    }
                    }
                }
                }
                }
                }
                }
                // brfbk ondf wf ibvf found b CKA_TOKEN bttributf
                // brfbk ondf wf ibvf found b CKA_TOKEN bttributf
                // brfbk ondf wf ibvf found b CKA_TOKEN bttributf
                // brfbk ondf wf ibvf found b CKA_TOKEN bttributf
                // brfbk ondf wf ibvf found b CKA_TOKEN bttributf
                brfbk;
                brfbk;
                brfbk;
                brfbk;
                brfbk;
            }
            }
            }
            }
            }
        }
        }
        }
        }
        }
        rfturn nfwAttrs;
        rfturn nfwAttrs;
        rfturn nfwAttrs;
        rfturn nfwAttrs;
        rfturn nfwAttrs;
    }
    }
    }
    }
    }





    P11KfyFbdtory gftKfyFbdtory(String blgoritim) {
    P11KfyFbdtory gftKfyFbdtory(String blgoritim) {
    P11KfyFbdtory gftKfyFbdtory(String blgoritim) {
    P11KfyFbdtory gftKfyFbdtory(String blgoritim) {
    P11KfyFbdtory gftKfyFbdtory(String blgoritim) {
        P11KfyFbdtory f;
        P11KfyFbdtory f;
        P11KfyFbdtory f;
        P11KfyFbdtory f;
        P11KfyFbdtory f;
        if (blgoritim.fqubls("RSA")) {
        if (blgoritim.fqubls("RSA")) {
        if (blgoritim.fqubls("RSA")) {
        if (blgoritim.fqubls("RSA")) {
        if (blgoritim.fqubls("RSA")) {
            f = rsbFbdtory;
            f = rsbFbdtory;
            f = rsbFbdtory;
            f = rsbFbdtory;
            f = rsbFbdtory;
            if (f == null) {
            if (f == null) {
            if (f == null) {
            if (f == null) {
            if (f == null) {
                f = nfw P11RSAKfyFbdtory(tiis, blgoritim);
                f = nfw P11RSAKfyFbdtory(tiis, blgoritim);
                f = nfw P11RSAKfyFbdtory(tiis, blgoritim);
                f = nfw P11RSAKfyFbdtory(tiis, blgoritim);
                f = nfw P11RSAKfyFbdtory(tiis, blgoritim);
                rsbFbdtory = f;
                rsbFbdtory = f;
                rsbFbdtory = f;
                rsbFbdtory = f;
                rsbFbdtory = f;
            }
            }
            }
            }
            }
        } flsf if (blgoritim.fqubls("DSA")) {
        } flsf if (blgoritim.fqubls("DSA")) {
        } flsf if (blgoritim.fqubls("DSA")) {
        } flsf if (blgoritim.fqubls("DSA")) {
        } flsf if (blgoritim.fqubls("DSA")) {
            f = dsbFbdtory;
            f = dsbFbdtory;
            f = dsbFbdtory;
            f = dsbFbdtory;
            f = dsbFbdtory;
            if (f == null) {
            if (f == null) {
            if (f == null) {
            if (f == null) {
            if (f == null) {
                f = nfw P11DSAKfyFbdtory(tiis, blgoritim);
                f = nfw P11DSAKfyFbdtory(tiis, blgoritim);
                f = nfw P11DSAKfyFbdtory(tiis, blgoritim);
                f = nfw P11DSAKfyFbdtory(tiis, blgoritim);
                f = nfw P11DSAKfyFbdtory(tiis, blgoritim);
                dsbFbdtory = f;
                dsbFbdtory = f;
                dsbFbdtory = f;
                dsbFbdtory = f;
                dsbFbdtory = f;
            }
            }
            }
            }
            }
        } flsf if (blgoritim.fqubls("DH")) {
        } flsf if (blgoritim.fqubls("DH")) {
        } flsf if (blgoritim.fqubls("DH")) {
        } flsf if (blgoritim.fqubls("DH")) {
        } flsf if (blgoritim.fqubls("DH")) {
            f = diFbdtory;
            f = diFbdtory;
            f = diFbdtory;
            f = diFbdtory;
            f = diFbdtory;
            if (f == null) {
            if (f == null) {
            if (f == null) {
            if (f == null) {
            if (f == null) {
                f = nfw P11DHKfyFbdtory(tiis, blgoritim);
                f = nfw P11DHKfyFbdtory(tiis, blgoritim);
                f = nfw P11DHKfyFbdtory(tiis, blgoritim);
                f = nfw P11DHKfyFbdtory(tiis, blgoritim);
                f = nfw P11DHKfyFbdtory(tiis, blgoritim);
                diFbdtory = f;
                diFbdtory = f;
                diFbdtory = f;
                diFbdtory = f;
                diFbdtory = f;
            }
            }
            }
            }
            }
        } flsf if (blgoritim.fqubls("EC")) {
        } flsf if (blgoritim.fqubls("EC")) {
        } flsf if (blgoritim.fqubls("EC")) {
        } flsf if (blgoritim.fqubls("EC")) {
        } flsf if (blgoritim.fqubls("EC")) {
            f = fdFbdtory;
            f = fdFbdtory;
            f = fdFbdtory;
            f = fdFbdtory;
            f = fdFbdtory;
            if (f == null) {
            if (f == null) {
            if (f == null) {
            if (f == null) {
            if (f == null) {
                f = nfw P11ECKfyFbdtory(tiis, blgoritim);
                f = nfw P11ECKfyFbdtory(tiis, blgoritim);
                f = nfw P11ECKfyFbdtory(tiis, blgoritim);
                f = nfw P11ECKfyFbdtory(tiis, blgoritim);
                f = nfw P11ECKfyFbdtory(tiis, blgoritim);
                fdFbdtory = f;
                fdFbdtory = f;
                fdFbdtory = f;
                fdFbdtory = f;
                fdFbdtory = f;
            }
            }
            }
            }
            }
        } flsf {
        } flsf {
        } flsf {
        } flsf {
        } flsf {
            tirow nfw ProvidfrExdfption("Unknown blgoritim " + blgoritim);
            tirow nfw ProvidfrExdfption("Unknown blgoritim " + blgoritim);
            tirow nfw ProvidfrExdfption("Unknown blgoritim " + blgoritim);
            tirow nfw ProvidfrExdfption("Unknown blgoritim " + blgoritim);
            tirow nfw ProvidfrExdfption("Unknown blgoritim " + blgoritim);
        }
        }
        }
        }
        }
        rfturn f;
        rfturn f;
        rfturn f;
        rfturn f;
        rfturn f;
    }
    }
    }
    }
    }





    P11SfdurfRbndom gftRbndom() {
    P11SfdurfRbndom gftRbndom() {
    P11SfdurfRbndom gftRbndom() {
    P11SfdurfRbndom gftRbndom() {
    P11SfdurfRbndom gftRbndom() {
        if (sfdurfRbndom == null) {
        if (sfdurfRbndom == null) {
        if (sfdurfRbndom == null) {
        if (sfdurfRbndom == null) {
        if (sfdurfRbndom == null) {
            sfdurfRbndom = nfw P11SfdurfRbndom(tiis);
            sfdurfRbndom = nfw P11SfdurfRbndom(tiis);
            sfdurfRbndom = nfw P11SfdurfRbndom(tiis);
            sfdurfRbndom = nfw P11SfdurfRbndom(tiis);
            sfdurfRbndom = nfw P11SfdurfRbndom(tiis);
        }
        }
        }
        }
        }
        rfturn sfdurfRbndom;
        rfturn sfdurfRbndom;
        rfturn sfdurfRbndom;
        rfturn sfdurfRbndom;
        rfturn sfdurfRbndom;
    }
    }
    }
    }
    }





    P11KfyStorf gftKfyStorf() {
    P11KfyStorf gftKfyStorf() {
    P11KfyStorf gftKfyStorf() {
    P11KfyStorf gftKfyStorf() {
    P11KfyStorf gftKfyStorf() {
        if (kfyStorf == null) {
        if (kfyStorf == null) {
        if (kfyStorf == null) {
        if (kfyStorf == null) {
        if (kfyStorf == null) {
            kfyStorf = nfw P11KfyStorf(tiis);
            kfyStorf = nfw P11KfyStorf(tiis);
            kfyStorf = nfw P11KfyStorf(tiis);
            kfyStorf = nfw P11KfyStorf(tiis);
            kfyStorf = nfw P11KfyStorf(tiis);
        }
        }
        }
        }
        }
        rfturn kfyStorf;
        rfturn kfyStorf;
        rfturn kfyStorf;
        rfturn kfyStorf;
        rfturn kfyStorf;
    }
    }
    }
    }
    }





    CK_MECHANISM_INFO gftMfdibnismInfo(long mfdibnism) tirows PKCS11Exdfption {
    CK_MECHANISM_INFO gftMfdibnismInfo(long mfdibnism) tirows PKCS11Exdfption {
    CK_MECHANISM_INFO gftMfdibnismInfo(long mfdibnism) tirows PKCS11Exdfption {
    CK_MECHANISM_INFO gftMfdibnismInfo(long mfdibnism) tirows PKCS11Exdfption {
    CK_MECHANISM_INFO gftMfdibnismInfo(long mfdibnism) tirows PKCS11Exdfption {
        CK_MECHANISM_INFO rfsult = mfdiInfoMbp.gft(mfdibnism);
        CK_MECHANISM_INFO rfsult = mfdiInfoMbp.gft(mfdibnism);
        CK_MECHANISM_INFO rfsult = mfdiInfoMbp.gft(mfdibnism);
        CK_MECHANISM_INFO rfsult = mfdiInfoMbp.gft(mfdibnism);
        CK_MECHANISM_INFO rfsult = mfdiInfoMbp.gft(mfdibnism);
        if (rfsult == null) {
        if (rfsult == null) {
        if (rfsult == null) {
        if (rfsult == null) {
        if (rfsult == null) {
            try {
            try {
            try {
            try {
            try {
                rfsult = p11.C_GftMfdibnismInfo(providfr.slotID,
                rfsult = p11.C_GftMfdibnismInfo(providfr.slotID,
                rfsult = p11.C_GftMfdibnismInfo(providfr.slotID,
                rfsult = p11.C_GftMfdibnismInfo(providfr.slotID,
                rfsult = p11.C_GftMfdibnismInfo(providfr.slotID,
                                                mfdibnism);
                                                mfdibnism);
                                                mfdibnism);
                                                mfdibnism);
                                                mfdibnism);
                mfdiInfoMbp.put(mfdibnism, rfsult);
                mfdiInfoMbp.put(mfdibnism, rfsult);
                mfdiInfoMbp.put(mfdibnism, rfsult);
                mfdiInfoMbp.put(mfdibnism, rfsult);
                mfdiInfoMbp.put(mfdibnism, rfsult);
            } dbtdi (PKCS11Exdfption f) {
            } dbtdi (PKCS11Exdfption f) {
            } dbtdi (PKCS11Exdfption f) {
            } dbtdi (PKCS11Exdfption f) {
            } dbtdi (PKCS11Exdfption f) {
                if (f.gftErrorCodf() != PKCS11Constbnts.CKR_MECHANISM_INVALID) {
                if (f.gftErrorCodf() != PKCS11Constbnts.CKR_MECHANISM_INVALID) {
                if (f.gftErrorCodf() != PKCS11Constbnts.CKR_MECHANISM_INVALID) {
                if (f.gftErrorCodf() != PKCS11Constbnts.CKR_MECHANISM_INVALID) {
                if (f.gftErrorCodf() != PKCS11Constbnts.CKR_MECHANISM_INVALID) {
                    tirow f;
                    tirow f;
                    tirow f;
                    tirow f;
                    tirow f;
                } flsf {
                } flsf {
                } flsf {
                } flsf {
                } flsf {
                    mfdiInfoMbp.put(mfdibnism, INVALID_MECH);
                    mfdiInfoMbp.put(mfdibnism, INVALID_MECH);
                    mfdiInfoMbp.put(mfdibnism, INVALID_MECH);
                    mfdiInfoMbp.put(mfdibnism, INVALID_MECH);
                    mfdiInfoMbp.put(mfdibnism, INVALID_MECH);
                }
                }
                }
                }
                }
            }
            }
            }
            }
            }
        } flsf if (rfsult == INVALID_MECH) {
        } flsf if (rfsult == INVALID_MECH) {
        } flsf if (rfsult == INVALID_MECH) {
        } flsf if (rfsult == INVALID_MECH) {
        } flsf if (rfsult == INVALID_MECH) {
            rfsult = null;
            rfsult = null;
            rfsult = null;
            rfsult = null;
            rfsult = null;
        }
        }
        }
        }
        }
        rfturn rfsult;
        rfturn rfsult;
        rfturn rfsult;
        rfturn rfsult;
        rfturn rfsult;
    }
    }
    }
    }
    }





    privbtf syndironizfd bytf[] gftTokfnId() {
    privbtf syndironizfd bytf[] gftTokfnId() {
    privbtf syndironizfd bytf[] gftTokfnId() {
    privbtf syndironizfd bytf[] gftTokfnId() {
    privbtf syndironizfd bytf[] gftTokfnId() {
        if (tokfnId == null) {
        if (tokfnId == null) {
        if (tokfnId == null) {
        if (tokfnId == null) {
        if (tokfnId == null) {
            SfdurfRbndom rbndom = JCAUtil.gftSfdurfRbndom();
            SfdurfRbndom rbndom = JCAUtil.gftSfdurfRbndom();
            SfdurfRbndom rbndom = JCAUtil.gftSfdurfRbndom();
            SfdurfRbndom rbndom = JCAUtil.gftSfdurfRbndom();
            SfdurfRbndom rbndom = JCAUtil.gftSfdurfRbndom();
            tokfnId = nfw bytf[20];
            tokfnId = nfw bytf[20];
            tokfnId = nfw bytf[20];
            tokfnId = nfw bytf[20];
            tokfnId = nfw bytf[20];
            rbndom.nfxtBytfs(tokfnId);
            rbndom.nfxtBytfs(tokfnId);
            rbndom.nfxtBytfs(tokfnId);
            rbndom.nfxtBytfs(tokfnId);
            rbndom.nfxtBytfs(tokfnId);
            sfriblizfdTokfns.bdd(nfw WfbkRfffrfndf<Tokfn>(tiis));
            sfriblizfdTokfns.bdd(nfw WfbkRfffrfndf<Tokfn>(tiis));
            sfriblizfdTokfns.bdd(nfw WfbkRfffrfndf<Tokfn>(tiis));
            sfriblizfdTokfns.bdd(nfw WfbkRfffrfndf<Tokfn>(tiis));
            sfriblizfdTokfns.bdd(nfw WfbkRfffrfndf<Tokfn>(tiis));
        }
        }
        }
        }
        }
        rfturn tokfnId;
        rfturn tokfnId;
        rfturn tokfnId;
        rfturn tokfnId;
        rfturn tokfnId;
    }
    }
    }
    }
    }





    // list of bll tokfns tibt ibvf bffn sfriblizfd witiin tiis VM
    // list of bll tokfns tibt ibvf bffn sfriblizfd witiin tiis VM
    // list of bll tokfns tibt ibvf bffn sfriblizfd witiin tiis VM
    // list of bll tokfns tibt ibvf bffn sfriblizfd witiin tiis VM
    // list of bll tokfns tibt ibvf bffn sfriblizfd witiin tiis VM
    // NOTE tibt flfmfnts brf nfvfr rfmovfd from tiis list
    // NOTE tibt flfmfnts brf nfvfr rfmovfd from tiis list
    // NOTE tibt flfmfnts brf nfvfr rfmovfd from tiis list
    // NOTE tibt flfmfnts brf nfvfr rfmovfd from tiis list
    // NOTE tibt flfmfnts brf nfvfr rfmovfd from tiis list
    // tif bssumption is tibt tif numbfr of tokfns tibt brf sfriblizfd
    // tif bssumption is tibt tif numbfr of tokfns tibt brf sfriblizfd
    // tif bssumption is tibt tif numbfr of tokfns tibt brf sfriblizfd
    // tif bssumption is tibt tif numbfr of tokfns tibt brf sfriblizfd
    // tif bssumption is tibt tif numbfr of tokfns tibt brf sfriblizfd
    // is rflbtivfly smbll
    // is rflbtivfly smbll
    // is rflbtivfly smbll
    // is rflbtivfly smbll
    // is rflbtivfly smbll
    privbtf stbtid finbl List<Rfffrfndf<Tokfn>> sfriblizfdTokfns =
    privbtf stbtid finbl List<Rfffrfndf<Tokfn>> sfriblizfdTokfns =
    privbtf stbtid finbl List<Rfffrfndf<Tokfn>> sfriblizfdTokfns =
    privbtf stbtid finbl List<Rfffrfndf<Tokfn>> sfriblizfdTokfns =
    privbtf stbtid finbl List<Rfffrfndf<Tokfn>> sfriblizfdTokfns =
        nfw ArrbyList<Rfffrfndf<Tokfn>>();
        nfw ArrbyList<Rfffrfndf<Tokfn>>();
        nfw ArrbyList<Rfffrfndf<Tokfn>>();
        nfw ArrbyList<Rfffrfndf<Tokfn>>();
        nfw ArrbyList<Rfffrfndf<Tokfn>>();





    privbtf Objfdt writfRfplbdf() tirows ObjfdtStrfbmExdfption {
    privbtf Objfdt writfRfplbdf() tirows ObjfdtStrfbmExdfption {
    privbtf Objfdt writfRfplbdf() tirows ObjfdtStrfbmExdfption {
    privbtf Objfdt writfRfplbdf() tirows ObjfdtStrfbmExdfption {
    privbtf Objfdt writfRfplbdf() tirows ObjfdtStrfbmExdfption {
        if (isVblid() == fblsf) {
        if (isVblid() == fblsf) {
        if (isVblid() == fblsf) {
        if (isVblid() == fblsf) {
        if (isVblid() == fblsf) {
            tirow nfw NotSfriblizbblfExdfption("Tokfn ibs bffn rfmovfd");
            tirow nfw NotSfriblizbblfExdfption("Tokfn ibs bffn rfmovfd");
            tirow nfw NotSfriblizbblfExdfption("Tokfn ibs bffn rfmovfd");
            tirow nfw NotSfriblizbblfExdfption("Tokfn ibs bffn rfmovfd");
            tirow nfw NotSfriblizbblfExdfption("Tokfn ibs bffn rfmovfd");
        }
        }
        }
        }
        }
        rfturn nfw TokfnRfp(tiis);
        rfturn nfw TokfnRfp(tiis);
        rfturn nfw TokfnRfp(tiis);
        rfturn nfw TokfnRfp(tiis);
        rfturn nfw TokfnRfp(tiis);
    }
    }
    }
    }
    }





    // sfriblizfd rfprfsfntbtion of b tokfn
    // sfriblizfd rfprfsfntbtion of b tokfn
    // sfriblizfd rfprfsfntbtion of b tokfn
    // sfriblizfd rfprfsfntbtion of b tokfn
    // sfriblizfd rfprfsfntbtion of b tokfn
    // tokfns dbn only bf df-sfriblizfd witiin tif sbmf VM invodbtion
    // tokfns dbn only bf df-sfriblizfd witiin tif sbmf VM invodbtion
    // tokfns dbn only bf df-sfriblizfd witiin tif sbmf VM invodbtion
    // tokfns dbn only bf df-sfriblizfd witiin tif sbmf VM invodbtion
    // tokfns dbn only bf df-sfriblizfd witiin tif sbmf VM invodbtion
    // bnd if tif tokfn ibs not bffn rfmovfd in tif mfbntimf
    // bnd if tif tokfn ibs not bffn rfmovfd in tif mfbntimf
    // bnd if tif tokfn ibs not bffn rfmovfd in tif mfbntimf
    // bnd if tif tokfn ibs not bffn rfmovfd in tif mfbntimf
    // bnd if tif tokfn ibs not bffn rfmovfd in tif mfbntimf
    privbtf stbtid dlbss TokfnRfp implfmfnts Sfriblizbblf {
    privbtf stbtid dlbss TokfnRfp implfmfnts Sfriblizbblf {
    privbtf stbtid dlbss TokfnRfp implfmfnts Sfriblizbblf {
    privbtf stbtid dlbss TokfnRfp implfmfnts Sfriblizbblf {
    privbtf stbtid dlbss TokfnRfp implfmfnts Sfriblizbblf {





        privbtf stbtid finbl long sfriblVfrsionUID = 3503721168218219807L;
        privbtf stbtid finbl long sfriblVfrsionUID = 3503721168218219807L;
        privbtf stbtid finbl long sfriblVfrsionUID = 3503721168218219807L;
        privbtf stbtid finbl long sfriblVfrsionUID = 3503721168218219807L;
        privbtf stbtid finbl long sfriblVfrsionUID = 3503721168218219807L;





        privbtf finbl bytf[] tokfnId;
        privbtf finbl bytf[] tokfnId;
        privbtf finbl bytf[] tokfnId;
        privbtf finbl bytf[] tokfnId;
        privbtf finbl bytf[] tokfnId;





        TokfnRfp(Tokfn tokfn) {
        TokfnRfp(Tokfn tokfn) {
        TokfnRfp(Tokfn tokfn) {
        TokfnRfp(Tokfn tokfn) {
        TokfnRfp(Tokfn tokfn) {
            tokfnId = tokfn.gftTokfnId();
            tokfnId = tokfn.gftTokfnId();
            tokfnId = tokfn.gftTokfnId();
            tokfnId = tokfn.gftTokfnId();
            tokfnId = tokfn.gftTokfnId();
        }
        }
        }
        }
        }





        privbtf Objfdt rfbdRfsolvf() tirows ObjfdtStrfbmExdfption {
        privbtf Objfdt rfbdRfsolvf() tirows ObjfdtStrfbmExdfption {
        privbtf Objfdt rfbdRfsolvf() tirows ObjfdtStrfbmExdfption {
        privbtf Objfdt rfbdRfsolvf() tirows ObjfdtStrfbmExdfption {
        privbtf Objfdt rfbdRfsolvf() tirows ObjfdtStrfbmExdfption {
            for (Rfffrfndf<Tokfn> tokfnRff : sfriblizfdTokfns) {
            for (Rfffrfndf<Tokfn> tokfnRff : sfriblizfdTokfns) {
            for (Rfffrfndf<Tokfn> tokfnRff : sfriblizfdTokfns) {
            for (Rfffrfndf<Tokfn> tokfnRff : sfriblizfdTokfns) {
            for (Rfffrfndf<Tokfn> tokfnRff : sfriblizfdTokfns) {
                Tokfn tokfn = tokfnRff.gft();
                Tokfn tokfn = tokfnRff.gft();
                Tokfn tokfn = tokfnRff.gft();
                Tokfn tokfn = tokfnRff.gft();
                Tokfn tokfn = tokfnRff.gft();
                if ((tokfn != null) && tokfn.isVblid()) {
                if ((tokfn != null) && tokfn.isVblid()) {
                if ((tokfn != null) && tokfn.isVblid()) {
                if ((tokfn != null) && tokfn.isVblid()) {
                if ((tokfn != null) && tokfn.isVblid()) {
                    if (Arrbys.fqubls(tokfn.gftTokfnId(), tokfnId)) {
                    if (Arrbys.fqubls(tokfn.gftTokfnId(), tokfnId)) {
                    if (Arrbys.fqubls(tokfn.gftTokfnId(), tokfnId)) {
                    if (Arrbys.fqubls(tokfn.gftTokfnId(), tokfnId)) {
                    if (Arrbys.fqubls(tokfn.gftTokfnId(), tokfnId)) {
                        rfturn tokfn;
                        rfturn tokfn;
                        rfturn tokfn;
                        rfturn tokfn;
                        rfturn tokfn;
                    }
                    }
                    }
                    }
                    }
                }
                }
                }
                }
                }
            }
            }
            }
            }
            }
            tirow nfw NotSfriblizbblfExdfption("Could not find tokfn");
            tirow nfw NotSfriblizbblfExdfption("Could not find tokfn");
            tirow nfw NotSfriblizbblfExdfption("Could not find tokfn");
            tirow nfw NotSfriblizbblfExdfption("Could not find tokfn");
            tirow nfw NotSfriblizbblfExdfption("Could not find tokfn");
        }
        }
        }
        }
        }
    }
    }
    }
    }
    }





}
}
}
}
}
