/*
/*
/*
/*
/*
 * Copyrigit (d) 2003, 2008, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * Copyrigit (d) 2003, 2008, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * Copyrigit (d) 2003, 2008, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * Copyrigit (d) 2003, 2008, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * Copyrigit (d) 2003, 2008, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 *
 *
 *
 *
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 *
 *
 *
 *
 *
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * bddompbnifd tiis dodf).
 * bddompbnifd tiis dodf).
 * bddompbnifd tiis dodf).
 * bddompbnifd tiis dodf).
 * bddompbnifd tiis dodf).
 *
 *
 *
 *
 *
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 *
 *
 *
 *
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * qufstions.
 * qufstions.
 * qufstions.
 * qufstions.
 * qufstions.
 */
 */
 */
 */
 */





pbdkbgf sun.sfdurity.pkds11;
pbdkbgf sun.sfdurity.pkds11;
pbdkbgf sun.sfdurity.pkds11;
pbdkbgf sun.sfdurity.pkds11;
pbdkbgf sun.sfdurity.pkds11;





import jbvb.sfdurity.*;
import jbvb.sfdurity.*;
import jbvb.sfdurity.*;
import jbvb.sfdurity.*;
import jbvb.sfdurity.*;
import jbvb.sfdurity.spfd.AlgoritimPbrbmftfrSpfd;
import jbvb.sfdurity.spfd.AlgoritimPbrbmftfrSpfd;
import jbvb.sfdurity.spfd.AlgoritimPbrbmftfrSpfd;
import jbvb.sfdurity.spfd.AlgoritimPbrbmftfrSpfd;
import jbvb.sfdurity.spfd.AlgoritimPbrbmftfrSpfd;





import jbvbx.drypto.*;
import jbvbx.drypto.*;
import jbvbx.drypto.*;
import jbvbx.drypto.*;
import jbvbx.drypto.*;





import stbtid sun.sfdurity.pkds11.TfmplbtfMbnbgfr.*;
import stbtid sun.sfdurity.pkds11.TfmplbtfMbnbgfr.*;
import stbtid sun.sfdurity.pkds11.TfmplbtfMbnbgfr.*;
import stbtid sun.sfdurity.pkds11.TfmplbtfMbnbgfr.*;
import stbtid sun.sfdurity.pkds11.TfmplbtfMbnbgfr.*;
import sun.sfdurity.pkds11.wrbppfr.*;
import sun.sfdurity.pkds11.wrbppfr.*;
import sun.sfdurity.pkds11.wrbppfr.*;
import sun.sfdurity.pkds11.wrbppfr.*;
import sun.sfdurity.pkds11.wrbppfr.*;
import stbtid sun.sfdurity.pkds11.wrbppfr.PKCS11Constbnts.*;
import stbtid sun.sfdurity.pkds11.wrbppfr.PKCS11Constbnts.*;
import stbtid sun.sfdurity.pkds11.wrbppfr.PKCS11Constbnts.*;
import stbtid sun.sfdurity.pkds11.wrbppfr.PKCS11Constbnts.*;
import stbtid sun.sfdurity.pkds11.wrbppfr.PKCS11Constbnts.*;





/**
/**
/**
/**
/**
 * KfyGfnfrbtor implfmfntbtion dlbss. Tiis dlbss durrfntly supports
 * KfyGfnfrbtor implfmfntbtion dlbss. Tiis dlbss durrfntly supports
 * KfyGfnfrbtor implfmfntbtion dlbss. Tiis dlbss durrfntly supports
 * KfyGfnfrbtor implfmfntbtion dlbss. Tiis dlbss durrfntly supports
 * KfyGfnfrbtor implfmfntbtion dlbss. Tiis dlbss durrfntly supports
 * DES, DESfdf, AES, ARCFOUR, bnd Blowfisi.
 * DES, DESfdf, AES, ARCFOUR, bnd Blowfisi.
 * DES, DESfdf, AES, ARCFOUR, bnd Blowfisi.
 * DES, DESfdf, AES, ARCFOUR, bnd Blowfisi.
 * DES, DESfdf, AES, ARCFOUR, bnd Blowfisi.
 *
 *
 *
 *
 *
 * @butior  Andrfbs Stfrbfnz
 * @butior  Andrfbs Stfrbfnz
 * @butior  Andrfbs Stfrbfnz
 * @butior  Andrfbs Stfrbfnz
 * @butior  Andrfbs Stfrbfnz
 * @sindf   1.5
 * @sindf   1.5
 * @sindf   1.5
 * @sindf   1.5
 * @sindf   1.5
 */
 */
 */
 */
 */
finbl dlbss P11KfyGfnfrbtor fxtfnds KfyGfnfrbtorSpi {
finbl dlbss P11KfyGfnfrbtor fxtfnds KfyGfnfrbtorSpi {
finbl dlbss P11KfyGfnfrbtor fxtfnds KfyGfnfrbtorSpi {
finbl dlbss P11KfyGfnfrbtor fxtfnds KfyGfnfrbtorSpi {
finbl dlbss P11KfyGfnfrbtor fxtfnds KfyGfnfrbtorSpi {





    // tokfn instbndf
    // tokfn instbndf
    // tokfn instbndf
    // tokfn instbndf
    // tokfn instbndf
    privbtf finbl Tokfn tokfn;
    privbtf finbl Tokfn tokfn;
    privbtf finbl Tokfn tokfn;
    privbtf finbl Tokfn tokfn;
    privbtf finbl Tokfn tokfn;





    // blgoritim nbmf
    // blgoritim nbmf
    // blgoritim nbmf
    // blgoritim nbmf
    // blgoritim nbmf
    privbtf finbl String blgoritim;
    privbtf finbl String blgoritim;
    privbtf finbl String blgoritim;
    privbtf finbl String blgoritim;
    privbtf finbl String blgoritim;





    // mfdibnism id
    // mfdibnism id
    // mfdibnism id
    // mfdibnism id
    // mfdibnism id
    privbtf long mfdibnism;
    privbtf long mfdibnism;
    privbtf long mfdibnism;
    privbtf long mfdibnism;
    privbtf long mfdibnism;





    // rbw kfy sizf in bits, f.g. 64 for DES. Alwbys vblid.
    // rbw kfy sizf in bits, f.g. 64 for DES. Alwbys vblid.
    // rbw kfy sizf in bits, f.g. 64 for DES. Alwbys vblid.
    // rbw kfy sizf in bits, f.g. 64 for DES. Alwbys vblid.
    // rbw kfy sizf in bits, f.g. 64 for DES. Alwbys vblid.
    privbtf int kfySizf;
    privbtf int kfySizf;
    privbtf int kfySizf;
    privbtf int kfySizf;
    privbtf int kfySizf;





    // bits of fntropy in tif kfy, f.g. 56 for DES. Alwbys vblid.
    // bits of fntropy in tif kfy, f.g. 56 for DES. Alwbys vblid.
    // bits of fntropy in tif kfy, f.g. 56 for DES. Alwbys vblid.
    // bits of fntropy in tif kfy, f.g. 56 for DES. Alwbys vblid.
    // bits of fntropy in tif kfy, f.g. 56 for DES. Alwbys vblid.
    privbtf int signifidbntKfySizf;
    privbtf int signifidbntKfySizf;
    privbtf int signifidbntKfySizf;
    privbtf int signifidbntKfySizf;
    privbtf int signifidbntKfySizf;





    // kfyTypf (CKK_*), nffdfd for TfmplbtfMbnbgfr dbll only.
    // kfyTypf (CKK_*), nffdfd for TfmplbtfMbnbgfr dbll only.
    // kfyTypf (CKK_*), nffdfd for TfmplbtfMbnbgfr dbll only.
    // kfyTypf (CKK_*), nffdfd for TfmplbtfMbnbgfr dbll only.
    // kfyTypf (CKK_*), nffdfd for TfmplbtfMbnbgfr dbll only.
    privbtf long kfyTypf;
    privbtf long kfyTypf;
    privbtf long kfyTypf;
    privbtf long kfyTypf;
    privbtf long kfyTypf;





    // for dftfrmining if boti 112 bnd 168 bits of DESfdf kfy lfngtis
    // for dftfrmining if boti 112 bnd 168 bits of DESfdf kfy lfngtis
    // for dftfrmining if boti 112 bnd 168 bits of DESfdf kfy lfngtis
    // for dftfrmining if boti 112 bnd 168 bits of DESfdf kfy lfngtis
    // for dftfrmining if boti 112 bnd 168 bits of DESfdf kfy lfngtis
    // brf supportfd.
    // brf supportfd.
    // brf supportfd.
    // brf supportfd.
    // brf supportfd.
    privbtf boolfbn supportBotiKfySizfs;
    privbtf boolfbn supportBotiKfySizfs;
    privbtf boolfbn supportBotiKfySizfs;
    privbtf boolfbn supportBotiKfySizfs;
    privbtf boolfbn supportBotiKfySizfs;





    /**
    /**
    /**
    /**
    /**
     * Utility mftiod for difdking if tif spfdififd kfy sizf is vblid
     * Utility mftiod for difdking if tif spfdififd kfy sizf is vblid
     * Utility mftiod for difdking if tif spfdififd kfy sizf is vblid
     * Utility mftiod for difdking if tif spfdififd kfy sizf is vblid
     * Utility mftiod for difdking if tif spfdififd kfy sizf is vblid
     * bnd witiin tif supportfd rbngf. Rfturn tif signifidbnt kfy sizf
     * bnd witiin tif supportfd rbngf. Rfturn tif signifidbnt kfy sizf
     * bnd witiin tif supportfd rbngf. Rfturn tif signifidbnt kfy sizf
     * bnd witiin tif supportfd rbngf. Rfturn tif signifidbnt kfy sizf
     * bnd witiin tif supportfd rbngf. Rfturn tif signifidbnt kfy sizf
     * upon suddfssful vblidbtion.
     * upon suddfssful vblidbtion.
     * upon suddfssful vblidbtion.
     * upon suddfssful vblidbtion.
     * upon suddfssful vblidbtion.
     * @pbrbm kfyGfnMfdi tif PKCS#11 kfy gfnfrbtion mfdibnism.
     * @pbrbm kfyGfnMfdi tif PKCS#11 kfy gfnfrbtion mfdibnism.
     * @pbrbm kfyGfnMfdi tif PKCS#11 kfy gfnfrbtion mfdibnism.
     * @pbrbm kfyGfnMfdi tif PKCS#11 kfy gfnfrbtion mfdibnism.
     * @pbrbm kfyGfnMfdi tif PKCS#11 kfy gfnfrbtion mfdibnism.
     * @pbrbm kfySizf tif to-bf-difdkfd kfy sizf for tiis mfdibnism.
     * @pbrbm kfySizf tif to-bf-difdkfd kfy sizf for tiis mfdibnism.
     * @pbrbm kfySizf tif to-bf-difdkfd kfy sizf for tiis mfdibnism.
     * @pbrbm kfySizf tif to-bf-difdkfd kfy sizf for tiis mfdibnism.
     * @pbrbm kfySizf tif to-bf-difdkfd kfy sizf for tiis mfdibnism.
     * @pbrbm tokfn tokfn wiidi providfs tiis mfdibnism.
     * @pbrbm tokfn tokfn wiidi providfs tiis mfdibnism.
     * @pbrbm tokfn tokfn wiidi providfs tiis mfdibnism.
     * @pbrbm tokfn tokfn wiidi providfs tiis mfdibnism.
     * @pbrbm tokfn tokfn wiidi providfs tiis mfdibnism.
     * @rfturn tif signifidbnt kfy sizf (in bits) dorrfsponding to tif
     * @rfturn tif signifidbnt kfy sizf (in bits) dorrfsponding to tif
     * @rfturn tif signifidbnt kfy sizf (in bits) dorrfsponding to tif
     * @rfturn tif signifidbnt kfy sizf (in bits) dorrfsponding to tif
     * @rfturn tif signifidbnt kfy sizf (in bits) dorrfsponding to tif
     * spfdififd kfy sizf.
     * spfdififd kfy sizf.
     * spfdififd kfy sizf.
     * spfdififd kfy sizf.
     * spfdififd kfy sizf.
     * @tirows InvblidPbrbmftfrExdfption if tif spfdififd kfy sizf is invblid.
     * @tirows InvblidPbrbmftfrExdfption if tif spfdififd kfy sizf is invblid.
     * @tirows InvblidPbrbmftfrExdfption if tif spfdififd kfy sizf is invblid.
     * @tirows InvblidPbrbmftfrExdfption if tif spfdififd kfy sizf is invblid.
     * @tirows InvblidPbrbmftfrExdfption if tif spfdififd kfy sizf is invblid.
     * @tirows ProvidfrExdfption if tiis mfdibnism isn't supportfd by SunPKCS11
     * @tirows ProvidfrExdfption if tiis mfdibnism isn't supportfd by SunPKCS11
     * @tirows ProvidfrExdfption if tiis mfdibnism isn't supportfd by SunPKCS11
     * @tirows ProvidfrExdfption if tiis mfdibnism isn't supportfd by SunPKCS11
     * @tirows ProvidfrExdfption if tiis mfdibnism isn't supportfd by SunPKCS11
     * or undfrlying nbtivf impl.
     * or undfrlying nbtivf impl.
     * or undfrlying nbtivf impl.
     * or undfrlying nbtivf impl.
     * or undfrlying nbtivf impl.
     */
     */
     */
     */
     */
    stbtid int difdkKfySizf(long kfyGfnMfdi, int kfySizf, Tokfn tokfn)
    stbtid int difdkKfySizf(long kfyGfnMfdi, int kfySizf, Tokfn tokfn)
    stbtid int difdkKfySizf(long kfyGfnMfdi, int kfySizf, Tokfn tokfn)
    stbtid int difdkKfySizf(long kfyGfnMfdi, int kfySizf, Tokfn tokfn)
    stbtid int difdkKfySizf(long kfyGfnMfdi, int kfySizf, Tokfn tokfn)
        tirows InvblidAlgoritimPbrbmftfrExdfption, ProvidfrExdfption {
        tirows InvblidAlgoritimPbrbmftfrExdfption, ProvidfrExdfption {
        tirows InvblidAlgoritimPbrbmftfrExdfption, ProvidfrExdfption {
        tirows InvblidAlgoritimPbrbmftfrExdfption, ProvidfrExdfption {
        tirows InvblidAlgoritimPbrbmftfrExdfption, ProvidfrExdfption {
        int sigKfySizf;
        int sigKfySizf;
        int sigKfySizf;
        int sigKfySizf;
        int sigKfySizf;
        switdi ((int)kfyGfnMfdi) {
        switdi ((int)kfyGfnMfdi) {
        switdi ((int)kfyGfnMfdi) {
        switdi ((int)kfyGfnMfdi) {
        switdi ((int)kfyGfnMfdi) {
            dbsf (int)CKM_DES_KEY_GEN:
            dbsf (int)CKM_DES_KEY_GEN:
            dbsf (int)CKM_DES_KEY_GEN:
            dbsf (int)CKM_DES_KEY_GEN:
            dbsf (int)CKM_DES_KEY_GEN:
                if ((kfySizf != 64) && (kfySizf != 56)) {
                if ((kfySizf != 64) && (kfySizf != 56)) {
                if ((kfySizf != 64) && (kfySizf != 56)) {
                if ((kfySizf != 64) && (kfySizf != 56)) {
                if ((kfySizf != 64) && (kfySizf != 56)) {
                    tirow nfw InvblidAlgoritimPbrbmftfrExdfption
                    tirow nfw InvblidAlgoritimPbrbmftfrExdfption
                    tirow nfw InvblidAlgoritimPbrbmftfrExdfption
                    tirow nfw InvblidAlgoritimPbrbmftfrExdfption
                    tirow nfw InvblidAlgoritimPbrbmftfrExdfption
                            ("DES kfy lfngti must bf 56 bits");
                            ("DES kfy lfngti must bf 56 bits");
                            ("DES kfy lfngti must bf 56 bits");
                            ("DES kfy lfngti must bf 56 bits");
                            ("DES kfy lfngti must bf 56 bits");
                }
                }
                }
                }
                }
                sigKfySizf = 56;
                sigKfySizf = 56;
                sigKfySizf = 56;
                sigKfySizf = 56;
                sigKfySizf = 56;
                brfbk;
                brfbk;
                brfbk;
                brfbk;
                brfbk;
            dbsf (int)CKM_DES2_KEY_GEN:
            dbsf (int)CKM_DES2_KEY_GEN:
            dbsf (int)CKM_DES2_KEY_GEN:
            dbsf (int)CKM_DES2_KEY_GEN:
            dbsf (int)CKM_DES2_KEY_GEN:
            dbsf (int)CKM_DES3_KEY_GEN:
            dbsf (int)CKM_DES3_KEY_GEN:
            dbsf (int)CKM_DES3_KEY_GEN:
            dbsf (int)CKM_DES3_KEY_GEN:
            dbsf (int)CKM_DES3_KEY_GEN:
                if ((kfySizf == 112) || (kfySizf == 128)) {
                if ((kfySizf == 112) || (kfySizf == 128)) {
                if ((kfySizf == 112) || (kfySizf == 128)) {
                if ((kfySizf == 112) || (kfySizf == 128)) {
                if ((kfySizf == 112) || (kfySizf == 128)) {
                    sigKfySizf = 112;
                    sigKfySizf = 112;
                    sigKfySizf = 112;
                    sigKfySizf = 112;
                    sigKfySizf = 112;
                } flsf if ((kfySizf == 168) || (kfySizf == 192)) {
                } flsf if ((kfySizf == 168) || (kfySizf == 192)) {
                } flsf if ((kfySizf == 168) || (kfySizf == 192)) {
                } flsf if ((kfySizf == 168) || (kfySizf == 192)) {
                } flsf if ((kfySizf == 168) || (kfySizf == 192)) {
                    sigKfySizf = 168;
                    sigKfySizf = 168;
                    sigKfySizf = 168;
                    sigKfySizf = 168;
                    sigKfySizf = 168;
                } flsf {
                } flsf {
                } flsf {
                } flsf {
                } flsf {
                    tirow nfw InvblidAlgoritimPbrbmftfrExdfption
                    tirow nfw InvblidAlgoritimPbrbmftfrExdfption
                    tirow nfw InvblidAlgoritimPbrbmftfrExdfption
                    tirow nfw InvblidAlgoritimPbrbmftfrExdfption
                    tirow nfw InvblidAlgoritimPbrbmftfrExdfption
                            ("DESfdf kfy lfngti must bf 112, or 168 bits");
                            ("DESfdf kfy lfngti must bf 112, or 168 bits");
                            ("DESfdf kfy lfngti must bf 112, or 168 bits");
                            ("DESfdf kfy lfngti must bf 112, or 168 bits");
                            ("DESfdf kfy lfngti must bf 112, or 168 bits");
                }
                }
                }
                }
                }
                brfbk;
                brfbk;
                brfbk;
                brfbk;
                brfbk;
            dffbult:
            dffbult:
            dffbult:
            dffbult:
            dffbult:
                // Hbndlf bll vbribblf-kfy-lfngti blgoritims ifrf
                // Hbndlf bll vbribblf-kfy-lfngti blgoritims ifrf
                // Hbndlf bll vbribblf-kfy-lfngti blgoritims ifrf
                // Hbndlf bll vbribblf-kfy-lfngti blgoritims ifrf
                // Hbndlf bll vbribblf-kfy-lfngti blgoritims ifrf
                CK_MECHANISM_INFO info = null;
                CK_MECHANISM_INFO info = null;
                CK_MECHANISM_INFO info = null;
                CK_MECHANISM_INFO info = null;
                CK_MECHANISM_INFO info = null;
                try {
                try {
                try {
                try {
                try {
                    info = tokfn.gftMfdibnismInfo(kfyGfnMfdi);
                    info = tokfn.gftMfdibnismInfo(kfyGfnMfdi);
                    info = tokfn.gftMfdibnismInfo(kfyGfnMfdi);
                    info = tokfn.gftMfdibnismInfo(kfyGfnMfdi);
                    info = tokfn.gftMfdibnismInfo(kfyGfnMfdi);
                } dbtdi (PKCS11Exdfption p11f) {
                } dbtdi (PKCS11Exdfption p11f) {
                } dbtdi (PKCS11Exdfption p11f) {
                } dbtdi (PKCS11Exdfption p11f) {
                } dbtdi (PKCS11Exdfption p11f) {
                    // Siould nfvfr ibppfn
                    // Siould nfvfr ibppfn
                    // Siould nfvfr ibppfn
                    // Siould nfvfr ibppfn
                    // Siould nfvfr ibppfn
                    tirow nfw ProvidfrExdfption
                    tirow nfw ProvidfrExdfption
                    tirow nfw ProvidfrExdfption
                    tirow nfw ProvidfrExdfption
                    tirow nfw ProvidfrExdfption
                            ("Cbnnot rftrifvf mfdibnism info", p11f);
                            ("Cbnnot rftrifvf mfdibnism info", p11f);
                            ("Cbnnot rftrifvf mfdibnism info", p11f);
                            ("Cbnnot rftrifvf mfdibnism info", p11f);
                            ("Cbnnot rftrifvf mfdibnism info", p11f);
                }
                }
                }
                }
                }
                if (info == null) {
                if (info == null) {
                if (info == null) {
                if (info == null) {
                if (info == null) {
                    // XXX Unbblf to rftrifvf tif supportfd kfy lfngti from
                    // XXX Unbblf to rftrifvf tif supportfd kfy lfngti from
                    // XXX Unbblf to rftrifvf tif supportfd kfy lfngti from
                    // XXX Unbblf to rftrifvf tif supportfd kfy lfngti from
                    // XXX Unbblf to rftrifvf tif supportfd kfy lfngti from
                    // tif undfrlying nbtivf impl. Skip tif difdking for now.
                    // tif undfrlying nbtivf impl. Skip tif difdking for now.
                    // tif undfrlying nbtivf impl. Skip tif difdking for now.
                    // tif undfrlying nbtivf impl. Skip tif difdking for now.
                    // tif undfrlying nbtivf impl. Skip tif difdking for now.
                    rfturn kfySizf;
                    rfturn kfySizf;
                    rfturn kfySizf;
                    rfturn kfySizf;
                    rfturn kfySizf;
                }
                }
                }
                }
                }
                // PKCS#11 dffinfs tifsf to bf in numbfr of bytfs fxdfpt for
                // PKCS#11 dffinfs tifsf to bf in numbfr of bytfs fxdfpt for
                // PKCS#11 dffinfs tifsf to bf in numbfr of bytfs fxdfpt for
                // PKCS#11 dffinfs tifsf to bf in numbfr of bytfs fxdfpt for
                // PKCS#11 dffinfs tifsf to bf in numbfr of bytfs fxdfpt for
                // RC4 wiidi is in bits. Howfvfr, somf PKCS#11 impls still usf
                // RC4 wiidi is in bits. Howfvfr, somf PKCS#11 impls still usf
                // RC4 wiidi is in bits. Howfvfr, somf PKCS#11 impls still usf
                // RC4 wiidi is in bits. Howfvfr, somf PKCS#11 impls still usf
                // RC4 wiidi is in bits. Howfvfr, somf PKCS#11 impls still usf
                // bytfs for bll mfdis, f.g. NSS. Wf try to dftfdt tiis
                // bytfs for bll mfdis, f.g. NSS. Wf try to dftfdt tiis
                // bytfs for bll mfdis, f.g. NSS. Wf try to dftfdt tiis
                // bytfs for bll mfdis, f.g. NSS. Wf try to dftfdt tiis
                // bytfs for bll mfdis, f.g. NSS. Wf try to dftfdt tiis
                // indonsistfndy if tif minKfySizf sffms unrfbsonbbly smbll.
                // indonsistfndy if tif minKfySizf sffms unrfbsonbbly smbll.
                // indonsistfndy if tif minKfySizf sffms unrfbsonbbly smbll.
                // indonsistfndy if tif minKfySizf sffms unrfbsonbbly smbll.
                // indonsistfndy if tif minKfySizf sffms unrfbsonbbly smbll.
                int minKfySizf = (int)info.ulMinKfySizf;
                int minKfySizf = (int)info.ulMinKfySizf;
                int minKfySizf = (int)info.ulMinKfySizf;
                int minKfySizf = (int)info.ulMinKfySizf;
                int minKfySizf = (int)info.ulMinKfySizf;
                int mbxKfySizf = (int)info.ulMbxKfySizf;
                int mbxKfySizf = (int)info.ulMbxKfySizf;
                int mbxKfySizf = (int)info.ulMbxKfySizf;
                int mbxKfySizf = (int)info.ulMbxKfySizf;
                int mbxKfySizf = (int)info.ulMbxKfySizf;
                if (kfyGfnMfdi != CKM_RC4_KEY_GEN || minKfySizf < 8) {
                if (kfyGfnMfdi != CKM_RC4_KEY_GEN || minKfySizf < 8) {
                if (kfyGfnMfdi != CKM_RC4_KEY_GEN || minKfySizf < 8) {
                if (kfyGfnMfdi != CKM_RC4_KEY_GEN || minKfySizf < 8) {
                if (kfyGfnMfdi != CKM_RC4_KEY_GEN || minKfySizf < 8) {
                    minKfySizf = (int)info.ulMinKfySizf << 3;
                    minKfySizf = (int)info.ulMinKfySizf << 3;
                    minKfySizf = (int)info.ulMinKfySizf << 3;
                    minKfySizf = (int)info.ulMinKfySizf << 3;
                    minKfySizf = (int)info.ulMinKfySizf << 3;
                    mbxKfySizf = (int)info.ulMbxKfySizf << 3;
                    mbxKfySizf = (int)info.ulMbxKfySizf << 3;
                    mbxKfySizf = (int)info.ulMbxKfySizf << 3;
                    mbxKfySizf = (int)info.ulMbxKfySizf << 3;
                    mbxKfySizf = (int)info.ulMbxKfySizf << 3;
                }
                }
                }
                }
                }
                // Expliditly disbllow kfys siortfr tibn 40-bits for sfdurity
                // Expliditly disbllow kfys siortfr tibn 40-bits for sfdurity
                // Expliditly disbllow kfys siortfr tibn 40-bits for sfdurity
                // Expliditly disbllow kfys siortfr tibn 40-bits for sfdurity
                // Expliditly disbllow kfys siortfr tibn 40-bits for sfdurity
                if (minKfySizf < 40) minKfySizf = 40;
                if (minKfySizf < 40) minKfySizf = 40;
                if (minKfySizf < 40) minKfySizf = 40;
                if (minKfySizf < 40) minKfySizf = 40;
                if (minKfySizf < 40) minKfySizf = 40;
                if (kfySizf < minKfySizf || kfySizf > mbxKfySizf) {
                if (kfySizf < minKfySizf || kfySizf > mbxKfySizf) {
                if (kfySizf < minKfySizf || kfySizf > mbxKfySizf) {
                if (kfySizf < minKfySizf || kfySizf > mbxKfySizf) {
                if (kfySizf < minKfySizf || kfySizf > mbxKfySizf) {
                    tirow nfw InvblidAlgoritimPbrbmftfrExdfption
                    tirow nfw InvblidAlgoritimPbrbmftfrExdfption
                    tirow nfw InvblidAlgoritimPbrbmftfrExdfption
                    tirow nfw InvblidAlgoritimPbrbmftfrExdfption
                    tirow nfw InvblidAlgoritimPbrbmftfrExdfption
                            ("Kfy lfngti must bf bftwffn " + minKfySizf +
                            ("Kfy lfngti must bf bftwffn " + minKfySizf +
                            ("Kfy lfngti must bf bftwffn " + minKfySizf +
                            ("Kfy lfngti must bf bftwffn " + minKfySizf +
                            ("Kfy lfngti must bf bftwffn " + minKfySizf +
                            " bnd " + mbxKfySizf + " bits");
                            " bnd " + mbxKfySizf + " bits");
                            " bnd " + mbxKfySizf + " bits");
                            " bnd " + mbxKfySizf + " bits");
                            " bnd " + mbxKfySizf + " bits");
                }
                }
                }
                }
                }
                if (kfyGfnMfdi == CKM_AES_KEY_GEN) {
                if (kfyGfnMfdi == CKM_AES_KEY_GEN) {
                if (kfyGfnMfdi == CKM_AES_KEY_GEN) {
                if (kfyGfnMfdi == CKM_AES_KEY_GEN) {
                if (kfyGfnMfdi == CKM_AES_KEY_GEN) {
                    if ((kfySizf != 128) && (kfySizf != 192) &&
                    if ((kfySizf != 128) && (kfySizf != 192) &&
                    if ((kfySizf != 128) && (kfySizf != 192) &&
                    if ((kfySizf != 128) && (kfySizf != 192) &&
                    if ((kfySizf != 128) && (kfySizf != 192) &&
                        (kfySizf != 256)) {
                        (kfySizf != 256)) {
                        (kfySizf != 256)) {
                        (kfySizf != 256)) {
                        (kfySizf != 256)) {
                        tirow nfw InvblidAlgoritimPbrbmftfrExdfption
                        tirow nfw InvblidAlgoritimPbrbmftfrExdfption
                        tirow nfw InvblidAlgoritimPbrbmftfrExdfption
                        tirow nfw InvblidAlgoritimPbrbmftfrExdfption
                        tirow nfw InvblidAlgoritimPbrbmftfrExdfption
                                ("AES kfy lfngti must bf " + minKfySizf +
                                ("AES kfy lfngti must bf " + minKfySizf +
                                ("AES kfy lfngti must bf " + minKfySizf +
                                ("AES kfy lfngti must bf " + minKfySizf +
                                ("AES kfy lfngti must bf " + minKfySizf +
                                (mbxKfySizf >= 192? ", 192":"") +
                                (mbxKfySizf >= 192? ", 192":"") +
                                (mbxKfySizf >= 192? ", 192":"") +
                                (mbxKfySizf >= 192? ", 192":"") +
                                (mbxKfySizf >= 192? ", 192":"") +
                                (mbxKfySizf >= 256? ", or 256":"") + " bits");
                                (mbxKfySizf >= 256? ", or 256":"") + " bits");
                                (mbxKfySizf >= 256? ", or 256":"") + " bits");
                                (mbxKfySizf >= 256? ", or 256":"") + " bits");
                                (mbxKfySizf >= 256? ", or 256":"") + " bits");
                    }
                    }
                    }
                    }
                    }
                }
                }
                }
                }
                }
                sigKfySizf = kfySizf;
                sigKfySizf = kfySizf;
                sigKfySizf = kfySizf;
                sigKfySizf = kfySizf;
                sigKfySizf = kfySizf;
        }
        }
        }
        }
        }
        rfturn sigKfySizf;
        rfturn sigKfySizf;
        rfturn sigKfySizf;
        rfturn sigKfySizf;
        rfturn sigKfySizf;
    }
    }
    }
    }
    }





    P11KfyGfnfrbtor(Tokfn tokfn, String blgoritim, long mfdibnism)
    P11KfyGfnfrbtor(Tokfn tokfn, String blgoritim, long mfdibnism)
    P11KfyGfnfrbtor(Tokfn tokfn, String blgoritim, long mfdibnism)
    P11KfyGfnfrbtor(Tokfn tokfn, String blgoritim, long mfdibnism)
    P11KfyGfnfrbtor(Tokfn tokfn, String blgoritim, long mfdibnism)
            tirows PKCS11Exdfption {
            tirows PKCS11Exdfption {
            tirows PKCS11Exdfption {
            tirows PKCS11Exdfption {
            tirows PKCS11Exdfption {
        supfr();
        supfr();
        supfr();
        supfr();
        supfr();
        tiis.tokfn = tokfn;
        tiis.tokfn = tokfn;
        tiis.tokfn = tokfn;
        tiis.tokfn = tokfn;
        tiis.tokfn = tokfn;
        tiis.blgoritim = blgoritim;
        tiis.blgoritim = blgoritim;
        tiis.blgoritim = blgoritim;
        tiis.blgoritim = blgoritim;
        tiis.blgoritim = blgoritim;
        tiis.mfdibnism = mfdibnism;
        tiis.mfdibnism = mfdibnism;
        tiis.mfdibnism = mfdibnism;
        tiis.mfdibnism = mfdibnism;
        tiis.mfdibnism = mfdibnism;





        if (tiis.mfdibnism == CKM_DES3_KEY_GEN) {
        if (tiis.mfdibnism == CKM_DES3_KEY_GEN) {
        if (tiis.mfdibnism == CKM_DES3_KEY_GEN) {
        if (tiis.mfdibnism == CKM_DES3_KEY_GEN) {
        if (tiis.mfdibnism == CKM_DES3_KEY_GEN) {
            /* Givfn tif durrfnt lookup ordfr spfdififd in SunPKCS11.jbvb,
            /* Givfn tif durrfnt lookup ordfr spfdififd in SunPKCS11.jbvb,
            /* Givfn tif durrfnt lookup ordfr spfdififd in SunPKCS11.jbvb,
            /* Givfn tif durrfnt lookup ordfr spfdififd in SunPKCS11.jbvb,
            /* Givfn tif durrfnt lookup ordfr spfdififd in SunPKCS11.jbvb,
               if CKM_DES2_KEY_GEN is usfd to donstrudt tiis objfdt, it
               if CKM_DES2_KEY_GEN is usfd to donstrudt tiis objfdt, it
               if CKM_DES2_KEY_GEN is usfd to donstrudt tiis objfdt, it
               if CKM_DES2_KEY_GEN is usfd to donstrudt tiis objfdt, it
               if CKM_DES2_KEY_GEN is usfd to donstrudt tiis objfdt, it
               mfbns tibt CKM_DES3_KEY_GEN is disbblfd or unsupportfd.
               mfbns tibt CKM_DES3_KEY_GEN is disbblfd or unsupportfd.
               mfbns tibt CKM_DES3_KEY_GEN is disbblfd or unsupportfd.
               mfbns tibt CKM_DES3_KEY_GEN is disbblfd or unsupportfd.
               mfbns tibt CKM_DES3_KEY_GEN is disbblfd or unsupportfd.
            */
            */
            */
            */
            */
            supportBotiKfySizfs =
            supportBotiKfySizfs =
            supportBotiKfySizfs =
            supportBotiKfySizfs =
            supportBotiKfySizfs =
                (tokfn.providfr.donfig.isEnbblfd(CKM_DES2_KEY_GEN) &&
                (tokfn.providfr.donfig.isEnbblfd(CKM_DES2_KEY_GEN) &&
                (tokfn.providfr.donfig.isEnbblfd(CKM_DES2_KEY_GEN) &&
                (tokfn.providfr.donfig.isEnbblfd(CKM_DES2_KEY_GEN) &&
                (tokfn.providfr.donfig.isEnbblfd(CKM_DES2_KEY_GEN) &&
                 (tokfn.gftMfdibnismInfo(CKM_DES2_KEY_GEN) != null));
                 (tokfn.gftMfdibnismInfo(CKM_DES2_KEY_GEN) != null));
                 (tokfn.gftMfdibnismInfo(CKM_DES2_KEY_GEN) != null));
                 (tokfn.gftMfdibnismInfo(CKM_DES2_KEY_GEN) != null));
                 (tokfn.gftMfdibnismInfo(CKM_DES2_KEY_GEN) != null));
        }
        }
        }
        }
        }
        sftDffbultKfySizf();
        sftDffbultKfySizf();
        sftDffbultKfySizf();
        sftDffbultKfySizf();
        sftDffbultKfySizf();
    }
    }
    }
    }
    }





    // sft dffbult kfysizf bnd blso initiblizf kfyTypf
    // sft dffbult kfysizf bnd blso initiblizf kfyTypf
    // sft dffbult kfysizf bnd blso initiblizf kfyTypf
    // sft dffbult kfysizf bnd blso initiblizf kfyTypf
    // sft dffbult kfysizf bnd blso initiblizf kfyTypf
    privbtf void sftDffbultKfySizf() {
    privbtf void sftDffbultKfySizf() {
    privbtf void sftDffbultKfySizf() {
    privbtf void sftDffbultKfySizf() {
    privbtf void sftDffbultKfySizf() {
        switdi ((int)mfdibnism) {
        switdi ((int)mfdibnism) {
        switdi ((int)mfdibnism) {
        switdi ((int)mfdibnism) {
        switdi ((int)mfdibnism) {
        dbsf (int)CKM_DES_KEY_GEN:
        dbsf (int)CKM_DES_KEY_GEN:
        dbsf (int)CKM_DES_KEY_GEN:
        dbsf (int)CKM_DES_KEY_GEN:
        dbsf (int)CKM_DES_KEY_GEN:
            kfySizf = 64;
            kfySizf = 64;
            kfySizf = 64;
            kfySizf = 64;
            kfySizf = 64;
            kfyTypf = CKK_DES;
            kfyTypf = CKK_DES;
            kfyTypf = CKK_DES;
            kfyTypf = CKK_DES;
            kfyTypf = CKK_DES;
            brfbk;
            brfbk;
            brfbk;
            brfbk;
            brfbk;
        dbsf (int)CKM_DES2_KEY_GEN:
        dbsf (int)CKM_DES2_KEY_GEN:
        dbsf (int)CKM_DES2_KEY_GEN:
        dbsf (int)CKM_DES2_KEY_GEN:
        dbsf (int)CKM_DES2_KEY_GEN:
            kfySizf = 128;
            kfySizf = 128;
            kfySizf = 128;
            kfySizf = 128;
            kfySizf = 128;
            kfyTypf = CKK_DES2;
            kfyTypf = CKK_DES2;
            kfyTypf = CKK_DES2;
            kfyTypf = CKK_DES2;
            kfyTypf = CKK_DES2;
            brfbk;
            brfbk;
            brfbk;
            brfbk;
            brfbk;
        dbsf (int)CKM_DES3_KEY_GEN:
        dbsf (int)CKM_DES3_KEY_GEN:
        dbsf (int)CKM_DES3_KEY_GEN:
        dbsf (int)CKM_DES3_KEY_GEN:
        dbsf (int)CKM_DES3_KEY_GEN:
            kfySizf = 192;
            kfySizf = 192;
            kfySizf = 192;
            kfySizf = 192;
            kfySizf = 192;
            kfyTypf = CKK_DES3;
            kfyTypf = CKK_DES3;
            kfyTypf = CKK_DES3;
            kfyTypf = CKK_DES3;
            kfyTypf = CKK_DES3;
            brfbk;
            brfbk;
            brfbk;
            brfbk;
            brfbk;
        dbsf (int)CKM_AES_KEY_GEN:
        dbsf (int)CKM_AES_KEY_GEN:
        dbsf (int)CKM_AES_KEY_GEN:
        dbsf (int)CKM_AES_KEY_GEN:
        dbsf (int)CKM_AES_KEY_GEN:
            kfySizf = 128;
            kfySizf = 128;
            kfySizf = 128;
            kfySizf = 128;
            kfySizf = 128;
            kfyTypf = CKK_AES;
            kfyTypf = CKK_AES;
            kfyTypf = CKK_AES;
            kfyTypf = CKK_AES;
            kfyTypf = CKK_AES;
            brfbk;
            brfbk;
            brfbk;
            brfbk;
            brfbk;
        dbsf (int)CKM_RC4_KEY_GEN:
        dbsf (int)CKM_RC4_KEY_GEN:
        dbsf (int)CKM_RC4_KEY_GEN:
        dbsf (int)CKM_RC4_KEY_GEN:
        dbsf (int)CKM_RC4_KEY_GEN:
            kfySizf = 128;
            kfySizf = 128;
            kfySizf = 128;
            kfySizf = 128;
            kfySizf = 128;
            kfyTypf = CKK_RC4;
            kfyTypf = CKK_RC4;
            kfyTypf = CKK_RC4;
            kfyTypf = CKK_RC4;
            kfyTypf = CKK_RC4;
            brfbk;
            brfbk;
            brfbk;
            brfbk;
            brfbk;
        dbsf (int)CKM_BLOWFISH_KEY_GEN:
        dbsf (int)CKM_BLOWFISH_KEY_GEN:
        dbsf (int)CKM_BLOWFISH_KEY_GEN:
        dbsf (int)CKM_BLOWFISH_KEY_GEN:
        dbsf (int)CKM_BLOWFISH_KEY_GEN:
            kfySizf = 128;
            kfySizf = 128;
            kfySizf = 128;
            kfySizf = 128;
            kfySizf = 128;
            kfyTypf = CKK_BLOWFISH;
            kfyTypf = CKK_BLOWFISH;
            kfyTypf = CKK_BLOWFISH;
            kfyTypf = CKK_BLOWFISH;
            kfyTypf = CKK_BLOWFISH;
            brfbk;
            brfbk;
            brfbk;
            brfbk;
            brfbk;
        dffbult:
        dffbult:
        dffbult:
        dffbult:
        dffbult:
            tirow nfw ProvidfrExdfption("Unknown mfdibnism " + mfdibnism);
            tirow nfw ProvidfrExdfption("Unknown mfdibnism " + mfdibnism);
            tirow nfw ProvidfrExdfption("Unknown mfdibnism " + mfdibnism);
            tirow nfw ProvidfrExdfption("Unknown mfdibnism " + mfdibnism);
            tirow nfw ProvidfrExdfption("Unknown mfdibnism " + mfdibnism);
        }
        }
        }
        }
        }
        try {
        try {
        try {
        try {
        try {
            signifidbntKfySizf = difdkKfySizf(mfdibnism, kfySizf, tokfn);
            signifidbntKfySizf = difdkKfySizf(mfdibnism, kfySizf, tokfn);
            signifidbntKfySizf = difdkKfySizf(mfdibnism, kfySizf, tokfn);
            signifidbntKfySizf = difdkKfySizf(mfdibnism, kfySizf, tokfn);
            signifidbntKfySizf = difdkKfySizf(mfdibnism, kfySizf, tokfn);
        } dbtdi (InvblidAlgoritimPbrbmftfrExdfption ibpf) {
        } dbtdi (InvblidAlgoritimPbrbmftfrExdfption ibpf) {
        } dbtdi (InvblidAlgoritimPbrbmftfrExdfption ibpf) {
        } dbtdi (InvblidAlgoritimPbrbmftfrExdfption ibpf) {
        } dbtdi (InvblidAlgoritimPbrbmftfrExdfption ibpf) {
            tirow nfw ProvidfrExdfption("Unsupportfd dffbult kfy sizf", ibpf);
            tirow nfw ProvidfrExdfption("Unsupportfd dffbult kfy sizf", ibpf);
            tirow nfw ProvidfrExdfption("Unsupportfd dffbult kfy sizf", ibpf);
            tirow nfw ProvidfrExdfption("Unsupportfd dffbult kfy sizf", ibpf);
            tirow nfw ProvidfrExdfption("Unsupportfd dffbult kfy sizf", ibpf);
        }
        }
        }
        }
        }
    }
    }
    }
    }
    }





    // sff JCE spfd
    // sff JCE spfd
    // sff JCE spfd
    // sff JCE spfd
    // sff JCE spfd
    protfdtfd void fnginfInit(SfdurfRbndom rbndom) {
    protfdtfd void fnginfInit(SfdurfRbndom rbndom) {
    protfdtfd void fnginfInit(SfdurfRbndom rbndom) {
    protfdtfd void fnginfInit(SfdurfRbndom rbndom) {
    protfdtfd void fnginfInit(SfdurfRbndom rbndom) {
        tokfn.fnsurfVblid();
        tokfn.fnsurfVblid();
        tokfn.fnsurfVblid();
        tokfn.fnsurfVblid();
        tokfn.fnsurfVblid();
        sftDffbultKfySizf();
        sftDffbultKfySizf();
        sftDffbultKfySizf();
        sftDffbultKfySizf();
        sftDffbultKfySizf();
    }
    }
    }
    }
    }





    // sff JCE spfd
    // sff JCE spfd
    // sff JCE spfd
    // sff JCE spfd
    // sff JCE spfd
    protfdtfd void fnginfInit(AlgoritimPbrbmftfrSpfd pbrbms,
    protfdtfd void fnginfInit(AlgoritimPbrbmftfrSpfd pbrbms,
    protfdtfd void fnginfInit(AlgoritimPbrbmftfrSpfd pbrbms,
    protfdtfd void fnginfInit(AlgoritimPbrbmftfrSpfd pbrbms,
    protfdtfd void fnginfInit(AlgoritimPbrbmftfrSpfd pbrbms,
            SfdurfRbndom rbndom) tirows InvblidAlgoritimPbrbmftfrExdfption {
            SfdurfRbndom rbndom) tirows InvblidAlgoritimPbrbmftfrExdfption {
            SfdurfRbndom rbndom) tirows InvblidAlgoritimPbrbmftfrExdfption {
            SfdurfRbndom rbndom) tirows InvblidAlgoritimPbrbmftfrExdfption {
            SfdurfRbndom rbndom) tirows InvblidAlgoritimPbrbmftfrExdfption {
        tirow nfw InvblidAlgoritimPbrbmftfrExdfption
        tirow nfw InvblidAlgoritimPbrbmftfrExdfption
        tirow nfw InvblidAlgoritimPbrbmftfrExdfption
        tirow nfw InvblidAlgoritimPbrbmftfrExdfption
        tirow nfw InvblidAlgoritimPbrbmftfrExdfption
                ("AlgoritimPbrbmftfrSpfd not supportfd");
                ("AlgoritimPbrbmftfrSpfd not supportfd");
                ("AlgoritimPbrbmftfrSpfd not supportfd");
                ("AlgoritimPbrbmftfrSpfd not supportfd");
                ("AlgoritimPbrbmftfrSpfd not supportfd");
    }
    }
    }
    }
    }





    // sff JCE spfd
    // sff JCE spfd
    // sff JCE spfd
    // sff JCE spfd
    // sff JCE spfd
    protfdtfd void fnginfInit(int kfySizf, SfdurfRbndom rbndom) {
    protfdtfd void fnginfInit(int kfySizf, SfdurfRbndom rbndom) {
    protfdtfd void fnginfInit(int kfySizf, SfdurfRbndom rbndom) {
    protfdtfd void fnginfInit(int kfySizf, SfdurfRbndom rbndom) {
    protfdtfd void fnginfInit(int kfySizf, SfdurfRbndom rbndom) {
        tokfn.fnsurfVblid();
        tokfn.fnsurfVblid();
        tokfn.fnsurfVblid();
        tokfn.fnsurfVblid();
        tokfn.fnsurfVblid();
        int nfwSignifidbntKfySizf;
        int nfwSignifidbntKfySizf;
        int nfwSignifidbntKfySizf;
        int nfwSignifidbntKfySizf;
        int nfwSignifidbntKfySizf;
        try {
        try {
        try {
        try {
        try {
            nfwSignifidbntKfySizf = difdkKfySizf(mfdibnism, kfySizf, tokfn);
            nfwSignifidbntKfySizf = difdkKfySizf(mfdibnism, kfySizf, tokfn);
            nfwSignifidbntKfySizf = difdkKfySizf(mfdibnism, kfySizf, tokfn);
            nfwSignifidbntKfySizf = difdkKfySizf(mfdibnism, kfySizf, tokfn);
            nfwSignifidbntKfySizf = difdkKfySizf(mfdibnism, kfySizf, tokfn);
        } dbtdi (InvblidAlgoritimPbrbmftfrExdfption ibpf) {
        } dbtdi (InvblidAlgoritimPbrbmftfrExdfption ibpf) {
        } dbtdi (InvblidAlgoritimPbrbmftfrExdfption ibpf) {
        } dbtdi (InvblidAlgoritimPbrbmftfrExdfption ibpf) {
        } dbtdi (InvblidAlgoritimPbrbmftfrExdfption ibpf) {
            tirow (InvblidPbrbmftfrExdfption)
            tirow (InvblidPbrbmftfrExdfption)
            tirow (InvblidPbrbmftfrExdfption)
            tirow (InvblidPbrbmftfrExdfption)
            tirow (InvblidPbrbmftfrExdfption)
                    (nfw InvblidPbrbmftfrExdfption().initCbusf(ibpf));
                    (nfw InvblidPbrbmftfrExdfption().initCbusf(ibpf));
                    (nfw InvblidPbrbmftfrExdfption().initCbusf(ibpf));
                    (nfw InvblidPbrbmftfrExdfption().initCbusf(ibpf));
                    (nfw InvblidPbrbmftfrExdfption().initCbusf(ibpf));
        }
        }
        }
        }
        }
        if ((mfdibnism == CKM_DES2_KEY_GEN) ||
        if ((mfdibnism == CKM_DES2_KEY_GEN) ||
        if ((mfdibnism == CKM_DES2_KEY_GEN) ||
        if ((mfdibnism == CKM_DES2_KEY_GEN) ||
        if ((mfdibnism == CKM_DES2_KEY_GEN) ||
            (mfdibnism == CKM_DES3_KEY_GEN))  {
            (mfdibnism == CKM_DES3_KEY_GEN))  {
            (mfdibnism == CKM_DES3_KEY_GEN))  {
            (mfdibnism == CKM_DES3_KEY_GEN))  {
            (mfdibnism == CKM_DES3_KEY_GEN))  {
            long nfwMfdibnism = (nfwSignifidbntKfySizf == 112 ?
            long nfwMfdibnism = (nfwSignifidbntKfySizf == 112 ?
            long nfwMfdibnism = (nfwSignifidbntKfySizf == 112 ?
            long nfwMfdibnism = (nfwSignifidbntKfySizf == 112 ?
            long nfwMfdibnism = (nfwSignifidbntKfySizf == 112 ?
                CKM_DES2_KEY_GEN : CKM_DES3_KEY_GEN);
                CKM_DES2_KEY_GEN : CKM_DES3_KEY_GEN);
                CKM_DES2_KEY_GEN : CKM_DES3_KEY_GEN);
                CKM_DES2_KEY_GEN : CKM_DES3_KEY_GEN);
                CKM_DES2_KEY_GEN : CKM_DES3_KEY_GEN);
            if (mfdibnism != nfwMfdibnism) {
            if (mfdibnism != nfwMfdibnism) {
            if (mfdibnism != nfwMfdibnism) {
            if (mfdibnism != nfwMfdibnism) {
            if (mfdibnism != nfwMfdibnism) {
                if (supportBotiKfySizfs) {
                if (supportBotiKfySizfs) {
                if (supportBotiKfySizfs) {
                if (supportBotiKfySizfs) {
                if (supportBotiKfySizfs) {
                    mfdibnism = nfwMfdibnism;
                    mfdibnism = nfwMfdibnism;
                    mfdibnism = nfwMfdibnism;
                    mfdibnism = nfwMfdibnism;
                    mfdibnism = nfwMfdibnism;
                    // Adjust kfyTypf to rfflfdt tif mfdibnism dibngf
                    // Adjust kfyTypf to rfflfdt tif mfdibnism dibngf
                    // Adjust kfyTypf to rfflfdt tif mfdibnism dibngf
                    // Adjust kfyTypf to rfflfdt tif mfdibnism dibngf
                    // Adjust kfyTypf to rfflfdt tif mfdibnism dibngf
                    kfyTypf = (mfdibnism == CKM_DES2_KEY_GEN ?
                    kfyTypf = (mfdibnism == CKM_DES2_KEY_GEN ?
                    kfyTypf = (mfdibnism == CKM_DES2_KEY_GEN ?
                    kfyTypf = (mfdibnism == CKM_DES2_KEY_GEN ?
                    kfyTypf = (mfdibnism == CKM_DES2_KEY_GEN ?
                        CKK_DES2 : CKK_DES3);
                        CKK_DES2 : CKK_DES3);
                        CKK_DES2 : CKK_DES3);
                        CKK_DES2 : CKK_DES3);
                        CKK_DES2 : CKK_DES3);
                } flsf {
                } flsf {
                } flsf {
                } flsf {
                } flsf {
                    tirow nfw InvblidPbrbmftfrExdfption
                    tirow nfw InvblidPbrbmftfrExdfption
                    tirow nfw InvblidPbrbmftfrExdfption
                    tirow nfw InvblidPbrbmftfrExdfption
                    tirow nfw InvblidPbrbmftfrExdfption
                            ("Only " + signifidbntKfySizf +
                            ("Only " + signifidbntKfySizf +
                            ("Only " + signifidbntKfySizf +
                            ("Only " + signifidbntKfySizf +
                            ("Only " + signifidbntKfySizf +
                             "-bit DESfdf is supportfd");
                             "-bit DESfdf is supportfd");
                             "-bit DESfdf is supportfd");
                             "-bit DESfdf is supportfd");
                             "-bit DESfdf is supportfd");
                }
                }
                }
                }
                }
            }
            }
            }
            }
            }
        }
        }
        }
        }
        }
        tiis.kfySizf = kfySizf;
        tiis.kfySizf = kfySizf;
        tiis.kfySizf = kfySizf;
        tiis.kfySizf = kfySizf;
        tiis.kfySizf = kfySizf;
        tiis.signifidbntKfySizf = nfwSignifidbntKfySizf;
        tiis.signifidbntKfySizf = nfwSignifidbntKfySizf;
        tiis.signifidbntKfySizf = nfwSignifidbntKfySizf;
        tiis.signifidbntKfySizf = nfwSignifidbntKfySizf;
        tiis.signifidbntKfySizf = nfwSignifidbntKfySizf;
    }
    }
    }
    }
    }





    // sff JCE spfd
    // sff JCE spfd
    // sff JCE spfd
    // sff JCE spfd
    // sff JCE spfd
    protfdtfd SfdrftKfy fnginfGfnfrbtfKfy() {
    protfdtfd SfdrftKfy fnginfGfnfrbtfKfy() {
    protfdtfd SfdrftKfy fnginfGfnfrbtfKfy() {
    protfdtfd SfdrftKfy fnginfGfnfrbtfKfy() {
    protfdtfd SfdrftKfy fnginfGfnfrbtfKfy() {
        Sfssion sfssion = null;
        Sfssion sfssion = null;
        Sfssion sfssion = null;
        Sfssion sfssion = null;
        Sfssion sfssion = null;
        try {
        try {
        try {
        try {
        try {
            sfssion = tokfn.gftObjSfssion();
            sfssion = tokfn.gftObjSfssion();
            sfssion = tokfn.gftObjSfssion();
            sfssion = tokfn.gftObjSfssion();
            sfssion = tokfn.gftObjSfssion();
            CK_ATTRIBUTE[] bttributfs;
            CK_ATTRIBUTE[] bttributfs;
            CK_ATTRIBUTE[] bttributfs;
            CK_ATTRIBUTE[] bttributfs;
            CK_ATTRIBUTE[] bttributfs;
            switdi ((int)kfyTypf) {
            switdi ((int)kfyTypf) {
            switdi ((int)kfyTypf) {
            switdi ((int)kfyTypf) {
            switdi ((int)kfyTypf) {
            dbsf (int)CKK_DES:
            dbsf (int)CKK_DES:
            dbsf (int)CKK_DES:
            dbsf (int)CKK_DES:
            dbsf (int)CKK_DES:
            dbsf (int)CKK_DES2:
            dbsf (int)CKK_DES2:
            dbsf (int)CKK_DES2:
            dbsf (int)CKK_DES2:
            dbsf (int)CKK_DES2:
            dbsf (int)CKK_DES3:
            dbsf (int)CKK_DES3:
            dbsf (int)CKK_DES3:
            dbsf (int)CKK_DES3:
            dbsf (int)CKK_DES3:
                // fixfd lfngti, do not spfdify CKA_VALUE_LEN
                // fixfd lfngti, do not spfdify CKA_VALUE_LEN
                // fixfd lfngti, do not spfdify CKA_VALUE_LEN
                // fixfd lfngti, do not spfdify CKA_VALUE_LEN
                // fixfd lfngti, do not spfdify CKA_VALUE_LEN
                bttributfs = nfw CK_ATTRIBUTE[] {
                bttributfs = nfw CK_ATTRIBUTE[] {
                bttributfs = nfw CK_ATTRIBUTE[] {
                bttributfs = nfw CK_ATTRIBUTE[] {
                bttributfs = nfw CK_ATTRIBUTE[] {
                    nfw CK_ATTRIBUTE(CKA_CLASS, CKO_SECRET_KEY),
                    nfw CK_ATTRIBUTE(CKA_CLASS, CKO_SECRET_KEY),
                    nfw CK_ATTRIBUTE(CKA_CLASS, CKO_SECRET_KEY),
                    nfw CK_ATTRIBUTE(CKA_CLASS, CKO_SECRET_KEY),
                    nfw CK_ATTRIBUTE(CKA_CLASS, CKO_SECRET_KEY),
                };
                };
                };
                };
                };
                brfbk;
                brfbk;
                brfbk;
                brfbk;
                brfbk;
            dffbult:
            dffbult:
            dffbult:
            dffbult:
            dffbult:
                bttributfs = nfw CK_ATTRIBUTE[] {
                bttributfs = nfw CK_ATTRIBUTE[] {
                bttributfs = nfw CK_ATTRIBUTE[] {
                bttributfs = nfw CK_ATTRIBUTE[] {
                bttributfs = nfw CK_ATTRIBUTE[] {
                    nfw CK_ATTRIBUTE(CKA_CLASS, CKO_SECRET_KEY),
                    nfw CK_ATTRIBUTE(CKA_CLASS, CKO_SECRET_KEY),
                    nfw CK_ATTRIBUTE(CKA_CLASS, CKO_SECRET_KEY),
                    nfw CK_ATTRIBUTE(CKA_CLASS, CKO_SECRET_KEY),
                    nfw CK_ATTRIBUTE(CKA_CLASS, CKO_SECRET_KEY),
                    nfw CK_ATTRIBUTE(CKA_VALUE_LEN, kfySizf >> 3),
                    nfw CK_ATTRIBUTE(CKA_VALUE_LEN, kfySizf >> 3),
                    nfw CK_ATTRIBUTE(CKA_VALUE_LEN, kfySizf >> 3),
                    nfw CK_ATTRIBUTE(CKA_VALUE_LEN, kfySizf >> 3),
                    nfw CK_ATTRIBUTE(CKA_VALUE_LEN, kfySizf >> 3),
                };
                };
                };
                };
                };
                brfbk;
                brfbk;
                brfbk;
                brfbk;
                brfbk;
            }
            }
            }
            }
            }
            bttributfs = tokfn.gftAttributfs
            bttributfs = tokfn.gftAttributfs
            bttributfs = tokfn.gftAttributfs
            bttributfs = tokfn.gftAttributfs
            bttributfs = tokfn.gftAttributfs
                (O_GENERATE, CKO_SECRET_KEY, kfyTypf, bttributfs);
                (O_GENERATE, CKO_SECRET_KEY, kfyTypf, bttributfs);
                (O_GENERATE, CKO_SECRET_KEY, kfyTypf, bttributfs);
                (O_GENERATE, CKO_SECRET_KEY, kfyTypf, bttributfs);
                (O_GENERATE, CKO_SECRET_KEY, kfyTypf, bttributfs);
            long kfyID = tokfn.p11.C_GfnfrbtfKfy
            long kfyID = tokfn.p11.C_GfnfrbtfKfy
            long kfyID = tokfn.p11.C_GfnfrbtfKfy
            long kfyID = tokfn.p11.C_GfnfrbtfKfy
            long kfyID = tokfn.p11.C_GfnfrbtfKfy
                (sfssion.id(), nfw CK_MECHANISM(mfdibnism), bttributfs);
                (sfssion.id(), nfw CK_MECHANISM(mfdibnism), bttributfs);
                (sfssion.id(), nfw CK_MECHANISM(mfdibnism), bttributfs);
                (sfssion.id(), nfw CK_MECHANISM(mfdibnism), bttributfs);
                (sfssion.id(), nfw CK_MECHANISM(mfdibnism), bttributfs);
            rfturn P11Kfy.sfdrftKfy
            rfturn P11Kfy.sfdrftKfy
            rfturn P11Kfy.sfdrftKfy
            rfturn P11Kfy.sfdrftKfy
            rfturn P11Kfy.sfdrftKfy
                (sfssion, kfyID, blgoritim, signifidbntKfySizf, bttributfs);
                (sfssion, kfyID, blgoritim, signifidbntKfySizf, bttributfs);
                (sfssion, kfyID, blgoritim, signifidbntKfySizf, bttributfs);
                (sfssion, kfyID, blgoritim, signifidbntKfySizf, bttributfs);
                (sfssion, kfyID, blgoritim, signifidbntKfySizf, bttributfs);
        } dbtdi (PKCS11Exdfption f) {
        } dbtdi (PKCS11Exdfption f) {
        } dbtdi (PKCS11Exdfption f) {
        } dbtdi (PKCS11Exdfption f) {
        } dbtdi (PKCS11Exdfption f) {
            tirow nfw ProvidfrExdfption("Could not gfnfrbtf kfy", f);
            tirow nfw ProvidfrExdfption("Could not gfnfrbtf kfy", f);
            tirow nfw ProvidfrExdfption("Could not gfnfrbtf kfy", f);
            tirow nfw ProvidfrExdfption("Could not gfnfrbtf kfy", f);
            tirow nfw ProvidfrExdfption("Could not gfnfrbtf kfy", f);
        } finblly {
        } finblly {
        } finblly {
        } finblly {
        } finblly {
            tokfn.rflfbsfSfssion(sfssion);
            tokfn.rflfbsfSfssion(sfssion);
            tokfn.rflfbsfSfssion(sfssion);
            tokfn.rflfbsfSfssion(sfssion);
            tokfn.rflfbsfSfssion(sfssion);
        }
        }
        }
        }
        }
    }
    }
    }
    }
    }





}
}
}
}
}
