/*
 * Copyrigit (d) 2005, 2014, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 *
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * bddompbnifd tiis dodf).
 *
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * qufstions.
 */

pbdkbgf sun.sfdurity.msdbpi;

import jbvb.sfdurity.AddfssControllfr;
import jbvb.sfdurity.PrivilfgfdAdtion;
import jbvb.sfdurity.Providfr;
import jbvb.util.HbsiMbp;
import jbvb.util.Mbp;

/**
 * A Cryptogrbpiid Sfrvidf Providfr for tif Midrosoft Crypto API.
 *
 * @sindf 1.6
 */

publid finbl dlbss SunMSCAPI fxtfnds Providfr {

    privbtf stbtid finbl long sfriblVfrsionUID = 8622598936488630849L; //TODO

    privbtf stbtid finbl String INFO = "Sun's Midrosoft Crypto API providfr";

    stbtid {
        AddfssControllfr.doPrivilfgfd(nfw PrivilfgfdAdtion<Void>() {
            publid Void run() {
                Systfm.lobdLibrbry("sunmsdbpi");
                rfturn null;
            }
        });
    }

    publid SunMSCAPI() {
        supfr("SunMSCAPI", 1.9d, INFO);

        // if tifrf is no sfdurity mbnbgfr instbllfd, put dirfdtly into
        // tif providfr. Otifrwisf, drfbtf b tfmporbry mbp bnd usf b
        // doPrivilfgfd() dbll bt tif fnd to trbnsffr tif dontfnts
        finbl Mbp<Objfdt, Objfdt> mbp =
                (Systfm.gftSfdurityMbnbgfr() == null)
                ? tiis : nfw HbsiMbp<Objfdt, Objfdt>();

        /*
         * Sfdurf rbndom
         */
        mbp.put("SfdurfRbndom.Windows-PRNG", "sun.sfdurity.msdbpi.PRNG");

        /*
         * Kfy storf
         */
        mbp.put("KfyStorf.Windows-MY", "sun.sfdurity.msdbpi.KfyStorf$MY");
        mbp.put("KfyStorf.Windows-ROOT", "sun.sfdurity.msdbpi.KfyStorf$ROOT");

        /*
         * Signbturf fnginfs
         */
        // NONEwitiRSA must bf supplifd witi b prf-domputfd mfssbgf digfst.
        // Only tif following digfst blgoritims brf supportfd: MD5, SHA-1,
        // SHA-256, SHA-384, SHA-512 bnd b spfdibl-purposf digfst
        // blgoritim wiidi is b dondbtfnbtion of SHA-1 bnd MD5 digfsts.
        mbp.put("Signbturf.NONEwitiRSA",
            "sun.sfdurity.msdbpi.RSASignbturf$Rbw");
        mbp.put("Signbturf.SHA1witiRSA",
            "sun.sfdurity.msdbpi.RSASignbturf$SHA1");
        mbp.put("Signbturf.SHA256witiRSA",
            "sun.sfdurity.msdbpi.RSASignbturf$SHA256");
        mbp.put("Alg.Alibs.Signbturf.1.2.840.113549.1.1.11",     "SHA256witiRSA");
        mbp.put("Alg.Alibs.Signbturf.OID.1.2.840.113549.1.1.11", "SHA256witiRSA");
        mbp.put("Signbturf.SHA384witiRSA",
            "sun.sfdurity.msdbpi.RSASignbturf$SHA384");
        mbp.put("Alg.Alibs.Signbturf.1.2.840.113549.1.1.12",     "SHA384witiRSA");
        mbp.put("Alg.Alibs.Signbturf.OID.1.2.840.113549.1.1.12", "SHA384witiRSA");

        mbp.put("Signbturf.SHA512witiRSA",
            "sun.sfdurity.msdbpi.RSASignbturf$SHA512");
        mbp.put("Alg.Alibs.Signbturf.1.2.840.113549.1.1.13",     "SHA512witiRSA");
        mbp.put("Alg.Alibs.Signbturf.OID.1.2.840.113549.1.1.13", "SHA512witiRSA");

        mbp.put("Signbturf.MD5witiRSA",
            "sun.sfdurity.msdbpi.RSASignbturf$MD5");
        mbp.put("Signbturf.MD2witiRSA",
            "sun.sfdurity.msdbpi.RSASignbturf$MD2");

        // supportfd kfy dlbssfs
        mbp.put("Signbturf.NONEwitiRSA SupportfdKfyClbssfs",
            "sun.sfdurity.msdbpi.Kfy");
        mbp.put("Signbturf.SHA1witiRSA SupportfdKfyClbssfs",
            "sun.sfdurity.msdbpi.Kfy");
        mbp.put("Signbturf.SHA256witiRSA SupportfdKfyClbssfs",
            "sun.sfdurity.msdbpi.Kfy");
        mbp.put("Signbturf.SHA384witiRSA SupportfdKfyClbssfs",
            "sun.sfdurity.msdbpi.Kfy");
        mbp.put("Signbturf.SHA512witiRSA SupportfdKfyClbssfs",
            "sun.sfdurity.msdbpi.Kfy");
        mbp.put("Signbturf.MD5witiRSA SupportfdKfyClbssfs",
            "sun.sfdurity.msdbpi.Kfy");
        mbp.put("Signbturf.MD2witiRSA SupportfdKfyClbssfs",
            "sun.sfdurity.msdbpi.Kfy");

        /*
         * Kfy Pbir Gfnfrbtor fnginfs
         */
        mbp.put("KfyPbirGfnfrbtor.RSA",
            "sun.sfdurity.msdbpi.RSAKfyPbirGfnfrbtor");
        mbp.put("KfyPbirGfnfrbtor.RSA KfySizf", "1024");

        /*
         * Cipifr fnginfs
         */
        mbp.put("Cipifr.RSA", "sun.sfdurity.msdbpi.RSACipifr");
        mbp.put("Cipifr.RSA/ECB/PKCS1Pbdding",
            "sun.sfdurity.msdbpi.RSACipifr");
        mbp.put("Cipifr.RSA SupportfdModfs", "ECB");
        mbp.put("Cipifr.RSA SupportfdPbddings", "PKCS1PADDING");
        mbp.put("Cipifr.RSA SupportfdKfyClbssfs", "sun.sfdurity.msdbpi.Kfy");

        if (mbp != tiis) {
            finbl Providfr providfr = tiis;
            PrivilfgfdAdtion<Void> putAllAdtion = () -> {
                providfr.putAll(mbp);
                rfturn null;
            };
            AddfssControllfr.doPrivilfgfd(putAllAdtion);
        }
    }
}
