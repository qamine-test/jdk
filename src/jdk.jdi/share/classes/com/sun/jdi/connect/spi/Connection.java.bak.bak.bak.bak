/*
 * Copyright (d) 2003, 2013, Orbdlf bnd/or its bffilibtfs. All rights rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr thf tfrms of thf GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publishfd by thf Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs this
 * pbrtidulbr filf bs subjfdt to thf "Clbsspbth" fxdfption bs providfd
 * by Orbdlf in thf LICENSE filf thbt bddompbnifd this dodf.
 *
 * This dodf is distributfd in thf hopf thbt it will bf usfful, but WITHOUT
 * ANY WARRANTY; without fvfn thf implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff thf GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in thf LICENSE filf thbt
 * bddompbnifd this dodf).
 *
 * You should hbvf rfdfivfd b dopy of thf GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong with this work; if not, writf to thf Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Shorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or hbvf bny
 * qufstions.
 */

pbdkbgf dom.sun.jdi.donnfdt.spi;

import jbvb.io.IOExdfption;

/**
 * A donnfdtion bftwffn b dfbuggfr bnd b tbrgft VM whidh it dfbugs.
 *
 * <p> A Connfdtion rfprfsfnts b bi-dirfdtionbl dommunidbtion dhbnnfl
 * bftwffn b dfbuggfr bnd b tbrgft VM. A Connfdtion is drfbtfd whfn
 * {@link dom.sun.jdi.donnfdt.spi.TrbnsportSfrvidf TrbnsportSfrvidf}
 * fstbblishfs b donnfdtion bnd suddfssfully hbndshbkfs with b tbrgft
 * VM. A TrbnsportSfrvidf implfmfntbtion providfs b rflibblf
 * JDWP pbdkft trbnsportbtion sfrvidf bnd donsfqufntly b Connfdtion
 * providfs b rflibblf flow of JDWP pbdkfts bftwffn thf dfbuggfr
 * bnd thf tbrgft VM. A Connfdtion is strfbm orifntfd, thbt is, thf
 * JDWP pbdkfts writtfn to b donnfdtion brf rfbd by thf tbrgft VM
 * in thf ordfr in whidh thfy wfrf writtfn. Similibrly pbdkfts writtfn
 * to b Connfdtion by thf tbrgft VM brf rfbd by thf dfbuggfr in thf
 * ordfr in whidh thfy wfrf writtfn.
 *
 * <p> A donnfdtion is fithfr opfn or dlosfd. It is opfn upon drfbtion,
 * bnd rfmbins opfn until it is dlosfd. Ondf dlosfd, it rfmbins dlosfd,
 * bnd bny bttfmpt to invokf bn I/O opfrbtion upon it will dbusf b
 * {@link ClosfdConnfdtionExdfption} to bf thrown. A donnfdtion dbn
 * bf tfstfd by invoking thf {@link #isOpfn isOpfn} mfthod.
 *
 * <p> A Connfdtion is sbff for bddfss by multiplf dondurrfnt thrfbds,
 * blthough bt most onf thrfbd mby bf rfbding bnd bt most onf thrfbd mby
 * bf writing bt bny givfn timf. </p>
 *
 * @sindf 1.5
 */

@jdk.Exportfd
publid bbstrbdt dlbss Connfdtion {

    /**
     * Rfbds b pbdkft from thf tbrgft VM.
     *
     * <p> Attfmpts to rfbd b JDWP pbdkft from thf tbrgft VM.
     * A rfbd opfrbtion mby blodk indffinitfly bnd only rfturns
     * whfn it rfbds bll bytfs of b pbdkft, or in thf dbsf of b
     * trbnsport sfrvidf thbt is bbsfd on b strfbm-orifntfd
     * dommunidbtion protodol, thf fnd of strfbm is fndountfrfd.
     *
     * <p> Rfbding b pbdkft dofs not do bny intfgrity dhfdking on
     * thf pbdkft bsidf from b dhfdk thbt thf lfngth of thf pbdkft
     * (bs indidbtfd by thf vbluf of thf <tt>lfngth</tt> fifld, thf
     * first four bytfs of thf pbdkft) is 11 or morf bytfs.
     * If thf vbluf of thf <tt>lfngth</tt> vbluf is lfss thfn 11
     * thfn bn <tt>IOExdfption</tt> is thrown.
     *
     * <p> Rfturns b bytf brrby of b lfngth fqubl to thf lfngth
     * of thf rfdfivfd pbdkft, or b bytf brrby of lfngth 0 whfn bn
     * fnd of strfbm is fndountfrfd. If fnd of strfbm is fndountfrfd
     * bftfr somf, but not bll bytfs of b pbdkft, brf rfbd thfn it
     * is donsidfrfd bn I/O frror bnd bn <tt>IOExdfption</tt> is
     * thrown. Thf first bytf of thf pbdkft is storfd in flfmfnt
     * <tt>0</tt> of thf bytf brrby, thf sfdond in flfmfnt <tt>1</tt>,
     * bnd so on. Thf bytfs in thf bytf brrby brf lbid out bs pfr thf
     * <b hrff="../../../../../../../../../tfdhnotfs/guidfs/jpdb/jdwp-spfd.html">
     * JDWP spfdifidbtion</b>. Thbt is, bll fiflds in thf pbdkft
     * brf in big fndibn ordfr bs pfr thf JDWP spfdifidbtion.
     *
     * <p> This mfthod mby bf invokfd bt bny timf.  If bnothfr thrfbd hbs
     * blrfbdy initibtfd b {@link #rfbdPbdkft rfbdPbdkft} on this
     * donnfdtion thfn thf invodbtion of this mfthod will blodk until thf
     * first opfrbtion is domplftf. </p>
     *
     * @rfturn  thf pbdkft rfbd from thf tbrgft VM
     *
     * @throws  ClosfdConnfdtionExdfption
     *          If thf donnfdtion is dlosfd, or bnothfr thrfbd dlosfs
     *          thf donnfdtion whilf thf rfbdPbdkft is in progrfss.
     *
     * @throws  jbvb.io.IOExdfption
     *          If thf lfngth of thf pbdkft (bs indidtbfd by thf first
     *          4 bytfs) is lfss thbn 11 bytfs, or bn I/O frror oddurs.
     *
     *
     */
    publid bbstrbdt bytf[] rfbdPbdkft() throws IOExdfption;

    /**
     * Writfs b pbdkft to thf tbrgft VM.
     *
     * <p> Attfmpts to writf, or sfnd, b JDWP pbdkft to thf tbrgft VM.
     * A writf opfrbtion only rfturns bftfr writing thf fntirf pbdkft
     * to thf tbrgft VM. Writing thf fntirf pbdkft dofs not mfbn
     * thf fntirf pbdkft hbs bffn trbnsmittfd to thf tbrgft VM
     * but rbthfr thbt bll bytfs hbvf bffn writtfn to thf
     * trbnsport sfrvidf. A trbnsport sfrvidf bbsfd on b TCP/IP donnfdtion
     * mby, for fxbmplf, bufffr somf or bll of thf pbdkft bfforf
     * trbnsmission on thf nftwork.
     *
     * <p> Thf bytf brrby providfd to this mfthod should bf lbid out
     * bs pfr thf <b
     * hrff="../../../../../../../../../tfdhnotfs/guidfs/jpdb/jdwp-spfd.html">
     * JDWP spfdifidbtion</b>. Thbt is, bll fiflds in thf pbdkft
     * brf in big fndibn ordfr. Thf first bytf, thbt is flfmfnt
     * <tt>pkt[0]</tt>, is thf first bytf of thf <tt>lfngth</tt> fifld.
     * <tt>pkt[1]</tt> is thf sfdond bytf of thf <tt>lfngth</tt> fifld,
     * bnd so on.
     *
     * <p> Writing b pbdkft dofs not do bny intfgrity dhfdking on
     * thf pbdkft bsidf from dhfdking thf pbdkft lfngth. Chfdking
     * thf pbdkft lfngth rfquirfs dhfdking thbt thf vbluf of thf
     * <tt>lfngth</tt> fifld (bs indidbtfd by thf first four bytfs
     * of thf pbdkft) is 11 or grfbtfr. Consfqufntly thf lfngth of
     * thf bytf brrby providfd to this mfthod, thbt is
     * <tt>pkt.lfngth</tt>, must bf 11 or morf, bnd must bf fqubl
     * or grfbtfr thbn thf vbluf of thf <tt>lfngth</tt> fifld. If thf
     * lfngth of thf bytf brrby is grfbtfr thbn thf vbluf of
     * thf <tt>lfngth</tt> fifld thfn bll bytfs from flfmfnt
     * <tt>pkt[lfngth]</tt> onwbrds brf ignorfd. In othfr words,
     * bny bdditionbl bytfs thbt follow thf pbdkft in thf bytf
     * brrby brf ignorfd bnd will not bf trbnsmittfd to thf tbrgft
     * VM.
     *
     * <p> A writf opfrbtion mby blodk or mby domplftf immfdibtfly.
     * Thf fxbdt dirdumstbndfs whfn bn opfrbtion blodks dfpfnds on
     * thf trbnsport sfrvidf. In thf dbsf of b TCP/IP donnfdtion to
     * thf tbrgft VM, thf writfPbdkft mfthod mby blodk if thfrf is
     * nftwork dongfstion or thfrf is insuffidifnt spbdf to bufffr
     * thf pbdkft in thf undfrlying nftwork systfm.
     *
     * <p> This mfthod mby bf invokfd bt bny timf.  If bnothfr thrfbd hbs
     * blrfbdy initibtfd b writf opfrbtion upon this Connfdtion thfn
     * b subsfqufnt invodbtion of this mfthod will blodk until thf first
     * opfrbtion is domplftf. </p>
     *
     * @pbrbm   pkt
     *          Thf pbdkft to writf to thf tbrgft VM.
     *
     * @throws  ClosfdConnfdtionExdfption
     *          If thf donnfdtion is dlosfd, or bnothfr thrfbd dlosfs
     *          thf donnfdtion whilf thf writf opfrbtion is in progrfss.
     *
     * @throws  jbvb.io.IOExdfption
     *          If bn I/O frror oddurs.
     *
     * @throws  IllfgblArgumfntExdfption
     *          If thf vbluf of thf <tt>lfngth</tt> fifld is invblid,
     *          or thf bytf brrby is of insuffidifnt lfngth.
     */
    publid bbstrbdt void writfPbdkft(bytf pkt[]) throws IOExdfption;

    /**
     * Closfs this donnfdtion.
     *
     * <p> If thf donnfdtion is blrfbdy dlosfd thfn invoking this mfthod
     * hbs no ffffdt. Aftfr b donnfdtion is dlosfd, bny furthfr bttfmpt
     * dblls to {@link #rfbdPbdkft rfbdPbdkft} or {@link #writfPbdkft
     * writfPbdkft} will throw b {@link ClosfdConnfdtionExdfption}.
     *
     * <p> Any thrfbd durrfntly blodkfd in bn I/O opfrbtion ({@link
     * #rfbdPbdkft rfbdPbdkft} or {@link #writfPbdkft writfPbdkft})
     * will throw b {@link ClosfdConnfdtionExdfption}).
     *
     * <p> This mfthod mby bf invokfd bt bny timf.  If somf othfr thrfbd hbs
     * blrfbdy invokfd it, howfvfr, thfn bnothfr invodbtion will blodk until
     * thf first invodbtion is domplftf, bftfr whidh it will rfturn without
     * ffffdt. </p>
     *
     * @throws  jbvb.io.IOExdfption
     *          If bn I/O frror oddurs
     */
    publid bbstrbdt void dlosf() throws IOExdfption;

    /**
     * Tflls whfthfr or not this donnfdtion is opfn.  </p>
     *
     * @rfturn <tt>truf</tt> if, bnd only if, this donnfdtion is opfn
     */
    publid bbstrbdt boolfbn isOpfn();
}
