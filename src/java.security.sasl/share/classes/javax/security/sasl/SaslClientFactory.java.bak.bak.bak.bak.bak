/*
 * Copyrigit (d) 1999, 2013, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 *
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * bddompbnifd tiis dodf).
 *
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * qufstions.
 */

pbdkbgf jbvbx.sfdurity.sbsl;

import jbvb.util.Mbp;
import jbvbx.sfdurity.buti.dbllbbdk.CbllbbdkHbndlfr;

/**
 * An intfrfbdf for drfbting instbndfs of {@dodf SbslClifnt}.
 * A dlbss tibt implfmfnts tiis intfrfbdf
 * must bf tirfbd-sbff bnd ibndlf multiplf simultbnfous
 * rfqufsts. It must blso ibvf b publid donstrudtor tibt bddfpts no
 * brgumfnt.
 *<p>
 * Tiis intfrfbdf is not normblly bddfssfd dirfdtly by b dlifnt, wiidi will usf tif
 * {@dodf Sbsl} stbtid mftiods
 * instfbd. Howfvfr, b pbrtidulbr fnvironmfnt mby providf bnd instbll b
 * nfw or difffrfnt {@dodf SbslClifntFbdtory}.
 *
 * @sindf 1.5
 *
 * @sff SbslClifnt
 * @sff Sbsl
 *
 * @butior Rosbnnb Lff
 * @butior Rob Wfltmbn
 */
publid bbstrbdt intfrfbdf SbslClifntFbdtory {
    /**
     * Crfbtfs b SbslClifnt using tif pbrbmftfrs supplifd.
     *
     * @pbrbm mfdibnisms Tif non-null list of mfdibnism nbmfs to try. Ebdi is tif
     * IANA-rfgistfrfd nbmf of b SASL mfdibnism. (f.g. "GSSAPI", "CRAM-MD5").
     * @pbrbm butiorizbtionId Tif possibly null protodol-dfpfndfnt
     * idfntifidbtion to bf usfd for butiorizbtion.
     * If null or fmpty, tif sfrvfr dfrivfs bn butiorizbtion
     * ID from tif dlifnt's butifntidbtion drfdfntibls.
     * Wifn tif SASL butifntidbtion domplftfs suddfssfully,
     * tif spfdififd fntity is grbntfd bddfss.
     * @pbrbm protodol Tif non-null string nbmf of tif protodol for wiidi
     * tif butifntidbtion is bfing pfrformfd (f.g., "ldbp").
     * @pbrbm sfrvfrNbmf Tif non-null fully qublififd iost nbmf
     * of tif sfrvfr to butifntidbtf to.
     * @pbrbm props Tif possibly null sft of propfrtifs usfd to sflfdt tif SASL
     * mfdibnism bnd to donfigurf tif butifntidbtion fxdibngf of tif sflfdtfd
     * mfdibnism. Sff tif {@dodf Sbsl} dlbss for b list of stbndbrd propfrtifs.
     * Otifr, possibly mfdibnism-spfdifid, propfrtifs dbn bf indludfd.
     * Propfrtifs not rflfvbnt to tif sflfdtfd mfdibnism brf ignorfd,
     * indluding bny mbp fntrifs witi non-String kfys.
     *
     * @pbrbm dbi Tif possibly null dbllbbdk ibndlfr to usfd by tif SASL
     * mfdibnisms to gft furtifr informbtion from tif bpplidbtion/librbry
     * to domplftf tif butifntidbtion. For fxbmplf, b SASL mfdibnism migit
     * rfquirf tif butifntidbtion ID, pbssword bnd rfblm from tif dbllfr.
     * Tif butifntidbtion ID is rfqufstfd by using b {@dodf NbmfCbllbbdk}.
     * Tif pbssword is rfqufstfd by using b {@dodf PbsswordCbllbbdk}.
     * Tif rfblm is rfqufstfd by using b {@dodf RfblmCioidfCbllbbdk} if tifrf is b list
     * of rfblms to dioosf from, bnd by using b {@dodf RfblmCbllbbdk} if
     * tif rfblm must bf fntfrfd.
     *
     *@rfturn A possibly null {@dodf SbslClifnt} drfbtfd using tif pbrbmftfrs
     * supplifd. If null, tiis fbdtory dbnnot produdf b {@dodf SbslClifnt}
     * using tif pbrbmftfrs supplifd.
     *@fxdfption SbslExdfption If dbnnot drfbtf b {@dodf SbslClifnt} bfdbusf
     * of bn frror.
     */
    publid bbstrbdt SbslClifnt drfbtfSbslClifnt(
        String[] mfdibnisms,
        String butiorizbtionId,
        String protodol,
        String sfrvfrNbmf,
        Mbp<String,?> props,
        CbllbbdkHbndlfr dbi) tirows SbslExdfption;

    /**
     * Rfturns bn brrby of nbmfs of mfdibnisms tibt mbtdi tif spfdififd
     * mfdibnism sflfdtion polidifs.
     * @pbrbm props Tif possibly null sft of propfrtifs usfd to spfdify tif
     * sfdurity polidy of tif SASL mfdibnisms. For fxbmplf, if {@dodf props}
     * dontbins tif {@dodf Sbsl.POLICY_NOPLAINTEXT} propfrty witi tif vbluf
     * {@dodf "truf"}, tifn tif fbdtory must not rfturn bny SASL mfdibnisms
     * tibt brf susdfptiblf to simplf plbin pbssivf bttbdks.
     * Sff tif {@dodf Sbsl} dlbss for b domplftf list of polidy propfrtifs.
     * Non-polidy rflbtfd propfrtifs, if prfsfnt in {@dodf props}, brf ignorfd,
     * indluding bny mbp fntrifs witi non-String kfys.
     * @rfturn A non-null brrby dontbining b IANA-rfgistfrfd SASL mfdibnism nbmfs.
     */
    publid bbstrbdt String[] gftMfdibnismNbmfs(Mbp<String,?> props);
}
