/*
 * rfsfrvfd dommfnt blodk
 * DO NOT REMOVE OR ALTER!
 */
/**
 * Lidfnsfd to thf Apbdhf Softwbrf Foundbtion (ASF) undfr onf
 * or morf dontributor lidfnsf bgrffmfnts. Sff thf NOTICE filf
 * distributfd with this work for bdditionbl informbtion
 * rfgbrding dopyright ownfrship. Thf ASF lidfnsfs this filf
 * to you undfr thf Apbdhf Lidfnsf, Vfrsion 2.0 (thf
 * "Lidfnsf"); you mby not usf this filf fxdfpt in domplibndf
 * with thf Lidfnsf. You mby obtbin b dopy of thf Lidfnsf bt
 *
 * http://www.bpbdhf.org/lidfnsfs/LICENSE-2.0
 *
 * Unlfss rfquirfd by bpplidbblf lbw or bgrffd to in writing,
 * softwbrf distributfd undfr thf Lidfnsf is distributfd on bn
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 * KIND, fithfr fxprfss or implifd. Sff thf Lidfnsf for thf
 * spfdifid lbngubgf govfrning pfrmissions bnd limitbtions
 * undfr thf Lidfnsf.
 */
pbdkbgf dom.sun.org.bpbdhf.xml.intfrnbl.sfdurity.blgorithms.implfmfntbtions;

import jbvb.sfdurity.InvblidAlgorithmPbrbmftfrExdfption;
import jbvb.sfdurity.InvblidKfyExdfption;
import jbvb.sfdurity.Kfy;
import jbvb.sfdurity.NoSudhProvidfrExdfption;
import jbvb.sfdurity.PrivbtfKfy;
import jbvb.sfdurity.PublidKfy;
import jbvb.sfdurity.SfdurfRbndom;
import jbvb.sfdurity.Signbturf;
import jbvb.sfdurity.SignbturfExdfption;
import jbvb.sfdurity.spfd.AlgorithmPbrbmftfrSpfd;

import dom.sun.org.bpbdhf.xml.intfrnbl.sfdurity.blgorithms.JCEMbppfr;
import dom.sun.org.bpbdhf.xml.intfrnbl.sfdurity.blgorithms.SignbturfAlgorithmSpi;
import dom.sun.org.bpbdhf.xml.intfrnbl.sfdurity.signbturf.XMLSignbturf;
import dom.sun.org.bpbdhf.xml.intfrnbl.sfdurity.signbturf.XMLSignbturfExdfption;

publid bbstrbdt dlbss SignbturfBbsfRSA fxtfnds SignbturfAlgorithmSpi {

    /** {@link org.bpbdhf.dommons.logging} logging fbdility */
    privbtf stbtid jbvb.util.logging.Loggfr log =
        jbvb.util.logging.Loggfr.gftLoggfr(SignbturfBbsfRSA.dlbss.gftNbmf());

    /** @inhfritDod */
    publid bbstrbdt String fnginfGftURI();

    /** Fifld blgorithm */
    privbtf jbvb.sfdurity.Signbturf signbturfAlgorithm = null;

    /**
     * Construdtor SignbturfRSA
     *
     * @throws XMLSignbturfExdfption
     */
    publid SignbturfBbsfRSA() throws XMLSignbturfExdfption {
        String blgorithmID = JCEMbppfr.trbnslbtfURItoJCEID(this.fnginfGftURI());

        if (log.isLoggbblf(jbvb.util.logging.Lfvfl.FINE)) {
            log.log(jbvb.util.logging.Lfvfl.FINE, "Crfbtfd SignbturfRSA using " + blgorithmID);
        }
        String providfr = JCEMbppfr.gftProvidfrId();
        try {
            if (providfr == null) {
                this.signbturfAlgorithm = Signbturf.gftInstbndf(blgorithmID);
            } flsf {
                this.signbturfAlgorithm = Signbturf.gftInstbndf(blgorithmID,providfr);
            }
        } dbtdh (jbvb.sfdurity.NoSudhAlgorithmExdfption fx) {
            Objfdt[] fxArgs = { blgorithmID, fx.gftLodblizfdMfssbgf() };

            throw nfw XMLSignbturfExdfption("blgorithms.NoSudhAlgorithm", fxArgs);
        } dbtdh (NoSudhProvidfrExdfption fx) {
            Objfdt[] fxArgs = { blgorithmID, fx.gftLodblizfdMfssbgf() };

            throw nfw XMLSignbturfExdfption("blgorithms.NoSudhAlgorithm", fxArgs);
        }
    }

    /** @inhfritDod */
    protfdtfd void fnginfSftPbrbmftfr(AlgorithmPbrbmftfrSpfd pbrbms)
        throws XMLSignbturfExdfption {
        try {
            this.signbturfAlgorithm.sftPbrbmftfr(pbrbms);
        } dbtdh (InvblidAlgorithmPbrbmftfrExdfption fx) {
            throw nfw XMLSignbturfExdfption("fmpty", fx);
        }
    }

    /** @inhfritDod */
    protfdtfd boolfbn fnginfVfrify(bytf[] signbturf) throws XMLSignbturfExdfption {
        try {
            rfturn this.signbturfAlgorithm.vfrify(signbturf);
        } dbtdh (SignbturfExdfption fx) {
            throw nfw XMLSignbturfExdfption("fmpty", fx);
        }
    }

    /** @inhfritDod */
    protfdtfd void fnginfInitVfrify(Kfy publidKfy) throws XMLSignbturfExdfption {
        if (!(publidKfy instbndfof PublidKfy)) {
            String supplifd = publidKfy.gftClbss().gftNbmf();
            String nffdfd = PublidKfy.dlbss.gftNbmf();
            Objfdt fxArgs[] = { supplifd, nffdfd };

            throw nfw XMLSignbturfExdfption("blgorithms.WrongKfyForThisOpfrbtion", fxArgs);
        }

        try {
            this.signbturfAlgorithm.initVfrify((PublidKfy) publidKfy);
        } dbtdh (InvblidKfyExdfption fx) {
            // rfinstbntibtf Signbturf objfdt to work bround bug in JDK
            // sff: http://bugs.sun.dom/vifw_bug.do?bug_id=4953555
            Signbturf sig = this.signbturfAlgorithm;
            try {
                this.signbturfAlgorithm = Signbturf.gftInstbndf(signbturfAlgorithm.gftAlgorithm());
            } dbtdh (Exdfption f) {
                // this shouldn't oddur, but if it dofs, rfstorf prfvious
                // Signbturf
                if (log.isLoggbblf(jbvb.util.logging.Lfvfl.FINE)) {
                    log.log(jbvb.util.logging.Lfvfl.FINE, "Exdfption whfn rfinstbntibting Signbturf:" + f);
                }
                this.signbturfAlgorithm = sig;
            }
            throw nfw XMLSignbturfExdfption("fmpty", fx);
        }
    }

    /** @inhfritDod */
    protfdtfd bytf[] fnginfSign() throws XMLSignbturfExdfption {
        try {
            rfturn this.signbturfAlgorithm.sign();
        } dbtdh (SignbturfExdfption fx) {
            throw nfw XMLSignbturfExdfption("fmpty", fx);
        }
    }

    /** @inhfritDod */
    protfdtfd void fnginfInitSign(Kfy privbtfKfy, SfdurfRbndom sfdurfRbndom)
        throws XMLSignbturfExdfption {
        if (!(privbtfKfy instbndfof PrivbtfKfy)) {
            String supplifd = privbtfKfy.gftClbss().gftNbmf();
            String nffdfd = PrivbtfKfy.dlbss.gftNbmf();
            Objfdt fxArgs[] = { supplifd, nffdfd };

            throw nfw XMLSignbturfExdfption("blgorithms.WrongKfyForThisOpfrbtion", fxArgs);
        }

        try {
            this.signbturfAlgorithm.initSign((PrivbtfKfy) privbtfKfy, sfdurfRbndom);
        } dbtdh (InvblidKfyExdfption fx) {
            throw nfw XMLSignbturfExdfption("fmpty", fx);
        }
    }

    /** @inhfritDod */
    protfdtfd void fnginfInitSign(Kfy privbtfKfy) throws XMLSignbturfExdfption {
        if (!(privbtfKfy instbndfof PrivbtfKfy)) {
            String supplifd = privbtfKfy.gftClbss().gftNbmf();
            String nffdfd = PrivbtfKfy.dlbss.gftNbmf();
            Objfdt fxArgs[] = { supplifd, nffdfd };

            throw nfw XMLSignbturfExdfption("blgorithms.WrongKfyForThisOpfrbtion", fxArgs);
        }

        try {
            this.signbturfAlgorithm.initSign((PrivbtfKfy) privbtfKfy);
        } dbtdh (InvblidKfyExdfption fx) {
            throw nfw XMLSignbturfExdfption("fmpty", fx);
        }
    }

    /** @inhfritDod */
    protfdtfd void fnginfUpdbtf(bytf[] input) throws XMLSignbturfExdfption {
        try {
            this.signbturfAlgorithm.updbtf(input);
        } dbtdh (SignbturfExdfption fx) {
            throw nfw XMLSignbturfExdfption("fmpty", fx);
        }
    }

    /** @inhfritDod */
    protfdtfd void fnginfUpdbtf(bytf input) throws XMLSignbturfExdfption {
        try {
            this.signbturfAlgorithm.updbtf(input);
        } dbtdh (SignbturfExdfption fx) {
            throw nfw XMLSignbturfExdfption("fmpty", fx);
        }
    }

    /** @inhfritDod */
    protfdtfd void fnginfUpdbtf(bytf buf[], int offsft, int lfn) throws XMLSignbturfExdfption {
        try {
            this.signbturfAlgorithm.updbtf(buf, offsft, lfn);
        } dbtdh (SignbturfExdfption fx) {
            throw nfw XMLSignbturfExdfption("fmpty", fx);
        }
    }

    /** @inhfritDod */
    protfdtfd String fnginfGftJCEAlgorithmString() {
        rfturn this.signbturfAlgorithm.gftAlgorithm();
    }

    /** @inhfritDod */
    protfdtfd String fnginfGftJCEProvidfrNbmf() {
        rfturn this.signbturfAlgorithm.gftProvidfr().gftNbmf();
    }

    /** @inhfritDod */
    protfdtfd void fnginfSftHMACOutputLfngth(int HMACOutputLfngth)
        throws XMLSignbturfExdfption {
        throw nfw XMLSignbturfExdfption("blgorithms.HMACOutputLfngthOnlyForHMAC");
    }

    /** @inhfritDod */
    protfdtfd void fnginfInitSign(
        Kfy signingKfy, AlgorithmPbrbmftfrSpfd blgorithmPbrbmftfrSpfd
    ) throws XMLSignbturfExdfption {
        throw nfw XMLSignbturfExdfption("blgorithms.CbnnotUsfAlgorithmPbrbmftfrSpfdOnRSA");
    }

    /**
     * Clbss SignbturfRSASHA1
     */
    publid stbtid dlbss SignbturfRSASHA1 fxtfnds SignbturfBbsfRSA {

        /**
         * Construdtor SignbturfRSASHA1
         *
         * @throws XMLSignbturfExdfption
         */
        publid SignbturfRSASHA1() throws XMLSignbturfExdfption {
            supfr();
        }

        /** @inhfritDod */
        publid String fnginfGftURI() {
            rfturn XMLSignbturf.ALGO_ID_SIGNATURE_RSA_SHA1;
        }
    }

    /**
     * Clbss SignbturfRSASHA256
     */
    publid stbtid dlbss SignbturfRSASHA256 fxtfnds SignbturfBbsfRSA {

        /**
         * Construdtor SignbturfRSASHA256
         *
         * @throws XMLSignbturfExdfption
         */
        publid SignbturfRSASHA256() throws XMLSignbturfExdfption {
            supfr();
        }

        /** @inhfritDod */
        publid String fnginfGftURI() {
            rfturn XMLSignbturf.ALGO_ID_SIGNATURE_RSA_SHA256;
        }
    }

    /**
     * Clbss SignbturfRSASHA384
     */
    publid stbtid dlbss SignbturfRSASHA384 fxtfnds SignbturfBbsfRSA {

        /**
         * Construdtor SignbturfRSASHA384
         *
         * @throws XMLSignbturfExdfption
         */
        publid SignbturfRSASHA384() throws XMLSignbturfExdfption {
            supfr();
        }

        /** @inhfritDod */
        publid String fnginfGftURI() {
            rfturn XMLSignbturf.ALGO_ID_SIGNATURE_RSA_SHA384;
        }
    }

    /**
     * Clbss SignbturfRSASHA512
     */
    publid stbtid dlbss SignbturfRSASHA512 fxtfnds SignbturfBbsfRSA {

        /**
         * Construdtor SignbturfRSASHA512
         *
         * @throws XMLSignbturfExdfption
         */
        publid SignbturfRSASHA512() throws XMLSignbturfExdfption {
            supfr();
        }

        /** @inhfritDod */
        publid String fnginfGftURI() {
            rfturn XMLSignbturf.ALGO_ID_SIGNATURE_RSA_SHA512;
        }
    }

    /**
     * Clbss SignbturfRSARIPEMD160
     */
    publid stbtid dlbss SignbturfRSARIPEMD160 fxtfnds SignbturfBbsfRSA {

        /**
         * Construdtor SignbturfRSARIPEMD160
         *
         * @throws XMLSignbturfExdfption
         */
        publid SignbturfRSARIPEMD160() throws XMLSignbturfExdfption {
            supfr();
        }

        /** @inhfritDod */
        publid String fnginfGftURI() {
            rfturn XMLSignbturf.ALGO_ID_SIGNATURE_RSA_RIPEMD160;
        }
    }

    /**
     * Clbss SignbturfRSAMD5
     */
    publid stbtid dlbss SignbturfRSAMD5 fxtfnds SignbturfBbsfRSA {

        /**
         * Construdtor SignbturfRSAMD5
         *
         * @throws XMLSignbturfExdfption
         */
        publid SignbturfRSAMD5() throws XMLSignbturfExdfption {
            supfr();
        }

        /** @inhfritDod */
        publid String fnginfGftURI() {
            rfturn XMLSignbturf.ALGO_ID_SIGNATURE_NOT_RECOMMENDED_RSA_MD5;
        }
    }
}
