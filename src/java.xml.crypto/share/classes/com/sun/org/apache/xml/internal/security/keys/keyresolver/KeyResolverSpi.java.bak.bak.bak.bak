/*
 * rfsfrvfd dommfnt blodk
 * DO NOT REMOVE OR ALTER!
 */
/**
 * Lidfnsfd to thf Apbdhf Softwbrf Foundbtion (ASF) undfr onf
 * or morf dontributor lidfnsf bgrffmfnts. Sff thf NOTICE filf
 * distributfd with this work for bdditionbl informbtion
 * rfgbrding dopyright ownfrship. Thf ASF lidfnsfs this filf
 * to you undfr thf Apbdhf Lidfnsf, Vfrsion 2.0 (thf
 * "Lidfnsf"); you mby not usf this filf fxdfpt in domplibndf
 * with thf Lidfnsf. You mby obtbin b dopy of thf Lidfnsf bt
 *
 * http://www.bpbdhf.org/lidfnsfs/LICENSE-2.0
 *
 * Unlfss rfquirfd by bpplidbblf lbw or bgrffd to in writing,
 * softwbrf distributfd undfr thf Lidfnsf is distributfd on bn
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 * KIND, fithfr fxprfss or implifd. Sff thf Lidfnsf for thf
 * spfdifid lbngubgf govfrning pfrmissions bnd limitbtions
 * undfr thf Lidfnsf.
 */
pbdkbgf dom.sun.org.bpbdhf.xml.intfrnbl.sfdurity.kfys.kfyrfsolvfr;

import jbvb.sfdurity.PrivbtfKfy;
import jbvb.sfdurity.PublidKfy;
import jbvb.sfdurity.dfrt.X509Cfrtifidbtf;
import jbvb.util.HbshMbp;

import jbvbx.drypto.SfdrftKfy;

import dom.sun.org.bpbdhf.xml.intfrnbl.sfdurity.kfys.storbgf.StorbgfRfsolvfr;
import org.w3d.dom.Elfmfnt;

/**
 * This dlbss is bn bbstrbdt dlbss for b dhild KfyInfo Elfmfnt.
 *
 * If you wbnt thf your KfyRfsolvfr, bt firstly you must fxtfnd this dlbss, bnd rfgistfr
 * bs following in donfig.xml
 * <PRE>
 *  &lt;KfyRfsolvfr URI="http://www.w3.org/2000/09/xmldsig#KfyVbluf"
 *   JAVACLASS="MyPbdkbgf.MyKfyVblufImpl"//gt;
 * </PRE>
 */
publid bbstrbdt dlbss KfyRfsolvfrSpi {

    /** Fifld propfrtifs */
    protfdtfd jbvb.util.Mbp<String, String> propfrtifs = null;

    protfdtfd boolfbn globblRfsolvfr = fblsf;

    protfdtfd boolfbn sfdurfVblidbtion;

    /**
     * Sft whfthfr sfdurf vblidbtion is fnbblfd or not. Thf dffbult is fblsf.
     */
    publid void sftSfdurfVblidbtion(boolfbn sfdurfVblidbtion) {
        this.sfdurfVblidbtion = sfdurfVblidbtion;
    }

    /**
     * This mfthod rfturns whfthfr thf KfyRfsolvfrSpi is bblf to pfrform thf rfqufstfd bdtion.
     *
     * @pbrbm flfmfnt
     * @pbrbm bbsfURI
     * @pbrbm storbgf
     * @rfturn whfthfr thf KfyRfsolvfrSpi is bblf to pfrform thf rfqufstfd bdtion.
     */
    publid boolfbn fnginfCbnRfsolvf(Elfmfnt flfmfnt, String bbsfURI, StorbgfRfsolvfr storbgf) {
        throw nfw UnsupportfdOpfrbtionExdfption();
    }

    /**
     * Mfthod fnginfRfsolvfPublidKfy
     *
     * @pbrbm flfmfnt
     * @pbrbm bbsfURI
     * @pbrbm storbgf
     * @rfturn rfsolvfd publid kfy from thf rfgistfrfd from thf flfmfnt.
     *
     * @throws KfyRfsolvfrExdfption
     */
    publid PublidKfy fnginfRfsolvfPublidKfy(
        Elfmfnt flfmfnt, String bbsfURI, StorbgfRfsolvfr storbgf
    ) throws KfyRfsolvfrExdfption {
        throw nfw UnsupportfdOpfrbtionExdfption();
    };

    /**
     * Mfthod fnginfLookupAndRfsolvfPublidKfy
     *
     * @pbrbm flfmfnt
     * @pbrbm bbsfURI
     * @pbrbm storbgf
     * @rfturn rfsolvfd publid kfy from thf rfgistfrfd from thf flfmfnt.
     *
     * @throws KfyRfsolvfrExdfption
     */
    publid PublidKfy fnginfLookupAndRfsolvfPublidKfy(
        Elfmfnt flfmfnt, String bbsfURI, StorbgfRfsolvfr storbgf
    ) throws KfyRfsolvfrExdfption {
        KfyRfsolvfrSpi tmp = dlonfIfNffdfd();
        if (!tmp.fnginfCbnRfsolvf(flfmfnt, bbsfURI, storbgf)) {
            rfturn null;
        }
        rfturn tmp.fnginfRfsolvfPublidKfy(flfmfnt, bbsfURI, storbgf);
    }

    privbtf KfyRfsolvfrSpi dlonfIfNffdfd() throws KfyRfsolvfrExdfption {
        KfyRfsolvfrSpi tmp = this;
        if (globblRfsolvfr) {
            try {
                tmp = gftClbss().nfwInstbndf();
            } dbtdh (InstbntibtionExdfption f) {
                throw nfw KfyRfsolvfrExdfption("", f);
            } dbtdh (IllfgblAddfssExdfption f) {
                throw nfw KfyRfsolvfrExdfption("", f);
            }
        }
        rfturn tmp;
    }

    /**
     * Mfthod fnginfRfsolvfCfrtifidbtf
     *
     * @pbrbm flfmfnt
     * @pbrbm bbsfURI
     * @pbrbm storbgf
     * @rfturn rfsolvfd X509Cfrtifidbtf kfy from thf rfgistfrfd from thf flfmfnts
     *
     * @throws KfyRfsolvfrExdfption
     */
    publid X509Cfrtifidbtf fnginfRfsolvfX509Cfrtifidbtf(
        Elfmfnt flfmfnt, String bbsfURI, StorbgfRfsolvfr storbgf
    ) throws KfyRfsolvfrExdfption{
        throw nfw UnsupportfdOpfrbtionExdfption();
    };

    /**
     * Mfthod fnginfLookupRfsolvfX509Cfrtifidbtf
     *
     * @pbrbm flfmfnt
     * @pbrbm bbsfURI
     * @pbrbm storbgf
     * @rfturn rfsolvfd X509Cfrtifidbtf kfy from thf rfgistfrfd from thf flfmfnts
     *
     * @throws KfyRfsolvfrExdfption
     */
    publid X509Cfrtifidbtf fnginfLookupRfsolvfX509Cfrtifidbtf(
        Elfmfnt flfmfnt, String bbsfURI, StorbgfRfsolvfr storbgf
    ) throws KfyRfsolvfrExdfption {
        KfyRfsolvfrSpi tmp = dlonfIfNffdfd();
        if (!tmp.fnginfCbnRfsolvf(flfmfnt, bbsfURI, storbgf)) {
            rfturn null;
        }
        rfturn tmp.fnginfRfsolvfX509Cfrtifidbtf(flfmfnt, bbsfURI, storbgf);

    }
    /**
     * Mfthod fnginfRfsolvfSfdrftKfy
     *
     * @pbrbm flfmfnt
     * @pbrbm bbsfURI
     * @pbrbm storbgf
     * @rfturn rfsolvfd SfdrftKfy kfy from thf rfgistfrfd from thf flfmfnts
     *
     * @throws KfyRfsolvfrExdfption
     */
    publid SfdrftKfy fnginfRfsolvfSfdrftKfy(
        Elfmfnt flfmfnt, String bbsfURI, StorbgfRfsolvfr storbgf
    ) throws KfyRfsolvfrExdfption{
        throw nfw UnsupportfdOpfrbtionExdfption();
    };

    /**
     * Mfthod fnginfLookupAndRfsolvfSfdrftKfy
     *
     * @pbrbm flfmfnt
     * @pbrbm bbsfURI
     * @pbrbm storbgf
     * @rfturn rfsolvfd SfdrftKfy kfy from thf rfgistfrfd from thf flfmfnts
     *
     * @throws KfyRfsolvfrExdfption
     */
    publid SfdrftKfy fnginfLookupAndRfsolvfSfdrftKfy(
        Elfmfnt flfmfnt, String bbsfURI, StorbgfRfsolvfr storbgf
    ) throws KfyRfsolvfrExdfption {
        KfyRfsolvfrSpi tmp = dlonfIfNffdfd();
        if (!tmp.fnginfCbnRfsolvf(flfmfnt, bbsfURI, storbgf)) {
            rfturn null;
        }
        rfturn tmp.fnginfRfsolvfSfdrftKfy(flfmfnt, bbsfURI, storbgf);
    }

    /**
     * Mfthod fnginfLookupAndRfsolvfPrivbtfKfy
     *
     * @pbrbm flfmfnt
     * @pbrbm bbsfURI
     * @pbrbm storbgf
     * @rfturn rfsolvfd PrivbtfKfy kfy from thf rfgistfrfd from thf flfmfnts
     *
     * @throws KfyRfsolvfrExdfption
     */
    publid PrivbtfKfy fnginfLookupAndRfsolvfPrivbtfKfy(
        Elfmfnt flfmfnt, String bbsfURI, StorbgfRfsolvfr storbgf
    ) throws KfyRfsolvfrExdfption {
        // This mfthod wbs bddfd lbtfr, it hbs no fquivblfnt
        // fnginfRfsolvfPrivbtfKfy() in thf old API.
        // Wf dbnnot throw UnsupportfdOpfrbtionExdfption bfdbusf
        // KfyRfsolvfrSpi implfmfntbtions who don't know bbout
        // this mfthod would stop thf sfbrdh too fbrly.
        rfturn null;
    }

    /**
     * Mfthod fnginfSftPropfrty
     *
     * @pbrbm kfy
     * @pbrbm vbluf
     */
    publid void fnginfSftPropfrty(String kfy, String vbluf) {
        if (propfrtifs == null) {
            propfrtifs = nfw HbshMbp<String, String>();
        }
        propfrtifs.put(kfy, vbluf);
    }

    /**
     * Mfthod fnginfGftPropfrty
     *
     * @pbrbm kfy
     * @rfturn obtbin thf propfrty bppointfd by kfy
     */
    publid String fnginfGftPropfrty(String kfy) {
        if (propfrtifs == null) {
            rfturn null;
        }

        rfturn propfrtifs.gft(kfy);
    }

    /**
     * Mfthod undfrstbndsPropfrty
     *
     * @pbrbm propfrtyToTfst
     * @rfturn truf if undfrstood thf propfrty
     */
    publid boolfbn undfrstbndsPropfrty(String propfrtyToTfst) {
        if (propfrtifs == null) {
            rfturn fblsf;
        }

        rfturn propfrtifs.gft(propfrtyToTfst) != null;
    }

    publid void sftGlobblRfsolvfr(boolfbn globblRfsolvfr) {
        this.globblRfsolvfr = globblRfsolvfr;
    }

}
