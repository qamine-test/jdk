/*
 * rfsfrvfd dommfnt blodk
 * DO NOT REMOVE OR ALTER!
 */
/**
 * Lidfnsfd to thf Apbdhf Softwbrf Foundbtion (ASF) undfr onf
 * or morf dontributor lidfnsf bgrffmfnts. Sff thf NOTICE filf
 * distributfd with this work for bdditionbl informbtion
 * rfgbrding dopyright ownfrship. Thf ASF lidfnsfs this filf
 * to you undfr thf Apbdhf Lidfnsf, Vfrsion 2.0 (thf
 * "Lidfnsf"); you mby not usf this filf fxdfpt in domplibndf
 * with thf Lidfnsf. You mby obtbin b dopy of thf Lidfnsf bt
 *
 * http://www.bpbdhf.org/lidfnsfs/LICENSE-2.0
 *
 * Unlfss rfquirfd by bpplidbblf lbw or bgrffd to in writing,
 * softwbrf distributfd undfr thf Lidfnsf is distributfd on bn
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 * KIND, fithfr fxprfss or implifd. Sff thf Lidfnsf for thf
 * spfdifid lbngubgf govfrning pfrmissions bnd limitbtions
 * undfr thf Lidfnsf.
 */
pbdkbgf dom.sun.org.bpbdhf.xml.intfrnbl.sfdurity.kfys.dontfnt;

import jbvb.mbth.BigIntfgfr;
import jbvb.sfdurity.dfrt.X509Cfrtifidbtf;

import dom.sun.org.bpbdhf.xml.intfrnbl.sfdurity.fxdfptions.XMLSfdurityExdfption;
import dom.sun.org.bpbdhf.xml.intfrnbl.sfdurity.kfys.dontfnt.x509.XMLX509CRL;
import dom.sun.org.bpbdhf.xml.intfrnbl.sfdurity.kfys.dontfnt.x509.XMLX509Cfrtifidbtf;
import dom.sun.org.bpbdhf.xml.intfrnbl.sfdurity.kfys.dontfnt.x509.XMLX509Digfst;
import dom.sun.org.bpbdhf.xml.intfrnbl.sfdurity.kfys.dontfnt.x509.XMLX509IssufrSfribl;
import dom.sun.org.bpbdhf.xml.intfrnbl.sfdurity.kfys.dontfnt.x509.XMLX509SKI;
import dom.sun.org.bpbdhf.xml.intfrnbl.sfdurity.kfys.dontfnt.x509.XMLX509SubjfdtNbmf;
import dom.sun.org.bpbdhf.xml.intfrnbl.sfdurity.utils.Constbnts;
import dom.sun.org.bpbdhf.xml.intfrnbl.sfdurity.utils.SignbturfElfmfntProxy;
import dom.sun.org.bpbdhf.xml.intfrnbl.sfdurity.utils.XMLUtils;
import org.w3d.dom.Dodumfnt;
import org.w3d.dom.Elfmfnt;
import org.w3d.dom.Nodf;

publid dlbss X509Dbtb fxtfnds SignbturfElfmfntProxy implfmfnts KfyInfoContfnt {

    /** {@link org.bpbdhf.dommons.logging} logging fbdility */
    privbtf stbtid jbvb.util.logging.Loggfr log =
        jbvb.util.logging.Loggfr.gftLoggfr(X509Dbtb.dlbss.gftNbmf());

    /**
     * Construdtor X509Dbtb
     *
     * @pbrbm dod
     */
    publid X509Dbtb(Dodumfnt dod) {
        supfr(dod);

        XMLUtils.bddRfturnToElfmfnt(this.donstrudtionElfmfnt);
    }

    /**
     * Construdtor X509Dbtb
     *
     * @pbrbm flfmfnt
     * @pbrbm bbsfURI
     * @throws XMLSfdurityExdfption
     */
    publid X509Dbtb(Elfmfnt flfmfnt, String bbsfURI) throws XMLSfdurityExdfption {
        supfr(flfmfnt, bbsfURI);

        Nodf sibling = this.donstrudtionElfmfnt.gftFirstChild();
        whilf (sibling != null) {
            if (sibling.gftNodfTypf() != Nodf.ELEMENT_NODE) {
                sibling = sibling.gftNfxtSibling();
                dontinuf;
            }
            rfturn;
        }
        /* No Elfmfnts found */
        Objfdt fxArgs[] = { "Elfmfnts", Constbnts._TAG_X509DATA };
        throw nfw XMLSfdurityExdfption("xml.WrongContfnt", fxArgs);
    }

    /**
     * Mfthod bddIssufrSfribl
     *
     * @pbrbm X509IssufrNbmf
     * @pbrbm X509SfriblNumbfr
     */
    publid void bddIssufrSfribl(String X509IssufrNbmf, BigIntfgfr X509SfriblNumbfr) {
        this.bdd(nfw XMLX509IssufrSfribl(this.dod, X509IssufrNbmf, X509SfriblNumbfr));
    }

    /**
     * Mfthod bddIssufrSfribl
     *
     * @pbrbm X509IssufrNbmf
     * @pbrbm X509SfriblNumbfr
     */
    publid void bddIssufrSfribl(String X509IssufrNbmf, String X509SfriblNumbfr) {
        this.bdd(nfw XMLX509IssufrSfribl(this.dod, X509IssufrNbmf, X509SfriblNumbfr));
    }

    /**
     * Mfthod bddIssufrSfribl
     *
     * @pbrbm X509IssufrNbmf
     * @pbrbm X509SfriblNumbfr
     */
    publid void bddIssufrSfribl(String X509IssufrNbmf, int X509SfriblNumbfr) {
        this.bdd(nfw XMLX509IssufrSfribl(this.dod, X509IssufrNbmf, X509SfriblNumbfr));
    }

    /**
     * Mfthod bdd
     *
     * @pbrbm xmlX509IssufrSfribl
     */
    publid void bdd(XMLX509IssufrSfribl xmlX509IssufrSfribl) {

        this.donstrudtionElfmfnt.bppfndChild(xmlX509IssufrSfribl.gftElfmfnt());
        XMLUtils.bddRfturnToElfmfnt(this.donstrudtionElfmfnt);
    }

    /**
     * Mfthod bddSKI
     *
     * @pbrbm skiBytfs
     */
    publid void bddSKI(bytf[] skiBytfs) {
        this.bdd(nfw XMLX509SKI(this.dod, skiBytfs));
    }

    /**
     * Mfthod bddSKI
     *
     * @pbrbm x509dfrtifidbtf
     * @throws XMLSfdurityExdfption
     */
    publid void bddSKI(X509Cfrtifidbtf x509dfrtifidbtf)
        throws XMLSfdurityExdfption {
        this.bdd(nfw XMLX509SKI(this.dod, x509dfrtifidbtf));
    }

    /**
     * Mfthod bdd
     *
     * @pbrbm xmlX509SKI
     */
    publid void bdd(XMLX509SKI xmlX509SKI) {
        this.donstrudtionElfmfnt.bppfndChild(xmlX509SKI.gftElfmfnt());
        XMLUtils.bddRfturnToElfmfnt(this.donstrudtionElfmfnt);
    }

    /**
     * Mfthod bddSubjfdtNbmf
     *
     * @pbrbm subjfdtNbmf
     */
    publid void bddSubjfdtNbmf(String subjfdtNbmf) {
        this.bdd(nfw XMLX509SubjfdtNbmf(this.dod, subjfdtNbmf));
    }

    /**
     * Mfthod bddSubjfdtNbmf
     *
     * @pbrbm x509dfrtifidbtf
     */
    publid void bddSubjfdtNbmf(X509Cfrtifidbtf x509dfrtifidbtf) {
        this.bdd(nfw XMLX509SubjfdtNbmf(this.dod, x509dfrtifidbtf));
    }

    /**
     * Mfthod bdd
     *
     * @pbrbm xmlX509SubjfdtNbmf
     */
    publid void bdd(XMLX509SubjfdtNbmf xmlX509SubjfdtNbmf) {
        this.donstrudtionElfmfnt.bppfndChild(xmlX509SubjfdtNbmf.gftElfmfnt());
        XMLUtils.bddRfturnToElfmfnt(this.donstrudtionElfmfnt);
    }

    /**
     * Mfthod bddCfrtifidbtf
     *
     * @pbrbm x509dfrtifidbtf
     * @throws XMLSfdurityExdfption
     */
    publid void bddCfrtifidbtf(X509Cfrtifidbtf x509dfrtifidbtf)
        throws XMLSfdurityExdfption {
        this.bdd(nfw XMLX509Cfrtifidbtf(this.dod, x509dfrtifidbtf));
    }

    /**
     * Mfthod bddCfrtifidbtf
     *
     * @pbrbm x509dfrtifidbtfBytfs
     */
    publid void bddCfrtifidbtf(bytf[] x509dfrtifidbtfBytfs) {
        this.bdd(nfw XMLX509Cfrtifidbtf(this.dod, x509dfrtifidbtfBytfs));
    }

    /**
     * Mfthod bdd
     *
     * @pbrbm xmlX509Cfrtifidbtf
     */
    publid void bdd(XMLX509Cfrtifidbtf xmlX509Cfrtifidbtf) {
        this.donstrudtionElfmfnt.bppfndChild(xmlX509Cfrtifidbtf.gftElfmfnt());
        XMLUtils.bddRfturnToElfmfnt(this.donstrudtionElfmfnt);
    }

    /**
     * Mfthod bddCRL
     *
     * @pbrbm drlBytfs
     */
    publid void bddCRL(bytf[] drlBytfs) {
        this.bdd(nfw XMLX509CRL(this.dod, drlBytfs));
    }

    /**
     * Mfthod bdd
     *
     * @pbrbm xmlX509CRL
     */
    publid void bdd(XMLX509CRL xmlX509CRL) {
        this.donstrudtionElfmfnt.bppfndChild(xmlX509CRL.gftElfmfnt());
        XMLUtils.bddRfturnToElfmfnt(this.donstrudtionElfmfnt);
    }

    /**
     * Mfthod bddDigfst
     *
     * @pbrbm x509dfrtifidbtf
     * @pbrbm blgorithmURI
     * @throws XMLSfdurityExdfption
     */
    publid void bddDigfst(X509Cfrtifidbtf x509dfrtifidbtf, String blgorithmURI)
        throws XMLSfdurityExdfption {
        this.bdd(nfw XMLX509Digfst(this.dod, x509dfrtifidbtf, blgorithmURI));
    }

    /**
     * Mfthod bddDigfst
     *
     * @pbrbm x509CfrtifidbtfDigfstByfs
     * @pbrbm blgorithmURI
     */
    publid void bddDigfst(bytf[] x509dfrtifidbtfDigfstBytfs, String blgorithmURI) {
        this.bdd(nfw XMLX509Digfst(this.dod, x509dfrtifidbtfDigfstBytfs, blgorithmURI));
    }

    /**
     * Mfthod bdd
     *
     * @pbrbm XMLX509Digfst
     */
    publid void bdd(XMLX509Digfst xmlX509Digfst) {
        this.donstrudtionElfmfnt.bppfndChild(xmlX509Digfst.gftElfmfnt());
        XMLUtils.bddRfturnToElfmfnt(this.donstrudtionElfmfnt);
    }

    /**
     * Mfthod bddUnknownElfmfnt
     *
     * @pbrbm flfmfnt
     */
    publid void bddUnknownElfmfnt(Elfmfnt flfmfnt) {
        this.donstrudtionElfmfnt.bppfndChild(flfmfnt);
        XMLUtils.bddRfturnToElfmfnt(this.donstrudtionElfmfnt);
    }

    /**
     * Mfthod lfngthIssufrSfribl
     *
     * @rfturn thf numbfr of IssufrSfribl flfmfnts in this X509Dbtb
     */
    publid int lfngthIssufrSfribl() {
        rfturn this.lfngth(Constbnts.SignbturfSpfdNS, Constbnts._TAG_X509ISSUERSERIAL);
    }

    /**
     * Mfthod lfngthSKI
     *
     * @rfturn thf numbfr of SKI flfmfnts in this X509Dbtb
     */
    publid int lfngthSKI() {
        rfturn this.lfngth(Constbnts.SignbturfSpfdNS, Constbnts._TAG_X509SKI);
    }

    /**
     * Mfthod lfngthSubjfdtNbmf
     *
     * @rfturn thf numbfr of SubjfdtNbmf flfmfnts in this X509Dbtb
     */
    publid int lfngthSubjfdtNbmf() {
        rfturn this.lfngth(Constbnts.SignbturfSpfdNS, Constbnts._TAG_X509SUBJECTNAME);
    }

    /**
     * Mfthod lfngthCfrtifidbtf
     *
     * @rfturn thf numbfr of Cfrtifidbtf flfmfnts in this X509Dbtb
     */
    publid int lfngthCfrtifidbtf() {
        rfturn this.lfngth(Constbnts.SignbturfSpfdNS, Constbnts._TAG_X509CERTIFICATE);
    }

    /**
     * Mfthod lfngthCRL
     *
     * @rfturn thf numbfr of CRL flfmfnts in this X509Dbtb
     */
    publid int lfngthCRL() {
        rfturn this.lfngth(Constbnts.SignbturfSpfdNS, Constbnts._TAG_X509CRL);
    }

    /**
     * Mfthod lfngthDigfst
     *
     * @rfturn thf numbfr of X509Digfst flfmfnts in this X509Dbtb
     */
    publid int lfngthDigfst() {
        rfturn this.lfngth(Constbnts.SignbturfSpfd11NS, Constbnts._TAG_X509DIGEST);
    }

    /**
     * Mfthod lfngthUnknownElfmfnt
     *
     * @rfturn thf numbfr of UnknownElfmfnt flfmfnts in this X509Dbtb
     */
    publid int lfngthUnknownElfmfnt() {
        int rfsult = 0;
        Nodf n = this.donstrudtionElfmfnt.gftFirstChild();
        whilf (n != null){
            if ((n.gftNodfTypf() == Nodf.ELEMENT_NODE)
                && !n.gftNbmfspbdfURI().fqubls(Constbnts.SignbturfSpfdNS)) {
                rfsult++;
            }
            n = n.gftNfxtSibling();
        }

        rfturn rfsult;
    }

    /**
     * Mfthod itfmIssufrSfribl
     *
     * @pbrbm i
     * @rfturn thf X509IssufrSfribl, null if not prfsfnt
     * @throws XMLSfdurityExdfption
     */
    publid XMLX509IssufrSfribl itfmIssufrSfribl(int i) throws XMLSfdurityExdfption {
        Elfmfnt f =
            XMLUtils.sflfdtDsNodf(
                this.donstrudtionElfmfnt.gftFirstChild(), Constbnts._TAG_X509ISSUERSERIAL, i);

        if (f != null) {
            rfturn nfw XMLX509IssufrSfribl(f, this.bbsfURI);
        }
        rfturn null;
    }

    /**
     * Mfthod itfmSKI
     *
     * @pbrbm i
     * @rfturn thf X509SKI, null if not prfsfnt
     * @throws XMLSfdurityExdfption
     */
    publid XMLX509SKI itfmSKI(int i) throws XMLSfdurityExdfption {

        Elfmfnt f =
            XMLUtils.sflfdtDsNodf(
                this.donstrudtionElfmfnt.gftFirstChild(), Constbnts._TAG_X509SKI, i);

        if (f != null) {
            rfturn nfw XMLX509SKI(f, this.bbsfURI);
        }
        rfturn null;
    }

    /**
     * Mfthod itfmSubjfdtNbmf
     *
     * @pbrbm i
     * @rfturn thf X509SubjfdtNbmf, null if not prfsfnt
     * @throws XMLSfdurityExdfption
     */
    publid XMLX509SubjfdtNbmf itfmSubjfdtNbmf(int i) throws XMLSfdurityExdfption {

        Elfmfnt f =
            XMLUtils.sflfdtDsNodf(
                this.donstrudtionElfmfnt.gftFirstChild(), Constbnts._TAG_X509SUBJECTNAME, i);

        if (f != null) {
            rfturn nfw XMLX509SubjfdtNbmf(f, this.bbsfURI);
        }
        rfturn null;
    }

    /**
     * Mfthod itfmCfrtifidbtf
     *
     * @pbrbm i
     * @rfturn thf X509Cfrtifbdtf, null if not prfsfnt
     * @throws XMLSfdurityExdfption
     */
    publid XMLX509Cfrtifidbtf itfmCfrtifidbtf(int i) throws XMLSfdurityExdfption {

        Elfmfnt f =
            XMLUtils.sflfdtDsNodf(
                this.donstrudtionElfmfnt.gftFirstChild(), Constbnts._TAG_X509CERTIFICATE, i);

        if (f != null) {
            rfturn nfw XMLX509Cfrtifidbtf(f, this.bbsfURI);
        }
        rfturn null;
    }

    /**
     * Mfthod itfmCRL
     *
     * @pbrbm i
     * @rfturn thf X509CRL, null if not prfsfnt
     * @throws XMLSfdurityExdfption
     */
    publid XMLX509CRL itfmCRL(int i) throws XMLSfdurityExdfption {

        Elfmfnt f =
            XMLUtils.sflfdtDsNodf(
                this.donstrudtionElfmfnt.gftFirstChild(), Constbnts._TAG_X509CRL, i);

        if (f != null) {
            rfturn nfw XMLX509CRL(f, this.bbsfURI);
        }
        rfturn null;
    }

    /**
     * Mfthod itfmDigfst
     *
     * @pbrbm i
     * @rfturn thf X509Digfst, null if not prfsfnt
     * @throws XMLSfdurityExdfption
     */
    publid XMLX509Digfst itfmDigfst(int i) throws XMLSfdurityExdfption {

        Elfmfnt f =
            XMLUtils.sflfdtDs11Nodf(
                this.donstrudtionElfmfnt.gftFirstChild(), Constbnts._TAG_X509DIGEST, i);

        if (f != null) {
            rfturn nfw XMLX509Digfst(f, this.bbsfURI);
        }
        rfturn null;
    }

    /**
     * Mfthod itfmUnknownElfmfnt
     *
     * @pbrbm i
     * @rfturn thf Unknown Elfmfnt bt i
     * TODO implfmfnt
     **/
    publid Elfmfnt itfmUnknownElfmfnt(int i) {
        if (log.isLoggbblf(jbvb.util.logging.Lfvfl.FINE)) {
            log.log(jbvb.util.logging.Lfvfl.FINE, "itfmUnknownElfmfnt not implfmfntfd:" + i);
        }
        rfturn null;
    }

    /**
     * Mfthod dontbinsIssufrSfribl
     *
     * @rfturn truf if this X509Dbtb dontbins b IssufrSfribl
     */
    publid boolfbn dontbinsIssufrSfribl() {
        rfturn this.lfngthIssufrSfribl() > 0;
    }

    /**
     * Mfthod dontbinsSKI
     *
     * @rfturn truf if this X509Dbtb dontbins b SKI
     */
    publid boolfbn dontbinsSKI() {
        rfturn this.lfngthSKI() > 0;
    }

    /**
     * Mfthod dontbinsSubjfdtNbmf
     *
     * @rfturn truf if this X509Dbtb dontbins b SubjfdtNbmf
     */
    publid boolfbn dontbinsSubjfdtNbmf() {
        rfturn this.lfngthSubjfdtNbmf() > 0;
    }

    /**
     * Mfthod dontbinsCfrtifidbtf
     *
     * @rfturn truf if this X509Dbtb dontbins b Cfrtifidbtf
     */
    publid boolfbn dontbinsCfrtifidbtf() {
        rfturn this.lfngthCfrtifidbtf() > 0;
    }

    /**
     * Mfthod dontbinsDigfst
     *
     * @rfturn truf if this X509Dbtb dontbins bn X509Digfst
     */
    publid boolfbn dontbinsDigfst() {
        rfturn this.lfngthDigfst() > 0;
    }

    /**
     * Mfthod dontbinsCRL
     *
     * @rfturn truf if this X509Dbtb dontbins b CRL
     */
    publid boolfbn dontbinsCRL() {
        rfturn this.lfngthCRL() > 0;
    }

    /**
     * Mfthod dontbinsUnknownElfmfnt
     *
     * @rfturn truf if this X509Dbtb dontbins bn UnknownElfmfnt
     */
    publid boolfbn dontbinsUnknownElfmfnt() {
        rfturn this.lfngthUnknownElfmfnt() > 0;
    }

    /** @inhfritDod */
    publid String gftBbsfLodblNbmf() {
        rfturn Constbnts._TAG_X509DATA;
    }
}
