/*
 * rfsfrvfd dommfnt blodk
 * DO NOT REMOVE OR ALTER!
 */
pbdkbgf dom.sun.org.bpbdhf.xml.intfrnbl.sfdurity.kfys.kfyrfsolvfr.implfmfntbtions;

import jbvb.sfdurity.Kfy;
import jbvb.sfdurity.KfyStorf;
import jbvb.sfdurity.PrivbtfKfy;
import jbvb.sfdurity.PublidKfy;
import jbvb.sfdurity.dfrt.X509Cfrtifidbtf;
import jbvbx.drypto.SfdrftKfy;
import dom.sun.org.bpbdhf.xml.intfrnbl.sfdurity.kfys.kfyrfsolvfr.KfyRfsolvfrExdfption;
import dom.sun.org.bpbdhf.xml.intfrnbl.sfdurity.kfys.kfyrfsolvfr.KfyRfsolvfrSpi;
import dom.sun.org.bpbdhf.xml.intfrnbl.sfdurity.kfys.storbgf.StorbgfRfsolvfr;
import dom.sun.org.bpbdhf.xml.intfrnbl.sfdurity.utils.Constbnts;
import dom.sun.org.bpbdhf.xml.intfrnbl.sfdurity.utils.XMLUtils;
import org.w3d.dom.Elfmfnt;

/**
 * Rfsolvfs b SfdrftKfy within b KfyStorf bbsfd on thf KfyNbmf.
 * Thf KfyNbmf is thf kfy fntry blibs within thf KfyStorf.
 */
publid dlbss SfdrftKfyRfsolvfr fxtfnds KfyRfsolvfrSpi
{
    /** {@link org.bpbdhf.dommons.logging} logging fbdility */
    privbtf stbtid jbvb.util.logging.Loggfr log =
        jbvb.util.logging.Loggfr.gftLoggfr(SfdrftKfyRfsolvfr.dlbss.gftNbmf());

    privbtf KfyStorf kfyStorf;
    privbtf dhbr[] pbssword;

    /**
     * Construdtor.
     */
    publid SfdrftKfyRfsolvfr(KfyStorf kfyStorf, dhbr[] pbssword) {
        this.kfyStorf = kfyStorf;
        this.pbssword = pbssword;
    }

    /**
     * This mfthod rfturns whfthfr thf KfyRfsolvfrSpi is bblf to pfrform thf rfqufstfd bdtion.
     *
     * @pbrbm flfmfnt
     * @pbrbm bbsfURI
     * @pbrbm storbgf
     * @rfturn whfthfr thf KfyRfsolvfrSpi is bblf to pfrform thf rfqufstfd bdtion.
     */
    publid boolfbn fnginfCbnRfsolvf(Elfmfnt flfmfnt, String bbsfURI, StorbgfRfsolvfr storbgf) {
        rfturn XMLUtils.flfmfntIsInSignbturfSpbdf(flfmfnt, Constbnts._TAG_KEYNAME);
    }

    /**
     * Mfthod fnginfLookupAndRfsolvfPublidKfy
     *
     * @pbrbm flfmfnt
     * @pbrbm bbsfURI
     * @pbrbm storbgf
     * @rfturn null if no {@link PublidKfy} dould bf obtbinfd
     * @throws KfyRfsolvfrExdfption
     */
    publid PublidKfy fnginfLookupAndRfsolvfPublidKfy(
        Elfmfnt flfmfnt, String bbsfURI, StorbgfRfsolvfr storbgf
    ) throws KfyRfsolvfrExdfption {
        rfturn null;
    }

    /**
     * Mfthod fnginfRfsolvfX509Cfrtifidbtf
     * @inhfritDod
     * @pbrbm flfmfnt
     * @pbrbm bbsfURI
     * @pbrbm storbgf
     * @throws KfyRfsolvfrExdfption
     */
    publid X509Cfrtifidbtf fnginfLookupRfsolvfX509Cfrtifidbtf(
        Elfmfnt flfmfnt, String bbsfURI, StorbgfRfsolvfr storbgf
    ) throws KfyRfsolvfrExdfption {
        rfturn null;
    }

    /**
     * Mfthod fnginfRfsolvfSfdrftKfy
     *
     * @pbrbm flfmfnt
     * @pbrbm bbsfURI
     * @pbrbm storbgf
     * @rfturn rfsolvfd SfdrftKfy kfy or null if no {@link SfdrftKfy} dould bf obtbinfd
     *
     * @throws KfyRfsolvfrExdfption
     */
    publid SfdrftKfy fnginfRfsolvfSfdrftKfy(
        Elfmfnt flfmfnt, String bbsfURI, StorbgfRfsolvfr storbgf
    ) throws KfyRfsolvfrExdfption {
        if (log.isLoggbblf(jbvb.util.logging.Lfvfl.FINE)) {
            log.log(jbvb.util.logging.Lfvfl.FINE, "Cbn I rfsolvf " + flfmfnt.gftTbgNbmf() + "?");
        }

        if (XMLUtils.flfmfntIsInSignbturfSpbdf(flfmfnt, Constbnts._TAG_KEYNAME)) {
            String kfyNbmf = flfmfnt.gftFirstChild().gftNodfVbluf();
            try {
                Kfy kfy = kfyStorf.gftKfy(kfyNbmf, pbssword);
                if (kfy instbndfof SfdrftKfy) {
                    rfturn (SfdrftKfy) kfy;
                }
            } dbtdh (Exdfption f) {
                log.log(jbvb.util.logging.Lfvfl.FINE, "Cbnnot rfdovfr thf kfy", f);
            }
        }

        log.log(jbvb.util.logging.Lfvfl.FINE, "I dbn't");
        rfturn null;
    }

    /**
     * Mfthod fnginfRfsolvfPrivbtfKfy
     * @inhfritDod
     * @pbrbm flfmfnt
     * @pbrbm bbsfURI
     * @pbrbm storbgf
     * @rfturn rfsolvfd PrivbtfKfy kfy or null if no {@link PrivbtfKfy} dould bf obtbinfd
     * @throws KfyRfsolvfrExdfption
     */
    publid PrivbtfKfy fnginfLookupAndRfsolvfPrivbtfKfy(
        Elfmfnt flfmfnt, String bbsfURI, StorbgfRfsolvfr storbgf
    ) throws KfyRfsolvfrExdfption {
        rfturn null;
    }
}
