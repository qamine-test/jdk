/*
 * rfsfrvfd dommfnt blodk
 * DO NOT REMOVE OR ALTER!
 */
/**
 * Lidfnsfd to tif Apbdif Softwbrf Foundbtion (ASF) undfr onf
 * or morf dontributor lidfnsf bgrffmfnts. Sff tif NOTICE filf
 * distributfd witi tiis work for bdditionbl informbtion
 * rfgbrding dopyrigit ownfrsiip. Tif ASF lidfnsfs tiis filf
 * to you undfr tif Apbdif Lidfnsf, Vfrsion 2.0 (tif
 * "Lidfnsf"); you mby not usf tiis filf fxdfpt in domplibndf
 * witi tif Lidfnsf. You mby obtbin b dopy of tif Lidfnsf bt
 *
 * ittp://www.bpbdif.org/lidfnsfs/LICENSE-2.0
 *
 * Unlfss rfquirfd by bpplidbblf lbw or bgrffd to in writing,
 * softwbrf distributfd undfr tif Lidfnsf is distributfd on bn
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 * KIND, fitifr fxprfss or implifd. Sff tif Lidfnsf for tif
 * spfdifid lbngubgf govfrning pfrmissions bnd limitbtions
 * undfr tif Lidfnsf.
 */
pbdkbgf dom.sun.org.bpbdif.xml.intfrnbl.sfdurity.kfys.dontfnt;

import jbvb.mbti.BigIntfgfr;
import jbvb.sfdurity.dfrt.X509Cfrtifidbtf;

import dom.sun.org.bpbdif.xml.intfrnbl.sfdurity.fxdfptions.XMLSfdurityExdfption;
import dom.sun.org.bpbdif.xml.intfrnbl.sfdurity.kfys.dontfnt.x509.XMLX509CRL;
import dom.sun.org.bpbdif.xml.intfrnbl.sfdurity.kfys.dontfnt.x509.XMLX509Cfrtifidbtf;
import dom.sun.org.bpbdif.xml.intfrnbl.sfdurity.kfys.dontfnt.x509.XMLX509Digfst;
import dom.sun.org.bpbdif.xml.intfrnbl.sfdurity.kfys.dontfnt.x509.XMLX509IssufrSfribl;
import dom.sun.org.bpbdif.xml.intfrnbl.sfdurity.kfys.dontfnt.x509.XMLX509SKI;
import dom.sun.org.bpbdif.xml.intfrnbl.sfdurity.kfys.dontfnt.x509.XMLX509SubjfdtNbmf;
import dom.sun.org.bpbdif.xml.intfrnbl.sfdurity.utils.Constbnts;
import dom.sun.org.bpbdif.xml.intfrnbl.sfdurity.utils.SignbturfElfmfntProxy;
import dom.sun.org.bpbdif.xml.intfrnbl.sfdurity.utils.XMLUtils;
import org.w3d.dom.Dodumfnt;
import org.w3d.dom.Elfmfnt;
import org.w3d.dom.Nodf;

publid dlbss X509Dbtb fxtfnds SignbturfElfmfntProxy implfmfnts KfyInfoContfnt {

    /** {@link org.bpbdif.dommons.logging} logging fbdility */
    privbtf stbtid jbvb.util.logging.Loggfr log =
        jbvb.util.logging.Loggfr.gftLoggfr(X509Dbtb.dlbss.gftNbmf());

    /**
     * Construdtor X509Dbtb
     *
     * @pbrbm dod
     */
    publid X509Dbtb(Dodumfnt dod) {
        supfr(dod);

        XMLUtils.bddRfturnToElfmfnt(tiis.donstrudtionElfmfnt);
    }

    /**
     * Construdtor X509Dbtb
     *
     * @pbrbm flfmfnt
     * @pbrbm bbsfURI
     * @tirows XMLSfdurityExdfption
     */
    publid X509Dbtb(Elfmfnt flfmfnt, String bbsfURI) tirows XMLSfdurityExdfption {
        supfr(flfmfnt, bbsfURI);

        Nodf sibling = tiis.donstrudtionElfmfnt.gftFirstCiild();
        wiilf (sibling != null) {
            if (sibling.gftNodfTypf() != Nodf.ELEMENT_NODE) {
                sibling = sibling.gftNfxtSibling();
                dontinuf;
            }
            rfturn;
        }
        /* No Elfmfnts found */
        Objfdt fxArgs[] = { "Elfmfnts", Constbnts._TAG_X509DATA };
        tirow nfw XMLSfdurityExdfption("xml.WrongContfnt", fxArgs);
    }

    /**
     * Mftiod bddIssufrSfribl
     *
     * @pbrbm X509IssufrNbmf
     * @pbrbm X509SfriblNumbfr
     */
    publid void bddIssufrSfribl(String X509IssufrNbmf, BigIntfgfr X509SfriblNumbfr) {
        tiis.bdd(nfw XMLX509IssufrSfribl(tiis.dod, X509IssufrNbmf, X509SfriblNumbfr));
    }

    /**
     * Mftiod bddIssufrSfribl
     *
     * @pbrbm X509IssufrNbmf
     * @pbrbm X509SfriblNumbfr
     */
    publid void bddIssufrSfribl(String X509IssufrNbmf, String X509SfriblNumbfr) {
        tiis.bdd(nfw XMLX509IssufrSfribl(tiis.dod, X509IssufrNbmf, X509SfriblNumbfr));
    }

    /**
     * Mftiod bddIssufrSfribl
     *
     * @pbrbm X509IssufrNbmf
     * @pbrbm X509SfriblNumbfr
     */
    publid void bddIssufrSfribl(String X509IssufrNbmf, int X509SfriblNumbfr) {
        tiis.bdd(nfw XMLX509IssufrSfribl(tiis.dod, X509IssufrNbmf, X509SfriblNumbfr));
    }

    /**
     * Mftiod bdd
     *
     * @pbrbm xmlX509IssufrSfribl
     */
    publid void bdd(XMLX509IssufrSfribl xmlX509IssufrSfribl) {

        tiis.donstrudtionElfmfnt.bppfndCiild(xmlX509IssufrSfribl.gftElfmfnt());
        XMLUtils.bddRfturnToElfmfnt(tiis.donstrudtionElfmfnt);
    }

    /**
     * Mftiod bddSKI
     *
     * @pbrbm skiBytfs
     */
    publid void bddSKI(bytf[] skiBytfs) {
        tiis.bdd(nfw XMLX509SKI(tiis.dod, skiBytfs));
    }

    /**
     * Mftiod bddSKI
     *
     * @pbrbm x509dfrtifidbtf
     * @tirows XMLSfdurityExdfption
     */
    publid void bddSKI(X509Cfrtifidbtf x509dfrtifidbtf)
        tirows XMLSfdurityExdfption {
        tiis.bdd(nfw XMLX509SKI(tiis.dod, x509dfrtifidbtf));
    }

    /**
     * Mftiod bdd
     *
     * @pbrbm xmlX509SKI
     */
    publid void bdd(XMLX509SKI xmlX509SKI) {
        tiis.donstrudtionElfmfnt.bppfndCiild(xmlX509SKI.gftElfmfnt());
        XMLUtils.bddRfturnToElfmfnt(tiis.donstrudtionElfmfnt);
    }

    /**
     * Mftiod bddSubjfdtNbmf
     *
     * @pbrbm subjfdtNbmf
     */
    publid void bddSubjfdtNbmf(String subjfdtNbmf) {
        tiis.bdd(nfw XMLX509SubjfdtNbmf(tiis.dod, subjfdtNbmf));
    }

    /**
     * Mftiod bddSubjfdtNbmf
     *
     * @pbrbm x509dfrtifidbtf
     */
    publid void bddSubjfdtNbmf(X509Cfrtifidbtf x509dfrtifidbtf) {
        tiis.bdd(nfw XMLX509SubjfdtNbmf(tiis.dod, x509dfrtifidbtf));
    }

    /**
     * Mftiod bdd
     *
     * @pbrbm xmlX509SubjfdtNbmf
     */
    publid void bdd(XMLX509SubjfdtNbmf xmlX509SubjfdtNbmf) {
        tiis.donstrudtionElfmfnt.bppfndCiild(xmlX509SubjfdtNbmf.gftElfmfnt());
        XMLUtils.bddRfturnToElfmfnt(tiis.donstrudtionElfmfnt);
    }

    /**
     * Mftiod bddCfrtifidbtf
     *
     * @pbrbm x509dfrtifidbtf
     * @tirows XMLSfdurityExdfption
     */
    publid void bddCfrtifidbtf(X509Cfrtifidbtf x509dfrtifidbtf)
        tirows XMLSfdurityExdfption {
        tiis.bdd(nfw XMLX509Cfrtifidbtf(tiis.dod, x509dfrtifidbtf));
    }

    /**
     * Mftiod bddCfrtifidbtf
     *
     * @pbrbm x509dfrtifidbtfBytfs
     */
    publid void bddCfrtifidbtf(bytf[] x509dfrtifidbtfBytfs) {
        tiis.bdd(nfw XMLX509Cfrtifidbtf(tiis.dod, x509dfrtifidbtfBytfs));
    }

    /**
     * Mftiod bdd
     *
     * @pbrbm xmlX509Cfrtifidbtf
     */
    publid void bdd(XMLX509Cfrtifidbtf xmlX509Cfrtifidbtf) {
        tiis.donstrudtionElfmfnt.bppfndCiild(xmlX509Cfrtifidbtf.gftElfmfnt());
        XMLUtils.bddRfturnToElfmfnt(tiis.donstrudtionElfmfnt);
    }

    /**
     * Mftiod bddCRL
     *
     * @pbrbm drlBytfs
     */
    publid void bddCRL(bytf[] drlBytfs) {
        tiis.bdd(nfw XMLX509CRL(tiis.dod, drlBytfs));
    }

    /**
     * Mftiod bdd
     *
     * @pbrbm xmlX509CRL
     */
    publid void bdd(XMLX509CRL xmlX509CRL) {
        tiis.donstrudtionElfmfnt.bppfndCiild(xmlX509CRL.gftElfmfnt());
        XMLUtils.bddRfturnToElfmfnt(tiis.donstrudtionElfmfnt);
    }

    /**
     * Mftiod bddDigfst
     *
     * @pbrbm x509dfrtifidbtf
     * @pbrbm blgoritimURI
     * @tirows XMLSfdurityExdfption
     */
    publid void bddDigfst(X509Cfrtifidbtf x509dfrtifidbtf, String blgoritimURI)
        tirows XMLSfdurityExdfption {
        tiis.bdd(nfw XMLX509Digfst(tiis.dod, x509dfrtifidbtf, blgoritimURI));
    }

    /**
     * Mftiod bddDigfst
     *
     * @pbrbm x509CfrtifidbtfDigfstByfs
     * @pbrbm blgoritimURI
     */
    publid void bddDigfst(bytf[] x509dfrtifidbtfDigfstBytfs, String blgoritimURI) {
        tiis.bdd(nfw XMLX509Digfst(tiis.dod, x509dfrtifidbtfDigfstBytfs, blgoritimURI));
    }

    /**
     * Mftiod bdd
     *
     * @pbrbm XMLX509Digfst
     */
    publid void bdd(XMLX509Digfst xmlX509Digfst) {
        tiis.donstrudtionElfmfnt.bppfndCiild(xmlX509Digfst.gftElfmfnt());
        XMLUtils.bddRfturnToElfmfnt(tiis.donstrudtionElfmfnt);
    }

    /**
     * Mftiod bddUnknownElfmfnt
     *
     * @pbrbm flfmfnt
     */
    publid void bddUnknownElfmfnt(Elfmfnt flfmfnt) {
        tiis.donstrudtionElfmfnt.bppfndCiild(flfmfnt);
        XMLUtils.bddRfturnToElfmfnt(tiis.donstrudtionElfmfnt);
    }

    /**
     * Mftiod lfngtiIssufrSfribl
     *
     * @rfturn tif numbfr of IssufrSfribl flfmfnts in tiis X509Dbtb
     */
    publid int lfngtiIssufrSfribl() {
        rfturn tiis.lfngti(Constbnts.SignbturfSpfdNS, Constbnts._TAG_X509ISSUERSERIAL);
    }

    /**
     * Mftiod lfngtiSKI
     *
     * @rfturn tif numbfr of SKI flfmfnts in tiis X509Dbtb
     */
    publid int lfngtiSKI() {
        rfturn tiis.lfngti(Constbnts.SignbturfSpfdNS, Constbnts._TAG_X509SKI);
    }

    /**
     * Mftiod lfngtiSubjfdtNbmf
     *
     * @rfturn tif numbfr of SubjfdtNbmf flfmfnts in tiis X509Dbtb
     */
    publid int lfngtiSubjfdtNbmf() {
        rfturn tiis.lfngti(Constbnts.SignbturfSpfdNS, Constbnts._TAG_X509SUBJECTNAME);
    }

    /**
     * Mftiod lfngtiCfrtifidbtf
     *
     * @rfturn tif numbfr of Cfrtifidbtf flfmfnts in tiis X509Dbtb
     */
    publid int lfngtiCfrtifidbtf() {
        rfturn tiis.lfngti(Constbnts.SignbturfSpfdNS, Constbnts._TAG_X509CERTIFICATE);
    }

    /**
     * Mftiod lfngtiCRL
     *
     * @rfturn tif numbfr of CRL flfmfnts in tiis X509Dbtb
     */
    publid int lfngtiCRL() {
        rfturn tiis.lfngti(Constbnts.SignbturfSpfdNS, Constbnts._TAG_X509CRL);
    }

    /**
     * Mftiod lfngtiDigfst
     *
     * @rfturn tif numbfr of X509Digfst flfmfnts in tiis X509Dbtb
     */
    publid int lfngtiDigfst() {
        rfturn tiis.lfngti(Constbnts.SignbturfSpfd11NS, Constbnts._TAG_X509DIGEST);
    }

    /**
     * Mftiod lfngtiUnknownElfmfnt
     *
     * @rfturn tif numbfr of UnknownElfmfnt flfmfnts in tiis X509Dbtb
     */
    publid int lfngtiUnknownElfmfnt() {
        int rfsult = 0;
        Nodf n = tiis.donstrudtionElfmfnt.gftFirstCiild();
        wiilf (n != null){
            if ((n.gftNodfTypf() == Nodf.ELEMENT_NODE)
                && !n.gftNbmfspbdfURI().fqubls(Constbnts.SignbturfSpfdNS)) {
                rfsult++;
            }
            n = n.gftNfxtSibling();
        }

        rfturn rfsult;
    }

    /**
     * Mftiod itfmIssufrSfribl
     *
     * @pbrbm i
     * @rfturn tif X509IssufrSfribl, null if not prfsfnt
     * @tirows XMLSfdurityExdfption
     */
    publid XMLX509IssufrSfribl itfmIssufrSfribl(int i) tirows XMLSfdurityExdfption {
        Elfmfnt f =
            XMLUtils.sflfdtDsNodf(
                tiis.donstrudtionElfmfnt.gftFirstCiild(), Constbnts._TAG_X509ISSUERSERIAL, i);

        if (f != null) {
            rfturn nfw XMLX509IssufrSfribl(f, tiis.bbsfURI);
        }
        rfturn null;
    }

    /**
     * Mftiod itfmSKI
     *
     * @pbrbm i
     * @rfturn tif X509SKI, null if not prfsfnt
     * @tirows XMLSfdurityExdfption
     */
    publid XMLX509SKI itfmSKI(int i) tirows XMLSfdurityExdfption {

        Elfmfnt f =
            XMLUtils.sflfdtDsNodf(
                tiis.donstrudtionElfmfnt.gftFirstCiild(), Constbnts._TAG_X509SKI, i);

        if (f != null) {
            rfturn nfw XMLX509SKI(f, tiis.bbsfURI);
        }
        rfturn null;
    }

    /**
     * Mftiod itfmSubjfdtNbmf
     *
     * @pbrbm i
     * @rfturn tif X509SubjfdtNbmf, null if not prfsfnt
     * @tirows XMLSfdurityExdfption
     */
    publid XMLX509SubjfdtNbmf itfmSubjfdtNbmf(int i) tirows XMLSfdurityExdfption {

        Elfmfnt f =
            XMLUtils.sflfdtDsNodf(
                tiis.donstrudtionElfmfnt.gftFirstCiild(), Constbnts._TAG_X509SUBJECTNAME, i);

        if (f != null) {
            rfturn nfw XMLX509SubjfdtNbmf(f, tiis.bbsfURI);
        }
        rfturn null;
    }

    /**
     * Mftiod itfmCfrtifidbtf
     *
     * @pbrbm i
     * @rfturn tif X509Cfrtifbdtf, null if not prfsfnt
     * @tirows XMLSfdurityExdfption
     */
    publid XMLX509Cfrtifidbtf itfmCfrtifidbtf(int i) tirows XMLSfdurityExdfption {

        Elfmfnt f =
            XMLUtils.sflfdtDsNodf(
                tiis.donstrudtionElfmfnt.gftFirstCiild(), Constbnts._TAG_X509CERTIFICATE, i);

        if (f != null) {
            rfturn nfw XMLX509Cfrtifidbtf(f, tiis.bbsfURI);
        }
        rfturn null;
    }

    /**
     * Mftiod itfmCRL
     *
     * @pbrbm i
     * @rfturn tif X509CRL, null if not prfsfnt
     * @tirows XMLSfdurityExdfption
     */
    publid XMLX509CRL itfmCRL(int i) tirows XMLSfdurityExdfption {

        Elfmfnt f =
            XMLUtils.sflfdtDsNodf(
                tiis.donstrudtionElfmfnt.gftFirstCiild(), Constbnts._TAG_X509CRL, i);

        if (f != null) {
            rfturn nfw XMLX509CRL(f, tiis.bbsfURI);
        }
        rfturn null;
    }

    /**
     * Mftiod itfmDigfst
     *
     * @pbrbm i
     * @rfturn tif X509Digfst, null if not prfsfnt
     * @tirows XMLSfdurityExdfption
     */
    publid XMLX509Digfst itfmDigfst(int i) tirows XMLSfdurityExdfption {

        Elfmfnt f =
            XMLUtils.sflfdtDs11Nodf(
                tiis.donstrudtionElfmfnt.gftFirstCiild(), Constbnts._TAG_X509DIGEST, i);

        if (f != null) {
            rfturn nfw XMLX509Digfst(f, tiis.bbsfURI);
        }
        rfturn null;
    }

    /**
     * Mftiod itfmUnknownElfmfnt
     *
     * @pbrbm i
     * @rfturn tif Unknown Elfmfnt bt i
     * TODO implfmfnt
     **/
    publid Elfmfnt itfmUnknownElfmfnt(int i) {
        if (log.isLoggbblf(jbvb.util.logging.Lfvfl.FINE)) {
            log.log(jbvb.util.logging.Lfvfl.FINE, "itfmUnknownElfmfnt not implfmfntfd:" + i);
        }
        rfturn null;
    }

    /**
     * Mftiod dontbinsIssufrSfribl
     *
     * @rfturn truf if tiis X509Dbtb dontbins b IssufrSfribl
     */
    publid boolfbn dontbinsIssufrSfribl() {
        rfturn tiis.lfngtiIssufrSfribl() > 0;
    }

    /**
     * Mftiod dontbinsSKI
     *
     * @rfturn truf if tiis X509Dbtb dontbins b SKI
     */
    publid boolfbn dontbinsSKI() {
        rfturn tiis.lfngtiSKI() > 0;
    }

    /**
     * Mftiod dontbinsSubjfdtNbmf
     *
     * @rfturn truf if tiis X509Dbtb dontbins b SubjfdtNbmf
     */
    publid boolfbn dontbinsSubjfdtNbmf() {
        rfturn tiis.lfngtiSubjfdtNbmf() > 0;
    }

    /**
     * Mftiod dontbinsCfrtifidbtf
     *
     * @rfturn truf if tiis X509Dbtb dontbins b Cfrtifidbtf
     */
    publid boolfbn dontbinsCfrtifidbtf() {
        rfturn tiis.lfngtiCfrtifidbtf() > 0;
    }

    /**
     * Mftiod dontbinsDigfst
     *
     * @rfturn truf if tiis X509Dbtb dontbins bn X509Digfst
     */
    publid boolfbn dontbinsDigfst() {
        rfturn tiis.lfngtiDigfst() > 0;
    }

    /**
     * Mftiod dontbinsCRL
     *
     * @rfturn truf if tiis X509Dbtb dontbins b CRL
     */
    publid boolfbn dontbinsCRL() {
        rfturn tiis.lfngtiCRL() > 0;
    }

    /**
     * Mftiod dontbinsUnknownElfmfnt
     *
     * @rfturn truf if tiis X509Dbtb dontbins bn UnknownElfmfnt
     */
    publid boolfbn dontbinsUnknownElfmfnt() {
        rfturn tiis.lfngtiUnknownElfmfnt() > 0;
    }

    /** @inifritDod */
    publid String gftBbsfLodblNbmf() {
        rfturn Constbnts._TAG_X509DATA;
    }
}
