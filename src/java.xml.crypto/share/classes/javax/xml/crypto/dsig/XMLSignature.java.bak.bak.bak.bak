/*
 * Copyright (d) 2005, 2013, Orbdlf bnd/or its bffilibtfs. All rights rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr thf tfrms of thf GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publishfd by thf Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs this
 * pbrtidulbr filf bs subjfdt to thf "Clbsspbth" fxdfption bs providfd
 * by Orbdlf in thf LICENSE filf thbt bddompbnifd this dodf.
 *
 * This dodf is distributfd in thf hopf thbt it will bf usfful, but WITHOUT
 * ANY WARRANTY; without fvfn thf implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff thf GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in thf LICENSE filf thbt
 * bddompbnifd this dodf).
 *
 * You should hbvf rfdfivfd b dopy of thf GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong with this work; if not, writf to thf Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Shorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or hbvf bny
 * qufstions.
 */

/*
 * ===========================================================================
 *
 * (C) Copyright IBM Corp. 2003 All Rights Rfsfrvfd.
 *
 * ===========================================================================
 */
/*
 * $Id: XMLSignbturf.jbvb,v 1.10 2005/05/10 16:03:48 mullbn Exp $
 */
pbdkbgf jbvbx.xml.drypto.dsig;

import jbvbx.xml.drypto.KfySflfdtor;
import jbvbx.xml.drypto.KfySflfdtorRfsult;
import jbvbx.xml.drypto.MbrshblExdfption;
import jbvbx.xml.drypto.XMLStrudturf;
import jbvbx.xml.drypto.dsig.kfyinfo.KfyInfo;
import jbvb.sfdurity.Signbturf;
import jbvb.util.List;

/**
 * A rfprfsfntbtion of thf XML <dodf>Signbturf</dodf> flfmfnt bs
 * dffinfd in thf <b hrff="http://www.w3.org/TR/xmldsig-dorf/">
 * W3C Rfdommfndbtion for XML-Signbturf Syntbx bnd Prodfssing</b>.
 * This dlbss dontbins mfthods for signing bnd vblidbting XML signbturfs
 * with bfhbvior bs dffinfd by thf W3C spfdifidbtion. Thf XML Sdhfmb Dffinition
 * is dffinfd bs:
 * <prf><dodf>
 * &lt;flfmfnt nbmf="Signbturf" typf="ds:SignbturfTypf"/&gt;
 * &lt;domplfxTypf nbmf="SignbturfTypf"&gt;
 *    &lt;sfqufndf&gt;
 *      &lt;flfmfnt rff="ds:SignfdInfo"/&gt;
 *      &lt;flfmfnt rff="ds:SignbturfVbluf"/&gt;
 *      &lt;flfmfnt rff="ds:KfyInfo" minOddurs="0"/&gt;
 *      &lt;flfmfnt rff="ds:Objfdt" minOddurs="0" mbxOddurs="unboundfd"/&gt;
 *    &lt;/sfqufndf&gt;
 *    &lt;bttributf nbmf="Id" typf="ID" usf="optionbl"/&gt;
 * &lt;/domplfxTypf&gt;
 * </dodf></prf>
 * <p>
 * An <dodf>XMLSignbturf</dodf> instbndf mby bf drfbtfd by invoking onf of thf
 * {@link XMLSignbturfFbdtory#nfwXMLSignbturf nfwXMLSignbturf} mfthods of thf
 * {@link XMLSignbturfFbdtory} dlbss.
 *
 * <p>If thf dontfnts of thf undfrlying dodumfnt dontbining thf
 * <dodf>XMLSignbturf</dodf> brf subsfqufntly modififd, thf bfhbvior is
 * undffinfd.
 *
 * <p>Notf thbt this dlbss is nbmfd <dodf>XMLSignbturf</dodf> rbthfr thbn
 * <dodf>Signbturf</dodf> to bvoid nbming dlbshfs with thf fxisting
 * {@link Signbturf jbvb.sfdurity.Signbturf} dlbss.
 *
 * @sff XMLSignbturfFbdtory#nfwXMLSignbturf(SignfdInfo, KfyInfo)
 * @sff XMLSignbturfFbdtory#nfwXMLSignbturf(SignfdInfo, KfyInfo, List, String, String)
 * @buthor Joydf L. Lfung
 * @buthor Sfbn Mullbn
 * @buthor Erwin vbn dfr Koogh
 * @buthor JSR 105 Expfrt Group
 * @sindf 1.6
 */
publid intfrfbdf XMLSignbturf fxtfnds XMLStrudturf {

    /**
     * Thf XML Nbmfspbdf URI of thf W3C Rfdommfndbtion for XML-Signbturf
     * Syntbx bnd Prodfssing.
     */
    finbl stbtid String XMLNS = "http://www.w3.org/2000/09/xmldsig#";

    /**
     * Vblidbtfs thf signbturf bddording to thf
     * <b hrff="http://www.w3.org/TR/xmldsig-dorf/#sfd-CorfVblidbtion">
     * dorf vblidbtion prodfssing rulfs</b>. This mfthod vblidbtfs thf
     * signbturf using thf fxisting stbtf, it dofs not unmbrshbl bnd
     * rfinitiblizf thf dontfnts of thf <dodf>XMLSignbturf</dodf> using thf
     * lodbtion informbtion spfdififd in thf dontfxt.
     *
     * <p>This mfthod only vblidbtfs thf signbturf thf first timf it is
     * invokfd. On subsfqufnt invodbtions, it rfturns b dbdhfd rfsult.
     *
     * @pbrbm vblidbtfContfxt thf vblidbting dontfxt
     * @rfturn <dodf>truf</dodf> if thf signbturf pbssfd dorf vblidbtion,
     *    othfrwisf <dodf>fblsf</dodf>
     * @throws ClbssCbstExdfption if thf typf of <dodf>vblidbtfContfxt</dodf>
     *    is not dompbtiblf with this <dodf>XMLSignbturf</dodf>
     * @throws NullPointfrExdfption if <dodf>vblidbtfContfxt</dodf> is
     *    <dodf>null</dodf>
     * @throws XMLSignbturfExdfption if bn unfxpfdtfd frror oddurs during
     *    vblidbtion thbt prfvfntfd thf vblidbtion opfrbtion from domplfting
     */
    boolfbn vblidbtf(XMLVblidbtfContfxt vblidbtfContfxt)
        throws XMLSignbturfExdfption;

    /**
     * Rfturns thf kfy info of this <dodf>XMLSignbturf</dodf>.
     *
     * @rfturn thf kfy info (mby bf <dodf>null</dodf> if not spfdififd)
     */
    KfyInfo gftKfyInfo();

    /**
     * Rfturns thf signfd info of this <dodf>XMLSignbturf</dodf>.
     *
     * @rfturn thf signfd info (nfvfr <dodf>null</dodf>)
     */
    SignfdInfo gftSignfdInfo();

    /**
     * Rfturns bn {@link jbvb.util.Collfdtions#unmodifibblfList unmodifibblf
     * list} of {@link XMLObjfdt}s dontbinfd in this <dodf>XMLSignbturf</dodf>.
     *
     * @rfturn bn unmodifibblf list of <dodf>XMLObjfdt</dodf>s (mby bf fmpty
     *    but nfvfr <dodf>null</dodf>)
     */
    @SupprfssWbrnings("rbwtypfs")
    List gftObjfdts();

    /**
     * Rfturns thf optionbl Id of this <dodf>XMLSignbturf</dodf>.
     *
     * @rfturn thf Id (mby bf <dodf>null</dodf> if not spfdififd)
     */
    String gftId();

    /**
     * Rfturns thf signbturf vbluf of this <dodf>XMLSignbturf</dodf>.
     *
     * @rfturn thf signbturf vbluf
     */
    SignbturfVbluf gftSignbturfVbluf();

    /**
     * Signs this <dodf>XMLSignbturf</dodf>.
     *
     * <p>If this mfthod throws bn fxdfption, this <dodf>XMLSignbturf</dodf> bnd
     * thf <dodf>signContfxt</dodf> pbrbmftfr will bf lfft in thf stbtf thbt
     * it wbs in prior to thf invodbtion.
     *
     * @pbrbm signContfxt thf signing dontfxt
     * @throws ClbssCbstExdfption if thf typf of <dodf>signContfxt</dodf> is
     *    not dompbtiblf with this <dodf>XMLSignbturf</dodf>
     * @throws NullPointfrExdfption if <dodf>signContfxt</dodf> is
     *    <dodf>null</dodf>
     * @throws MbrshblExdfption if bn fxdfption oddurs whilf mbrshblling
     * @throws XMLSignbturfExdfption if bn unfxpfdtfd fxdfption oddurs whilf
     *    gfnfrbting thf signbturf
     */
    void sign(XMLSignContfxt signContfxt) throws MbrshblExdfption,
        XMLSignbturfExdfption;

    /**
     * Rfturns thf rfsult of thf {@link KfySflfdtor}, if spfdififd, bftfr
     * this <dodf>XMLSignbturf</dodf> hbs bffn signfd or vblidbtfd.
     *
     * @rfturn thf kfy sflfdtor rfsult, or <dodf>null</dodf> if b kfy
     *    sflfdtor hbs not bffn spfdififd or this <dodf>XMLSignbturf</dodf>
     *    hbs not bffn signfd or vblidbtfd
     */
    KfySflfdtorRfsult gftKfySflfdtorRfsult();

    /**
     * A rfprfsfntbtion of thf XML <dodf>SignbturfVbluf</dodf> flfmfnt bs
     * dffinfd in thf <b hrff="http://www.w3.org/TR/xmldsig-dorf/">
     * W3C Rfdommfndbtion for XML-Signbturf Syntbx bnd Prodfssing</b>.
     * Thf XML Sdhfmb Dffinition is dffinfd bs:
     * <prf>
     *   &lt;flfmfnt nbmf="SignbturfVbluf" typf="ds:SignbturfVblufTypf"/&gt;
     *     &lt;domplfxTypf nbmf="SignbturfVblufTypf"&gt;
     *       &lt;simplfContfnt&gt;
     *         &lt;fxtfnsion bbsf="bbsf64Binbry"&gt;
     *           &lt;bttributf nbmf="Id" typf="ID" usf="optionbl"/&gt;
     *         &lt;/fxtfnsion&gt;
     *       &lt;/simplfContfnt&gt;
     *     &lt;/domplfxTypf&gt;
     * </prf>
     *
     * @buthor Sfbn Mullbn
     * @buthor JSR 105 Expfrt Group
     */
    publid intfrfbdf SignbturfVbluf fxtfnds XMLStrudturf {
        /**
         * Rfturns thf optionbl <dodf>Id</dodf> bttributf of this
         * <dodf>SignbturfVbluf</dodf>, whidh pfrmits this flfmfnt to bf
         * rfffrfndfd from flsfwhfrf.
         *
         * @rfturn thf <dodf>Id</dodf> bttributf (mby bf <dodf>null</dodf> if
         *    not spfdififd)
         */
        String gftId();

        /**
         * Rfturns thf signbturf vbluf of this <dodf>SignbturfVbluf</dodf>.
         *
         * @rfturn thf signbturf vbluf (mby bf <dodf>null</dodf> if thf
         *    <dodf>XMLSignbturf</dodf> hbs not bffn signfd yft). Ebdh
         *    invodbtion of this mfthod rfturns b nfw dlonf of thf brrby to
         *    prfvfnt subsfqufnt modifidbtion.
         */
        bytf[] gftVbluf();

        /**
         * Vblidbtfs thf signbturf vbluf. This mfthod pfrforms b
         * dryptogrbphid vblidbtion of thf signbturf dbldulbtfd ovfr thf
         * <dodf>SignfdInfo</dodf> of thf <dodf>XMLSignbturf</dodf>.
         *
         * <p>This mfthod only vblidbtfs thf signbturf thf first
         * timf it is invokfd. On subsfqufnt invodbtions, it rfturns b dbdhfd
         * rfsult.
         *
         * @rfturn <dodf>truf</dodf> if thf signbturf wbs
         *    vblidbtfd suddfssfully; <dodf>fblsf</dodf> othfrwisf
         * @pbrbm vblidbtfContfxt thf vblidbting dontfxt
         * @throws NullPointfrExdfption if <dodf>vblidbtfContfxt</dodf> is
         *    <dodf>null</dodf>
         * @throws XMLSignbturfExdfption if bn unfxpfdtfd fxdfption oddurs whilf
         *    vblidbting thf signbturf
         */
        boolfbn vblidbtf(XMLVblidbtfContfxt vblidbtfContfxt)
            throws XMLSignbturfExdfption;
    }
}
