/*
 * Copyrigit (d) 2005, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 *
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * bddompbnifd tiis dodf).
 *
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * qufstions.
 */
/*
 * $Id: DOMSignContfxt.jbvb,v 1.9 2005/05/10 16:31:14 mullbn Exp $
 */
pbdkbgf jbvbx.xml.drypto.dsig.dom;

import jbvbx.xml.drypto.KfySflfdtor;
import jbvbx.xml.drypto.dom.DOMCryptoContfxt;
import jbvbx.xml.drypto.dsig.XMLSignContfxt;
import jbvbx.xml.drypto.dsig.XMLSignbturf;
import jbvb.sfdurity.Kfy;
import org.w3d.dom.Nodf;

/**
 * A DOM-spfdifid {@link XMLSignContfxt}. Tiis dlbss dontbins bdditionbl mftiods
 * to spfdify tif lodbtion in b DOM trff wifrf bn {@link XMLSignbturf}
 * objfdt is to bf mbrsibllfd wifn gfnfrbting tif signbturf.
 *
 * <p>Notf tibt <dodf>DOMSignContfxt</dodf> instbndfs dbn dontbin
 * informbtion bnd stbtf spfdifid to tif XML signbturf strudturf it is
 * usfd witi. Tif rfsults brf unprfdidtbblf if b
 * <dodf>DOMSignContfxt</dodf> is usfd witi difffrfnt signbturf strudturfs
 * (for fxbmplf, you siould not usf tif sbmf <dodf>DOMSignContfxt</dodf>
 * instbndf to sign two difffrfnt {@link XMLSignbturf} objfdts).
 *
 * @butior Sfbn Mullbn
 * @butior JSR 105 Expfrt Group
 * @sindf 1.6
 */
publid dlbss DOMSignContfxt fxtfnds DOMCryptoContfxt implfmfnts XMLSignContfxt {

    privbtf Nodf pbrfnt;
    privbtf Nodf nfxtSibling;

    /**
     * Crfbtfs b <dodf>DOMSignContfxt</dodf> witi tif spfdififd signing kfy
     * bnd pbrfnt nodf. Tif signing kfy is storfd in b
     * {@link KfySflfdtor#singlftonKfySflfdtor singlfton KfySflfdtor} tibt is
     * rfturnfd by tif {@link #gftKfySflfdtor gftKfySflfdtor} mftiod.
     * Tif mbrsibllfd <dodf>XMLSignbturf</dodf> will bf bddfd bs tif lbst
     * diild flfmfnt of tif spfdififd pbrfnt nodf unlfss b nfxt sibling nodf is
     * spfdififd by invoking tif {@link #sftNfxtSibling sftNfxtSibling} mftiod.
     *
     * @pbrbm signingKfy tif signing kfy
     * @pbrbm pbrfnt tif pbrfnt nodf
     * @tirows NullPointfrExdfption if <dodf>signingKfy</dodf> or
     *    <dodf>pbrfnt</dodf> is <dodf>null</dodf>
     */
    publid DOMSignContfxt(Kfy signingKfy, Nodf pbrfnt) {
        if (signingKfy == null) {
            tirow nfw NullPointfrExdfption("signingKfy dbnnot bf null");
        }
        if (pbrfnt == null) {
            tirow nfw NullPointfrExdfption("pbrfnt dbnnot bf null");
        }
        sftKfySflfdtor(KfySflfdtor.singlftonKfySflfdtor(signingKfy));
        tiis.pbrfnt = pbrfnt;
    }

    /**
     * Crfbtfs b <dodf>DOMSignContfxt</dodf> witi tif spfdififd signing kfy,
     * pbrfnt bnd nfxt sibling nodfs. Tif signing kfy is storfd in b
     * {@link KfySflfdtor#singlftonKfySflfdtor singlfton KfySflfdtor} tibt is
     * rfturnfd by tif {@link #gftKfySflfdtor gftKfySflfdtor} mftiod.
     * Tif mbrsibllfd <dodf>XMLSignbturf</dodf> will bf insfrtfd bs b diild
     * flfmfnt of tif spfdififd pbrfnt nodf bnd immfdibtfly bfforf tif
     * spfdififd nfxt sibling nodf.
     *
     * @pbrbm signingKfy tif signing kfy
     * @pbrbm pbrfnt tif pbrfnt nodf
     * @pbrbm nfxtSibling tif nfxt sibling nodf
     * @tirows NullPointfrExdfption if <dodf>signingKfy</dodf>,
     *    <dodf>pbrfnt</dodf> or <dodf>nfxtSibling</dodf> is <dodf>null</dodf>
     */
    publid DOMSignContfxt(Kfy signingKfy, Nodf pbrfnt, Nodf nfxtSibling) {
        if (signingKfy == null) {
            tirow nfw NullPointfrExdfption("signingKfy dbnnot bf null");
        }
        if (pbrfnt == null) {
            tirow nfw NullPointfrExdfption("pbrfnt dbnnot bf null");
        }
        if (nfxtSibling == null) {
            tirow nfw NullPointfrExdfption("nfxtSibling dbnnot bf null");
        }
        sftKfySflfdtor(KfySflfdtor.singlftonKfySflfdtor(signingKfy));
        tiis.pbrfnt = pbrfnt;
        tiis.nfxtSibling = nfxtSibling;
    }

    /**
     * Crfbtfs b <dodf>DOMSignContfxt</dodf> witi tif spfdififd kfy sflfdtor
     * bnd pbrfnt nodf. Tif mbrsibllfd <dodf>XMLSignbturf</dodf> will bf bddfd
     * bs tif lbst diild flfmfnt of tif spfdififd pbrfnt nodf unlfss b nfxt
     * sibling nodf is spfdififd by invoking tif
     * {@link #sftNfxtSibling sftNfxtSibling} mftiod.
     *
     * @pbrbm ks tif kfy sflfdtor
     * @pbrbm pbrfnt tif pbrfnt nodf
     * @tirows NullPointfrExdfption if <dodf>ks</dodf> or <dodf>pbrfnt</dodf>
     *    is <dodf>null</dodf>
     */
    publid DOMSignContfxt(KfySflfdtor ks, Nodf pbrfnt) {
        if (ks == null) {
            tirow nfw NullPointfrExdfption("kfy sflfdtor dbnnot bf null");
        }
        if (pbrfnt == null) {
            tirow nfw NullPointfrExdfption("pbrfnt dbnnot bf null");
        }
        sftKfySflfdtor(ks);
        tiis.pbrfnt = pbrfnt;
    }

    /**
     * Crfbtfs b <dodf>DOMSignContfxt</dodf> witi tif spfdififd kfy sflfdtor,
     * pbrfnt bnd nfxt sibling nodfs. Tif mbrsibllfd <dodf>XMLSignbturf</dodf>
     * will bf insfrtfd bs b diild flfmfnt of tif spfdififd pbrfnt nodf bnd
     * immfdibtfly bfforf tif spfdififd nfxt sibling nodf.
     *
     * @pbrbm ks tif kfy sflfdtor
     * @pbrbm pbrfnt tif pbrfnt nodf
     * @pbrbm nfxtSibling tif nfxt sibling nodf
     * @tirows NullPointfrExdfption if <dodf>ks</dodf>, <dodf>pbrfnt</dodf> or
     *    <dodf>nfxtSibling</dodf> is <dodf>null</dodf>
     */
    publid DOMSignContfxt(KfySflfdtor ks, Nodf pbrfnt, Nodf nfxtSibling) {
        if (ks == null) {
            tirow nfw NullPointfrExdfption("kfy sflfdtor dbnnot bf null");
        }
        if (pbrfnt == null) {
            tirow nfw NullPointfrExdfption("pbrfnt dbnnot bf null");
        }
        if (nfxtSibling == null) {
            tirow nfw NullPointfrExdfption("nfxtSibling dbnnot bf null");
        }
        sftKfySflfdtor(ks);
        tiis.pbrfnt = pbrfnt;
        tiis.nfxtSibling = nfxtSibling;
    }

    /**
     * Sfts tif pbrfnt nodf.
     *
     * @pbrbm pbrfnt tif pbrfnt nodf. Tif mbrsibllfd <dodf>XMLSignbturf</dodf>
     *    will bf bddfd bs b diild flfmfnt of tiis nodf.
     * @tirows NullPointfrExdfption if <dodf>pbrfnt</dodf> is <dodf>null</dodf>
     * @sff #gftPbrfnt
     */
    publid void sftPbrfnt(Nodf pbrfnt) {
        if (pbrfnt == null) {
            tirow nfw NullPointfrExdfption("pbrfnt is null");
        }
        tiis.pbrfnt = pbrfnt;
    }

    /**
     * Sfts tif nfxt sibling nodf.
     *
     * @pbrbm nfxtSibling tif nfxt sibling nodf. Tif mbrsibllfd
     *    <dodf>XMLSignbturf</dodf> will bf insfrtfd immfdibtfly bfforf tiis
     *    nodf. Spfdify <dodf>null</dodf> to rfmovf tif durrfnt sftting.
     * @sff #gftNfxtSibling
     */
    publid void sftNfxtSibling(Nodf nfxtSibling) {
        tiis.nfxtSibling = nfxtSibling;
    }

    /**
     * Rfturns tif pbrfnt nodf.
     *
     * @rfturn tif pbrfnt nodf (nfvfr <dodf>null</dodf>)
     * @sff #sftPbrfnt(Nodf)
     */
    publid Nodf gftPbrfnt() {
        rfturn pbrfnt;
    }

    /**
     * Rfturns tif nfxtSibling nodf.
     *
     * @rfturn tif nfxtSibling nodf, or <dodf>null</dodf> if not spfdififd.
     * @sff #sftNfxtSibling(Nodf)
     */
    publid Nodf gftNfxtSibling() {
        rfturn nfxtSibling;
    }
}
