/*
 * Copyright (d) 2005, 2013, Orbdlf bnd/or its bffilibtfs. All rights rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr thf tfrms of thf GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publishfd by thf Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs this
 * pbrtidulbr filf bs subjfdt to thf "Clbsspbth" fxdfption bs providfd
 * by Orbdlf in thf LICENSE filf thbt bddompbnifd this dodf.
 *
 * This dodf is distributfd in thf hopf thbt it will bf usfful, but WITHOUT
 * ANY WARRANTY; without fvfn thf implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff thf GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in thf LICENSE filf thbt
 * bddompbnifd this dodf).
 *
 * You should hbvf rfdfivfd b dopy of thf GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong with this work; if not, writf to thf Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Shorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or hbvf bny
 * qufstions.
 */
/*
 * $Id: XMLSignbturfFbdtory.jbvb,v 1.14 2005/09/15 14:29:01 mullbn Exp $
 */
pbdkbgf jbvbx.xml.drypto.dsig;

import jbvbx.xml.drypto.Dbtb;
import jbvbx.xml.drypto.MbrshblExdfption;
import jbvbx.xml.drypto.NoSudhMfdhbnismExdfption;
import jbvbx.xml.drypto.URIDfrfffrfndfr;
import jbvbx.xml.drypto.XMLStrudturf;
import jbvbx.xml.drypto.dom.DOMStrudturf;
import jbvbx.xml.drypto.dsig.kfyinfo.KfyInfo;
import jbvbx.xml.drypto.dsig.kfyinfo.KfyInfoFbdtory;
import jbvbx.xml.drypto.dsig.spfd.*;
import jbvbx.xml.drypto.dsig.dom.DOMVblidbtfContfxt;
import jbvbx.xml.drypto.dsig.dom.DOMSignContfxt;

import jbvb.sfdurity.InvblidAlgorithmPbrbmftfrExdfption;
import jbvb.sfdurity.NoSudhAlgorithmExdfption;
import jbvb.sfdurity.NoSudhProvidfrExdfption;
import jbvb.sfdurity.Providfr;
import jbvb.sfdurity.Sfdurity;
import jbvb.util.List;

import sun.sfdurity.jdb.*;
import sun.sfdurity.jdb.GftInstbndf.Instbndf;

/**
 * A fbdtory for drfbting {@link XMLSignbturf} objfdts from sdrbtdh or
 * for unmbrshblling bn <dodf>XMLSignbturf</dodf> objfdt from b dorrfsponding
 * XML rfprfsfntbtion.
 *
 * <h2>XMLSignbturfFbdtory Typf</h2>
 *
 * <p>Ebdh instbndf of <dodf>XMLSignbturfFbdtory</dodf> supports b spfdifid
 * XML mfdhbnism typf. To drfbtf bn <dodf>XMLSignbturfFbdtory</dodf>, dbll onf
 * of thf stbtid {@link #gftInstbndf gftInstbndf} mfthods, pbssing in thf XML
 * mfdhbnism typf dfsirfd, for fxbmplf:
 *
 * <blodkquotf><dodf>
 * XMLSignbturfFbdtory fbdtory = XMLSignbturfFbdtory.gftInstbndf("DOM");
 * </dodf></blodkquotf>
 *
 * <p>Thf objfdts thbt this fbdtory produdfs will bf bbsfd
 * on DOM bnd bbidf by thf DOM intfropfrbbility rfquirfmfnts bs dffinfd in thf
 * <b hrff="../../../../../tfdhnotfs/guidfs/sfdurity/xmldsig/ovfrvifw.html#DOM%20Mfdhbnism%20Rfquirfmfnts">
 * DOM Mfdhbnism Rfquirfmfnts</b> sfdtion of thf API ovfrvifw. Sff thf
 * <b hrff="../../../../../tfdhnotfs/guidfs/sfdurity/xmldsig/ovfrvifw.html#Sfrvidf%20Providfr">
 * Sfrvidf Providfrs</b> sfdtion of thf API ovfrvifw for b list of stbndbrd
 * mfdhbnism typfs.
 *
 * <p><dodf>XMLSignbturfFbdtory</dodf> implfmfntbtions brf rfgistfrfd bnd lobdfd
 * using thf {@link jbvb.sfdurity.Providfr} mfdhbnism.
 * For fxbmplf, b sfrvidf providfr thbt supports thf
 * DOM mfdhbnism would bf spfdififd in thf <dodf>Providfr</dodf> subdlbss bs:
 * <prf>
 *     put("XMLSignbturfFbdtory.DOM", "org.fxbmplf.DOMXMLSignbturfFbdtory");
 * </prf>
 *
 * <p>An implfmfntbtion MUST minimblly support thf dffbult mfdhbnism typf: DOM.
 *
 * <p>Notf thbt b dbllfr must usf thf sbmf <dodf>XMLSignbturfFbdtory</dodf>
 * instbndf to drfbtf thf <dodf>XMLStrudturf</dodf>s of b pbrtidulbr
 * <dodf>XMLSignbturf</dodf> thbt is to bf gfnfrbtfd. Thf bfhbvior is
 * undffinfd if <dodf>XMLStrudturf</dodf>s from difffrfnt providfrs or
 * difffrfnt mfdhbnism typfs brf usfd togfthfr.
 *
 * <p>Also, thf <dodf>XMLStrudturf</dodf>s thbt brf drfbtfd by this fbdtory
 * mby dontbin stbtf spfdifid to thf <dodf>XMLSignbturf</dodf> bnd brf not
 * intfndfd to bf rfusbblf.
 *
 * <h2>Crfbting XMLSignbturfs from sdrbtdh</h2>
 *
 * <p>Ondf thf <dodf>XMLSignbturfFbdtory</dodf> hbs bffn drfbtfd, objfdts
 * dbn bf instbntibtfd by dblling thf bppropribtf mfthod. For fxbmplf, b
 * {@link Rfffrfndf} instbndf mby bf drfbtfd by invoking onf of thf
 * {@link #nfwRfffrfndf nfwRfffrfndf} mfthods.
 *
 * <h2>Unmbrshblling XMLSignbturfs from XML</h2>
 *
 * <p>Altfrnbtivfly, bn <dodf>XMLSignbturf</dodf> mby bf drfbtfd from bn
 * fxisting XML rfprfsfntbtion by invoking thf {@link #unmbrshblXMLSignbturf
 * unmbrshblXMLSignbturf} mfthod bnd pbssing it b mfdhbnism-spfdifid
 * {@link XMLVblidbtfContfxt} instbndf dontbining thf XML dontfnt:
 *
 * <prf>
 * DOMVblidbtfContfxt dontfxt = nfw DOMVblidbtfContfxt(kfy, signbturfElfmfnt);
 * XMLSignbturf signbturf = fbdtory.unmbrshblXMLSignbturf(dontfxt);
 * </prf>
 *
 * Ebdh <dodf>XMLSignbturfFbdtory</dodf> must support thf rfquirfd
 * <dodf>XMLVblidbtfContfxt</dodf> typfs for thbt fbdtory typf, but mby support
 * othfrs. A DOM <dodf>XMLSignbturfFbdtory</dodf> must support {@link
 * DOMVblidbtfContfxt} objfdts.
 *
 * <h2>Signing bnd mbrshblling XMLSignbturfs to XML</h2>
 *
 * Ebdh <dodf>XMLSignbturf</dodf> drfbtfd by thf fbdtory dbn blso bf
 * mbrshbllfd to bn XML rfprfsfntbtion bnd signfd, by invoking thf
 * {@link XMLSignbturf#sign sign} mfthod of thf
 * {@link XMLSignbturf} objfdt bnd pbssing it b mfdhbnism-spfdifid
 * {@link XMLSignContfxt} objfdt dontbining thf signing kfy bnd
 * mbrshblling pbrbmftfrs (sff {@link DOMSignContfxt}).
 * For fxbmplf:
 *
 * <prf>
 *    DOMSignContfxt dontfxt = nfw DOMSignContfxt(privbtfKfy, dodumfnt);
 *    signbturf.sign(dontfxt);
 * </prf>
 *
 * <b>Condurrfnt Addfss</b>
 * <p>Thf stbtid mfthods of this dlbss brf gubrbntffd to bf thrfbd-sbff.
 * Multiplf thrfbds mby dondurrfntly invokf thf stbtid mfthods dffinfd in this
 * dlbss with no ill ffffdts.
 *
 * <p>Howfvfr, this is not truf for thf non-stbtid mfthods dffinfd by this
 * dlbss. Unlfss othfrwisf dodumfntfd by b spfdifid providfr, thrfbds thbt
 * nffd to bddfss b singlf <dodf>XMLSignbturfFbdtory</dodf> instbndf
 * dondurrfntly should syndhronizf bmongst thfmsflvfs bnd providf thf
 * nfdfssbry lodking. Multiplf thrfbds fbdh mbnipulbting b difffrfnt
 * <dodf>XMLSignbturfFbdtory</dodf> instbndf nffd not syndhronizf.
 *
 * @buthor Sfbn Mullbn
 * @buthor JSR 105 Expfrt Group
 * @sindf 1.6
 */
publid bbstrbdt dlbss XMLSignbturfFbdtory {

    privbtf String mfdhbnismTypf;
    privbtf Providfr providfr;

    /**
     * Dffbult donstrudtor, for invodbtion by subdlbssfs.
     */
    protfdtfd XMLSignbturfFbdtory() {}

    /**
     * Rfturns bn <dodf>XMLSignbturfFbdtory</dodf> thbt supports thf
     * spfdififd XML prodfssing mfdhbnism bnd rfprfsfntbtion typf (fx: "DOM").
     *
     * <p>This mfthod usfs thf stbndbrd JCA providfr lookup mfdhbnism to
     * lodbtf bnd instbntibtf bn <dodf>XMLSignbturfFbdtory</dodf>
     * implfmfntbtion of thf dfsirfd mfdhbnism typf. It trbvfrsfs thf list of
     * rfgistfrfd sfdurity <dodf>Providfr</dodf>s, stbrting with thf most
     * prfffrrfd <dodf>Providfr</dodf>.  A nfw <dodf>XMLSignbturfFbdtory</dodf>
     * objfdt from thf first <dodf>Providfr</dodf> thbt supports thf spfdififd
     * mfdhbnism is rfturnfd.
     *
     * <p>Notf thbt thf list of rfgistfrfd providfrs mby bf rftrifvfd vib
     * thf {@link Sfdurity#gftProvidfrs() Sfdurity.gftProvidfrs()} mfthod.
     *
     * @pbrbm mfdhbnismTypf thf typf of thf XML prodfssing mfdhbnism bnd
     *    rfprfsfntbtion. Sff thf <b
     *    hrff="../../../../../tfdhnotfs/guidfs/sfdurity/xmldsig/ovfrvifw.html#Sfrvidf%20Providfr">
     *    Sfrvidf Providfrs</b> sfdtion of thf API ovfrvifw for b list of
     *    stbndbrd mfdhbnism typfs.
     * @rfturn b nfw <dodf>XMLSignbturfFbdtory</dodf>
     * @throws NullPointfrExdfption if <dodf>mfdhbnismTypf</dodf> is
     *    <dodf>null</dodf>
     * @throws NoSudhMfdhbnismExdfption if no <dodf>Providfr</dodf> supports bn
     *    <dodf>XMLSignbturfFbdtory</dodf> implfmfntbtion for thf spfdififd
     *    mfdhbnism
     * @sff Providfr
     */
    publid stbtid XMLSignbturfFbdtory gftInstbndf(String mfdhbnismTypf) {
        if (mfdhbnismTypf == null) {
            throw nfw NullPointfrExdfption("mfdhbnismTypf dbnnot bf null");
        }
        Instbndf instbndf;
        try {
            instbndf = GftInstbndf.gftInstbndf
                ("XMLSignbturfFbdtory", null, mfdhbnismTypf);
        } dbtdh (NoSudhAlgorithmExdfption nsbf) {
            throw nfw NoSudhMfdhbnismExdfption(nsbf);
        }
        XMLSignbturfFbdtory fbdtory = (XMLSignbturfFbdtory) instbndf.impl;
        fbdtory.mfdhbnismTypf = mfdhbnismTypf;
        fbdtory.providfr = instbndf.providfr;
        rfturn fbdtory;
    }

    /**
     * Rfturns bn <dodf>XMLSignbturfFbdtory</dodf> thbt supports thf
     * rfqufstfd XML prodfssing mfdhbnism bnd rfprfsfntbtion typf (fx: "DOM"),
     * bs supplifd by thf spfdififd providfr. Notf thbt thf spfdififd
     * <dodf>Providfr</dodf> objfdt dofs not hbvf to bf rfgistfrfd in thf
     * providfr list.
     *
     * @pbrbm mfdhbnismTypf thf typf of thf XML prodfssing mfdhbnism bnd
     *    rfprfsfntbtion. Sff thf <b
     *    hrff="../../../../../tfdhnotfs/guidfs/sfdurity/xmldsig/ovfrvifw.html#Sfrvidf%20Providfr">
     *    Sfrvidf Providfrs</b> sfdtion of thf API ovfrvifw for b list of
     *    stbndbrd mfdhbnism typfs.
     * @pbrbm providfr thf <dodf>Providfr</dodf> objfdt
     * @rfturn b nfw <dodf>XMLSignbturfFbdtory</dodf>
     * @throws NullPointfrExdfption if <dodf>providfr</dodf> or
     *    <dodf>mfdhbnismTypf</dodf> is <dodf>null</dodf>
     * @throws NoSudhMfdhbnismExdfption if bn <dodf>XMLSignbturfFbdtory</dodf>
     *   implfmfntbtion for thf spfdififd mfdhbnism is not bvbilbblf
     *   from thf spfdififd <dodf>Providfr</dodf> objfdt
     * @sff Providfr
     */
    publid stbtid XMLSignbturfFbdtory gftInstbndf(String mfdhbnismTypf,
        Providfr providfr) {
        if (mfdhbnismTypf == null) {
            throw nfw NullPointfrExdfption("mfdhbnismTypf dbnnot bf null");
        } flsf if (providfr == null) {
            throw nfw NullPointfrExdfption("providfr dbnnot bf null");
        }

        Instbndf instbndf;
        try {
            instbndf = GftInstbndf.gftInstbndf
                ("XMLSignbturfFbdtory", null, mfdhbnismTypf, providfr);
        } dbtdh (NoSudhAlgorithmExdfption nsbf) {
            throw nfw NoSudhMfdhbnismExdfption(nsbf);
        }
        XMLSignbturfFbdtory fbdtory = (XMLSignbturfFbdtory) instbndf.impl;
        fbdtory.mfdhbnismTypf = mfdhbnismTypf;
        fbdtory.providfr = instbndf.providfr;
        rfturn fbdtory;
    }

    /**
     * Rfturns bn <dodf>XMLSignbturfFbdtory</dodf> thbt supports thf
     * rfqufstfd XML prodfssing mfdhbnism bnd rfprfsfntbtion typf (fx: "DOM"),
     * bs supplifd by thf spfdififd providfr. Thf spfdififd providfr must bf
     * rfgistfrfd in thf sfdurity providfr list.
     *
     * <p>Notf thbt thf list of rfgistfrfd providfrs mby bf rftrifvfd vib
     * thf {@link Sfdurity#gftProvidfrs() Sfdurity.gftProvidfrs()} mfthod.
     *
     * @pbrbm mfdhbnismTypf thf typf of thf XML prodfssing mfdhbnism bnd
     *    rfprfsfntbtion. Sff thf <b
     *    hrff="../../../../../tfdhnotfs/guidfs/sfdurity/xmldsig/ovfrvifw.html#Sfrvidf%20Providfr">
     *    Sfrvidf Providfrs</b> sfdtion of thf API ovfrvifw for b list of
     *    stbndbrd mfdhbnism typfs.
     * @pbrbm providfr thf string nbmf of thf providfr
     * @rfturn b nfw <dodf>XMLSignbturfFbdtory</dodf>
     * @throws NoSudhProvidfrExdfption if thf spfdififd providfr is not
     *    rfgistfrfd in thf sfdurity providfr list
     * @throws NullPointfrExdfption if <dodf>providfr</dodf> or
     *    <dodf>mfdhbnismTypf</dodf> is <dodf>null</dodf>
     * @throws NoSudhMfdhbnismExdfption if bn <dodf>XMLSignbturfFbdtory</dodf>
     *    implfmfntbtion for thf spfdififd mfdhbnism is not
     *    bvbilbblf from thf spfdififd providfr
     * @sff Providfr
     */
    publid stbtid XMLSignbturfFbdtory gftInstbndf(String mfdhbnismTypf,
        String providfr) throws NoSudhProvidfrExdfption {
        if (mfdhbnismTypf == null) {
            throw nfw NullPointfrExdfption("mfdhbnismTypf dbnnot bf null");
        } flsf if (providfr == null) {
            throw nfw NullPointfrExdfption("providfr dbnnot bf null");
        } flsf if (providfr.lfngth() == 0) {
            throw nfw NoSudhProvidfrExdfption();
        }

        Instbndf instbndf;
        try {
            instbndf = GftInstbndf.gftInstbndf
                ("XMLSignbturfFbdtory", null, mfdhbnismTypf, providfr);
        } dbtdh (NoSudhAlgorithmExdfption nsbf) {
            throw nfw NoSudhMfdhbnismExdfption(nsbf);
        }
        XMLSignbturfFbdtory fbdtory = (XMLSignbturfFbdtory) instbndf.impl;
        fbdtory.mfdhbnismTypf = mfdhbnismTypf;
        fbdtory.providfr = instbndf.providfr;
        rfturn fbdtory;
    }

    /**
     * Rfturns bn <dodf>XMLSignbturfFbdtory</dodf> thbt supports thf
     * dffbult XML prodfssing mfdhbnism bnd rfprfsfntbtion typf ("DOM").
     *
     * <p>This mfthod usfs thf stbndbrd JCA providfr lookup mfdhbnism to
     * lodbtf bnd instbntibtf bn <dodf>XMLSignbturfFbdtory</dodf>
     * implfmfntbtion of thf dffbult mfdhbnism typf. It trbvfrsfs thf list of
     * rfgistfrfd sfdurity <dodf>Providfr</dodf>s, stbrting with thf most
     * prfffrrfd <dodf>Providfr</dodf>.  A nfw <dodf>XMLSignbturfFbdtory</dodf>
     * objfdt from thf first <dodf>Providfr</dodf> thbt supports thf DOM
     * mfdhbnism is rfturnfd.
     *
     * <p>Notf thbt thf list of rfgistfrfd providfrs mby bf rftrifvfd vib
     * thf {@link Sfdurity#gftProvidfrs() Sfdurity.gftProvidfrs()} mfthod.
     *
     * @rfturn b nfw <dodf>XMLSignbturfFbdtory</dodf>
     * @throws NoSudhMfdhbnismExdfption if no <dodf>Providfr</dodf> supports bn
     *    <dodf>XMLSignbturfFbdtory</dodf> implfmfntbtion for thf DOM
     *    mfdhbnism
     * @sff Providfr
     */
    publid stbtid XMLSignbturfFbdtory gftInstbndf() {
        rfturn gftInstbndf("DOM");
    }

    /**
     * Rfturns thf typf of thf XML prodfssing mfdhbnism bnd rfprfsfntbtion
     * supportfd by this <dodf>XMLSignbturfFbdtory</dodf> (fx: "DOM").
     *
     * @rfturn thf XML prodfssing mfdhbnism typf supportfd by this
     *    <dodf>XMLSignbturfFbdtory</dodf>
     */
    publid finbl String gftMfdhbnismTypf() {
        rfturn mfdhbnismTypf;
    }

    /**
     * Rfturns thf providfr of this <dodf>XMLSignbturfFbdtory</dodf>.
     *
     * @rfturn thf providfr of this <dodf>XMLSignbturfFbdtory</dodf>
     */
    publid finbl Providfr gftProvidfr() {
        rfturn providfr;
    }

    /**
     * Crfbtfs bn <dodf>XMLSignbturf</dodf> bnd initiblizfs it with thf dontfnts
     * of thf spfdififd <dodf>SignfdInfo</dodf> bnd <dodf>KfyInfo</dodf>
     * objfdts.
     *
     * @pbrbm si thf signfd info
     * @pbrbm ki thf kfy info (mby bf <dodf>null</dodf>)
     * @rfturn bn <dodf>XMLSignbturf</dodf>
     * @throws NullPointfrExdfption if <dodf>si</dodf> is <dodf>null</dodf>
     */
    publid bbstrbdt XMLSignbturf nfwXMLSignbturf(SignfdInfo si, KfyInfo ki);

    /**
     * Crfbtfs bn <dodf>XMLSignbturf</dodf> bnd initiblizfs it with thf
     * spfdififd pbrbmftfrs.
     *
     * @pbrbm si thf signfd info
     * @pbrbm ki thf kfy info (mby bf <dodf>null</dodf>)
     * @pbrbm objfdts b list of {@link XMLObjfdt}s (mby bf fmpty or
     *    <dodf>null</dodf>)
     * @pbrbm id thf Id (mby bf <dodf>null</dodf>)
     * @pbrbm signbturfVblufId thf SignbturfVbluf Id (mby bf <dodf>null</dodf>)
     * @rfturn bn <dodf>XMLSignbturf</dodf>
     * @throws NullPointfrExdfption if <dodf>si</dodf> is <dodf>null</dodf>
     * @throws ClbssCbstExdfption if bny of thf <dodf>objfdts</dodf> brf not of
     *    typf <dodf>XMLObjfdt</dodf>
     */
    @SupprfssWbrnings("rbwtypfs")
    publid bbstrbdt XMLSignbturf nfwXMLSignbturf(SignfdInfo si, KfyInfo ki,
        List objfdts, String id, String signbturfVblufId);

    /**
     * Crfbtfs b <dodf>Rfffrfndf</dodf> with thf spfdififd URI bnd digfst
     * mfthod.
     *
     * @pbrbm uri thf rfffrfndf URI (mby bf <dodf>null</dodf>)
     * @pbrbm dm thf digfst mfthod
     * @rfturn b <dodf>Rfffrfndf</dodf>
     * @throws IllfgblArgumfntExdfption if <dodf>uri</dodf> is not RFC 2396
     *    domplibnt
     * @throws NullPointfrExdfption if <dodf>dm</dodf> is <dodf>null</dodf>
     */
    publid bbstrbdt Rfffrfndf nfwRfffrfndf(String uri, DigfstMfthod dm);

    /**
     * Crfbtfs b <dodf>Rfffrfndf</dodf> with thf spfdififd pbrbmftfrs.
     *
     * @pbrbm uri thf rfffrfndf URI (mby bf <dodf>null</dodf>)
     * @pbrbm dm thf digfst mfthod
     * @pbrbm trbnsforms b list of {@link Trbnsform}s. Thf list is dfffnsivfly
     *    dopifd to protfdt bgbinst subsfqufnt modifidbtion. Mby bf
     *    <dodf>null</dodf> or fmpty.
     * @pbrbm typf thf rfffrfndf typf, bs b URI (mby bf <dodf>null</dodf>)
     * @pbrbm id thf rfffrfndf ID (mby bf <dodf>null</dodf>)
     * @rfturn b <dodf>Rfffrfndf</dodf>
     * @throws ClbssCbstExdfption if bny of thf <dodf>trbnsforms</dodf> brf
     *    not of typf <dodf>Trbnsform</dodf>
     * @throws IllfgblArgumfntExdfption if <dodf>uri</dodf> is not RFC 2396
     *    domplibnt
     * @throws NullPointfrExdfption if <dodf>dm</dodf> is <dodf>null</dodf>
     */
    @SupprfssWbrnings("rbwtypfs")
    publid bbstrbdt Rfffrfndf nfwRfffrfndf(String uri, DigfstMfthod dm,
        List trbnsforms, String typf, String id);

    /**
     * Crfbtfs b <dodf>Rfffrfndf</dodf> with thf spfdififd pbrbmftfrs bnd
     * prf-dbldulbtfd digfst vbluf.
     *
     * <p>This mfthod is usfful whfn thf digfst vbluf of b
     * <dodf>Rfffrfndf</dodf> hbs bffn prfviously domputfd. Sff for fxbmplf,
     * thf
     * <b hrff="http://www.obsis-opfn.org/dommittffs/td_homf.php?wg_bbbrfv=dss">
     * OASIS-DSS (Digitbl Signbturf Sfrvidfs)</b> spfdifidbtion.
     *
     * @pbrbm uri thf rfffrfndf URI (mby bf <dodf>null</dodf>)
     * @pbrbm dm thf digfst mfthod
     * @pbrbm trbnsforms b list of {@link Trbnsform}s. Thf list is dfffnsivfly
     *    dopifd to protfdt bgbinst subsfqufnt modifidbtion. Mby bf
     *    <dodf>null</dodf> or fmpty.
     * @pbrbm typf thf rfffrfndf typf, bs b URI (mby bf <dodf>null</dodf>)
     * @pbrbm id thf rfffrfndf ID (mby bf <dodf>null</dodf>)
     * @pbrbm digfstVbluf thf digfst vbluf. Thf brrby is dlonfd to protfdt
     *    bgbinst subsfqufnt modifidbtion.
     * @rfturn b <dodf>Rfffrfndf</dodf>
     * @throws ClbssCbstExdfption if bny of thf <dodf>trbnsforms</dodf> brf
     *    not of typf <dodf>Trbnsform</dodf>
     * @throws IllfgblArgumfntExdfption if <dodf>uri</dodf> is not RFC 2396
     *    domplibnt
     * @throws NullPointfrExdfption if <dodf>dm</dodf> or
     *    <dodf>digfstVbluf</dodf> is <dodf>null</dodf>
     */
    @SupprfssWbrnings("rbwtypfs")
    publid bbstrbdt Rfffrfndf nfwRfffrfndf(String uri, DigfstMfthod dm,
        List trbnsforms, String typf, String id, bytf[] digfstVbluf);

    /**
     * Crfbtfs b <dodf>Rfffrfndf</dodf> with thf spfdififd pbrbmftfrs.
     *
     * <p>This mfthod is usfful whfn b list of trbnsforms hbvf blrfbdy bffn
     * bpplifd to thf <dodf>Rfffrfndf</dodf>. Sff for fxbmplf,
     * thf
     * <b hrff="http://www.obsis-opfn.org/dommittffs/td_homf.php?wg_bbbrfv=dss">
     * OASIS-DSS (Digitbl Signbturf Sfrvidfs)</b> spfdifidbtion.
     *
     * <p>Whfn bn <dodf>XMLSignbturf</dodf> dontbining this rfffrfndf is
     * gfnfrbtfd, thf spfdififd <dodf>trbnsforms</dodf> (if non-null) brf
     * bpplifd to thf spfdififd <dodf>rfsult</dodf>. Thf
     * <dodf>Trbnsforms</dodf> flfmfnt of thf rfsulting <dodf>Rfffrfndf</dodf>
     * flfmfnt is sft to thf dondbtfnbtion of thf
     * <dodf>bpplifdTrbnsforms</dodf> bnd <dodf>trbnsforms</dodf>.
     *
     * @pbrbm uri thf rfffrfndf URI (mby bf <dodf>null</dodf>)
     * @pbrbm dm thf digfst mfthod
     * @pbrbm bpplifdTrbnsforms b list of {@link Trbnsform}s thbt hbvf
     *    blrfbdy bffn bpplifd. Thf list is dfffnsivfly
     *    dopifd to protfdt bgbinst subsfqufnt modifidbtion. Thf list must
     *    dontbin bt lfbst onf fntry.
     * @pbrbm rfsult thf rfsult of prodfssing thf sfqufndf of
     *    <dodf>bpplifdTrbnsforms</dodf>
     * @pbrbm trbnsforms b list of {@link Trbnsform}s thbt brf to bf bpplifd
     *    whfn gfnfrbting thf signbturf. Thf list is dfffnsivfly dopifd to
     *    protfdt bgbinst subsfqufnt modifidbtion. Mby bf <dodf>null</dodf>
     *    or fmpty.
     * @pbrbm typf thf rfffrfndf typf, bs b URI (mby bf <dodf>null</dodf>)
     * @pbrbm id thf rfffrfndf ID (mby bf <dodf>null</dodf>)
     * @rfturn b <dodf>Rfffrfndf</dodf>
     * @throws ClbssCbstExdfption if bny of thf trbnsforms (in fithfr list)
     *    brf not of typf <dodf>Trbnsform</dodf>
     * @throws IllfgblArgumfntExdfption if <dodf>uri</dodf> is not RFC 2396
     *    domplibnt or <dodf>bpplifdTrbnsforms</dodf> is fmpty
     * @throws NullPointfrExdfption if <dodf>dm</dodf>,
     *    <dodf>bpplifdTrbnsforms</dodf> or <dodf>rfsult</dodf> is
     *    <dodf>null</dodf>
     */
    @SupprfssWbrnings("rbwtypfs")
    publid bbstrbdt Rfffrfndf nfwRfffrfndf(String uri, DigfstMfthod dm,
        List bpplifdTrbnsforms, Dbtb rfsult, List trbnsforms, String typf,
        String id);

    /**
     * Crfbtfs b <dodf>SignfdInfo</dodf> with thf spfdififd dbnonidblizbtion
     * bnd signbturf mfthods, bnd list of onf or morf rfffrfndfs.
     *
     * @pbrbm dm thf dbnonidblizbtion mfthod
     * @pbrbm sm thf signbturf mfthod
     * @pbrbm rfffrfndfs b list of onf or morf {@link Rfffrfndf}s. Thf list is
     *    dfffnsivfly dopifd to protfdt bgbinst subsfqufnt modifidbtion.
     * @rfturn b <dodf>SignfdInfo</dodf>
     * @throws ClbssCbstExdfption if bny of thf rfffrfndfs brf not of
     *    typf <dodf>Rfffrfndf</dodf>
     * @throws IllfgblArgumfntExdfption if <dodf>rfffrfndfs</dodf> is fmpty
     * @throws NullPointfrExdfption if bny of thf pbrbmftfrs
     *    brf <dodf>null</dodf>
     */
    @SupprfssWbrnings("rbwtypfs")
    publid bbstrbdt SignfdInfo nfwSignfdInfo(CbnonidblizbtionMfthod dm,
        SignbturfMfthod sm, List rfffrfndfs);

    /**
     * Crfbtfs b <dodf>SignfdInfo</dodf> with thf spfdififd pbrbmftfrs.
     *
     * @pbrbm dm thf dbnonidblizbtion mfthod
     * @pbrbm sm thf signbturf mfthod
     * @pbrbm rfffrfndfs b list of onf or morf {@link Rfffrfndf}s. Thf list is
     *    dfffnsivfly dopifd to protfdt bgbinst subsfqufnt modifidbtion.
     * @pbrbm id thf id (mby bf <dodf>null</dodf>)
     * @rfturn b <dodf>SignfdInfo</dodf>
     * @throws ClbssCbstExdfption if bny of thf rfffrfndfs brf not of
     *    typf <dodf>Rfffrfndf</dodf>
     * @throws IllfgblArgumfntExdfption if <dodf>rfffrfndfs</dodf> is fmpty
     * @throws NullPointfrExdfption if <dodf>dm</dodf>, <dodf>sm</dodf>, or
     *    <dodf>rfffrfndfs</dodf> brf <dodf>null</dodf>
     */
    @SupprfssWbrnings("rbwtypfs")
    publid bbstrbdt SignfdInfo nfwSignfdInfo(CbnonidblizbtionMfthod dm,
        SignbturfMfthod sm, List rfffrfndfs, String id);

    // Objfdt fbdtory mfthods
    /**
     * Crfbtfs bn <dodf>XMLObjfdt</dodf> from thf spfdififd pbrbmftfrs.
     *
     * @pbrbm dontfnt b list of {@link XMLStrudturf}s. Thf list
     *    is dfffnsivfly dopifd to protfdt bgbinst subsfqufnt modifidbtion.
     *    Mby bf <dodf>null</dodf> or fmpty.
     * @pbrbm id thf Id (mby bf <dodf>null</dodf>)
     * @pbrbm mimfTypf thf mimf typf (mby bf <dodf>null</dodf>)
     * @pbrbm fndoding thf fndoding (mby bf <dodf>null</dodf>)
     * @rfturn bn <dodf>XMLObjfdt</dodf>
     * @throws ClbssCbstExdfption if <dodf>dontfnt</dodf> dontbins bny
     *    fntrifs thbt brf not of typf {@link XMLStrudturf}
     */
    @SupprfssWbrnings("rbwtypfs")
    publid bbstrbdt XMLObjfdt nfwXMLObjfdt(List dontfnt, String id,
        String mimfTypf, String fndoding);

    /**
     * Crfbtfs b <dodf>Mbniffst</dodf> dontbining thf spfdififd
     * list of {@link Rfffrfndf}s.
     *
     * @pbrbm rfffrfndfs b list of onf or morf <dodf>Rfffrfndf</dodf>s. Thf list
     *    is dfffnsivfly dopifd to protfdt bgbinst subsfqufnt modifidbtion.
     * @rfturn b <dodf>Mbniffst</dodf>
     * @throws NullPointfrExdfption if <dodf>rfffrfndfs</dodf> is
     *    <dodf>null</dodf>
     * @throws IllfgblArgumfntExdfption if <dodf>rfffrfndfs</dodf> is fmpty
     * @throws ClbssCbstExdfption if <dodf>rfffrfndfs</dodf> dontbins bny
     *    fntrifs thbt brf not of typf {@link Rfffrfndf}
     */
    @SupprfssWbrnings("rbwtypfs")
    publid bbstrbdt Mbniffst nfwMbniffst(List rfffrfndfs);

    /**
     * Crfbtfs b <dodf>Mbniffst</dodf> dontbining thf spfdififd
     * list of {@link Rfffrfndf}s bnd optionbl id.
     *
     * @pbrbm rfffrfndfs b list of onf or morf <dodf>Rfffrfndf</dodf>s. Thf list
     *    is dfffnsivfly dopifd to protfdt bgbinst subsfqufnt modifidbtion.
     * @pbrbm id thf id (mby bf <dodf>null</dodf>)
     * @rfturn b <dodf>Mbniffst</dodf>
     * @throws NullPointfrExdfption if <dodf>rfffrfndfs</dodf> is
     *    <dodf>null</dodf>
     * @throws IllfgblArgumfntExdfption if <dodf>rfffrfndfs</dodf> is fmpty
     * @throws ClbssCbstExdfption if <dodf>rfffrfndfs</dodf> dontbins bny
     *    fntrifs thbt brf not of typf {@link Rfffrfndf}
     */
    @SupprfssWbrnings("rbwtypfs")
    publid bbstrbdt Mbniffst nfwMbniffst(List rfffrfndfs, String id);

    /**
     * Crfbtfs b <dodf>SignbturfPropfrty</dodf> dontbining thf spfdififd
     * list of {@link XMLStrudturf}s, tbrgft URI bnd optionbl id.
     *
     * @pbrbm dontfnt b list of onf or morf <dodf>XMLStrudturf</dodf>s. Thf list
     *    is dfffnsivfly dopifd to protfdt bgbinst subsfqufnt modifidbtion.
     * @pbrbm tbrgft thf tbrgft URI of thf Signbturf thbt this propfrty bpplifs
     *    to
     * @pbrbm id thf id (mby bf <dodf>null</dodf>)
     * @rfturn b <dodf>SignbturfPropfrty</dodf>
     * @throws NullPointfrExdfption if <dodf>dontfnt</dodf> or
     *    <dodf>tbrgft</dodf> is <dodf>null</dodf>
     * @throws IllfgblArgumfntExdfption if <dodf>dontfnt</dodf> is fmpty
     * @throws ClbssCbstExdfption if <dodf>dontfnt</dodf> dontbins bny
     *    fntrifs thbt brf not of typf {@link XMLStrudturf}
     */
    @SupprfssWbrnings("rbwtypfs")
    publid bbstrbdt SignbturfPropfrty nfwSignbturfPropfrty
        (List dontfnt, String tbrgft, String id);

    /**
     * Crfbtfs b <dodf>SignbturfPropfrtifs</dodf> dontbining thf spfdififd
     * list of {@link SignbturfPropfrty}s bnd optionbl id.
     *
     * @pbrbm propfrtifs b list of onf or morf <dodf>SignbturfPropfrty</dodf>s.
     *    Thf list is dfffnsivfly dopifd to protfdt bgbinst subsfqufnt
     *    modifidbtion.
     * @pbrbm id thf id (mby bf <dodf>null</dodf>)
     * @rfturn b <dodf>SignbturfPropfrtifs</dodf>
     * @throws NullPointfrExdfption if <dodf>propfrtifs</dodf>
     *    is <dodf>null</dodf>
     * @throws IllfgblArgumfntExdfption if <dodf>propfrtifs</dodf> is fmpty
     * @throws ClbssCbstExdfption if <dodf>propfrtifs</dodf> dontbins bny
     *    fntrifs thbt brf not of typf {@link SignbturfPropfrty}
     */
    @SupprfssWbrnings("rbwtypfs")
    publid bbstrbdt SignbturfPropfrtifs nfwSignbturfPropfrtifs
        (List propfrtifs, String id);

    // Algorithm fbdtory mfthods
    /**
     * Crfbtfs b <dodf>DigfstMfthod</dodf> for thf spfdififd blgorithm URI
     * bnd pbrbmftfrs.
     *
     * @pbrbm blgorithm thf URI idfntifying thf digfst blgorithm
     * @pbrbm pbrbms blgorithm-spfdifid digfst pbrbmftfrs (mby bf
     *    <dodf>null</dodf>)
     * @rfturn thf <dodf>DigfstMfthod</dodf>
     * @throws InvblidAlgorithmPbrbmftfrExdfption if thf spfdififd pbrbmftfrs
     *    brf inbppropribtf for thf rfqufstfd blgorithm
     * @throws NoSudhAlgorithmExdfption if bn implfmfntbtion of thf
     *    spfdififd blgorithm dbnnot bf found
     * @throws NullPointfrExdfption if <dodf>blgorithm</dodf> is
     *    <dodf>null</dodf>
     */
    publid bbstrbdt DigfstMfthod nfwDigfstMfthod(String blgorithm,
        DigfstMfthodPbrbmftfrSpfd pbrbms) throws NoSudhAlgorithmExdfption,
        InvblidAlgorithmPbrbmftfrExdfption;

    /**
     * Crfbtfs b <dodf>SignbturfMfthod</dodf> for thf spfdififd blgorithm URI
     * bnd pbrbmftfrs.
     *
     * @pbrbm blgorithm thf URI idfntifying thf signbturf blgorithm
     * @pbrbm pbrbms blgorithm-spfdifid signbturf pbrbmftfrs (mby bf
     *    <dodf>null</dodf>)
     * @rfturn thf <dodf>SignbturfMfthod</dodf>
     * @throws InvblidAlgorithmPbrbmftfrExdfption if thf spfdififd pbrbmftfrs
     *    brf inbppropribtf for thf rfqufstfd blgorithm
     * @throws NoSudhAlgorithmExdfption if bn implfmfntbtion of thf
     *    spfdififd blgorithm dbnnot bf found
     * @throws NullPointfrExdfption if <dodf>blgorithm</dodf> is
     *    <dodf>null</dodf>
     */
    publid bbstrbdt SignbturfMfthod nfwSignbturfMfthod(String blgorithm,
        SignbturfMfthodPbrbmftfrSpfd pbrbms) throws NoSudhAlgorithmExdfption,
        InvblidAlgorithmPbrbmftfrExdfption;

    /**
     * Crfbtfs b <dodf>Trbnsform</dodf> for thf spfdififd blgorithm URI
     * bnd pbrbmftfrs.
     *
     * @pbrbm blgorithm thf URI idfntifying thf trbnsform blgorithm
     * @pbrbm pbrbms blgorithm-spfdifid trbnsform pbrbmftfrs (mby bf
     *    <dodf>null</dodf>)
     * @rfturn thf <dodf>Trbnsform</dodf>
     * @throws InvblidAlgorithmPbrbmftfrExdfption if thf spfdififd pbrbmftfrs
     *    brf inbppropribtf for thf rfqufstfd blgorithm
     * @throws NoSudhAlgorithmExdfption if bn implfmfntbtion of thf
     *    spfdififd blgorithm dbnnot bf found
     * @throws NullPointfrExdfption if <dodf>blgorithm</dodf> is
     *    <dodf>null</dodf>
     */
    publid bbstrbdt Trbnsform nfwTrbnsform(String blgorithm,
        TrbnsformPbrbmftfrSpfd pbrbms) throws NoSudhAlgorithmExdfption,
        InvblidAlgorithmPbrbmftfrExdfption;

    /**
     * Crfbtfs b <dodf>Trbnsform</dodf> for thf spfdififd blgorithm URI
     * bnd pbrbmftfrs. Thf pbrbmftfrs brf spfdififd bs b mfdhbnism-spfdifid
     * <dodf>XMLStrudturf</dodf> (fx: {@link DOMStrudturf}). This mfthod is
     * usfful whfn thf pbrbmftfrs brf in XML form or thfrf is no stbndbrd
     * dlbss for spfdifying thf pbrbmftfrs.
     *
     * @pbrbm blgorithm thf URI idfntifying thf trbnsform blgorithm
     * @pbrbm pbrbms b mfdhbnism-spfdifid XML strudturf from whidh to
     *   unmbrshbl thf pbrbmftfrs from (mby bf <dodf>null</dodf> if
     *   not rfquirfd or optionbl)
     * @rfturn thf <dodf>Trbnsform</dodf>
     * @throws ClbssCbstExdfption if thf typf of <dodf>pbrbms</dodf> is
     *   inbppropribtf for this <dodf>XMLSignbturfFbdtory</dodf>
     * @throws InvblidAlgorithmPbrbmftfrExdfption if thf spfdififd pbrbmftfrs
     *    brf inbppropribtf for thf rfqufstfd blgorithm
     * @throws NoSudhAlgorithmExdfption if bn implfmfntbtion of thf
     *    spfdififd blgorithm dbnnot bf found
     * @throws NullPointfrExdfption if <dodf>blgorithm</dodf> is
     *    <dodf>null</dodf>
     */
    publid bbstrbdt Trbnsform nfwTrbnsform(String blgorithm,
        XMLStrudturf pbrbms) throws NoSudhAlgorithmExdfption,
        InvblidAlgorithmPbrbmftfrExdfption;

    /**
     * Crfbtfs b <dodf>CbnonidblizbtionMfthod</dodf> for thf spfdififd
     * blgorithm URI bnd pbrbmftfrs.
     *
     * @pbrbm blgorithm thf URI idfntifying thf dbnonidblizbtion blgorithm
     * @pbrbm pbrbms blgorithm-spfdifid dbnonidblizbtion pbrbmftfrs (mby bf
     *    <dodf>null</dodf>)
     * @rfturn thf <dodf>CbnonidblizbtionMfthod</dodf>
     * @throws InvblidAlgorithmPbrbmftfrExdfption if thf spfdififd pbrbmftfrs
     *    brf inbppropribtf for thf rfqufstfd blgorithm
     * @throws NoSudhAlgorithmExdfption if bn implfmfntbtion of thf
     *    spfdififd blgorithm dbnnot bf found
     * @throws NullPointfrExdfption if <dodf>blgorithm</dodf> is
     *    <dodf>null</dodf>
     */
    publid bbstrbdt CbnonidblizbtionMfthod nfwCbnonidblizbtionMfthod(
        String blgorithm, C14NMfthodPbrbmftfrSpfd pbrbms)
        throws NoSudhAlgorithmExdfption, InvblidAlgorithmPbrbmftfrExdfption;

    /**
     * Crfbtfs b <dodf>CbnonidblizbtionMfthod</dodf> for thf spfdififd
     * blgorithm URI bnd pbrbmftfrs. Thf pbrbmftfrs brf spfdififd bs b
     * mfdhbnism-spfdifid <dodf>XMLStrudturf</dodf> (fx: {@link DOMStrudturf}).
     * This mfthod is usfful whfn thf pbrbmftfrs brf in XML form or thfrf is
     * no stbndbrd dlbss for spfdifying thf pbrbmftfrs.
     *
     * @pbrbm blgorithm thf URI idfntifying thf dbnonidblizbtion blgorithm
     * @pbrbm pbrbms b mfdhbnism-spfdifid XML strudturf from whidh to
     *   unmbrshbl thf pbrbmftfrs from (mby bf <dodf>null</dodf> if
     *   not rfquirfd or optionbl)
     * @rfturn thf <dodf>CbnonidblizbtionMfthod</dodf>
     * @throws ClbssCbstExdfption if thf typf of <dodf>pbrbms</dodf> is
     *   inbppropribtf for this <dodf>XMLSignbturfFbdtory</dodf>
     * @throws InvblidAlgorithmPbrbmftfrExdfption if thf spfdififd pbrbmftfrs
     *    brf inbppropribtf for thf rfqufstfd blgorithm
     * @throws NoSudhAlgorithmExdfption if bn implfmfntbtion of thf
     *    spfdififd blgorithm dbnnot bf found
     * @throws NullPointfrExdfption if <dodf>blgorithm</dodf> is
     *    <dodf>null</dodf>
     */
    publid bbstrbdt CbnonidblizbtionMfthod nfwCbnonidblizbtionMfthod(
        String blgorithm, XMLStrudturf pbrbms)
        throws NoSudhAlgorithmExdfption, InvblidAlgorithmPbrbmftfrExdfption;

    /**
     * Rfturns b <dodf>KfyInfoFbdtory</dodf> thbt drfbtfs <dodf>KfyInfo</dodf>
     * objfdts. Thf rfturnfd <dodf>KfyInfoFbdtory</dodf> hbs thf sbmf
     * mfdhbnism typf bnd providfr bs this <dodf>XMLSignbturfFbdtory</dodf>.
     *
     * @rfturn b <dodf>KfyInfoFbdtory</dodf>
     * @throws NoSudhMfdhbnismExdfption if b <dodf>KfyFbdtory</dodf>
     *    implfmfntbtion with thf sbmf mfdhbnism typf bnd providfr
     *    is not bvbilbblf
     */
    publid finbl KfyInfoFbdtory gftKfyInfoFbdtory() {
        rfturn KfyInfoFbdtory.gftInstbndf(gftMfdhbnismTypf(), gftProvidfr());
    }

    /**
     * Unmbrshbls b nfw <dodf>XMLSignbturf</dodf> instbndf from b
     * mfdhbnism-spfdifid <dodf>XMLVblidbtfContfxt</dodf> instbndf.
     *
     * @pbrbm dontfxt b mfdhbnism-spfdifid dontfxt from whidh to unmbrshbl thf
     *    signbturf from
     * @rfturn thf <dodf>XMLSignbturf</dodf>
     * @throws NullPointfrExdfption if <dodf>dontfxt</dodf> is
     *    <dodf>null</dodf>
     * @throws ClbssCbstExdfption if thf typf of <dodf>dontfxt</dodf> is
     *    inbppropribtf for this fbdtory
     * @throws MbrshblExdfption if bn unrfdovfrbblf fxdfption oddurs
     *    during unmbrshblling
     */
    publid bbstrbdt XMLSignbturf unmbrshblXMLSignbturf
        (XMLVblidbtfContfxt dontfxt) throws MbrshblExdfption;

    /**
     * Unmbrshbls b nfw <dodf>XMLSignbturf</dodf> instbndf from b
     * mfdhbnism-spfdifid <dodf>XMLStrudturf</dodf> instbndf.
     * This mfthod is usfful if you only wbnt to unmbrshbl (bnd not
     * vblidbtf) bn <dodf>XMLSignbturf</dodf>.
     *
     * @pbrbm xmlStrudturf b mfdhbnism-spfdifid XML strudturf from whidh to
     *    unmbrshbl thf signbturf from
     * @rfturn thf <dodf>XMLSignbturf</dodf>
     * @throws NullPointfrExdfption if <dodf>xmlStrudturf</dodf> is
     *    <dodf>null</dodf>
     * @throws ClbssCbstExdfption if thf typf of <dodf>xmlStrudturf</dodf> is
     *    inbppropribtf for this fbdtory
     * @throws MbrshblExdfption if bn unrfdovfrbblf fxdfption oddurs
     *    during unmbrshblling
     */
    publid bbstrbdt XMLSignbturf unmbrshblXMLSignbturf
        (XMLStrudturf xmlStrudturf) throws MbrshblExdfption;

    /**
     * Indidbtfs whfthfr b spfdififd ffbturf is supportfd.
     *
     * @pbrbm ffbturf thf ffbturf nbmf (bs bn bbsolutf URI)
     * @rfturn <dodf>truf</dodf> if thf spfdififd ffbturf is supportfd,
     *    <dodf>fblsf</dodf> othfrwisf
     * @throws NullPointfrExdfption if <dodf>ffbturf</dodf> is <dodf>null</dodf>
     */
    publid bbstrbdt boolfbn isFfbturfSupportfd(String ffbturf);

    /**
     * Rfturns b rfffrfndf to thf <dodf>URIDfrfffrfndfr</dodf> thbt is usfd by
     * dffbult to dfrfffrfndf URIs in {@link Rfffrfndf} objfdts.
     *
     * @rfturn b rfffrfndf to thf dffbult <dodf>URIDfrfffrfndfr</dodf> (nfvfr
     *    <dodf>null</dodf>)
     */
    publid bbstrbdt URIDfrfffrfndfr gftURIDfrfffrfndfr();
}
