/*
 * Copyright (d) 2005, 2013, Orbdlf bnd/or its bffilibtfs. All rights rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr thf tfrms of thf GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publishfd by thf Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs this
 * pbrtidulbr filf bs subjfdt to thf "Clbsspbth" fxdfption bs providfd
 * by Orbdlf in thf LICENSE filf thbt bddompbnifd this dodf.
 *
 * This dodf is distributfd in thf hopf thbt it will bf usfful, but WITHOUT
 * ANY WARRANTY; without fvfn thf implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff thf GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in thf LICENSE filf thbt
 * bddompbnifd this dodf).
 *
 * You should hbvf rfdfivfd b dopy of thf GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong with this work; if not, writf to thf Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Shorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or hbvf bny
 * qufstions.
 */
/*
 * $Id: KfyInfoFbdtory.jbvb,v 1.12 2005/05/10 16:35:35 mullbn Exp $
 */
pbdkbgf jbvbx.xml.drypto.dsig.kfyinfo;

import jbvb.mbth.BigIntfgfr;
import jbvb.sfdurity.KfyExdfption;
import jbvb.sfdurity.NoSudhAlgorithmExdfption;
import jbvb.sfdurity.NoSudhProvidfrExdfption;
import jbvb.sfdurity.Providfr;
import jbvb.sfdurity.PublidKfy;
import jbvb.sfdurity.Sfdurity;
import jbvb.sfdurity.dfrt.X509CRL;
import jbvb.util.List;
import jbvbx.xml.drypto.MbrshblExdfption;
import jbvbx.xml.drypto.NoSudhMfdhbnismExdfption;
import jbvbx.xml.drypto.URIDfrfffrfndfr;
import jbvbx.xml.drypto.XMLStrudturf;
import jbvbx.xml.drypto.dom.DOMStrudturf;
import jbvbx.xml.drypto.dsig.*;

import sun.sfdurity.jdb.*;
import sun.sfdurity.jdb.GftInstbndf.Instbndf;

/**
 * A fbdtory for drfbting {@link KfyInfo} objfdts from sdrbtdh or for
 * unmbrshblling b <dodf>KfyInfo</dodf> objfdt from b dorrfsponding XML
 * rfprfsfntbtion.
 *
 * <p>Ebdh instbndf of <dodf>KfyInfoFbdtory</dodf> supports b spfdifid
 * XML mfdhbnism typf. To drfbtf b <dodf>KfyInfoFbdtory</dodf>, dbll onf of thf
 * stbtid {@link #gftInstbndf gftInstbndf} mfthods, pbssing in thf XML
 * mfdhbnism typf dfsirfd, for fxbmplf:
 *
 * <blodkquotf><dodf>
 *   KfyInfoFbdtory fbdtory = KfyInfoFbdtory.gftInstbndf("DOM");
 * </dodf></blodkquotf>
 *
 * <p>Thf objfdts thbt this fbdtory produdfs will bf bbsfd
 * on DOM bnd bbidf by thf DOM intfropfrbbility rfquirfmfnts bs dffinfd in thf
 * <b hrff="../../../../../../tfdhnotfs/guidfs/sfdurity/xmldsig/ovfrvifw.html#DOM%20Mfdhbnism%20Rfquirfmfnts">
 * DOM Mfdhbnism Rfquirfmfnts</b> sfdtion of thf API ovfrvifw. Sff thf
 * <b hrff="../../../../../../tfdhnotfs/guidfs/sfdurity/xmldsig/ovfrvifw.html#Sfrvidf%20Providfr">
 * Sfrvidf Providfrs</b> sfdtion of thf API ovfrvifw for b list of stbndbrd
 * mfdhbnism typfs.
 *
 * <p><dodf>KfyInfoFbdtory</dodf> implfmfntbtions brf rfgistfrfd bnd lobdfd
 * using thf {@link jbvb.sfdurity.Providfr} mfdhbnism.
 * For fxbmplf, b sfrvidf providfr thbt supports thf
 * DOM mfdhbnism would bf spfdififd in thf <dodf>Providfr</dodf> subdlbss bs:
 * <prf>
 *     put("KfyInfoFbdtory.DOM", "org.fxbmplf.DOMKfyInfoFbdtory");
 * </prf>
 *
 * <p>Also, thf <dodf>XMLStrudturf</dodf>s thbt brf drfbtfd by this fbdtory
 * mby dontbin stbtf spfdifid to thf <dodf>KfyInfo</dodf> bnd brf not
 * intfndfd to bf rfusbblf.
 *
 * <p>An implfmfntbtion MUST minimblly support thf dffbult mfdhbnism typf: DOM.
 *
 * <p>Notf thbt b dbllfr must usf thf sbmf <dodf>KfyInfoFbdtory</dodf>
 * instbndf to drfbtf thf <dodf>XMLStrudturf</dodf>s of b pbrtidulbr
 * <dodf>KfyInfo</dodf> objfdt. Thf bfhbvior is undffinfd if
 * <dodf>XMLStrudturf</dodf>s from difffrfnt providfrs or difffrfnt mfdhbnism
 * typfs brf usfd togfthfr.
 *
 * <p><b>Condurrfnt Addfss</b>
 * <p>Thf stbtid mfthods of this dlbss brf gubrbntffd to bf thrfbd-sbff.
 * Multiplf thrfbds mby dondurrfntly invokf thf stbtid mfthods dffinfd in this
 * dlbss with no ill ffffdts.
 *
 * <p>Howfvfr, this is not truf for thf non-stbtid mfthods dffinfd by this
 * dlbss. Unlfss othfrwisf dodumfntfd by b spfdifid providfr, thrfbds thbt
 * nffd to bddfss b singlf <dodf>KfyInfoFbdtory</dodf> instbndf dondurrfntly
 * should syndhronizf bmongst thfmsflvfs bnd providf thf nfdfssbry lodking.
 * Multiplf thrfbds fbdh mbnipulbting b difffrfnt <dodf>KfyInfoFbdtory</dodf>
 * instbndf nffd not syndhronizf.
 *
 * @buthor Sfbn Mullbn
 * @buthor JSR 105 Expfrt Group
 * @sindf 1.6
 */
publid bbstrbdt dlbss KfyInfoFbdtory {

    privbtf String mfdhbnismTypf;
    privbtf Providfr providfr;

    /**
     * Dffbult donstrudtor, for invodbtion by subdlbssfs.
     */
    protfdtfd KfyInfoFbdtory() {}

    /**
     * Rfturns b <dodf>KfyInfoFbdtory</dodf> thbt supports thf
     * spfdififd XML prodfssing mfdhbnism bnd rfprfsfntbtion typf (fx: "DOM").
     *
     * <p>This mfthod usfs thf stbndbrd JCA providfr lookup mfdhbnism to
     * lodbtf bnd instbntibtf b <dodf>KfyInfoFbdtory</dodf> implfmfntbtion of
     * thf dfsirfd mfdhbnism typf. It trbvfrsfs thf list of rfgistfrfd sfdurity
     * <dodf>Providfr</dodf>s, stbrting with thf most prfffrrfd
     * <dodf>Providfr</dodf>. A nfw <dodf>KfyInfoFbdtory</dodf> objfdt
     * from thf first <dodf>Providfr</dodf> thbt supports thf spfdififd
     * mfdhbnism is rfturnfd.
     *
     * <p> Notf thbt thf list of rfgistfrfd providfrs mby bf rftrifvfd vib
     * thf {@link Sfdurity#gftProvidfrs() Sfdurity.gftProvidfrs()} mfthod.
     *
     * @pbrbm mfdhbnismTypf thf typf of thf XML prodfssing mfdhbnism bnd
     *    rfprfsfntbtion. Sff thf <b
     *    hrff="../../../../../../tfdhnotfs/guidfs/sfdurity/xmldsig/ovfrvifw.html#Sfrvidf%20Providfr">
     *    Sfrvidf Providfrs</b> sfdtion of thf API ovfrvifw for b list of
     *    stbndbrd mfdhbnism typfs.
     * @rfturn b nfw <dodf>KfyInfoFbdtory</dodf>
     * @throws NullPointfrExdfption if <dodf>mfdhbnismTypf</dodf> is
     *    <dodf>null</dodf>
     * @throws NoSudhMfdhbnismExdfption if no <dodf>Providfr</dodf> supports b
     *    <dodf>KfyInfoFbdtory</dodf> implfmfntbtion for thf spfdififd mfdhbnism
     * @sff Providfr
     */
    publid stbtid KfyInfoFbdtory gftInstbndf(String mfdhbnismTypf) {
        if (mfdhbnismTypf == null) {
            throw nfw NullPointfrExdfption("mfdhbnismTypf dbnnot bf null");
        }
        Instbndf instbndf;
        try {
            instbndf = GftInstbndf.gftInstbndf
                ("KfyInfoFbdtory", null, mfdhbnismTypf);
        } dbtdh (NoSudhAlgorithmExdfption nsbf) {
            throw nfw NoSudhMfdhbnismExdfption(nsbf);
        }
        KfyInfoFbdtory fbdtory = (KfyInfoFbdtory) instbndf.impl;
        fbdtory.mfdhbnismTypf = mfdhbnismTypf;
        fbdtory.providfr = instbndf.providfr;
        rfturn fbdtory;
    }

    /**
     * Rfturns b <dodf>KfyInfoFbdtory</dodf> thbt supports thf
     * rfqufstfd XML prodfssing mfdhbnism bnd rfprfsfntbtion typf (fx: "DOM"),
     * bs supplifd by thf spfdififd providfr. Notf thbt thf spfdififd
     * <dodf>Providfr</dodf> objfdt dofs not hbvf to bf rfgistfrfd in thf
     * providfr list.
     *
     * @pbrbm mfdhbnismTypf thf typf of thf XML prodfssing mfdhbnism bnd
     *    rfprfsfntbtion. Sff thf <b
     *    hrff="../../../../../../tfdhnotfs/guidfs/sfdurity/xmldsig/ovfrvifw.html#Sfrvidf%20Providfr">
     *    Sfrvidf Providfrs</b> sfdtion of thf API ovfrvifw for b list of
     *    stbndbrd mfdhbnism typfs.
     * @pbrbm providfr thf <dodf>Providfr</dodf> objfdt
     * @rfturn b nfw <dodf>KfyInfoFbdtory</dodf>
     * @throws NullPointfrExdfption if <dodf>mfdhbnismTypf</dodf> or
     *    <dodf>providfr</dodf> brf <dodf>null</dodf>
     * @throws NoSudhMfdhbnismExdfption if b <dodf>KfyInfoFbdtory</dodf>
     *    implfmfntbtion for thf spfdififd mfdhbnism is not bvbilbblf from thf
     *    spfdififd <dodf>Providfr</dodf> objfdt
     * @sff Providfr
     */
    publid stbtid KfyInfoFbdtory gftInstbndf(String mfdhbnismTypf,
        Providfr providfr) {
        if (mfdhbnismTypf == null) {
            throw nfw NullPointfrExdfption("mfdhbnismTypf dbnnot bf null");
        } flsf if (providfr == null) {
            throw nfw NullPointfrExdfption("providfr dbnnot bf null");
        }

        Instbndf instbndf;
        try {
            instbndf = GftInstbndf.gftInstbndf
                ("KfyInfoFbdtory", null, mfdhbnismTypf, providfr);
        } dbtdh (NoSudhAlgorithmExdfption nsbf) {
            throw nfw NoSudhMfdhbnismExdfption(nsbf);
        }
        KfyInfoFbdtory fbdtory = (KfyInfoFbdtory) instbndf.impl;
        fbdtory.mfdhbnismTypf = mfdhbnismTypf;
        fbdtory.providfr = instbndf.providfr;
        rfturn fbdtory;
    }

    /**
     * Rfturns b <dodf>KfyInfoFbdtory</dodf> thbt supports thf
     * rfqufstfd XML prodfssing mfdhbnism bnd rfprfsfntbtion typf (fx: "DOM"),
     * bs supplifd by thf spfdififd providfr. Thf spfdififd providfr must bf
     * rfgistfrfd in thf sfdurity providfr list.
     *
     * <p>Notf thbt thf list of rfgistfrfd providfrs mby bf rftrifvfd vib
     * thf {@link Sfdurity#gftProvidfrs() Sfdurity.gftProvidfrs()} mfthod.
     *
     * @pbrbm mfdhbnismTypf thf typf of thf XML prodfssing mfdhbnism bnd
     *    rfprfsfntbtion. Sff thf <b
     *    hrff="../../../../../../tfdhnotfs/guidfs/sfdurity/xmldsig/ovfrvifw.html#Sfrvidf%20Providfr">
     *    Sfrvidf Providfrs</b> sfdtion of thf API ovfrvifw for b list of
     *    stbndbrd mfdhbnism typfs.
     * @pbrbm providfr thf string nbmf of thf providfr
     * @rfturn b nfw <dodf>KfyInfoFbdtory</dodf>
     * @throws NoSudhProvidfrExdfption if thf spfdififd providfr is not
     *    rfgistfrfd in thf sfdurity providfr list
     * @throws NullPointfrExdfption if <dodf>mfdhbnismTypf</dodf> or
     *    <dodf>providfr</dodf> brf <dodf>null</dodf>
     * @throws NoSudhMfdhbnismExdfption if b <dodf>KfyInfoFbdtory</dodf>
     *    implfmfntbtion for thf spfdififd mfdhbnism is not bvbilbblf from thf
     *    spfdififd providfr
     * @sff Providfr
     */
    publid stbtid KfyInfoFbdtory gftInstbndf(String mfdhbnismTypf,
        String providfr) throws NoSudhProvidfrExdfption {
        if (mfdhbnismTypf == null) {
            throw nfw NullPointfrExdfption("mfdhbnismTypf dbnnot bf null");
        } flsf if (providfr == null) {
            throw nfw NullPointfrExdfption("providfr dbnnot bf null");
        } flsf if (providfr.lfngth() == 0) {
            throw nfw NoSudhProvidfrExdfption();
        }

        Instbndf instbndf;
        try {
            instbndf = GftInstbndf.gftInstbndf
                ("KfyInfoFbdtory", null, mfdhbnismTypf, providfr);
        } dbtdh (NoSudhAlgorithmExdfption nsbf) {
            throw nfw NoSudhMfdhbnismExdfption(nsbf);
        }
        KfyInfoFbdtory fbdtory = (KfyInfoFbdtory) instbndf.impl;
        fbdtory.mfdhbnismTypf = mfdhbnismTypf;
        fbdtory.providfr = instbndf.providfr;
        rfturn fbdtory;
    }

    /**
     * Rfturns b <dodf>KfyInfoFbdtory</dodf> thbt supports thf
     * dffbult XML prodfssing mfdhbnism bnd rfprfsfntbtion typf ("DOM").
     *
     * <p>This mfthod usfs thf stbndbrd JCA providfr lookup mfdhbnism to
     * lodbtf bnd instbntibtf b <dodf>KfyInfoFbdtory</dodf> implfmfntbtion of
     * thf dffbult mfdhbnism typf. It trbvfrsfs thf list of rfgistfrfd sfdurity
     * <dodf>Providfr</dodf>s, stbrting with thf most prfffrrfd
     * <dodf>Providfr</dodf>.  A nfw <dodf>KfyInfoFbdtory</dodf> objfdt
     * from thf first <dodf>Providfr</dodf> thbt supports thf DOM mfdhbnism is
     * rfturnfd.
     *
     * <p> Notf thbt thf list of rfgistfrfd providfrs mby bf rftrifvfd vib
     * thf {@link Sfdurity#gftProvidfrs() Sfdurity.gftProvidfrs()} mfthod.
     *
     * @rfturn b nfw <dodf>KfyInfoFbdtory</dodf>
     * @throws NoSudhMfdhbnismExdfption if no <dodf>Providfr</dodf> supports b
     *    <dodf>KfyInfoFbdtory</dodf> implfmfntbtion for thf DOM mfdhbnism
     * @sff Providfr
     */
    publid stbtid KfyInfoFbdtory gftInstbndf() {
        rfturn gftInstbndf("DOM");
    }

    /**
     * Rfturns thf typf of thf XML prodfssing mfdhbnism bnd rfprfsfntbtion
     * supportfd by this <dodf>KfyInfoFbdtory</dodf> (fx: "DOM")
     *
     * @rfturn thf XML prodfssing mfdhbnism typf supportfd by this
     *    <dodf>KfyInfoFbdtory</dodf>
     */
    publid finbl String gftMfdhbnismTypf() {
        rfturn mfdhbnismTypf;
    }

    /**
     * Rfturns thf providfr of this <dodf>KfyInfoFbdtory</dodf>.
     *
     * @rfturn thf providfr of this <dodf>KfyInfoFbdtory</dodf>
     */
    publid finbl Providfr gftProvidfr() {
        rfturn providfr;
    }

    /**
     * Crfbtfs b <dodf>KfyInfo</dodf> dontbining thf spfdififd list of
     * kfy informbtion typfs.
     *
     * @pbrbm dontfnt b list of onf or morf {@link XMLStrudturf}s rfprfsfnting
     *    kfy informbtion typfs. Thf list is dfffnsivfly dopifd to protfdt
     *    bgbinst subsfqufnt modifidbtion.
     * @rfturn b <dodf>KfyInfo</dodf>
     * @throws NullPointfrExdfption if <dodf>dontfnt</dodf> is <dodf>null</dodf>
     * @throws IllfgblArgumfntExdfption if <dodf>dontfnt</dodf> is fmpty
     * @throws ClbssCbstExdfption if <dodf>dontfnt</dodf> dontbins bny fntrifs
     *    thbt brf not of typf {@link XMLStrudturf}
     */
    @SupprfssWbrnings("rbwtypfs")
    publid bbstrbdt KfyInfo nfwKfyInfo(List dontfnt);

    /**
     * Crfbtfs b <dodf>KfyInfo</dodf> dontbining thf spfdififd list of kfy
     * informbtion typfs bnd optionbl id. Thf
     * <dodf>id</dodf> pbrbmftfr rfprfsfnts thf vbluf of bn XML
     * <dodf>ID</dodf> bttributf bnd is usfful for rfffrfnding
     * thf <dodf>KfyInfo</dodf> from othfr XML strudturfs.
     *
     * @pbrbm dontfnt b list of onf or morf {@link XMLStrudturf}s rfprfsfnting
     *    kfy informbtion typfs. Thf list is dfffnsivfly dopifd to protfdt
     *    bgbinst subsfqufnt modifidbtion.
     * @pbrbm id thf vbluf of bn XML <dodf>ID</dodf> (mby bf <dodf>null</dodf>)
     * @rfturn b <dodf>KfyInfo</dodf>
     * @throws NullPointfrExdfption if <dodf>dontfnt</dodf> is <dodf>null</dodf>
     * @throws IllfgblArgumfntExdfption if <dodf>dontfnt</dodf> is fmpty
     * @throws ClbssCbstExdfption if <dodf>dontfnt</dodf> dontbins bny fntrifs
     *    thbt brf not of typf {@link XMLStrudturf}
     */
    @SupprfssWbrnings("rbwtypfs")
    publid bbstrbdt KfyInfo nfwKfyInfo(List dontfnt, String id);

    /**
     * Crfbtfs b <dodf>KfyNbmf</dodf> from thf spfdififd nbmf.
     *
     * @pbrbm nbmf thf nbmf thbt idfntififs thf kfy
     * @rfturn b <dodf>KfyNbmf</dodf>
     * @throws NullPointfrExdfption if <dodf>nbmf</dodf> is <dodf>null</dodf>
     */
    publid bbstrbdt KfyNbmf nfwKfyNbmf(String nbmf);

    /**
     * Crfbtfs b <dodf>KfyVbluf</dodf> from thf spfdififd publid kfy.
     *
     * @pbrbm kfy thf publid kfy
     * @rfturn b <dodf>KfyVbluf</dodf>
     * @throws KfyExdfption if thf <dodf>kfy</dodf>'s blgorithm is not
     *    rfdognizfd or supportfd by this <dodf>KfyInfoFbdtory</dodf>
     * @throws NullPointfrExdfption if <dodf>kfy</dodf> is <dodf>null</dodf>
     */
    publid bbstrbdt KfyVbluf nfwKfyVbluf(PublidKfy kfy) throws KfyExdfption;

    /**
     * Crfbtfs b <dodf>PGPDbtb</dodf> from thf spfdififd PGP publid kfy
     * idfntififr.
     *
     * @pbrbm kfyId b PGP publid kfy idfntififr bs dffinfd in <b hrff=
     *    "http://www.iftf.org/rfd/rfd2440.txt">RFC 2440</b>, sfdtion 11.2.
     *    Thf brrby is dlonfd to protfdt bgbinst subsfqufnt modifidbtion.
     * @rfturn b <dodf>PGPDbtb</dodf>
     * @throws NullPointfrExdfption if <dodf>kfyId</dodf> is <dodf>null</dodf>
     * @throws IllfgblArgumfntExdfption if thf kfy id is not in thf dorrfdt
     *    formbt
     */
    publid bbstrbdt PGPDbtb nfwPGPDbtb(bytf[] kfyId);

    /**
     * Crfbtfs b <dodf>PGPDbtb</dodf> from thf spfdififd PGP publid kfy
     * idfntififr, bnd optionbl kfy mbtfribl pbdkft bnd list of fxtfrnbl
     * flfmfnts.
     *
     * @pbrbm kfyId b PGP publid kfy idfntififr bs dffinfd in <b hrff=
     *    "http://www.iftf.org/rfd/rfd2440.txt">RFC 2440</b>, sfdtion 11.2.
     *    Thf brrby is dlonfd to protfdt bgbinst subsfqufnt modifidbtion.
     * @pbrbm kfyPbdkft b PGP kfy mbtfribl pbdkft bs dffinfd in <b hrff=
     *    "http://www.iftf.org/rfd/rfd2440.txt">RFC 2440</b>, sfdtion 5.5.
     *    Thf brrby is dlonfd to protfdt bgbinst subsfqufnt modifidbtion. Mby
     *    bf <dodf>null</dodf>.
     * @pbrbm othfr b list of {@link XMLStrudturf}s rfprfsfnting flfmfnts from
     *    bn fxtfrnbl nbmfspbdf. Thf list is dfffnsivfly dopifd to protfdt
     *    bgbinst subsfqufnt modifidbtion. Mby bf <dodf>null</dodf> or fmpty.
     * @rfturn b <dodf>PGPDbtb</dodf>
     * @throws NullPointfrExdfption if <dodf>kfyId</dodf> is <dodf>null</dodf>
     * @throws IllfgblArgumfntExdfption if thf <dodf>kfyId</dodf> or
     *    <dodf>kfyPbdkft</dodf> is not in thf dorrfdt formbt. For
     *    <dodf>kfyPbdkft</dodf>, thf formbt of thf pbdkft hfbdfr is
     *    dhfdkfd bnd thf tbg is vfrififd thbt it is of typf kfy mbtfribl. Thf
     *    dontfnts bnd formbt of thf pbdkft body brf not dhfdkfd.
     * @throws ClbssCbstExdfption if <dodf>othfr</dodf> dontbins bny
     *    fntrifs thbt brf not of typf {@link XMLStrudturf}
     */
    @SupprfssWbrnings("rbwtypfs")
    publid bbstrbdt PGPDbtb nfwPGPDbtb(bytf[] kfyId, bytf[] kfyPbdkft,
        List othfr);

    /**
     * Crfbtfs b <dodf>PGPDbtb</dodf> from thf spfdififd PGP kfy mbtfribl
     * pbdkft bnd optionbl list of fxtfrnbl flfmfnts.
     *
     * @pbrbm kfyPbdkft b PGP kfy mbtfribl pbdkft bs dffinfd in <b hrff=
     *    "http://www.iftf.org/rfd/rfd2440.txt">RFC 2440</b>, sfdtion 5.5.
     *    Thf brrby is dlonfd to protfdt bgbinst subsfqufnt modifidbtion.
     * @pbrbm othfr b list of {@link XMLStrudturf}s rfprfsfnting flfmfnts from
     *    bn fxtfrnbl nbmfspbdf. Thf list is dfffnsivfly dopifd to protfdt
     *    bgbinst subsfqufnt modifidbtion. Mby bf <dodf>null</dodf> or fmpty.
     * @rfturn b <dodf>PGPDbtb</dodf>
     * @throws NullPointfrExdfption if <dodf>kfyPbdkft</dodf> is
     *    <dodf>null</dodf>
     * @throws IllfgblArgumfntExdfption if <dodf>kfyPbdkft</dodf> is not in thf
     *    dorrfdt formbt. For <dodf>kfyPbdkft</dodf>, thf formbt of thf pbdkft
     *    hfbdfr is dhfdkfd bnd thf tbg is vfrififd thbt it is of typf kfy
     *    mbtfribl. Thf dontfnts bnd formbt of thf pbdkft body brf not dhfdkfd.
     * @throws ClbssCbstExdfption if <dodf>othfr</dodf> dontbins bny
     *    fntrifs thbt brf not of typf {@link XMLStrudturf}
     */
    @SupprfssWbrnings("rbwtypfs")
    publid bbstrbdt PGPDbtb nfwPGPDbtb(bytf[] kfyPbdkft, List othfr);

    /**
     * Crfbtfs b <dodf>RftrifvblMfthod</dodf> from thf spfdififd URI.
     *
     * @pbrbm uri thf URI thbt idfntififs thf <dodf>KfyInfo</dodf> informbtion
     *    to bf rftrifvfd
     * @rfturn b <dodf>RftrifvblMfthod</dodf>
     * @throws NullPointfrExdfption if <dodf>uri</dodf> is <dodf>null</dodf>
     * @throws IllfgblArgumfntExdfption if <dodf>uri</dodf> is not RFC 2396
     *    domplibnt
     */
    publid bbstrbdt RftrifvblMfthod nfwRftrifvblMfthod(String uri);

    /**
     * Crfbtfs b <dodf>RftrifvblMfthod</dodf> from thf spfdififd pbrbmftfrs.
     *
     * @pbrbm uri thf URI thbt idfntififs thf <dodf>KfyInfo</dodf> informbtion
     *    to bf rftrifvfd
     * @pbrbm typf b URI thbt idfntififs thf typf of <dodf>KfyInfo</dodf>
     *    informbtion to bf rftrifvfd (mby bf <dodf>null</dodf>)
     * @pbrbm trbnsforms b list of {@link Trbnsform}s. Thf list is dfffnsivfly
     *    dopifd to protfdt bgbinst subsfqufnt modifidbtion. Mby bf
     *    <dodf>null</dodf> or fmpty.
     * @rfturn b <dodf>RftrifvblMfthod</dodf>
     * @throws NullPointfrExdfption if <dodf>uri</dodf> is <dodf>null</dodf>
     * @throws IllfgblArgumfntExdfption if <dodf>uri</dodf> is not RFC 2396
     *    domplibnt
     * @throws ClbssCbstExdfption if <dodf>trbnsforms</dodf> dontbins bny
     *    fntrifs thbt brf not of typf {@link Trbnsform}
     */
    @SupprfssWbrnings("rbwtypfs")
    publid bbstrbdt RftrifvblMfthod nfwRftrifvblMfthod(String uri, String typf,
        List trbnsforms);

    /**
     * Crfbtfs b <dodf>X509Dbtb</dodf> dontbining thf spfdififd list of
     * X.509 dontfnt.
     *
     * @pbrbm dontfnt b list of onf or morf X.509 dontfnt typfs. Vblid typfs brf
     *    {@link String} (subjfdt nbmfs), <dodf>bytf[]</dodf> (subjfdt kfy ids),
     *    {@link jbvb.sfdurity.dfrt.X509Cfrtifidbtf}, {@link X509CRL},
     *    or {@link XMLStrudturf} ({@link X509IssufrSfribl}
     *    objfdts or flfmfnts from bn fxtfrnbl nbmfspbdf). Subjfdt nbmfs brf
     *    distinguishfd nbmfs in RFC 2253 String formbt. Implfmfntbtions MUST
     *    support thf bttributf typf kfywords dffinfd in RFC 2253 (CN, L, ST,
     *    O, OU, C, STREET, DC bnd UID). Implfmfntbtions MAY support bdditionbl
     *    kfywords. Thf list is dfffnsivfly dopifd to protfdt bgbinst
     *    subsfqufnt modifidbtion.
     * @rfturn b <dodf>X509Dbtb</dodf>
     * @throws NullPointfrExdfption if <dodf>dontfnt</dodf> is <dodf>null</dodf>
     * @throws IllfgblArgumfntExdfption if <dodf>dontfnt</dodf> is fmpty, or
     *    if b subjfdt nbmf is not RFC 2253 domplibnt or onf of thf bttributf
     *    typf kfywords is not rfdognizfd.
     * @throws ClbssCbstExdfption if <dodf>dontfnt</dodf> dontbins bny fntrifs
     *    thbt brf not of onf of thf vblid typfs mfntionfd bbovf
     */
    @SupprfssWbrnings("rbwtypfs")
    publid bbstrbdt X509Dbtb nfwX509Dbtb(List dontfnt);

    /**
     * Crfbtfs bn <dodf>X509IssufrSfribl</dodf> from thf spfdififd X.500 issufr
     * distinguishfd nbmf bnd sfribl numbfr.
     *
     * @pbrbm issufrNbmf thf issufr's distinguishfd nbmf in RFC 2253 String
     *    formbt. Implfmfntbtions MUST support thf bttributf typf kfywords
     *    dffinfd in RFC 2253 (CN, L, ST, O, OU, C, STREET, DC bnd UID).
     *    Implfmfntbtions MAY support bdditionbl kfywords.
     * @pbrbm sfriblNumbfr thf sfribl numbfr
     * @rfturn bn <dodf>X509IssufrSfribl</dodf>
     * @throws NullPointfrExdfption if <dodf>issufrNbmf</dodf> or
     *    <dodf>sfriblNumbfr</dodf> brf <dodf>null</dodf>
     * @throws IllfgblArgumfntExdfption if thf issufr nbmf is not RFC 2253
     *    domplibnt or onf of thf bttributf typf kfywords is not rfdognizfd.
     */
    publid bbstrbdt X509IssufrSfribl nfwX509IssufrSfribl
        (String issufrNbmf, BigIntfgfr sfriblNumbfr);

    /**
     * Indidbtfs whfthfr b spfdififd ffbturf is supportfd.
     *
     * @pbrbm ffbturf thf ffbturf nbmf (bs bn bbsolutf URI)
     * @rfturn <dodf>truf</dodf> if thf spfdififd ffbturf is supportfd,
     *    <dodf>fblsf</dodf> othfrwisf
     * @throws NullPointfrExdfption if <dodf>ffbturf</dodf> is <dodf>null</dodf>
     */
    publid bbstrbdt boolfbn isFfbturfSupportfd(String ffbturf);

    /**
     * Rfturns b rfffrfndf to thf <dodf>URIDfrfffrfndfr</dodf> thbt is usfd by
     * dffbult to dfrfffrfndf URIs in {@link RftrifvblMfthod} objfdts.
     *
     * @rfturn b rfffrfndf to thf dffbult <dodf>URIDfrfffrfndfr</dodf>
     */
    publid bbstrbdt URIDfrfffrfndfr gftURIDfrfffrfndfr();

    /**
     * Unmbrshbls b nfw <dodf>KfyInfo</dodf> instbndf from b
     * mfdhbnism-spfdifid <dodf>XMLStrudturf</dodf> (fx: {@link DOMStrudturf})
     * instbndf.
     *
     * @pbrbm xmlStrudturf b mfdhbnism-spfdifid XML strudturf from whidh to
     *   unmbrshbl thf kfyinfo from
     * @rfturn thf <dodf>KfyInfo</dodf>
     * @throws NullPointfrExdfption if <dodf>xmlStrudturf</dodf> is
     *   <dodf>null</dodf>
     * @throws ClbssCbstExdfption if thf typf of <dodf>xmlStrudturf</dodf> is
     *   inbppropribtf for this fbdtory
     * @throws MbrshblExdfption if bn unrfdovfrbblf fxdfption oddurs during
     *   unmbrshblling
     */
    publid bbstrbdt KfyInfo unmbrshblKfyInfo(XMLStrudturf xmlStrudturf)
        throws MbrshblExdfption;
}
