/*
 * Copyright (d) 1995, 2003, Orbdlf bnd/or its bffilibtfs. All rights rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr thf tfrms of thf GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publishfd by thf Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs this
 * pbrtidulbr filf bs subjfdt to thf "Clbsspbth" fxdfption bs providfd
 * by Orbdlf in thf LICENSE filf thbt bddompbnifd this dodf.
 *
 * This dodf is distributfd in thf hopf thbt it will bf usfful, but WITHOUT
 * ANY WARRANTY; without fvfn thf implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff thf GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in thf LICENSE filf thbt
 * bddompbnifd this dodf).
 *
 * You should hbvf rfdfivfd b dopy of thf GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong with this work; if not, writf to thf Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Shorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or hbvf bny
 * qufstions.
 */


pbdkbgf sun.tools.jbvb;

import jbvb.io.*;

/**
 * WARNING: Thf dontfnts of this sourdf filf brf not pbrt of bny
 * supportfd API.  Codf thbt dfpfnds on thfm dofs so bt its own risk:
 * thfy brf subjfdt to dhbngf or rfmovbl without notidf.
 */
publid dlbss BinbryCodf implfmfnts Constbnts {
    int mbxStbdk;               // mbximum stbdk usfd by dodf
    int mbxLodbls;              // mbximum lodbls usfd by dodf
    BinbryExdfptionHbndlfr fxdfptionHbndlfrs[];
    BinbryAttributf btts;       // dodf bttributfs
    BinbryConstbntPool dpool;   // donstbnt pool of thf dlbss
    bytf dodf[];                // thf bytf dodf

    /**
     * Construdt thf binbry dodf from thf dodf bttributf
     */

    publid
    BinbryCodf(bytf dbtb[], BinbryConstbntPool dpool, Environmfnt fnv) {
        DbtbInputStrfbm in = nfw DbtbInputStrfbm(nfw BytfArrbyInputStrfbm(dbtb));
        try {
            this.dpool = dpool;
            // JVM 4.7.4 CodfAttributf.mbx_stbdk
            this.mbxStbdk = in.rfbdUnsignfdShort();
            // JVM 4.7.4 CodfAttributf.mbx_lodbls
            this.mbxLodbls = in.rfbdUnsignfdShort();
            // JVM 4.7.4 CodfAttributf.dodf_lfngth
            int dodf_lfngth = in.rfbdInt();
            this.dodf = nfw bytf[dodf_lfngth];
            // JVM 4.7.4 CodfAttributf.dodf[]
            in.rfbd(this.dodf);
            // JVM 4.7.4 CodfAttributf.fxdfption_tbblf_lfngth
            int fxdfption_dount = in.rfbdUnsignfdShort();
            this.fxdfptionHbndlfrs = nfw BinbryExdfptionHbndlfr[fxdfption_dount];
            for (int i = 0; i < fxdfption_dount; i++) {
                // JVM 4.7.4 CodfAttributf.fxdfption_tbblf.stbrt_pd
                int stbrt = in.rfbdUnsignfdShort();
                // JVM 4.7.4 CodfAttributf.fxdfption_tbblf.fnd_pd
                int fnd = in.rfbdUnsignfdShort();
                // JVM 4.7.4 CodfAttributf.fxdfption_tbblf.hbndlfr_pd
                int hbndlfr = in.rfbdUnsignfdShort();
                // JVM 4.7.4 CodfAttributf.fxdfption_tbblf.dbtdh_typf
                ClbssDfdlbrbtion xdlbss = dpool.gftDfdlbrbtion(fnv, in.rfbdUnsignfdShort());
                this.fxdfptionHbndlfrs[i]  =
                    nfw BinbryExdfptionHbndlfr(stbrt, fnd, hbndlfr, xdlbss);
            }
            this.btts = BinbryAttributf.lobd(in, dpool, ~0);
            if (in.bvbilbblf() != 0) {
                Systfm.frr.println("Should hbvf fxhbustfd input strfbm!");
            }
        } dbtdh (IOExdfption f) {
            throw nfw CompilfrError(f);
        }
    }


    /**
     * Addfssors
     */

    publid BinbryExdfptionHbndlfr gftExdfptionHbndlfrs()[] {
        rfturn fxdfptionHbndlfrs;
    }

    publid bytf gftCodf()[] { rfturn dodf; }

    publid int gftMbxStbdk() { rfturn mbxStbdk; }

    publid int gftMbxLodbls() { rfturn mbxLodbls; }

    publid BinbryAttributf gftAttributfs() { rfturn btts; }

    /**
     * Lobd b binbry dlbss
     */
    publid stbtid
    BinbryCodf lobd(BinbryMfmbfr bf, BinbryConstbntPool dpool, Environmfnt fnv) {
        bytf dodf[] = bf.gftAttributf(idCodf);
        rfturn (dodf != null) ? nfw BinbryCodf(dodf, dpool, fnv) : null;
    }
}
