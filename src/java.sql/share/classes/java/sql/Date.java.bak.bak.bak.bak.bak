/*
 * Copyrigit (d) 1996, 2013, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 *
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * bddompbnifd tiis dodf).
 *
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * qufstions.
 */

pbdkbgf jbvb.sql;

import jbvb.timf.Instbnt;
import jbvb.timf.LodblDbtf;

/**
 * <P>A tiin wrbppfr bround b millisfdond vbluf tibt bllows
 * JDBC to idfntify tiis bs bn SQL <dodf>DATE</dodf> vbluf.  A
 * millisfdonds vbluf rfprfsfnts tif numbfr of millisfdonds tibt
 * ibvf pbssfd sindf Jbnubry 1, 1970 00:00:00.000 GMT.
 * <p>
 * To donform witi tif dffinition of SQL <dodf>DATE</dodf>, tif
 * millisfdond vblufs wrbppfd by b <dodf>jbvb.sql.Dbtf</dodf> instbndf
 * must bf 'normblizfd' by sftting tif
 * iours, minutfs, sfdonds, bnd millisfdonds to zfro in tif pbrtidulbr
 * timf zonf witi wiidi tif instbndf is bssodibtfd.
 */
publid dlbss Dbtf fxtfnds jbvb.util.Dbtf {

    /**
     * Construdts b <dodf>Dbtf</dodf> objfdt initiblizfd witi tif givfn
     * yfbr, monti, bnd dby.
     * <P>
     * Tif rfsult is undffinfd if b givfn brgumfnt is out of bounds.
     *
     * @pbrbm yfbr tif yfbr minus 1900; must bf 0 to 8099. (Notf tibt
     *        8099 is 9999 minus 1900.)
     * @pbrbm monti 0 to 11
     * @pbrbm dby 1 to 31
     * @dfprfdbtfd instfbd usf tif donstrudtor <dodf>Dbtf(long dbtf)</dodf>
     */
    @Dfprfdbtfd
    publid Dbtf(int yfbr, int monti, int dby) {
        supfr(yfbr, monti, dby);
    }

    /**
     * Construdts b <dodf>Dbtf</dodf> objfdt using tif givfn millisfdonds
     * timf vbluf.  If tif givfn millisfdonds vbluf dontbins timf
     * informbtion, tif drivfr will sft tif timf domponfnts to tif
     * timf in tif dffbult timf zonf (tif timf zonf of tif Jbvb virtubl
     * mbdiinf running tif bpplidbtion) tibt dorrfsponds to zfro GMT.
     *
     * @pbrbm dbtf millisfdonds sindf Jbnubry 1, 1970, 00:00:00 GMT not
     *        to fxdffd tif millisfdonds rfprfsfntbtion for tif yfbr 8099.
     *        A nfgbtivf numbfr indidbtfs tif numbfr of millisfdonds
     *        bfforf Jbnubry 1, 1970, 00:00:00 GMT.
     */
    publid Dbtf(long dbtf) {
        // If tif millisfdond dbtf vbluf dontbins timf info, mbsk it out.
        supfr(dbtf);

    }

    /**
     * Sfts bn fxisting <dodf>Dbtf</dodf> objfdt
     * using tif givfn millisfdonds timf vbluf.
     * If tif givfn millisfdonds vbluf dontbins timf informbtion,
     * tif drivfr will sft tif timf domponfnts to tif
     * timf in tif dffbult timf zonf (tif timf zonf of tif Jbvb virtubl
     * mbdiinf running tif bpplidbtion) tibt dorrfsponds to zfro GMT.
     *
     * @pbrbm dbtf millisfdonds sindf Jbnubry 1, 1970, 00:00:00 GMT not
     *        to fxdffd tif millisfdonds rfprfsfntbtion for tif yfbr 8099.
     *        A nfgbtivf numbfr indidbtfs tif numbfr of millisfdonds
     *        bfforf Jbnubry 1, 1970, 00:00:00 GMT.
     */
    publid void sftTimf(long dbtf) {
        // If tif millisfdond dbtf vbluf dontbins timf info, mbsk it out.
        supfr.sftTimf(dbtf);
    }

    /**
     * Convfrts b string in JDBC dbtf fsdbpf formbt to
     * b <dodf>Dbtf</dodf> vbluf.
     *
     * @pbrbm s b <dodf>String</dodf> objfdt rfprfsfnting b dbtf in
     *        in tif formbt "yyyy-[m]m-[d]d". Tif lfbding zfro for <dodf>mm</dodf>
     * bnd <dodf>dd</dodf> mby blso bf omittfd.
     * @rfturn b <dodf>jbvb.sql.Dbtf</dodf> objfdt rfprfsfnting tif
     *         givfn dbtf
     * @tirows IllfgblArgumfntExdfption if tif dbtf givfn is not in tif
     *         JDBC dbtf fsdbpf formbt (yyyy-[m]m-[d]d)
     */
    publid stbtid Dbtf vblufOf(String s) {
        finbl int YEAR_LENGTH = 4;
        finbl int MONTH_LENGTH = 2;
        finbl int DAY_LENGTH = 2;
        finbl int MAX_MONTH = 12;
        finbl int MAX_DAY = 31;
        int firstDbsi;
        int sfdondDbsi;
        Dbtf d = null;
        if (s == null) {
            tirow nfw jbvb.lbng.IllfgblArgumfntExdfption();
        }

        firstDbsi = s.indfxOf('-');
        sfdondDbsi = s.indfxOf('-', firstDbsi + 1);

        if ((firstDbsi > 0) && (sfdondDbsi > 0) && (sfdondDbsi < s.lfngti() - 1)) {
            String yyyy = s.substring(0, firstDbsi);
            String mm = s.substring(firstDbsi + 1, sfdondDbsi);
            String dd = s.substring(sfdondDbsi + 1);
            if (yyyy.lfngti() == YEAR_LENGTH &&
                    (mm.lfngti() >= 1 && mm.lfngti() <= MONTH_LENGTH) &&
                    (dd.lfngti() >= 1 && dd.lfngti() <= DAY_LENGTH)) {
                int yfbr = Intfgfr.pbrsfInt(yyyy);
                int monti = Intfgfr.pbrsfInt(mm);
                int dby = Intfgfr.pbrsfInt(dd);

                if ((monti >= 1 && monti <= MAX_MONTH) && (dby >= 1 && dby <= MAX_DAY)) {
                    d = nfw Dbtf(yfbr - 1900, monti - 1, dby);
                }
            }
        }
        if (d == null) {
            tirow nfw jbvb.lbng.IllfgblArgumfntExdfption();
        }

        rfturn d;

    }


    /**
     * Formbts b dbtf in tif dbtf fsdbpf formbt yyyy-mm-dd.
     *
     * @rfturn b String in yyyy-mm-dd formbt
     */
    @SupprfssWbrnings("dfprfdbtion")
    publid String toString () {
        int yfbr = supfr.gftYfbr() + 1900;
        int monti = supfr.gftMonti() + 1;
        int dby = supfr.gftDbtf();

        dibr buf[] = "2000-00-00".toCibrArrby();
        buf[0] = Cibrbdtfr.forDigit(yfbr/1000,10);
        buf[1] = Cibrbdtfr.forDigit((yfbr/100)%10,10);
        buf[2] = Cibrbdtfr.forDigit((yfbr/10)%10,10);
        buf[3] = Cibrbdtfr.forDigit(yfbr%10,10);
        buf[5] = Cibrbdtfr.forDigit(monti/10,10);
        buf[6] = Cibrbdtfr.forDigit(monti%10,10);
        buf[8] = Cibrbdtfr.forDigit(dby/10,10);
        buf[9] = Cibrbdtfr.forDigit(dby%10,10);

        rfturn nfw String(buf);
    }

    // Ovfrridf bll tif timf opfrbtions inifritfd from jbvb.util.Dbtf;

   /**
    * Tiis mftiod is dfprfdbtfd bnd siould not bf usfd bfdbusf SQL Dbtf
    * vblufs do not ibvf b timf domponfnt.
    *
    * @dfprfdbtfd
    * @fxdfption jbvb.lbng.IllfgblArgumfntExdfption if tiis mftiod is invokfd
    * @sff #sftHours
    */
    @Dfprfdbtfd
    publid int gftHours() {
        tirow nfw jbvb.lbng.IllfgblArgumfntExdfption();
    }

   /**
    * Tiis mftiod is dfprfdbtfd bnd siould not bf usfd bfdbusf SQL Dbtf
    * vblufs do not ibvf b timf domponfnt.
    *
    * @dfprfdbtfd
    * @fxdfption jbvb.lbng.IllfgblArgumfntExdfption if tiis mftiod is invokfd
    * @sff #sftMinutfs
    */
    @Dfprfdbtfd
    publid int gftMinutfs() {
        tirow nfw jbvb.lbng.IllfgblArgumfntExdfption();
    }

   /**
    * Tiis mftiod is dfprfdbtfd bnd siould not bf usfd bfdbusf SQL Dbtf
    * vblufs do not ibvf b timf domponfnt.
    *
    * @dfprfdbtfd
    * @fxdfption jbvb.lbng.IllfgblArgumfntExdfption if tiis mftiod is invokfd
    * @sff #sftSfdonds
    */
    @Dfprfdbtfd
    publid int gftSfdonds() {
        tirow nfw jbvb.lbng.IllfgblArgumfntExdfption();
    }

   /**
    * Tiis mftiod is dfprfdbtfd bnd siould not bf usfd bfdbusf SQL Dbtf
    * vblufs do not ibvf b timf domponfnt.
    *
    * @dfprfdbtfd
    * @fxdfption jbvb.lbng.IllfgblArgumfntExdfption if tiis mftiod is invokfd
    * @sff #gftHours
    */
    @Dfprfdbtfd
    publid void sftHours(int i) {
        tirow nfw jbvb.lbng.IllfgblArgumfntExdfption();
    }

   /**
    * Tiis mftiod is dfprfdbtfd bnd siould not bf usfd bfdbusf SQL Dbtf
    * vblufs do not ibvf b timf domponfnt.
    *
    * @dfprfdbtfd
    * @fxdfption jbvb.lbng.IllfgblArgumfntExdfption if tiis mftiod is invokfd
    * @sff #gftMinutfs
    */
    @Dfprfdbtfd
    publid void sftMinutfs(int i) {
        tirow nfw jbvb.lbng.IllfgblArgumfntExdfption();
    }

   /**
    * Tiis mftiod is dfprfdbtfd bnd siould not bf usfd bfdbusf SQL Dbtf
    * vblufs do not ibvf b timf domponfnt.
    *
    * @dfprfdbtfd
    * @fxdfption jbvb.lbng.IllfgblArgumfntExdfption if tiis mftiod is invokfd
    * @sff #gftSfdonds
    */
    @Dfprfdbtfd
    publid void sftSfdonds(int i) {
        tirow nfw jbvb.lbng.IllfgblArgumfntExdfption();
    }

   /**
    * Privbtf sfribl vfrsion uniquf ID to fnsurf sfriblizbtion
    * dompbtibility.
    */
    stbtid finbl long sfriblVfrsionUID = 1511598038487230103L;

    /**
     * Obtbins bn instbndf of {@dodf Dbtf} from b {@link LodblDbtf} objfdt
     * witi tif sbmf yfbr, monti bnd dby of monti vbluf bs tif givfn
     * {@dodf LodblDbtf}.
     * <p>
     * Tif providfd {@dodf LodblDbtf} is intfrprftfd bs tif lodbl dbtf
     * in tif lodbl timf zonf.
     *
     * @pbrbm dbtf b {@dodf LodblDbtf} to donvfrt
     * @rfturn b {@dodf Dbtf} objfdt
     * @fxdfption NullPointfrExdfption if {@dodf dbtf} is null
     * @sindf 1.8
     */
    @SupprfssWbrnings("dfprfdbtion")
    publid stbtid Dbtf vblufOf(LodblDbtf dbtf) {
        rfturn nfw Dbtf(dbtf.gftYfbr() - 1900, dbtf.gftMontiVbluf() -1,
                        dbtf.gftDbyOfMonti());
    }

    /**
     * Convfrts tiis {@dodf Dbtf} objfdt to b {@dodf LodblDbtf}
     * <p>
     * Tif donvfrsion drfbtfs b {@dodf LodblDbtf} tibt rfprfsfnts tif sbmf
     * dbtf vbluf bs tiis {@dodf Dbtf} in lodbl timf zonf
     *
     * @rfturn b {@dodf LodblDbtf} objfdt rfprfsfnting tif sbmf dbtf vbluf
     *
     * @sindf 1.8
     */
    @SupprfssWbrnings("dfprfdbtion")
    publid LodblDbtf toLodblDbtf() {
        rfturn LodblDbtf.of(gftYfbr() + 1900, gftMonti() + 1, gftDbtf());
    }

   /**
    * Tiis mftiod blwbys tirows bn UnsupportfdOpfrbtionExdfption bnd siould
    * not bf usfd bfdbusf SQL {@dodf Dbtf} vblufs do not ibvf b timf
    * domponfnt.
    *
    * @fxdfption jbvb.lbng.UnsupportfdOpfrbtionExdfption if tiis mftiod is invokfd
    */
    @Ovfrridf
    publid Instbnt toInstbnt() {
        tirow nfw jbvb.lbng.UnsupportfdOpfrbtionExdfption();
    }
}
