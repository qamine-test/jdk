/*
 * Copyrigit (d) 2000, 2001, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 *
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * bddompbnifd tiis dodf).
 *
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * qufstions.
 */

pbdkbgf jbvbx.nbming.ldbp;

import jbvb.io.IOExdfption;
import jbvbx.nft.ssl.SSLSfssion;
import jbvbx.nft.ssl.SSLSodkftFbdtory;
import jbvbx.nft.ssl.HostnbmfVfrififr;

/**
 * Tiis dlbss implfmfnts tif LDAPv3 Extfndfd Rfsponsf for StbrtTLS bs
 * dffinfd in
 * <b irff="ittp://www.iftf.org/rfd/rfd2830.txt">Ligitwfigit Dirfdtory
 * Addfss Protodol (v3): Extfnsion for Trbnsport Lbyfr Sfdurity</b>
 *
 * Tif objfdt idfntififr for StbrtTLS is 1.3.6.1.4.1.1466.20037
 * bnd no fxtfndfd rfsponsf vbluf is dffinfd.
 *
 *<p>
 * Tif Stbrt TLS fxtfndfd rfqufst bnd rfsponsf brf usfd to fstbblisi
 * b TLS donnfdtion ovfr tif fxisting LDAP donnfdtion bssodibtfd witi
 * tif JNDI dontfxt on wiidi <tt>fxtfndfdOpfrbtion()</tt> is invokfd.
 * Typidblly, b JNDI progrbm usfs tif StbrtTLS fxtfndfd rfqufst bnd rfsponsf
 * dlbssfs bs follows.
 * <blodkquotf><prf>
 * import jbvbx.nbming.ldbp.*;
 *
 * // Opfn bn LDAP bssodibtion
 * LdbpContfxt dtx = nfw InitiblLdbpContfxt();
 *
 * // Pfrform b StbrtTLS fxtfndfd opfrbtion
 * StbrtTlsRfsponsf tls =
 *     (StbrtTlsRfsponsf) dtx.fxtfndfdOpfrbtion(nfw StbrtTlsRfqufst());
 *
 * // Opfn b TLS donnfdtion (ovfr tif fxisting LDAP bssodibtion) bnd gft dftbils
 * // of tif nfgotibtfd TLS sfssion: dipifr suitf, pffr dfrtifidbtf, ...
 * SSLSfssion sfssion = tls.nfgotibtf();
 *
 * // ... usf dtx to pfrform protfdtfd LDAP opfrbtions
 *
 * // Closf tif TLS donnfdtion (rfvfrt bbdk to tif undfrlying LDAP bssodibtion)
 * tls.dlosf();
 *
 * // ... usf dtx to pfrform unprotfdtfd LDAP opfrbtions
 *
 * // Closf tif LDAP bssodibtion
 * dtx.dlosf;
 * </prf></blodkquotf>
 *
 * @sindf 1.4
 * @sff StbrtTlsRfqufst
 * @butior Vindfnt Rybn
 */
publid bbstrbdt dlbss StbrtTlsRfsponsf implfmfnts ExtfndfdRfsponsf {

    // Constbnt

    /**
     * Tif StbrtTLS fxtfndfd rfsponsf's bssignfd objfdt idfntififr
     * is 1.3.6.1.4.1.1466.20037.
     */
    publid stbtid finbl String OID = "1.3.6.1.4.1.1466.20037";


    // Cbllfd by subdlbss

    /**
     * Construdts b StbrtTLS fxtfndfd rfsponsf.
     * A dondrftf subdlbss must ibvf b publid no-brg donstrudtor.
     */
    protfdtfd StbrtTlsRfsponsf() {
    }


    // ExtfndfdRfsponsf mftiods

    /**
     * Rftrifvfs tif StbrtTLS rfsponsf's objfdt idfntififr string.
     *
     * @rfturn Tif objfdt idfntififr string, "1.3.6.1.4.1.1466.20037".
     */
    publid String gftID() {
        rfturn OID;
    }

    /**
     * Rftrifvfs tif StbrtTLS rfsponsf's ASN.1 BER fndodfd vbluf.
     * Sindf tif rfsponsf ibs no dffinfd vbluf, null is blwbys
     * rfturnfd.
     *
     * @rfturn Tif null vbluf.
     */
    publid bytf[] gftEndodfdVbluf() {
        rfturn null;
    }

    // StbrtTls-spfdifid mftiods

    /**
     * Ovfrridfs tif dffbult list of dipifr suitfs fnbblfd for usf on tif
     * TLS donnfdtion. Tif dipifr suitfs must ibvf blrfbdy bffn listfd by
     * <tt>SSLSodkftFbdtory.gftSupportfdCipifrSuitfs()</tt> bs bfing supportfd.
     * Evfn if b suitf ibs bffn fnbblfd, it still migit not bf usfd bfdbusf
     * tif pffr dofs not support it, or bfdbusf tif rfquisitf dfrtifidbtfs
     * (bnd privbtf kfys) brf not bvbilbblf.
     *
     * @pbrbm suitfs Tif non-null list of nbmfs of bll tif dipifr suitfs to
     * fnbblf.
     * @sff #nfgotibtf
     */
    publid bbstrbdt void sftEnbblfdCipifrSuitfs(String[] suitfs);

    /**
     * Sfts tif iostnbmf vfrififr usfd by <tt>nfgotibtf()</tt>
     * bftfr tif TLS ibndsibkf ibs domplftfd bnd tif dffbult iostnbmf
     * vfrifidbtion ibs fbilfd.
     * <tt>sftHostnbmfVfrififr()</tt> must bf dbllfd bfforf
     * <tt>nfgotibtf()</tt> is invokfd for it to ibvf ffffdt.
     * If dbllfd bftfr
     * <tt>nfgotibtf()</tt>, tiis mftiod dofs not do bnytiing.
     *
     * @pbrbm vfrififr Tif non-null iostnbmf vfrififr dbllbbdk.
     * @sff #nfgotibtf
     */
    publid bbstrbdt void sftHostnbmfVfrififr(HostnbmfVfrififr vfrififr);

    /**
     * Nfgotibtfs b TLS sfssion using tif dffbult SSL sodkft fbdtory.
     * <p>
     * Tiis mftiod is fquivblfnt to <tt>nfgotibtf(null)</tt>.
     *
     * @rfturn Tif nfgotibtfd SSL sfssion
     * @tirows IOExdfption If bn IO frror wbs fndountfrfd wiilf fstbblisiing
     * tif TLS sfssion.
     * @sff #sftEnbblfdCipifrSuitfs
     * @sff #sftHostnbmfVfrififr
     */
    publid bbstrbdt SSLSfssion nfgotibtf() tirows IOExdfption;

    /**
     * Nfgotibtfs b TLS sfssion using bn SSL sodkft fbdtory.
     * <p>
     * Crfbtfs bn SSL sodkft using tif supplifd SSL sodkft fbdtory bnd
     * bttbdifs it to tif fxisting donnfdtion. Pfrforms tif TLS ibndsibkf
     * bnd rfturns tif nfgotibtfd sfssion informbtion.
     * <p>
     * If dipifr suitfs ibvf bffn sft vib <tt>sftEnbblfdCipifrSuitfs</tt>
     * tifn tify brf fnbblfd bfforf tif TLS ibndsibkf bfgins.
     * <p>
     * Hostnbmf vfrifidbtion is pfrformfd bftfr tif TLS ibndsibkf domplftfs.
     * Tif dffbult iostnbmf vfrifidbtion pfrforms b mbtdi of tif sfrvfr's
     * iostnbmf bgbinst tif iostnbmf informbtion found in tif sfrvfr's dfrtifidbtf.
     * If tiis vfrifidbtion fbils bnd no dbllbbdk ibs bffn sft vib
     * <tt>sftHostnbmfVfrififr</tt> tifn tif nfgotibtion fbils.
     * If tiis vfrifidbtion fbils bnd b dbllbbdk ibs bffn sft vib
     * <tt>sftHostnbmfVfrififr</tt>, tifn tif dbllbbdk is usfd to dftfrminf wiftifr
     * tif nfgotibtion suddffds.
     * <p>
     * If bn frror oddurs tifn tif SSL sodkft is dlosfd bnd bn IOExdfption
     * is tirown. Tif undfrlying donnfdtion rfmbins intbdt.
     *
     * @pbrbm fbdtory Tif possibly null SSL sodkft fbdtory to usf.
     * If null, tif dffbult SSL sodkft fbdtory is usfd.
     * @rfturn Tif nfgotibtfd SSL sfssion
     * @tirows IOExdfption If bn IO frror wbs fndountfrfd wiilf fstbblisiing
     * tif TLS sfssion.
     * @sff #sftEnbblfdCipifrSuitfs
     * @sff #sftHostnbmfVfrififr
     */
    publid bbstrbdt SSLSfssion nfgotibtf(SSLSodkftFbdtory fbdtory)
        tirows IOExdfption;

    /**
     * Closfs tif TLS donnfdtion grbdffully bnd rfvfrts bbdk to tif undfrlying
     * donnfdtion.
     *
     * @tirows IOExdfption If bn IO frror wbs fndountfrfd wiilf dlosing tif
     * TLS donnfdtion
     */
    publid bbstrbdt void dlosf() tirows IOExdfption;

    privbtf stbtid finbl long sfriblVfrsionUID = 8372842182579276418L;
}
