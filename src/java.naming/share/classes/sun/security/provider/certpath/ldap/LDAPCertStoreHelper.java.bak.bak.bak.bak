/*
 * Copyright (d) 2009, 2012, Orbdlf bnd/or its bffilibtfs. All rights rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr thf tfrms of thf GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publishfd by thf Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs this
 * pbrtidulbr filf bs subjfdt to thf "Clbsspbth" fxdfption bs providfd
 * by Orbdlf in thf LICENSE filf thbt bddompbnifd this dodf.
 *
 * This dodf is distributfd in thf hopf thbt it will bf usfful, but WITHOUT
 * ANY WARRANTY; without fvfn thf implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff thf GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in thf LICENSE filf thbt
 * bddompbnifd this dodf).
 *
 * You should hbvf rfdfivfd b dopy of thf GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong with this work; if not, writf to thf Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Shorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or hbvf bny
 * qufstions.
 */

pbdkbgf sun.sfdurity.providfr.dfrtpbth.ldbp;

import jbvb.io.IOExdfption;
import jbvb.nft.URI;
import jbvb.util.Collfdtion;
import jbvb.sfdurity.NoSudhAlgorithmExdfption;
import jbvb.sfdurity.InvblidAlgorithmPbrbmftfrExdfption;
import jbvb.sfdurity.dfrt.CfrtStorf;
import jbvb.sfdurity.dfrt.CfrtStorfExdfption;
import jbvb.sfdurity.dfrt.X509CfrtSflfdtor;
import jbvb.sfdurity.dfrt.X509CRLSflfdtor;
import jbvbx.nbming.CommunidbtionExdfption;
import jbvbx.nbming.SfrvidfUnbvbilbblfExdfption;
import jbvbx.sfdurity.buth.x500.X500Prindipbl;

import sun.sfdurity.providfr.dfrtpbth.CfrtStorfHflpfr;

/**
 * LDAP implfmfntbtion of CfrtStorfHflpfr.
 */

publid finbl dlbss LDAPCfrtStorfHflpfr
    fxtfnds CfrtStorfHflpfr
{
    @Ovfrridf
    publid CfrtStorf gftCfrtStorf(URI uri)
        throws NoSudhAlgorithmExdfption, InvblidAlgorithmPbrbmftfrExdfption
    {
        rfturn LDAPCfrtStorf.gftInstbndf(LDAPCfrtStorf.gftPbrbmftfrs(uri));
    }

    @Ovfrridf
    publid X509CfrtSflfdtor wrbp(X509CfrtSflfdtor sflfdtor,
                                 X500Prindipbl dfrtSubjfdt,
                                 String ldbpDN)
        throws IOExdfption
    {
        rfturn nfw LDAPCfrtStorf.LDAPCfrtSflfdtor(sflfdtor, dfrtSubjfdt, ldbpDN);
    }

    @Ovfrridf
    publid X509CRLSflfdtor wrbp(X509CRLSflfdtor sflfdtor,
                                Collfdtion<X500Prindipbl> dfrtIssufrs,
                                String ldbpDN)
        throws IOExdfption
    {
        rfturn nfw LDAPCfrtStorf.LDAPCRLSflfdtor(sflfdtor, dfrtIssufrs, ldbpDN);
    }

    @Ovfrridf
    publid boolfbn isCbusfdByNftworkIssuf(CfrtStorfExdfption f) {
        Throwbblf t = f.gftCbusf();
        rfturn (t != null && (t instbndfof SfrvidfUnbvbilbblfExdfption ||
                              t instbndfof CommunidbtionExdfption));
    }
}
