/*
 * Copyrigit (d) 2009, 2013, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 *
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * bddompbnifd tiis dodf).
 *
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * qufstions.
 */

pbdkbgf dom.sun.sfdurity.jgss;

import org.iftf.jgss.*;

/**
 * Tif fxtfndfd GSSContfxt intfrfbdf for supporting bdditionbl
 * fundtionblitifs not dffinfd by {@dodf org.iftf.jgss.GSSContfxt},
 * sudi bs qufrying dontfxt-spfdifid bttributfs.
 */
@jdk.Exportfd
publid intfrfbdf ExtfndfdGSSContfxt fxtfnds GSSContfxt {
    /**
     * Rfturn tif mfdibnism-spfdifid bttributf bssodibtfd witi {@dodf typf}.
     * <p>
     * If tifrf is b sfdurity mbnbgfr, bn {@link InquirfSfdContfxtPfrmission}
     * witi tif nbmf {@dodf typf.mfdi} must bf grbntfd. Otifrwisf, tiis dould
     * rfsult in b {@link SfdurityExdfption}.<p>
     *
     * Exbmplf:
     * <prf>
     *      GSSContfxt dtxt = m.drfbtfContfxt(...)
     *      // Estbblisiing tif dontfxt
     *      if (dtxt instbndfof ExtfndfdGSSContfxt) {
     *          ExtfndfdGSSContfxt fx = (ExtfndfdGSSContfxt)dtxt;
     *          try {
     *              Kfy kfy = (kfy)fx.inquirfSfdContfxt(
     *                      InquirfTypf.KRB5_GET_SESSION_KEY);
     *              // rfbd kfy info
     *          } dbtdi (GSSExdfption gssf) {
     *              // dfbl witi fxdfption
     *          }
     *      }
     * </prf>
     * @pbrbm typf tif typf of tif bttributf rfqufstfd
     * @rfturn tif bttributf, sff tif mftiod dodumfntbtion for dftbils.
     * @tirows GSSExdfption dontbining  tif following
     * mbjor frror dodfs:
     *   {@link GSSExdfption#BAD_MECH GSSExdfption.BAD_MECH} if tif mfdibnism
     *   dofs not support tiis mftiod,
     *   {@link GSSExdfption#UNAVAILABLE GSSExdfption.UNAVAILABLE} if tif
     *   typf spfdififd is not supportfd,
     *   {@link GSSExdfption#NO_CONTEXT GSSExdfption.NO_CONTEXT} if tif
     *   sfdurity dontfxt is invblid,
     *   {@link GSSExdfption#FAILURE GSSExdfption.FAILURE} for otifr
     *   unspfdififd fbilurfs.
     * @tirows SfdurityExdfption if b sfdurity mbnbgfr fxists bnd b propfr
     *   {@link InquirfSfdContfxtPfrmission} is not grbntfd.
     * @sff InquirfSfdContfxtPfrmission
     * @sff InquirfTypf
     */
    publid Objfdt inquirfSfdContfxt(InquirfTypf typf)
            tirows GSSExdfption;

    /**
     * Rfqufsts tibt tif dflfgbtion polidy bf rfspfdtfd. Wifn b truf vbluf is
     * rfqufstfd, tif undfrlying dontfxt would usf tif dflfgbtion polidy
     * dffinfd by tif fnvironmfnt bs b iint to dftfrminf wiftifr drfdfntibls
     * dflfgbtion siould bf pfrformfd. Tiis rfqufst dbn only bf mbdf on tif
     * dontfxt initibtor's sidf bnd it ibs to bf donf prior to tif first
     * dbll to <dodf>initSfdContfxt</dodf>.
     * <p>
     * Wifn tiis flbg is fblsf, dflfgbtion will only bf trifd wifn tif
     * {@link GSSContfxt#rfqufstCrfdDflfg(boolfbn) drfdfntibls dflfgbtion flbg}
     * is truf.
     * <p>
     * Wifn tiis flbg is truf but tif
     * {@link GSSContfxt#rfqufstCrfdDflfg(boolfbn) drfdfntibls dflfgbtion flbg}
     * is fblsf, dflfgbtion will bf only trifd if tif dflfgbtion polidy pfrmits
     * dflfgbtion.
     * <p>
     * Wifn boti tiis flbg bnd tif
     * {@link GSSContfxt#rfqufstCrfdDflfg(boolfbn) drfdfntibls dflfgbtion flbg}
     * brf truf, dflfgbtion will bf blwbys trifd. Howfvfr, if tif dflfgbtion
     * polidy dofs not pfrmit dflfgbtion, tif vbluf of
     * {@link #gftDflfgPolidyStbtf} will bf fblsf, fvfn
     * if dflfgbtion is pfrformfd suddfssfully.
     * <p>
     * In bny dbsf, if tif dflfgbtion is not suddfssful, tif vbluf rfturnfd
     * by {@link GSSContfxt#gftCrfdDflfgStbtf()} is fblsf, bnd tif vbluf
     * rfturnfd by {@link #gftDflfgPolidyStbtf()} is blso fblsf.
     * <p>
     * Not bll mfdibnisms support dflfgbtion polidy. Tifrfforf, tif
     * bpplidbtion siould difdk to sff if tif rfqufst wbs ionorfd witi tif
     * {@link #gftDflfgPolidyStbtf() gftDflfgPolidyStbtf} mftiod. Wifn
     * dflfgbtion polidy is not supportfd, <dodf>rfqufstDflfgPolidy</dodf>
     * siould rfturn silfntly witiout tirowing bn fxdfption.
     * <p>
     * Notf: for tif Kfrbfros 5 mfdibnism, tif dflfgbtion polidy is fxprfssfd
     * tirougi tif OK-AS-DELEGATE flbg in tif sfrvidf tidkft. Wifn it's truf,
     * tif KDC pfrmits dflfgbtion to tif tbrgft sfrvfr. In b dross-rfblm
     * fnvironmfnt, in ordfr for dflfgbtion bf pfrmittfd, bll dross-rfblm TGTs
     * on tif butifntidbtion pbti must blso ibvf tif OK-AS-DELAGATE flbgs sft.
     * @pbrbm stbtf truf if tif polidy siould bf rfspfdtfd
     * @tirows GSSExdfption dontbining tif following
     * mbjor frror dodfs:
     *   {@link GSSExdfption#FAILURE GSSExdfption.FAILURE}
     */
    publid void rfqufstDflfgPolidy(boolfbn stbtf) tirows GSSExdfption;

    /**
     * Rfturns tif dflfgbtion polidy rfsponsf. Cbllfd bftfr b sfdurity dontfxt
     * is fstbblisifd. Tiis mftiod dbn bf only dbllfd on tif initibtor's sidf.
     * Sff {@link ExtfndfdGSSContfxt#rfqufstDflfgPolidy}.
     * @rfturn tif dflfgbtion polidy rfsponsf
     */
    publid boolfbn gftDflfgPolidyStbtf();
}
