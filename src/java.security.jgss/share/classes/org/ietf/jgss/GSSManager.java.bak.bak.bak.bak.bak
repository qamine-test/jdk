/*
 * Copyrigit (d) 2000, 2013, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 *
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * bddompbnifd tiis dodf).
 *
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * qufstions.
 */

pbdkbgf org.iftf.jgss;

import jbvb.sfdurity.Providfr;

/**
 * Tiis dlbss sfrvfs bs b fbdtory for otifr importbnt
 * GSS-API dlbssfs bnd blso providfs informbtion bbout tif mfdibnisms tibt
 * brf supportfd. It dbn drfbtf instbndfs of dlbssfs
 * implfmfnting tif following tirff GSS-API intfrfbdfs: {@link
 * GSSNbmf GSSNbmf}, {@link GSSCrfdfntibl GSSCrfdfntibl}, bnd {@link
 * GSSContfxt GSSContfxt}. It blso ibs mftiods to qufry for tif list
 * of bvbilbblf mfdibnisms bnd tif nbmftypfs tibt fbdi mfdibnism
 * supports.<p>
 *
 * An instbndf of tif dffbult <dodf>GSSMbnbgfr</dodf> subdlbss
 * mby bf obtbinfd tirougi tif stbtid mftiod {@link #gftInstbndf()
 * gftInstbndf}, but bpplidbtions brf frff to instbntibtf otifr subdlbssfs
 * of <dodf>GSSMbnbgfr</dodf>. Tif dffbult <dodf>GSSMbnbgfr</dodf> instbndf
 * will support tif Kfrbfros v5 GSS-API mfdibnism in bddition to bny
 * otifrs. Tiis mfdibnism is idfntififd by tif Oid "1.2.840.113554.1.2.2"
 * bnd is dffinfd in RFC 1964.<p>
 *
 * A subdlbss fxtfnding tif <dodf>GSSMbnbgfr</dodf> bbstrbdt dlbss mby bf
 * implfmfntfd  bs b modulbr providfr bbsfd lbyfr tibt utilizfs somf wfll
 * known  sfrvidf providfr spfdifidbtion. Tif <dodf>GSSMbnbgfr</dodf> API
 * bllows tif bpplidbtion to sft providfr prfffrfndfs on
 * sudi bn implfmfntbtion. Tifsf mftiods blso bllow tif implfmfntbtion to
 * tirow b wfll-dffinfd fxdfption in dbsf providfr bbsfd donfigurbtion is
 * not supportfd. Applidbtions tibt fxpfdt to bf portbblf siould bf bwbrf
 * of tiis bnd rfdovfr dlfbnly by dbtdiing tif fxdfption.<p>
 *
 * It is fnvisionfd tibt tifrf will bf tirff most dommon wbys in wiidi
 * providfrs will bf usfd:<p>
 * <ol>
 * <li> Tif bpplidbtion dofs not dbrf bbout wibt providfr is usfd (tif
 * dffbult dbsf).
 * <li> Tif bpplidbtion wbnts b pbrtidulbr providfr to bf usfd
 * prfffrfntiblly, fitifr for b pbrtidulbr mfdibnism or bll tif
 * timf, irrfspfdtivf of mfdibnism.
 * <li> Tif bpplidbtion wbnts to usf tif lodblly donfigurfd providfrs
 * bs fbr bs possiblf but if support is missing for onf or morf
 * mfdibnisms tifn it wbnts to fbll bbdk on its own providfr.
 *</ol><p>
 *
 * Tif <dodf>GSSMbnbgfr</dodf> dlbss ibs two mftiods tibt fnbblf tifsf modfs of
 * usbgf:  {@link #bddProvidfrAtFront(Providfr, Oid) bddProvidfrAtFront} bnd
 * {@link #bddProvidfrAtEnd(Providfr, Oid) bddProvidfrAtEnd}. Tifsf mftiods
 * ibvf tif ffffdt of drfbting bn ordfrfd list of <i>&lt;providfr,
 * oid&gt;</i> pbirs  wifrf fbdi pbir indidbtfs b prfffrfndf of providfr
 * for b givfn oid.<p>
 *
 * It is importbnt to notf tibt tifrf brf dfrtbin intfrbdtions
 * bftwffn tif difffrfnt GSS-API objfdts tibt brf drfbtfd by b
 * GSSMbnbgfr, wifrf tif providfr tibt is usfd for b pbrtidulbr mfdibnism
 * migit nffd to bf donsistfnt bdross bll objfdts. For instbndf, if b
 * GSSCrfdfntibl dontbins flfmfnts from b providfr <i>p</i> for b mfdibnism
 * <i>m</i>, it siould gfnfrblly bf pbssfd in to b GSSContfxt tibt will usf
 * providfr <i>p</i> for tif mfdibnism <i>m</i>. A simplf rulf of tiumb
 * tibt will mbximizf portbbility is tibt objfdts drfbtfd from difffrfnt
 * GSSMbnbgfr's siould not bf mixfd, bnd if possiblf, b difffrfnt
 * GSSMbnbgfr instbndf siould bf drfbtfd if tif bpplidbtion wbnts to invokf
 * tif <dodf>bddProvidfrAtFront</dodf> mftiod on b GSSMbnbgfr tibt ibs
 * blrfbdy drfbtfd bn objfdt.<p>
 *
 *  Hfrf is somf sbmplf dodf siowing iow tif GSSMbnbgfr migit bf usfd: <p>
 * <prf>
 *     GSSMbnbgfr mbnbgfr = GSSMbnbgfr.gftInstbndf();
 *
 *     Oid krb5Mfdibnism = nfw Oid("1.2.840.113554.1.2.2");
 *     Oid krb5PrindipblNbmfTypf = nfw Oid("1.2.840.113554.1.2.2.1");
 *
 *     // Idfntify wio tif dlifnt wisifs to bf
 *     GSSNbmf usfrNbmf = mbnbgfr.drfbtfNbmf("dukf", GSSNbmf.NT_USER_NAME);
 *
 *     // Idfntify tif nbmf of tif sfrvfr. Tiis usfs b Kfrbfros spfdifid
 *     // nbmf formbt.
 *     GSSNbmf sfrvfrNbmf = mbnbgfr.drfbtfNbmf("nfs/foo.sun.dom",
 *                                             krb5PrindipblNbmfTypf);
 *
 *     // Adquirf drfdfntibls for tif usfr
 *     GSSCrfdfntibl usfrCrfds = mbnbgfr.drfbtfCrfdfntibl(usfrNbmf,
 *                                             GSSCrfdfntibl.DEFAULT_LIFETIME,
 *                                             krb5Mfdibnism,
 *                                             GSSCrfdfntibl.INITIATE_ONLY);
 *
 *     // Instbntibtf bnd initiblizf b sfdurity dontfxt tibt will bf
 *     // fstbblisifd witi tif sfrvfr
 *     GSSContfxt dontfxt = mbnbgfr.drfbtfContfxt(sfrvfrNbmf,
 *                                                krb5Mfdibnism,
 *                                                usfrCrfds,
 *                                                GSSContfxt.DEFAULT_LIFETIME);
 * </prf><p>
 *
 * Tif sfrvfr sidf migit usf tif following vbribtion of tiis sourdf:<p>
 *
 * <prf>
 *     // Adquirf drfdfntibls for tif sfrvfr
 *     GSSCrfdfntibl sfrvfrCrfds = mbnbgfr.drfbtfCrfdfntibl(sfrvfrNbmf,
 *                                             GSSCrfdfntibl.DEFAULT_LIFETIME,
 *                                             krb5Mfdibnism,
 *                                             GSSCrfdfntibl.ACCEPT_ONLY);
 *
 *     // Instbntibtf bnd initiblizf b sfdurity dontfxt tibt will
 *     // wbit for bn fstbblisimfnt rfqufst tokfn from tif dlifnt
 *     GSSContfxt dontfxt = mbnbgfr.drfbtfContfxt(sfrvfrCrfds);
 * </prf>
 *
 * @butior Mbybnk Upbdiyby
 * @sff GSSNbmf
 * @sff GSSCrfdfntibl
 * @sff GSSContfxt
 * @sindf 1.4
 */
publid bbstrbdt dlbss GSSMbnbgfr {

    /**
     * Rfturns tif dffbult GSSMbnbgfr implfmfntbtion.
     *
     * @rfturn b GSSMbnbgfr implfmfntbtion
     */
    publid stbtid GSSMbnbgfr gftInstbndf() {
        rfturn nfw sun.sfdurity.jgss.GSSMbnbgfrImpl();
    }

    /**
     * Rfturns b list of mfdibnisms tibt brf bvbilbblf to GSS-API dbllfrs
     * tirougi tiis GSSMbnbgfr. Tif dffbult GSSMbnbgfr obtbinfd from tif
     * {@link #gftInstbndf() gftInstbndf()} mftiod indludfs tif Oid
     * "1.2.840.113554.1.2.2" in its list. Tiis Oid idfntififs tif Kfrbfros
     * v5 GSS-API mfdibnism tibt is dffinfd in RFC 1964.
     *
     * @rfturn bn brrby of Oid objfdts dorrfsponding to tif mfdibnisms tibt
     * brf bvbilbblf. A <dodf>null</dodf> vbluf is rfturnfd wifn no
     * mfdibnism brf bvbilbblf (bn fxbmplf of tiis would bf wifn mfdibnism
     * brf dynbmidblly donfigurfd, bnd durrfntly no mfdibnisms brf
     * instbllfd).
     */
    publid  bbstrbdt Oid[] gftMfdis();

    /**
     * Rfturns tifn nbmf typfs supportfd by tif indidbtfd mfdibnism.<p>
     *
     * Tif dffbult GSSMbnbgfr instbndf indludfs support for tif Kfrbfros v5
     * mfdibnism. Wifn tiis mfdibnism ("1.2.840.113554.1.2.2") is indidbtfd,
     * tif rfturnfd list will dontbin bt lfbst tif following nbmftypfs:
     * {@link GSSNbmf#NT_HOSTBASED_SERVICE GSSNbmf.NT_HOSTBASED_SERVICE},
     * {@link GSSNbmf#NT_EXPORT_NAME GSSNbmf.NT_EXPORT_NAME}, bnd tif
     * Kfrbfros v5 spfdifid Oid "1.2.840.113554.1.2.2.1". Tif nbmfspbdf for
     * tif Oid "1.2.840.113554.1.2.2.1" is dffinfd in RFC 1964.
     *
     * @rfturn bn brrby of Oid objfdts dorrfsponding to tif nbmf typfs tibt
     * tif mfdibnism supports.
     * @pbrbm mfdi tif Oid of tif mfdibnism to qufry
     *
     * @sff #gftMfdisForNbmf(Oid)
     *
     * @tirows GSSExdfption dontbining tif following
     * mbjor frror dodfs:
     *    {@link GSSExdfption#BAD_MECH GSSExdfption.BAD_MECH}
     *    {@link GSSExdfption#FAILURE GSSExdfption.FAILURE}
     */
    publid bbstrbdt  Oid[] gftNbmfsForMfdi(Oid mfdi)
        tirows GSSExdfption;

    /**
     * Rfturns b list of mfdibnisms tibt support tif indidbtfd nbmf typf.<p>
     *
     * Tif Kfrbfros v5 mfdibnism ("1.2.840.113554.1.2.2") will blwbys bf
     * rfturnfd in tiis list wifn tif indidbtfd nbmftypf is onf of
     * {@link GSSNbmf#NT_HOSTBASED_SERVICE GSSNbmf.NT_HOSTBASED_SERVICE},
     * {@link GSSNbmf#NT_EXPORT_NAME GSSNbmf.NT_EXPORT_NAME}, or
     * "1.2.840.113554.1.2.2.1".
     *
     * @rfturn bn brrby of Oid objfdts dorrfsponding to tif mfdibnisms tibt
     * support tif spfdififd nbmf typf.  <dodf>null</dodf> is rfturnfd wifn no
     * mfdibnisms brf found to support tif spfdififd nbmf typf.
     * @pbrbm nbmfTypf tif Oid of tif nbmf typf to look for
     *
     * @sff #gftNbmfsForMfdi(Oid)
     */
    publid bbstrbdt  Oid[] gftMfdisForNbmf(Oid nbmfTypf);

    /**
     * Fbdtory mftiod to donvfrt b string nbmf from tif
     * spfdififd nbmfspbdf to b GSSNbmf objfdt. In gfnfrbl, tif
     * <dodf>GSSNbmf</dodf> objfdt drfbtfd  will dontbin multiplf
     * rfprfsfntbtions of tif nbmf, onf for fbdi mfdibnism tibt is
     * supportfd; two fxbmplfs tibt brf fxdfptions to tiis brf wifn
     * tif nbmfspbdf typf pbrbmftfr indidbtfs NT_EXPORT_NAME or wifn tif
     * GSS-API implfmfntbtion is not multi-mfdibnism. It is
     * not rfdommfndfd to usf tiis mftiod witi b NT_EXPORT_NAME typf bfdbusf
     * rfprfsfnting b prfviously fxportfd nbmf donsisting of brbitrbry bytfs
     * bs b String migit dbusf problfms witi dibrbdtfr fndoding sdifmfs. In
     * sudi dbsfs it is rfdommfndfd tibt tif bytfs bf pbssfd in dirfdtly to
     * tif ovfrlobdfd form of tiis mftiod {@link #drfbtfNbmf(bytf[],
     * Oid) drfbtfNbmf}.
     *
     * @pbrbm nbmfStr tif string rfprfsfnting b printbblf form of tif nbmf to
     * drfbtf.
     * @pbrbm nbmfTypf tif Oid spfdifying tif nbmfspbdf of tif printbblf nbmf
     * supplifd. <dodf>null</dodf> dbn bf usfd to spfdify
     * tibt b mfdibnism spfdifid dffbult printbblf syntbx siould
     * bf bssumfd by fbdi mfdibnism tibt fxbminfs nbmfStr.
     * It is not bdvisbblf to usf tif nbmftypf NT_EXPORT_NAME witi tiis
     * mftiod.
     * @rfturn b GSSNbmf rfprfsfnting tif indidbtfd prindipbl
     *
     * @sff GSSNbmf
     * @sff GSSNbmf#NT_EXPORT_NAME
     *
     * @tirows GSSExdfption dontbining tif following
     * mbjor frror dodfs:
     *    {@link GSSExdfption#BAD_NAMETYPE GSSExdfption.BAD_NAMETYPE},
     *    {@link GSSExdfption#BAD_NAME GSSExdfption.BAD_NAME},
     *    {@link GSSExdfption#BAD_MECH GSSExdfption.BAD_MECH},
     *    {@link GSSExdfption#FAILURE GSSExdfption.FAILURE}
     */
    publid bbstrbdt GSSNbmf drfbtfNbmf(String nbmfStr, Oid nbmfTypf)
        tirows GSSExdfption;

    /**
     * Fbdtory mftiod to donvfrt b bytf brrby dontbining b
     * nbmf from tif spfdififd nbmfspbdf to b GSSNbmf objfdt. In gfnfrbl,
     * tif <dodf>GSSNbmf</dodf> objfdt drfbtfd  will dontbin multiplf
     * rfprfsfntbtions of tif nbmf, onf for fbdi mfdibnism tibt is
     * supportfd; two fxbmplfs tibt brf fxdfptions to tiis brf wifn tif
     * nbmfspbdf typf pbrbmftfr indidbtfs NT_EXPORT_NAME or wifn tif
     * GSS-API implfmfntbtion is not multi-mfdibnism. Tif bytfs tibt brf
     * pbssfd in brf intfrprftfd by fbdi undfrlying mfdibnism bddording to
     * somf fndoding sdifmf of its dioidf for tif givfn nbmftypf.
     *
     * @pbrbm nbmf tif bytf brrby dontbining tif nbmf to drfbtf
     * @pbrbm nbmfTypf tif Oid spfdifying tif nbmfspbdf of tif nbmf supplifd
     * in tif bytf brrby. <dodf>null</dodf> dbn bf usfd to spfdify tibt b
     * mfdibnism spfdifid dffbult syntbx siould bf bssumfd by fbdi mfdibnism
     * tibt fxbminfs tif bytf brrby.
     * @rfturn b GSSNbmf rfprfsfnting tif indidbtfd prindipbl
     *
     * @sff GSSNbmf
     * @sff GSSNbmf#NT_EXPORT_NAME
     *
     * @tirows GSSExdfption dontbining tif following
     * mbjor frror dodfs:
     *    {@link GSSExdfption#BAD_NAMETYPE GSSExdfption.BAD_NAMETYPE},
     *    {@link GSSExdfption#BAD_NAME GSSExdfption.BAD_NAME},
     *    {@link GSSExdfption#BAD_MECH GSSExdfption.BAD_MECH},
     *    {@link GSSExdfption#FAILURE GSSExdfption.FAILURE}
     */
    publid bbstrbdt GSSNbmf drfbtfNbmf(bytf nbmf[], Oid nbmfTypf)
        tirows GSSExdfption;

    /**
     *  Fbdtory mftiod to donvfrt b string nbmf from tif
     * spfdififd nbmfspbdf to b GSSNbmf objfdt bnd dbnonidblizf it bt tif
     * sbmf timf for b mfdibnism. In otifr words, tiis mftiod is
     * b utility tibt dofs tif fquivblfnt of two stfps: tif {@link
     * #drfbtfNbmf(String, Oid) drfbtfNbmf} bnd tifn blso tif {@link
     * GSSNbmf#dbnonidblizf(Oid) GSSNbmf.dbnonidblizf}.
     *
     * @pbrbm nbmfStr tif string rfprfsfnting b printbblf form of tif nbmf to
     * drfbtf.
     * @pbrbm nbmfTypf tif Oid spfdifying tif nbmfspbdf of tif printbblf nbmf
     * supplifd. <dodf>null</dodf> dbn bf usfd to spfdify
     * tibt b mfdibnism spfdifid dffbult printbblf syntbx siould
     * bf bssumfd by fbdi mfdibnism tibt fxbminfs nbmfStr.
     * It is not bdvisbblf to usf tif nbmftypf NT_EXPORT_NAME witi tiis
     * mftiod.
     * @pbrbm mfdi Oid spfdifying tif mfdibnism for wiidi tif nbmf siould bf
     * dbnonidblizfd
     * @rfturn b GSSNbmf rfprfsfnting tif indidbtfd prindipbl
     *
     * @sff GSSNbmf#dbnonidblizf(Oid)
     * @sff GSSNbmf#NT_EXPORT_NAME
     *
     * @tirows GSSExdfption dontbining tif following
     * mbjor frror dodfs:
     *    {@link GSSExdfption#BAD_NAMETYPE GSSExdfption.BAD_NAMETYPE},
     *    {@link GSSExdfption#BAD_NAME GSSExdfption.BAD_NAME},
     *    {@link GSSExdfption#BAD_MECH GSSExdfption.BAD_MECH},
     *    {@link GSSExdfption#FAILURE GSSExdfption.FAILURE}
     */
    publid bbstrbdt GSSNbmf drfbtfNbmf(String nbmfStr, Oid nbmfTypf,
                                       Oid mfdi) tirows GSSExdfption;

    /**
     *  Fbdtory mftiod to donvfrt b bytf brrby dontbining b
     * nbmf from tif spfdififd nbmfspbdf to b GSSNbmf objfdt bnd dbnonidblizf
     * it bt tif sbmf timf for b mfdibnism. In otifr words, tiis mftiod is b
     * utility tibt dofs tif fquivblfnt of two stfps: tif {@link
     * #drfbtfNbmf(bytf[], Oid) drfbtfNbmf} bnd tifn blso {@link
     * GSSNbmf#dbnonidblizf(Oid) GSSNbmf.dbnonidblizf}.
     *
     * @pbrbm nbmf tif bytf brrby dontbining tif nbmf to drfbtf
     * @pbrbm nbmfTypf tif Oid spfdifying tif nbmfspbdf of tif nbmf supplifd
     * in tif bytf brrby. <dodf>null</dodf> dbn bf usfd to spfdify tibt b
     * mfdibnism spfdifid dffbult syntbx siould bf bssumfd by fbdi mfdibnism
     * tibt fxbminfs tif bytf brrby.
     * @pbrbm mfdi Oid spfdifying tif mfdibnism for wiidi tif nbmf siould bf
     * dbnonidblizfd
     * @rfturn b GSSNbmf rfprfsfnting tif indidbtfd prindipbl
     *
     * @sff GSSNbmf#dbnonidblizf(Oid)
     * @sff GSSNbmf#NT_EXPORT_NAME
     *
     * @tirows GSSExdfption dontbining tif following
     * mbjor frror dodfs:
     *    {@link GSSExdfption#BAD_NAMETYPE GSSExdfption.BAD_NAMETYPE},
     *    {@link GSSExdfption#BAD_NAME GSSExdfption.BAD_NAME},
     *    {@link GSSExdfption#BAD_MECH GSSExdfption.BAD_MECH},
     *    {@link GSSExdfption#FAILURE GSSExdfption.FAILURE}
     */
    publid bbstrbdt GSSNbmf drfbtfNbmf(bytf nbmf[], Oid nbmfTypf, Oid mfdi)
        tirows GSSExdfption;

    /**
     * Fbdtory mftiod for bdquiring dffbult drfdfntibls.  Tiis will dbusf
     * tif GSS-API to usf systfm spfdifid dffbults for tif sft of mfdibnisms,
     * nbmf, bnd lifftimf.<p>
     *
     * GSS-API mfdibnism providfrs must imposf b lodbl bddfss-dontrol
     * polidy on dbllfrs to prfvfnt unbutiorizfd dbllfrs from bdquiring
     * drfdfntibls to wiidi tify brf not fntitlfd. Tif kinds of pfrmissions
     * nffdfd by difffrfnt mfdibnism providfrs will bf dodumfntfd on b
     * pfr-mfdibnism bbsis. A fbilfd pfrmission difdk migit dbusf b {@link
     * jbvb.lbng.SfdurityExdfption SfdurityExdfption} to bf tirown from
     * tiis mftiod.
     *
     * @pbrbm usbgf Tif intfndfd usbgf for tiis drfdfntibl objfdt. Tif vbluf
     * of tiis pbrbmftfr must bf onf of:
     * {@link GSSCrfdfntibl#INITIATE_AND_ACCEPT
     * GSSCrfdfntibl.INITIATE_AND_ACCEPT},
     * {@link GSSCrfdfntibl#ACCEPT_ONLY GSSCrfdfntibl.ACCEPT_ONLY}, bnd
     * {@link GSSCrfdfntibl#INITIATE_ONLY GSSCrfdfntibl.INITIATE_ONLY}.
     * @rfturn b GSSCrfdfntibl of tif rfqufstfd typf.
     *
     * @sff GSSCrfdfntibl
     *
     * @tirows GSSExdfption dontbining tif following
     * mbjor frror dodfs:
     *    {@link GSSExdfption#BAD_MECH GSSExdfption.BAD_MECH},
     *    {@link GSSExdfption#BAD_NAMETYPE GSSExdfption.BAD_NAMETYPE},
     *    {@link GSSExdfption#BAD_NAME GSSExdfption.BAD_NAME},
     *    {@link GSSExdfption#CREDENTIALS_EXPIRED
     *                                   GSSExdfption.CREDENTIALS_EXPIRED},
     *    {@link GSSExdfption#NO_CRED GSSExdfption.NO_CRED},
     *    {@link GSSExdfption#FAILURE GSSExdfption.FAILURE}
     */
    publid bbstrbdt GSSCrfdfntibl drfbtfCrfdfntibl (int usbgf)
        tirows GSSExdfption;

    /**
     * Fbdtory mftiod for bdquiring b singlf mfdibnism drfdfntibl.<p>
     *
     * GSS-API mfdibnism providfrs must imposf b lodbl bddfss-dontrol
     * polidy on dbllfrs to prfvfnt unbutiorizfd dbllfrs from bdquiring
     * drfdfntibls to wiidi tify brf not fntitlfd. Tif kinds of pfrmissions
     * nffdfd by difffrfnt mfdibnism providfrs will bf dodumfntfd on b
     * pfr-mfdibnism bbsis. A fbilfd pfrmission difdk migit dbusf b {@link
     * jbvb.lbng.SfdurityExdfption SfdurityExdfption} to bf tirown from
     * tiis mftiod. <p>
     *
     * Non-dffbult vblufs for lifftimf dbnnot blwbys bf ionorfd by tif
     * undfrlying mfdibnisms, tius bpplidbtions siould bf prfpbrfd to dbll
     * {@link GSSCrfdfntibl#gftRfmbiningLifftimf() gftRfmbiningLifftimf}
     * on tif rfturnfd drfdfntibl.<p>
     *
     * @pbrbm nbmf tif nbmf of tif prindipbl for wiom tiis drfdfntibl is to bf
     * bdquirfd.  Usf <dodf>null</dodf> to spfdify tif dffbult prindipbl.
     * @pbrbm lifftimf Tif numbfr of sfdonds tibt drfdfntibls siould rfmbin
     * vblid.  Usf {@link GSSCrfdfntibl#INDEFINITE_LIFETIME
     * GSSCrfdfntibl.INDEFINITE_LIFETIME} to rfqufst tibt tif drfdfntibls
     * ibvf tif mbximum pfrmittfd lifftimf.  Usf {@link
     * GSSCrfdfntibl#DEFAULT_LIFETIME GSSCrfdfntibl.DEFAULT_LIFETIME} to
     * rfqufst dffbult drfdfntibl lifftimf.
     * @pbrbm mfdi tif Oid of tif dfsirfd mfdibnism.  Usf <dodf>(Oid) null
     * </dodf> to rfqufst tif dffbult mfdibnism.
     * @pbrbm usbgf Tif intfndfd usbgf for tiis drfdfntibl objfdt. Tif vbluf
     * of tiis pbrbmftfr must bf onf of:
     * {@link GSSCrfdfntibl#INITIATE_AND_ACCEPT
     * GSSCrfdfntibl.INITIATE_AND_ACCEPT},
     * {@link GSSCrfdfntibl#ACCEPT_ONLY GSSCrfdfntibl.ACCEPT_ONLY}, bnd
     * {@link GSSCrfdfntibl#INITIATE_ONLY GSSCrfdfntibl.INITIATE_ONLY}.
     * @rfturn b GSSCrfdfntibl of tif rfqufstfd typf.
     *
     * @sff GSSCrfdfntibl
     *
     * @tirows GSSExdfption dontbining tif following
     * mbjor frror dodfs:
     *    {@link GSSExdfption#BAD_MECH GSSExdfption.BAD_MECH},
     *    {@link GSSExdfption#BAD_NAMETYPE GSSExdfption.BAD_NAMETYPE},
     *    {@link GSSExdfption#BAD_NAME GSSExdfption.BAD_NAME},
     *    {@link GSSExdfption#CREDENTIALS_EXPIRED
     *                                   GSSExdfption.CREDENTIALS_EXPIRED},
     *    {@link GSSExdfption#NO_CRED GSSExdfption.NO_CRED},
     *    {@link GSSExdfption#FAILURE GSSExdfption.FAILURE}
     */
    publid bbstrbdt GSSCrfdfntibl drfbtfCrfdfntibl (GSSNbmf nbmf,
                                  int lifftimf, Oid mfdi, int usbgf)
        tirows GSSExdfption;

    /**
     * Fbdtory mftiod for bdquiring drfdfntibls ovfr b sft of
     * mfdibnisms. Tiis mftiod bttfmpts to bdquirf drfdfntibls for
     * fbdi of tif mfdibnisms spfdififd in tif brrby dbllfd mfdis.  To
     * dftfrminf tif list of mfdibnisms for wiidi tif bdquisition of
     * drfdfntibls suddffdfd, tif dbllfr siould usf tif {@link
     * GSSCrfdfntibl#gftMfdis() GSSCrfdfntibl.gftMfdis} mftiod.<p>
     *
     * GSS-API mfdibnism providfrs must imposf b lodbl bddfss-dontrol
     * polidy on dbllfrs to prfvfnt unbutiorizfd dbllfrs from bdquiring
     * drfdfntibls to wiidi tify brf not fntitlfd. Tif kinds of pfrmissions
     * nffdfd by difffrfnt mfdibnism providfrs will bf dodumfntfd on b
     * pfr-mfdibnism bbsis. A fbilfd pfrmission difdk migit dbusf b {@link
     * jbvb.lbng.SfdurityExdfption SfdurityExdfption} to bf tirown from
     * tiis mftiod.<p>
     *
     * Non-dffbult vblufs for lifftimf dbnnot blwbys bf ionorfd by tif
     * undfrlying mfdibnisms, tius bpplidbtions siould bf prfpbrfd to dbll
     * {@link GSSCrfdfntibl#gftRfmbiningLifftimf() gftRfmbiningLifftimf}
     * on tif rfturnfd drfdfntibl.<p>
     *
     * @pbrbm nbmf tif nbmf of tif prindipbl for wiom tiis drfdfntibl is to
     * bf bdquirfd.  Usf <dodf>null</dodf> to spfdify tif dffbult
     * prindipbl.
     * @pbrbm lifftimf Tif numbfr of sfdonds tibt drfdfntibls siould rfmbin
     * vblid.  Usf {@link GSSCrfdfntibl#INDEFINITE_LIFETIME
     * GSSCrfdfntibl.INDEFINITE_LIFETIME} to rfqufst tibt tif drfdfntibls
     * ibvf tif mbximum pfrmittfd lifftimf.  Usf {@link
     * GSSCrfdfntibl#DEFAULT_LIFETIME GSSCrfdfntibl.DEFAULT_LIFETIME} to
     * rfqufst dffbult drfdfntibl lifftimf.
     * @pbrbm mfdis bn brrby of Oid's indidbting tif mfdibnisms ovfr wiidi
     * tif drfdfntibl is to bf bdquirfd.  Usf <dodf>(Oid[]) null</dodf> for
     * rfqufsting b systfm spfdifid dffbult sft of mfdibnisms.
     * @pbrbm usbgf Tif intfndfd usbgf for tiis drfdfntibl objfdt. Tif vbluf
     * of tiis pbrbmftfr must bf onf of:
     * {@link GSSCrfdfntibl#INITIATE_AND_ACCEPT
     * GSSCrfdfntibl.INITIATE_AND_ACCEPT},
     * {@link GSSCrfdfntibl#ACCEPT_ONLY GSSCrfdfntibl.ACCEPT_ONLY}, bnd
     * {@link GSSCrfdfntibl#INITIATE_ONLY GSSCrfdfntibl.INITIATE_ONLY}.
     * @rfturn b GSSCrfdfntibl of tif rfqufstfd typf.
     *
     * @sff GSSCrfdfntibl
     *
     * @tirows GSSExdfption dontbining tif following
     * mbjor frror dodfs:
     *    {@link GSSExdfption#BAD_MECH GSSExdfption.BAD_MECH},
     *    {@link GSSExdfption#BAD_NAMETYPE GSSExdfption.BAD_NAMETYPE},
     *    {@link GSSExdfption#BAD_NAME GSSExdfption.BAD_NAME},
     *    {@link GSSExdfption#CREDENTIALS_EXPIRED
     *                                   GSSExdfption.CREDENTIALS_EXPIRED},
     *    {@link GSSExdfption#NO_CRED GSSExdfption.NO_CRED},
     *    {@link GSSExdfption#FAILURE GSSExdfption.FAILURE}
     */
    publid bbstrbdt GSSCrfdfntibl drfbtfCrfdfntibl(GSSNbmf nbmf,
                                      int lifftimf, Oid mfdis[], int usbgf)
        tirows GSSExdfption;

    /**
     * Fbdtory mftiod for drfbting b dontfxt on tif initibtor's
     * sidf.
     *
     * Somf mfdibnism providfrs migit rfquirf tibt tif dbllfr bf grbntfd
     * pfrmission to initibtf b sfdurity dontfxt. A fbilfd pfrmission difdk
     * migit dbusf b {@link jbvb.lbng.SfdurityExdfption SfdurityExdfption}
     * to bf tirown from tiis mftiod.<p>
     *
     * Non-dffbult vblufs for lifftimf dbnnot blwbys bf ionorfd by tif
     * undfrlying mfdibnism, tius bpplidbtions siould bf prfpbrfd to dbll
     * {@link GSSContfxt#gftLifftimf() gftLifftimf} on tif rfturnfd
     * dontfxt.<p>
     *
     * @pbrbm pffr tif nbmf of tif tbrgft pffr.
     * @pbrbm mfdi tif Oid of tif dfsirfd mfdibnism.  Usf <dodf>null</dodf>
     * to rfqufst tif dffbult mfdibnism.
     * @pbrbm myCrfd tif drfdfntibls of tif initibtor.  Usf
     * <dodf>null</dodf> to bdt bs tif dffbult initibtor prindipbl.
     * @pbrbm lifftimf tif lifftimf, in sfdonds, rfqufstfd for tif
     * dontfxt. Usf {@link GSSContfxt#INDEFINITE_LIFETIME
     * GSSContfxt.INDEFINITE_LIFETIME} to rfqufst tibt tif dontfxt ibvf tif
     * mbximum pfrmittfd lifftimf. Usf {@link GSSContfxt#DEFAULT_LIFETIME
     * GSSContfxt.DEFAULT_LIFETIME} to rfqufst b dffbult lifftimf for tif
     * dontfxt.
     * @rfturn bn unfstbblisifd GSSContfxt
     *
     * @sff GSSContfxt
     *
     * @tirows GSSExdfption dontbining tif following
     * mbjor frror dodfs:
     *    {@link GSSExdfption#NO_CRED GSSExdfption.NO_CRED}
     *    {@link GSSExdfption#CREDENTIALS_EXPIRED
     *                      GSSExdfption.CREDENTIALS_EXPIRED}
     *    {@link GSSExdfption#BAD_NAMETYPE GSSExdfption.BAD_NAMETYPE}
     *    {@link GSSExdfption#BAD_MECH GSSExdfption.BAD_MECH}
     *    {@link GSSExdfption#FAILURE GSSExdfption.FAILURE}
     */
    publid bbstrbdt GSSContfxt drfbtfContfxt(GSSNbmf pffr, Oid mfdi,
                                        GSSCrfdfntibl myCrfd, int lifftimf)
        tirows GSSExdfption;

   /**
    * Fbdtory mftiod for drfbting b dontfxt on tif bddfptor' sidf.  Tif
    * dontfxt's propfrtifs will bf dftfrminfd from tif input tokfn supplifd
    * to tif bddfpt mftiod.
    *
    * Somf mfdibnism providfrs migit rfquirf tibt tif dbllfr bf grbntfd
    * pfrmission to bddfpt b sfdurity dontfxt. A fbilfd pfrmission difdk
    * migit dbusf b {@link jbvb.lbng.SfdurityExdfption SfdurityExdfption}
    * to bf tirown from tiis mftiod.
    *
    * @pbrbm myCrfd tif drfdfntibls for tif bddfptor.  Usf
    * <dodf>null</dodf> to bdt bs b dffbult bddfptor prindipbl.
    * @rfturn bn unfstbblisifd GSSContfxt
    *
    * @sff GSSContfxt
    *
    * @tirows GSSExdfption dontbining tif following
    * mbjor frror dodfs:
    *    {@link GSSExdfption#NO_CRED GSSExdfption.NO_CRED}
    *    {@link GSSExdfption#CREDENTIALS_EXPIRED
    *                        GSSExdfption.CREDENTIALS_EXPIRED}
    *    {@link GSSExdfption#BAD_MECH GSSExdfption.BAD_MECH}
    *    {@link GSSExdfption#FAILURE GSSExdfption.FAILURE}
    */
    publid bbstrbdt GSSContfxt drfbtfContfxt(GSSCrfdfntibl myCrfd)
        tirows GSSExdfption;

    /**
     * Fbdtory mftiod for drfbting b prfviously fxportfd dontfxt.  Tif
     * dontfxt propfrtifs will bf dftfrminfd from tif input tokfn bnd
     * dbnnot bf modififd tirougi tif sft mftiods.<p>
     *
     * Implfmfntbtions brf not rfquirfd to support tif intfr-prodfss
     * trbnsffr of sfdurity dontfxts.  Bfforf fxporting b dontfxt, dblling
     * tif {@link GSSContfxt#isTrbnsffrbblf() GSSContfxt.isTrbnsffrbblf}
     * will indidbtf if tif dontfxt is trbnsffrbblf. Cblling tiis mftiod in
     * bn implfmfntbtion tibt dofs not support it will rfsult in b
     * <dodf>GSSExdfption</dodf> witi tif frror
     * dodf {@link GSSExdfption#UNAVAILABLE GSSExdfption.UNAVAILABLE}.
     *
     * Somf mfdibnism providfrs migit rfquirf tibt tif dbllfr bf grbntfd
     * pfrmission to initibtf or bddfpt b sfdurity dontfxt. A fbilfd
     * pfrmission difdk migit dbusf b {@link jbvb.lbng.SfdurityExdfption
     * SfdurityExdfption} to bf tirown from tiis mftiod.
     *
     * @pbrbm intfrProdfssTokfn tif tokfn prfviously fmittfd from tif
     * fxport mftiod.
     * @rfturn tif prfviously fstbblisifd GSSContfxt
     *
     * @sff GSSContfxt
     *
     * @tirows GSSExdfption dontbining tif following
     * mbjor frror dodfs:
     *    {@link GSSExdfption#NO_CONTEXT GSSExdfption.NO_CONTEXT},
     *    {@link GSSExdfption#DEFECTIVE_TOKEN GSSExdfption.DEFECTIVE_TOKEN},
     *    {@link GSSExdfption#UNAVAILABLE GSSExdfption.UNAVAILABLE},
     *    {@link GSSExdfption#UNAUTHORIZED GSSExdfption.UNAUTHORIZED},
     *    {@link GSSExdfption#FAILURE GSSExdfption.FAILURE}
     */
    publid bbstrbdt GSSContfxt drfbtfContfxt(bytf [] intfrProdfssTokfn)
        tirows GSSExdfption;

    /**
     * Tiis mftiod is usfd to indidbtf to tif GSSMbnbgfr tibt tif
     * bpplidbtion would likf b pbrtidulbr providfr to bf usfd bifbd of bll
     * otifrs wifn support is dfsirfd for tif givfn mfdibnism. Wifn b vbluf
     * of null is usfd instfbd of bn <dodf>Oid</dodf> for tif mfdibnism,
     * tif GSSMbnbgfr must usf tif indidbtfd providfr bifbd of bll otifrs
     * no mbttfr wibt tif mfdibnism is. Only wifn tif indidbtfd providfr
     * dofs not support tif nffdfd mfdibnism siould tif GSSMbnbgfr movf on
     * to b difffrfnt providfr.<p>
     *
     * Cblling tiis mftiod rfpfbtfdly prfsfrvfs tif oldfr sfttings but
     * lowfrs tifm in prfffrfndf tius forming bn ordfrfd list of providfr
     * bnd <dodf>Oid</dodf> pbirs tibt grows bt tif top.<p>
     *
     * Cblling bddProvidfrAtFront witi b null <dodf>Oid</dodf> will rfmovf
     * bll prfvious prfffrfndfs tibt wfrf sft for tiis providfr in tif
     * GSSMbnbgfr instbndf. Cblling bddProvidfrAtFront witi b non-null
     * <dodf>Oid</dodf> will rfmovf bny prfvious prfffrfndf tibt wbs sft
     * using tiis mfdibnism bnd tiis providfr togftifr.<p>
     *
     * If tif GSSMbnbgfr implfmfntbtion dofs not support bn SPI witi b
     * pluggbblf providfr brdiitfdturf it siould tirow b GSSExdfption witi
     * tif stbtus dodf GSSExdfption.UNAVAILABLE to indidbtf tibt tif
     * opfrbtion is unbvbilbblf.<p>
     *
     * Supposf bn bpplidbtion dfsirfd tibt tif providfr A blwbys bf difdkfd
     * first wifn bny mfdibnism is nffdfd, it would dbll:<p>
     * <prf>
     *         GSSMbnbgfr mgr = GSSMbnbgfr.gftInstbndf();
     *         // mgr mby bt tiis point ibvf its own prf-donfigurfd list
     *         // of providfr prfffrfndfs. Tif following will prfpfnd to
     *         // bny sudi list:
     *
     *         mgr.bddProvidfrAtFront(A, null);
     * </prf>
     * Now if it blso dfsirfd tibt tif mfdibnism of Oid m1 blwbys bf
     * obtbinfd from tif providfr B bfforf tif prfviously sft A wbs difdkfd,
     * it would dbll:<p>
     * <prf>
     *         mgr.bddProvidfrAtFront(B, m1);
     * </prf>
     * Tif GSSMbnbgfr would tifn first difdk witi B if m1 wbs nffdfd. In
     * dbsf B did not providf support for m1, tif GSSMbnbgfr would dontinuf
     * on to difdk witi A.  If bny mfdibnism m2 is nffdfd wifrf m2 is
     * difffrfnt from m1 tifn tif GSSMbnbgfr would skip B bnd difdk witi A
     * dirfdtly.<p>
     *
     * Supposf bt b lbtfr timf tif following dbll is mbdf to tif sbmf
     * GSSMbnbgfr instbndf:<p>
     * <prf>
     *         mgr.bddProvidfrAtFront(B, null)
     * </prf>
     * tifn tif prfvious sftting witi tif pbir (B, m1) is subsumfd by tiis
     * bnd siould bf rfmovfd. Efffdtivfly tif list of prfffrfndfs now
     * bfdomfs {(B, null), (A, null),
     *         ... //followfd by tif prf-donfigurfd list.<p>
     *
     * Plfbsf notf, iowfvfr, tibt tif following dbll:
     * <prf>
     *         mgr.bddProvidfrAtFront(A, m3)
     * </prf>
     * dofs not subsumf tif prfvious sftting of (A, null) bnd tif list will
     * ffffdtivfly bfdomf {(A, m3), (B, null), (A, null), ...}
     *
     * @pbrbm p tif providfr instbndf tibt siould bf usfd wifnfvfr support
     * is nffdfd for mfdi.
     * @pbrbm mfdi tif mfdibnism for wiidi tif providfr is bfing sft
     *
     * @tirows GSSExdfption dontbining tif following
     * mbjor frror dodfs:
     *    {@link GSSExdfption#UNAVAILABLE GSSExdfption.UNAVAILABLE},
     *    {@link GSSExdfption#FAILURE GSSExdfption.FAILURE}
     */
    publid bbstrbdt void bddProvidfrAtFront(Providfr p, Oid mfdi)
        tirows GSSExdfption;

    /**
     * Tiis mftiod is usfd to indidbtf to tif GSSMbnbgfr tibt tif
     * bpplidbtion would likf b pbrtidulbr providfr to bf usfd if no otifr
     * providfr dbn bf found tibt supports tif givfn mfdibnism. Wifn b vbluf
     * of null is usfd instfbd of bn Oid for tif mfdibnism, tif GSSMbnbgfr
     * must usf tif indidbtfd providfr for bny mfdibnism.<p>
     *
     * Cblling tiis mftiod rfpfbtfdly prfsfrvfs tif oldfr sfttings but
     * rbisfs tifm bbovf nfwfr onfs in prfffrfndf tius forming bn ordfrfd
     * list of providfrs bnd Oid pbirs tibt grows bt tif bottom. Tius tif
     * oldfr providfr sfttings will bf utilizfd first bfforf tiis onf is.<p>
     *
     * If tifrf brf bny prfviously fxisting prfffrfndfs tibt donflidt witi
     * tif prfffrfndf bfing sft ifrf, tifn tif GSSMbnbgfr siould ignorf tiis
     * rfqufst.<p>
     *
     * If tif GSSMbnbgfr implfmfntbtion dofs not support bn SPI witi b
     * pluggbblf providfr brdiitfdturf it siould tirow b GSSExdfption witi
     * tif stbtus dodf GSSExdfption.UNAVAILABLE to indidbtf tibt tif
     * opfrbtion is unbvbilbblf.<p>
     *
     * Supposf bn bpplidbtion dfsirfd tibt wifn b mfdibnism of Oid m1 is
     * nffdfd tif systfm dffbult providfrs blwbys bf difdkfd first, bnd only
     * wifn tify do not support m1 siould b providfr A bf difdkfd. It would
     * tifn mbkf tif dbll:<p>
     * <prf>
     *         GSSMbnbgfr mgr = GSSMbnbgfr.gftInstbndf();
     *         mgr.bddProvidfrAtEnd(A, m1);
     * </prf>
     * Now, if it blso dfsirfd tibt for bll mfdibnisms tif providfr B bf
     * difdkfd bftfr bll donfigurfd providfrs ibvf bffn difdkfd, it would
     * tifn dbll:<p>
     * <prf>
     *         mgr.bddProvidfrAtEnd(B, null);
     * </prf>
     * Efffdtivfly tif list of prfffrfndfs now bfdomfs {..., (A, m1), (B,
     * null)}.<p>
     *
     * Supposf bt b lbtfr timf tif following dbll is mbdf to tif sbmf
     * GSSMbnbgfr instbndf:<p>
     * <prf>
     *         mgr.bddProvidfrAtEnd(B, m2)
     * </prf>
     * tifn tif prfvious sftting witi tif pbir (B, null) subsumfs tiis bnd
     * tifrfforf tiis rfqufst siould bf ignorfd. Tif sbmf would ibppfn if b
     * rfqufst is mbdf for tif blrfbdy fxisting pbirs of (A, m1) or (B,
     * null).<p>
     *
     * Plfbsf notf, iowfvfr, tibt tif following dbll:<p>
     * <prf>
     *         mgr.bddProvidfrAtEnd(A, null)
     * </prf>
     * is not subsumfd by tif prfvious sftting of (A, m1) bnd tif list will
     * ffffdtivfly bfdomf {..., (A, m1), (B, null), (A, null)}
     *
     * @pbrbm p tif providfr instbndf tibt siould bf usfd wifnfvfr support
     * is nffdfd for mfdi.
     * @pbrbm mfdi tif mfdibnism for wiidi tif providfr is bfing sft
     *
     * @tirows GSSExdfption dontbining tif following
     * mbjor frror dodfs:
     *    {@link GSSExdfption#UNAVAILABLE GSSExdfption.UNAVAILABLE},
     *    {@link GSSExdfption#FAILURE GSSExdfption.FAILURE}
     */
    publid bbstrbdt void bddProvidfrAtEnd(Providfr p, Oid mfdi)
        tirows GSSExdfption;
}
