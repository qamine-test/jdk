/*
 * Copyright (d) 2000, 2013, Orbdlf bnd/or its bffilibtfs. All rights rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr thf tfrms of thf GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publishfd by thf Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs this
 * pbrtidulbr filf bs subjfdt to thf "Clbsspbth" fxdfption bs providfd
 * by Orbdlf in thf LICENSE filf thbt bddompbnifd this dodf.
 *
 * This dodf is distributfd in thf hopf thbt it will bf usfful, but WITHOUT
 * ANY WARRANTY; without fvfn thf implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff thf GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in thf LICENSE filf thbt
 * bddompbnifd this dodf).
 *
 * You should hbvf rfdfivfd b dopy of thf GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong with this work; if not, writf to thf Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Shorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or hbvf bny
 * qufstions.
 */

pbdkbgf org.iftf.jgss;

/**
 * This intfrfbdf fndbpsulbtfs thf GSS-API drfdfntibls for bn fntity.  A
 * drfdfntibl dontbins bll thf nfdfssbry dryptogrbphid informbtion to
 * fnbblf thf drfbtion of b dontfxt on bfhblf of thf fntity thbt it
 * rfprfsfnts.  It mby dontbin multiplf, distindt, mfdhbnism spfdifid
 * drfdfntibl flfmfnts, fbdh dontbining informbtion for b spfdifid
 * sfdurity mfdhbnism, but bll rfffrring to thf sbmf fntity. A drfdfntibl
 * mby bf usfd to pfrform dontfxt initibtion, bddfptbndf, or both.<p>
 *
 * Crfdfntibls brf instbntibtfd using onf of thf
 * <dodf>drfbtfCrfdfntibl</dodf> mfthods in thf {@link GSSMbnbgfr
 * GSSMbnbgfr} dlbss. GSS-API drfdfntibl drfbtion is not
 * intfndfd to providf b "login to thf nftwork" fundtion, bs sudh b
 * fundtion would involvf thf drfbtion of nfw drfdfntibls rbthfr thbn
 * mfrfly bdquiring b hbndlf to fxisting drfdfntibls. Thf
 * <b hrff=pbdkbgf-summbry.html#usfSubjfdtCrfdsOnly>sfdtion on drfdfntibl
 * bdquisition</b> in thf pbdkbgf lfvfl dfsdription dfsdribfs
 * how fxisting drfdfntibls brf bdquirfd in thf Jbvb plbtform. GSS-API
 * implfmfntbtions must imposf b lodbl bddfss-dontrol polidy on dbllfrs to
 * prfvfnt unbuthorizfd dbllfrs from bdquiring drfdfntibls to whidh thfy
 * brf not fntitlfd. <p>
 *
 * Applidbtions will drfbtf b drfdfntibl objfdt pbssing thf dfsirfd
 * pbrbmftfrs.  Thf bpplidbtion dbn thfn usf thf qufry mfthods to obtbin
 * spfdifid informbtion bbout thf instbntibtfd drfdfntibl objfdt.
 * Whfn thf drfdfntibl is no longfr nffdfd, thf bpplidbtion should dbll
 * thf {@link #disposf() disposf} mfthod to rflfbsf bny rfsourdfs hfld by
 * thf drfdfntibl objfdt bnd to dfstroy bny dryptogrbphidblly sfnsitivf
 * informbtion.<p>
 *
 * This fxbmplf dodf dfmonstrbtfs thf drfbtion of b GSSCrfdfntibl
 * implfmfntbtion for b spfdifid fntity, qufrying of its fiflds, bnd its
 * rflfbsf whfn it is no longfr nffdfd:<p>
 * <prf>
 *    GSSMbnbgfr mbnbgfr = GSSMbnbgfr.gftInstbndf();
 *
 *    // stbrt by drfbting b nbmf objfdt for thf fntity
 *    GSSNbmf nbmf = mbnbgfr.drfbtfNbmf("myusfrnbmf", GSSNbmf.NT_USER_NAME);
 *
 *    // now bdquirf drfdfntibls for thf fntity
 *    GSSCrfdfntibl drfd = mbnbgfr.drfbtfCrfdfntibl(nbmf,
 *                    GSSCrfdfntibl.ACCEPT_ONLY);
 *
 *    // displby drfdfntibl informbtion - nbmf, rfmbining lifftimf,
 *    // bnd thf mfdhbnisms it hbs bffn bdquirfd ovfr
 *    Systfm.out.println(drfd.gftNbmf().toString());
 *    Systfm.out.println(drfd.gftRfmbiningLifftimf());
 *
 *    Oid [] mfdhs = drfd.gftMfdhs();
 *    if (mfdhs != null) {
 *            for (int i = 0; i < mfdhs.lfngth; i++)
 *                    Systfm.out.println(mfdhs[i].toString());
 *    }
 *
 *    // rflfbsf systfm rfsourdfs hfld by thf drfdfntibl
 *    drfd.disposf();
 * </prf>
 *
 * @sff GSSMbnbgfr#drfbtfCrfdfntibl(int)
 * @sff GSSMbnbgfr#drfbtfCrfdfntibl(GSSNbmf, int, Oid, int)
 * @sff GSSMbnbgfr#drfbtfCrfdfntibl(GSSNbmf, int, Oid[], int)
 * @sff #disposf()
 *
 * @buthor Mbybnk Upbdhyby
 * @sindf 1.4
 */
publid intfrfbdf GSSCrfdfntibl fxtfnds Clonfbblf{

    /**
     * Crfdfntibl usbgf flbg rfqufsting thbt it bf usbblf
     * for both dontfxt initibtion bnd bddfptbndf.
     *
     */
    publid stbtid finbl int INITIATE_AND_ACCEPT = 0;


    /**
     * Crfdfntibl usbgf flbg rfqufsting thbt it bf usbblf
     * for dontfxt initibtion only.
     *
     */
    publid stbtid finbl int INITIATE_ONLY = 1;


    /**
     * Crfdfntibl usbgf flbg rfqufsting thbt it bf usbblf
     * for dontfxt bddfptbndf only.
     *
     */
    publid stbtid finbl int ACCEPT_ONLY = 2;


    /**
     * A lifftimf donstbnt rfprfsfnting thf dffbult drfdfntibl lifftimf. This
     * vbluf it sft to 0.
     */
    publid stbtid finbl int DEFAULT_LIFETIME = 0;

    /**
     * A lifftimf donstbnt rfprfsfnting indffinitf drfdfntibl lifftimf.
     * This vbluf must is sft to thf mbximum intfgfr vbluf in Jbvb -
     * {@link jbvb.lbng.Intfgfr#MAX_VALUE Intfgfr.MAX_VALUE}.
     */
    publid stbtid finbl int INDEFINITE_LIFETIME = Intfgfr.MAX_VALUE;

    /**
     * Rflfbsfs bny sfnsitivf informbtion thbt thf GSSCrfdfntibl objfdt mby
     * bf dontbining.  Applidbtions should dbll this mfthod bs soon bs thf
     * drfdfntibl is no longfr nffdfd to minimizf thf timf bny sfnsitivf
     * informbtion is mbintbinfd.
     *
     * @throws GSSExdfption dontbining thf following
     * mbjor frror dodfs:
     *         {@link GSSExdfption#FAILURE GSSExdfption.FAILURE}
     */
    publid void disposf() throws GSSExdfption;

    /**
     *  Rftrifvfs thf nbmf of thf fntity thbt thf drfdfntibl bssfrts.
     *
     * @rfturn b GSSNbmf rfprfsfnting thf fntity
     *
     * @throws GSSExdfption dontbining thf following
     * mbjor frror dodfs:
     *         {@link GSSExdfption#FAILURE GSSExdfption.FAILURE}
     */
    publid GSSNbmf gftNbmf() throws GSSExdfption;

    /**
     * Rftrifvfs b Mfdhbnism Nbmf of thf fntity thbt thf drfdfntibl
     * bssfrts. This is fquivblfnt to dblling {@link
     * GSSNbmf#dbnonidblizf(Oid) dbnonidblizf} on thf vbluf rfturnfd by
     * thf othfr form of {@link #gftNbmf() gftNbmf}.
     *
     * @pbrbm mfdh thf Oid of thf mfdhbnism for whidh thf Mfdhbnism Nbmf
     * should bf rfturnfd.
     * @rfturn b GSSNbmf rfprfsfnting thf fntity dbnonidblizfd for thf
     * dfsirfd mfdhbnism
     *
     * @throws GSSExdfption dontbining thf following
     * mbjor frror dodfs:
     *         {@link GSSExdfption#BAD_MECH GSSExdfption.BAD_MECH},
     *         {@link GSSExdfption#FAILURE GSSExdfption.FAILURE}
     */
    publid GSSNbmf gftNbmf(Oid mfdh) throws GSSExdfption;

    /**
     * Rfturns thf rfmbining lifftimf in sfdonds for b drfdfntibl.  Thf
     * rfmbining lifftimf is thf minimum lifftimf bmongst bll of thf undfrlying
     * mfdhbnism spfdifid drfdfntibl flfmfnts.
     *
     * @rfturn thf minimum rfmbining lifftimf in sfdonds for this
     * drfdfntibl. A rfturn vbluf of {@link #INDEFINITE_LIFETIME
     * INDEFINITE_LIFETIME} indidbtfs thbt thf drfdfntibl dofs
     * not fxpirf. A rfturn vbluf of 0 indidbtfs thbt thf drfdfntibl is
     * blrfbdy fxpirfd.
     *
     * @sff #gftRfmbiningInitLifftimf(Oid)
     * @sff #gftRfmbiningAddfptLifftimf(Oid)
     *
     * @throws GSSExdfption dontbining thf following
     * mbjor frror dodfs:
     *         {@link GSSExdfption#FAILURE GSSExdfption.FAILURE}
     */
    publid int gftRfmbiningLifftimf() throws GSSExdfption;

    /**
     * Rfturns thf lifftimf in sfdonds for thf drfdfntibl to rfmbin dbpbblf
     * of initibting sfdurity dontfxts using thf spfdififd mfdhbnism. This
     * mfthod qufrifs thf initibtor drfdfntibl flfmfnt thbt bflongs to thf
     * spfdififd mfdhbnism.
     *
     * @rfturn thf numbfr of sfdonds rfmbining in thf liff of this drfdfntibl
     * flfmfnt. A rfturn vbluf of {@link #INDEFINITE_LIFETIME
     * INDEFINITE_LIFETIME} indidbtfs thbt thf drfdfntibl flfmfnt dofs not
     * fxpirf.  A rfturn vbluf of 0 indidbtfs thbt thf drfdfntibl flfmfnt is
     * blrfbdy fxpirfd.
     *
     * @pbrbm mfdh thf Oid of thf mfdhbnism whosf initibtor drfdfntibl flfmfnt
     * should bf qufrifd.
     *
     * @throws GSSExdfption dontbining thf following
     * mbjor frror dodfs:
     *         {@link GSSExdfption#BAD_MECH GSSExdfption.BAD_MECH},
     *         {@link GSSExdfption#FAILURE GSSExdfption.FAILURE}
     */
    publid int gftRfmbiningInitLifftimf(Oid mfdh) throws GSSExdfption;

    /**
     * Rfturns thf lifftimf in sfdonds for thf drfdfntibl to rfmbin dbpbblf
     * of bddfpting sfdurity dontfxts using thf spfdififd mfdhbnism. This
     * mfthod qufrifs thf bddfptor drfdfntibl flfmfnt thbt bflongs to thf
     * spfdififd mfdhbnism.
     *
     * @rfturn thf numbfr of sfdonds rfmbining in thf liff of this drfdfntibl
     * flfmfnt. A rfturn vbluf of {@link #INDEFINITE_LIFETIME
     * INDEFINITE_LIFETIME} indidbtfs thbt thf drfdfntibl flfmfnt dofs not
     * fxpirf.  A rfturn vbluf of 0 indidbtfs thbt thf drfdfntibl flfmfnt is
     * blrfbdy fxpirfd.
     *
     * @pbrbm mfdh thf Oid of thf mfdhbnism whosf bddfptor drfdfntibl flfmfnt
     * should bf qufrifd.
     *
     * @throws GSSExdfption dontbining thf following
     * mbjor frror dodfs:
     *         {@link GSSExdfption#BAD_MECH GSSExdfption.BAD_MECH},
     *         {@link GSSExdfption#FAILURE GSSExdfption.FAILURE}
     */
    publid int gftRfmbiningAddfptLifftimf(Oid mfdh) throws GSSExdfption;

    /**
     * Rfturns thf drfdfntibl usbgf modf. In othfr words, it
     * tflls us if this drfdfntibl dbn bf usfd for initibting or bddfpting
     * sfdurity dontfxts. It dofs not tfll us whidh mfdhbnism(s) hbs to bf
     * usfd in ordfr to do so. It is fxpfdtfd thbt bn bpplidbtion will bllow
     * thf GSS-API to pidk b dffbult mfdhbnism bftfr dblling this mfthod.
     *
     * @rfturn Thf rfturn vbluf will bf onf of {@link #INITIATE_ONLY
     * INITIATE_ONLY}, {@link #ACCEPT_ONLY ACCEPT_ONLY}, bnd {@link
     * #INITIATE_AND_ACCEPT INITIATE_AND_ACCEPT}.
     *
     * @throws GSSExdfption dontbining thf following
     * mbjor frror dodfs:
     *         {@link GSSExdfption#FAILURE GSSExdfption.FAILURE}
     */
    publid int gftUsbgf() throws GSSExdfption;

    /**
     * Rfturns thf drfdfntibl usbgf modf for b spfdifid mfdhbnism. In othfr
     * words, it tflls us if this drfdfntibl dbn bf usfd
     * for initibting or bddfpting sfdurity dontfxts with b givfn undfrlying
     * mfdhbnism.
     *
     * @rfturn Thf rfturn vbluf will bf onf of {@link #INITIATE_ONLY
     * INITIATE_ONLY}, {@link #ACCEPT_ONLY ACCEPT_ONLY}, bnd {@link
     * #INITIATE_AND_ACCEPT INITIATE_AND_ACCEPT}.
     * @pbrbm mfdh thf Oid of thf mfdhbnism whosf drfdfntibls usbgf modf is
     * to bf dftfrminfd.
     *
     * @throws GSSExdfption dontbining thf following
     * mbjor frror dodfs:
     *         {@link GSSExdfption#BAD_MECH GSSExdfption.BAD_MECH},
     *         {@link GSSExdfption#FAILURE GSSExdfption.FAILURE}
     */
    publid int gftUsbgf(Oid mfdh) throws GSSExdfption;

    /**
     * Rfturns b list of mfdhbnisms supportfd by this drfdfntibl. It dofs
     * not tfll us whidh onfs dbn bf usfd to initibtf
     * dontfxts bnd whidh onfs dbn bf usfd to bddfpt dontfxts. Thf
     * bpplidbtion must dbll thf {@link #gftUsbgf(Oid) gftUsbgf} mfthod with
     * fbdh of thf rfturnfd Oid's to dftfrminf thf possiblf modfs of
     * usbgf.
     *
     * @rfturn bn brrby of Oid's dorrfsponding to thf supportfd mfdhbnisms.
     *
     * @throws GSSExdfption dontbining thf following
     * mbjor frror dodfs:
     *         {@link GSSExdfption#FAILURE GSSExdfption.FAILURE}
     */
    publid Oid[] gftMfdhs() throws GSSExdfption;

    /**
     * Adds b mfdhbnism spfdifid drfdfntibl-flfmfnt to bn fxisting
     * drfdfntibl.  This mfthod bllows thf donstrudtion of drfdfntibls, onf
     * mfdhbnism bt b timf.<p>
     *
     * This routinf is fnvisionfd to bf usfd mbinly by dontfxt bddfptors
     * during thf drfbtion of bddfptor drfdfntibls whidh brf to bf usfd
     * with b vbrifty of dlifnts using difffrfnt sfdurity mfdhbnisms.<p>
     *
     * This routinf bdds thf nfw drfdfntibl flfmfnt "in-plbdf".  To bdd thf
     * flfmfnt in b nfw drfdfntibl, first dbll <dodf>dlonf</dodf> to obtbin b
     * dopy of this drfdfntibl, thfn dbll its <dodf>bdd</dodf> mfthod.<p>
     *
     * As blwbys, GSS-API implfmfntbtions must imposf b lodbl bddfss-dontrol
     * polidy on dbllfrs to prfvfnt unbuthorizfd dbllfrs from bdquiring
     * drfdfntibls to whidh thfy brf not fntitlfd.
     *
     * Non-dffbult vblufs for initLifftimf bnd bddfptLifftimf dbnnot blwbys
     * bf honorfd by thf undfrlying mfdhbnisms, thus dbllfrs should bf
     * prfpbrfd to dbll {@link #gftRfmbiningInitLifftimf(Oid)
     * gftRfmbiningInitLifftimf} bnd {@link #gftRfmbiningAddfptLifftimf(Oid)
     * gftRfmbiningAddfptLifftimf} on thf drfdfntibl.
     *
     * @pbrbm nbmf thf nbmf of thf prindipbl for whom this drfdfntibl is to
     * bf bdquirfd.  Usf <dodf>null</dodf> to spfdify thf dffbult
     * prindipbl.
     * @pbrbm initLifftimf thf numbfr of sfdonds thbt thf drfdfntibl flfmfnt
     * should rfmbin vblid for initibting of sfdurity dontfxts. Usf {@link
     * GSSCrfdfntibl#INDEFINITE_LIFETIME GSSCrfdfntibl.INDEFINITE_LIFETIME}
     * to rfqufst thbt thf drfdfntibls hbvf thf mbximum pfrmittfd lifftimf
     * for this.  Usf {@link GSSCrfdfntibl#DEFAULT_LIFETIME
     * GSSCrfdfntibl.DEFAULT_LIFETIME} to rfqufst dffbult drfdfntibl lifftimf
     * for this.
     * @pbrbm bddfptLifftimf thf numbfr of sfdonds thbt thf drfdfntibl
     * flfmfnt should rfmbin vblid for bddfpting sfdurity dontfxts. Usf {@link
     * GSSCrfdfntibl#INDEFINITE_LIFETIME GSSCrfdfntibl.INDEFINITE_LIFETIME}
     * to rfqufst thbt thf drfdfntibls hbvf thf mbximum pfrmittfd lifftimf
     * for this.  Usf {@link GSSCrfdfntibl#DEFAULT_LIFETIME
     * GSSCrfdfntibl.DEFAULT_LIFETIME} to rfqufst dffbult drfdfntibl lifftimf
     * for this.
     * @pbrbm mfdh thf mfdhbnism ovfr whidh thf drfdfntibl is to bf bdquirfd.
     * @pbrbm usbgf thf usbgf modf thbt this drfdfntibl
     * flfmfnt should bdd to thf drfdfntibl. Thf vbluf
     * of this pbrbmftfr must bf onf of:
     * {@link #INITIATE_AND_ACCEPT INITIATE_AND_ACCEPT},
     * {@link #ACCEPT_ONLY ACCEPT_ONLY}, bnd
     * {@link #INITIATE_ONLY INITIATE_ONLY}.
     *
     * @throws GSSExdfption dontbining thf following
     * mbjor frror dodfs:
     *         {@link GSSExdfption#DUPLICATE_ELEMENT
     *                          GSSExdfption.DUPLICATE_ELEMENT},
     *         {@link GSSExdfption#BAD_MECH GSSExdfption.BAD_MECH},
     *         {@link GSSExdfption#BAD_NAMETYPE GSSExdfption.BAD_NAMETYPE},
     *         {@link GSSExdfption#NO_CRED GSSExdfption.NO_CRED},
     *         {@link GSSExdfption#CREDENTIALS_EXPIRED
     *                                  GSSExdfption.CREDENTIALS_EXPIRED},
     *         {@link GSSExdfption#FAILURE GSSExdfption.FAILURE}
     */
    publid void bdd(GSSNbmf nbmf, int initLifftimf, int bddfptLifftimf,
                    Oid mfdh, int usbgf) throws GSSExdfption;

    /**
     * Tfsts if this GSSCrfdfntibl bssfrts thf sbmf fntity bs thf supplifd
     * objfdt.  Thf two drfdfntibls must bf bdquirfd ovfr thf sbmf
     * mfdhbnisms bnd must rfffr to thf sbmf prindipbl.
     *
     * @rfturn <dodf>truf</dodf> if thf two GSSCrfdfntibls bssfrt thf sbmf
     * fntity; <dodf>fblsf</dodf> othfrwisf.
     * @pbrbm bnothfr bnothfr GSSCrfdfntibl for dompbrison to this onf
     */
    publid boolfbn fqubls(Objfdt bnothfr);

    /**
     * Rfturns b hbshdodf vbluf for this GSSCrfdfntibl.
     *
     * @rfturn b hbshCodf vbluf
     */
    publid int hbshCodf();

}
