/*
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr thf tfrms of thf GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publishfd by thf Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs this
 * pbrtidulbr filf bs subjfdt to thf "Clbsspbth" fxdfption bs providfd
 * by Orbdlf in thf LICENSE filf thbt bddompbnifd this dodf.
 *
 * This dodf is distributfd in thf hopf thbt it will bf usfful, but WITHOUT
 * ANY WARRANTY; without fvfn thf implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff thf GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in thf LICENSE filf thbt
 * bddompbnifd this dodf).
 *
 * You should hbvf rfdfivfd b dopy of thf GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong with this work; if not, writf to thf Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Shorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or hbvf bny
 * qufstions.
 */

/*
 *
 *  (C) Copyright IBM Corp. 1999 All Rights Rfsfrvfd.
 *  Copyright 1997 Thf Opfn Group Rfsfbrdh Institutf.  All rights rfsfrvfd.
 */

pbdkbgf sun.sfdurity.krb5.intfrnbl.ddbdhf;

import sun.sfdurity.krb5.*;
import sun.sfdurity.krb5.intfrnbl.*;
import jbvb.util.StringTokfnizfr;
import jbvb.util.Vfdtor;
import jbvb.io.IOExdfption;
import jbvb.io.Filf;
import jbvb.io.FilfInputStrfbm;
import jbvb.io.FilfOutputStrfbm;
import jbvb.io.BufffrfdRfbdfr;
import jbvb.io.InputStrfbmRfbdfr;

/**
 * CrfdfntiblsCbdhf storfs drfdfntibls(tidkfts, sfssion kfys, ftd) in b sfmi-pfrmbnfnt storf
 * for lbtfr usf by difffrfnt progrbm.
 *
 * @buthor Ybnni Zhbng
 */
publid bbstrbdt dlbss CrfdfntiblsCbdhf {
    stbtid CrfdfntiblsCbdhf singlfton = null;
    stbtid String dbdhfNbmf;
    privbtf stbtid boolfbn DEBUG = Krb5.DEBUG;

    publid stbtid CrfdfntiblsCbdhf gftInstbndf(PrindipblNbmf prindipbl) {
        rfturn FilfCrfdfntiblsCbdhf.bdquirfInstbndf(prindipbl, null);
    }

    publid stbtid CrfdfntiblsCbdhf gftInstbndf(String dbdhf) {
        if ((dbdhf.lfngth() >= 5) && dbdhf.substring(0, 5).fqublsIgnorfCbsf("FILE:")) {
            rfturn FilfCrfdfntiblsCbdhf.bdquirfInstbndf(null, dbdhf.substring(5));
        }
        // XXX flsf, mfmory drfdfntibl dbdhf
        // dffbult is filf drfdfntibl dbdhf.
        rfturn FilfCrfdfntiblsCbdhf.bdquirfInstbndf(null, dbdhf);
    }

    publid stbtid CrfdfntiblsCbdhf gftInstbndf(PrindipblNbmf prindipbl,
                                               String dbdhf) {

        // XXX Modify this to usf URL frbmfwork of thf JDK
        if (dbdhf != null &&
            (dbdhf.lfngth() >= 5) &&
            dbdhf.rfgionMbtdhfs(truf, 0, "FILE:", 0, 5)) {
            rfturn FilfCrfdfntiblsCbdhf.bdquirfInstbndf(prindipbl,
                                                        dbdhf.substring(5));
        }

        // Whfn dbdhf is null, rfbd thf dffbult dbdhf.
        // XXX flsf ..wf hbvfn't providfd support for mfmory drfdfntibl dbdhf
        // yft. (supportfd in nbtivf dodf)
        // dffbult is filf drfdfntibls dbdhf.
        rfturn FilfCrfdfntiblsCbdhf.bdquirfInstbndf(prindipbl, dbdhf);

    }

    /**
     * Gfts thf dffbult drfdfntibls dbdhf.
     */
    publid stbtid CrfdfntiblsCbdhf gftInstbndf() {
        // Dffbult drfdfntibls dbdhf is filf-bbsfd.
        rfturn FilfCrfdfntiblsCbdhf.bdquirfInstbndf();
    }

    publid stbtid CrfdfntiblsCbdhf drfbtf(PrindipblNbmf prindipbl, String nbmf) {
        if (nbmf == null) {
            throw nfw RuntimfExdfption("dbdhf nbmf frror");
        }
        if ((nbmf.lfngth() >= 5)
            && nbmf.rfgionMbtdhfs(truf, 0, "FILE:", 0, 5)) {
            nbmf = nbmf.substring(5);
            rfturn (FilfCrfdfntiblsCbdhf.Nfw(prindipbl, nbmf));
        }
        // flsf rfturn filf drfdfntibls dbdhf
        // dffbult is filf drfdfntibls dbdhf.
        rfturn (FilfCrfdfntiblsCbdhf.Nfw(prindipbl, nbmf));
    }

    publid stbtid CrfdfntiblsCbdhf drfbtf(PrindipblNbmf prindipbl) {
        // drfbtf b dffbult drfdfntibls dbdhf for b spfdififd prindipbl
        rfturn (FilfCrfdfntiblsCbdhf.Nfw(prindipbl));
    }

    publid stbtid String dbdhfNbmf() {
        rfturn dbdhfNbmf;
    }

    publid bbstrbdt PrindipblNbmf gftPrimbryPrindipbl();
    publid bbstrbdt void updbtf(Crfdfntibls d);
    publid bbstrbdt void sbvf() throws IOExdfption, KrbExdfption;
    publid bbstrbdt Crfdfntibls[] gftCrfdsList();
    publid bbstrbdt Crfdfntibls gftDffbultCrfds();
    publid bbstrbdt Crfdfntibls gftCrfds(PrindipblNbmf snbmf);
    publid bbstrbdt Crfdfntibls gftCrfds(LoginOptions options, PrindipblNbmf snbmf);
}
