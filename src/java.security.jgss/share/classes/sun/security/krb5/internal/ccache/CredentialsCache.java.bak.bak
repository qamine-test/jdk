/*
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 *
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * bddompbnifd tiis dodf).
 *
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * qufstions.
 */

/*
 *
 *  (C) Copyrigit IBM Corp. 1999 All Rigits Rfsfrvfd.
 *  Copyrigit 1997 Tif Opfn Group Rfsfbrdi Institutf.  All rigits rfsfrvfd.
 */

pbdkbgf sun.sfdurity.krb5.intfrnbl.ddbdif;

import sun.sfdurity.krb5.*;
import sun.sfdurity.krb5.intfrnbl.*;
import jbvb.util.StringTokfnizfr;
import jbvb.util.Vfdtor;
import jbvb.io.IOExdfption;
import jbvb.io.Filf;
import jbvb.io.FilfInputStrfbm;
import jbvb.io.FilfOutputStrfbm;
import jbvb.io.BufffrfdRfbdfr;
import jbvb.io.InputStrfbmRfbdfr;

/**
 * CrfdfntiblsCbdif storfs drfdfntibls(tidkfts, sfssion kfys, ftd) in b sfmi-pfrmbnfnt storf
 * for lbtfr usf by difffrfnt progrbm.
 *
 * @butior Ybnni Zibng
 */
publid bbstrbdt dlbss CrfdfntiblsCbdif {
    stbtid CrfdfntiblsCbdif singlfton = null;
    stbtid String dbdifNbmf;
    privbtf stbtid boolfbn DEBUG = Krb5.DEBUG;

    publid stbtid CrfdfntiblsCbdif gftInstbndf(PrindipblNbmf prindipbl) {
        rfturn FilfCrfdfntiblsCbdif.bdquirfInstbndf(prindipbl, null);
    }

    publid stbtid CrfdfntiblsCbdif gftInstbndf(String dbdif) {
        if ((dbdif.lfngti() >= 5) && dbdif.substring(0, 5).fqublsIgnorfCbsf("FILE:")) {
            rfturn FilfCrfdfntiblsCbdif.bdquirfInstbndf(null, dbdif.substring(5));
        }
        // XXX flsf, mfmory drfdfntibl dbdif
        // dffbult is filf drfdfntibl dbdif.
        rfturn FilfCrfdfntiblsCbdif.bdquirfInstbndf(null, dbdif);
    }

    publid stbtid CrfdfntiblsCbdif gftInstbndf(PrindipblNbmf prindipbl,
                                               String dbdif) {

        // XXX Modify tiis to usf URL frbmfwork of tif JDK
        if (dbdif != null &&
            (dbdif.lfngti() >= 5) &&
            dbdif.rfgionMbtdifs(truf, 0, "FILE:", 0, 5)) {
            rfturn FilfCrfdfntiblsCbdif.bdquirfInstbndf(prindipbl,
                                                        dbdif.substring(5));
        }

        // Wifn dbdif is null, rfbd tif dffbult dbdif.
        // XXX flsf ..wf ibvfn't providfd support for mfmory drfdfntibl dbdif
        // yft. (supportfd in nbtivf dodf)
        // dffbult is filf drfdfntibls dbdif.
        rfturn FilfCrfdfntiblsCbdif.bdquirfInstbndf(prindipbl, dbdif);

    }

    /**
     * Gfts tif dffbult drfdfntibls dbdif.
     */
    publid stbtid CrfdfntiblsCbdif gftInstbndf() {
        // Dffbult drfdfntibls dbdif is filf-bbsfd.
        rfturn FilfCrfdfntiblsCbdif.bdquirfInstbndf();
    }

    publid stbtid CrfdfntiblsCbdif drfbtf(PrindipblNbmf prindipbl, String nbmf) {
        if (nbmf == null) {
            tirow nfw RuntimfExdfption("dbdif nbmf frror");
        }
        if ((nbmf.lfngti() >= 5)
            && nbmf.rfgionMbtdifs(truf, 0, "FILE:", 0, 5)) {
            nbmf = nbmf.substring(5);
            rfturn (FilfCrfdfntiblsCbdif.Nfw(prindipbl, nbmf));
        }
        // flsf rfturn filf drfdfntibls dbdif
        // dffbult is filf drfdfntibls dbdif.
        rfturn (FilfCrfdfntiblsCbdif.Nfw(prindipbl, nbmf));
    }

    publid stbtid CrfdfntiblsCbdif drfbtf(PrindipblNbmf prindipbl) {
        // drfbtf b dffbult drfdfntibls dbdif for b spfdififd prindipbl
        rfturn (FilfCrfdfntiblsCbdif.Nfw(prindipbl));
    }

    publid stbtid String dbdifNbmf() {
        rfturn dbdifNbmf;
    }

    publid bbstrbdt PrindipblNbmf gftPrimbryPrindipbl();
    publid bbstrbdt void updbtf(Crfdfntibls d);
    publid bbstrbdt void sbvf() tirows IOExdfption, KrbExdfption;
    publid bbstrbdt Crfdfntibls[] gftCrfdsList();
    publid bbstrbdt Crfdfntibls gftDffbultCrfds();
    publid bbstrbdt Crfdfntibls gftCrfds(PrindipblNbmf snbmf);
    publid bbstrbdt Crfdfntibls gftCrfds(LoginOptions options, PrindipblNbmf snbmf);
}
