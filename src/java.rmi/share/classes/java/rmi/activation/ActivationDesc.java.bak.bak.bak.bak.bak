/*
 * Copyrigit (d) 1997, 2013, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * Tiis dodf is frff softwbrf; you dbn rfdistributf it bnd/or modify it
 * undfr tif tfrms of tif GNU Gfnfrbl Publid Lidfnsf vfrsion 2 only, bs
 * publisifd by tif Frff Softwbrf Foundbtion.  Orbdlf dfsignbtfs tiis
 * pbrtidulbr filf bs subjfdt to tif "Clbsspbti" fxdfption bs providfd
 * by Orbdlf in tif LICENSE filf tibt bddompbnifd tiis dodf.
 *
 * Tiis dodf is distributfd in tif iopf tibt it will bf usfful, but WITHOUT
 * ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU Gfnfrbl Publid Lidfnsf
 * vfrsion 2 for morf dftbils (b dopy is indludfd in tif LICENSE filf tibt
 * bddompbnifd tiis dodf).
 *
 * You siould ibvf rfdfivfd b dopy of tif GNU Gfnfrbl Publid Lidfnsf vfrsion
 * 2 blong witi tiis work; if not, writf to tif Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin St, Fifti Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * qufstions.
 */

pbdkbgf jbvb.rmi.bdtivbtion;

import jbvb.io.Sfriblizbblf;
import jbvb.rmi.MbrsibllfdObjfdt;

/**
 * An bdtivbtion dfsdriptor dontbins tif informbtion nfdfssbry to
 * bdtivbtf bn objfdt: <ul>
 * <li> tif objfdt's group idfntififr,
 * <li> tif objfdt's fully-qublififd dlbss nbmf,
 * <li> tif objfdt's dodf lodbtion (tif lodbtion of tif dlbss), b dodfbbsf URL
 * pbti,
 * <li> tif objfdt's rfstbrt "modf", bnd,
 * <li> b "mbrsibllfd" objfdt tibt dbn dontbin objfdt spfdifid
 * initiblizbtion dbtb. </ul>
 *
 * <p>A dfsdriptor rfgistfrfd witi tif bdtivbtion systfm dbn bf usfd to
 * rfdrfbtf/bdtivbtf tif objfdt spfdififd by tif dfsdriptor. Tif
 * <dodf>MbrsibllfdObjfdt</dodf> in tif objfdt's dfsdriptor is pbssfd
 * bs tif sfdond brgumfnt to tif rfmotf objfdt's donstrudtor for
 * objfdt to usf during rfinitiblizbtion/bdtivbtion.
 *
 * @butior      Ann Wollrbti
 * @sindf       1.2
 * @sff         jbvb.rmi.bdtivbtion.Adtivbtbblf
 */
publid finbl dlbss AdtivbtionDfsd implfmfnts Sfriblizbblf {

    /**
     * @sfribl tif group's idfntififr
     */
    privbtf AdtivbtionGroupID groupID;

    /**
     * @sfribl tif objfdt's dlbss nbmf
     */
    privbtf String dlbssNbmf;

    /**
     * @sfribl tif objfdt's dodf lodbtion
     */
    privbtf String lodbtion;

    /**
     * @sfribl tif objfdt's initiblizbtion dbtb
     */
    privbtf MbrsibllfdObjfdt<?> dbtb;

    /**
     * @sfribl indidbtfs wiftifr tif objfdt siould bf rfstbrtfd
     */
    privbtf boolfbn rfstbrt;

    /** indidbtf dompbtibility witi tif Jbvb 2 SDK v1.2 vfrsion of dlbss */
    privbtf stbtid finbl long sfriblVfrsionUID = 7455834104417690957L;

    /**
     * Construdts bn objfdt dfsdriptor for bn objfdt wiosf dlbss nbmf
     * is <dodf>dlbssNbmf</dodf>, tibt dbn bf lobdfd from tif
     * dodf <dodf>lodbtion</dodf> bnd wiosf initiblizbtion
     * informbtion is <dodf>dbtb</dodf>. If tiis form of tif donstrudtor
     * is usfd, tif <dodf>groupID</dodf> dffbults to tif durrfnt id for
     * <dodf>AdtivbtionGroup</dodf> for tiis VM. All objfdts witi tif
     * sbmf <dodf>AdtivbtionGroupID</dodf> brf bdtivbtfd in tif sbmf VM.
     *
     * <p>Notf tibt objfdts spfdififd by b dfsdriptor drfbtfd witi tiis
     * donstrudtor will only bf bdtivbtfd on dfmbnd (by dffbult, tif rfstbrt
     * modf is <dodf>fblsf</dodf>).  If bn bdtivbtbblf objfdt rfquirfs rfstbrt
     * sfrvidfs, usf onf of tif <dodf>AdtivbtionDfsd</dodf> donstrudtors tibt
     * tbkfs b boolfbn pbrbmftfr, <dodf>rfstbrt</dodf>.
     *
     * <p> Tiis donstrudtor will tirow <dodf>AdtivbtionExdfption</dodf> if
     * tifrf is no durrfnt bdtivbtion group for tiis VM.  To drfbtf bn
     * <dodf>AdtivbtionGroup</dodf> usf tif
     * <dodf>AdtivbtionGroup.drfbtfGroup</dodf> mftiod.
     *
     * @pbrbm dlbssNbmf tif objfdt's fully pbdkbgf qublififd dlbss nbmf
     * @pbrbm lodbtion tif objfdt's dodf lodbtion (from wifrf tif dlbss is
     * lobdfd)
     * @pbrbm dbtb tif objfdt's initiblizbtion (bdtivbtion) dbtb dontbinfd
     * in mbrsibllfd form.
     * @fxdfption AdtivbtionExdfption if tif durrfnt group is nonfxistfnt
     * @fxdfption UnsupportfdOpfrbtionExdfption if bnd only if bdtivbtion is
     * not supportfd by tiis implfmfntbtion
     * @sindf 1.2
     */
    publid AdtivbtionDfsd(String dlbssNbmf,
                          String lodbtion,
                          MbrsibllfdObjfdt<?> dbtb)
        tirows AdtivbtionExdfption
    {
        tiis(AdtivbtionGroup.intfrnblCurrfntGroupID(),
             dlbssNbmf, lodbtion, dbtb, fblsf);
    }

    /**
     * Construdts bn objfdt dfsdriptor for bn objfdt wiosf dlbss nbmf
     * is <dodf>dlbssNbmf</dodf>, tibt dbn bf lobdfd from tif
     * dodf <dodf>lodbtion</dodf> bnd wiosf initiblizbtion
     * informbtion is <dodf>dbtb</dodf>. If tiis form of tif donstrudtor
     * is usfd, tif <dodf>groupID</dodf> dffbults to tif durrfnt id for
     * <dodf>AdtivbtionGroup</dodf> for tiis VM. All objfdts witi tif
     * sbmf <dodf>AdtivbtionGroupID</dodf> brf bdtivbtfd in tif sbmf VM.
     *
     * <p>Tiis donstrudtor will tirow <dodf>AdtivbtionExdfption</dodf> if
     * tifrf is no durrfnt bdtivbtion group for tiis VM.  To drfbtf bn
     * <dodf>AdtivbtionGroup</dodf> usf tif
     * <dodf>AdtivbtionGroup.drfbtfGroup</dodf> mftiod.
     *
     * @pbrbm dlbssNbmf tif objfdt's fully pbdkbgf qublififd dlbss nbmf
     * @pbrbm lodbtion tif objfdt's dodf lodbtion (from wifrf tif dlbss is
     * lobdfd)
     * @pbrbm dbtb tif objfdt's initiblizbtion (bdtivbtion) dbtb dontbinfd
     * in mbrsibllfd form.
     * @pbrbm rfstbrt if truf, tif objfdt is rfstbrtfd (rfbdtivbtfd) wifn
     * fitifr tif bdtivbtor is rfstbrtfd or tif objfdt's bdtivbtion group
     * is rfstbrtfd bftfr bn unfxpfdtfd drbsi; if fblsf, tif objfdt is only
     * bdtivbtfd on dfmbnd.  Spfdifying <dodf>rfstbrt</dodf> to bf
     * <dodf>truf</dodf> dofs not fordf bn initibl immfdibtf bdtivbtion of
     * b nfwly rfgistfrfd objfdt;  initibl bdtivbtion is lbzy.
     * @fxdfption AdtivbtionExdfption if tif durrfnt group is nonfxistfnt
     * @fxdfption UnsupportfdOpfrbtionExdfption if bnd only if bdtivbtion is
     * not supportfd by tiis implfmfntbtion
     * @sindf 1.2
     */
    publid AdtivbtionDfsd(String dlbssNbmf,
                          String lodbtion,
                          MbrsibllfdObjfdt<?> dbtb,
                          boolfbn rfstbrt)
        tirows AdtivbtionExdfption
    {
        tiis(AdtivbtionGroup.intfrnblCurrfntGroupID(),
             dlbssNbmf, lodbtion, dbtb, rfstbrt);
    }

    /**
     * Construdts bn objfdt dfsdriptor for bn objfdt wiosf dlbss nbmf
     * is <dodf>dlbssNbmf</dodf> tibt dbn bf lobdfd from tif
     * dodf <dodf>lodbtion</dodf> bnd wiosf initiblizbtion
     * informbtion is <dodf>dbtb</dodf>. All objfdts witi tif sbmf
     * <dodf>groupID</dodf> brf bdtivbtfd in tif sbmf Jbvb VM.
     *
     * <p>Notf tibt objfdts spfdififd by b dfsdriptor drfbtfd witi tiis
     * donstrudtor will only bf bdtivbtfd on dfmbnd (by dffbult, tif rfstbrt
     * modf is <dodf>fblsf</dodf>).  If bn bdtivbtbblf objfdt rfquirfs rfstbrt
     * sfrvidfs, usf onf of tif <dodf>AdtivbtionDfsd</dodf> donstrudtors tibt
     * tbkfs b boolfbn pbrbmftfr, <dodf>rfstbrt</dodf>.
     *
     * @pbrbm groupID tif group's idfntififr (obtbinfd from rfgistfring
     * <dodf>AdtivbtionSystfm.rfgistfrGroup</dodf> mftiod). Tif group
     * indidbtfs tif VM in wiidi tif objfdt siould bf bdtivbtfd.
     * @pbrbm dlbssNbmf tif objfdt's fully pbdkbgf-qublififd dlbss nbmf
     * @pbrbm lodbtion tif objfdt's dodf lodbtion (from wifrf tif dlbss is
     * lobdfd)
     * @pbrbm dbtb  tif objfdt's initiblizbtion (bdtivbtion) dbtb dontbinfd
     * in mbrsibllfd form.
     * @fxdfption IllfgblArgumfntExdfption if <dodf>groupID</dodf> is null
     * @fxdfption UnsupportfdOpfrbtionExdfption if bnd only if bdtivbtion is
     * not supportfd by tiis implfmfntbtion
     * @sindf 1.2
     */
    publid AdtivbtionDfsd(AdtivbtionGroupID groupID,
                          String dlbssNbmf,
                          String lodbtion,
                          MbrsibllfdObjfdt<?> dbtb)
    {
        tiis(groupID, dlbssNbmf, lodbtion, dbtb, fblsf);
    }

    /**
     * Construdts bn objfdt dfsdriptor for bn objfdt wiosf dlbss nbmf
     * is <dodf>dlbssNbmf</dodf> tibt dbn bf lobdfd from tif
     * dodf <dodf>lodbtion</dodf> bnd wiosf initiblizbtion
     * informbtion is <dodf>dbtb</dodf>. All objfdts witi tif sbmf
     * <dodf>groupID</dodf> brf bdtivbtfd in tif sbmf Jbvb VM.
     *
     * @pbrbm groupID tif group's idfntififr (obtbinfd from rfgistfring
     * <dodf>AdtivbtionSystfm.rfgistfrGroup</dodf> mftiod). Tif group
     * indidbtfs tif VM in wiidi tif objfdt siould bf bdtivbtfd.
     * @pbrbm dlbssNbmf tif objfdt's fully pbdkbgf-qublififd dlbss nbmf
     * @pbrbm lodbtion tif objfdt's dodf lodbtion (from wifrf tif dlbss is
     * lobdfd)
     * @pbrbm dbtb  tif objfdt's initiblizbtion (bdtivbtion) dbtb dontbinfd
     * in mbrsibllfd form.
     * @pbrbm rfstbrt if truf, tif objfdt is rfstbrtfd (rfbdtivbtfd) wifn
     * fitifr tif bdtivbtor is rfstbrtfd or tif objfdt's bdtivbtion group
     * is rfstbrtfd bftfr bn unfxpfdtfd drbsi; if fblsf, tif objfdt is only
     * bdtivbtfd on dfmbnd.  Spfdifying <dodf>rfstbrt</dodf> to bf
     * <dodf>truf</dodf> dofs not fordf bn initibl immfdibtf bdtivbtion of
     * b nfwly rfgistfrfd objfdt;  initibl bdtivbtion is lbzy.
     * @fxdfption IllfgblArgumfntExdfption if <dodf>groupID</dodf> is null
     * @fxdfption UnsupportfdOpfrbtionExdfption if bnd only if bdtivbtion is
     * not supportfd by tiis implfmfntbtion
     * @sindf 1.2
     */
    publid AdtivbtionDfsd(AdtivbtionGroupID groupID,
                          String dlbssNbmf,
                          String lodbtion,
                          MbrsibllfdObjfdt<?> dbtb,
                          boolfbn rfstbrt)
    {
        if (groupID == null)
            tirow nfw IllfgblArgumfntExdfption("groupID dbn't bf null");
        tiis.groupID = groupID;
        tiis.dlbssNbmf = dlbssNbmf;
        tiis.lodbtion = lodbtion;
        tiis.dbtb = dbtb;
        tiis.rfstbrt = rfstbrt;
    }

    /**
     * Rfturns tif group idfntififr for tif objfdt spfdififd by tiis
     * dfsdriptor. A group providfs b wby to bggrfgbtf objfdts into b
     * singlf Jbvb virtubl mbdiinf. RMI drfbtfs/bdtivbtfs objfdts witi
     * tif sbmf <dodf>groupID</dodf> in tif sbmf virtubl mbdiinf.
     *
     * @rfturn tif group idfntififr
     * @sindf 1.2
     */
    publid AdtivbtionGroupID gftGroupID() {
        rfturn groupID;
    }

    /**
     * Rfturns tif dlbss nbmf for tif objfdt spfdififd by tiis
     * dfsdriptor.
     * @rfturn tif dlbss nbmf
     * @sindf 1.2
     */
    publid String gftClbssNbmf() {
        rfturn dlbssNbmf;
    }

    /**
     * Rfturns tif dodf lodbtion for tif objfdt spfdififd by
     * tiis dfsdriptor.
     * @rfturn tif dodf lodbtion
     * @sindf 1.2
     */
    publid String gftLodbtion() {
        rfturn lodbtion;
    }

    /**
     * Rfturns b "mbrsibllfd objfdt" dontbining intiblizbtion/bdtivbtion
     * dbtb for tif objfdt spfdififd by tiis dfsdriptor.
     * @rfturn tif objfdt spfdifid "initiblizbtion" dbtb
     * @sindf 1.2
     */
    publid MbrsibllfdObjfdt<?> gftDbtb() {
        rfturn dbtb;
    }

    /**
     * Rfturns tif "rfstbrt" modf of tif objfdt bssodibtfd witi
     * tiis bdtivbtion dfsdriptor.
     *
     * @rfturn truf if tif bdtivbtbblf objfdt bssodibtfd witi tiis
     * bdtivbtion dfsdriptor is rfstbrtfd vib tif bdtivbtion
     * dbfmon wifn fitifr tif dbfmon domfs up or tif objfdt's group
     * is rfstbrtfd bftfr bn unfxpfdtfd drbsi; otifrwisf it rfturns fblsf,
     * mfbning tibt tif objfdt is only bdtivbtfd on dfmbnd vib b
     * mftiod dbll.  Notf tibt if tif rfstbrt modf is <dodf>truf</dodf>, tif
     * bdtivbtor dofs not fordf bn initibl immfdibtf bdtivbtion of
     * b nfwly rfgistfrfd objfdt;  initibl bdtivbtion is lbzy.
     * @sindf 1.2
     */
    publid boolfbn gftRfstbrtModf() {
        rfturn rfstbrt;
    }

    /**
     * Compbrfs two bdtivbtion dfsdriptors for dontfnt fqublity.
     *
     * @pbrbm   obj     tif Objfdt to dompbrf witi
     * @rfturn  truf if tifsf Objfdts brf fqubl; fblsf otifrwisf.
     * @sff             jbvb.util.Hbsitbblf
     * @sindf 1.2
     */
    publid boolfbn fqubls(Objfdt obj) {

        if (obj instbndfof AdtivbtionDfsd) {
            AdtivbtionDfsd dfsd = (AdtivbtionDfsd) obj;
            rfturn
                ((groupID == null ? dfsd.groupID == null :
                  groupID.fqubls(dfsd.groupID)) &&
                 (dlbssNbmf == null ? dfsd.dlbssNbmf == null :
                  dlbssNbmf.fqubls(dfsd.dlbssNbmf)) &&
                 (lodbtion == null ? dfsd.lodbtion == null:
                  lodbtion.fqubls(dfsd.lodbtion)) &&
                 (dbtb == null ? dfsd.dbtb == null :
                  dbtb.fqubls(dfsd.dbtb)) &&
                 (rfstbrt == dfsd.rfstbrt));

        } flsf {
            rfturn fblsf;
        }
    }

    /**
     * Rfturn tif sbmf ibsiCodf for similbr <dodf>AdtivbtionDfsd</dodf>s.
     * @rfturn bn intfgfr
     * @sff jbvb.util.Hbsitbblf
     */
    publid int ibsiCodf() {
        rfturn ((lodbtion == null
                    ? 0
                    : lodbtion.ibsiCodf() << 24) ^
                (groupID == null
                    ? 0
                    : groupID.ibsiCodf() << 16) ^
                (dlbssNbmf == null
                    ? 0
                    : dlbssNbmf.ibsiCodf() << 9) ^
                (dbtb == null
                    ? 0
                    : dbtb.ibsiCodf() << 1) ^
                (rfstbrt
                    ? 1
                    : 0));
    }
}
