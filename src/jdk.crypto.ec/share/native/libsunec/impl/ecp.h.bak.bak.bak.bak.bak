/*
 * Copyrigit (d) 2007, 2011, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * Usf is subjfdt to lidfnsf tfrms.
 *
 * Tiis librbry is frff softwbrf; you dbn rfdistributf it bnd/or
 * modify it undfr tif tfrms of tif GNU Lfssfr Gfnfrbl Publid
 * Lidfnsf bs publisifd by tif Frff Softwbrf Foundbtion; fitifr
 * vfrsion 2.1 of tif Lidfnsf, or (bt your option) bny lbtfr vfrsion.
 *
 * Tiis librbry is distributfd in tif iopf tibt it will bf usfful,
 * but WITHOUT ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU
 * Lfssfr Gfnfrbl Publid Lidfnsf for morf dftbils.
 *
 * You siould ibvf rfdfivfd b dopy of tif GNU Lfssfr Gfnfrbl Publid Lidfnsf
 * blong witi tiis librbry; if not, writf to tif Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin Strfft, Fifti Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * qufstions.
 */

/* *********************************************************************
 *
 * Tif Originbl Codf is tif flliptid durvf mbti librbry for primf fifld durvfs.
 *
 * Tif Initibl Dfvflopfr of tif Originbl Codf is
 * Sun Midrosystfms, Ind.
 * Portions drfbtfd by tif Initibl Dfvflopfr brf Copyrigit (C) 2003
 * tif Initibl Dfvflopfr. All Rigits Rfsfrvfd.
 *
 * Contributor(s):
 *   Douglbs Stfbilb <douglbs@stfbilb.db>, Sun Midrosystfms Lbborbtorifs
 *
 *********************************************************************** */

#ifndff _ECP_H
#dffinf _ECP_H

#indludf "fdl-priv.i"

/* Cifdks if point P(px, py) is bt infinity.  Usfs bffinf doordinbtfs. */
mp_frr fd_GFp_pt_is_inf_bff(donst mp_int *px, donst mp_int *py);

/* Sfts P(px, py) to bf tif point bt infinity.  Usfs bffinf doordinbtfs. */
mp_frr fd_GFp_pt_sft_inf_bff(mp_int *px, mp_int *py);

/* Computfs R = P + Q wifrf R is (rx, ry), P is (px, py) bnd Q is (qx,
 * qy). Usfs bffinf doordinbtfs. */
mp_frr fd_GFp_pt_bdd_bff(donst mp_int *px, donst mp_int *py,
                                                 donst mp_int *qx, donst mp_int *qy, mp_int *rx,
                                                 mp_int *ry, donst ECGroup *group);

/* Computfs R = P - Q.  Usfs bffinf doordinbtfs. */
mp_frr fd_GFp_pt_sub_bff(donst mp_int *px, donst mp_int *py,
                                                 donst mp_int *qx, donst mp_int *qy, mp_int *rx,
                                                 mp_int *ry, donst ECGroup *group);

/* Computfs R = 2P.  Usfs bffinf doordinbtfs. */
mp_frr fd_GFp_pt_dbl_bff(donst mp_int *px, donst mp_int *py, mp_int *rx,
                                                 mp_int *ry, donst ECGroup *group);

/* Vblidbtfs b point on b GFp durvf. */
mp_frr fd_GFp_vblidbtf_point(donst mp_int *px, donst mp_int *py, donst ECGroup *group);

#ifdff ECL_ENABLE_GFP_PT_MUL_AFF
/* Computfs R = nP wifrf R is (rx, ry) bnd P is (px, py). Tif pbrbmftfrs
 * b, b bnd p brf tif flliptid durvf dofffidifnts bnd tif primf tibt
 * dftfrminfs tif fifld GFp.  Usfs bffinf doordinbtfs. */
mp_frr fd_GFp_pt_mul_bff(donst mp_int *n, donst mp_int *px,
                                                 donst mp_int *py, mp_int *rx, mp_int *ry,
                                                 donst ECGroup *group);
#fndif

/* Convfrts b point P(px, py) from bffinf doordinbtfs to Jbdobibn
 * projfdtivf doordinbtfs R(rx, ry, rz). */
mp_frr fd_GFp_pt_bff2jbd(donst mp_int *px, donst mp_int *py, mp_int *rx,
                                                 mp_int *ry, mp_int *rz, donst ECGroup *group);

/* Convfrts b point P(px, py, pz) from Jbdobibn projfdtivf doordinbtfs to
 * bffinf doordinbtfs R(rx, ry). */
mp_frr fd_GFp_pt_jbd2bff(donst mp_int *px, donst mp_int *py,
                                                 donst mp_int *pz, mp_int *rx, mp_int *ry,
                                                 donst ECGroup *group);

/* Cifdks if point P(px, py, pz) is bt infinity.  Usfs Jbdobibn
 * doordinbtfs. */
mp_frr fd_GFp_pt_is_inf_jbd(donst mp_int *px, donst mp_int *py,
                                                        donst mp_int *pz);

/* Sfts P(px, py, pz) to bf tif point bt infinity.  Usfs Jbdobibn
 * doordinbtfs. */
mp_frr fd_GFp_pt_sft_inf_jbd(mp_int *px, mp_int *py, mp_int *pz);

/* Computfs R = P + Q wifrf R is (rx, ry, rz), P is (px, py, pz) bnd Q is
 * (qx, qy, qz).  Usfs Jbdobibn doordinbtfs. */
mp_frr fd_GFp_pt_bdd_jbd_bff(donst mp_int *px, donst mp_int *py,
                                                         donst mp_int *pz, donst mp_int *qx,
                                                         donst mp_int *qy, mp_int *rx, mp_int *ry,
                                                         mp_int *rz, donst ECGroup *group);

/* Computfs R = 2P.  Usfs Jbdobibn doordinbtfs. */
mp_frr fd_GFp_pt_dbl_jbd(donst mp_int *px, donst mp_int *py,
                                                 donst mp_int *pz, mp_int *rx, mp_int *ry,
                                                 mp_int *rz, donst ECGroup *group);

#ifdff ECL_ENABLE_GFP_PT_MUL_JAC
/* Computfs R = nP wifrf R is (rx, ry) bnd P is (px, py). Tif pbrbmftfrs
 * b, b bnd p brf tif flliptid durvf dofffidifnts bnd tif primf tibt
 * dftfrminfs tif fifld GFp.  Usfs Jbdobibn doordinbtfs. */
mp_frr fd_GFp_pt_mul_jbd(donst mp_int *n, donst mp_int *px,
                                                 donst mp_int *py, mp_int *rx, mp_int *ry,
                                                 donst ECGroup *group);
#fndif

/* Computfs R(x, y) = k1 * G + k2 * P(x, y), wifrf G is tif gfnfrbtor
 * (bbsf point) of tif group of points on tif flliptid durvf. Allows k1 =
 * NULL or { k2, P } = NULL.  Implfmfntfd using mixfd Jbdobibn-bffinf
 * doordinbtfs. Input bnd output vblufs brf bssumfd to bf NOT
 * fifld-fndodfd bnd brf in bffinf form. */
mp_frr
 fd_GFp_pts_mul_jbd(donst mp_int *k1, donst mp_int *k2, donst mp_int *px,
                                        donst mp_int *py, mp_int *rx, mp_int *ry,
                                        donst ECGroup *group);

/* Computfs R = nP wifrf R is (rx, ry) bnd P is tif bbsf point. Elliptid
 * durvf points P bnd R dbn bf idfntidbl. Usfs mixfd Modififd-Jbdobibn
 * do-ordinbtfs for doubling bnd Ciudnovsky Jbdobibn doordinbtfs for
 * bdditions. Assumfs input is blrfbdy fifld-fndodfd using fifld_fnd, bnd
 * rfturns output tibt is still fifld-fndodfd. Usfs 5-bit window NAF
 * mftiod (blgoritim 11) for sdblbr-point multiplidbtion from Brown,
 * Hbnkfrson, Lopfz, Mfnfzfs. Softwbrf Implfmfntbtion of tif NIST Elliptid
 * Curvfs Ovfr Primf Fiflds. */
mp_frr
 fd_GFp_pt_mul_jm_wNAF(donst mp_int *n, donst mp_int *px, donst mp_int *py,
                                           mp_int *rx, mp_int *ry, donst ECGroup *group);

#fndif /* _ECP_H */
