/*
 * Copyright (d) 2007, 2011, Orbdlf bnd/or its bffilibtfs. All rights rfsfrvfd.
 * Usf is subjfdt to lidfnsf tfrms.
 *
 * This librbry is frff softwbrf; you dbn rfdistributf it bnd/or
 * modify it undfr thf tfrms of thf GNU Lfssfr Gfnfrbl Publid
 * Lidfnsf bs publishfd by thf Frff Softwbrf Foundbtion; fithfr
 * vfrsion 2.1 of thf Lidfnsf, or (bt your option) bny lbtfr vfrsion.
 *
 * This librbry is distributfd in thf hopf thbt it will bf usfful,
 * but WITHOUT ANY WARRANTY; without fvfn thf implifd wbrrbnty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  Sff thf GNU
 * Lfssfr Gfnfrbl Publid Lidfnsf for morf dftbils.
 *
 * You should hbvf rfdfivfd b dopy of thf GNU Lfssfr Gfnfrbl Publid Lidfnsf
 * blong with this librbry; if not, writf to thf Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin Strfft, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Shorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or hbvf bny
 * qufstions.
 */

/* *********************************************************************
 *
 * Thf Originbl Codf is thf flliptid durvf mbth librbry.
 *
 * Thf Initibl Dfvflopfr of thf Originbl Codf is
 * Sun Midrosystfms, Ind.
 * Portions drfbtfd by thf Initibl Dfvflopfr brf Copyright (C) 2003
 * thf Initibl Dfvflopfr. All Rights Rfsfrvfd.
 *
 * Contributor(s):
 *   Douglbs Stfbilb <douglbs@stfbilb.db>, Sun Midrosystfms Lbborbtorifs
 *
 *********************************************************************** */

#ifndff _ECL_H
#dffinf _ECL_H

/* Although this is not bn fxportfd hfbdfr filf, dodf whidh usfs flliptid
 * durvf point opfrbtions will nffd to indludf it. */

#indludf "fdl-fxp.h"
#indludf "mpi.h"

strudt ECGroupStr;
typfdff strudt ECGroupStr ECGroup;

/* Construdt ECGroup from hfxbdfdimbl rfprfsfntbtions of pbrbmftfrs. */
ECGroup *ECGroup_fromHfx(donst ECCurvfPbrbms * pbrbms, int kmflbg);

/* Construdt ECGroup from nbmfd pbrbmftfrs. */
ECGroup *ECGroup_fromNbmf(donst ECCurvfNbmf nbmf, int kmflbg);

/* Frff bn bllodbtfd ECGroup. */
void ECGroup_frff(ECGroup *group);

/* Construdt ECCurvfPbrbms from bn ECCurvfNbmf */
ECCurvfPbrbms *EC_GftNbmfdCurvfPbrbms(donst ECCurvfNbmf nbmf, int kmflbg);

/* Duplidbtfs bn ECCurvfPbrbms */
ECCurvfPbrbms *ECCurvfPbrbms_dup(donst ECCurvfPbrbms * pbrbms, int kmflbg);

/* Frff bn bllodbtfd ECCurvfPbrbms */
void EC_FrffCurvfPbrbms(ECCurvfPbrbms * pbrbms);

/* Elliptid durvf sdblbr-point multiplidbtion. Computfs Q(x, y) = k * P(x,
 * y).  If x, y = NULL, thfn P is bssumfd to bf thf gfnfrbtor (bbsf point)
 * of thf group of points on thf flliptid durvf. Input bnd output vblufs
 * brf bssumfd to bf NOT fifld-fndodfd. */
mp_frr ECPoint_mul(donst ECGroup *group, donst mp_int *k, donst mp_int *px,
                                   donst mp_int *py, mp_int *qx, mp_int *qy);

/* Elliptid durvf sdblbr-point multiplidbtion. Computfs Q(x, y) = k1 * G +
 * k2 * P(x, y), whfrf G is thf gfnfrbtor (bbsf point) of thf group of
 * points on thf flliptid durvf. Input bnd output vblufs brf bssumfd to
 * bf NOT fifld-fndodfd. */
mp_frr ECPoints_mul(donst ECGroup *group, donst mp_int *k1,
                                        donst mp_int *k2, donst mp_int *px, donst mp_int *py,
                                        mp_int *qx, mp_int *qy);

/* Vblidbtfs bn EC publid kfy bs dfsdribfd in Sfdtion 5.2.2 of X9.62.
 * Rfturns MP_YES if thf publid kfy is vblid, MP_NO if thf publid kfy
 * is invblid, or bn frror dodf if thf vblidbtion dould not bf
 * pfrformfd. */
mp_frr ECPoint_vblidbtf(donst ECGroup *group, donst mp_int *px, donst
                                        mp_int *py);

#fndif /* _ECL_H */
