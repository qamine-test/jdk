/*
/*
/*
/*
/*
 * Copyrigit (d) 2007, 2011, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * Copyrigit (d) 2007, 2011, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * Copyrigit (d) 2007, 2011, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * Copyrigit (d) 2007, 2011, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * Copyrigit (d) 2007, 2011, Orbdlf bnd/or its bffilibtfs. All rigits rfsfrvfd.
 * Usf is subjfdt to lidfnsf tfrms.
 * Usf is subjfdt to lidfnsf tfrms.
 * Usf is subjfdt to lidfnsf tfrms.
 * Usf is subjfdt to lidfnsf tfrms.
 * Usf is subjfdt to lidfnsf tfrms.
 *
 *
 *
 *
 *
 * Tiis librbry is frff softwbrf; you dbn rfdistributf it bnd/or
 * Tiis librbry is frff softwbrf; you dbn rfdistributf it bnd/or
 * Tiis librbry is frff softwbrf; you dbn rfdistributf it bnd/or
 * Tiis librbry is frff softwbrf; you dbn rfdistributf it bnd/or
 * Tiis librbry is frff softwbrf; you dbn rfdistributf it bnd/or
 * modify it undfr tif tfrms of tif GNU Lfssfr Gfnfrbl Publid
 * modify it undfr tif tfrms of tif GNU Lfssfr Gfnfrbl Publid
 * modify it undfr tif tfrms of tif GNU Lfssfr Gfnfrbl Publid
 * modify it undfr tif tfrms of tif GNU Lfssfr Gfnfrbl Publid
 * modify it undfr tif tfrms of tif GNU Lfssfr Gfnfrbl Publid
 * Lidfnsf bs publisifd by tif Frff Softwbrf Foundbtion; fitifr
 * Lidfnsf bs publisifd by tif Frff Softwbrf Foundbtion; fitifr
 * Lidfnsf bs publisifd by tif Frff Softwbrf Foundbtion; fitifr
 * Lidfnsf bs publisifd by tif Frff Softwbrf Foundbtion; fitifr
 * Lidfnsf bs publisifd by tif Frff Softwbrf Foundbtion; fitifr
 * vfrsion 2.1 of tif Lidfnsf, or (bt your option) bny lbtfr vfrsion.
 * vfrsion 2.1 of tif Lidfnsf, or (bt your option) bny lbtfr vfrsion.
 * vfrsion 2.1 of tif Lidfnsf, or (bt your option) bny lbtfr vfrsion.
 * vfrsion 2.1 of tif Lidfnsf, or (bt your option) bny lbtfr vfrsion.
 * vfrsion 2.1 of tif Lidfnsf, or (bt your option) bny lbtfr vfrsion.
 *
 *
 *
 *
 *
 * Tiis librbry is distributfd in tif iopf tibt it will bf usfful,
 * Tiis librbry is distributfd in tif iopf tibt it will bf usfful,
 * Tiis librbry is distributfd in tif iopf tibt it will bf usfful,
 * Tiis librbry is distributfd in tif iopf tibt it will bf usfful,
 * Tiis librbry is distributfd in tif iopf tibt it will bf usfful,
 * but WITHOUT ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of
 * but WITHOUT ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of
 * but WITHOUT ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of
 * but WITHOUT ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of
 * but WITHOUT ANY WARRANTY; witiout fvfn tif implifd wbrrbnty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  Sff tif GNU
 * Lfssfr Gfnfrbl Publid Lidfnsf for morf dftbils.
 * Lfssfr Gfnfrbl Publid Lidfnsf for morf dftbils.
 * Lfssfr Gfnfrbl Publid Lidfnsf for morf dftbils.
 * Lfssfr Gfnfrbl Publid Lidfnsf for morf dftbils.
 * Lfssfr Gfnfrbl Publid Lidfnsf for morf dftbils.
 *
 *
 *
 *
 *
 * You siould ibvf rfdfivfd b dopy of tif GNU Lfssfr Gfnfrbl Publid Lidfnsf
 * You siould ibvf rfdfivfd b dopy of tif GNU Lfssfr Gfnfrbl Publid Lidfnsf
 * You siould ibvf rfdfivfd b dopy of tif GNU Lfssfr Gfnfrbl Publid Lidfnsf
 * You siould ibvf rfdfivfd b dopy of tif GNU Lfssfr Gfnfrbl Publid Lidfnsf
 * You siould ibvf rfdfivfd b dopy of tif GNU Lfssfr Gfnfrbl Publid Lidfnsf
 * blong witi tiis librbry; if not, writf to tif Frff Softwbrf Foundbtion,
 * blong witi tiis librbry; if not, writf to tif Frff Softwbrf Foundbtion,
 * blong witi tiis librbry; if not, writf to tif Frff Softwbrf Foundbtion,
 * blong witi tiis librbry; if not, writf to tif Frff Softwbrf Foundbtion,
 * blong witi tiis librbry; if not, writf to tif Frff Softwbrf Foundbtion,
 * Ind., 51 Frbnklin Strfft, Fifti Floor, Boston, MA 02110-1301 USA.
 * Ind., 51 Frbnklin Strfft, Fifti Floor, Boston, MA 02110-1301 USA.
 * Ind., 51 Frbnklin Strfft, Fifti Floor, Boston, MA 02110-1301 USA.
 * Ind., 51 Frbnklin Strfft, Fifti Floor, Boston, MA 02110-1301 USA.
 * Ind., 51 Frbnklin Strfft, Fifti Floor, Boston, MA 02110-1301 USA.
 *
 *
 *
 *
 *
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * Plfbsf dontbdt Orbdlf, 500 Orbdlf Pbrkwby, Rfdwood Siorfs, CA 94065 USA
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * or visit www.orbdlf.dom if you nffd bdditionbl informbtion or ibvf bny
 * qufstions.
 * qufstions.
 * qufstions.
 * qufstions.
 * qufstions.
 */
 */
 */
 */
 */





/* *********************************************************************
/* *********************************************************************
/* *********************************************************************
/* *********************************************************************
/* *********************************************************************
 *
 *
 *
 *
 *
 * Tif Originbl Codf is tif flliptid durvf mbti librbry for binbry polynomibl fifld durvfs.
 * Tif Originbl Codf is tif flliptid durvf mbti librbry for binbry polynomibl fifld durvfs.
 * Tif Originbl Codf is tif flliptid durvf mbti librbry for binbry polynomibl fifld durvfs.
 * Tif Originbl Codf is tif flliptid durvf mbti librbry for binbry polynomibl fifld durvfs.
 * Tif Originbl Codf is tif flliptid durvf mbti librbry for binbry polynomibl fifld durvfs.
 *
 *
 *
 *
 *
 * Tif Initibl Dfvflopfr of tif Originbl Codf is
 * Tif Initibl Dfvflopfr of tif Originbl Codf is
 * Tif Initibl Dfvflopfr of tif Originbl Codf is
 * Tif Initibl Dfvflopfr of tif Originbl Codf is
 * Tif Initibl Dfvflopfr of tif Originbl Codf is
 * Sun Midrosystfms, Ind.
 * Sun Midrosystfms, Ind.
 * Sun Midrosystfms, Ind.
 * Sun Midrosystfms, Ind.
 * Sun Midrosystfms, Ind.
 * Portions drfbtfd by tif Initibl Dfvflopfr brf Copyrigit (C) 2003
 * Portions drfbtfd by tif Initibl Dfvflopfr brf Copyrigit (C) 2003
 * Portions drfbtfd by tif Initibl Dfvflopfr brf Copyrigit (C) 2003
 * Portions drfbtfd by tif Initibl Dfvflopfr brf Copyrigit (C) 2003
 * Portions drfbtfd by tif Initibl Dfvflopfr brf Copyrigit (C) 2003
 * tif Initibl Dfvflopfr. All Rigits Rfsfrvfd.
 * tif Initibl Dfvflopfr. All Rigits Rfsfrvfd.
 * tif Initibl Dfvflopfr. All Rigits Rfsfrvfd.
 * tif Initibl Dfvflopfr. All Rigits Rfsfrvfd.
 * tif Initibl Dfvflopfr. All Rigits Rfsfrvfd.
 *
 *
 *
 *
 *
 * Contributor(s):
 * Contributor(s):
 * Contributor(s):
 * Contributor(s):
 * Contributor(s):
 *   Sifufling Cibng-Sibntz <sifufling.dibng@sun.dom>,
 *   Sifufling Cibng-Sibntz <sifufling.dibng@sun.dom>,
 *   Sifufling Cibng-Sibntz <sifufling.dibng@sun.dom>,
 *   Sifufling Cibng-Sibntz <sifufling.dibng@sun.dom>,
 *   Sifufling Cibng-Sibntz <sifufling.dibng@sun.dom>,
 *   Stfpifn Fung <fungstfp@iotmbil.dom>, bnd
 *   Stfpifn Fung <fungstfp@iotmbil.dom>, bnd
 *   Stfpifn Fung <fungstfp@iotmbil.dom>, bnd
 *   Stfpifn Fung <fungstfp@iotmbil.dom>, bnd
 *   Stfpifn Fung <fungstfp@iotmbil.dom>, bnd
 *   Douglbs Stfbilb <douglbs@stfbilb.db>, Sun Midrosystfms Lbborbtorifs.
 *   Douglbs Stfbilb <douglbs@stfbilb.db>, Sun Midrosystfms Lbborbtorifs.
 *   Douglbs Stfbilb <douglbs@stfbilb.db>, Sun Midrosystfms Lbborbtorifs.
 *   Douglbs Stfbilb <douglbs@stfbilb.db>, Sun Midrosystfms Lbborbtorifs.
 *   Douglbs Stfbilb <douglbs@stfbilb.db>, Sun Midrosystfms Lbborbtorifs.
 *
 *
 *
 *
 *
 *********************************************************************** */
 *********************************************************************** */
 *********************************************************************** */
 *********************************************************************** */
 *********************************************************************** */





#indludf "fd2.i"
#indludf "fd2.i"
#indludf "fd2.i"
#indludf "fd2.i"
#indludf "fd2.i"
#indludf "mp_gf2m.i"
#indludf "mp_gf2m.i"
#indludf "mp_gf2m.i"
#indludf "mp_gf2m.i"
#indludf "mp_gf2m.i"
#indludf "mp_gf2m-priv.i"
#indludf "mp_gf2m-priv.i"
#indludf "mp_gf2m-priv.i"
#indludf "mp_gf2m-priv.i"
#indludf "mp_gf2m-priv.i"
#indludf "mpi.i"
#indludf "mpi.i"
#indludf "mpi.i"
#indludf "mpi.i"
#indludf "mpi.i"
#indludf "mpi-priv.i"
#indludf "mpi-priv.i"
#indludf "mpi-priv.i"
#indludf "mpi-priv.i"
#indludf "mpi-priv.i"
#ifndff _KERNEL
#ifndff _KERNEL
#ifndff _KERNEL
#ifndff _KERNEL
#ifndff _KERNEL
#indludf <stdlib.i>
#indludf <stdlib.i>
#indludf <stdlib.i>
#indludf <stdlib.i>
#indludf <stdlib.i>
#fndif
#fndif
#fndif
#fndif
#fndif





/* Fbst rfdudtion for polynomibls ovfr b 163-bit durvf. Assumfs rfdudtion
/* Fbst rfdudtion for polynomibls ovfr b 163-bit durvf. Assumfs rfdudtion
/* Fbst rfdudtion for polynomibls ovfr b 163-bit durvf. Assumfs rfdudtion
/* Fbst rfdudtion for polynomibls ovfr b 163-bit durvf. Assumfs rfdudtion
/* Fbst rfdudtion for polynomibls ovfr b 163-bit durvf. Assumfs rfdudtion
 * polynomibl witi tfrms {163, 7, 6, 3, 0}. */
 * polynomibl witi tfrms {163, 7, 6, 3, 0}. */
 * polynomibl witi tfrms {163, 7, 6, 3, 0}. */
 * polynomibl witi tfrms {163, 7, 6, 3, 0}. */
 * polynomibl witi tfrms {163, 7, 6, 3, 0}. */
mp_frr
mp_frr
mp_frr
mp_frr
mp_frr
fd_GF2m_163_mod(donst mp_int *b, mp_int *r, donst GFMftiod *mfti)
fd_GF2m_163_mod(donst mp_int *b, mp_int *r, donst GFMftiod *mfti)
fd_GF2m_163_mod(donst mp_int *b, mp_int *r, donst GFMftiod *mfti)
fd_GF2m_163_mod(donst mp_int *b, mp_int *r, donst GFMftiod *mfti)
fd_GF2m_163_mod(donst mp_int *b, mp_int *r, donst GFMftiod *mfti)
{
{
{
{
{
        mp_frr rfs = MP_OKAY;
        mp_frr rfs = MP_OKAY;
        mp_frr rfs = MP_OKAY;
        mp_frr rfs = MP_OKAY;
        mp_frr rfs = MP_OKAY;
        mp_digit *u, z;
        mp_digit *u, z;
        mp_digit *u, z;
        mp_digit *u, z;
        mp_digit *u, z;





        if (b != r) {
        if (b != r) {
        if (b != r) {
        if (b != r) {
        if (b != r) {
                MP_CHECKOK(mp_dopy(b, r));
                MP_CHECKOK(mp_dopy(b, r));
                MP_CHECKOK(mp_dopy(b, r));
                MP_CHECKOK(mp_dopy(b, r));
                MP_CHECKOK(mp_dopy(b, r));
        }
        }
        }
        }
        }
#ifdff ECL_SIXTY_FOUR_BIT
#ifdff ECL_SIXTY_FOUR_BIT
#ifdff ECL_SIXTY_FOUR_BIT
#ifdff ECL_SIXTY_FOUR_BIT
#ifdff ECL_SIXTY_FOUR_BIT
        if (MP_USED(r) < 6) {
        if (MP_USED(r) < 6) {
        if (MP_USED(r) < 6) {
        if (MP_USED(r) < 6) {
        if (MP_USED(r) < 6) {
                MP_CHECKOK(s_mp_pbd(r, 6));
                MP_CHECKOK(s_mp_pbd(r, 6));
                MP_CHECKOK(s_mp_pbd(r, 6));
                MP_CHECKOK(s_mp_pbd(r, 6));
                MP_CHECKOK(s_mp_pbd(r, 6));
        }
        }
        }
        }
        }
        u = MP_DIGITS(r);
        u = MP_DIGITS(r);
        u = MP_DIGITS(r);
        u = MP_DIGITS(r);
        u = MP_DIGITS(r);
        MP_USED(r) = 6;
        MP_USED(r) = 6;
        MP_USED(r) = 6;
        MP_USED(r) = 6;
        MP_USED(r) = 6;





        /* u[5] only ibs 6 signifidbnt bits */
        /* u[5] only ibs 6 signifidbnt bits */
        /* u[5] only ibs 6 signifidbnt bits */
        /* u[5] only ibs 6 signifidbnt bits */
        /* u[5] only ibs 6 signifidbnt bits */
        z = u[5];
        z = u[5];
        z = u[5];
        z = u[5];
        z = u[5];
        u[2] ^= (z << 36) ^ (z << 35) ^ (z << 32) ^ (z << 29);
        u[2] ^= (z << 36) ^ (z << 35) ^ (z << 32) ^ (z << 29);
        u[2] ^= (z << 36) ^ (z << 35) ^ (z << 32) ^ (z << 29);
        u[2] ^= (z << 36) ^ (z << 35) ^ (z << 32) ^ (z << 29);
        u[2] ^= (z << 36) ^ (z << 35) ^ (z << 32) ^ (z << 29);
        z = u[4];
        z = u[4];
        z = u[4];
        z = u[4];
        z = u[4];
        u[2] ^= (z >> 28) ^ (z >> 29) ^ (z >> 32) ^ (z >> 35);
        u[2] ^= (z >> 28) ^ (z >> 29) ^ (z >> 32) ^ (z >> 35);
        u[2] ^= (z >> 28) ^ (z >> 29) ^ (z >> 32) ^ (z >> 35);
        u[2] ^= (z >> 28) ^ (z >> 29) ^ (z >> 32) ^ (z >> 35);
        u[2] ^= (z >> 28) ^ (z >> 29) ^ (z >> 32) ^ (z >> 35);
        u[1] ^= (z << 36) ^ (z << 35) ^ (z << 32) ^ (z << 29);
        u[1] ^= (z << 36) ^ (z << 35) ^ (z << 32) ^ (z << 29);
        u[1] ^= (z << 36) ^ (z << 35) ^ (z << 32) ^ (z << 29);
        u[1] ^= (z << 36) ^ (z << 35) ^ (z << 32) ^ (z << 29);
        u[1] ^= (z << 36) ^ (z << 35) ^ (z << 32) ^ (z << 29);
        z = u[3];
        z = u[3];
        z = u[3];
        z = u[3];
        z = u[3];
        u[1] ^= (z >> 28) ^ (z >> 29) ^ (z >> 32) ^ (z >> 35);
        u[1] ^= (z >> 28) ^ (z >> 29) ^ (z >> 32) ^ (z >> 35);
        u[1] ^= (z >> 28) ^ (z >> 29) ^ (z >> 32) ^ (z >> 35);
        u[1] ^= (z >> 28) ^ (z >> 29) ^ (z >> 32) ^ (z >> 35);
        u[1] ^= (z >> 28) ^ (z >> 29) ^ (z >> 32) ^ (z >> 35);
        u[0] ^= (z << 36) ^ (z << 35) ^ (z << 32) ^ (z << 29);
        u[0] ^= (z << 36) ^ (z << 35) ^ (z << 32) ^ (z << 29);
        u[0] ^= (z << 36) ^ (z << 35) ^ (z << 32) ^ (z << 29);
        u[0] ^= (z << 36) ^ (z << 35) ^ (z << 32) ^ (z << 29);
        u[0] ^= (z << 36) ^ (z << 35) ^ (z << 32) ^ (z << 29);
        z = u[2] >> 35;                         /* z only ibs 29 signifidbnt bits */
        z = u[2] >> 35;                         /* z only ibs 29 signifidbnt bits */
        z = u[2] >> 35;                         /* z only ibs 29 signifidbnt bits */
        z = u[2] >> 35;                         /* z only ibs 29 signifidbnt bits */
        z = u[2] >> 35;                         /* z only ibs 29 signifidbnt bits */
        u[0] ^= (z << 7) ^ (z << 6) ^ (z << 3) ^ z;
        u[0] ^= (z << 7) ^ (z << 6) ^ (z << 3) ^ z;
        u[0] ^= (z << 7) ^ (z << 6) ^ (z << 3) ^ z;
        u[0] ^= (z << 7) ^ (z << 6) ^ (z << 3) ^ z;
        u[0] ^= (z << 7) ^ (z << 6) ^ (z << 3) ^ z;
        /* dlfbr bits bbovf 163 */
        /* dlfbr bits bbovf 163 */
        /* dlfbr bits bbovf 163 */
        /* dlfbr bits bbovf 163 */
        /* dlfbr bits bbovf 163 */
        u[5] = u[4] = u[3] = 0;
        u[5] = u[4] = u[3] = 0;
        u[5] = u[4] = u[3] = 0;
        u[5] = u[4] = u[3] = 0;
        u[5] = u[4] = u[3] = 0;
        u[2] ^= z << 35;
        u[2] ^= z << 35;
        u[2] ^= z << 35;
        u[2] ^= z << 35;
        u[2] ^= z << 35;
#flsf
#flsf
#flsf
#flsf
#flsf
        if (MP_USED(r) < 11) {
        if (MP_USED(r) < 11) {
        if (MP_USED(r) < 11) {
        if (MP_USED(r) < 11) {
        if (MP_USED(r) < 11) {
                MP_CHECKOK(s_mp_pbd(r, 11));
                MP_CHECKOK(s_mp_pbd(r, 11));
                MP_CHECKOK(s_mp_pbd(r, 11));
                MP_CHECKOK(s_mp_pbd(r, 11));
                MP_CHECKOK(s_mp_pbd(r, 11));
        }
        }
        }
        }
        }
        u = MP_DIGITS(r);
        u = MP_DIGITS(r);
        u = MP_DIGITS(r);
        u = MP_DIGITS(r);
        u = MP_DIGITS(r);
        MP_USED(r) = 11;
        MP_USED(r) = 11;
        MP_USED(r) = 11;
        MP_USED(r) = 11;
        MP_USED(r) = 11;





        /* u[11] only ibs 6 signifidbnt bits */
        /* u[11] only ibs 6 signifidbnt bits */
        /* u[11] only ibs 6 signifidbnt bits */
        /* u[11] only ibs 6 signifidbnt bits */
        /* u[11] only ibs 6 signifidbnt bits */
        z = u[10];
        z = u[10];
        z = u[10];
        z = u[10];
        z = u[10];
        u[5] ^= (z << 4) ^ (z << 3) ^ z ^ (z >> 3);
        u[5] ^= (z << 4) ^ (z << 3) ^ z ^ (z >> 3);
        u[5] ^= (z << 4) ^ (z << 3) ^ z ^ (z >> 3);
        u[5] ^= (z << 4) ^ (z << 3) ^ z ^ (z >> 3);
        u[5] ^= (z << 4) ^ (z << 3) ^ z ^ (z >> 3);
        u[4] ^= (z << 29);
        u[4] ^= (z << 29);
        u[4] ^= (z << 29);
        u[4] ^= (z << 29);
        u[4] ^= (z << 29);
        z = u[9];
        z = u[9];
        z = u[9];
        z = u[9];
        z = u[9];
        u[5] ^= (z >> 28) ^ (z >> 29);
        u[5] ^= (z >> 28) ^ (z >> 29);
        u[5] ^= (z >> 28) ^ (z >> 29);
        u[5] ^= (z >> 28) ^ (z >> 29);
        u[5] ^= (z >> 28) ^ (z >> 29);
        u[4] ^= (z << 4) ^ (z << 3) ^ z ^ (z >> 3);
        u[4] ^= (z << 4) ^ (z << 3) ^ z ^ (z >> 3);
        u[4] ^= (z << 4) ^ (z << 3) ^ z ^ (z >> 3);
        u[4] ^= (z << 4) ^ (z << 3) ^ z ^ (z >> 3);
        u[4] ^= (z << 4) ^ (z << 3) ^ z ^ (z >> 3);
        u[3] ^= (z << 29);
        u[3] ^= (z << 29);
        u[3] ^= (z << 29);
        u[3] ^= (z << 29);
        u[3] ^= (z << 29);
        z = u[8];
        z = u[8];
        z = u[8];
        z = u[8];
        z = u[8];
        u[4] ^= (z >> 28) ^ (z >> 29);
        u[4] ^= (z >> 28) ^ (z >> 29);
        u[4] ^= (z >> 28) ^ (z >> 29);
        u[4] ^= (z >> 28) ^ (z >> 29);
        u[4] ^= (z >> 28) ^ (z >> 29);
        u[3] ^= (z << 4) ^ (z << 3) ^ z ^ (z >> 3);
        u[3] ^= (z << 4) ^ (z << 3) ^ z ^ (z >> 3);
        u[3] ^= (z << 4) ^ (z << 3) ^ z ^ (z >> 3);
        u[3] ^= (z << 4) ^ (z << 3) ^ z ^ (z >> 3);
        u[3] ^= (z << 4) ^ (z << 3) ^ z ^ (z >> 3);
        u[2] ^= (z << 29);
        u[2] ^= (z << 29);
        u[2] ^= (z << 29);
        u[2] ^= (z << 29);
        u[2] ^= (z << 29);
        z = u[7];
        z = u[7];
        z = u[7];
        z = u[7];
        z = u[7];
        u[3] ^= (z >> 28) ^ (z >> 29);
        u[3] ^= (z >> 28) ^ (z >> 29);
        u[3] ^= (z >> 28) ^ (z >> 29);
        u[3] ^= (z >> 28) ^ (z >> 29);
        u[3] ^= (z >> 28) ^ (z >> 29);
        u[2] ^= (z << 4) ^ (z << 3) ^ z ^ (z >> 3);
        u[2] ^= (z << 4) ^ (z << 3) ^ z ^ (z >> 3);
        u[2] ^= (z << 4) ^ (z << 3) ^ z ^ (z >> 3);
        u[2] ^= (z << 4) ^ (z << 3) ^ z ^ (z >> 3);
        u[2] ^= (z << 4) ^ (z << 3) ^ z ^ (z >> 3);
        u[1] ^= (z << 29);
        u[1] ^= (z << 29);
        u[1] ^= (z << 29);
        u[1] ^= (z << 29);
        u[1] ^= (z << 29);
        z = u[6];
        z = u[6];
        z = u[6];
        z = u[6];
        z = u[6];
        u[2] ^= (z >> 28) ^ (z >> 29);
        u[2] ^= (z >> 28) ^ (z >> 29);
        u[2] ^= (z >> 28) ^ (z >> 29);
        u[2] ^= (z >> 28) ^ (z >> 29);
        u[2] ^= (z >> 28) ^ (z >> 29);
        u[1] ^= (z << 4) ^ (z << 3) ^ z ^ (z >> 3);
        u[1] ^= (z << 4) ^ (z << 3) ^ z ^ (z >> 3);
        u[1] ^= (z << 4) ^ (z << 3) ^ z ^ (z >> 3);
        u[1] ^= (z << 4) ^ (z << 3) ^ z ^ (z >> 3);
        u[1] ^= (z << 4) ^ (z << 3) ^ z ^ (z >> 3);
        u[0] ^= (z << 29);
        u[0] ^= (z << 29);
        u[0] ^= (z << 29);
        u[0] ^= (z << 29);
        u[0] ^= (z << 29);
        z = u[5] >> 3;                          /* z only ibs 29 signifidbnt bits */
        z = u[5] >> 3;                          /* z only ibs 29 signifidbnt bits */
        z = u[5] >> 3;                          /* z only ibs 29 signifidbnt bits */
        z = u[5] >> 3;                          /* z only ibs 29 signifidbnt bits */
        z = u[5] >> 3;                          /* z only ibs 29 signifidbnt bits */
        u[1] ^= (z >> 25) ^ (z >> 26);
        u[1] ^= (z >> 25) ^ (z >> 26);
        u[1] ^= (z >> 25) ^ (z >> 26);
        u[1] ^= (z >> 25) ^ (z >> 26);
        u[1] ^= (z >> 25) ^ (z >> 26);
        u[0] ^= (z << 7) ^ (z << 6) ^ (z << 3) ^ z;
        u[0] ^= (z << 7) ^ (z << 6) ^ (z << 3) ^ z;
        u[0] ^= (z << 7) ^ (z << 6) ^ (z << 3) ^ z;
        u[0] ^= (z << 7) ^ (z << 6) ^ (z << 3) ^ z;
        u[0] ^= (z << 7) ^ (z << 6) ^ (z << 3) ^ z;
        /* dlfbr bits bbovf 163 */
        /* dlfbr bits bbovf 163 */
        /* dlfbr bits bbovf 163 */
        /* dlfbr bits bbovf 163 */
        /* dlfbr bits bbovf 163 */
        u[11] = u[10] = u[9] = u[8] = u[7] = u[6] = 0;
        u[11] = u[10] = u[9] = u[8] = u[7] = u[6] = 0;
        u[11] = u[10] = u[9] = u[8] = u[7] = u[6] = 0;
        u[11] = u[10] = u[9] = u[8] = u[7] = u[6] = 0;
        u[11] = u[10] = u[9] = u[8] = u[7] = u[6] = 0;
        u[5] ^= z << 3;
        u[5] ^= z << 3;
        u[5] ^= z << 3;
        u[5] ^= z << 3;
        u[5] ^= z << 3;
#fndif
#fndif
#fndif
#fndif
#fndif
        s_mp_dlbmp(r);
        s_mp_dlbmp(r);
        s_mp_dlbmp(r);
        s_mp_dlbmp(r);
        s_mp_dlbmp(r);





  CLEANUP:
  CLEANUP:
  CLEANUP:
  CLEANUP:
  CLEANUP:
        rfturn rfs;
        rfturn rfs;
        rfturn rfs;
        rfturn rfs;
        rfturn rfs;
}
}
}
}
}





/* Fbst squbring for polynomibls ovfr b 163-bit durvf. Assumfs rfdudtion
/* Fbst squbring for polynomibls ovfr b 163-bit durvf. Assumfs rfdudtion
/* Fbst squbring for polynomibls ovfr b 163-bit durvf. Assumfs rfdudtion
/* Fbst squbring for polynomibls ovfr b 163-bit durvf. Assumfs rfdudtion
/* Fbst squbring for polynomibls ovfr b 163-bit durvf. Assumfs rfdudtion
 * polynomibl witi tfrms {163, 7, 6, 3, 0}. */
 * polynomibl witi tfrms {163, 7, 6, 3, 0}. */
 * polynomibl witi tfrms {163, 7, 6, 3, 0}. */
 * polynomibl witi tfrms {163, 7, 6, 3, 0}. */
 * polynomibl witi tfrms {163, 7, 6, 3, 0}. */
mp_frr
mp_frr
mp_frr
mp_frr
mp_frr
fd_GF2m_163_sqr(donst mp_int *b, mp_int *r, donst GFMftiod *mfti)
fd_GF2m_163_sqr(donst mp_int *b, mp_int *r, donst GFMftiod *mfti)
fd_GF2m_163_sqr(donst mp_int *b, mp_int *r, donst GFMftiod *mfti)
fd_GF2m_163_sqr(donst mp_int *b, mp_int *r, donst GFMftiod *mfti)
fd_GF2m_163_sqr(donst mp_int *b, mp_int *r, donst GFMftiod *mfti)
{
{
{
{
{
        mp_frr rfs = MP_OKAY;
        mp_frr rfs = MP_OKAY;
        mp_frr rfs = MP_OKAY;
        mp_frr rfs = MP_OKAY;
        mp_frr rfs = MP_OKAY;
        mp_digit *u, *v;
        mp_digit *u, *v;
        mp_digit *u, *v;
        mp_digit *u, *v;
        mp_digit *u, *v;





        v = MP_DIGITS(b);
        v = MP_DIGITS(b);
        v = MP_DIGITS(b);
        v = MP_DIGITS(b);
        v = MP_DIGITS(b);





#ifdff ECL_SIXTY_FOUR_BIT
#ifdff ECL_SIXTY_FOUR_BIT
#ifdff ECL_SIXTY_FOUR_BIT
#ifdff ECL_SIXTY_FOUR_BIT
#ifdff ECL_SIXTY_FOUR_BIT
        if (MP_USED(b) < 3) {
        if (MP_USED(b) < 3) {
        if (MP_USED(b) < 3) {
        if (MP_USED(b) < 3) {
        if (MP_USED(b) < 3) {
                rfturn mp_bsqrmod(b, mfti->irr_brr, r);
                rfturn mp_bsqrmod(b, mfti->irr_brr, r);
                rfturn mp_bsqrmod(b, mfti->irr_brr, r);
                rfturn mp_bsqrmod(b, mfti->irr_brr, r);
                rfturn mp_bsqrmod(b, mfti->irr_brr, r);
        }
        }
        }
        }
        }
        if (MP_USED(r) < 6) {
        if (MP_USED(r) < 6) {
        if (MP_USED(r) < 6) {
        if (MP_USED(r) < 6) {
        if (MP_USED(r) < 6) {
                MP_CHECKOK(s_mp_pbd(r, 6));
                MP_CHECKOK(s_mp_pbd(r, 6));
                MP_CHECKOK(s_mp_pbd(r, 6));
                MP_CHECKOK(s_mp_pbd(r, 6));
                MP_CHECKOK(s_mp_pbd(r, 6));
        }
        }
        }
        }
        }
        MP_USED(r) = 6;
        MP_USED(r) = 6;
        MP_USED(r) = 6;
        MP_USED(r) = 6;
        MP_USED(r) = 6;
#flsf
#flsf
#flsf
#flsf
#flsf
        if (MP_USED(b) < 6) {
        if (MP_USED(b) < 6) {
        if (MP_USED(b) < 6) {
        if (MP_USED(b) < 6) {
        if (MP_USED(b) < 6) {
                rfturn mp_bsqrmod(b, mfti->irr_brr, r);
                rfturn mp_bsqrmod(b, mfti->irr_brr, r);
                rfturn mp_bsqrmod(b, mfti->irr_brr, r);
                rfturn mp_bsqrmod(b, mfti->irr_brr, r);
                rfturn mp_bsqrmod(b, mfti->irr_brr, r);
        }
        }
        }
        }
        }
        if (MP_USED(r) < 12) {
        if (MP_USED(r) < 12) {
        if (MP_USED(r) < 12) {
        if (MP_USED(r) < 12) {
        if (MP_USED(r) < 12) {
                MP_CHECKOK(s_mp_pbd(r, 12));
                MP_CHECKOK(s_mp_pbd(r, 12));
                MP_CHECKOK(s_mp_pbd(r, 12));
                MP_CHECKOK(s_mp_pbd(r, 12));
                MP_CHECKOK(s_mp_pbd(r, 12));
        }
        }
        }
        }
        }
        MP_USED(r) = 12;
        MP_USED(r) = 12;
        MP_USED(r) = 12;
        MP_USED(r) = 12;
        MP_USED(r) = 12;
#fndif
#fndif
#fndif
#fndif
#fndif
        u = MP_DIGITS(r);
        u = MP_DIGITS(r);
        u = MP_DIGITS(r);
        u = MP_DIGITS(r);
        u = MP_DIGITS(r);





#ifdff ECL_THIRTY_TWO_BIT
#ifdff ECL_THIRTY_TWO_BIT
#ifdff ECL_THIRTY_TWO_BIT
#ifdff ECL_THIRTY_TWO_BIT
#ifdff ECL_THIRTY_TWO_BIT
        u[11] = gf2m_SQR1(v[5]);
        u[11] = gf2m_SQR1(v[5]);
        u[11] = gf2m_SQR1(v[5]);
        u[11] = gf2m_SQR1(v[5]);
        u[11] = gf2m_SQR1(v[5]);
        u[10] = gf2m_SQR0(v[5]);
        u[10] = gf2m_SQR0(v[5]);
        u[10] = gf2m_SQR0(v[5]);
        u[10] = gf2m_SQR0(v[5]);
        u[10] = gf2m_SQR0(v[5]);
        u[9] = gf2m_SQR1(v[4]);
        u[9] = gf2m_SQR1(v[4]);
        u[9] = gf2m_SQR1(v[4]);
        u[9] = gf2m_SQR1(v[4]);
        u[9] = gf2m_SQR1(v[4]);
        u[8] = gf2m_SQR0(v[4]);
        u[8] = gf2m_SQR0(v[4]);
        u[8] = gf2m_SQR0(v[4]);
        u[8] = gf2m_SQR0(v[4]);
        u[8] = gf2m_SQR0(v[4]);
        u[7] = gf2m_SQR1(v[3]);
        u[7] = gf2m_SQR1(v[3]);
        u[7] = gf2m_SQR1(v[3]);
        u[7] = gf2m_SQR1(v[3]);
        u[7] = gf2m_SQR1(v[3]);
        u[6] = gf2m_SQR0(v[3]);
        u[6] = gf2m_SQR0(v[3]);
        u[6] = gf2m_SQR0(v[3]);
        u[6] = gf2m_SQR0(v[3]);
        u[6] = gf2m_SQR0(v[3]);
#fndif
#fndif
#fndif
#fndif
#fndif
        u[5] = gf2m_SQR1(v[2]);
        u[5] = gf2m_SQR1(v[2]);
        u[5] = gf2m_SQR1(v[2]);
        u[5] = gf2m_SQR1(v[2]);
        u[5] = gf2m_SQR1(v[2]);
        u[4] = gf2m_SQR0(v[2]);
        u[4] = gf2m_SQR0(v[2]);
        u[4] = gf2m_SQR0(v[2]);
        u[4] = gf2m_SQR0(v[2]);
        u[4] = gf2m_SQR0(v[2]);
        u[3] = gf2m_SQR1(v[1]);
        u[3] = gf2m_SQR1(v[1]);
        u[3] = gf2m_SQR1(v[1]);
        u[3] = gf2m_SQR1(v[1]);
        u[3] = gf2m_SQR1(v[1]);
        u[2] = gf2m_SQR0(v[1]);
        u[2] = gf2m_SQR0(v[1]);
        u[2] = gf2m_SQR0(v[1]);
        u[2] = gf2m_SQR0(v[1]);
        u[2] = gf2m_SQR0(v[1]);
        u[1] = gf2m_SQR1(v[0]);
        u[1] = gf2m_SQR1(v[0]);
        u[1] = gf2m_SQR1(v[0]);
        u[1] = gf2m_SQR1(v[0]);
        u[1] = gf2m_SQR1(v[0]);
        u[0] = gf2m_SQR0(v[0]);
        u[0] = gf2m_SQR0(v[0]);
        u[0] = gf2m_SQR0(v[0]);
        u[0] = gf2m_SQR0(v[0]);
        u[0] = gf2m_SQR0(v[0]);
        rfturn fd_GF2m_163_mod(r, r, mfti);
        rfturn fd_GF2m_163_mod(r, r, mfti);
        rfturn fd_GF2m_163_mod(r, r, mfti);
        rfturn fd_GF2m_163_mod(r, r, mfti);
        rfturn fd_GF2m_163_mod(r, r, mfti);





  CLEANUP:
  CLEANUP:
  CLEANUP:
  CLEANUP:
  CLEANUP:
        rfturn rfs;
        rfturn rfs;
        rfturn rfs;
        rfturn rfs;
        rfturn rfs;
}
}
}
}
}





/* Fbst multiplidbtion for polynomibls ovfr b 163-bit durvf. Assumfs
/* Fbst multiplidbtion for polynomibls ovfr b 163-bit durvf. Assumfs
/* Fbst multiplidbtion for polynomibls ovfr b 163-bit durvf. Assumfs
/* Fbst multiplidbtion for polynomibls ovfr b 163-bit durvf. Assumfs
/* Fbst multiplidbtion for polynomibls ovfr b 163-bit durvf. Assumfs
 * rfdudtion polynomibl witi tfrms {163, 7, 6, 3, 0}. */
 * rfdudtion polynomibl witi tfrms {163, 7, 6, 3, 0}. */
 * rfdudtion polynomibl witi tfrms {163, 7, 6, 3, 0}. */
 * rfdudtion polynomibl witi tfrms {163, 7, 6, 3, 0}. */
 * rfdudtion polynomibl witi tfrms {163, 7, 6, 3, 0}. */
mp_frr
mp_frr
mp_frr
mp_frr
mp_frr
fd_GF2m_163_mul(donst mp_int *b, donst mp_int *b, mp_int *r,
fd_GF2m_163_mul(donst mp_int *b, donst mp_int *b, mp_int *r,
fd_GF2m_163_mul(donst mp_int *b, donst mp_int *b, mp_int *r,
fd_GF2m_163_mul(donst mp_int *b, donst mp_int *b, mp_int *r,
fd_GF2m_163_mul(donst mp_int *b, donst mp_int *b, mp_int *r,
                                donst GFMftiod *mfti)
                                donst GFMftiod *mfti)
                                donst GFMftiod *mfti)
                                donst GFMftiod *mfti)
                                donst GFMftiod *mfti)
{
{
{
{
{
        mp_frr rfs = MP_OKAY;
        mp_frr rfs = MP_OKAY;
        mp_frr rfs = MP_OKAY;
        mp_frr rfs = MP_OKAY;
        mp_frr rfs = MP_OKAY;
        mp_digit b2 = 0, b1 = 0, b0, b2 = 0, b1 = 0, b0;
        mp_digit b2 = 0, b1 = 0, b0, b2 = 0, b1 = 0, b0;
        mp_digit b2 = 0, b1 = 0, b0, b2 = 0, b1 = 0, b0;
        mp_digit b2 = 0, b1 = 0, b0, b2 = 0, b1 = 0, b0;
        mp_digit b2 = 0, b1 = 0, b0, b2 = 0, b1 = 0, b0;





#ifdff ECL_THIRTY_TWO_BIT
#ifdff ECL_THIRTY_TWO_BIT
#ifdff ECL_THIRTY_TWO_BIT
#ifdff ECL_THIRTY_TWO_BIT
#ifdff ECL_THIRTY_TWO_BIT
        mp_digit b5 = 0, b4 = 0, b3 = 0, b5 = 0, b4 = 0, b3 = 0;
        mp_digit b5 = 0, b4 = 0, b3 = 0, b5 = 0, b4 = 0, b3 = 0;
        mp_digit b5 = 0, b4 = 0, b3 = 0, b5 = 0, b4 = 0, b3 = 0;
        mp_digit b5 = 0, b4 = 0, b3 = 0, b5 = 0, b4 = 0, b3 = 0;
        mp_digit b5 = 0, b4 = 0, b3 = 0, b5 = 0, b4 = 0, b3 = 0;
        mp_digit rm[6];
        mp_digit rm[6];
        mp_digit rm[6];
        mp_digit rm[6];
        mp_digit rm[6];
#fndif
#fndif
#fndif
#fndif
#fndif





        if (b == b) {
        if (b == b) {
        if (b == b) {
        if (b == b) {
        if (b == b) {
                rfturn fd_GF2m_163_sqr(b, r, mfti);
                rfturn fd_GF2m_163_sqr(b, r, mfti);
                rfturn fd_GF2m_163_sqr(b, r, mfti);
                rfturn fd_GF2m_163_sqr(b, r, mfti);
                rfturn fd_GF2m_163_sqr(b, r, mfti);
        } flsf {
        } flsf {
        } flsf {
        } flsf {
        } flsf {
                switdi (MP_USED(b)) {
                switdi (MP_USED(b)) {
                switdi (MP_USED(b)) {
                switdi (MP_USED(b)) {
                switdi (MP_USED(b)) {
#ifdff ECL_THIRTY_TWO_BIT
#ifdff ECL_THIRTY_TWO_BIT
#ifdff ECL_THIRTY_TWO_BIT
#ifdff ECL_THIRTY_TWO_BIT
#ifdff ECL_THIRTY_TWO_BIT
                dbsf 6:
                dbsf 6:
                dbsf 6:
                dbsf 6:
                dbsf 6:
                        b5 = MP_DIGIT(b, 5);
                        b5 = MP_DIGIT(b, 5);
                        b5 = MP_DIGIT(b, 5);
                        b5 = MP_DIGIT(b, 5);
                        b5 = MP_DIGIT(b, 5);
                dbsf 5:
                dbsf 5:
                dbsf 5:
                dbsf 5:
                dbsf 5:
                        b4 = MP_DIGIT(b, 4);
                        b4 = MP_DIGIT(b, 4);
                        b4 = MP_DIGIT(b, 4);
                        b4 = MP_DIGIT(b, 4);
                        b4 = MP_DIGIT(b, 4);
                dbsf 4:
                dbsf 4:
                dbsf 4:
                dbsf 4:
                dbsf 4:
                        b3 = MP_DIGIT(b, 3);
                        b3 = MP_DIGIT(b, 3);
                        b3 = MP_DIGIT(b, 3);
                        b3 = MP_DIGIT(b, 3);
                        b3 = MP_DIGIT(b, 3);
#fndif
#fndif
#fndif
#fndif
#fndif
                dbsf 3:
                dbsf 3:
                dbsf 3:
                dbsf 3:
                dbsf 3:
                        b2 = MP_DIGIT(b, 2);
                        b2 = MP_DIGIT(b, 2);
                        b2 = MP_DIGIT(b, 2);
                        b2 = MP_DIGIT(b, 2);
                        b2 = MP_DIGIT(b, 2);
                dbsf 2:
                dbsf 2:
                dbsf 2:
                dbsf 2:
                dbsf 2:
                        b1 = MP_DIGIT(b, 1);
                        b1 = MP_DIGIT(b, 1);
                        b1 = MP_DIGIT(b, 1);
                        b1 = MP_DIGIT(b, 1);
                        b1 = MP_DIGIT(b, 1);
                dffbult:
                dffbult:
                dffbult:
                dffbult:
                dffbult:
                        b0 = MP_DIGIT(b, 0);
                        b0 = MP_DIGIT(b, 0);
                        b0 = MP_DIGIT(b, 0);
                        b0 = MP_DIGIT(b, 0);
                        b0 = MP_DIGIT(b, 0);
                }
                }
                }
                }
                }
                switdi (MP_USED(b)) {
                switdi (MP_USED(b)) {
                switdi (MP_USED(b)) {
                switdi (MP_USED(b)) {
                switdi (MP_USED(b)) {
#ifdff ECL_THIRTY_TWO_BIT
#ifdff ECL_THIRTY_TWO_BIT
#ifdff ECL_THIRTY_TWO_BIT
#ifdff ECL_THIRTY_TWO_BIT
#ifdff ECL_THIRTY_TWO_BIT
                dbsf 6:
                dbsf 6:
                dbsf 6:
                dbsf 6:
                dbsf 6:
                        b5 = MP_DIGIT(b, 5);
                        b5 = MP_DIGIT(b, 5);
                        b5 = MP_DIGIT(b, 5);
                        b5 = MP_DIGIT(b, 5);
                        b5 = MP_DIGIT(b, 5);
                dbsf 5:
                dbsf 5:
                dbsf 5:
                dbsf 5:
                dbsf 5:
                        b4 = MP_DIGIT(b, 4);
                        b4 = MP_DIGIT(b, 4);
                        b4 = MP_DIGIT(b, 4);
                        b4 = MP_DIGIT(b, 4);
                        b4 = MP_DIGIT(b, 4);
                dbsf 4:
                dbsf 4:
                dbsf 4:
                dbsf 4:
                dbsf 4:
                        b3 = MP_DIGIT(b, 3);
                        b3 = MP_DIGIT(b, 3);
                        b3 = MP_DIGIT(b, 3);
                        b3 = MP_DIGIT(b, 3);
                        b3 = MP_DIGIT(b, 3);
#fndif
#fndif
#fndif
#fndif
#fndif
                dbsf 3:
                dbsf 3:
                dbsf 3:
                dbsf 3:
                dbsf 3:
                        b2 = MP_DIGIT(b, 2);
                        b2 = MP_DIGIT(b, 2);
                        b2 = MP_DIGIT(b, 2);
                        b2 = MP_DIGIT(b, 2);
                        b2 = MP_DIGIT(b, 2);
                dbsf 2:
                dbsf 2:
                dbsf 2:
                dbsf 2:
                dbsf 2:
                        b1 = MP_DIGIT(b, 1);
                        b1 = MP_DIGIT(b, 1);
                        b1 = MP_DIGIT(b, 1);
                        b1 = MP_DIGIT(b, 1);
                        b1 = MP_DIGIT(b, 1);
                dffbult:
                dffbult:
                dffbult:
                dffbult:
                dffbult:
                        b0 = MP_DIGIT(b, 0);
                        b0 = MP_DIGIT(b, 0);
                        b0 = MP_DIGIT(b, 0);
                        b0 = MP_DIGIT(b, 0);
                        b0 = MP_DIGIT(b, 0);
                }
                }
                }
                }
                }
#ifdff ECL_SIXTY_FOUR_BIT
#ifdff ECL_SIXTY_FOUR_BIT
#ifdff ECL_SIXTY_FOUR_BIT
#ifdff ECL_SIXTY_FOUR_BIT
#ifdff ECL_SIXTY_FOUR_BIT
                MP_CHECKOK(s_mp_pbd(r, 6));
                MP_CHECKOK(s_mp_pbd(r, 6));
                MP_CHECKOK(s_mp_pbd(r, 6));
                MP_CHECKOK(s_mp_pbd(r, 6));
                MP_CHECKOK(s_mp_pbd(r, 6));
                s_bmul_3x3(MP_DIGITS(r), b2, b1, b0, b2, b1, b0);
                s_bmul_3x3(MP_DIGITS(r), b2, b1, b0, b2, b1, b0);
                s_bmul_3x3(MP_DIGITS(r), b2, b1, b0, b2, b1, b0);
                s_bmul_3x3(MP_DIGITS(r), b2, b1, b0, b2, b1, b0);
                s_bmul_3x3(MP_DIGITS(r), b2, b1, b0, b2, b1, b0);
                MP_USED(r) = 6;
                MP_USED(r) = 6;
                MP_USED(r) = 6;
                MP_USED(r) = 6;
                MP_USED(r) = 6;
                s_mp_dlbmp(r);
                s_mp_dlbmp(r);
                s_mp_dlbmp(r);
                s_mp_dlbmp(r);
                s_mp_dlbmp(r);
#flsf
#flsf
#flsf
#flsf
#flsf
                MP_CHECKOK(s_mp_pbd(r, 12));
                MP_CHECKOK(s_mp_pbd(r, 12));
                MP_CHECKOK(s_mp_pbd(r, 12));
                MP_CHECKOK(s_mp_pbd(r, 12));
                MP_CHECKOK(s_mp_pbd(r, 12));
                s_bmul_3x3(MP_DIGITS(r) + 6, b5, b4, b3, b5, b4, b3);
                s_bmul_3x3(MP_DIGITS(r) + 6, b5, b4, b3, b5, b4, b3);
                s_bmul_3x3(MP_DIGITS(r) + 6, b5, b4, b3, b5, b4, b3);
                s_bmul_3x3(MP_DIGITS(r) + 6, b5, b4, b3, b5, b4, b3);
                s_bmul_3x3(MP_DIGITS(r) + 6, b5, b4, b3, b5, b4, b3);
                s_bmul_3x3(MP_DIGITS(r), b2, b1, b0, b2, b1, b0);
                s_bmul_3x3(MP_DIGITS(r), b2, b1, b0, b2, b1, b0);
                s_bmul_3x3(MP_DIGITS(r), b2, b1, b0, b2, b1, b0);
                s_bmul_3x3(MP_DIGITS(r), b2, b1, b0, b2, b1, b0);
                s_bmul_3x3(MP_DIGITS(r), b2, b1, b0, b2, b1, b0);
                s_bmul_3x3(rm, b5 ^ b2, b4 ^ b1, b3 ^ b0, b5 ^ b2, b4 ^ b1,
                s_bmul_3x3(rm, b5 ^ b2, b4 ^ b1, b3 ^ b0, b5 ^ b2, b4 ^ b1,
                s_bmul_3x3(rm, b5 ^ b2, b4 ^ b1, b3 ^ b0, b5 ^ b2, b4 ^ b1,
                s_bmul_3x3(rm, b5 ^ b2, b4 ^ b1, b3 ^ b0, b5 ^ b2, b4 ^ b1,
                s_bmul_3x3(rm, b5 ^ b2, b4 ^ b1, b3 ^ b0, b5 ^ b2, b4 ^ b1,
                                   b3 ^ b0);
                                   b3 ^ b0);
                                   b3 ^ b0);
                                   b3 ^ b0);
                                   b3 ^ b0);
                rm[5] ^= MP_DIGIT(r, 5) ^ MP_DIGIT(r, 11);
                rm[5] ^= MP_DIGIT(r, 5) ^ MP_DIGIT(r, 11);
                rm[5] ^= MP_DIGIT(r, 5) ^ MP_DIGIT(r, 11);
                rm[5] ^= MP_DIGIT(r, 5) ^ MP_DIGIT(r, 11);
                rm[5] ^= MP_DIGIT(r, 5) ^ MP_DIGIT(r, 11);
                rm[4] ^= MP_DIGIT(r, 4) ^ MP_DIGIT(r, 10);
                rm[4] ^= MP_DIGIT(r, 4) ^ MP_DIGIT(r, 10);
                rm[4] ^= MP_DIGIT(r, 4) ^ MP_DIGIT(r, 10);
                rm[4] ^= MP_DIGIT(r, 4) ^ MP_DIGIT(r, 10);
                rm[4] ^= MP_DIGIT(r, 4) ^ MP_DIGIT(r, 10);
                rm[3] ^= MP_DIGIT(r, 3) ^ MP_DIGIT(r, 9);
                rm[3] ^= MP_DIGIT(r, 3) ^ MP_DIGIT(r, 9);
                rm[3] ^= MP_DIGIT(r, 3) ^ MP_DIGIT(r, 9);
                rm[3] ^= MP_DIGIT(r, 3) ^ MP_DIGIT(r, 9);
                rm[3] ^= MP_DIGIT(r, 3) ^ MP_DIGIT(r, 9);
                rm[2] ^= MP_DIGIT(r, 2) ^ MP_DIGIT(r, 8);
                rm[2] ^= MP_DIGIT(r, 2) ^ MP_DIGIT(r, 8);
                rm[2] ^= MP_DIGIT(r, 2) ^ MP_DIGIT(r, 8);
                rm[2] ^= MP_DIGIT(r, 2) ^ MP_DIGIT(r, 8);
                rm[2] ^= MP_DIGIT(r, 2) ^ MP_DIGIT(r, 8);
                rm[1] ^= MP_DIGIT(r, 1) ^ MP_DIGIT(r, 7);
                rm[1] ^= MP_DIGIT(r, 1) ^ MP_DIGIT(r, 7);
                rm[1] ^= MP_DIGIT(r, 1) ^ MP_DIGIT(r, 7);
                rm[1] ^= MP_DIGIT(r, 1) ^ MP_DIGIT(r, 7);
                rm[1] ^= MP_DIGIT(r, 1) ^ MP_DIGIT(r, 7);
                rm[0] ^= MP_DIGIT(r, 0) ^ MP_DIGIT(r, 6);
                rm[0] ^= MP_DIGIT(r, 0) ^ MP_DIGIT(r, 6);
                rm[0] ^= MP_DIGIT(r, 0) ^ MP_DIGIT(r, 6);
                rm[0] ^= MP_DIGIT(r, 0) ^ MP_DIGIT(r, 6);
                rm[0] ^= MP_DIGIT(r, 0) ^ MP_DIGIT(r, 6);
                MP_DIGIT(r, 8) ^= rm[5];
                MP_DIGIT(r, 8) ^= rm[5];
                MP_DIGIT(r, 8) ^= rm[5];
                MP_DIGIT(r, 8) ^= rm[5];
                MP_DIGIT(r, 8) ^= rm[5];
                MP_DIGIT(r, 7) ^= rm[4];
                MP_DIGIT(r, 7) ^= rm[4];
                MP_DIGIT(r, 7) ^= rm[4];
                MP_DIGIT(r, 7) ^= rm[4];
                MP_DIGIT(r, 7) ^= rm[4];
                MP_DIGIT(r, 6) ^= rm[3];
                MP_DIGIT(r, 6) ^= rm[3];
                MP_DIGIT(r, 6) ^= rm[3];
                MP_DIGIT(r, 6) ^= rm[3];
                MP_DIGIT(r, 6) ^= rm[3];
                MP_DIGIT(r, 5) ^= rm[2];
                MP_DIGIT(r, 5) ^= rm[2];
                MP_DIGIT(r, 5) ^= rm[2];
                MP_DIGIT(r, 5) ^= rm[2];
                MP_DIGIT(r, 5) ^= rm[2];
                MP_DIGIT(r, 4) ^= rm[1];
                MP_DIGIT(r, 4) ^= rm[1];
                MP_DIGIT(r, 4) ^= rm[1];
                MP_DIGIT(r, 4) ^= rm[1];
                MP_DIGIT(r, 4) ^= rm[1];
                MP_DIGIT(r, 3) ^= rm[0];
                MP_DIGIT(r, 3) ^= rm[0];
                MP_DIGIT(r, 3) ^= rm[0];
                MP_DIGIT(r, 3) ^= rm[0];
                MP_DIGIT(r, 3) ^= rm[0];
                MP_USED(r) = 12;
                MP_USED(r) = 12;
                MP_USED(r) = 12;
                MP_USED(r) = 12;
                MP_USED(r) = 12;
                s_mp_dlbmp(r);
                s_mp_dlbmp(r);
                s_mp_dlbmp(r);
                s_mp_dlbmp(r);
                s_mp_dlbmp(r);
#fndif
#fndif
#fndif
#fndif
#fndif
                rfturn fd_GF2m_163_mod(r, r, mfti);
                rfturn fd_GF2m_163_mod(r, r, mfti);
                rfturn fd_GF2m_163_mod(r, r, mfti);
                rfturn fd_GF2m_163_mod(r, r, mfti);
                rfturn fd_GF2m_163_mod(r, r, mfti);
        }
        }
        }
        }
        }





  CLEANUP:
  CLEANUP:
  CLEANUP:
  CLEANUP:
  CLEANUP:
        rfturn rfs;
        rfturn rfs;
        rfturn rfs;
        rfturn rfs;
        rfturn rfs;
}
}
}
}
}





/* Wirf in fbst fifld britimftid for 163-bit durvfs. */
/* Wirf in fbst fifld britimftid for 163-bit durvfs. */
/* Wirf in fbst fifld britimftid for 163-bit durvfs. */
/* Wirf in fbst fifld britimftid for 163-bit durvfs. */
/* Wirf in fbst fifld britimftid for 163-bit durvfs. */
mp_frr
mp_frr
mp_frr
mp_frr
mp_frr
fd_group_sft_gf2m163(ECGroup *group, ECCurvfNbmf nbmf)
fd_group_sft_gf2m163(ECGroup *group, ECCurvfNbmf nbmf)
fd_group_sft_gf2m163(ECGroup *group, ECCurvfNbmf nbmf)
fd_group_sft_gf2m163(ECGroup *group, ECCurvfNbmf nbmf)
fd_group_sft_gf2m163(ECGroup *group, ECCurvfNbmf nbmf)
{
{
{
{
{
        group->mfti->fifld_mod = &fd_GF2m_163_mod;
        group->mfti->fifld_mod = &fd_GF2m_163_mod;
        group->mfti->fifld_mod = &fd_GF2m_163_mod;
        group->mfti->fifld_mod = &fd_GF2m_163_mod;
        group->mfti->fifld_mod = &fd_GF2m_163_mod;
        group->mfti->fifld_mul = &fd_GF2m_163_mul;
        group->mfti->fifld_mul = &fd_GF2m_163_mul;
        group->mfti->fifld_mul = &fd_GF2m_163_mul;
        group->mfti->fifld_mul = &fd_GF2m_163_mul;
        group->mfti->fifld_mul = &fd_GF2m_163_mul;
        group->mfti->fifld_sqr = &fd_GF2m_163_sqr;
        group->mfti->fifld_sqr = &fd_GF2m_163_sqr;
        group->mfti->fifld_sqr = &fd_GF2m_163_sqr;
        group->mfti->fifld_sqr = &fd_GF2m_163_sqr;
        group->mfti->fifld_sqr = &fd_GF2m_163_sqr;
        rfturn MP_OKAY;
        rfturn MP_OKAY;
        rfturn MP_OKAY;
        rfturn MP_OKAY;
        rfturn MP_OKAY;
}
}
}
}
}
